The O
Darkhotel O
APT O
is O
a O
threat O
actor O
possessing O
a O
seemingly O
inconsistent O
and O
con- O
tradictory O
set O
of O
characteristics O
, O
some O
advanced O
and O
some O
fairly O
rudimentary O
. O

In- O
hospitably O
operating O
for O
almost O
a O
decade O
, O
the O
threat O
actor O
is O
currently O
active O
. O

The O
actor O
's O
offensive O
activity O
can O
be O
tied O
to O
specific O
hotel O
and O
business O
center O
Wi‑Fi O
and O
physical O
connections O
, O
some O
of O
it O
is O
also O
tied O
to O
p2p/file O
sharing O
networks O
, O
and O
they B-Entity
have O
been O
known O
to O
spear-phish B-Action
targets B-Entity
as O
well O
. O

Darkhotel O
tools O
are O
detected O
as O
'' O
Tapaoux O
'' O
, O
'' O
Pioneer O
'' O
, O
'' O
Karba O
'' O
, O
and O
'' O
Nemim O
'' O
, O
among O
other O
names O
. O

The O
following O
list O
presents O
a O
set O
of O
characteristics O
for O
the O
crew O
: O
When O
unsuspecting O
guests O
, O
including O
situationally O
aware O
corporate O
executives O
and O
high-tech O
entrepreneurs O
, O
travel O
to O
a O
variety O
of O
hotels O
and O
connect O
to O
the O
internet O
, O
they B-Entity
are B-Action
infected I-Action
with B-Modifier
a B-Entity
rare I-Entity
APT I-Entity
Trojan I-Entity
posing B-Action
as B-Modifier
any B-Entity
one I-Entity
of I-Entity
several I-Entity
major I-Entity
software I-Entity
releases I-Entity
. O

These O
might O
be O
GoogleToolbar O
, O
Adobe O
Flash O
, O
Windows O
Messenger O
, O
etc O
. O

This O
first O
stage O
of O
malware O
helps O
the B-Entity
attackers I-Entity
to O
identify B-Action
more B-Entity
significant I-Entity
victims I-Entity
, O
leading O
to O
the O
selective O
download B-Action
of O
more B-Entity
advanced I-Entity
stealing I-Entity
tools I-Entity
. O

At O
the O
hotels O
, O
these B-Entity
installs I-Entity
are B-Action
selectively I-Action
distributed I-Action
to B-Modifier
targeted B-Entity
individuals I-Entity
. O

This O
group O
of O
attackers O
seems O
to O
know O
in O
advance O
when O
these O
individuals O
will O
arrive O
and O
depart O
from O
their O
high-end O
hotels O
. O

So O
, O
the O
attackers O
lay O
in O
wait O
until O
these O
travelers O
arrive O
and O
connect O
to O
the O
Internet O
. O

The O
FBI O
issued O
advisories O
about O
similar O
hotel O
incidents O
; O
Australian O
government O
offi- O
cials O
produced O
similar O
, O
newsworthy O
accounts O
when O
they O
were O
infected O
. O

While O
an O
FBI O
announcement O
related O
to O
attacks O
on O
hotel O
guests O
overseas O
appeared O
in O
May O
2012 O
, O
related O
Darkhotel O
samples O
were O
already O
circulating O
back O
in O
2007 O
. O

And O
available O
Darkhotel O
server O
log O
data O
records O
connections O
as O
early O
as O
Jan O
1 O
, O
2009 O
. O

Addition- O
ally O
, O
seeding B-Action
p2p B-Entity
networks I-Entity
with B-Modifier
widely B-Entity
spread I-Entity
malware I-Entity
and I-Entity
0-day I-Entity
spear-phishing I-Entity
attacks I-Entity
demonstrate O
that O
the O
Darkhotel O
APT O
maintains O
an O
effective O
toolset O
and O
a O
long-running O
operation O
behind O
the O
questionable O
hospitality O
it O
shows O
its O
guests O
. O

The O
Darkhotel O
APT O
's O
precise O
malware O
spread O
was O
observed O
in O
several O
hotels' O
networks O
, O
where O
visitors B-Entity
connecting I-Entity
to I-Entity
the I-Entity
hotel I-Entity
's I-Entity
Wi-Fi I-Entity
were B-Action
prompted I-Action
to B-Modifier
install B-Entity
software I-Entity
updates I-Entity
to I-Entity
popular I-Entity
software I-Entity
packages I-Entity
. O

Of O
course O
, O
these B-Entity
packages I-Entity
were B-Action
really B-Entity
installers I-Entity
for I-Entity
Darkhotel I-Entity
APT I-Entity
's I-Entity
backdoors I-Entity
, O
added O
to O
legitimate O
installers O
from O
Adobe O
and O
Google O
. O

Digitally B-Entity
signed I-Entity
Darkhotel I-Entity
backdoors I-Entity
were B-Action
installed I-Action
alongside B-Modifier
the B-Entity
legitimate I-Entity
packages I-Entity
. O

The O
most O
interesting O
thing O
about O
this O
delivery O
method O
is O
that O
the O
hotels O
require O
guests O
to O
use O
their O
last O
name O
and O
room O
number O
to O
login O
, O
yet O
only B-Entity
a I-Entity
few I-Entity
guests I-Entity
received B-Action
the B-Entity
Darkhotel I-Entity
package I-Entity
. O

When O
visiting O
the O
same O
hotels O
, O
our O
honeypot O
research O
systems O
could O
n't O
attract O
a O
Darkhotel O
attack O
. O

This O
data O
is O
inconclusive O
, O
but O
it O
points O
to O
misuse O
of O
check-in O
information O
. O

The O
Darkhotel O
actor O
maintained O
an O
effective O
intrusion O
set O
at O
hotel O
networks O
, O
providing O
ample O
access O
to O
unexpected O
points O
of O
attack O
over O
several O
years O
. O

These O
staging O
points O
also O
provide O
the O
attackers O
with O
access O
to O
check-in/check-out O
and O
identity O
information O
of O
visitors O
to O
high-end O
and O
luxury O
hotels O
. O

As O
a O
part O
of O
an O
ongoing O
investigation O
, O
our O
research O
led O
us O
to O
embedded B-Entity
iframes I-Entity
within I-Entity
hotel I-Entity
networks I-Entity
that O
redirected B-Action
individuals B-Entity
' I-Entity
web I-Entity
browsers I-Entity
to B-Modifier
phony B-Entity
install- I-Entity
ers I-Entity
. O

The O
attackers O
were O
very O
careful O
with O
the O
placement O
of O
these O
iframes O
and O
executables O
on O
trusted O
resources O
- O
the O
hotels O
' O
network O
login O
portals O
themselves O
. O

The B-Entity
attackers I-Entity
were O
also O
very O
careful O
to O
immediately O
delete B-Action
all B-Entity
traces I-Entity
of I-Entity
their I-Entity
tools I-Entity
as B-Modifier
soon I-Modifier
as I-Modifier
an B-Entity
attack I-Entity
was I-Entity
carried I-Entity
out I-Entity
successfully I-Entity
. O

Those O
portals O
are O
now O
reviewed O
, O
cleaned O
and O
undergoing O
a O
further O
review O
and O
hardening O
process O
. O

We O
observed O
traces O
of O
a O
couple O
of O
these O
incidents O
in O
late O
2013 O
and O
early O
2014 O
on O
a O
victim O
hotel O
's O
network O
. O

The B-Entity
attackers I-Entity
set O
up O
the O
environment O
and O
hit B-Action
their B-Entity
individual I-Entity
targets I-Entity
with B-Modifier
precision B-Entity
. O

As O
soon O
as O
their O
target O
's O
stay O
was O
over O
and O
the O
attack-frame O
was O
closed O
, O
the B-Entity
attackers I-Entity
deleted B-Action
their B-Entity
iframe I-Entity
placement I-Entity
and I-Entity
backdoored I-Entity
executables I-Entity
from B-Modifier
the B-Entity
hotel I-Entity
network I-Entity
. O

The B-Entity
attackers I-Entity
successfully O
de- B-Action
leted I-Action
traces B-Entity
of I-Entity
their I-Entity
work I-Entity
from B-Modifier
earlier B-Entity
attacks I-Entity
in I-Entity
another I-Entity
hotel I-Entity
, O
but O
their O
offensive O
techniques O
were O
the O
same O
. O

Outside O
reports O
of O
the O
same O
activity O
at O
other O
hotels O
provide O
enough O
data O
to O
confirm O
the O
same O
careful O
operations O
there O
. O

The O
attack O
technique O
blurs O
the O
line O
between O
a O
couple O
of O
common O
APT O
tactics O
; O
fairly O
inaccurate O
'' O
watering O
holes O
'' O
or O
'' O
strategic O
web O
compromises O
'' O
and O
more O
accurate O
spearphishing O
techniques O
. O

In O
this O
case O
, O
the O
Darkhotel O
attackers O
wait O
for O
their O
victim O
to O
connect O
to O
the O
Internet O
over O
the O
hotel O
Wi-Fi O
or O
the O
cable O
in O
their O
room O
. O

There O
is O
a O
very O
strong O
likelihood O
the O
targets O
will O
connect O
over O
these O
resourc- O
es O
, O
and O
the O
attackers O
rely O
on O
that O
likelihood O
, O
much O
like O
at O
a O
watering O
hole O
. O

But O
the B-Entity
attackers I-Entity
also O
maintain B-Action
truly B-Entity
precise I-Entity
targeting I-Entity
information I-Entity
over B-Modifier
the B-Entity
victim I-Entity
's I-Entity
visit I-Entity
, O
much O
like O
they O
would O
know O
a O
victim O
's O
email O
address O
and O
content O
interests O
in O
a O
spearphishing O
attack O
. O

While O
setting O
up O
the O
attack O
, O
the O
Darkhotel O
attackers O
knew O
the O
target O
's O
expected O
arrival O
and O
departure O
times O
, O
room O
number O
, O
and O
full O
name O
, O
among O
other O
data O
. O

This O
data O
enables O
the B-Entity
attackers I-Entity
to O
present B-Action
the B-Entity
malicious I-Entity
iframe I-Entity
precisely B-Modifier
to I-Modifier
that B-Entity
individual I-Entity
target I-Entity
. O

So O
, O
here O
we O
have O
yet O
another O
unique O
characteristic O
of O
this O
attacker O
- O
they O
employ O
a O
loosely O
certain O
but O
highly O
precise O
offensive O
approach O
. O

An O
example O
of O
the O
Darkhotel O
APT O
's O
indiscriminate O
malware O
spreading O
is O
dem- O
onstrated O
by O
the O
way O
it B-Entity
seeds B-Action
Japanese B-Entity
p2p I-Entity
sharing I-Entity
sites I-Entity
, O
where O
the B-Entity
malware I-Entity
is B-Action
delivered I-Action
as B-Modifier
a B-Entity
part I-Entity
of I-Entity
a I-Entity
large I-Entity
( I-Entity
approximately I-Entity
900mb I-Entity
) I-Entity
rar I-Entity
archive I-Entity
. O

The B-Entity
archive I-Entity
is B-Action
also I-Action
spread I-Action
over B-Modifier
bittorrent B-Entity
, O
as O
detailed O
below O
. O

Darkhotel B-Entity
uses B-Action
this B-Entity
method I-Entity
to B-Modifier
distribute B-Entity
their I-Entity
Karba I-Entity
Trojan I-Entity
. O

These O
Japanese O
archives O
, O
translated O
for O
Chinese O
speaking O
viewers O
, O
appear O
to O
be O
sexual O
in O
nature O
, O
part O
of O
an O
anime O
sex/military O
comic O
scene O
, O
exposing O
the O
likely O
interests O
of O
potential O
targets O
. O

This B-Entity
Darkhotel I-Entity
package I-Entity
was B-Action
downloaded I-Action
over B-Entity
30,000 I-Entity
times I-Entity
in B-Modifier
less B-Entity
than I-Entity
six I-Entity
months I-Entity
. O

The O
p2p O
bittorrent O
Darkhotel O
offering O
is O
listed O
here O
, O
posted O
on O
2013.11.22 O
. O

It O
was O
spread O
throughout O
2014 O
. O

This O
torrent O
serves O
up O
an O
almost O
900 O
mb O
file O
. O

The O
rar O
archive O
decompresses O
to O
a O
directory O
full O
of O
encrypted O
zips O
, O
the O
associated O
decryptor O
and O
a O
password O
file O
for O
decrypting O
the O
zips O
. O

But O
what O
looks O
like O
the B-Entity
AxDecrypt.exe I-Entity
decryptor I-Entity
is B-Action
bound I-Action
to B-Modifier
both O
the O
true O
decryptor O
and O
the B-Entity
dropper I-Entity
for I-Entity
the I-Entity
Darkhotel I-Entity
Catch.exe I-Entity
Karba I-Entity
Trojan I-Entity
. O

When O
a O
user O
downloads O
the O
torrent O
and O
decrypts O
the O
zip O
files O
, O
the B-Entity
trojan I-Entity
surrepti- O
tiously O
is B-Action
installed I-Action
and I-Action
run I-Action
on B-Modifier
the B-Entity
victim I-Entity
system I-Entity
. O

Catch.exe B-Entity
, O
detected B-Action
as B-Modifier
Backdoor.Win32.Agent.dgrn B-Entity
, O
communicates B-Action
with B-Modifier
the B-Entity
fol- I-Entity
lowing I-Entity
Darkhotel I-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
: O
Other O
examples O
of O
this B-Entity
Darkhotel I-Entity
backdoor I-Entity
bound B-Action
within B-Modifier
a B-Entity
shared I-Entity
torrent I-Entity
include O
adult O
content O
Japanese O
anime O
and O
more O
. O

There O
are O
tens O
of O
thousands O
of O
down- O
loads O
of O
these O
individual O
torrents O
. O

The B-Entity
associated I-Entity
Darkhotel I-Entity
backdoor I-Entity
was B-Action
hosted I-Action
on B-Modifier
bittorrent B-Entity
, I-Entity
emule I-Entity
, I-Entity
etc I-Entity
, I-Entity
under B-Modifier
a B-Entity
variety I-Entity
of I-Entity
comic I-Entity
names I-Entity
. O

Examples O
include O
comics O
and O
anime O
offerings O
. O

Related B-Entity
Darkhotel I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
domains I-Entity
include B-Action
: O
Darkhotel B-Entity
campaigns I-Entity
involving B-Action
typical B-Entity
spear-phished I-Entity
Tapaoux I-Entity
implants I-Entity
publicly O
appeared O
in O
bits O
and O
pieces O
several O
times O
over O
the O
past O
five O
years O
. O

These O
subproject O
efforts O
targeted O
defense O
industrial O
base O
( O
DIB O
) O
, O
government O
, O
and O
NGO O
organizations O
. O

Email O
content O
on O
topics O
like O
nuclear O
energy O
and O
weaponry O
capabilities O
was O
used O
as O
a O
lure O
. O

Early O
accounts O
were O
posted O
on O
contagio O
describing O
attacks O
on O
NGO O
organi- O
zations O
and O
government O
policy O
makers O
. O

This B-Entity
spear-phishing I-Entity
activity I-Entity
continues B-Action
into B-Modifier
2014 B-Entity
. O

The B-Entity
attacks I-Entity
follow B-Action
the B-Entity
typical I-Entity
spear-phishing I-Entity
process I-Entity
and O
in O
the O
past O
couple O
of O
months O
, O
exploited B-Entity
systems I-Entity
retrieved B-Action
downloader B-Entity
executables I-Entity
from B-Modifier
web B-Entity
servers I-Entity
like O
Over O
the O
past O
few O
years O
the B-Entity
group I-Entity
has O
emailed B-Action
links B-Entity
that O
redirect B-Action
targets B-Entity
' I-Entity
brows- I-Entity
ers I-Entity
to B-Modifier
Internet B-Entity
Explorer I-Entity
0-day I-Entity
exploits I-Entity
. O

Sometimes O
the B-Entity
attachment I-Entity
itself I-Entity
includes B-Action
an B-Entity
Adobe I-Entity
0-day I-Entity
exploit I-Entity
. O

This O
crew O
occasionally O
deploys O
0-day O
exploits O
, O
but O
burns O
them O
when O
required O
. O

In O
the O
past O
few O
years O
, O
they B-Entity
deployed B-Action
0-day B-Entity
spear-phishing I-Entity
attacks I-Entity
targeting B-Action
Adobe B-Entity
products I-Entity
and I-Entity
Microsoft I-Entity
Internet I-Entity
Explorer I-Entity
, I-Entity
including I-Entity
cve­2010­0188 I-Entity
. O

In O
early O
2014 O
, O
our O
researchers O
exposed O
their O
use O
of O
cve­2014­0497 O
, O
a O
Flash O
0-day O
described O
on O
Securelist O
in O
early O
February O
. O

The B-Entity
crew I-Entity
spear-phished B-Action
a B-Entity
set I-Entity
of I-Entity
target I-Entity
systems I-Entity
connected I-Entity
to I-Entity
the I-Entity
Internet I-Entity
through I-Entity
Chinese I-Entity
ISPs I-Entity
, O
and O
developed O
capabilities O
within O
the O
0-day O
exploits O
to O
handle O
hardened O
Windows O
8.1 O
systems O
. O

It O
's O
interesting O
that O
the B-Entity
Flash I-Entity
objects I-Entity
were B-Action
embedded I-Action
in B-Modifier
Korean B-Entity
documents I-Entity
titled I-Entity
'' I-Entity
List I-Entity
of I-Entity
the I-Entity
latest I-Entity
Japanese I-Entity
AV I-Entity
wind I-Entity
and I-Entity
how I-Entity
to I-Entity
use I-Entity
torrents.docx I-Entity
'' I-Entity
( I-Entity
loose I-Entity
English I-Entity
translation I-Entity
) I-Entity
. O

The B-Entity
dropped I-Entity
downloader I-Entity
( I-Entity
d8137ded710d83e2339a97ee78494c34 I-Entity
) I-Entity
delivered B-Action
malcode B-Entity
similar I-Entity
to I-Entity
the I-Entity
'' I-Entity
Information I-Entity
Stealer I-Entity
'' I-Entity
component I-Entity
functionality I-Entity
summarized I-Entity
below I-Entity
, I-Entity
and I-Entity
detailed I-Entity
in I-Entity
Appendix I-Entity
D I-Entity
. O

The O
Darkhotel O
actors O
typically O
sign O
their O
backdoors O
with O
digital O
certificates O
of O
one O
kind O
or O
another O
. O

However O
, O
the O
certificates O
originally O
chosen O
by O
this O
crew O
are O
very O
interesting O
because O
of O
their O
weak O
keys O
and O
likely O
abuse O
by O
attackers O
. O

Here O
is O
a O
listing O
of O
the O
certs O
that O
were O
commonly O
used O
to O
sign O
Darkhotel O
malcode O
, O
requiring O
advanced O
mathematical O
capabilities O
to O
factorize O
the O
keys O
at O
the O
time O
. O

They O
are O
not O
the O
only O
certificates O
used O
by O
the O
group O
. O

More O
recent O
activity O
suggests O
that O
the O
group O
has O
stolen O
certificates O
to O
sign O
their O
code O
. O

All O
related O
cases O
of O
signed O
Darkhotel O
malware O
share O
the O
same O
Root O
Certificate O
Authority O
and O
Intermediate O
Certificate O
Authority O
that O
issued O
certificates O
with O
weak O
md5 O
keys O
( O
RSA O
512 O
bits O
) O
. O

We O
are O
confident O
that O
our O
Darkhotel O
threat O
actor O
fraudulently O
duplicated O
these O
certificates O
to O
sign O
its O
malware O
. O

These O
keys O
were O
not O
stolen O
. O

Many O
of O
the O
certificates O
were O
noted O
in O
a O
2011 O
Fox­IT O
post O
'' O
RSA­512 O
Certificates O
Abused O
in O
the O
Wild O
'' O
. O

To O
further O
support O
this O
speculation O
please O
note O
the O
non­specific O
Microsoft O
Security O
Advisory O
below O
, O
the O
Mozilla O
advisory O
addressing O
the O
issue O
at O
the O
time O
, O
and O
the O
Entrust O
responses O
. O

From O
Microsoft O
's O
security O
advisory O
from O
Thursday O
, O
November O
10 O
, O
2011 O
: O
'' O
Microsoft O
is O
aware O
that O
DigiCert O
Sdn O
. O

Bhd O
, O
a O
Malaysian O
subordinate O
certifica- O
tion O
authority O
( O
CA O
) O
under O
Entrust O
and O
GTE O
CyberTrust O
, O
has O
issued O
22 O
certifi- O
cates O
with O
weak O
512 O
bit O
keys O
. O

These O
weak O
encryption O
keys O
, O
when O
broken O
, O
could O
allow O
an B-Entity
attacker I-Entity
to O
use B-Action
the B-Entity
certificates I-Entity
fraudulently B-Entity
to B-Modifier
spoof B-Entity
content I-Entity
, O
perform B-Entity
phishing I-Entity
attacks I-Entity
, O
or O
perform B-Entity
man­in­the­middle I-Entity
attacks I-Entity
against I-Entity
all I-Entity
Web I-Entity
browser I-Entity
users I-Entity
including I-Entity
users I-Entity
of I-Entity
Internet I-Entity
Explorer I-Entity
. O

While O
this O
is O
not O
a O
vulnerability O
in O
a O
Microsoft O
product O
, O
this O
issue O
affects O
all O
supported O
releases O
of O
Microsoft O
Windows O
. O

There O
is O
no O
indication O
that O
any O
certificates O
were O
issued O
fraudulently O
. O

Instead O
, O
cryptographically O
weak O
keys O
have O
allowed O
some O
of O
the O
certificates O
to O
be O
dupli- O
cated O
and O
used O
in O
a O
fraudulent O
manner O
. O

Microsoft O
is O
providing O
an O
update O
for O
all O
supported O
releases O
of O
Microsoft O
Windows O
that O
revokes O
the O
trust O
in O
DigiCert O
Sdn O
. O

Bhd O
. O

The O
update O
revokes O
the O
trust O
of O
the O
following O
two O
intermediate O
CA O
certificates O
: O
Digisign O
Server O
ID O
– O
( O
Enrich O
) O
, O
issued O
by O
Entrust.net O
Certification O
Authority O
( O
2048 O
) O
Digisign O
Server O
ID O
( O
Enrich O
) O
, O
issued O
by O
GTE O
CyberTrust O
Global O
Root O
'' O
From O
Mozilla O
's O
2011 O
response O
: O
'' O
While O
there O
is O
no O
indication O
they O
were O
issued O
fraudulently O
, O
the O
weak O
keys O
have O
allowed O
the O
certificates O
to O
be O
compromised O
. O

Furthermore O
, O
certificates O
from O
this O
CA O
contain O
several O
technical O
issues O
. O

They O
lack O
an O
EKU O
extension O
specifying O
their O
intended O
usage O
and O
they O
have O
been O
issued O
without O
revocation O
information O
. O

'' O
From O
Entrust O
's O
response O
: O
'' O
There O
is O
no O
evidence O
that O
the O
Digicert O
Malaysia O
certificate O
authorities O
have O
been O
compromised O
. O

'' O
Here O
are O
some O
notes O
on O
the O
costs O
and O
technical O
requirements O
of O
attacking O
these O
certificates O
. O

The O
computing O
power O
required O
to O
crack O
and O
factor O
an O
RSA O
512 O
bit O
key O
was O
$ O
5000 O
and O
the O
period O
of O
time O
required O
was O
about O
2 O
weeks O
. O

( O
see O
http O
: O
//lukenotricks O
. O

blogspot.co.at/2010/03/rsa­512­factoring­service­two­weeks.html O
) O
In O
October O
2012 O
, O
Tom O
Ritter O
reported O
that O
it O
would O
cost O
about O
$ O
120­- O
$ O
150 O
, O
per- O
haps O
even O
as O
little O
as O
$ O
75 O
. O

Going O
even O
further O
back O
, O
there O
was O
much O
discussion O
about O
the O
technical O
meth- O
ods O
of O
cracking O
these O
keys O
: O
DJ O
Bernstein O
's O
2001 O
paper O
on O
building O
a O
machine O
reducing O
the O
cost O
of O
integer O
factorization O
with O
Number O
Field O
Sieve O
techniques O
, O
breaking O
1024 O
bit O
RSA O
keys O
. O

RSA O
's O
reaction O
and O
2002 O
statement O
on O
whether O
or O
not O
1024 O
bit O
RSA O
keys O
are O
broken O
: O
'' O
NIST O
offered O
a O
table O
of O
proposed O
key O
sizes O
for O
discussion O
at O
its O
key O
man- O
agement O
workshop O
in O
November O
2001 O
[ O
7 O
] O
. O

For O
data O
that O
needs O
to O
be O
protected O
no O
later O
than O
the O
year O
2015 O
, O
the O
table O
indicates O
that O
the O
RSA O
key O
size O
should O
be O
at O
least O
1024 O
bits O
. O

For O
data O
that O
needs O
to O
be O
protected O
longer O
, O
the O
key O
size O
should O
be O
at O
least O
2048 O
bits O
. O

'' O
Recent O
Tapaoux O
attacks O
and O
backdoors O
include O
malware O
signed O
with O
strong O
SHA1/RSA O
2048 O
bit O
certificates O
, O
suggesting O
certificate O
theft O
. O

One B-Entity
of I-Entity
the I-Entity
most I-Entity
interesting I-Entity
components I-Entity
that I-Entity
we I-Entity
discovered I-Entity
as I-Entity
a I-Entity
part I-Entity
of I-Entity
this I-Entity
cam- I-Entity
paign I-Entity
was B-Action
the B-Entity
use I-Entity
of I-Entity
a I-Entity
digitally­signed I-Entity
advanced I-Entity
keylogger I-Entity
. O

It O
is O
clean O
, O
well­written O
, O
kernel O
level O
malcode O
. O

The O
languages O
of O
its O
strings O
are O
a O
mix O
of O
English O
and O
Korean O
. O

It O
is O
signed O
with O
the O
familiar O
'' O
belinda.jablonski O
@ O
syniverse.com O
'' O
digital O
certificate O
. O

This B-Entity
keylogger I-Entity
is B-Action
dropped I-Action
by B-Modifier
code B-Entity
running I-Entity
within I-Entity
svchost.exe I-Entity
on I-Entity
WinXP I-Entity
SP3 I-Entity
, O
which O
maintains O
an O
interesting O
debug O
string O
: O
It O
probably O
was O
developed O
as O
a O
part O
of O
a O
mid-to-late O
2009 O
project O
: O
e O
: O
\project\2009\x\totalsource\32bit\ndiskpro\src\ioman.c O
This B-Entity
driver I-Entity
package I-Entity
is B-Action
built I-Action
to B-Modifier
resemble B-Entity
a I-Entity
legitimate I-Entity
low-level I-Entity
Microsoft I-Entity
system I-Entity
device I-Entity
. O

It B-Entity
is B-Action
installed I-Action
as B-Modifier
a B-Entity
system I-Entity
kernel I-Entity
driver I-Entity
'' I-Entity
Ndiskpro I-Entity
'' I-Entity
service I-Entity
, O
described O
as O
a O
'' O
Microcode O
Update O
Device O
'' O
. O

It O
is O
slightly O
surprising O
that O
no O
rootkit O
functionality O
hides O
this O
service O
: O
When O
loaded O
, O
the B-Entity
NDISKPRO.SYS I-Entity
driver I-Entity
hooks B-Action
both B-Entity
INT I-Entity
0x01 I-Entity
and I-Entity
INT I-Entity
0xff I-Entity
, O
and O
retrieves B-Action
keystroke B-Entity
data I-Entity
directly B-Modifier
from I-Modifier
port B-Entity
0x60 I-Entity
, I-Entity
the I-Entity
motherboard I-Entity
keyboard I-Entity
con- I-Entity
troller I-Entity
itself I-Entity
. O

It O
buffers O
, O
then O
communicates O
logged O
user O
data O
to O
the O
running O
user O
mode O
component O
. O

This B-Entity
component I-Entity
then O
encrypts B-Action
and O
writes B-Action
the B-Entity
retrieved I-Entity
values I-Entity
ondisk I-Entity
to B-Modifier
a B-Entity
randomly I-Entity
named I-Entity
.tmp I-Entity
, I-Entity
file I-Entity
like I-Entity
ffffz07131101.tmp I-Entity
. O

This O
file O
is O
located O
in O
the O
same O
directory O
as O
the B-Entity
original I-Entity
dropper I-Entity
, O
which O
maintains B-Action
persistence B-Entity
across B-Modifier
reboots B-Entity
with B-Modifier
a B-Entity
simple I-Entity
addition I-Entity
to I-Entity
the I-Entity
HKCU I-Entity
run I-Entity
key I-Entity
. O

This B-Entity
keylogger I-Entity
module I-Entity
encrypts B-Action
and O
stores B-Action
gathered B-Entity
data I-Entity
in B-Modifier
a B-Entity
log I-Entity
file I-Entity
, O
as O
men- O
tioned O
previously O
. O

Its O
encryption O
algorithm O
is O
similar O
to O
RC4 O
. O

The O
interesting O
part O
is O
that O
the O
module O
randomly O
generates O
the O
key O
and O
stores O
it O
in O
an O
unexpected O
place O
: O
in O
the O
middle O
of O
the O
log O
file O
name O
. O

Hence O
, O
the O
numeric O
part O
of O
the O
filename O
is O
used O
as O
a O
seed O
for O
the O
pseudorandom O
number O
generator O
. O

The O
rand O
function O
is O
statically O
linked O
to O
ensure O
same O
results O
on O
different O
computers O
. O

The O
Darkhotel O
toolset O
consists O
of O
multiple O
components O
that O
have O
been O
slightly O
modified O
over O
time O
. O

These B-Entity
tools I-Entity
are B-Action
dropped I-Action
by O
hotel B-Entity
installers I-Entity
spoofing B-Action
legiti- B-Entity
mate I-Entity
software I-Entity
installers I-Entity
, O
bound B-Action
within B-Modifier
torrent B-Entity
bundles I-Entity
, O
or O
dropped B-Action
by O
exploits B-Entity
or O
hypertext B-Action
linked I-Action
from B-Modifier
spear-phishing B-Entity
emails I-Entity
. O

More B-Entity
advanced I-Entity
tools I-Entity
, I-Entity
like I-Entity
the I-Entity
keylogger I-Entity
decribed I-Entity
above I-Entity
, O
are B-Action
later I-Action
downloaded I-Action
to B-Modifier
the B-Entity
victim I-Entity
system I-Entity
by O
one B-Entity
of I-Entity
these I-Entity
implants I-Entity
. O

In O
a O
recent O
case O
, O
word B-Entity
docs I-Entity
embed- B-Action
ded I-Action
with B-Modifier
0-day B-Entity
flash I-Entity
swf I-Entity
files I-Entity
either O
dropped B-Action
these B-Entity
backdoors I-Entity
or O
downloaded B-Action
and O
executed B-Action
backdoors B-Entity
from B-Modifier
remote B-Entity
web I-Entity
servers I-Entity
. O

These B-Entity
tools I-Entity
pull B-Action
down I-Action
the B-Entity
keylog- I-Entity
ger I-Entity
, O
steal B-Action
information B-Entity
from B-Modifier
the B-Entity
system I-Entity
, O
or O
download B-Action
other B-Entity
tools I-Entity
. O

The O
most O
interesting O
behaviors O
of O
these O
components O
include O
This O
module O
is O
quite O
small O
( O
27Kb O
) O
and O
comes O
as O
a O
part O
of O
WinRar B-Entity
SFX I-Entity
file I-Entity
that O
drops B-Action
and O
starts B-Action
the B-Entity
module I-Entity
from B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\Microsoft\Crypto\DES64v7\msieckc.exe I-Entity
. O

This B-Entity
module I-Entity
is O
designed O
to O
update B-Action
malicious B-Entity
components I-Entity
through B-Modifier
recurring B-Entity
checks I-Entity
at I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

It B-Entity
is O
also O
capable O
of O
removing B-Action
some B-Entity
older I-Entity
components I-Entity
, O
the O
names O
of O
which O
are O
hardcoded O
in O
the O
body O
of O
the O
malware O
. O

The B-Entity
module I-Entity
adds B-Action
autorun B-Entity
registry I-Entity
settings I-Entity
to B-Modifier
enable B-Entity
an I-Entity
automatic I-Entity
start I-Entity
during I-Entity
system I-Entity
boot I-Entity
. O

One B-Entity
of I-Entity
the I-Entity
most I-Entity
interesting I-Entity
functions I-Entity
of I-Entity
this I-Entity
executable I-Entity
is B-Action
its B-Entity
unusual I-Entity
delay I-Entity
and I-Entity
persistence I-Entity
. O

If O
a O
special O
file O
exists O
on O
the O
system O
, O
the O
module O
will O
not O
start O
calling O
back O
to O
C O
& O
C O
server O
until O
the O
special O
file O
is O
180 O
days O
old O
. O

So O
, O
if O
some O
other O
critical O
malicious O
component O
was O
removed O
during O
this O
period O
, O
current B-Entity
module I-Entity
backs B-Action
up I-Action
and I-Action
restores I-Action
access B-Entity
to I-Entity
the I-Entity
system I-Entity
within I-Entity
6 I-Entity
months I-Entity
. O

The B-Entity
component I-Entity
gathers B-Action
system B-Entity
information I-Entity
and O
sends B-Action
it B-Entity
to B-Modifier
the B-Entity
Darkhotel I-Entity
com- I-Entity
mand I-Entity
and I-Entity
control I-Entity
servers I-Entity
as O
detailed O
in O
Appendix O
D. O
This O
module O
is O
relatively O
large O
( O
455Kb O
) O
and O
comes O
as O
a O
part O
of O
a B-Entity
WinRar I-Entity
SFX I-Entity
file I-Entity
that O
drops B-Action
and O
starts B-Action
the B-Entity
module I-Entity
from B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\Microsoft\Display\DmaUp3 I-Entity
. I-Entity
exe I-Entity
. O

The O
main O
purpose O
of O
the B-Entity
module I-Entity
is O
to O
collect B-Action
various B-Entity
secrets I-Entity
stored I-Entity
on I-Entity
a I-Entity
lo- I-Entity
cal I-Entity
system I-Entity
and O
upload B-Action
them B-Entity
to B-Modifier
Darkhotel B-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
: O
This B-Entity
module I-Entity
is O
designed O
to O
terminate B-Action
itself B-Entity
on B-Modifier
Windows B-Entity
with I-Entity
the I-Entity
system I-Entity
de- I-Entity
fault I-Entity
codepage I-Entity
set I-Entity
to I-Entity
Korean I-Entity
. O

This O
malware O
is O
220Kb O
in O
size O
. O

It O
was O
built O
as O
MFC O
framework O
application O
with O
a B-Entity
lot I-Entity
of I-Entity
extra I-Entity
calls I-Entity
that O
should O
have O
complicated B-Action
the B-Entity
analysis I-Entity
of I-Entity
the I-Entity
sample I-Entity
. O

It B-Entity
mim- B-Action
ics I-Action
a B-Entity
GUI I-Entity
desktop I-Entity
application I-Entity
but O
it O
does O
not O
create O
any O
visible O
windows O
or O
dialogs O
to O
interact O
with O
local O
users O
. O

The B-Entity
Trojan I-Entity
collects B-Action
data B-Entity
about B-Modifier
the B-Entity
system I-Entity
and O
anti­ B-Entity
malware I-Entity
software I-Entity
installed I-Entity
on I-Entity
it I-Entity
, O
and O
uploads B-Action
that B-Entity
data I-Entity
to B-Modifier
Darkhotel B-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
. O

More O
technical O
details O
are O
provided O
in O
Appendix O
D. O
This O
malware O
is O
63kb O
in O
size O
. O

It B-Entity
is B-Action
bound I-Action
to B-Modifier
a B-Entity
variety I-Entity
of I-Entity
other I-Entity
software I-Entity
packages I-Entity
that I-Entity
vary I-Entity
in I-Entity
name I-Entity
, O
but O
the O
host O
package O
is O
consistently O
detected O
as O
'' O
Virus.Win32 O
. O

Pioneer.dx O
'' O
. O

It B-Entity
drops B-Action
the B-Entity
igfxext.exe I-Entity
'' I-Entity
selective I-Entity
infector I-Entity
'' I-Entity
component I-Entity
to B-Modifier
disk B-Entity
and O
runs B-Action
it B-Entity
. O

This B-Entity
component I-Entity
is O
a O
virus O
, O
and O
is O
used O
to O
selectively O
infiltrate B-Action
into B-Modifier
other B-Entity
comput- I-Entity
ers I-Entity
via B-Modifier
USB B-Entity
or O
network B-Entity
shares I-Entity
. O

First O
, O
the B-Entity
virus I-Entity
retrieves B-Action
all B-Entity
available I-Entity
disks I-Entity
and O
starting O
from O
disk O
number O
4 O
( O
D O
: O
\ O
) O
to O
disk O
number O
20 O
( O
Z O
: O
\ O
) O
, O
finds B-Action
executable B-Entity
files I-Entity
and O
infects B-Action
them B-Entity
. O

The B-Entity
code I-Entity
simply O
brute B-Action
forces I-Action
the B-Entity
list I-Entity
of I-Entity
mapped I-Entity
removable I-Entity
drives I-Entity
. O

During O
its O
infection O
routine O
, O
the B-Entity
infector I-Entity
changes B-Action
the B-Entity
entrypoint I-Entity
of I-Entity
executable I-Entity
files I-Entity
, O
creates B-Action
an B-Entity
.rdat I-Entity
section I-Entity
, O
and O
inserts B-Action
a B-Entity
small I-Entity
loader I-Entity
in B-Modifier
the B-Entity
section I-Entity
, O
then O
puts B-Action
its B-Entity
main I-Entity
payload I-Entity
in B-Modifier
the B-Entity
overlay I-Entity
. O

Every B-Entity
infected I-Entity
file I-Entity
has B-Action
functionality B-Entity
described I-Entity
in I-Entity
Trojan­Dropper I-Entity
& I-Entity
Injector I-Entity
section I-Entity
, O
so O
it B-Entity
can O
collect B-Action
information B-Entity
about I-Entity
the I-Entity
comput- I-Entity
er I-Entity
, O
send B-Action
it B-Entity
to B-Modifier
the B-Entity
C2 I-Entity
and O
download B-Action
other B-Entity
Darkhotel I-Entity
components I-Entity
as B-Modifier
commanded B-Entity
. O

Observed O
downloaded O
components O
are O
signed O
with O
a O
familiar O
expired O
certificate O
from O
www.esupplychain.com.tw O
, O
issued O
by O
Cybertrust O
SureServer O
CA O
. O

Again O
, O
further O
technical O
details O
are O
provided O
in O
Appendix O
D. O
Almost B-Entity
every I-Entity
backdoor I-Entity
in I-Entity
this I-Entity
set I-Entity
maintains B-Action
an B-Entity
internal I-Entity
campaign I-Entity
code I-Entity
or I-Entity
id I-Entity
, I-Entity
used I-Entity
in I-Entity
initial I-Entity
c2 I-Entity
communications I-Entity
as I-Entity
described I-Entity
above I-Entity
. O

Some O
IDs O
appear O
to O
be O
related O
to O
geographic O
interests O
, O
others O
do O
not O
seem O
obvious O
. O

We O
gathered O
a O
list O
of O
Darkhotel O
campaign O
IDs O
shown O
below O
. O

Internal O
IDs O
and O
c2 O
resources O
overlap O
across O
these O
com- O
ponents O
, O
there O
is O
no O
pattern O
of O
distribution O
according O
to O
connectback O
resources O
. O

The O
most O
common O
id O
is O
'' O
DEXT87 O
'' O
: O
This O
infrastructure O
team O
appears O
to O
employ O
a O
lesser O
skillset O
than O
top O
notch O
campaigns O
, O
maintaining O
weak O
server O
configurations O
with O
limited O
monitoring O
and O
defensive O
reactions O
, O
and O
making O
some O
simple O
mistakes O
. O

However O
, O
they O
are O
ef- O
fective O
at O
maintaining O
a O
fully O
available O
infrastructure O
to O
support O
new O
and O
existing O
infections O
. O

Overall O
, O
victims O
in O
our O
sinkhole O
logs O
and O
KSN O
data O
were O
found O
across O
the O
globe O
, O
with O
the O
majority O
in O
Japan O
, O
Taiwan O
, O
China O
, O
Russia O
, O
Korea O
and O
Hong O
Kong O
. O

The O
following O
C O
& O
C O
domains O
have O
been O
sinkholed O
and O
redirected O
to O
the O
Kaspersky O
Sinkhole O
Server O
Our O
Kaspersky O
Security O
Network O
detected O
Darkhotel O
infections O
across O
thousands O
of O
machines O
, O
mostly O
related O
to O
the O
Darkhotel O
p2p O
campaigns O
. O

These O
geolocation O
estimates O
probably O
provide O
the O
most O
accurate O
picture O
of O
where O
Darkhotel O
activity O
is O
occurring O
. O

Here O
is O
a O
pie O
chart O
to O
better O
visualize O
the O
proportions O
of O
attack O
activity O
throughout O
the O
world O
. O

As O
you O
can O
see O
, O
over O
90 O
% O
of O
it O
occurs O
in O
the O
top O
five O
countries O
: O
Japan O
, O
followed O
by O
Taiwan O
, O
China O
, O
Russia O
and O
Korea O
. O

Because O
the B-Entity
operators I-Entity
very O
actively O
build B-Action
up I-Action
new B-Entity
command I-Entity
and I-Entity
control I-Entity
serv- I-Entity
ers I-Entity
, O
it O
is O
difficult O
to O
sinkhole O
enough O
domains O
to O
get O
an O
accurate O
overall O
picture O
of O
victim O
system O
location O
based O
on O
this O
data O
. O

Also O
, O
many O
researcher O
systems O
are O
connected O
to O
the O
sinkholed O
domains O
. O

However O
, O
this O
graph O
of O
current O
sinkhole O
callbacks O
presents O
a O
low O
confidence O
distribution O
of O
victim O
geolocation O
, O
with O
India O
, O
Japan O
, O
Ireland O
, O
Korea O
, O
China O
and O
Taiwan O
in O
the O
top O
slots O
. O

Removing O
India O
and O
Ireland O
, O
the O
set O
more O
closely O
matches O
our O
KSN O
data O
. O

Many B-Entity
of I-Entity
these I-Entity
c2s I-Entity
maintain B-Action
a B-Entity
common I-Entity
directory I-Entity
path I-Entity
that I-Entity
serves I-Entity
a I-Entity
ddrlog I-Entity
. O

The O
ddrlogs O
appear O
to O
maintain O
callback O
data O
that O
the O
attackers O
want O
to O
set O
aside O
in O
error O
logs O
. O

Many O
of O
the O
callback O
URLs O
have O
errors O
, O
many O
are O
from O
unwanted O
IP O
ranges O
, O
and O
others O
are O
clearly O
unwanted O
researcher O
sandbox O
system O
callbacks O
. O

A O
description O
of O
the O
detailed O
connectback O
URL O
values O
and O
their O
xor/base64 O
encoding O
scheme O
is O
included O
in O
the O
'' O
Interesting O
Malware O
Trojan.Win32.Karba.e O
'' O
technical O
notes O
in O
Appendix O
D. O
The B-Entity
Darkhotel I-Entity
c2 I-Entity
maintain B-Action
these B-Entity
directory I-Entity
structures I-Entity
to B-Modifier
store B-Entity
and I-Entity
serve I-Entity
ddrlog I-Entity
content I-Entity
: O
The O
following O
structures O
appear O
to O
be O
common O
across O
servers O
, O
but O
do O
not O
pro- O
duce O
ddrlog O
and O
do O
not O
maintain O
an O
/error/ O
directory O
: O
Two O
ddrlog O
files O
report O
entries O
starting O
January O
1 O
, O
2009 O
at O
9:16 O
a.m. O
All O
of O
the O
logs O
maintain O
a O
significant O
number O
of O
entries O
, O
almost O
50,000 O
, O
with O
a O
simple O
stamp O
'' O
B O
'' O
or O
'' O
L O
'' O
. O

Those O
records O
are O
formatted O
in O
the O
following O
manner O
: O
Only O
120 O
IP O
addresses O
perform O
the O
'' O
B O
'' O
checkin O
, O
and O
90 O
% O
of O
these O
are O
from O
the O
range O
150.70.97.x O
. O

This O
entire O
range O
is O
owned O
by O
Trend O
Micro O
in O
Tokyo O
, O
JP O
. O

A O
handful O
of O
the O
remaining O
addresses O
, O
like O
222.150.70.228 O
, O
appear O
to O
come O
from O
other O
ranges O
owned O
by O
Trend O
Micro O
in O
JP O
. O

One O
outlier O
comes O
from O
an O
El O
Sal- O
vadoran O
ISP O
, O
and O
another O
is O
connected O
to O
a O
Japanese O
ISP O
. O

Approximately O
20,000 O
IP O
addresses O
perform O
the O
'' O
L O
'' O
checkin O
. O

Other O
ddrlogs O
may O
include O
'' O
A O
'' O
tags O
as O
well O
. O

The O
'' O
A O
'' O
tag O
labels O
unwanted O
checkins O
from O
untargeted O
locations O
, O
like O
Hungary O
and O
Italy O
. O

The O
'' O
B O
'' O
tag O
labels O
unwanted O
checkins O
from O
Trend O
Micro O
IP O
ranges O
. O

The O
'' O
L O
'' O
tag O
labels O
unwanted O
checkins O
from O
a O
variety O
of O
ranges O
, O
but O
includes O
odd O
IP O
like O
the O
loopback O
address O
, O
127.0.0.1 O
, O
clearly O
an O
error O
. O

Entries O
in O
these O
logs O
include O
callback O
URLs O
that O
have O
spaces O
and O
unusual O
charac- O
ters O
that O
do O
not O
conform O
to O
the O
required O
base64 O
character O
dictionary O
. O

Typical O
main O
page O
: O
For O
begatrendstone.com O
, O
we O
have O
the O
following O
directory O
structure O
: O
The B-Entity
group I-Entity
encrypts B-Action
victim B-Entity
data I-Entity
on B-Modifier
their B-Entity
servers I-Entity
with B-Modifier
single B-Entity
user/passkey I-Entity
combi- I-Entity
nations I-Entity
across I-Entity
multiple I-Entity
victims I-Entity
. O

When O
an O
unauthorized O
user O
attempts O
to O
access O
a O
Darkhotel O
web O
interface O
for O
victim O
management O
without O
the O
correct O
passkey O
, O
the O
html O
page O
and O
table O
layout O
renders O
properly O
, O
but O
all O
the O
data O
values O
on O
the O
page O
are O
returned O
as O
garbled O
ciphertext O
. O

New B-Entity
victim I-Entity
systems I-Entity
appear O
to O
be B-Action
systematically I-Action
vetted I-Action
. O

The B-Entity
attackers I-Entity
maintain B-Action
a B-Entity
web I-Entity
interface I-Entity
to B-Modifier
vet B-Entity
these I-Entity
new I-Entity
victim I-Entity
systems I-Entity
. O

The B-Entity
attackers I-Entity
first O
and O
foremost O
list B-Action
and I-Action
sort I-Action
victim B-Entity
systems I-Entity
according B-Modifier
to I-Modifier
their B-Entity
latest I-Entity
c2 I-Entity
check­in I-Entity
. O

Collected O
data O
probably O
is O
presented O
in O
order O
of O
importance O
: O
Here O
is O
an O
example O
of O
one O
of O
these O
web O
pages O
: O
Clearly O
, O
some O
automated O
analysis O
activity O
involving O
researchers O
' O
sandbox O
tools O
are O
filling O
up O
these O
logs O
. O

From O
June O
2013 O
to O
April O
2014 O
( O
approximately O
an O
11 O
month O
period O
) O
, O
in O
only O
15 O
ddrlog O
files O
, O
we O
observe O
almost O
7,000 O
connections O
from O
research O
sandbox O
systems O
. O

The O
network O
connections O
provide O
a1= O
through O
a3= O
values O
identifying O
a O
QEMU O
based O
sandbox O
, O
all O
sourced O
from O
only O
485 O
WAN O
IP O
ad- O
dresses O
. O

Under O
30 O
lan O
IPs O
are O
recorded O
, O
all O
in O
the O
same O
172.16.2.14­126 O
range O
. O

This O
system O
( O
s O
) O
uses O
a O
'' O
Dave O
'' O
user O
account O
and O
'' O
HOME­OFF­D5F0AC O
'' O
Windows O
system O
name O
. O

These O
characteristics O
correspond O
with O
network O
activity O
generated O
by O
GFI O
Soft- O
ware O
's O
'' O
CWsandbox O
'' O
tools O
, O
now O
owned O
by O
'' O
ThreatTrack O
Security O
'' O
. O

For O
the O
past O
seven O
years O
, O
a O
strong O
threat O
actor O
named O
Darkhotel O
, O
also O
known O
as O
Tapaoux O
, O
has O
carried O
out O
a O
number O
of O
successful O
attacks O
against O
a O
wide O
range O
of O
victims O
from O
around O
the O
world O
. O

It O
employs O
methods O
and O
techniques O
which O
go O
well O
beyond O
typical O
cybercriminal O
behavior O
. O

The O
Darkhotel O
crew O
's O
skillset O
allows O
it O
to O
launch O
interesting O
cryptographical O
at- O
tacks O
, O
for O
instance O
factoring O
512 O
bit O
RSA O
keys O
. O

Its O
use O
of O
0-days O
is O
another O
indica- O
tor O
of O
a O
strong O
threat O
actor O
. O

The O
targeting O
of O
top O
executives O
from O
various O
large O
companies O
around O
the O
world O
during O
their O
stay O
at O
certain O
'' O
Dark O
Hotels O
'' O
is O
one O
of O
the O
most O
interesting O
aspects O
of O
this O
operation O
. O

The O
exact O
method O
of O
targeting O
is O
still O
unknown O
- O
for O
instance O
, O
why O
some O
people O
are O
targeted O
while O
others O
are O
not O
. O

The O
fact O
that O
most O
of O
the O
time O
the O
victims O
are O
top O
executives O
indicates O
the O
attackers O
have O
knowledge O
of O
their O
victims O
whereabouts O
, O
including O
name O
and O
place O
of O
stay O
. O

This O
paints O
a O
dark O
, O
dangerous O
web O
in O
which O
unsuspecting O
travelers O
can O
easily O
fall O
. O

While O
the O
exact O
reason O
why O
some O
hotels O
function O
as O
an O
attacker O
vector O
are O
unknown O
, O
certain O
suspicions O
ex- O
ist O
, O
indicating O
possibly O
a O
much O
larger O
compromise O
. O

We O
are O
still O
investigating O
this O
aspect O
of O
the O
operation O
and O
will O
publish O
more O
information O
in O
the O
future O
. O

A O
further O
interesting O
trait O
is O
the O
deployment O
of O
multiple O
types O
of O
campaigns O
, O
both O
targeted O
and O
botnet O
. O

This O
is O
becoming O
more O
and O
more O
common O
on O
the O
APT O
scene O
, O
where O
targeted B-Entity
attacks I-Entity
are O
used O
to O
compromise B-Action
high B-Entity
profile I-Entity
victims I-Entity
and O
botnet B-Entity
style I-Entity
operations I-Entity
are B-Action
used I-Action
for B-Modifier
massive B-Entity
surveillance I-Entity
or O
performing O
other O
tasks O
such O
as O
launching B-Action
DDoS B-Entity
attacks I-Entity
on B-Modifier
hostile B-Entity
parties I-Entity
or O
simply O
upgrading B-Action
victims B-Entity
to B-Modifier
more B-Entity
sophisticated I-Entity
espionage I-Entity
tools I-Entity
. O

We O
expect O
the O
Darkhotel O
crew O
to O
continue O
their O
activities O
against O
DIB O
, O
Govern- O
ment O
and O
NGO O
sectors O
. O

The O
appendix O
released O
with O
this O
paper O
provides O
technical O
indicators O
of O
compromise O
which O
should O
help O
victims O
identify O
the O
malicious O
traffic O
and O
enable O
targets O
to O
protect O
themselves O
better O
against O
attack O
. O

By O
2014 O
, O
the O
number O
of O
Android O
users O
has O
grown O
to O
1.1 O
billion O
and O
the O
number O
of O
Android O
devices O
has O
reached O
1.9 O
billion O
. O

At O
the O
same O
time O
, O
enterprises O
are O
also O
embracing O
Android- O
based O
Bring O
Your O
Own O
Device O
( O
BYOD O
) O
solutions O
. O

For O
example O
, O
in O
Intel O
's O
BYOD O
program O
, O
there O
are O
more O
than O
20,000 O
Android O
devices O
across O
over O
800 O
combinations O
of O
Android O
versions O
and O
hardware O
configurations O
. O

Although O
little O
malware O
has O
been O
found O
in O
Google O
Play O
, O
both O
Android O
apps O
and O
the O
Android O
system O
itself O
contain O
vulnerabilities O
. O

Aggressive B-Entity
ad I-Entity
libraries I-Entity
also O
leak B-Action
the B-Entity
user I-Entity
's I-Entity
private I-Entity
information I-Entity
. O

By O
leveraging O
all O
these O
vulnerabilities O
, O
an B-Entity
attacker I-Entity
can O
conduct B-Action
more B-Entity
targeted I-Entity
attacks I-Entity
, O
which O
we O
call O
'' O
Sidewinder O
Targeted O
Attacks O
. O

'' O
In O
this O
paper O
we O
explain O
the O
security O
risks O
from O
such O
attacks O
, O
in O
which O
an B-Entity
attacker I-Entity
can O
intercept B-Action
and I-Action
use I-Action
private B-Entity
information I-Entity
uploaded I-Entity
from I-Entity
ad I-Entity
libraries I-Entity
to B-Modifier
precisely B-Entity
locate I-Entity
targeted I-Entity
areas I-Entity
such I-Entity
as I-Entity
a I-Entity
CEO I-Entity
's I-Entity
office I-Entity
or I-Entity
specific I-Entity
conference I-Entity
rooms I-Entity
. O

When O
the O
target O
is O
identified O
, O
a O
'' O
Sidewinder O
Targeted O
Attack O
'' O
exploits O
popular O
vulnerabilities O
in O
ad O
libraries O
, O
such O
as O
Javascript-binding-over-HTTP O
or O
dynamic- O
loading-over-HTTP O
, O
etc O
. O

It O
is O
a O
well-known O
challenge O
for O
an O
attacker O
to O
call O
Android O
services O
from O
injected O
native O
code O
that O
does O
n't O
have O
Android O
application O
context O
. O

Here O
, O
we O
explain O
how O
attackers B-Entity
can O
invoke B-Action
Android B-Entity
services I-Entity
for B-Modifier
tasks O
including O
taking B-Entity
photos I-Entity
, O
calling B-Entity
phone I-Entity
numbers I-Entity
, O
sending B-Entity
SMS I-Entity
, O
reading B-Entity
from/ I-Entity
writing I-Entity
to I-Entity
the I-Entity
clipboard I-Entity
, O
etc O
. O

Furthermore O
, O
the B-Entity
attackers I-Entity
can O
exploit B-Action
several B-Entity
Android I-Entity
vulnerabilities I-Entity
to B-Modifier
get B-Entity
valuable I-Entity
private I-Entity
information I-Entity
or O
to B-Modifier
launch B-Entity
more I-Entity
advanced I-Entity
attacks I-Entity
. O

Finally O
, O
we O
show O
that O
this O
threat O
is O
not O
only O
real O
but O
also O
prevalent O
due O
to O
the O
popularity O
of O
Android O
ad O
libraries O
. O

We O
hope O
this O
paper O
kickstarts O
the O
conversation O
on O
how O
to O
better O
protect O
the O
security O
and O
privacy O
in O
third-party O
libraries O
and O
how O
to O
further O
harden O
the O
Android O
security O
framework O
in O
the O
future O
. O

To O
understand O
the O
security O
risks O
brought O
by O
a O
Sidewinder O
Targeted O
Attack O
, O
we O
first O
explain O
one O
possible O
attack O
mechanism O
( O
illustrated O
in O
Figure O
1 O
) O
that O
is O
similar O
to O
that O
of O
Sidewinder O
missiles O
. O

The B-Entity
attacker I-Entity
can O
hijack B-Action
the B-Entity
network I-Entity
where I-Entity
the I-Entity
targeted I-Entity
victim I-Entity
resides I-Entity
. O

Like O
an O
infrared O
homing O
system O
, O
the O
attacker O
then O
seeks O
'' O
emission O
'' O
from O
ad O
libraries O
running O
on O
the O
target O
device O
to O
track O
and O
lock O
on O
it O
. O

Once O
the O
target O
is O
locked O
on O
, O
the O
attacker O
can O
launch O
advanced O
persistent O
attacks O
. O

To O
minimize O
detection O
chances O
, O
the B-Entity
attacker I-Entity
can O
choose B-Action
to B-Modifier
take B-Entity
action I-Entity
on I-Entity
important I-Entity
targets I-Entity
only I-Entity
, O
ignoring O
all O
other O
devices O
. O

In O
later O
sections O
, O
we O
discuss O
attacking O
( O
'' O
warhead O
'' O
) O
and O
targeting O
( O
'' O
homing O
'' O
) O
components O
in O
detail O
and O
show O
how O
a B-Entity
combination I-Entity
of I-Entity
these I-Entity
components I-Entity
can O
launch B-Action
powerful B-Entity
and I-Entity
precise I-Entity
attacks I-Entity
on B-Modifier
target B-Entity
devices I-Entity
. O

Table O
1 O
proposes O
different B-Entity
attacks I-Entity
that O
an B-Entity
attacker I-Entity
can O
launch B-Action
remotely B-Entity
on B-Modifier
target B-Entity
devices I-Entity
through B-Modifier
vulnerable B-Entity
ad I-Entity
libraries I-Entity
. O

Figure O
2 O
shows O
a O
proof-of-concept O
attack O
control O
interface O
. O

This O
attack O
targets O
one O
of O
the O
ad O
libraries O
described O
in O
this O
paper O
. O

The O
security O
risks O
become O
obvious O
by O
looking O
at O
what O
the O
attacker O
can O
do O
with O
this O
control O
interface O
. O

The B-Entity
left I-Entity
panel I-Entity
enables B-Action
the B-Entity
attacker I-Entity
to B-Modifier
command B-Entity
the I-Entity
victim I-Entity
's I-Entity
device I-Entity
, O
including O
uploading B-Action
local B-Entity
files I-Entity
, O
taking B-Action
pictures B-Entity
, O
recording B-Action
audio/video B-Entity
, O
manipulating B-Action
the B-Entity
clipboard I-Entity
, O
sending B-Action
SMS B-Entity
, O
dialing B-Action
numbers B-Entity
, O
implanting B-Action
bootkit B-Entity
, O
or O
installing B-Action
the B-Entity
attacker I-Entity
's I-Entity
apps I-Entity
uploaded I-Entity
to I-Entity
Google I-Entity
Play I-Entity
, O
etc O
. O

The O
right O
panel O
lists O
all B-Entity
information I-Entity
stolen B-Action
from B-Modifier
the B-Entity
victim I-Entity
's I-Entity
device I-Entity
. O

In O
this O
screenshot O
, O
the B-Entity
victim's I-Entity
installed I-Entity
app I-Entity
list I-Entity
, I-Entity
clipboard I-Entity
, I-Entity
a I-Entity
photo I-Entity
taken I-Entity
from I-Entity
the I-Entity
back I-Entity
camera I-Entity
, I-Entity
an I-Entity
audio I-Entity
clip I-Entity
, I-Entity
and I-Entity
a I-Entity
video I-Entity
clip I-Entity
have O
been B-Action
uploaded I-Action
, O
with O
the B-Entity
GPS I-Entity
location I-Entity
intercepted B-Action
from B-Modifier
the B-Entity
ad I-Entity
library I-Entity
. O

The B-Entity
panel I-Entity
also O
pins B-Action
down B-Modifier
the B-Entity
GPS I-Entity
location I-Entity
of I-Entity
the I-Entity
victim's I-Entity
device I-Entity
onto B-Modifier
a B-Entity
Google I-Entity
Map I-Entity
widget I-Entity
. O

Based O
on O
this O
precise O
position O
information O
, O
it O
is O
easy O
to O
identify O
individuals O
or O
groups O
of O
'' O
VIP O
'' O
targets O
by O
which O
offices O
they O
are O
in O
. O

In O
this O
section O
, O
we O
explain O
in O
more O
detail O
the O
risks O
of O
remote O
attacks O
on O
the O
Android O
devices O
. O

Android O
uses O
the O
JavaScript O
binding O
method O
addJavascriptInterface O
to O
enable O
JavaScript O
code O
running O
inside O
a O
WebView O
to O
access O
the O
app O
's O
Java O
methods O
( O
also O
known O
as O
the O
Javascript O
bridge O
) O
. O

However O
, O
it O
is O
widely O
known O
that O
this O
feature O
, O
if O
not O
used O
carefully O
, O
presents O
a O
potential O
security O
risk O
when O
running O
on O
Android O
API O
16 O
( O
Android O
4.1 O
) O
or O
below O
. O

As O
noted O
by O
Google O
: O
'' O
Use O
of O
this O
method O
in O
a O
WebView O
containing O
untrusted O
content O
could O
allow O
an B-Entity
attacker I-Entity
to O
manipulate B-Action
the B-Entity
host I-Entity
application I-Entity
in B-Modifier
unintended B-Entity
ways I-Entity
, O
executing B-Action
Java B-Entity
code I-Entity
with B-Modifier
the B-Entity
permissions I-Entity
of I-Entity
the I-Entity
host I-Entity
application I-Entity
. O

'' O
In O
particular O
, O
if O
an O
app O
running O
on O
Android O
API O
16 O
or O
below O
uses O
the O
JavaScript O
binding O
method O
addJavascriptInterface O
and O
loads O
the O
content O
in O
the O
WebView O
over O
HTTP O
, O
an B-Entity
attacker I-Entity
over I-Entity
the I-Entity
network I-Entity
could O
hijack B-Action
the B-Entity
HTTP I-Entity
traffic I-Entity
( O
e.g. O
, O
through B-Modifier
WiFi B-Entity
or I-Entity
DNS I-Entity
hijacking I-Entity
) O
to B-Modifier
inject B-Entity
malicious I-Entity
content I-Entity
into I-Entity
the I-Entity
WebView I-Entity
and O
to B-Modifier
control B-Entity
the I-Entity
host I-Entity
application I-Entity
. O

Listing O
1 O
is O
a B-Entity
sample I-Entity
Javascript I-Entity
snippet I-Entity
to O
execute B-Action
shell B-Entity
command I-Entity
. O

We O
call O
this O
the O
JavaScript-Binding-Over-HTTP O
( O
JBOH O
) O
vulnerability O
. O

This O
applies O
to O
insecure O
HTTPS O
channels O
as O
well O
. O

If O
an O
app O
containing O
such O
vulnerability O
has O
sensitive O
Android O
permissions O
such O
as O
access O
to O
the O
camera O
, O
a B-Entity
remote I-Entity
attacker I-Entity
could O
exploit O
it O
to O
perform O
sensitive O
tasks O
such O
as O
taking B-Action
photos B-Entity
or O
recording B-Action
video B-Entity
, O
over B-Modifier
the B-Entity
Internet I-Entity
, O
without B-Modifier
consent B-Entity
. O

Based O
on O
the O
official O
data O
in O
June O
2014 O
, O
~60 O
% O
of O
Android O
devices O
are O
still O
running O
API≤16 O
. O

Note O
that O
API O
> O
16 O
platforms O
are O
not O
necessarily O
secure O
. O

If O
the O
app O
is O
targeting O
at O
a O
lower O
API O
level O
, O
Android O
will O
still O
run O
it O
with O
the O
lower O
API O
level O
for O
compatibility O
reasons O
. O

Figure O
3 O
shows O
the O
targeted O
API O
of O
popular O
Google O
Play O
apps O
, O
each O
of O
which O
has O
over O
50,000 O
downloads O
. O

We O
can O
see O
that O
a O
large O
portion O
of O
apps O
are O
targeting O
at O
API≤16 O
. O

Starting O
with O
Android O
4.2 O
( O
API O
> O
16 O
) O
, O
Google O
introduced O
the O
@ O
JavascriptInterface O
anno- O
tation O
to O
explicitly O
designate O
and O
restrict O
which O
public O
Java O
methods O
in O
the O
app O
were O
accessible O
from O
JavaScript O
running O
inside O
a O
WebView O
. O

However O
, O
if O
an O
ad O
library O
uses O
the O
@ O
JavascriptInterface O
annotation O
to O
expose O
security-sensitive O
interfaces O
, O
and O
uses O
HTTP O
to O
load O
content O
in O
the O
WebView O
, O
it O
is O
vulnerable O
to O
attacks O
where O
an B-Entity
attacker I-Entity
over I-Entity
the I-Entity
network I-Entity
could O
inject B-Action
malicious B-Entity
content I-Entity
into B-Modifier
the B-Entity
WebView I-Entity
to B-Modifier
misuse B-Entity
the I-Entity
interfaces I-Entity
exposed I-Entity
through I-Entity
the I-Entity
JS I-Entity
binding I-Entity
annotation I-Entity
. O

We O
call O
these O
exposed O
JS O
binding O
annotation O
interfaces O
'' O
JS O
Sidedoors O
. O

'' O
For O
example O
, O
we O
found O
a O
list O
of O
sensitive O
Javascript O
interfaces O
that O
are O
publicly O
ex- O
posed O
from O
certain O
versions O
of O
a O
real-world O
ad O
library O
: O
createCalendarEvent O
, O
makeCall O
, O
postToSocial O
, O
sendMail O
, O
sendSMS O
, O
takeCameraPicture O
, O
getGalleryImage O
, O
registerMicListener O
, O
etc O
. O

Given O
that O
this O
ad O
library O
loads O
ads O
using O
HTTP O
, O
if O
the O
host O
app O
has O
the O
corresponding O
permissions O
( O
e.g. O
, O
CALL O
PHONE O
) O
, O
attackers B-Entity
over I-Entity
the I-Entity
network I-Entity
can O
abuse O
these O
interfaces O
to O
do O
malicious O
things O
( O
e.g. O
, O
utilizing B-Action
the B-Entity
makeCall I-Entity
interface I-Entity
to B-Modifier
dial B-Entity
phone I-Entity
numbers I-Entity
without I-Entity
the I-Entity
user I-Entity
's I-Entity
consent I-Entity
) O
. O

Similar O
to O
JBOH O
, O
DEX O
loading O
over O
HTTP O
or O
insecure O
HTTPS O
( O
DLOH O
) O
is O
another O
serious O
issue O
raised O
by O
ad O
libraries O
. O

If O
the B-Entity
attackers I-Entity
can O
hijack B-Action
the B-Entity
communication I-Entity
channels I-Entity
and O
inject B-Action
malicious B-Entity
DEX I-Entity
files I-Entity
, O
they B-Entity
can O
then O
control B-Action
the B-Entity
behaviors I-Entity
of I-Entity
the I-Entity
victim I-Entity
apps I-Entity
. O

After O
getting B-Action
local B-Entity
access I-Entity
, O
the B-Entity
attacker I-Entity
can O
upload B-Action
private B-Entity
and I-Entity
sensitive I-Entity
files I-Entity
from B-Modifier
the B-Entity
victim I-Entity
's I-Entity
device I-Entity
, O
or O
modify B-Action
files B-Entity
that I-Entity
the I-Entity
host I-Entity
app I-Entity
can I-Entity
write I-Entity
to I-Entity
( O
e.g. O
, O
the O
directory O
of O
the O
host O
app O
and O
SD O
Card O
with O
FAT O
file O
system O
) O
. O

To O
launch O
more O
sophisticated O
attacks O
like O
sending B-Action
SMS B-Entity
or O
taking B-Action
pictures B-Entity
, O
the B-Entity
attackers I-Entity
may O
use O
Java O
reflection O
to O
call O
other O
APIs O
from O
the O
Javascript O
bridge O
. O

It O
appears O
this O
method O
makes O
sending O
SMS O
easy O
. O

However O
, O
some O
other O
operations O
require O
Android O
context O
or O
registering O
Java O
callbacks O
. O

Android O
context O
provides O
an O
interface O
to O
the O
global O
information O
about O
an O
app O
's O
environment O
. O

Many O
Android O
functionalities O
, O
especially O
remote O
call O
invocations O
, O
are O
encapsulated O
in O
the O
context O
. O

We O
discuss O
attacks O
requiring O
context O
in O
a O
later O
section O
. O

In O
this O
section O
, O
we O
explain O
attacks O
that O
do O
n't O
need O
Android O
context O
, O
and O
discuss O
their O
security O
risks O
. O

One O
direct O
threat O
posed O
by O
JBOH O
is O
to O
use B-Action
the B-Entity
JBOH I-Entity
shell I-Entity
( O
Listing O
1 O
) O
to B-Modifier
download B-Entity
exe- I-Entity
cutables I-Entity
and O
use B-Action
them B-Entity
to B-Modifier
root B-Entity
the I-Entity
device I-Entity
. O

Commercial O
one-touch O
root O
apps O
claim O
they O
can O
root O
more O
than O
1,000 O
brands O
( O
> O
20,000 O
models O
) O
. O

towelroot O
, O
which O
exploits O
a O
bug O
found O
recently O
in O
Linux O
kernel O
, O
claims O
that O
it O
can O
root O
most O
new O
devices O
released O
before O
June O
2014 O
. O

Thus O
, O
as O
long O
as O
attackers O
can O
get O
the O
JBOH O
shell O
, O
they B-Entity
have O
the O
tools O
to O
obtain B-Action
root B-Entity
on B-Modifier
most B-Entity
Android I-Entity
phone I-Entity
models I-Entity
. O

Even O
if O
the O
attackers O
ca O
n't O
obtain O
root O
, O
they B-Entity
can O
attempt B-Action
ptrace B-Entity
to B-Modifier
control B-Entity
the I-Entity
host I-Entity
app I-Entity
. O

Although O
only O
processes O
with O
root O
privilege O
can O
ptrace O
others O
, O
child O
processes O
are O
able O
to O
ptrace O
their O
parents O
. O

Because O
the O
shell O
launched O
from O
the O
Javascript O
bridge O
is O
a O
child O
process O
of O
the O
host O
app O
, O
it O
can O
ptrace O
the O
host O
app O
's O
process O
. O

Note O
that O
only O
apps O
with O
android O
: O
debuggable O
set O
as O
'' O
true O
'' O
in O
the O
manifest O
can O
be O
ptraced O
, O
which O
limits O
its O
adoption O
. O

Sending O
SMS O
does O
not O
require O
context O
or O
user O
interaction O
. O

A O
simple O
call O
does O
the O
job O
, O
as O
shown O
in O
Listing O
2 O
To O
make B-Action
calls B-Entity
from B-Modifier
the B-Entity
Javascript I-Entity
bridge I-Entity
without B-Modifier
user B-Entity
consent I-Entity
, O
we B-Entity
can O
invoke B-Action
the B-Entity
telephony I-Entity
service I-Entity
to B-Modifier
dial B-Entity
numbers I-Entity
directly I-Entity
via I-Entity
binder I-Entity
, O
as O
shown O
in O
Listing O
3 O
, O
where O
phone O
is O
the O
remote O
Android O
telephony O
service O
and O
the O
number O
2 O
represents O
the O
second O
remote O
call O
. O

s16 O
is O
the O
type O
marker O
represents O
'' O
16 O
bit O
string O
, O
'' O
and O
packageName O
is O
the O
host O
app O
's O
package O
name O
, O
where O
we O
can O
obtain O
from O
the O
information O
posted O
from O
the O
ad O
libraries O
. O

The O
sequence O
number O
of O
the O
remote O
calls O
can O
be O
found O
in O
the O
corresponding O
Android O
Interface O
Definition O
Language O
( O
AIDL O
) O
files O
. O

Many O
other O
Android O
services O
can O
be O
invoked O
in O
the O
same O
way O
, O
including O
sending O
SMS O
As O
mentioned O
, O
it O
is O
more O
convenient O
to O
directly O
obtain O
the O
Android O
context O
via O
the O
Javascript O
bridge O
. O

Code O
in O
Listing O
4 O
, O
for O
example O
, O
is O
an O
easy O
way O
to O
get O
context O
from O
anywhere O
of O
the O
application O
. O

Operations O
like O
taking O
pictures O
and O
recording O
videos O
need O
to O
register O
Java O
callbacks O
. O

The O
attackers O
either O
need O
to O
boot O
a O
Java O
VM O
from O
the O
Javascript O
bridge O
, O
or O
to O
inject O
code O
into O
the O
host O
app O
's O
Java O
VM O
. O

Fortunately O
, O
Android O
Runtime O
offers O
another O
way O
to O
load O
Java O
Native O
Interface O
( O
JNI O
) O
code O
into O
the O
host O
app O
using O
Runtime.load O
( O
) O
. O

As O
shown O
in O
Listing O
5 O
, O
an B-Entity
attacker I-Entity
can O
load B-Action
executables B-Entity
compiled I-Entity
from I-Entity
JNI I-Entity
code I-Entity
. O

Once O
loaded O
, O
the B-Entity
code I-Entity
can O
obtain O
context O
as O
described O
in O
Listing O
4 O
, O
or O
call B-Action
DexClassLoaderload B-Entity
to B-Modifier
inject B-Entity
new I-Entity
classes I-Entity
from I-Entity
the I-Entity
attackers I-Entity
' I-Entity
DEX I-Entity
files I-Entity
to I-Entity
register I-Entity
callbacks I-Entity
to I-Entity
take I-Entity
pictures/ I-Entity
record I-Entity
videos I-Entity
. O

There O
are O
other O
ways O
to O
obtain O
Android O
context O
, O
like O
reflecting O
to O
the O
private O
static O
context O
variable O
of O
WebView O
. O

However O
, O
without O
Java O
VM O
instances O
, O
it O
's O
difficult O
to O
take O
pictures O
and O
record O
videos O
. O

After O
our O
submission O
to O
Black O
Hat O
in O
April O
2014 O
, O
we O
noticed O
that O
MWR O
was O
also O
concurrently O
and O
independently O
working O
on O
this O
issue O
. O

They O
published O
a O
similar O
mechanism O
in O
June O
2014 O
. O

With O
the O
Android O
context O
, O
an B-Entity
attacker I-Entity
can O
monitor B-Action
or I-Action
tamper I-Action
with B-Modifier
the B-Entity
clipboard I-Entity
. O

Android O
users O
may O
perform O
copy-paste O
on O
important O
text O
content O
. O

For O
example O
, O
there O
are O
many O
popular O
password-management O
apps O
in O
Google O
Play O
, O
enabling O
the O
users O
to O
click-and-copy O
passwords O
and O
paste O
them O
into O
login O
forms O
. O

Malicious B-Entity
apps I-Entity
can O
steal B-Action
the B-Entity
passwords I-Entity
if B-Modifier
they B-Entity
can I-Entity
read I-Entity
the I-Entity
contents I-Entity
on I-Entity
clipboard I-Entity
. O

Android O
has O
no O
permissions O
restricting O
apps O
from O
accessing O
the O
global O
clipboard O
. O

Any O
UID O
has O
the O
capability O
to O
manipulate O
clipboard O
via O
the O
API O
calls O
in O
Listing O
6 O
: O
Using O
these O
APIs O
, O
the B-Entity
attackers I-Entity
can O
monitor B-Action
changes B-Entity
to I-Entity
a I-Entity
clipboard I-Entity
and O
transfer B-Action
the B-Entity
clipboard I-Entity
contents I-Entity
to B-Modifier
some B-Entity
remote I-Entity
server I-Entity
. O

They B-Entity
can O
also O
alter B-Action
the B-Entity
clipboard I-Entity
content I-Entity
to B-Modifier
achieve B-Entity
phishing I-Entity
goals I-Entity
. O

For O
example O
, O
the O
user O
may O
copy O
a O
link O
to O
visit O
and O
the B-Entity
background I-Entity
malicious I-Entity
service I-Entity
can O
change B-Action
that B-Entity
link I-Entity
to B-Modifier
a B-Entity
phishing I-Entity
site I-Entity
. O

We O
have O
notified O
Google O
about O
this O
issue O
. O

Android O
Open O
Source O
Project O
( O
AOSP O
) O
classifies O
Android O
permissions O
into O
several O
protec- O
tion O
levels O
: O
'' O
normal O
, O
'' O
'' O
dangerous O
, O
'' O
'' O
system O
, O
'' O
'' O
signature O
'' O
and O
'' O
development O
'' O
, O
, O
. O

Dangerous O
permissions O
'' O
may O
be O
displayed O
to O
the O
user O
and O
require O
confirmation O
before O
pro- O
ceeding O
, O
or O
some O
other O
approach O
may O
be O
taken O
to O
avoid O
the O
user O
automatically O
allowing O
the O
use O
of O
such O
facilities O
. O

'' O
In O
contrast O
, O
normal O
permissions O
are O
automatically O
granted O
at O
installation O
, O
'' O
without O
asking O
for O
the O
user O
's O
explicit O
approval O
( O
though O
the O
user O
always O
has O
the O
option O
to O
review O
these O
permissions O
before O
installing O
) O
'' O
. O

If O
an O
app O
requests O
both O
dangerous O
permissions O
and O
normal O
permissions O
, O
Android O
only O
displays O
the O
dangerous O
per- O
missions O
by O
default O
. O

If O
an O
app O
requests O
only O
normal O
permissions O
, O
Android O
does O
n't O
display O
any O
permission O
to O
the O
user O
. O

We O
have O
found O
that O
certain O
'' O
normal O
'' O
permissions O
have O
dangerous O
security O
impacts O
. O

For O
example O
, O
the B-Entity
attackers I-Entity
can O
manipulate B-Action
Android B-Entity
home I-Entity
screen I-Entity
icons I-Entity
using B-Modifier
two B-Entity
normal I-Entity
permissions I-Entity
: I-Entity
launcher I-Entity
READ I-Entity
SETTINGS I-Entity
and I-Entity
WRITE I-Entity
SETTINGS I-Entity
permissions I-Entity
. O

These O
two O
permissions O
enable O
an O
app O
to O
query O
, O
insert O
, O
delete O
, O
or O
modify O
all O
launcher O
configuration O
settings O
, O
including O
icon O
insertion O
or O
modification O
. O

As O
a O
proof-of-concept O
attack O
scenario O
, O
a B-Entity
malicious I-Entity
app I-Entity
with I-Entity
these I-Entity
two I-Entity
permissions I-Entity
can O
query/insert/ B-Action
alter I-Action
the B-Entity
system I-Entity
icon I-Entity
settings I-Entity
and O
modify B-Action
legitimate B-Entity
icons I-Entity
of I-Entity
some I-Entity
security- I-Entity
sensitive I-Entity
apps I-Entity
, I-Entity
such I-Entity
as I-Entity
banking I-Entity
apps I-Entity
, O
to B-Modifier
a B-Entity
phishing I-Entity
website I-Entity
. O

After O
our O
notification O
, O
Google O
has O
patched O
this O
vulnerability O
in O
Android O
4.4.3 O
and O
has O
released O
the O
patch O
to O
its O
OEM O
partners O
. O

However O
, O
according O
to O
Google O
, O
by O
7 O
July O
2014 O
, O
17.9 O
% O
Android O
devices O
are O
using O
Android O
4.4 O
. O

Given O
that O
Android O
4.4.2 O
and O
below O
has O
this O
vulnerability O
, O
over O
82.1 O
% O
Android O
devices O
are O
vulnerable O
. O

With O
the O
CHANGE O
WIFI O
STATE O
permission O
, O
Android O
processes O
can O
change O
the O
proxy O
settings O
of O
WIFI O
networks O
( O
not O
solely O
the O
currently O
connected O
one O
) O
. O

To O
do O
this O
, O
the O
attacker O
can O
use O
the O
remote O
calls O
exposed O
by O
WifiManager O
to O
obtain O
the O
WifiConfiguration O
objects O
, O
then O
create O
new O
proxySettings O
to O
replace O
to O
a O
corresponding O
field O
. O

Note O
that O
the O
proxySettings O
field O
is O
a O
private O
Java O
field O
not O
intended O
to O
be O
accessed O
by O
other O
processes O
. O

Unfortunately O
, O
the O
flexible O
and O
powerful O
Java O
reflection O
mechanism O
( O
especially O
the O
forName O
( O
) O
, O
getField O
( O
) O
, O
setAccessible O
( O
) O
calls O
) O
exposes O
such O
components O
to O
the O
attackers O
for O
arbitrary O
read O
or O
write O
operations O
. O

Android O
audio O
recording O
via O
the O
MediaRecorder O
APIs O
does O
not O
need O
user O
interaction O
or O
consent O
, O
which O
makes O
it O
easy O
to O
record O
sound O
in O
the O
background O
. O

On O
the O
contrary O
, O
taking O
pictures O
and O
recording O
videos O
are O
more O
challenging O
. O

First O
, O
this O
requires O
registering O
Java O
callbacks O
. O

Second O
, O
Android O
warns O
that O
'' O
Preview O
must O
be O
started O
before O
you O
can O
take O
a O
picture O
'' O
. O

It O
seems O
that O
taking O
pictures O
and O
recording O
videos O
without O
user O
notification O
is O
impossible O
. O

However O
, O
security O
largely O
depends O
on O
the O
correct O
implementation O
and O
enforcing O
a O
flawless O
implementation O
is O
difficult O
. O

On O
some O
of O
the O
popular O
phones O
( O
models O
anonymized O
for O
security O
consideration O
) O
, O
startPreview O
( O
) O
is O
required O
to O
take O
pictures/record O
videos O
; O
However O
, O
it O
's O
highly O
possible O
that O
on O
these O
devices O
takePicture O
( O
) O
fails O
to O
check O
whether O
a O
view O
has O
been O
presented O
to O
the O
user O
. O

Fortunately O
, O
we O
have O
never O
witnessed O
a O
case O
where O
the O
MediaRecorder O
can O
shoot O
videos O
without O
calling O
setPreviewDisplay O
. O

But O
we O
were O
able O
to O
create O
and O
register O
a O
dummy O
SurfaceView O
to O
the O
WindowManager O
, O
which O
made O
taking O
photos O
and O
videos O
possible O
even O
on O
devices O
that O
properly O
checked O
for O
an O
existing O
preview O
. O

With B-Modifier
both B-Entity
the I-Entity
GET I-Entity
ACCOUNTS I-Entity
and I-Entity
the I-Entity
USE I-Entity
CREDENTIALS I-Entity
permissions I-Entity
, O
Android B-Entity
pro- I-Entity
cesses I-Entity
can O
get B-Action
secret B-Entity
tokens I-Entity
of I-Entity
services I-Entity
( I-Entity
e.g. I-Entity
, I-Entity
Google I-Entity
services I-Entity
) I-Entity
from B-Modifier
the B-Entity
AccountManager I-Entity
and O
use B-Action
them B-Entity
to B-Modifier
authenticate B-Entity
to I-Entity
these I-Entity
services I-Entity
. O

We O
verified O
that O
Android B-Entity
apps I-Entity
with I-Entity
these I-Entity
two I-Entity
permissions I-Entity
can O
authenticate B-Action
themselves B-Entity
with B-Modifier
the B-Entity
user I-Entity
's I-Entity
Google I-Entity
account I-Entity
, O
allowing O
access O
to O
Google O
Play O
and O
the O
ability O
send O
app O
installation O
requests O
. O

Through O
the O
Javascript O
bridge O
, O
attackers B-Entity
can O
install B-Action
apps B-Entity
of I-Entity
choice I-Entity
( I-Entity
e.g. I-Entity
, I-Entity
an I-Entity
attacker I-Entity
's I-Entity
phishing I-Entity
app I-Entity
) I-Entity
to B-Modifier
any B-Entity
devices I-Entity
registered I-Entity
in I-Entity
user I-Entity
's I-Entity
account I-Entity
in I-Entity
the I-Entity
background I-Entity
without B-Modifier
user B-Entity
consent I-Entity
. O

Combined O
with O
the O
launcher O
modification O
attack O
introduced O
earlier O
, O
the B-Entity
attackers I-Entity
can O
redirect B-Action
other B-Entity
app I-Entity
icons I-Entity
( I-Entity
e.g. I-Entity
, I-Entity
bank I-Entity
or I-Entity
email I-Entity
app I-Entity
icons I-Entity
) I-Entity
to B-Modifier
the B-Entity
phishing I-Entity
app I-Entity
and O
steal B-Action
the B-Entity
user I-Entity
's I-Entity
login I-Entity
credentials I-Entity
. O

In O
this O
section O
, O
we O
explain O
the O
risks O
of O
victims B-Entity
' I-Entity
devices I-Entity
being B-Action
tracked I-Action
and I-Action
targeted I-Action
through B-Modifier
ad B-Entity
traffic I-Entity
. O

It O
is O
well O
known O
that O
communication O
via O
HTTP O
is O
prone O
to O
hijacking O
and O
data O
tamper- O
ing O
. O

Though O
ad O
libraries O
may O
not O
have O
the O
incentive O
to O
abuse O
users O
' O
private O
and O
sensitive O
data O
, O
this O
is O
not O
the O
case O
with O
the B-Entity
attackers I-Entity
eavesdropping B-Action
or I-Action
hijacking I-Action
the B-Entity
HTTP I-Entity
traffic I-Entity
. O

Switching O
to O
HTTPS O
may O
not O
solve O
this O
issue O
since O
the O
HTTPS O
security O
relies O
on O
a O
flawless O
implementation O
, O
which O
is O
difficult O
. O

For O
example O
, O
there O
are O
cases O
where O
the O
developer O
failed O
( O
intentionally O
or O
unintentionally O
) O
to O
check O
the O
server O
's O
certificate O
. O

We O
found O
that O
some O
of O
the O
most O
popular O
ad O
libraries O
( O
see O
Table O
3 O
) O
have O
this O
issue O
. O

We B-Entity
successfully O
launched B-Action
Man-in-the- B-Entity
Middle I-Entity
( I-Entity
MITM I-Entity
) I-Entity
attacks I-Entity
and O
intercepted B-Action
the B-Entity
data I-Entity
uploaded I-Entity
to I-Entity
the I-Entity
remote I-Entity
server I-Entity
. O

Note O
that O
even O
if O
the O
ad O
libraries O
have O
a O
correct O
and O
rigorous O
implementation O
, O
the O
SSL O
library O
itself O
may O
contain O
serious O
vulnerabilities O
that O
can O
be O
exploited O
by O
MITM O
attacks O
, O
. O

Almost O
every O
ad O
library O
uploads O
local O
information O
from O
Android O
devices O
. O

Based O
on O
our O
observations O
, O
they O
do O
so O
mostly O
for O
purposes O
such O
as O
checking O
for O
platform O
compatibility O
and O
user O
interest O
targeting O
. O

The O
information O
most O
frequently O
uploaded O
includes O
IMEI O
, O
Android O
version O
, O
manufacturer O
, O
Android O
ID O
, O
device O
specification O
, O
carrier O
information O
, O
host O
app O
information O
, O
installed O
app O
list O
, O
etc O
. O

Table O
3 O
lists O
the O
info O
uploaded O
from O
the O
top O
five O
popular O
ad O
libraries O
. O

Listing O
7 O
is O
a O
captured O
packet O
posted O
to O
the O
remote O
ad O
server O
by O
one O
of O
the O
ad O
libraries O
. O

It O
is O
captured O
from O
a O
popular O
Google O
Play O
app O
. O

From O
this O
packet O
we O
can O
tell O
the O
device O
's O
screen O
density O
( O
d-device-screen-density O
) O
, O
screen O
size O
( O
d-device- O
screen-size O
) O
, O
host O
app O
's O
pack- O
age O
name O
( O
u-appBId O
) O
, O
host O
app O
's O
name O
( O
u-appDNM O
) O
1 O
, O
host O
app O
's O
version O
( O
u-appVer O
) O
, O
user O
agent O
( O
h-user-agent O
) O
, O
localization O
( O
d-localization O
) O
, O
mobile O
network O
type O
( O
d-netType O
) O
, O
screen O
orientation O
( O
d-orientation O
) O
, O
and O
GPS O
location O
( O
u-latlong-accu O
) O
. O

The O
most O
important O
infor- O
mation O
is O
the O
GPS O
location O
, O
where O
the O
victim O
's O
latitude O
, O
longitude O
and O
the O
location O
precision O
are O
shown O
. O

It O
is O
reasonable O
for O
an O
ad O
to O
obtain O
this O
information O
to O
improve O
the O
ad-serving O
experience O
. O

However O
, O
with O
this O
information O
, O
an B-Entity
attacker I-Entity
can O
precisely O
locate B-Action
the B-Entity
victim I-Entity
and O
acquire B-Action
the B-Entity
device I-Entity
's I-Entity
specifications I-Entity
. O

To O
locate O
victims O
effectively O
, O
an O
attacker O
needs O
to O
monitor O
large-scale O
network O
traffic O
containing O
such O
private O
information O
. O

Unfortunately O
, O
several B-Entity
well-known I-Entity
attacks I-Entity
can O
be O
used O
to O
achieve B-Action
large-scale B-Entity
monitoring I-Entity
, O
including O
DNS O
hijacking O
, O
BGP O
hijacking O
, O
and O
ARP O
hijacking O
in O
IDC O
. O

In O
this O
context O
, O
DNS B-Entity
hijacking I-Entity
is O
done O
to O
subvert B-Action
the B-Entity
resolution I-Entity
of I-Entity
Domain I-Entity
Name I-Entity
System I-Entity
( I-Entity
DNS I-Entity
) I-Entity
queries I-Entity
through B-Modifier
modifying B-Entity
the I-Entity
behavior I-Entity
of I-Entity
DNS I-Entity
servers I-Entity
so I-Entity
that I-Entity
they I-Entity
serve I-Entity
fake I-Entity
DNS I-Entity
information I-Entity
. O

DNS O
hijacking O
is O
legally O
and O
maliciously O
used O
in O
many O
situations O
including O
traffic O
management O
, O
phishing O
and O
censorship O
. O

Attackers B-Entity
successfully O
compromised B-Action
many B-Entity
DNS I-Entity
servers I-Entity
, I-Entity
including I-Entity
the I-Entity
ones I-Entity
from I-Entity
Google I-Entity
and I-Entity
Godaddy I-Entity
. O

By B-Modifier
DNS B-Entity
hijacking I-Entity
, O
attackers B-Entity
can O
effectively O
access B-Action
all B-Entity
the I-Entity
traffic I-Entity
to I-Entity
ad I-Entity
servers I-Entity
. O

BGP B-Entity
hijacking I-Entity
takes B-Action
over I-Action
groups B-Entity
of I-Entity
IP I-Entity
addresses I-Entity
, O
corrupting B-Action
Internet B-Entity
routing I-Entity
tables I-Entity
by B-Modifier
breaking B-Entity
BGP I-Entity
sessions I-Entity
or I-Entity
injecting I-Entity
fake I-Entity
BGP I-Entity
information I-Entity
. O

This O
enables O
attackers B-Entity
to O
monitor B-Action
all B-Entity
traffic I-Entity
to I-Entity
specific I-Entity
IPs I-Entity
. O

Historically O
, O
there O
were O
many O
BGP O
hijacking O
attacks O
that O
affected O
YouTube O
, O
DNS O
root O
servers O
, O
Yahoo O
, O
and O
many O
other O
important O
Internet O
services O
. O

ARP B-Entity
hijacking I-Entity
( I-Entity
or I-Entity
spoofing I-Entity
) I-Entity
in I-Entity
IDC I-Entity
is O
done O
to O
hijack B-Action
the B-Entity
traffic I-Entity
to I-Entity
the I-Entity
ad I-Entity
server I-Entity
in I-Entity
the I-Entity
IDC I-Entity
where I-Entity
the I-Entity
ad I-Entity
server I-Entity
locates I-Entity
through I-Entity
fake I-Entity
ARP I-Entity
packets I-Entity
. O

Attackers B-Entity
may O
rent O
servers O
close O
to O
the O
target O
servers O
, O
and O
use B-Action
fake B-Entity
ARP I-Entity
packets I-Entity
to B-Modifier
direct B-Entity
all I-Entity
the I-Entity
traffic I-Entity
to I-Entity
go I-Entity
through I-Entity
the I-Entity
hijacking I-Entity
servers I-Entity
first I-Entity
for I-Entity
monitoring I-Entity
and I-Entity
hijacking I-Entity
. O

ARP B-Entity
hijacking I-Entity
is B-Action
a B-Entity
well-known I-Entity
approach I-Entity
used I-Entity
in I-Entity
network I-Entity
attacks I-Entity
. O

Using B-Modifier
the B-Entity
large-scale I-Entity
traffic I-Entity
intercepted I-Entity
from I-Entity
the I-Entity
above I-Entity
methods I-Entity
, O
attackers B-Entity
can O
iden- B-Action
tify I-Action
potential B-Entity
victims I-Entity
based B-Modifier
on I-Modifier
information B-Entity
leakage I-Entity
such I-Entity
as I-Entity
GPS I-Entity
location I-Entity
described I-Entity
in I-Entity
Sec- I-Entity
tion I-Entity
4.2 I-Entity
. O

After O
that O
, O
they B-Entity
can O
inject B-Action
exploits B-Entity
only B-Modifier
into I-Modifier
the B-Entity
targeted I-Entity
traffic I-Entity
to B-Modifier
launch B-Entity
further I-Entity
attacks I-Entity
. O

Attackers B-Entity
keep B-Action
a B-Entity
low I-Entity
profile I-Entity
by B-Modifier
allowing B-Entity
all I-Entity
other I-Entity
irrelevant I-Entity
network I-Entity
traffic I-Entity
to I-Entity
pass I-Entity
without I-Entity
being I-Entity
modified I-Entity
. O

We O
used O
the O
FireEye O
Mobile O
Threat O
Prevention O
( O
MTP O
) O
engine O
to O
analyze O
all O
of O
the O
~73,000 O
popular O
apps O
from O
Google O
Play O
with O
more O
than O
50,000 O
downloads O
, O
and O
identified O
93 O
ad O
libraries O
. O

The O
detailed O
ad O
library O
inclusion O
statistics O
are O
shown O
in O
Figure O
4 O
. O

Seventy-one O
% O
of O
the O
apps O
contain O
at O
least O
one O
ad O
library O
, O
35 O
% O
have O
at O
least O
two O
ad O
libraries O
, O
and O
22.25 O
% O
include O
at O
least O
three O
ad O
libraries O
. O

The O
largest O
ad O
inclusion O
number O
is O
35 O
. O

Since O
Google O
is O
cautious O
about O
the O
security O
of O
the O
products O
it O
directly O
controls O
, O
we O
exclude O
Google O
Ad O
from O
the O
following O
discussion O
. O

For O
security O
considerations O
, O
in O
this O
paper O
we O
anonymize O
the O
names O
of O
the O
other O
92 O
ad O
libraries O
, O
using O
Ad1 O
, O
Ad2 O
, O
... O

, O
Ad92 O
to O
refer O
to O
them O
, O
where O
the O
subscripts O
represent O
the O
rankings O
of O
how O
many O
apps O
include O
the O
ad O
libraries O
. O

The O
top O
five O
popular O
ad O
libraries O
' O
inclusion O
and O
download O
statistics O
are O
listed O
in O
Table O
2 O
. O

We O
analyzed O
the O
92 O
ad O
libraries O
found O
in O
the O
popular O
Google O
Play O
apps O
, O
and O
summa- O
rized O
the O
communication O
channel O
vulnerabilities O
in O
Table O
3 O
. O

Combined O
with O
the O
uploaded O
information O
column O
we O
can O
learn O
about O
the O
data O
the O
attackers O
can O
obtain O
. O

Fifty-seven O
of O
the O
92 O
ad O
libraries O
in O
the O
popular O
Google O
Play O
apps O
have O
the O
JBOH O
issue O
. O

Specifically O
, O
four O
of O
the O
top O
five O
ad O
libraries O
are O
subject O
to O
this O
problem O
( O
shown O
in O
Table O
2 O
) O
. O

Seven O
of O
the O
92 O
ad O
libraries O
are O
prone O
to O
DLOH O
attacks O
. O

Particularly O
, O
some O
versions O
of O
Ad5 O
in O
Table O
3 O
have O
this O
problem O
. O

The O
affected O
Google O
Play O
apps O
number O
and O
the O
accumulated O
download O
counts O
are O
listed O
in O
Table O
4 O
. O

In O
the O
current O
golden O
age O
of O
Android O
ad O
libraries O
, O
Sidewinder B-Entity
Targeted I-Entity
Attacks I-Entity
can O
target B-Action
victims B-Entity
using B-Modifier
info B-Entity
leakage I-Entity
and I-Entity
other I-Entity
vulnerabilities I-Entity
of I-Entity
ad I-Entity
libraries I-Entity
to B-Modifier
get B-Entity
valuable I-Entity
, I-Entity
sensitive I-Entity
information I-Entity
. O

Millions O
of O
users O
are O
still O
under O
the O
threat O
of O
Sidewinder O
Targeted O
Attacks O
. O

First O
we O
need O
to O
improve O
the O
security O
and O
privacy O
protection O
of O
ad O
libraries O
. O

For O
example O
, O
we O
encourage O
ad O
libraries O
' O
publishers O
to O
use O
HTTPS O
with O
proper O
SSL O
certificate O
validation O
, O
and O
to O
properly O
encrypt O
network O
traffic O
. O

They O
also O
need O
to O
be O
cautious O
about O
which O
privileged O
interfaces O
are O
exposed O
to O
the O
ad O
providers O
, O
in O
case O
of O
malicious B-Entity
ads I-Entity
or I-Entity
attackers I-Entity
hijacking B-Action
the B-Entity
communication I-Entity
channels I-Entity
. O

Meanwhile O
, O
Google O
itself O
needs O
to O
further O
harden O
the O
security O
framework O
. O

This O
may O
prove O
difficult O
because O
: O
1 O
. O

Android O
is O
a O
complex O
system O
. O

Any O
sub- O
component O
's O
vulnerability O
may O
impact O
the O
security O
of O
the O
whole O
system O
. O

Fragmentation O
makes O
the O
situation O
even O
more O
challenging O
. O

2 O
. O

The O
trade-off O
between O
usability O
, O
performance O
and O
security O
always O
matters O
, O
and O
market O
demand O
frequently O
dictates O
that O
security O
comes O
last O
. O

Many O
Android O
developers O
do O
not O
even O
understand O
how O
to O
program O
securely O
( O
as O
shown O
in O
the O
JBOH O
issue O
) O
. O

3 O
. O

Many O
security O
patches O
are O
not O
back-ported O
to O
old O
versions O
of O
Android O
( O
like O
the O
launcher O
settings O
problem O
described O
earlier O
) O
, O
even O
though O
older O
versions O
are O
widely O
used O
. O

4 O
. O

There O
is O
always O
information O
asymmetry O
in O
the O
development O
chain O
. O

For O
example O
, O
it O
usually O
takes O
several O
months O
for O
vendors O
to O
apply O
security O
patches O
after O
Google O
releases O
them O
. O

Albeit O
challenging O
, O
we O
hope O
that O
this O
work O
can O
kickstart O
a O
conversation O
, O
both O
on O
improved O
security O
and O
privacy O
protection O
in O
third-party O
libraries O
and O
on O
a O
hardened O
Android O
security O
framework O
. O

FireEye O
has O
invented O
a O
purpose-built O
, O
virtual O
machine-based O
security O
platform O
that O
provides O
real-time O
threat O
protection O
to O
enterprises O
and O
governments O
worldwide O
against O
the O
next O
generation O
of O
cyber O
attacks O
. O

These O
highly O
sophisticated O
cyber O
attacks O
easily O
circumvent O
traditional O
signature-based O
defenses O
, O
such O
as O
next-generation O
firewalls O
, O
IPS O
, O
anti-virus O
, O
and O
gateways O
. O

The O
FireEye O
Threat O
Prevention O
Platform O
provides O
real-time O
, O
dynamic O
threat O
protection O
without O
the O
use O
of O
signatures O
to O
protect O
an O
organization O
across O
the O
primary O
threat O
vectors O
and O
across O
the O
different O
stages O
of O
an O
attack O
life O
cycle O
. O

The O
core O
of O
the O
FireEye O
platform O
is O
a O
virtual O
execution O
engine O
, O
complemented O
by O
dynamic O
threat O
intelligence O
, O
to O
identify O
and O
block O
cyber O
attacks O
in O
real O
time O
. O

FireEye O
has O
over O
1,900 O
customers O
across O
more O
than O
60 O
countries O
, O
including O
over O
130 O
of O
the O
Fortune O
500 O
. O

Thank O
you O
for O
subscribing O
to O
Episode O
16 O
of O
the O
HP O
Security O
Briefing O
. O

In O
this O
edition O
we O
discuss O
the O
cyber O
landscape O
within O
the O
Democratic O
People's O
Republic O
of O
Korea O
. O

The O
Democratic O
People O
's O
Republic O
of O
Korea O
( O
DPRK O
) O
, O
known O
in O
the O
West O
as O
North O
Korea O
, O
is O
a O
unique O
country O
with O
a O
military-focused O
society O
and O
an O
unconventional O
technology O
infrastructure O
. O

While O
North O
Korea O
was O
formerly O
on O
the O
U.S. O
list O
of O
state O
sponsors O
of O
terrorism O
, O
it O
was O
removed O
in O
2008 O
. O

However O
, O
due O
to O
North O
Korea O
's O
hostility O
toward O
other O
nations O
, O
its O
pursuit O
of O
nuclear O
weapons O
, O
and O
human O
rights O
violations O
against O
its O
own O
citizens O
, O
the O
United O
Nations O
and O
many O
Western O
entities O
have O
placed O
sanctions O
and O
embargoes O
against O
North O
Korea O
. O

For O
example O
, O
U.S. O
export O
laws O
forbid O
the O
sale O
of O
dual-use O
technologies O
, O
or O
those O
that O
can O
be O
used O
or O
repurposed O
for O
both O
civilian O
and O
military O
use O
, O
to O
North O
Korea O
. O

< O
/n O
> O
5 O
< O
/fn O
> O
Additionally O
, O
the O
U.S. O
has O
a O
military O
alliance O
with O
the O
Republic O
of O
Korea O
( O
ROK O
) O
, O
known O
in O
the O
West O
as O
South O
Korea O
, O
North O
Korea O
's O
primary O
target O
of O
conflict O
. O

Due O
to O
North O
Korea O
's O
global O
interactions O
, O
its O
cyber O
warfare O
capabilities O
are O
of O
particular O
interest O
to O
the O
U.S O
. O

According O
to O
a O
2009 O
report O
by O
Major O
Steve O
Sin O
, O
an O
intelligence O
analyst O
at O
U.S O
. O

Forces O
Korea O
, O
North O
Korean O
hackers O
have O
successfully O
penetrated O
U.S. O
defense O
networks O
more O
frequently O
than O
any O
other O
country O
that O
has O
targeted O
U.S. O
defense O
assets O
. O

While O
Major O
Sin O
may O
have O
been O
overly O
optimistic O
about O
North O
Korea O
's O
abilities O
, O
it O
is O
clear O
that O
they O
should O
not O
be O
underestimated O
. O

Frank O
Cilluffo O
, O
co-director O
of O
the O
Cyber O
Center O
for O
National O
and O
Economic O
Security O
at O
George O
Washington O
University O
, O
testified O
before O
Congress O
that O
North O
Korea O
's O
cyber O
capability O
'' O
poses O
an O
important O
'wild O
card O
' O
threat O
, O
not O
only O
to O
the O
United O
States O
but O
also O
to O
the O
region O
and O
broader O
international O
stability… O
'' O
In O
an O
April O
2014 O
testimony O
given O
to O
the O
House O
Armed O
Services O
Committee O
, O
General O
Curtis O
M. O
Scaparrotti O
noted O
that O
'' O
North O
Korea O
remains O
a O
significant O
threat O
to O
United O
States O
' O
interests O
, O
the O
security O
of O
South O
Korea O
, O
and O
the O
international O
community O
due O
to O
its O
willingness O
to O
use O
force O
, O
its O
continued O
development O
and O
proliferation O
of O
nuclear O
weapon O
and O
long- O
range O
ballistic O
missile O
programs O
, O
and O
its O
abuse O
of O
its O
citizens O
' O
human O
rights O
, O
as O
well O
as O
the O
legitimate O
interests O
of O
its O
neighbors O
and O
the O
international O
community O
. O

'' O
Scaparrotti O
stressed O
that O
'' O
While O
North O
Korea O
's O
massive O
conventional O
forces O
have O
been O
declining O
due O
to O
aging O
and O
lack O
of O
resources…North O
Korea O
is O
emphasizing O
the O
development O
of O
its O
asymmetric O
capabilities O
. O

North O
Korea O
's O
asymmetric O
arsenal O
includes…an O
active O
cyber O
warfare O
capability O
. O

'' O
While O
one O
would O
expect O
the O
regime O
's O
digital O
infrastructure O
to O
also O
suffer O
from O
aging O
or O
lack O
of O
resources O
, O
these O
factors O
do O
not O
take O
away O
from O
their O
technical O
abilities O
to O
wage O
cyber O
warfare O
. O

While O
the O
U.S. O
views O
North O
Korea O
's O
cyber O
warfare O
program O
as O
the O
regime O
's O
foray O
into O
modern O
asymmetrical O
warfare O
, O
South O
Korea O
views O
the O
regime O
's O
cyber O
capabilities O
as O
a O
terroristic O
threat O
, O
-a O
build-up O
for O
an O
impending O
multifaceted O
attack O
. O

It O
is O
important O
to O
note O
that O
, O
to O
date O
, O
no O
such O
attack O
has O
occurred O
. O

According O
to O
a O
report O
written O
by O
Captain O
Duk-Ki O
Kim O
, O
Republic O
of O
Korea O
Navy O
officer O
and O
Ph.D. O
'' O
…the O
North O
Korean O
regime O
will O
first O
conduct O
a O
simultaneous O
and O
multifarious O
cyber O
offensive O
on O
the O
Republic O
of O
Korea O
's O
society O
and O
basic O
infrastructure O
, O
government O
agencies O
, O
and O
major O
military O
command O
centers O
while O
at O
the O
same O
time O
suppressing O
the O
ROK O
government O
and O
its O
domestic O
allies O
and O
supporters O
with O
nuclear O
weapons O
. O

'' O
South O
Korea O
's O
view O
of O
North O
Korea O
as O
a O
terroristic O
threat O
may O
be O
an O
attempt O
to O
downgrade O
North O
Korea O
politically O
, O
since O
South O
Korea O
does O
not O
recognize O
the O
regime O
as O
a O
legitimate O
state O
. O

South O
Korean O
reports O
also O
claim O
that O
North O
Korea O
's O
premier O
hacking O
unit O
, O
Unit O
121 O
, O
trails O
Russia O
and O
the O
U.S. O
as O
the O
world O
's O
third O
largest O
cyber O
unit O
. O

While O
this O
claim O
may O
be O
exaggerated O
, O
in O
2012 O
, O
South O
Korean O
reports O
estimated O
North O
Korea O
's O
hacker O
forces O
at O
around O
3000 O
personnel O
. O

In O
a O
July O
2014 O
report O
from O
South O
Korea O
's O
Yonhap O
News O
Agency O
, O
that O
figure O
was O
upgraded O
to O
5900 O
hacker O
elite O
. O

We O
must O
stress O
that O
although O
these O
claims O
have O
not O
been O
corroborated O
, O
South O
Korea O
has O
taken O
the O
regime O
's O
cyber O
threats O
very O
seriously O
and O
is O
reportedly O
training O
5000 O
personnel O
to O
defend O
against O
North O
Korean O
cyber O
attacks O
. O

Obtaining O
details O
on O
North O
Korea O
's O
cyber O
warfare O
capabilities O
is O
not O
an O
easy O
task O
. O

This O
paper O
will O
examine O
the O
known O
cyber O
capabilities O
of O
North O
Korea O
's O
regime O
and O
how O
the O
country O
maintains O
secrecy O
in O
these O
matters O
. O

Through O
information O
obtained O
via O
open O
source O
intelligence O
( O
OSINT O
) O
, O
we O
will O
present O
what O
is O
known O
about O
North O
Korea O
's O
cyber O
warfare O
and O
supporting O
intelligence O
and O
psychological O
operations O
capabilities O
. O

The O
following O
conditions O
proved O
to O
be O
research O
roadblocks O
when O
gathering O
intelligence O
regarding O
North O
Korea O
's O
cyber O
warfare O
capabilities O
: O
 O
Much O
of O
the O
intelligence O
available O
on O
North O
Korea O
is O
dated O
and O
may O
not O
accurately O
reflect O
the O
regime O
's O
current O
capabilities O
. O

 O
Much O
of O
the O
intelligence O
available O
on O
North O
Korea O
comes O
from O
U.S. O
or O
South O
Korean O
military O
or O
agency O
reports O
. O

These O
reports O
omit O
details O
that O
are O
likely O
classified O
, O
such O
as O
specific O
IP O
addresses O
and O
individual O
actor O
information O
. O

 O
While O
South O
Korea O
is O
an O
ally O
of O
the O
United O
States O
, O
its O
reports O
on O
North O
Korean O
cyber O
activity O
potentially O
contain O
incomplete O
or O
biased O
information O
. O

Cultural O
factors O
that O
stem O
from O
a O
history O
of O
tension O
and O
conflict O
between O
the O
two O
nations O
may O
skew O
perception O
and O
make O
objectivity O
difficult O
. O

 O
North O
Korea O
's O
Internet O
infrastructure O
and O
the O
regime O
's O
strict O
control O
over O
its O
use O
ensures O
that O
there O
are O
no O
rogue O
actors O
and O
that O
all O
officially O
sanctioned O
actors O
exercise O
careful O
OPSEC O
and O
PERSEC O
practices O
in O
order O
to O
prevent O
inadvertent O
information O
leaks O
. O

In O
other O
words O
, O
there O
was O
no O
significant O
identifying O
information O
in O
the O
form O
of O
an O
OSINT O
trail O
left O
behind O
by O
the O
actors O
. O

This O
hinders O
collection O
of O
original O
, O
actionable O
threat O
intelligence O
and O
individual O
actor O
attribution O
. O

 O
North O
Korea O
is O
well-isolated O
from O
the O
outside O
world O
, O
and O
its O
strong O
intelligence O
and O
psychological O
operations O
presence O
effectively O
creates O
confusion O
via O
counterintelligence O
and O
disinformation O
about O
the O
regime O
's O
capabilities O
. O

For O
this O
reason O
, O
any O
'' O
official O
'' O
reports O
emanating O
from O
North O
Korea O
must O
be O
taken O
with O
a O
grain O
of O
salt O
. O

This O
also O
hinders O
attempts O
to O
obtain O
original O
, O
actionable O
threat O
intelligence O
. O

In O
order O
for O
Westerners O
to O
understand O
the O
North O
Korean O
mindset O
, O
it O
is O
necessary O
to O
examine O
the O
key O
components O
of O
North O
Korean O
political O
and O
ideological O
thought O
. O

It O
is O
also O
necessary O
to O
provide O
a O
brief O
explanation O
of O
how O
North O
Korea O
and O
South O
Korea O
view O
one O
another O
, O
in O
order O
to O
understand O
the O
basis O
for O
conflict O
between O
the O
two O
. O

North O
Korea O
has O
two O
primary O
ideologies O
that O
provide O
context O
for O
the O
regime O
's O
motivations O
and O
activities O
: O
juche O
( O
ju-cheh O
) O
and O
songun O
( O
sun-goon O
) O
. O

Juche O
is O
the O
official O
political O
ideology O
of O
North O
Korea O
. O

It O
was O
instituted O
in O
1972 O
and O
is O
based O
on O
the O
ideologies O
of O
Kim O
Il-Sung O
, O
the O
founder O
of O
the O
DPRK O
. O

Juche O
emphasizes O
self-reliance O
, O
mastering O
revolution O
and O
reconstruction O
in O
one O
's O
own O
country O
, O
being O
independent O
of O
others O
, O
displaying O
one O
's O
strengths O
, O
defending O
oneself O
, O
and O
taking O
responsibility O
for O
solving O
one O
's O
own O
problems O
. O

North O
Korea O
's O
air-gapped O
intranet O
, O
described O
below O
, O
exemplifies O
this O
philosophy O
in O
the O
country O
's O
cyber O
infrastructure O
. O

The O
juche O
philosophy O
explains O
North O
Korea O
's O
disdain O
for O
outside O
cultural O
and O
political O
influence O
. O

Juche O
challenges O
North O
Koreans O
to O
contribute O
to O
the O
regime O
's O
chaju O
( O
ja-ju O
) O
, O
a O
concept O
of O
national O
sovereignty O
and O
independence O
. O

The O
regime O
's O
greatest O
fear O
is O
internal O
dissent O
and O
resulting O
destabilization O
. O

In O
a O
June O
2014 O
Reddit O
AMA O
session O
, O
Dr. O
Andrei O
Lankov O
, O
an O
expert O
on O
North O
Korean O
culture O
and O
society O
, O
noted O
'' O
there O
are O
also O
serious O
signs O
of O
public O
alienation O
and O
discontent O
. O

And O
I O
can O
not O
rule O
out O
a O
public O
outbreak O
of O
such O
discontent O
in O
the O
near O
future O
. O

Of O
course O
, O
if O
it O
happens O
, O
it O
will O
have O
a O
serious O
impact O
on O
the O
government O
. O

'' O
Despite O
North O
Korea O
's O
strong O
conviction O
in O
juche O
, O
the O
regime O
collaborates O
with O
and O
receives O
support O
from O
other O
nations O
. O

However O
, O
due O
to O
this O
deep-seated O
ideology O
, O
it O
is O
doubtful O
that O
North O
Korea O
fully O
trusts O
these O
apparent O
allies O
. O

Later O
in O
this O
document O
, O
we O
will O
show O
that O
North O
Korea O
relies O
heavily O
on O
China O
for O
Internet O
access O
. O

North O
Korea O
also O
collaborates O
with O
China O
and O
Russia O
to O
train O
its O
cyber O
warriors O
and O
has O
longstanding O
political O
and O
military O
relationships O
with O
several O
nations O
. O

Songun O
is O
North O
Korea O
's O
'' O
military O
first O
'' O
doctrine O
. O

Songun O
emphasizes O
the O
priority O
of O
the O
military O
in O
resource O
allocation O
and O
political O
and O
economic O
affairs O
. O

This O
doctrine O
stems O
from O
the O
belief O
that O
the O
military O
is O
vital O
for O
preservation O
of O
chaju O
. O

Understanding O
songun O
mindset O
gives O
context O
for O
this O
potential O
threat O
actor O
's O
motivations O
. O

According O
to O
a O
2013 O
Congressional O
report O
, O
the O
strategy O
established O
under O
former O
leader O
Kim O
Jong-Il O
focused O
on O
'' O
internal O
security O
, O
coercive O
diplomacy O
to O
compel O
acceptance O
of O
its O
diplomatic O
, O
economic O
and O
security O
interests O
, O
development O
of O
strategic O
military O
capabilities O
to O
deter O
external O
attack O
, O
and O
challenging O
South O
Korea O
and O
the O
U.S.-South O
Korean O
alliance O
. O

'' O
North O
Korea O
's O
songun O
permeates O
the O
lives O
of O
all O
North O
Korean O
citizens O
. O

Article O
58 O
of O
the O
North O
Korean O
Constitution O
states O
that O
the O
nation O
should O
base O
itself O
on O
a O
nationwide O
defense O
system O
that O
includes O
all O
people O
. O

North O
Korea O
, O
with O
a O
population O
of O
25 O
million O
, O
has O
an O
active O
duty O
force O
of O
1.19 O
million O
personnel O
, O
the O
fourth O
largest O
in O
the O
world O
. O

The O
country O
's O
reserve O
and O
paramilitary O
units O
comprise O
7.7 O
million O
additional O
personnel O
. O

In O
other O
words O
, O
over O
a O
third O
of O
the O
country's O
population O
serves O
in O
a O
military O
or O
paramilitary O
capacity O
. O

Some O
North O
Korean O
youth O
aged O
7-13 O
are O
inducted O
into O
the O
Korean O
Children O
's O
Union O
. O

The O
Korean O
Children O
's O
Union O
is O
responsible O
for O
indoctrinating O
youths O
who O
pledge O
to O
build O
up O
their O
strength O
to O
later O
defend O
the O
regime O
. O

Children O
aged O
14-16 O
can O
begin O
military O
training O
as O
members O
of O
the O
Young O
Red O
Guards O
, O
a O
paramilitary O
unit O
. O

Beginning O
at O
age O
17 O
, O
North O
Koreans O
are O
eligible O
to O
join O
the O
Reserve O
Military O
Training O
Unit O
. O

The O
Reserve O
Military O
Training O
Unit O
forms O
the O
core O
of O
North O
Korea O
's O
reserves O
and O
is O
typically O
assigned O
to O
the O
front O
or O
regional O
defense O
in O
wartime O
. O

The O
youngest O
age O
at O
which O
a O
citizen O
can O
be O
conscripted O
for O
active O
duty O
is O
unclear O
; O
reported O
ages O
range O
from O
18-20 O
. O

Youths O
can O
volunteer O
for O
active O
duty O
service O
at O
age O
16 O
or O
17 O
. O

The O
Worker-Peasant O
Militia O
, O
or O
Red O
Guards O
, O
includes O
males O
ages O
17-60 O
and O
unmarried O
females O
ages O
17-30 O
who O
are O
not O
part O
of O
active O
duty O
units O
or O
the O
Reserve O
Military O
Training O
Unit O
. O

The O
regime O
has O
an O
impressive O
number O
of O
conventional O
weapons O
, O
considering O
the O
nation O
's O
small O
land O
area O
and O
population O
size O
. O

According O
to O
statistics O
released O
by O
CNN O
in O
2014 O
, O
North O
Korea's O
ground O
arsenal O
includes O
4100 O
tanks O
, O
2100 O
armored O
vehicles O
, O
and O
8500 O
pieces O
of O
field O
artillery O
. O

The O
regime O
's O
sea O
weaponry O
includes O
70 O
submarines O
, O
420 O
patrol O
combatants O
, O
and O
260 O
amphibious O
landing O
craft O
. O

Their O
airpower O
includes O
730 O
combat O
aircraft O
, O
300 O
helicopters O
, O
and O
290 O
transport O
aircraft O
. O

While O
the O
limits O
of O
the O
regime O
's O
ballistic O
missile O
program O
are O
unknown O
, O
North O
Korea O
is O
thought O
to O
have O
fewer O
than O
100 O
short-range O
missiles O
and O
fewer O
than O
100 O
medium O
to O
long-range O
missiles O
. O

However O
, O
in O
recent O
years O
, O
North O
Korea O
has O
suffered O
oil O
, O
fuel O
, O
electricity O
, O
and O
food O
shortages O
. O

Without O
aid O
from O
another O
entity O
, O
the O
regime O
does O
not O
have O
sufficient O
resources O
to O
maintain O
and O
sustain O
the O
majority O
of O
its O
weapons O
and O
associated O
personnel O
for O
rapid O
deployment O
or O
prolonged O
combat O
. O

Tension O
between O
North O
and O
South O
Korea O
has O
continued O
well O
past O
the O
armistice O
meant O
to O
end O
the O
Korean O
War O
. O

Neither O
nation O
recognizes O
the O
other O
as O
a O
legitimate O
state O
. O

South O
Korea O
's O
constitution O
legally O
defines O
South O
Korean O
territory O
as O
the O
entire O
Korean O
peninsula O
and O
its O
adjacent O
islands O
, O
with O
'' O
North O
Korea O
'' O
being O
a O
part O
of O
South O
Korea O
. O

North O
Korea O
also O
claims O
to O
be O
the O
sole O
government O
of O
the O
Korean O
Peninsula O
. O

Each O
country O
's O
claim O
of O
sovereignty O
and O
refusal O
to O
acknowledge O
the O
other O
as O
a O
legitimate O
state O
creates O
the O
condition O
for O
perpetual O
conflict O
. O

North O
Korea O
's O
negative O
sentiment O
towards O
the O
U.S. O
stems O
from O
two O
major O
factors O
: O
the O
U.S. O
– O
South O
Korea O
military O
alliance O
and O
North O
Korea O
's O
perception O
that O
the O
U.S. O
is O
imperialistic O
and O
prone O
to O
exploitative O
capitalism O
. O

In O
recent O
years O
, O
two O
primary O
factors O
have O
heavily O
influenced O
the O
current O
state O
of O
North O
Korea's O
relations O
with O
South O
Korea O
and O
her O
allies O
: O
the O
rise O
of O
the O
regime O
's O
leader O
Kim O
Jong O
Un O
and O
the O
inauguration O
of O
South O
Korean O
president O
Park O
Guen O
Hye O
. O

Kim O
Jong O
Un O
officially O
rose O
to O
power O
in O
April O
2012 O
, O
following O
the O
death O
of O
his O
father O
Kim O
Jong O
Il O
in O
December O
2011 O
. O

While O
his O
age O
remained O
a O
mystery O
for O
quite O
some O
time O
, O
it O
was O
later O
revealed O
that O
he O
was O
born O
in O
January O
1983 O
, O
making O
him O
age O
31 O
at O
present O
. O

This O
makes O
Kim O
Jong O
Un O
the O
world O
's O
youngest O
leader O
of O
an O
established O
nation O
. O

The O
young O
leader O
's O
rise O
to O
power O
brought O
about O
several O
changes O
in O
North O
Korea O
. O

First O
, O
Kim O
Jong O
Un O
's O
personal O
life O
is O
more O
public O
and O
more O
extravagant O
than O
that O
of O
his O
father O
. O

Unlike O
his O
father O
, O
the O
young O
Kim O
is O
often O
accompanied O
by O
his O
wife O
when O
making O
public O
appearances O
. O

Second O
, O
the O
young O
Kim O
, O
who O
is O
more O
high-tech O
than O
his O
predecessor O
, O
is O
reported O
to O
have O
an O
affinity O
for O
luxury O
items O
and O
is O
an O
avid O
gamer O
and O
basketball O
fan O
. O

Third O
, O
Kim O
Jong O
Un O
is O
more O
totalitarian O
than O
his O
father O
. O

Following O
his O
rise O
to O
power O
, O
the O
regime O
reportedly O
expanded O
its O
labor O
camps O
, O
and O
more O
military O
resources O
were O
allocated O
to O
target O
those O
attempting O
to O
defect O
. O

Kim O
also O
executed O
his O
own O
uncle O
, O
a O
high-ranking O
official O
who O
did O
not O
share O
his O
ideals O
. O

These O
moves O
indicate O
the O
regime O
's O
priority O
to O
deter O
internal O
destabilization O
and O
dissent O
, O
which O
is O
perceived O
to O
be O
a O
greater O
threat O
than O
outside O
adversity O
. O

According O
to O
Phil O
Robertson O
, O
deputy O
Asia O
director O
at O
Human O
Rights O
Watch O
, O
'' O
The O
government O
now O
recognizes O
that O
the O
accounts O
of O
escaping O
North O
Koreans O
reveal O
Pyongyang O
's O
crimes O
– O
so O
it O
is O
doing O
what O
it O
can O
to O
stop O
people O
from O
fleeing O
. O

'' O
Under O
Kim O
Jong O
Un O
's O
rule O
, O
the O
regime O
has O
stepped O
up O
its O
nuclear O
materials O
production O
, O
and O
the O
propaganda O
distributed O
by O
state O
media O
has O
become O
more O
menacing O
. O

The O
regime O
's O
response O
to O
perceived O
threats O
has O
also O
become O
more O
volatile O
. O

Christian O
Whiton O
, O
a O
former O
deputy O
envoy O
to O
North O
Korea O
, O
noted O
that O
following O
Kim O
Jong O
Un O
's O
rise O
to O
power O
, O
'' O
the O
regime O
still O
acts O
in O
a O
very O
belligerent O
manner O
, O
but O
it O
seems O
less O
predictable O
, O
and O
more O
random O
. O

'' O
Ellen O
Kim O
, O
assistant O
director O
of O
the O
Korea O
Chair O
at O
the O
Center O
for O
Strategic O
and O
International O
Studies O
, O
assessed O
the O
situation O
thusly O
: O
'' O
Since O
[ O
Kim O
Jong O
Un O
] O
took O
power O
he O
has O
purged O
almost O
all O
of O
his O
elder O
guardians O
... O

and O
filled O
his O
surroundings O
with O
new O
faces O
. O

We O
are O
in O
a O
situation O
where O
we O
are O
learning O
about O
him O
a O
little O
bit O
every O
day O
through O
his O
unpredictable O
behavior O
and O
actions O
, O
which O
is O
why O
the O
current O
situation O
with O
North O
Korea O
is O
a O
lot O
more O
dangerous O
than O
before O
. O

'' O
The O
regime's O
recent O
reaction O
to O
an O
upcoming O
film O
supports O
these O
statements O
. O

The O
plot O
for O
the O
comedy O
film O
'' O
The O
Interview O
'' O
follows O
two O
talk O
show O
hosts O
who O
are O
asked O
to O
assassinate O
Kim O
Jong O
Un O
. O

The O
regime O
even O
sent O
a O
complaint O
about O
the O
movie O
to O
the O
UN O
. O

In O
response O
to O
the O
film O
, O
a O
North O
Korean O
official O
stated O
, O
'' O
The O
enemies O
have O
gone O
beyond O
the O
tolerance O
limit O
in O
their O
despicable O
moves O
to O
dare O
hurt O
the O
dignity O
of O
the O
supreme O
leadership O
. O

'' O
The O
official O
referred O
to O
the O
movie O
as O
'' O
the O
most O
undisguised O
terrorism O
and O
a O
war O
action O
to O
deprive O
the O
service O
personnel O
and O
people O
of O
the O
DPRK O
of O
their O
mental O
mainstay O
and O
bring O
down O
its O
social O
system O
. O

'' O
The O
official O
also O
issued O
a O
threat O
: O
'' O
If O
the O
U.S. O
administration O
connives O
at O
and O
patronizes O
the O
screening O
of O
the O
film O
, O
it O
will O
invite O
a O
strong O
and O
merciless O
countermeasure O
. O

'' O
This O
reaction O
demonstrates O
North O
Korea O
's O
priority O
of O
preserving O
the O
regime O
's O
self-perceived O
dignity O
in O
the O
global O
arena O
and O
its O
intolerance O
of O
any O
disrespect O
directed O
at O
the O
Kim O
family O
. O

While O
tensions O
between O
North O
and O
South O
Korea O
have O
persisted O
since O
the O
Korean O
War O
, O
these O
tensions O
escalated O
following O
the O
2013 O
inauguration O
of O
South O
Korea O
's O
current O
president O
, O
Park O
Geun O
Hye O
. O

Her O
platform O
, O
in O
her O
words O
, O
is O
as O
follows O
: O
'' O
North O
Korea O
must O
keep O
its O
agreements O
made O
with O
South O
Korea O
and O
the O
international O
community O
to O
establish O
a O
minimum O
level O
of O
trust O
, O
and O
second O
there O
must O
be O
assured O
consequences O
for O
actions O
that O
breach O
the O
peace O
. O

To O
ensure O
stability O
, O
trustpolitik O
should O
be O
applied O
consistently O
from O
issue O
to O
issue O
based O
on O
verifiable O
actions O
, O
and O
steps O
should O
not O
be O
taken O
for O
mere O
political O
expediency O
. O

'' O
Shortly O
after O
Park O
's O
inauguration O
, O
North O
Korea O
denounced O
UN O
Security O
Council O
Resolution O
2094 O
, O
which O
is O
'' O
a O
resolution O
strengthening O
and O
expanding O
the O
scope O
of O
United O
Nations O
sanctions O
against O
the O
Democratic O
People O
's O
Republic O
of O
Korea O
by O
targeting O
the O
illicit O
activities O
of O
diplomatic O
personnel O
, O
transfers O
of O
bulk O
cash O
, O
and O
the O
country O
's O
banking O
relationships O
, O
in O
response O
to O
that O
country O
's O
third O
nuclear O
test O
on O
12 O
February O
[ O
2013 O
] O
. O

'' O
North O
Korea O
also O
responded O
strongly O
to O
joint O
U.S.-South O
Korea O
military O
exercises O
in O
March O
2013 O
, O
as O
is O
noted O
later O
in O
this O
paper O
. O

North O
Korea O
's O
cyber O
infrastructure O
is O
divided O
into O
two O
major O
parts O
: O
an O
outward-facing O
Internet O
connection O
and O
a O
regime-controlled O
intranet O
. O

North O
Korea O
's O
outward-facing O
Internet O
connection O
is O
only O
available O
to O
select O
individuals O
and O
is O
closely O
monitored O
for O
any O
activity O
that O
is O
deemed O
anti- O
regime O
. O

Individuals O
using O
the O
outward-facing O
Internet O
connection O
must O
be O
authorized O
. O

In O
2013 O
, O
Jean O
H. O
Lee O
, O
the O
Associated O
Press O
bureau O
chief O
in O
Pyongyang O
, O
stated O
that O
foreigners O
visiting O
North O
Korea O
are O
allowed O
Internet O
access O
with O
no O
firewalls O
. O

Common O
citizens O
are O
limited O
to O
using O
the O
Kwangmyong O
( O
gwang O
me-young O
) O
, O
a O
nationwide O
intranet O
with O
no O
access O
to O
the O
world O
outside O
North O
Korea O
. O

According O
to O
Lee O
, O
Kwangmyong O
allows O
citizens O
'' O
access O
to O
the O
state O
media O
, O
information O
sources O
that O
are O
vetted O
by O
the O
government O
, O
and O
picked O
and O
pulled O
from O
the O
Internet O
and O
posted O
to O
their O
intranet O
site O
. O

'' O
As O
of O
May O
2013 O
, O
North O
Korea O
had O
only O
one O
'' O
Internet O
café O
. O

'' O
A O
2003 O
report O
from O
the O
Office O
of O
the O
National O
Counterintelligence O
Executive O
stated O
that O
North O
Korea O
's O
'' O
Internet O
café O
'' O
was O
'' O
the O
only O
place O
in O
North O
Korea O
for O
the O
public O
to O
access O
the O
Internet O
'' O
and O
that O
foreigners O
were O
allowed O
to O
access O
the O
Internet O
from O
this O
café O
. O

Whether O
citizens O
are O
allowed O
to O
access O
the O
Internet O
from O
this O
location O
is O
unknown O
. O

Star O
Joint O
Venture O
Co. O
is O
responsible O
for O
providing O
North O
Korea O
's O
Internet O
access O
. O

Star O
Joint O
Venture O
Co. O
was O
established O
by O
the O
Post O
and O
Telecommunications O
Corporation O
in O
cooperation O
with O
Loxley O
Pacific O
in O
Thailand O
. O

In O
December O
2009 O
, O
Star O
Joint O
Venture O
became O
responsible O
for O
North O
Korea's O
Internet O
address O
allocation O
. O

Previously O
, O
Internet O
access O
was O
provided O
by O
a O
German O
satellite O
link O
via O
Korea O
Computer O
Center O
Europe O
or O
via O
direct O
connections O
with O
China O
Netcom O
, O
which O
was O
later O
merged O
into O
China O
Unicom O
. O

By O
October O
2010 O
, O
North O
Korea O
had O
made O
its O
first O
known O
direct O
connection O
to O
the O
Internet O
, O
hosting O
an O
outward-facing O
Korean O
Central O
News O
Agency O
website O
accessible O
from O
the O
global O
Internet O
. O

However O
, O
many O
of O
North O
Korea O
's O
globally O
accessible O
websites O
are O
hosted O
in O
other O
countries O
. O

In O
2001 O
, O
South O
Korean O
reports O
indicated O
that O
North O
Korea O
had O
joined O
the O
International O
Telecommunications O
Satellite O
Organization O
( O
INTELSAT O
) O
. O

As O
of O
April O
2012 O
, O
North O
Korea O
reportedly O
used O
the O
Intelsat O
connection O
, O
which O
appeared O
in O
border O
gateway O
protocol O
( O
BGP O
) O
announcements O
. O

Some O
reports O
referred O
to O
the O
Intelsat O
connection O
as O
North O
Korea O
's O
backup O
Internet O
connection O
, O
in O
case O
the O
China O
Unicom O
connection O
fails O
. O

A O
March O
2013 O
post O
on O
the O
blog O
rdns.im O
showed O
that O
North O
Korea O
no O
longer O
used O
the O
Intelsat O
connection O
. O

In O
the O
blog O
post O
, O
the O
author O
noted O
his O
method O
for O
proving O
that O
The O
Pirate O
Bay O
was O
not O
hosted O
in O
North O
Korea O
. O

While O
his O
analysis O
of O
The O
Pirate O
Bay O
's O
hosting O
is O
irrelevant O
to O
our O
research O
, O
he O
did O
detail O
that O
175.45.177.0/24 O
always O
routes O
through O
AS4837 O
, O
and O
AS131279 O
. O

AS131279 O
is O
Star-KP O
, O
North O
Korea O
's O
Star O
Joint O
Venture O
Company O
, O
and O
AS4837 O
is O
China O
Unicom O
. O

The O
author O
concluded O
that O
'' O
all O
[ O
traffic O
] O
is O
ONLY O
routed O
through O
China O
Unicom O
and O
NOT O
through O
Intelsat O
. O

'' O
In O
February O
2014 O
, O
North O
Korean O
and O
South O
Korean O
officials O
agreed O
to O
extend O
Internet O
access O
to O
Kaesong O
Industrial O
Zone O
, O
a O
jointly O
operated O
industrial O
complex O
just O
north O
of O
the O
border O
. O

However O
, O
this O
would O
likely O
require O
a O
major O
electrical O
and O
network O
infrastructure O
expansion O
. O

North O
Korea O
's O
electrical O
grid O
can O
not O
support O
a O
large O
technological O
infrastructure O
. O

Electrical O
power O
is O
reported O
to O
be O
unreliable O
and O
sporadic O
, O
with O
many O
citizens O
only O
receiving O
a O
few O
hours O
of O
electricity O
per O
day O
. O

The O
photo O
above O
( O
Figure O
3 O
) O
, O
from O
the O
International O
Space O
Station O
, O
shows O
North O
Korea O
's O
sparse O
power O
grid O
, O
in O
comparison O
with O
surrounding O
nations O
. O

We O
have O
highlighted O
North O
Korea O
in O
red O
. O

Koryolink O
, O
the O
country O
's O
only O
cellular O
phone O
network O
, O
is O
tightly O
controlled O
by O
the O
regime O
. O

Cell O
phone O
data O
plans O
are O
not O
available O
to O
most O
users O
. O

Most O
cellular O
phones O
can O
not O
access O
the O
Internet O
and O
can O
only O
make O
domestic O
calls O
. O

According O
to O
a O
2013 O
report O
, O
North O
Korea O
has O
a O
3G O
data O
network O
for O
cellular O
phones O
. O

Visiting O
reporter O
Jean O
H. O
Lee O
purportedly O
used O
this O
3G O
network O
to O
post O
to O
both O
Twitter O
and O
Instagram O
. O

However O
, O
citizens O
are O
not O
generally O
allowed O
to O
use O
the O
3G O
network O
. O

Email O
is O
also O
regulated O
by O
the O
regime O
. O

The O
first O
email O
provider O
in O
North O
Korea O
was O
Silibank O
. O

Silibank O
has O
servers O
in O
Pyongyong O
and O
Shenyang O
and O
is O
a O
joint O
venture O
with O
China O
. O

The O
North O
Korean O
Silibank O
homepage O
is O
silibank.net O
, O
and O
the O
Chinese O
homepage O
is O
silibank.com O
. O

In O
order O
to O
use O
the O
email O
service O
, O
users O
had O
to O
initially O
register O
, O
provide O
personal O
information O
, O
and O
pay O
a O
registration O
fee O
and O
monthly O
service O
fees O
. O

This O
registration O
information O
was O
current O
as O
of O
2001 O
. O

However O
, O
it O
is O
unknown O
whether O
the O
same O
process O
still O
applies O
. O

WHOIS O
records O
for O
silibank.net O
show O
that O
the O
site O
was O
registered O
anonymously O
via O
a O
Japanese O
registrar O
. O

This O
information O
can O
be O
found O
in O
Appendix O
A O
at O
the O
end O
of O
this O
paper O
. O

Korea O
Computer O
Center O
( O
KCC O
) O
is O
North O
Korea O
's O
leading O
government O
research O
center O
for O
information O
technology O
. O

KCC O
has O
eleven O
regional O
information O
centers O
and O
eight O
development O
and O
production O
centers O
. O

Other O
countries O
with O
KCC O
branch O
offices O
include O
China O
, O
Syria O
, O
Germany O
, O
and O
United O
Arab O
Emirates O
. O

KCC O
has O
a O
vested O
interest O
in O
Linux O
research O
and O
is O
responsible O
for O
the O
development O
of O
North O
Korea O
's O
national O
operating O
system O
, O
Red O
Star O
OS O
, O
which O
is O
discussed O
in O
more O
detail O
below O
. O

KCC O
's O
other O
projects O
have O
included O
a O
proprietary O
search O
engine O
, O
a O
document O
writer O
, O
a O
game O
called O
Jang-Gi O
, O
the O
Kwangmyong O
intranet O
, O
a O
food O
study O
program O
, O
a O
Korean O
input O
method O
editor O
, O
a O
pen-based O
English-Korean O
and O
Korean-English O
translator O
, O
Korean O
voice O
recognition O
software O
, O
a O
video O
conferencing O
system O
, O
a O
distance O
education O
system O
, O
SilverStar O
Paduk O
software O
, O
HMS O
Player O
, O
and O
the O
Samjiyon O
tablet O
. O

In O
addition O
to O
research O
and O
development O
, O
KCC O
also O
monitors O
websites O
of O
foreign O
government O
and O
business O
entities O
and O
conducts O
technical O
reconnaissance O
to O
blueprint O
the O
technical O
specifications O
and O
vulnerabilities O
in O
foreign O
systems O
and O
technologies O
. O

KCC O
has O
also O
been O
involved O
in O
clandestine O
information O
and O
cyber O
operations O
, O
serving O
as O
a O
command O
center O
. O

North O
Korea O
's O
proprietary O
operating O
system O
is O
Red O
Star O
OS O
. O

The O
development O
of O
this O
Linux-based O
operating O
system O
started O
in O
2002 O
. O

Red O
Star O
OS O
is O
only O
offered O
in O
the O
Korean O
language O
and O
features O
proprietary O
software O
including O
Naenara O
( O
a O
Firefox-based O
browser O
) O
, O
as O
well O
as O
a O
text O
editor O
, O
email O
client O
, O
audio O
and O
video O
players O
, O
and O
games O
. O

Red O
Star O
OS O
's O
keyboard O
layouts O
include O
Korean O
, O
English O
, O
Russian O
, O
Chinese O
, O
and O
Japanese O
. O

Regime O
ideals O
extend O
to O
Red O
Star O
OS O
. O

The O
readme O
file O
, O
which O
goes O
with O
the O
installation O
disc O
, O
reportedly O
includes O
a O
quote O
from O
Kim O
Jong-Il O
regarding O
the O
importance O
of O
North O
Korea O
having O
its O
own O
Linux-based O
operating O
system O
that O
is O
compatible O
with O
Korean O
traditions O
. O

While O
prior O
versions O
of O
Red O
Star O
were O
KDE-based O
, O
version O
3.0 O
mimics O
Apple O
's O
OS O
X O
. O

This O
could O
indicate O
the O
regime O
leader O
Kim O
Jong O
Un O
's O
preference O
for O
the O
OS O
X O
environment O
, O
as O
Kim O
reportedly O
uses O
an O
iMac O
. O

Citizens O
do O
not O
need O
permission O
to O
obtain O
Red O
Star O
OS O
. O

However O
, O
the O
purchase O
of O
computers O
is O
heavily O
regulated O
. O

The O
OS O
's O
design O
suggests O
it O
was O
developed O
with O
means O
for O
the O
regime O
to O
monitor O
user O
activity O
. O

North O
Korea O
is O
known O
to O
use O
two O
IP O
ranges O
. O

175.45.176.0/22 O
is O
North O
Korea O
's O
own O
IP O
block O
. O

Additionally O
, O
North O
Korea O
's O
Telecommunications O
Ministry O
is O
the O
registered O
user O
of O
China O
Unicom O
IP O
range O
210.52.109.0/24 O
. O

The O
country O
's O
only O
autonomous O
system O
( O
AS O
) O
number O
is O
AS131279 O
, O
and O
its O
only O
peer O
is O
AS4837 O
, O
the O
AS O
for O
China O
Unicom O
. O

North O
Korea O
's O
country O
code O
top-level O
domain O
( O
ccTLD O
) O
is O
.kp O

. O

In O
2007 O
, O
the O
.kp O

TLD O
was O
initially O
delegated O
to O
and O
administered O
by O
the O
German-based O
KCC O
Europe O
. O

After O
KCC O
Europe O
failed O
to O
maintain O
the O
TLD O
, O
it O
was O
re-delegated O
to O
Star O
Joint O
Venture O
Company O
. O

The O
.kp O

TLD O
uses O
the O
following O
nameservers O
and O
IP O
addresses O
: O
Various O
U.S. O
, O
U.N O
, O
and O
other O
sanctions O
prohibit O
export O
of O
dual-use O
technologies O
to O
North O
Korea O
. O

In O
light O
of O
this O
, O
North O
Korea O
has O
managed O
to O
develop O
both O
hardware O
and O
software O
and O
hosts O
an O
annual O
National O
Exhibition O
of O
Invention O
and O
New O
Technologies O
to O
promote O
its O
products O
. O

However O
, O
the O
regime O
has O
historically O
failed O
in O
its O
attempts O
at O
large-scale O
production O
of O
electronic O
components O
. O

The O
country O
's O
sparse O
electrical O
grid O
is O
one O
of O
the O
major O
obstacles O
hindering O
large- O
scale O
manufacturing O
. O

Additionally O
, O
the O
famine O
in O
the O
early O
1990 O
's O
negatively O
impacted O
existing O
manufacturing O
facilities O
, O
and O
the O
regime O
simply O
does O
not O
have O
the O
capital O
to O
modernize O
those O
factories O
. O

A O
member O
of O
the O
World O
International O
Property O
Organization O
( O
WIPO O
) O
, O
North O
Korea O
joined O
the O
WIPO O
Patent O
Cooperation O
Treaty O
that O
protects O
patents O
and O
trademarks O
worldwide O
, O
and O
leverages O
intellectual O
property O
laws O
to O
ensure O
Westerners O
do O
not O
take O
credit O
for O
North O
Korean O
inventions O
. O

The O
regime O
, O
in O
its O
efforts O
to O
isolate O
its O
citizens O
from O
Western O
influence O
, O
leverages O
intellectual O
property O
laws O
to O
ensure O
Westerners O
do O
not O
take O
credit O
for O
North O
Korean O
inventions O
. O

This O
is O
ironic O
since O
foreign-made O
electronic O
components O
are O
sometimes O
smuggled O
into O
North O
Korea O
for O
military O
use O
and O
for O
personal O
use O
by O
the O
regime O
's O
upper O
echelon O
. O

A O
comparison O
of O
a O
scan O
of O
North O
Korea O
's O
IP O
ranges O
in O
November O
2010 O
, O
just O
one O
month O
after O
North O
Korea O
made O
its O
first O
direct O
connection O
to O
the O
Internet O
, O
and O
a O
series O
of O
several O
scans O
we O
conducted O
in O
May O
2014 O
, O
shows O
that O
North O
Korea O
has O
made O
significant O
headway O
in O
establishing O
its O
Internet O
presence O
. O

In O
the O
November O
2010 O
scan O
, O
175.45.176.0 O
- O
175.45.176.16 O
showed O
a O
variety O
of O
devices O
including O
D-link O
, O
Cisco O
, O
Linksys O
, O
HP O
, O
and O
Nokia O
devices O
, O
and O
a O
Juniper O
networks O
firewall O
. O

Operating O
systems O
detected O
included O
FreeBSD O
6.x O
, O
Linux O
2.6.x O
, O
and O
Red O
Hat O
Enterprise O
Linux O
. O

175.45.176.14 O
returned O
'' O
Naenara O
'' O
as O
an O
html-title O
. O

Most O
hosts O
in O
the O
175.45.176.xx O
and O
175.45.177.xx O
ranges O
were O
down O
. O

As O
of O
2014 O
, O
IP O
addresses O
175.45.176.0 O
- O
175.45.177.255 O
appear O
to O
be O
used O
for O
websites O
, O
nameservers O
, O
databases O
, O
email O
, O
and O
voice O
over O
IP O
( O
VoIP O
) O
. O

In O
November O
2010 O
, O
the O
175.45.178.xx O
range O
showed O
all O
hosts O
down O
, O
and O
the O
175.45.179.xx O
range O
showed O
most O
hosts O
were O
down O
. O

In O
2014 O
, O
several O
webservers O
and O
nameservers O
were O
found O
in O
the O
175.45.178.xx O
range O
, O
and O
several O
nameservers O
and O
mail O
servers O
were O
found O
in O
the O
175.45.179.xx O
range O
. O

This O
comparison O
demonstrates O
that O
there O
has O
been O
some O
growth O
in O
DPRK O
Internet O
infrastructure O
over O
the O
past O
four O
years O
. O

However O
, O
it O
seemingly O
lags O
behind O
even O
most O
third O
world O
nations O
. O

The O
2014 O
scans O
detected O
dated O
technology O
that O
is O
potentially O
susceptible O
to O
multiple O
vulnerabilities O
and O
consistently O
showed O
the O
same O
open O
ports O
and O
active O
devices O
on O
scanned O
hosts O
. O

It O
is O
not O
clear O
whether O
the O
regime O
failed O
to O
notice O
and O
react O
to O
the O
scanning O
or O
whether O
the O
regime O
allows O
these O
open O
ports O
and O
devices O
to O
be O
detected O
or O
spoofed O
to O
serve O
as O
a O
distraction O
or O
possible O
honeypot O
. O

Domains O
, O
nameservers O
, O
and O
mail O
servers O
present O
during O
the O
May O
2014 O
scan O
are O
listed O
in O
Appendix O
B O
at O
the O
end O
of O
this O
report O
. O

According O
to O
Alexa O
rankings O
, O
the O
three O
most O
visited O
websites O
in O
North O
Korea O
are O
kcna.kp O
, O
the O
official O
website O
of O
the O
Korean O
Central O
News O
Agency O
( O
KCNA O
) O
; O
rodong.rep.kp O
, O
another O
North O
Korean O
news O
site O
; O
and O
naenara.com.kp O
, O
North O
Korea O
's O
official O
web O
portal O
. O

Naenara O
translates O
to O
'' O
my O
country O
'' O
. O

The O
kcna.kp O
site O
was O
registered O
using O
a O
Loxley.co.th O
email O
address O
and O
is O
administrated O
by O
Star O
Joint O
Venture O
Company O
. O

The O
WHOIS O
Record O
can O
be O
found O
in O
Appendix O
A. O
Rodong.rep.kp O
was O
registered O
using O
the O
same O
loxley.co.th O
email O
address O
and O
is O
also O
administered O
by O
Star O
Joint O
Venture O
Company O
. O

The O
WHOIS O
Record O
for O
this O
site O
can O
be O
found O
in O
Appendix O
A O
. O

The O
WHOIS O
information O
for O
Naenara.com.kp O
was O
not O
available O
. O

In O
March O
2013 O
, O
there O
were O
reports O
that O
the O
Chrome O
browser O
was O
blocking O
Naenara.com.kp O
due O
to O
malware O
. O

It O
is O
difficult O
to O
say O
whether O
this O
incident O
is O
a O
case O
of O
North O
Korea O
serving O
malware O
or O
whether O
a O
third O
party O
took O
advantage O
of O
an O
improperly O
secured O
website O
. O

Several O
major O
North O
Korean O
websites O
are O
hosted O
outside O
of O
North O
Korea O
. O

The O
popular O
Uriminzokkiri.com O
website O
, O
whose O
name O
translates O
to O
'' O
our O
nation O
, O
'' O
is O
hosted O
in O
China O
. O

The O
administrative O
contact O
for O
the O
website O
is O
Kim O
Sejun O
, O
and O
the O
email O
address O
given O
as O
contact O
information O
is O
hyk1979 O
@ O
hotmail.com O
. O

The O
WHOIS O
Record O
for O
this O
site O
can O
be O
found O
in O
Appendix O
A O
. O

The O
website O
for O
Kim O
Il O
Sung O
Open O
University O
, O
otherwise O
known O
as O
'' O
Our O
Nation O
School O
'' O
is O
also O
hosted O
in O
China O
. O

The O
WHOIS O
record O
for O
this O
site O
can O
be O
found O
in O
Appendix O
A O
. O

At O
the O
top O
of O
North O
Korea O
's O
military O
structure O
is O
the O
National O
Defense O
Commission O
( O
NDC O
) O
. O

The O
NDC O
is O
also O
the O
highest O
branch O
of O
government O
and O
the O
regime O
's O
supreme O
policymaking O
body O
. O

Along O
with O
the O
Central O
Committee O
of O
the O
Workers O
' O
Party O
of O
Korea O
and O
the O
Cabinet O
, O
NDC O
is O
at O
the O
top O
of O
North O
Korea O
's O
political O
hierarchy O
. O

Article O
106 O
of O
North O
Korea O
's O
Constitution O
gives O
the O
NDC O
the O
following O
powers O
: O
 O
The O
power O
to O
establish O
policies O
of O
the O
state O
in O
accordance O
with O
the O
military-first O
revolutionary O
line O
. O

 O
The O
power O
to O
guide O
the O
armed O
forces O
and O
oversee O
defense O
building O
. O

 O
The O
power O
to O
supervise O
and O
ensure O
the O
NDC O
and O
its O
chairman O
's O
orders O
are O
executed O
and O
to O
establish O
necessary O
measures O
. O

 O
The O
power O
to O
override O
any O
state O
decisions O
or O
directives O
that O
are O
in O
opposition O
to O
the O
NDC O
or O
its O
chairman O
's O
decisions O
and O
directives O
. O

 O
The O
power O
to O
create O
or O
remove O
central O
organs O
of O
the O
national O
defense O
sector O
. O

 O
The O
power O
to O
create O
and O
bestow O
military O
titles O
above O
general-grade O
officer O
rank O
. O

The O
NDC O
oversees O
several O
defense O
and O
intelligence O
bodies O
including O
the O
Ministry O
of O
State O
Security O
, O
the O
Ministry O
of O
People O
's O
Security O
, O
the O
Ministry O
of O
People O
's O
Armed O
Forces O
, O
and O
the O
Korean O
People's O
Army O
. O

The O
Ministry O
of O
State O
Security O
( O
MSS O
) O
, O
also O
known O
as O
the O
State O
Security O
Department O
, O
is O
North O
Korea O
's O
primary O
counterintelligence O
service O
. O

It O
is O
considered O
an O
autonomous O
agent O
of O
the O
regime O
and O
reports O
directly O
to O
leader O
Kim O
Jong O
Un O
. O

The O
MSS O
's O
duties O
include O
oversight O
of O
North O
Korean O
prison O
camps O
, O
investigation O
of O
domestic O
espionage O
, O
repatriation O
of O
defectors O
, O
and O
overseas O
counterespionage O
operations O
. O

The O
Ministry O
of O
People O
's O
Security O
is O
also O
known O
as O
the O
Ministry O
of O
Public O
Security O
( O
MPS O
) O
. O

Focused O
on O
domestic O
order O
, O
it O
oversees O
North O
Korea O
's O
national O
police O
force O
, O
conducts O
criminal O
investigations O
and O
preliminary O
examinations O
, O
and O
oversees O
correctional O
facilities O
, O
excluding O
prison O
camps O
. O

While O
the O
roles O
of O
the O
MSS O
and O
MPS O
focus O
more O
on O
intelligence O
than O
on O
cyber O
operations O
, O
the O
MSS O
also O
reportedly O
has O
a O
communications O
monitoring O
and O
computer O
hacking O
group O
. O

The O
Ministry O
of O
People O
's O
Armed O
Forces O
( O
MPAF O
) O
administrates O
the O
Korean O
People O
's O
Army O
( O
KPA O
) O
and O
oversees O
the O
General O
Staff O
Department O
( O
GSD O
) O
, O
which O
is O
responsible O
for O
operational O
command O
and O
control O
of O
North O
Korea O
's O
armed O
forces O
. O

The O
General O
Staff O
Department O
also O
oversees O
the O
Reconnaissance O
General O
Bureau O
( O
RGB O
) O
, O
North O
Korea O
's O
agency O
for O
clandestine O
operations O
. O

The O
RGB O
has O
a O
role O
in O
both O
traditional O
and O
cyber O
operations O
. O

In O
the O
past O
, O
the O
RGB O
has O
sent O
agents O
on O
overseas O
military O
assistance O
missions O
to O
train O
insurgent O
groups O
. O

The O
RGB O
reportedly O
has O
a O
special O
operations O
forces O
( O
SOF O
) O
element O
and O
oversees O
six O
bureaus O
that O
specialize O
in O
operations O
, O
reconnaissance O
, O
technology O
and O
cyber O
matters O
, O
overseas O
intelligence O
collection O
, O
inter-Korean O
talks O
, O
and O
service O
support O
. O

Two O
of O
these O
bureaus O
have O
been O
identified O
as O
the O
No O
. O

91 O
Office O
and O
Unit O
121 O
. O

The O
No O
. O

91 O
Office O
, O
an O
office O
responsible O
for O
hacking O
, O
operates O
out O
of O
the O
Mangkyungdae-district O
of O
Pyongyang O
. O

Unit O
121 O
comprises O
both O
an O
intelligence O
component O
and O
an O
attack O
component O
. O

Unit O
121 O
's O
headquarters O
is O
in O
the O
Moonshin-dong O
area O
of O
Pyongyang O
, O
near O
the O
Taedong O
River O
. O

It O
also O
has O
components O
that O
conduct O
operations O
from O
within O
China O
. O

One O
of O
Unit O
121 O
's O
command O
posts O
is O
Chilbosan O
Hotel O
in O
Shenyang O
, O
the O
capital O
of O
Liaoning O
Province O
, O
which O
borders O
North O
Korea O
. O

Shenyang O
is O
a O
Chinese O
military O
district O
. O

According O
to O
Dr. O
Alexandre O
Mansourov O
, O
an O
expert O
on O
North O
Korea O
and O
a O
visiting O
scholar O
at O
the O
U.S.-Korea O
Institute O
at O
Johns O
Hopkins O
University O
, O
'' O
They O
[ O
Unit O
121 O
] O
are O
believed O
to O
have O
conducted O
hacking O
operations O
from O
inside O
China O
that O
falsify O
classified O
data O
and O
disrupt O
U.S. O
and O
South O
Korean O
systems O
. O

'' O
Both O
Unit O
121 O
and O
an O
entity O
known O
as O
Lab O
110 O
are O
reported O
to O
maintain O
technical O
reconnaissance O
teams O
responsible O
for O
infiltrating O
computer O
networks O
, O
hacking O
to O
obtain O
intelligence O
, O
and O
planting O
viruses O
on O
enemy O
networks O
. O

Several O
entities O
are O
nested O
under O
the O
Workers O
' O
Party O
. O

The O
Central O
Party O
Committee O
oversees O
the O
Central O
Party O
Investigative O
Group O
, O
also O
known O
as O
Unit O
35 O
. O

Unit O
35 O
is O
reportedly O
responsible O
for O
technical O
education O
and O
training O
of O
cyber O
warriors O
. O

The O
Unification O
Bureau O
's O
Operations O
Department O
is O
responsible O
for O
cyber-psychological O
warfare O
, O
organizational O
espionage O
, O
and O
oversight O
of O
Unit O
204 O
. O

Unit O
204 O
's O
responsibilities O
include O
planning O
and O
execution O
of O
cyber-psychological O
warfare O
operations O
and O
technological O
research O
. O

The O
Psychological O
Operations O
Department O
of O
the O
North O
Korea O
Defense O
Commission O
also O
engages O
in O
cyber-psychological O
warfare O
. O

The O
225th O
Bureau O
, O
or O
Office O
225 O
, O
is O
responsible O
for O
training O
agents O
, O
infiltration O
operations O
in O
South O
Korea O
, O
and O
creation O
of O
underground O
political O
parties O
in O
order O
to O
incite O
disorder O
and O
revolution O
. O

It O
plays O
a O
more O
traditional O
intelligence O
and O
psychological O
operations O
role O
, O
rather O
than O
focusing O
on O
cyber O
operations O
. O

The O
United O
Front O
Department O
( O
UFD O
) O
conducts O
overt O
operations O
to O
create O
pro-North O
Korean O
groups O
in O
South O
Korea O
. O

Examples O
of O
this O
activity O
include O
the O
Korean O
Asia-Pacific O
Committee O
and O
the O
Ethnic O
Reconciliation O
Council O
. O

The O
UFD O
also O
manages O
inter-Korean O
dialogue O
and O
North O
Korea's O
policy O
toward O
South O
Korea O
. O

Its O
operations O
are O
also O
more O
traditional O
rather O
than O
cyber-focused O
. O

The O
Liaison O
Department O
of O
the O
Worker O
's O
Party O
oversees O
a O
faction O
of O
ethnic O
North O
Koreans O
residing O
in O
Japan O
who O
are O
critical O
to O
North O
Korea O
's O
cyber O
and O
intelligence O
programs O
. O

This O
group O
, O
which O
was O
established O
in O
1955 O
, O
is O
referred O
to O
by O
various O
names O
including O
the O
Chosen O
Soren O
, O
Chongryon O
, O
and O
the O
General O
Association O
of O
Korean O
Residents O
in O
Japan O
. O

The O
Chongryon O
ascribe O
to O
juche O
and O
seek O
to O
preserve O
North O
Korean O
culture O
while O
living O
in O
Japan O
. O

They O
operate O
North O
Korean O
style O
schools O
and O
refuse O
to O
assimilate O
with O
Japanese O
culture O
. O

According O
to O
Mitsuhiro O
Suganuma O
, O
former O
section O
head O
of O
the O
second O
intelligence O
department O
of O
the O
Japanese O
Public O
Security O
Intelligence O
Agency O
( O
PSIA O
) O
, O
'' O
Chongryon O
is O
virtually O
under O
the O
direct O
control O
of O
the O
Liaison O
Department O
of O
the O
Workers O
' O
Party O
of O
Korea O
, O
which O
has O
been O
in O
charge O
of O
North O
Korea O
's O
covert O
operations O
and O
underground O
activities O
against O
South O
Korea O
. O

Chongryon O
in O
Japan O
has O
been O
a O
strong O
support O
organization O
aimed O
at O
bringing O
a O
revolution O
in O
South O
Korea O
, O
or O
a O
red O
unification O
by O
force O
. O

'' O
He O
also O
stated O
'' O
North O
Korea O
will O
continue O
to O
make O
Chongryon O
serve O
as O
Pyongyang O
's O
pawn O
in O
covert O
operations O
against O
South O
Korea O
. O

'' O
The O
Chongryon O
are O
vital O
to O
North O
Korea O
's O
military O
budget O
, O
raising O
funds O
via O
weapons O
trafficking O
, O
drug O
trafficking O
, O
and O
other O
black O
market O
activities O
. O

The O
group O
also O
forms O
'' O
front O
companies O
'' O
abroad O
that O
benefit O
the O
regime O
by O
generating O
hard O
currency O
. O

One O
example O
is O
Unikotech O
, O
which O
was O
formed O
to O
sell O
KCC O
products O
abroad O
. O

The O
Chongryon O
's O
underground O
group O
known O
as O
the O
Gakushu-gumi O
, O
or O
'' O
the O
study O
group O
'' O
, O
gathers O
intelligence O
for O
North O
Korea O
and O
helps O
the O
regime O
procure O
advanced O
technologies O
. O

The O
Chongryon O
's O
role O
in O
North O
Korean O
intelligence O
and O
resource O
acquisition O
is O
discussed O
below O
in O
more O
detail O
. O

The O
regime O
also O
has O
several O
government O
bodies O
under O
the O
Cabinet O
that O
oversee O
its O
infrastructure O
, O
intelligence O
, O
and O
technological O
development O
. O

These O
include O
the O
Central O
Scientific O
and O
Technological O
Information O
Agency O
( O
CSTIA O
) O
, O
the O
Ministry O
of O
Electronics O
Industry O
, O
and O
the O
Ministry O
of O
Posts O
and O
Telecommunications O
. O

The O
CSTIA O
collects O
, O
analyzes O
, O
and O
processes O
data O
regarding O
advanced O
science O
and O
technology O
then O
sends O
relevant O
information O
to O
appropriate O
areas O
of O
the O
national O
economy O
. O

The O
amount O
of O
information O
contained O
in O
CSTIA's O
technical O
database O
makes O
it O
North O
Korea O
's O
largest O
scientific O
facility O
. O

According O
to O
a O
CIA O
article O
, O
review O
of O
CSTIA O
's O
publications O
showed O
that O
China O
, O
Russia O
, O
and O
Japan O
are O
important O
sources O
of O
technical O
data O
. O

CSTIA O
's O
publications O
include O
newsletters O
and O
an O
18-volume O
science O
and O
technology O
reference O
series O
. O

The O
Ministry O
of O
Posts O
and O
Telecommunications O
is O
the O
body O
of O
oversight O
for O
Star O
Joint O
Venture O
Co. O
North O
Korea O
's O
cyber O
warfare O
doctrine O
has O
not O
been O
clearly O
stated O
. O

However O
, O
based O
on O
cultural O
and O
technical O
observations O
, O
we O
may O
deduce O
that O
North O
Korea O
's O
cyber O
doctrine O
follows O
the O
tenets O
of O
juche O
nationalism O
and O
the O
songun O
doctrine O
. O

Although O
North O
Korea O
's O
limited O
online O
presence O
makes O
a O
thorough O
analysis O
of O
their O
cyber O
warfare O
capabilities O
a O
difficult O
task O
, O
it O
must O
be O
noted O
that O
what O
is O
known O
of O
those O
capabilities O
closely O
mirrors O
their O
kinetic O
warfare O
tactics O
. O

Cyber O
warfare O
is O
simply O
the O
modern O
chapter O
in O
North O
Korea's O
long O
history O
of O
asymmetrical O
warfare O
. O

North O
Korea O
has O
used O
various O
unconventional O
tactics O
in O
the O
past O
, O
such O
as O
guerilla O
warfare O
, O
strategic O
use O
of O
terrain O
, O
and O
psychological O
operations O
. O

The O
regime O
also O
aspires O
to O
create O
viable O
nuclear O
weapons O
. O

Asymmetrical O
warfare O
is O
defined O
as O
'' O
a O
conflict O
in O
which O
the O
resources O
of O
two O
belligerents O
differ O
in O
essence O
and O
in O
the O
struggle O
, O
interact O
and O
attempt O
to O
exploit O
each O
other O
's O
characteristic O
weaknesses O
. O

Such O
struggles O
often O
involve O
strategies O
and O
tactics O
of O
unconventional O
warfare O
, O
the O
'weaker O
' O
combatants O
attempting O
to O
use O
strategy O
to O
offset O
deficiencies O
in O
quantity O
or O
quality O
'' O
. O

According O
to O
the O
aforementioned O
report O
to O
the O
House O
Armed O
Service O
Committee O
, O
'' O
Cyber O
warfare O
is O
an O
important O
asymmetric O
dimension O
of O
conflict O
that O
North O
Korea O
will O
probably O
continue O
to O
emphasize O
- O
in O
part O
because O
of O
its O
deniability O
and O
low O
relative O
costs O
. O

'' O
North O
Korea O
's O
poor O
economic O
state O
, O
further O
explains O
the O
regime O
's O
reliance O
on O
these O
tactics O
. O

In O
2014 O
, O
the O
regime O
reportedly O
spent O
16 O
% O
of O
its O
budget O
on O
defense O
. O

The O
North O
Korean O
military O
places O
a O
strong O
emphasis O
on O
information O
warfare O
capabilities O
including O
political O
and O
psychological O
warfare O
and O
cyber O
or O
hacker O
warfare O
. O

The O
report O
by O
Capt O
. O

Duk-Ki O
Kim O
, O
Ph.D. O
highlighted O
North O
Korea O
's O
counter-asymmetric O
strategy O
and O
ranked O
each O
based O
on O
intensity O
and O
frequency O
: O
Just O
ten O
years O
ago O
, O
experts O
noted O
that O
North O
Korea O
was O
one O
of O
the O
'' O
least O
network-ready O
and O
most O
isolated O
societies O
on O
the O
planet O
. O

'' O
Today O
North O
Korea O
's O
air-gapped O
networks O
and O
prioritization O
of O
resources O
for O
military O
use O
provide O
both O
a O
secure O
and O
structured O
base O
of O
operations O
for O
cyber O
operations O
and O
a O
secure O
means O
of O
communications O
. O

North O
Korea O
's O
hermit O
infrastructure O
creates O
a O
cyber-terrain O
that O
deters O
reconnaissance O
. O

Because O
North O
Korea O
has O
few O
Internet O
connections O
to O
the O
outside O
world O
, O
anyone O
seeking O
intelligence O
on O
North O
Korea O
's O
networks O
has O
to O
expend O
more O
resources O
for O
cyber O
reconnaissance O
. O

A O
2003 O
article O
by O
the O
U.S. O
Office O
of O
the O
National O
Counterintelligence O
Executive O
assessed O
that O
'' O
Development O
of O
the O
nation O
, O
rather O
than O
empowerment O
of O
the O
individual O
, O
appears O
to O
be O
driving O
DPRK O
efforts O
to O
develop O
domestic O
IT O
infrastructure O
and O
industry O
. O

'' O
In O
November O
2013 O
, O
Kim O
Jong O
Un O
referred O
to O
cyber O
warfare O
capabilities O
as O
a O
'' O
magic O
weapon O
'' O
in O
conjunction O
with O
nuclear O
weapons O
and O
missiles O
. O

According O
to O
Kim O
Heung-kwang O
, O
a O
North O
Korean O
defector O
and O
former O
computer O
science O
professor O
, O
the O
regime O
has O
the O
following O
motivations O
for O
expanding O
its O
cyber O
warfare O
capabilities O
: O
 O
Cyber O
capabilities O
are O
a O
cost-effective O
way O
to O
offset O
North O
Korea O
's O
lack O
of O
kinetic O
military O
prowess O
. O

 O
North O
Korea O
's O
school O
systems O
place O
a O
strong O
emphasis O
on O
math O
, O
giving O
the O
nation O
confidence O
in O
its O
programmers O
, O
cryptographers O
, O
and O
security O
researchers O
. O

 O
In O
the O
modern O
warfare O
landscape O
, O
cyber O
capabilities O
are O
potentially O
more O
utilitarian O
than O
heavy O
artillery O
or O
aircraft O
. O

 O
Cyber O
warfare O
capabilities O
provide O
a O
platform O
for O
espionage O
, O
psychological O
operations O
, O
and O
other O
forms O
of O
non-kinetic O
warfare O
. O

 O
Considering O
the O
separatist O
nature O
of O
North O
Korea O
's O
infrastructure O
, O
cyber O
warfare O
provides O
a O
strategic O
advantage O
since O
outbound O
attacks O
are O
possible O
, O
but O
inbound O
attacks O
would O
have O
limited O
reach O
. O

 O
Cyber O
warfare O
allows O
North O
Korea O
to O
leverage O
the O
Internet O
's O
inherent O
flaws O
for O
offensive O
purposes O
while O
maintaining O
its O
defenses O
, O
primarily O
via O
air-gapping O
its O
most O
critical O
networks O
from O
the O
outside O
world O
. O

North O
Korea O
's O
attack O
and O
defense O
capabilities O
reportedly O
include O
the O
following O
cyber O
warfare O
and O
electronic O
warfare O
components O
: O
offensive O
cyber O
operations O
( O
OCO O
) O
; O
computer O
network O
operations O
( O
CNO O
) O
, O
which O
includes O
both O
computer O
network O
attack O
( O
CNA O
) O
and O
computer O
network O
exploitation O
( O
CNE O
) O
; O
distributed O
denial O
of O
service O
( O
DDoS O
) O
; O
satellite O
monitoring O
; O
drones O
; O
GPS O
jamming O
capabilities O
; O
and O
deployment O
of O
electromagnetic O
pulse O
( O
EMP O
) O
. O

North O
Korea O
's O
OCO O
and O
CNO O
capabilities O
became O
apparent O
as O
early O
as O
2004 O
, O
when O
North O
Korea O
reportedly O
gained O
access O
to O
33 O
of O
80 O
South O
Korean O
military O
wireless O
communication O
networks O
. O

In O
June O
2006 O
, O
an O
attack O
on O
the O
U.S. O
State O
Department O
originating O
in O
the O
East O
Asia-Pacific O
region O
coincided O
with O
U.S.-North O
Korea O
negotiations O
over O
the O
regime O
's O
nuclear O
missile O
testing O
. O

A O
month O
later O
, O
a O
South O
Korean O
military O
report O
implicated O
North O
Korea O
's O
Unit O
121 O
in O
hacking O
the O
South O
Korean O
and O
U.S. O
Defense O
Departments O
. O

North O
Korea O
also O
tested O
a O
logic O
bomb O
in O
October O
2007 O
. O

A O
logic O
bomb O
is O
malicious O
code O
programmed O
to O
execute O
based O
on O
a O
pre-defined O
triggering O
event O
. O

Following O
the O
logic O
bomb O
test O
, O
the O
UN O
passed O
a O
resolution O
banning O
sales O
of O
certain O
computer O
hardware O
to O
North O
Korea O
. O

North O
Korea O
considers O
its O
cyber O
warfare O
capabilities O
an O
important O
asymmetric O
asset O
in O
the O
face O
of O
its O
perceived O
enemies O
, O
the O
U.S. O
and O
South O
Korea O
. O

While O
North O
Korea O
does O
not O
have O
an O
immersive O
digital O
culture O
, O
both O
the O
U.S. O
and O
South O
Korea O
are O
heavily O
dependent O
upon O
technological O
infrastructure O
for O
social O
, O
economic O
, O
and O
political O
stability O
. O

For O
this O
reason O
, O
a O
cyber O
attack O
that O
cripples O
or O
compromises O
the O
reliability O
of O
the O
U.S. O
or O
South O
Korea O
's O
technological O
infrastructure O
could O
have O
a O
far-reaching O
impact O
. O

North O
Korea O
has O
reportedly O
used O
computer O
games O
for O
both O
illegal O
capital O
gain O
and O
orchestrating O
cyber O
attacks O
. O

In O
2011 O
, O
South O
Korean O
police O
arrested O
five O
individuals O
, O
including O
one O
Chinese O
national O
, O
for O
allegedly O
collaborating O
with O
North O
Korean O
hackers O
affiliated O
with O
the O
Korea O
Computer O
Center O
to O
steal O
money O
via O
online O
games O
. O

According O
to O
South O
Korean O
reports O
, O
the O
culprits O
used O
an O
auto-player O
to O
quickly O
progress O
in O
the O
massively O
multiplayer O
online O
role-playing O
game O
( O
MMORPG O
) O
'' O
Lineage O
'' O
and O
were O
able O
to O
use O
the O
game O
's O
market O
to O
obtain O
real O
currency O
. O

In O
2013 O
, O
South O
Korean O
officials O
released O
information O
stating O
they O
had O
found O
evidence O
that O
North O
Korea O
was O
using O
games O
as O
a O
medium O
for O
infecting O
machines O
and O
launching O
cyber O
attacks O
. O

North O
Korea O
had O
used O
game O
downloads O
to O
infect O
100,000 O
South O
Korean O
machines O
for O
a O
botnet O
used O
to O
launch O
a O
distributed O
denial O
of O
service O
( O
DDoS O
) O
attack O
against O
Incheon O
Airport O
. O

This O
clever O
tactic O
sought O
to O
leverage O
a O
seemingly O
innocent O
game O
as O
a O
force O
multiplier O
in O
order O
to O
amplify O
the O
effects O
of O
a O
DDoS O
attack O
on O
a O
critical O
infrastructure O
target O
. O

However O
, O
in O
this O
case O
, O
there O
was O
little O
impact O
on O
the O
target O
. O

North O
Korea O
's O
intelligence O
program O
is O
one O
of O
its O
strongest O
military O
assets O
, O
providing O
foundational O
support O
for O
all O
other O
military O
operations O
. O

The O
regime O
's O
cyber O
warfare O
capabilities O
, O
in O
particular O
, O
rely O
heavily O
on O
open-source O
intelligence O
( O
OSINT O
) O
collection O
and O
cyber-espionage O
. O

As O
noted O
in O
a O
CIA O
publication O
, O
'' O
It O
is O
a O
significant O
irony O
of O
our O
information O
age O
that O
open-source O
intelligence O
is O
contributing O
to O
the O
survival O
and O
development O
of O
one O
of O
the O
world O
's O
most O
secretive O
regimes O
. O

'' O
Historically O
, O
the O
primary O
goals O
of O
the O
regime O
's O
intelligence O
program O
included O
collection O
and O
dissemination O
of O
intelligence O
concerning O
any O
possible O
political O
, O
military O
, O
or O
economic O
threat O
to O
the O
regime O
's O
security O
and O
stability O
. O

Secondary O
goals O
have O
included O
'' O
acquisition O
of O
foreign O
military O
and O
civilian O
technologies O
and O
equipment O
, O
support O
of O
the O
DPRK O
's O
foreign O
policy O
goals O
, O
training O
and O
support O
for O
foreign O
revolutionary O
and O
terrorist O
organizations O
, O
and O
the O
acquisition O
of O
foreign O
capital O
for O
state O
and O
intelligence O
operations O
. O

'' O
North O
Korea O
has O
a O
broad O
reach O
for O
intelligence O
collection O
, O
which O
extends O
to O
cyber O
intelligence O
. O

In O
April O
2013 O
, O
Solutionary O
, O
a O
company O
providing O
managed O
security O
services O
, O
reported O
a O
marked O
increase O
in O
both O
overt O
attacks O
and O
information O
gathering O
attempts O
originating O
from O
North O
Korean O
IPs O
. O

Solutionary O
refers O
to O
any O
overt O
external O
attacks O
on O
company O
networks O
or O
attempts O
to O
steal O
data O
as O
'' O
touches O
. O

'' O
They O
reportedly O
recorded O
12,473 O
of O
these O
touches O
in O
February O
2013 O
, O
11,000 O
of O
which O
were O
directed O
at O
a O
single O
financial O
institution O
. O

As O
a O
baseline O
, O
Solutionary O
noted O
that O
typically O
only O
200 O
incidents O
per O
month O
are O
traced O
to O
North O
Korean O
origin O
. O

This O
is O
an O
interesting O
claim O
, O
considering O
that O
attacks O
attributed O
to O
North O
Korea O
are O
usually O
routed O
through O
other O
countries O
. O

As O
mentioned O
above O
, O
a O
faction O
of O
ethnic O
North O
Koreans O
residing O
in O
Japan O
, O
known O
as O
the O
Chongryon O
, O
are O
critical O
to O
North O
Korea O
's O
cyber O
and O
intelligence O
programs O
and O
help O
generate O
hard O
currency O
for O
the O
regime O
. O

The O
Chongryon O
headquarters O
has O
been O
recognized O
as O
the O
de O
facto O
North O
Korean O
embassy O
in O
Japan O
. O

In O
2012 O
, O
the O
organization O
's O
headquarters O
was O
seized O
to O
pay O
for O
the O
group's O
past O
due O
debts O
. O

It O
was O
then O
purchased O
by O
a O
monk O
named O
Ekan O
Ikeguchi O
, O
who O
let O
the O
Chongryon O
continue O
to O
use O
the O
building O
in O
what O
he O
referred O
to O
as O
a O
'' O
goodwill O
gesture O
'' O
. O

Ikeguchi O
is O
one O
of O
the O
Chongryon's O
many O
ties O
to O
organized O
crime O
. O

Ikeguchi O
was O
arrested O
in O
the O
past O
for O
an O
attempted O
coup O
against O
the O
Japanese O
government O
. O

He O
also O
has O
ties O
to O
the O
political O
group O
Nihon O
Seinensya O
, O
which O
is O
involved O
in O
illegal O
activities O
in O
conjunction O
with O
the O
yakuza O
syndicate O
Sumiyoshi-kai O
, O
which O
imports O
and O
sells O
amphetamines O
made O
in O
North O
Korea O
. O

North O
Korea O
also O
has O
black O
market O
ties O
to O
Sumiyoshi-kai's O
rival O
syndicate O
, O
Yamaguchi-gumi O
. O

Many O
members O
of O
the O
Kodo-kai O
, O
Yamaguchi-gumi O
's O
ruling O
faction O
, O
are O
Korean-Japanese O
, O
with O
ties O
to O
North O
Korea O
. O

Masahiro O
Namikawa O
, O
leader O
of O
the O
drug O
trafficking O
Seido-kai O
yakuza O
organization O
, O
also O
has O
ties O
to O
the O
Chongryon O
. O

The O
Chongryon O
operate O
at O
least O
two O
websites O
, O
chongryon.com O
, O
which O
is O
in O
Japanese O
, O
and O
korea- O
np.co.jp O
. O

WHOIS O
records O
for O
chongryon.com O
indicate O
that O
it O
was O
registered O
by O
'' O
guanin O
o O
'' O
using O
the O
email O
address O
park2 O
@ O
mac.com O
. O

The O
WHOIS O
information O
for O
korea-np.co.jp O
. O

shows O
that O
it O
was O
registered O
by O
Choson O
Shinbo O
Company O
Inc O
. O

The O
WHOIS O
records O
for O
these O
sites O
can O
be O
found O
in O
Appendix O
A. O
Additionally O
, O
the O
Chongryon O
operate O
a O
ferry O
called O
the O
Mangyongbong-92 O
, O
the O
only O
direct O
transit O
from O
Japan O
to O
North O
Korea O
. O

In O
2003 O
, O
they O
were O
suspected O
of O
using O
the O
ferry O
to O
smuggle O
missile O
parts O
. O

In O
2006 O
, O
the O
ferry O
was O
temporarily O
banned O
from O
Japanese O
waters O
when O
Japanese O
officials O
discovered O
the O
Chongryon O
were O
using O
it O
to O
smuggle O
dual-use O
electronics O
to O
North O
Korea O
to O
be O
used O
for O
military O
purposes O
. O

North O
Korea O
has O
a O
global O
network O
of O
state-run O
businesses O
located O
in O
30 O
to O
40 O
countries O
that O
is O
used O
for O
espionage O
activities O
. O

The O
Reconnaissance O
General O
Bureau O
is O
responsible O
for O
oversight O
of O
this O
network O
. O

The O
businesses O
include O
cafes O
and O
other O
non-suspect O
establishments O
. O

The O
highest O
concentration O
of O
these O
is O
in O
China O
. O

Members O
of O
this O
espionage O
network O
reportedly O
'' O
send O
more O
than O
$ O
100 O
million O
in O
cash O
per O
year O
to O
the O
regime O
and O
provide O
cover O
for O
spies O
. O

'' O
These O
establishments O
are O
also O
used O
for O
money O
laundering O
and O
drug O
trafficking O
. O

The O
regime O
is O
also O
known O
to O
kidnap O
foreign O
citizens O
and O
use O
them O
as O
instruments O
for O
intelligence O
. O

Prisoners O
are O
first O
tortured O
and O
psychologically O
conditioned O
to O
bend O
to O
the O
regime O
's O
will O
. O

They O
are O
then O
used O
based O
on O
their O
skillset O
. O

This O
may O
include O
teaching O
their O
language O
to O
North O
Koreans O
, O
spreading O
propaganda O
in O
their O
native O
language O
, O
providing O
translation O
services O
, O
conducting O
military O
training O
, O
or O
other O
skills O
the O
regime O
deems O
useful O
. O

In O
July O
2014 O
, O
Japanese O
officials O
agreed O
to O
lift O
some O
sanctions O
on O
North O
Korea O
when O
the O
regime O
agreed O
to O
investigate O
the O
whereabouts O
of O
Japanese O
citizens O
who O
were O
allegedly O
abducted O
by O
North O
Korean O
agents O
decades O
ago O
. O

Sanctions O
to O
be O
lifted O
include O
the O
ban O
on O
port O
calls O
to O
Japan O
by O
North O
Korean O
ships O
. O

North O
Korea O
has O
also O
infiltrated O
important O
positions O
in O
South O
Korea O
for O
both O
intelligence O
and O
psychological O
operations O
purposes O
. O

In O
2011 O
, O
South O
Korea O
's O
National O
Intelligence O
Service O
reportedly O
discovered O
the O
presence O
of O
Communist O
spies O
. O

These O
spies O
within O
their O
trusted O
circles O
had O
been O
reporting O
back O
to O
North O
Korea O
for O
almost O
10 O
years O
. O

The O
embedded O
spies O
included O
a O
Democratic O
Party O
representative O
. O

According O
to O
the O
agency O
, O
the O
spies O
were O
on O
a O
mission O
to O
infiltrate O
and O
influence O
the O
Democratic O
Party O
and O
to O
gather O
military O
intelligence O
. O

The O
regime O
also O
attempts O
to O
infiltrate O
organizations O
made O
up O
of O
North O
Koreans O
who O
seek O
shelter O
in O
South O
Korea O
, O
in O
order O
to O
gain O
intelligence O
. O

In O
the O
past O
several O
years O
, O
South O
Korea O
has O
arrested O
at O
least O
14 O
defectors O
who O
were O
found O
to O
be O
spies O
. O

These O
intelligence O
collection O
and O
counterintelligence O
capabilities O
are O
an O
attempt O
to O
provide O
the O
regime O
with O
a O
strategic O
asymmetrical O
advantage O
. O

The O
regime O
leverages O
its O
human O
and O
cyber O
resources O
around O
the O
globe O
to O
provide O
an O
influx O
of O
intelligence O
, O
while O
very O
little O
credible O
intelligence O
about O
the O
regime O
's O
activities O
and O
capabilities O
ever O
becomes O
available O
to O
the O
outside O
world O
. O

North O
Korea O
continues O
to O
be O
a O
master O
of O
propaganda O
and O
deception O
and O
leverages O
the O
cyber O
realm O
for O
psychological O
operations O
. O

Modern O
North O
Korean O
psychological O
operations O
tactics O
include O
distribution O
of O
propaganda O
via O
traditional O
media O
outlets O
, O
websites O
, O
and O
social O
media O
. O

Many O
of O
these O
psychological O
operations O
campaigns O
are O
politically O
focused O
. O

According O
to O
Dr. O
Andrei O
Lankov O
, O
the O
North O
Korean O
government O
has O
'' O
very O
rational O
and O
highly O
successful O
manipulators O
who O
usually O
get O
what O
they O
want O
by O
outsmarting O
everybody O
else O
in O
the O
process O
. O

'' O
The O
regime O
's O
Unit O
204 O
is O
responsible O
for O
cyber-psychological O
operations O
. O

These O
operations O
are O
PSYOP O
tailored O
for O
the O
cyber O
arena O
. O

In O
order O
to O
be O
successful O
, O
cyber- O
psychological O
campaigns O
require O
speed O
, O
precision O
, O
and O
creativity O
. O

These O
campaigns O
leverage O
the O
phenomenon O
of O
viral O
, O
unverified O
news O
stories O
that O
tend O
to O
rapidly O
propagate O
via O
social O
media O
, O
mobile O
text O
messaging O
, O
and O
other O
electronic O
communications O
. O

This O
phenomenon O
creates O
an O
arena O
for O
strategic O
propagation O
of O
both O
fact O
and O
fiction O
for O
the O
purposes O
of O
sentiment O
manipulation O
. O

Such O
messages O
may O
be O
used O
for O
recruitment O
, O
cyber O
mobilization O
, O
and O
to O
instill O
fear O
in O
a O
target O
population O
. O

Cyber-psychological O
operations O
may O
also O
include O
mental O
suggestion O
using O
technology O
as O
a O
delivery O
mechanism O
for O
subliminal O
cues O
. O

It O
is O
unknown O
whether O
North O
Korea O
possesses O
this O
capability O
. O

North O
Korean O
citizens O
have O
access O
to O
state-approved O
social O
networks O
on O
the O
Kwangmyong O
. O

The O
regime O
has O
a O
limited O
overt O
social O
media O
presence O
on O
the O
Internet O
. O

Some O
of O
the O
known O
social O
media O
platforms O
employed O
by O
the O
regime O
include O
Twitter O
, O
Facebook O
, O
and O
YouTube O
. O

The O
YouTube O
channel O
North O
Korea O
Today O
, O
operated O
by O
user O
rodrigorojo1 O
, O
features O
news O
clips O
from O
North O
Korea O
. O

It O
is O
unclear O
whether O
this O
channel O
is O
officially O
sanctioned O
. O

The O
North O
Korea O
Today O
YouTube O
channel O
also O
has O
corresponding O
profiles O
on O
Twitter O
and O
Facebook O
. O

The O
Uriminzokkiri O
website O
, O
known O
for O
pushing O
juche O
ideology O
and O
anti-American O
and O
anti-South O
Korean O
messages O
, O
has O
accompanying O
social O
media O
profiles O
on O
YouTube O
, O
Google+ O
, O
and O
Facebook O
. O

It O
also O
has O
Twitter O
profiles O
in O
both O
Korean O
and O
English O
. O

North O
Korean O
propaganda O
is O
used O
for O
several O
purposes O
: O
to O
enforce O
the O
ideals O
of O
allies O
and O
sympathizers O
, O
to O
frame O
North O
Korea O
in O
a O
favorable O
light O
to O
outsiders O
, O
to O
sensationalize O
the O
regime O
's O
perceived O
self-reliance O
and O
military O
prowess O
, O
and O
to O
shield O
its O
own O
citizens O
from O
the O
outside O
world O
. O

Juche O
ideology O
and O
indoctrination O
of O
the O
regime's O
youth O
ensure O
support O
of O
the O
local O
population O
. O

North O
Koreans O
accept O
military O
duty O
as O
an O
honor O
and O
strive O
to O
excel O
in O
their O
service O
to O
the O
regime O
. O

In O
the O
spirit O
of O
juche O
, O
the O
regime O
uses O
disinformation O
to O
'' O
hide O
lapses O
or O
tout O
accomplishments O
that O
may O
have O
never O
been O
achieved O
. O

'' O
Limiting O
citizen O
access O
to O
the O
outside O
world O
by O
instituting O
the O
Kwangmyong O
intranet O
, O
North O
Korea O
ensures O
its O
citizens O
are O
not O
exposed O
to O
outside O
information O
that O
is O
counterproductive O
to O
citizen O
indoctrination O
or O
in O
conflict O
with O
juche O
ideals O
. O

North O
Korea O
portrays O
the O
West O
, O
particularly O
the O
United O
States O
, O
as O
an O
enemy O
. O

The O
regime O
uses O
this O
strategy O
of O
shifting O
the O
population's O
negative O
sentiments O
toward O
an O
external O
entity O
to O
keep O
its O
citizens O
ignorant O
of O
North O
Korea O
's O
own O
economic O
hardship O
, O
regime O
brutality O
, O
and O
systemic O
incompetence O
. O

For O
example O
, O
prior O
to O
Kim O
Jong O
Il O
's O
death O
in O
2011 O
, O
North O
Korean O
media O
altered O
photos O
of O
their O
'' O
Dear O
Leader O
'' O
to O
make O
him O
appear O
younger O
and O
healthier O
than O
he O
really O
was O
. O

This O
became O
obvious O
when O
the O
altered O
photos O
were O
compared O
to O
those O
taken O
by O
Western O
media O
around O
the O
same O
time O
. O

According O
to O
Dr. O
Andrei O
Lankov O
, O
'' O
North O
Koreans O
now O
have O
a O
much O
better O
understanding O
of O
what O
is O
going O
on O
in O
the O
outside O
than O
they O
did O
before O
. O

This O
is O
largely O
thanks O
to O
the O
spread O
of O
DVDs O
and O
video O
content O
in O
the O
country O
, O
but O
also O
because O
some O
of O
them O
have O
been O
to O
China O
and O
talk O
about O
what O
they O
have O
seen…many O
[ O
of O
] O
them O
sincerely O
believe O
that O
the O
United O
States O
remains O
ready O
to O
attack O
at O
any O
moment O
and O
that O
Japan O
is O
an O
incurably O
aggressive O
place…nearly O
all O
of O
them O
swallow O
the O
official O
propaganda O
myths O
about O
the O
Korean O
War O
being O
started O
by O
the O
'American O
Imperialists' O
who O
invaded O
them O
. O

Hence O
, O
they O
see O
the O
outside O
world O
as O
an O
inherently O
dangerous O
place O
. O

'' O
Some O
human O
rights O
groups O
seek O
to O
reach O
out O
to O
North O
Korean O
citizens O
and O
break O
them O
from O
this O
isolation O
. O

In O
August O
2014 O
, O
the O
New O
York-based O
charity O
Human O
Rights O
Foundation O
sponsored O
a O
hackathon O
in O
San O
Francisco O
called O
'' O
Hack O
North O
Korea O
'' O
to O
find O
new O
ways O
to O
get O
information O
in O
, O
out O
, O
and O
around O
North O
Korea O
. O

The O
event O
brought O
together O
many O
programmers O
, O
human O
rights O
campaigners O
, O
and O
defectors O
. O

North O
Korea O
even O
uses O
'' O
trolling O
'' O
as O
a O
PSYOP O
tactic O
. O

On O
the O
Internet O
, O
'' O
trolls O
'' O
are O
users O
who O
post O
messages O
that O
are O
often O
crass O
, O
controversial O
, O
inflammatory O
, O
or O
offensive O
, O
in O
order O
to O
evoke O
a O
strong O
reaction O
or O
influence O
a O
reader O
's O
opinion O
. O

Often O
, O
the O
motivation O
for O
trolling O
is O
simply O
for O
the O
troll O
's O
enjoyment O
. O

The O
rude O
and O
offensive O
trolling O
tactics O
are O
in O
stark O
contrast O
to O
traditional O
forms O
of O
persuasive O
rhetoric O
. O

However O
, O
North O
Korea O
reportedly O
utilizes O
over O
200 O
military O
intelligence O
operatives O
to O
troll O
South O
Korean O
message O
boards O
and O
social O
media O
pages O
with O
pro-North O
Korean O
sentiments. O
< O
/fn O
> O
Matt O
Rhoades O
, O
director O
of O
the O
cyberspace O
and O
security O
program O
at O
the O
Truman O
National O
Security O
Project O
, O
said O
, O
'' O
North O
Korea O
's O
cyber-development O
is O
almost O
just O
a O
new O
harassment O
mechanism O
for O
them O
, O
a O
low-cost O
, O
asymmetric O
method O
to O
harass O
its O
neighbor O
in O
the O
south… O
'' O
Leveraging O
the O
cyber O
and O
intelligence O
resources O
noted O
above O
, O
North O
Korea O
's O
psychological O
operations O
serve O
an O
important O
strategic O
role O
. O

The O
ability O
to O
influence O
outsiders O
, O
while O
effectively O
isolating O
its O
own O
population O
from O
most O
outside O
influence O
, O
allows O
North O
Korea O
to O
remain O
an O
enigma O
. O

Additionally O
, O
in O
line O
with O
its O
PSYOP O
tactics O
, O
North O
Korea O
may O
strategically O
take O
credit O
for O
cyber O
attacks O
that O
were O
, O
in O
reality O
, O
launched O
by O
another O
entity O
. O

Whether O
the O
targeted O
entity O
blames O
North O
Korea O
for O
the O
attacks O
, O
or O
the O
regime O
simply O
takes O
credit O
for O
an O
attack O
that O
has O
not O
yet O
been O
attributed O
, O
several O
PSYOP O
goals O
can O
come O
into O
play O
. O

First O
, O
to O
claim O
credit O
for O
an O
attack O
amplifies O
the O
impact O
of O
a O
show O
of O
force O
, O
particularly O
if O
South O
Korea O
is O
the O
target O
. O

This O
tactic O
can O
be O
used O
to O
stir O
sentiments O
in O
order O
to O
provoke O
a O
reaction O
. O

Second O
, O
North O
Korea O
may O
lay O
claim O
to O
responsibility O
for O
an O
attack O
that O
exceeds O
its O
capabilities O
in O
order O
to O
seem O
more O
technologically O
advanced O
and O
more O
capable O
. O

Third O
, O
any O
success O
, O
or O
the O
appearance O
thereof O
, O
enforces O
the O
juche O
ideal O
of O
regime O
self-sufficiency O
. O

Finally O
, O
North O
Korea O
may O
act O
as O
a O
scapegoat O
and O
claim O
credit O
for O
a O
cyber O
attack O
of O
an O
ally O
such O
as O
China O
so O
the O
attack O
is O
not O
attributed O
to O
the O
real O
actors O
. O

North O
Korea O
reportedly O
has O
the O
electronic O
warfare O
capabilities O
to O
jam O
GPS O
and O
to O
inject O
false O
GPS O
coordinates O
. O

North O
Korea O
demonstrated O
these O
capabilities O
in O
March O
2011 O
by O
jamming O
South O
Korea O
's O
GPS O
signals O
during O
a O
joint O
U.S.-South O
Korea O
military O
exercise O
. O

North O
Korea O
has O
the O
capability O
to O
create O
an O
EMP O
. O

An O
EMP O
is O
a O
sudden O
, O
extreme O
outburst O
of O
atmospheric O
electricity O
creating O
an O
intense O
magnetic O
field O
that O
can O
burn O
out O
electrical O
equipment O
. O

A O
report O
from O
the O
U.S. O
Department O
of O
Homeland O
Security O
( O
DHS O
) O
noted O
North O
Korea O
's O
ability O
to O
deliver O
a O
nuclear O
warhead O
as O
a O
satellite O
over O
the O
South O
Pole O
, O
effectively O
creating O
the O
burst O
needed O
to O
deliver O
an O
EMP O
targeting O
the O
United O
States O
. O

An O
EMP O
could O
effectively O
disrupt O
electronic O
communications O
including O
critical O
infrastructure O
components O
such O
as O
telecommunications O
, O
financial O
institutions O
, O
the O
energy O
sector O
, O
transportation O
, O
food O
and O
water O
delivery O
, O
emergency O
services O
, O
and O
space O
systems O
. O

North O
Korea O
reportedly O
acquired O
its O
EMP O
technology O
from O
Russia O
. O

North O
Korea O
also O
has O
a O
drone O
program O
. O

The O
regime O
reportedly O
acquired O
its O
first O
drones O
in O
the O
late O
1980 O
's O
or O
early O
1990 O
's O
. O

The O
regime O
's O
drones O
are O
complimentary O
to O
its O
intelligence O
program O
and O
are O
primarily O
used O
for O
surveillance O
. O

In O
early O
2014 O
a O
North O
Korean O
drone O
crashed O
south O
of O
the O
38th O
parallel O
, O
the O
line O
dividing O
North O
Korea O
from O
the O
south O
. O

While O
early O
reports O
noted O
that O
the O
drones O
appeared O
similar O
to O
those O
manufactured O
by O
Chinese O
company O
Tauyuan O
Navigation O
Friend O
Aviation O
Technology O
, O
the O
company O
denied O
involvement O
. O

Stressing O
the O
importance O
of O
the O
regime O
's O
electronic O
warfare O
capabilities O
, O
in O
1999 O
former O
regime O
leader O
Kim O
Jong O
Il O
said O
'' O
The O
basic O
key O
to O
victory O
in O
modern O
warfare O
is O
to O
do O
well O
in O
electronic O
warfare O
. O

'' O
Since O
the O
regime O
's O
advanced O
technology O
lags O
behind O
that O
of O
South O
Korea O
and O
the O
U.S. O
, O
its O
capability O
to O
disrupt O
the O
communications O
of O
these O
perceived O
adversaries O
is O
a O
vital O
asymmetric O
capability O
. O

North O
Korea O
utilizes O
primary O
and O
secondary O
education O
and O
the O
university O
system O
to O
train O
its O
cyber O
warfare O
operators O
. O

According O
to O
reports O
by O
defectors O
, O
the O
regime O
seeks O
out O
children O
who O
show O
mathematical O
talent O
and O
sends O
them O
through O
rigorous O
advanced O
training O
. O

A O
vintage O
North O
Korean O
animation O
stresses O
the O
importance O
of O
mathematics O
in O
North O
Korean O
education O
. O

The O
short O
film O
follows O
a O
young O
boy O
as O
he O
does O
his O
geometry O
homework O
. O

The O
frustrated O
boy O
begins O
to O
daydream O
then O
has O
visions O
of O
going O
to O
war O
with O
the O
U.S. O
and O
needing O
geometry O
to O
effectively O
calculate O
missile O
trajectory O
during O
the O
battle O
. O

Science O
and O
technology O
students O
are O
expected O
to O
learn O
foreign O
languages O
, O
which O
may O
include O
Chinese O
, O
Japanese O
, O
and O
English.233 O
Student O
emails O
, O
chats O
, O
and O
web O
browsing O
activities O
are O
heavily O
monitored O
. O

Around O
age O
twelve O
or O
thirteen O
, O
chosen O
students O
are O
enrolled O
in O
accelerated O
computer O
courses O
at O
First O
and O
Second O
Geumseong O
Senior-Middle O
Schools O
. O

The O
successful O
students O
are O
then O
sent O
to O
Kim O
Il-sung O
University O
, O
Kim O
Chaek O
University O
of O
Technology O
, O
or O
the O
Command O
Automation O
University O
, O
traditionally O
known O
as O
Mirim O
University O
. O

Kim O
Il-sung O
University O
's O
computer O
center O
was O
started O
in O
1985 O
. O

Its O
computer O
courses O
have O
a O
heavy O
programming O
element O
. O

The O
university O
reportedly O
developed O
the O
Intelligent O
Locker O
hard O
disc O
protection O
program O
, O
Worluf O
Antivirus O
, O
SIMNA O
( O
simulation O
and O
system O
analysis O
program O
) O
, O
a O
war O
games O
program O
, O
a O
hepatitis O
diagnosis O
and O
prescription O
system O
, O
and O
a O
C++ O
program O
development O
tool O
called O
FC O
2.0 O
. O

Kim O
Il-sung O
University O
also O
has O
programs O
focusing O
on O
nuclear O
research O
. O

Kim O
Chaek O
University O
of O
Technology O
was O
established O
in O
1948 O
. O

In O
the O
late O
1990s O
, O
it O
began O
to O
restructure O
its O
computer-focused O
courses O
to O
reflect O
more O
modern O
technologies O
. O

As O
of O
2002 O
, O
the O
university O
had O
three O
colleges O
focusing O
on O
computer O
science O
, O
information O
science O
and O
technology O
, O
and O
machine O
science O
. O

Software O
developed O
by O
the O
university O
includes O
Computer O
Fax O
and O
SGVision O
, O
an O
image-reprocessing O
program O
used O
for O
steganography O
. O

Students O
and O
instructors O
must O
submit O
a O
formal O
request O
for O
permission O
in O
order O
to O
use O
the O
Internet O
for O
research O
. O

The O
Command O
Automation O
University O
periodically O
chooses O
around O
100 O
students O
for O
an O
intensive O
five-year O
course O
prior O
to O
their O
assignment O
to O
serve O
in O
cyber O
intelligence O
and O
cyber O
warfare O
capacities O
. O

Programs O
at O
the O
Command O
Automation O
University O
include O
command O
automation O
, O
computers O
, O
programming O
, O
automated O
reconnaissance O
, O
and O
electronic O
warfare O
. O

Other O
students O
attend O
a O
two-year O
accelerated O
university O
program O
, O
then O
study O
abroad O
in O
Russia O
or O
China O
before O
they O
are O
assigned O
to O
a O
cyber-operator O
role O
. O

The O
elite O
cyber O
operators O
are O
given O
special O
incentives O
. O

For O
example O
, O
parents O
of O
students O
graduating O
from O
the O
cyber O
program O
with O
top O
scores O
are O
given O
the O
opportunity O
to O
live O
in O
Pyongyang O
; O
and O
married O
cyber O
operators O
are O
given O
housing O
, O
a O
food O
allowance O
, O
and O
a O
stipend O
if O
operating O
overseas O
. O

Due O
to O
the O
nature O
of O
their O
profession O
, O
these O
cyber O
elite O
are O
some O
of O
the O
only O
North O
Koreans O
allowed O
to O
access O
the O
outside O
Internet O
. O

While O
this O
report O
focuses O
on O
North O
Korea O
's O
cyber O
warfare O
capabilities O
, O
these O
capabilities O
can O
not O
be O
fully O
separated O
from O
the O
implications O
of O
partnerships O
with O
countries O
known O
to O
deal O
in O
illegal O
weapons O
trade O
with O
the O
regime O
. O

Now O
that O
cyberspace O
has O
become O
a O
legitimate O
arena O
for O
warfare O
, O
these O
nations O
are O
also O
potential O
allies O
in O
the O
cyber O
realm O
. O

For O
this O
reason O
, O
the O
regime O
's O
key O
political O
and O
military O
relationships O
are O
explored O
below O
. O

North O
Korea O
has O
a O
longstanding O
historical O
relationship O
with O
China O
. O

During O
the O
Korean O
War O
( O
1950- O
1953 O
) O
, O
China O
allied O
with O
North O
Korea O
's O
Communist O
forces O
. O

China O
has O
also O
provided O
ongoing O
political O
and O
economic O
support O
to O
the O
regime O
's O
leadership O
and O
is O
a O
primary O
trade O
partner O
. O

North O
Korea O
is O
economically O
dependent O
on O
China O
. O

North O
Korea O
gets O
an O
estimated O
90 O
percent O
of O
its O
energy O
imports O
, O
80 O
percent O
of O
its O
consumer O
goods O
, O
and O
45 O
percent O
of O
its O
food O
supply O
from O
China O
. O

This O
relationship O
is O
prudent O
– O
in O
the O
event O
of O
a O
military O
conflict O
, O
China O
can O
strategically O
use O
North O
Korea O
as O
a O
buffer O
zone O
between O
itself O
and O
South O
Korea O
, O
where O
many O
U.S. O
military O
personnel O
are O
stationed O
. O

Chinese O
aid O
to O
North O
Korea O
also O
deters O
the O
likelihood O
that O
the O
regime O
will O
collapse O
, O
resulting O
in O
internal O
destabilization O
that O
could O
catalyze O
a O
U.S.-China O
conflict O
. O

North O
Korea O
relies O
heavily O
on O
China O
for O
technological O
resources O
. O

As O
noted O
above O
, O
North O
Korea O
relies O
on O
China O
's O
Unicom O
for O
Internet O
access O
. O

Additionally O
, O
the O
regime O
sends O
some O
of O
its O
cyber O
warriors O
to O
train O
in O
China O
and O
stations O
a O
portion O
of O
its O
Unit O
121 O
personnel O
in O
Shenyang O
. O

Some O
of O
North O
Korea O
's O
official O
websites O
are O
hosted O
in O
China O
, O
and O
KCC O
has O
a O
branch O
office O
there O
. O

North O
Korea O
also O
relies O
on O
China O
to O
provide O
much O
of O
its O
network O
hardware O
, O
including O
servers O
and O
routers O
. O

North O
Korea O
has O
a O
long O
history O
of O
ties O
to O
Russia O
. O

The O
former O
Soviet O
Union O
was O
the O
major O
sponsor O
of O
the O
North O
Korean O
state O
and O
a O
major O
trading O
partner O
. O

Following O
the O
dissolution O
of O
the O
Soviet O
Union O
, O
aid O
to O
North O
Korea O
was O
halted O
and O
trade O
diminished O
significantly O
. O

This O
chain O
of O
events O
contributed O
to O
North O
Korea O
's O
eventual O
economic O
collapse O
, O
as O
it O
could O
not O
survive O
without O
aid O
. O

North O
Korea O
currently O
has O
a O
collaborative O
relationship O
with O
Russia O
in O
the O
cyber O
realm O
. O

The O
regime's O
CSTIA O
relies O
on O
Russia O
as O
one O
of O
several O
sources O
for O
technical O
data O
. O

North O
Korea O
also O
sends O
some O
of O
its O
cyber O
warriors O
to O
train O
in O
Russia O
, O
and O
the O
regime O
reportedly O
acquired O
its O
EMP O
technology O
from O
there O
. O

Political O
ties O
between O
Russia O
and O
North O
Korea O
have O
become O
stronger O
in O
recent O
months O
. O

In O
2014 O
, O
potentially O
as O
a O
result O
of O
the O
U.S. O
response O
to O
the O
Russian-Ukranian O
conflict O
, O
Russia O
began O
to O
strengthen O
ties O
with O
North O
Korea O
. O

Negotiations O
reportedly O
included O
promises O
of O
trade O
and O
development O
projects O
. O

Narushige O
Michishita O
, O
a O
North O
Korea O
and O
Asia O
security O
expert O
at O
Japan's O
National O
Graduate O
Institute O
for O
Policy O
Studies O
, O
stated O
'' O
By O
strengthening O
its O
relationship O
with O
North O
Korea O
, O
Russia O
is O
trying O
to O
enhance O
its O
bargaining O
position O
vis-à-vis O
the O
United O
States O
and O
Japan O
. O

'' O
Russia O
also O
recently O
forgave O
most O
of O
the O
regime O
's O
debts O
. O

North O
Korea O
and O
Iran O
have O
longstanding O
political O
and O
military O
ties O
. O

North O
Korea O
supplied O
Iran O
with O
conventional O
arms O
during O
the O
Iran-Iraq O
War O
. O

Iran O
and O
North O
Korea O
reportedly O
collaborate O
closely O
in O
ballistic O
missile O
development O
efforts O
. O

In O
the O
past O
, O
Iran O
provided O
the O
North O
Korean O
regime O
with O
necessary O
funds O
and O
oil O
in O
exchange O
for O
missile O
parts O
and O
technology O
. O

In O
2009 O
, O
a O
North O
Korean O
plane O
transporting O
35 O
tons O
of O
weapons O
and O
allegedly O
bound O
for O
Iran O
was O
seized O
after O
making O
an O
unscheduled O
stop O
in O
Bangkok O
, O
Thailand O
. O

That O
same O
year O
, O
United O
Arab O
Emirates O
seized O
a O
ship O
bound O
for O
Iran O
that O
was O
transporting O
several O
containers O
of O
North O
Korean O
weapons O
, O
including O
rocket-propelled O
grenades O
and O
ammunition O
. O

Reportedly O
, O
the O
customer O
was O
a O
company O
affiliated O
with O
Iran O
's O
Islamic O
Revolutionary O
Guard O
Corps O
. O

North O
Korea O
also O
has O
cyberwar O
ties O
with O
Iran O
. O

In O
2012 O
, O
North O
Korea O
and O
Iran O
signed O
a O
technology O
treaty O
to O
help O
combat O
'' O
common O
enemies O
'' O
in O
cyberspace O
. O

The O
treaty O
included O
provisions O
for O
cooperation O
in O
research O
, O
student O
exchanges O
, O
and O
joint O
laboratories O
. O

Joint O
projects O
reportedly O
include O
IT O
information O
sharing O
, O
engineering O
, O
biotechnology O
, O
renewable O
energy O
, O
and O
sustainability O
. O

F-Secure O
's O
Mikko O
Hypponen O
stated O
, O
'' O
It O
's O
highly O
likely O
that O
one O
of O
the O
reasons O
for O
this O
co-operation O
is O
for O
them O
to O
work O
together O
regarding O
their O
cyber O
defence O
and O
cyber O
offense O
strategies O
'' O
. O

Hypponen O
cited O
Flame O
malware O
as O
a O
possible O
triggering O
event O
for O
the O
creation O
of O
this O
treaty O
. O

Others O
also O
suspect O
that O
Iran O
and O
North O
Korea O
's O
mutual O
interest O
in O
development O
of O
nuclear O
weapons O
and O
the O
need O
to O
protect O
refineries O
against O
malware O
such O
as O
Stuxnet O
were O
driving O
factors O
in O
the O
establishment O
of O
the O
treaty O
. O

U.S. O
House O
Foreign O
Affairs O
Committee O
leaders O
assert O
that O
the O
treaty O
indicates O
North O
Korea O
and O
Iran O
are O
collaborating O
on O
a O
joint O
nuclear O
weapons O
program O
. O

Additionally O
, O
North O
Korea O
, O
in O
conjunction O
with O
Iran O
and O
Syria O
, O
reportedly O
supports O
both O
Hamas O
and O
Hezbollah O
in O
procuring O
kinetic O
weaponry O
and O
communications O
equipment O
and O
in O
establishing O
operational O
infrastructure O
. O

North O
Korea O
has O
both O
a O
cyber O
relationship O
and O
kinetic O
weapons O
ties O
with O
Syria O
. O

KCC O
reportedly O
has O
a O
branch O
in O
Syria O
. O

In O
2007 O
, O
Israel O
launched O
an O
airstrike O
, O
destroying O
a O
Syrian O
target O
that O
was O
allegedly O
a O
nuclear O
facility O
under O
construction O
with O
North O
Korea O
's O
assistance O
. O

U.S. O
officials O
noted O
the O
facility O
was O
modeled O
on O
the O
North O
Korean O
nuclear O
reactor O
at O
Yongbyon O
. O

The O
North O
Korea-Syria O
relationship O
becomes O
more O
important O
in O
the O
context O
of O
both O
countries O
' O
ties O
with O
Iran O
. O

As O
noted O
above O
, O
Iran O
, O
North O
Korea O
, O
and O
Syria O
jointly O
provide O
support O
to O
extremist O
groups O
Hamas O
and O
Hezbollah O
. O

Additionally O
, O
as O
we O
explored O
in O
HPSR O
Security O
Briefing O
Episode O
11 O
, O
Iran O
and O
Syria O
's O
military O
alliances O
extend O
to O
joint O
SIGINT O
and O
cyber O
operations O
. O

North O
Korea O
also O
has O
an O
interesting O
relationship O
with O
Cuba O
– O
one O
that O
includes O
supplying O
weapons O
and O
apparent O
attempts O
to O
illegally O
smuggle O
weapons O
. O

In O
2013 O
, O
a O
North O
Korean O
cargo O
ship O
on O
its O
return O
voyage O
was O
stopped O
near O
the O
Panama O
Canal O
. O

The O
ship O
was O
carrying O
surface-to-air O
missile O
parts O
, O
disguised O
as O
containers O
of O
sugar O
. O

In O
an O
attempt O
to O
save O
face O
, O
Cuba O
's O
Ministry O
of O
Foreign O
Affairs O
stated O
that O
the O
cargo O
included O
'' O
240 O
metric O
tons O
of O
obsolete O
defensive O
weapons O
-- O
two O
anti- O
aircraft O
missile O
complexes O
Volga O
and O
Pechora O
, O
nine O
missiles O
in O
parts O
and O
spares O
, O
two O
Mig-21 O
Bis O
and O
15 O
motors O
for O
this O
type O
of O
airplane O
, O
all O
of O
it O
manufactured O
in O
the O
mid-20th O
century O
-- O
to O
be O
repaired O
and O
returned O
to O
Cuba O
. O

'' O
Experts O
said O
the O
cargo O
appeared O
to O
include O
a O
SNR-75 O
Fan O
Song O
fire-control O
radar O
system O
for O
an O
SA-2 O
missile O
, O
a O
Soviet-era O
missile O
system O
that O
was O
also O
used O
in O
Cuba O
. O

Following O
the O
incident O
, O
Fidel O
Castro O
credited O
former O
North O
Korean O
leader O
Kim O
Il-Sung O
for O
providing O
Cuba O
with O
weapons O
near O
the O
end O
of O
the O
Cold O
War O
. O

Weapons O
included O
100,000 O
AK O
rifles O
and O
necessary O
ammunition O
. O

While O
no O
apparent O
cyber O
relationship O
exists O
between O
North O
Korea O
and O
Cuba O
at O
this O
time O
, O
their O
track O
record O
for O
weapons O
trade O
means O
the O
potential O
for O
future O
collaboration O
in O
the O
cyber O
realm O
can O
not O
be O
discounted O
. O

 O
North O
Korea O
gains O
access O
to O
33 O
South O
Korean O
military O
wireless O
communication O
networks O
 O
The O
U.S. O
State O
Department O
is O
attacked O
by O
entities O
in O
the O
East O
Asia-Pacific O
region O
. O

The O
attacks O
coincided O
with O
State O
Department O
negotiations O
with O
North O
Korea O
regarding O
the O
regime O
's O
nuclear O
missile O
tests O
. O

( O
June O
) O
 O
A O
South O
Korean O
military O
official O
states O
North O
Korea O
's O
Unit O
121 O
has O
breached O
South O
Korean O
and O
U.S. O
military O
entities O
. O

( O
July O
) O
 O
North O
Korea O
states O
that O
it O
is O
'' O
fully O
ready O
for O
any O
form O
of O
high-tech O
war O
. O

'' O
( O
June O
) O
 O
DarkSeoul O
DDoS O
and O
disk O
wiping O
malware O
targeting O
South O
Korean O
and O
U.S. O
government O
, O
media O
outlet O
, O
and O
financial O
websites O
. O

These O
attacks O
also O
coincided O
with O
U.S O
. O

Independence O
Day O
. O

( O
July O
) O
 O
Malware O
for O
'' O
Operation O
Troy O
'' O
was O
likely O
planted O
. O

It O
is O
interesting O
to O
note O
that O
much O
of O
North O
Korea O
's O
cyber O
activity O
follows O
a O
distinct O
pattern O
. O

Analysis O
of O
North O
Korean O
cyber O
activity O
gives O
insight O
into O
these O
patterns O
and O
also O
helps O
tie O
together O
North O
Korea O
's O
strategic O
, O
tactical O
, O
and O
operational O
capabilities O
. O

Strategic O
capabilities O
refer O
to O
the O
assets O
used O
in O
support O
of O
a O
long-term O
, O
overarching O
goal O
. O

Tactical O
capabilities O
refer O
to O
the O
methods O
and O
maneuvers O
actually O
implemented O
in O
pursuit O
of O
the O
strategic O
goal O
. O

Operational O
capabilities O
refer O
to O
the O
potential O
use O
of O
these O
capabilities O
. O

In O
2004 O
, O
in O
response O
to O
the O
annual O
U.S. O
– O
South O
Korea O
joint O
military O
exercises O
, O
North O
Korea O
reportedly O
gained O
access O
to O
33 O
South O
Korean O
military O
wireless O
communication O
networks O
. O

The O
next O
significant O
cyber O
attack O
attributed O
to O
North O
Korea O
was O
in O
June O
2006 O
. O

The O
U.S. O
State O
Department O
was O
attacked O
by O
entities O
in O
the O
East O
Asia-Pacific O
region O
. O

The O
attacks O
coincided O
with O
State O
Department O
negotiations O
with O
North O
Korea O
regarding O
the O
regime O
's O
nuclear O
missile O
tests O
. O

In O
July O
2006 O
, O
North O
Korea O
's O
Unit O
121 O
reportedly O
breached O
South O
Korean O
and O
U.S. O
military O
entities O
. O

This O
attack O
was O
concurrent O
with O
the O
regime O
's O
test-fire O
of O
at O
least O
one O
long-range O
missile O
and O
several O
medium-range O
missiles O
. O

2007 O
was O
politically O
tumultuous O
for O
North O
Korea O
. O

Following O
multi-national O
talks O
, O
the O
UN's O
International O
Atomic O
Energy O
Agency O
( O
IAEA O
) O
ordered O
the O
shutdown O
of O
the O
regime O
's O
nuclear O
facilities O
in O
Yongbyon O
in O
July O
. O

Its O
nuclear O
efforts O
temporarily O
thwarted O
, O
North O
Korea O
tested O
a O
logic O
bomb O
in O
October O
2007 O
. O

In O
April O
2009 O
, O
North O
Korea O
ejected O
IAEA O
and O
U.S. O
nuclear O
compliance O
officials O
. O

The O
regime O
indicated O
refusal O
to O
comply O
with O
any O
UN O
agreements O
regarding O
nuclear O
weaponry O
and O
announced O
it O
would O
reinstate O
its O
nuclear O
materials O
production O
. O

The O
next O
month O
, O
North O
Korea O
conducted O
an O
underground O
nuclear O
test O
and O
voiced O
its O
confidence O
that O
the O
regime O
was O
well O
on O
its O
way O
to O
producing O
viable O
nuclear O
technology O
. O

The O
UN O
called O
an O
emergency O
meeting O
condemning O
the O
nuclear O
weapons O
test O
, O
and O
South O
Korea O
joined O
the O
Proliferation O
Security O
Initiative O
( O
PSI O
) O
. O

North O
Korea O
issued O
a O
statement O
via O
KCNA O
calling O
South O
Korea O
's O
involvement O
in O
PSI O
an O
act O
of O
war O
. O

In O
June O
2009 O
, O
North O
Korea O
stated O
that O
it O
was O
'' O
fully O
ready O
for O
any O
form O
of O
high-tech O
war O
. O

'' O
The O
following O
month O
, O
DDoS O
and O
disk O
wiping O
malware O
, O
later O
known O
as O
DarkSeoul O
, O
targeted O
South O
Korean O
and O
U.S. O
government O
entities O
, O
media O
outlets O
, O
and O
financial O
websites O
. O

The O
attacks O
coincided O
with O
U.S O
. O

Independence O
Day O
. O

Other O
malware O
used O
for O
Operation O
Troy O
was O
also O
planted O
. O

Operation O
Troy O
would O
continue O
for O
several O
years O
, O
largely O
undetected O
. O

In O
early O
2011 O
, O
political O
and O
military O
tensions O
were O
high O
. O

In O
February O
, O
James O
Clapper O
, O
United O
States O
Director O
of O
National O
Intelligence O
, O
testified O
that O
North O
Korea O
likely O
had O
undeclared O
uranium O
enrichment O
facilities O
as O
part O
of O
its O
nuclear O
weapons O
program O
. O

In O
March O
2011 O
, O
South O
Korean O
media O
, O
financial O
, O
and O
critical O
infrastructure O
targets O
suffered O
a O
DDoS O
and O
disk-wiping O
malware O
attack O
later O
known O
as O
the O
'' O
10 O
Days O
of O
Rain O
'' O
. O

U.S. O
and O
South O
Korean O
military O
entities O
were O
also O
targeted O
by O
DDoS O
during O
this O
attack O
. O

The O
attack O
used O
the O
DarkSeoul O
malware O
. O

North O
Korea O
also O
disrupted O
South O
Korean O
GPS O
signals O
. O

Additionally O
, O
North O
Korean O
actors O
reportedly O
attempted O
a O
DDoS O
attack O
against O
South O
Korea O
's O
Incheon O
Airport O
that O
same O
month O
. O

These O
incidents O
coincided O
with O
the O
annual O
U.S. O
– O
South O
Korea O
joint O
military O
exercises O
. O

The O
following O
month O
, O
North O
Korean O
actors O
reportedly O
launched O
a O
DDoS O
attack O
against O
South O
Korea O
's O
Nonghyup O
bank O
. O

In O
2012 O
, O
an O
attack O
on O
South O
Korean O
Newspaper O
JoongAng O
Ilbo O
was O
attributed O
to O
North O
Korean O
actors O
. O

This O
attack O
also O
coincided O
with O
the O
timing O
of O
the O
annual O
joint O
U.S. O
– O
South O
Korea O
military O
exercises O
. O

In O
September O
2012 O
, O
North O
Korea O
signed O
a O
cyber O
treaty O
with O
Iran O
, O
agreeing O
the O
two O
nations O
would O
collaborate O
to O
combat O
'' O
common O
enemies O
'' O
in O
cyberspace O
. O

The O
week O
of O
March O
11 O
, O
2013 O
, O
the O
U.S. O
and O
South O
Korea O
began O
their O
annual O
joint O
military O
exercise O
near O
the O
Korean O
Peninsula O
. O

Like O
clockwork O
, O
attacks O
attributed O
to O
North O
Korea O
and O
now O
known O
as O
the O
March O
20 O
attacks O
targeted O
three O
South O
Korean O
media O
outlets O
and O
Shinhan O
, O
Nonghyup O
, O
and O
Jeju O
banks O
. O

North O
Korea O
also O
exhibited O
other O
hostile O
activity O
at O
that O
time O
. O

North O
Korea O
cut O
communication O
with O
Seoul O
and O
announced O
it O
had O
scrapped O
the O
1953 O
armistice O
between O
the O
two O
Koreas O
. O

North O
Korea O
's O
foreign O
ministry O
also O
issued O
a O
statement O
that O
it O
perceived O
this O
exercise O
as O
a O
precursor O
to O
invasion O
and O
that O
the O
regime O
would O
respond O
with O
a O
'' O
strong O
military O
counteraction O
'' O
if O
the O
situation O
escalated O
. O

That O
same O
week O
, O
the O
North O
Korean O
military O
conducted O
a O
drone O
attack O
simulation O
. O

On O
March O
18 O
, O
the O
Uriminzokkiri O
YouTube O
channel O
posted O
an O
anti-U.S. O
video O
entitled O
'' O
Firestorms O
Will O
Rain O
on O
the O
Headquarters O
of O
War O
'' O
that O
showed O
a O
depiction O
of O
the O
White O
House O
in O
crosshairs O
, O
followed O
by O
an O
explosion O
. O

In O
May O
2013 O
, O
DarkSeoul O
malware O
was O
used O
to O
attack O
several O
South O
Korean O
financial O
institutions O
; O
and O
in O
June O
, O
DarkSeoul B-Entity
DDoS I-Entity
attacks I-Entity
were B-Action
launched I-Action
against B-Modifier
the B-Entity
South I-Entity
Korean I-Entity
government I-Entity
's I-Entity
DNS I-Entity
server I-Entity
. O

The O
latter O
took O
place O
on O
June O
25 O
, O
the O
anniversary O
of O
the O
start O
of O
the O
Korean O
War O
. O

As O
evidenced O
above O
, O
much O
of O
North O
Korea O
's O
cyber O
activity O
coincides O
with O
the O
annual O
U.S. O
– O
South O
Korea O
joint O
military O
exercises O
. O

Attacks O
not O
following O
that O
pattern O
were O
typically O
in O
response O
to O
political O
events O
impacting O
the O
regime O
or O
correlated O
with O
significant O
dates O
, O
such O
as O
the O
anniversary O
of O
the O
start O
of O
the O
Korean O
War O
. O

The O
regime O
's O
strategic O
assets O
and O
tactical O
capabilities O
in O
the O
cyber O
arena O
seem O
to O
have O
evolved O
only O
slightly O
since O
2009 O
. O

Most O
of O
the O
attacks O
attributed O
to O
North O
Korea O
employ O
limited O
tactics O
, O
and O
their O
operational O
capability O
demonstrates O
an O
increase O
in O
the O
frequency O
and O
volume O
of O
attacks O
but O
is O
otherwise O
unimpressive O
to O
date O
. O

In O
June O
2014 O
, O
the O
regime O
demanded O
cancellation O
of O
the O
annual O
U.S. O
- O
South O
Korea O
joint O
military O
exercise O
, O
attempting O
to O
use O
participation O
in O
the O
upcoming O
Asian O
Games O
as O
a O
bargaining O
chip O
. O

The O
regime O
's O
demands O
may O
have O
had O
other O
political O
motivations O
, O
as O
they O
preceded O
the O
July O
2014 O
meeting O
between O
South O
Korean O
president O
Park O
and O
Chinese O
President O
Xi O
Jinping O
. O

The O
meeting O
centered O
on O
trade O
and O
regional O
security O
issues O
, O
including O
the O
ever-present O
rhetoric O
around O
denuclearization O
of O
North O
Korea O
. O

Both O
leaders O
were O
critical O
of O
Japan O
's O
recent O
announcement O
to O
soften O
sanctions O
on O
North O
Korea O
. O

As O
this O
report O
headed O
to O
press O
, O
the O
annual O
U.S. O
– O
South O
Korea O
joint O
military O
exercises O
were O
underway O
. O

The O
most O
prominent O
North O
Korean O
threat O
actor O
group O
is O
the O
group O
responsible O
for O
the O
DarkSeoul O
malware O
. O

According O
to O
statements O
from O
the O
South O
Korean O
government O
, O
North O
Korea O
's O
Lab O
110 O
were O
the O
actors O
behind O
the O
DarkSeoul O
malware O
. O

South O
Korean O
intelligence O
reports O
stated O
that O
Lab O
110 O
, O
which O
is O
affiliated O
with O
the O
regime O
's O
defense O
ministry O
, O
was O
ordered O
by O
the O
North O
Korean O
regime O
to O
destroy O
South O
Korean O
communications O
networks O
. O

Although O
the O
March O
20 O
attacks O
used O
DarkSeoul O
malware O
, O
it O
is O
interesting O
to O
note O
that O
two O
groups O
, O
WhoIs O
Team O
and O
New O
Romantic O
Cyber O
Army O
Team O
, O
claimed O
responsibility O
for O
the O
'' O
March O
20 O
'' O
2013 O
attacks O
on O
South O
Korean O
media O
and O
financial O
institutions O
. O

Some O
of O
the O
DarkSeoul O
attacks O
corresponded O
with O
significant O
dates O
, O
such O
as O
U.S O
. O

Independence O
Day O
or O
the O
anniversary O
of O
the O
start O
of O
the O
Korean O
War O
. O

DarkSeoul O
attacks O
go O
beyond O
denial O
of O
service O
and O
sabotage O
. O

As O
early O
as O
2009 O
, O
the O
group O
responsible O
for O
the O
Dark O
Seoul O
attacks O
launched O
'' O
Operation O
Troy O
'' O
, O
an O
espionage O
campaign O
targeting O
the O
South O
Korean O
military O
. O

The O
operation O
was O
codenamed O
'' O
Troy O
'' O
due O
to O
the O
frequent O
use O
of O
the O
word O
'' O
Troy O
'' O
in O
the O
malware's O
compile O
path O
strings O
. O

The B-Entity
malware I-Entity
used I-Entity
in I-Entity
these I-Entity
attacks I-Entity
sought B-Action
out I-Action
and O
exfiltrated B-Action
data B-Entity
, O
based O
on O
keyword O
searches O
. O

While O
the B-Entity
malware I-Entity
was O
clearly O
intended O
to O
search B-Action
for B-Modifier
and O
exfiltrate B-Action
certain B-Entity
types I-Entity
of I-Entity
data I-Entity
, O
its O
true O
impact O
on O
the O
targets O
was O
never O
revealed O
. O

The O
March O
2011 O
'' O
10 O
Days O
of O
Rain O
'' O
DDoS O
attacks O
on O
U.S. O
and O
South O
Korean O
sites O
have O
also O
been O
attributed O
to O
the O
actors O
associated O
with O
DarkSeoul O
. O

According O
to O
Symantec O
, O
the O
politically O
motivated O
attacks O
have O
required O
a O
level O
of O
intelligence O
, O
coordination O
, O
monetary O
support O
, O
and O
technical O
sophistication O
that O
suggests O
state O
sponsorship O
. O

This O
designation O
means O
the O
group O
can O
be O
considered O
an O
advanced O
persistent O
threat O
( O
APT O
) O
. O

A O
March O
20 O
, O
2013 O
attack O
attributed O
to O
the O
DarkSeoul O
actors O
targeted O
three O
South O
Korean O
media O
outlets O
and O
Shinhan O
, O
Nonghyup O
, O
and O
Jeju O
banks O
. O

The O
impact O
of O
the B-Entity
March I-Entity
20 I-Entity
attacks I-Entity
included B-Action
disruption B-Entity
of I-Entity
service I-Entity
at I-Entity
financial I-Entity
institutions I-Entity
and O
data B-Entity
deletion I-Entity
. O

However O
, O
the O
targeted O
entities O
resumed O
normal O
operations O
shortly O
thereafter O
. O

According O
to O
South O
Korean O
reports O
, O
the O
media O
outlets O
targeted O
corresponded O
with O
those O
listed O
by O
the O
North O
Korean O
regime O
in O
2012 O
as O
right-wing O
press O
that O
manipulated O
South O
Korea O
's O
public O
opinion O
. O

In O
April O
2012 O
, O
the O
regime O
reportedly O
listed O
those O
entities O
as O
attack O
targets O
. O

The B-Entity
malware I-Entity
used I-Entity
in I-Entity
the I-Entity
March I-Entity
20 I-Entity
, I-Entity
2013 I-Entity
attacks I-Entity
were B-Action
wiper B-Entity
malware I-Entity
. O

The B-Entity
malware I-Entity
attempted O
to O
disable B-Action
AhnLab B-Entity
and I-Entity
Hauri I-Entity
AV I-Entity
antivirus I-Entity
products I-Entity
then O
proceeded O
to O
overwrite B-Action
the B-Entity
master I-Entity
boot I-Entity
record I-Entity
( I-Entity
MBR I-Entity
) I-Entity
. O

The B-Entity
attack I-Entity
was O
capable O
of O
wiping B-Action
both B-Entity
Linux I-Entity
and I-Entity
Windows I-Entity
machines I-Entity
. O

McAfee O
found O
that O
these O
attacks O
were O
the O
culmination O
of O
the O
malware O
campaign O
they O
dubbed O
'' O
Operation O
Troy O
'' O
. O

A O
report O
from O
IssueMakersLab O
tied O
the O
actors O
responsible O
for O
the O
March O
20 O
, O
2013 O
attacks O
to O
cyber O
attack O
activity O
occurring O
as O
early O
as O
2007 O
. O

IssueMakersLab O
found O
that O
these B-Entity
actors I-Entity
consistently O
used B-Action
the B-Entity
same I-Entity
16-digit I-Entity
password I-Entity
for B-Modifier
file B-Entity
compression I-Entity
, O
the B-Entity
same I-Entity
stage I-Entity
1 I-Entity
C2 I-Entity
protocol I-Entity
, O
the B-Entity
same I-Entity
collection I-Entity
keywords I-Entity
and I-Entity
encryption I-Entity
keys I-Entity
, O
and O
the O
same O
development O
path O
. O

According O
to O
South O
Korea O
's O
Korea O
Internet O
and O
Security O
Agency O
, O
the B-Entity
North I-Entity
Korean I-Entity
IP I-Entity
address I-Entity
175.45.178.xx I-Entity
was O
found O
scanning B-Action
South B-Entity
Korean I-Entity
routes I-Entity
the O
month O
before O
the O
attacks O
, O
and O
the O
same O
IP O
was O
reportedly O
logged O
as O
accessing O
one O
of O
the O
targets O
13 O
times O
. O

Details O
of O
the O
March O
20 O
attack O
also O
suggested O
possible O
ties O
to O
China O
. O

AlienVault O
suspected O
the B-Entity
Chinese I-Entity
exploit I-Entity
kit I-Entity
GonDad I-Entity
was O
used O
to O
spread B-Action
the B-Entity
malware I-Entity
, O
and O
the O
Korean O
domains O
serving O
the O
malware O
were O
registered O
using O
a O
Chinese O
email O
address O
. O

Additionally O
, O
researchers O
at O
AhnLab O
in O
South O
Korea O
noted O
a O
Chinese O
IP O
address O
linked O
to O
the O
attacks O
. O

While O
no O
concrete O
evidence O
has O
been O
released O
that O
indicates O
Lab O
110 O
was O
responsible O
for O
the O
DarkSeoul O
attacks O
, O
the O
responsible O
group O
's O
targets O
, O
TTP O
, O
and O
attack O
timing O
demonstrate O
a O
strong O
pro-North O
Korean O
sentiment O
. O

Known O
tactics O
, O
techniques O
and O
procedures O
Targets O
WhoIs O
Team O
is O
one O
of O
two O
groups O
that O
claimed O
responsibility O
for O
the O
'' O
March O
20 O
'' O
attacks O
targeting O
South O
Korea O
. O

A O
defacement O
on O
the O
LG O
+U O
webpage O
stated O
that O
it O
was O
'' O
Hacked O
by O
WhoIs O
Team O
'' O
and O
that O
the O
attackers O
would O
return O
. O

The O
page O
featured O
three O
skulls O
. O

However O
, O
no O
other O
attacks O
by O
WhoIs O
Team O
have O
been O
observed O
. O

Known O
tactics O
, O
techniques O
, O
and O
procedures O
Targets O
Associated O
actors O
Based O
on O
North O
Korea O
's O
affinity O
for O
disinformation O
and O
counterintelligence O
, O
we O
must O
note O
the O
distinct O
possibility O
that O
operatives O
claiming O
to O
be O
WhoIs O
Team O
are O
part O
of O
another O
group O
and O
that O
the O
defacement O
was O
a O
false O
flag O
operation O
meant O
to O
pin O
blame O
on O
RAONASRT O
. O

RAONASRT O
is O
a O
South O
Korean O
white O
hat O
capture O
the O
flag O
( O
CTF O
) O
team O
, O
whose O
members O
also O
operate O
under O
the O
name O
'' O
WhoIs O
'' O
. O

l O
RAONASRT O
( O
the O
RaonSecure O
Advanced O
Security O
Research O
Team O
) O
and O
its O
sub-teams O
WhoIs O
Team O
and O
Cpark O
Team O
have O
participated O
in O
and O
performed O
well O
in O
CTF O
contests O
such O
as O
the O
one O
hosted O
by O
DefCon O
. O

In O
2013 O
, O
a O
member O
of O
RAONASRT O
was O
invited O
to O
Blue O
House O
, O
the O
residence O
of O
the O
South O
Korean O
president O
, O
to O
meet O
with O
president O
Park O
and O
discuss O
the O
security O
industry O
. O

RAONASRT O
runs O
the O
Secuinside O
CTF O
competition O
. O

Their O
parent O
organization O
RaonSecure O
operates O
a O
whitehat O
training O
program O
. O

The O
group O
also O
runs O
the O
Korea O
WhiteHat O
Contest O
, O
which O
is O
hosted O
by O
South O
Korea O
's O
Ministry O
of O
National O
Defense O
and O
National O
Intelligence O
Service O
and O
supervised O
by O
South O
Korean O
Cyber O
Command O
. O

For O
these O
reasons O
, O
it O
seems O
unlikely O
that O
the O
RAONASRT O
WhoIs O
Team O
would O
maliciously O
target O
South O
Korean O
entities O
. O

IsOne O
is O
the O
group O
that O
claimed O
responsibility O
for O
the O
June O
2012 O
attack O
on O
the O
website O
of O
South O
Korean O
newspaper O
JoongAng O
Ilbo O
. O

The O
attack O
included O
an O
attempt O
to O
wipe O
JoongAng O
Ilbo O
's O
servers O
as O
well O
as O
a O
defacement O
depicting O
a O
laughing O
cat O
. O

Despite O
efforts O
to O
wipe O
the O
target O
's O
servers O
, O
the O
target O
only O
suffered O
defacement O
and O
temporary O
downtime O
. O

Although O
the O
groups O
have O
a O
similar O
name O
and O
both O
use O
a O
cat O
theme O
, O
it O
is O
unclear O
whether O
a O
CTF O
team O
known O
as O
'' O
The O
Cat O
is O
Number O
1 O
'' O
and O
IsOne O
are O
the O
same O
actors O
. O

'' O
The O
Cat O
is O
Number O
1 O
'' O
members O
claim O
to O
hail O
from O
North O
Korea O
, O
but O
there O
is O
no O
hard O
evidence O
linking O
team O
members O
to O
the O
region O
. O

Again O
, O
it O
seems O
that O
the O
actors O
responsible O
for O
the O
attack O
borrowed O
the O
moniker O
of O
another O
group O
. O

According O
to O
South O
Korea O
's O
National O
Police O
Agency O
, O
the O
attack O
on O
JoongAng O
Ilbo O
shares O
characteristics O
with O
previous O
attacks O
attributed O
to O
North O
Korean O
actors O
. O

An O
investigation O
conducted O
by O
the O
agency O
's O
Cyber O
Terror O
Response O
Center O
found O
that O
the O
actors O
targeting O
JoongAng O
Ilbo O
used O
two O
North O
Korean O
servers O
and O
17 O
servers O
in O
10 O
other O
countries O
. O

One O
server O
maintained O
a O
constant O
connection O
to O
an O
IP O
address O
belonging O
to O
Joson O
Telecommunication O
Company O
, O
which O
is O
affiliated O
with O
North O
Korea O
's O
Ministry O
of O
Posts O
and O
Telecommunications O
. O

Investigators O
found O
that O
one O
of O
the O
servers O
used O
in O
the O
attack O
on O
JoongAng O
Ilbo O
was O
also O
used O
in O
the O
March O
2011 O
DDoS O
attacks O
on O
South O
Korean O
critical O
infrastructure O
sites O
and O
the O
April O
2011 O
attack O
on O
Nyongyup O
Bank O
. O

Known O
tactics O
, O
techniques O
and O
procedures O
Targets O
The O
Kimsuky O
malware O
, O
which O
targeted O
South O
Korean O
think O
tanks O
, O
is O
loosely O
attributed O
to O
an O
actor O
referred O
to O
as O
Kimsukyang O
. O

Little O
is O
known O
about O
the O
actor O
or O
group O
responsible O
for O
the O
malware O
. O

However O
, O
the O
following O
email O
addresses O
are O
associated O
with O
the O
Kimsuky O
operation O
: O
The O
email O
address O
iop110112 O
@ O
hotmail.com O
was O
registered O
using O
the O
alias O
'' O
kimsukyang O
'' O
, O
and O
rsh1213 O
@ O
hotmail.com O
was O
registered O
using O
the O
alias O
'' O
Kim O
asdfa O
'' O
. O

Kaspersky O
found O
that O
the O
Kimsuky O
operation O
used O
10 O
IP O
addresses O
in O
two O
Chinese O
provinces O
that O
border O
North O
Korea O
: O
Jilin O
and O
Liaoning O
. O

Known O
tactics O
, O
techniques O
and O
procedures O
Targets O
The O
New O
Romantic O
Cyber O
Army O
Team O
also O
took O
credit O
for O
the O
March O
20 O
, O
2013 O
attacks O
. O

McAfee O
suspected O
New O
Romantic O
Cyber O
Army O
Team O
were O
responsible O
for O
Operation O
Troy O
and O
the O
resulting O
March O
20 O
, O
2013 O
attacks O
due O
to O
the O
group O
's O
'' O
frequent O
use O
of O
Roman O
and O
classical O
terms O
in O
their O
code O
. O

'' O
It O
is O
unknown O
whether O
Hastati O
is O
an O
alternate O
name O
for O
the O
group O
or O
whether O
Hastati O
is O
an O
individual O
actor O
within O
the O
group O
. O

It O
is O
interesting O
to O
note O
that O
the O
malware O
associated O
with O
these O
actors O
uses O
the O
strings O
'' O
HASTATI O
'' O
and O
'' O
PRINCIPES O
'' O
to O
overwrite O
the O
MBR O
. O

The O
name O
Hastati O
likely O
refers O
to O
a O
class O
of O
infantrymen O
of O
the O
early O
Roman O
Republic O
. O

The O
Hastati O
were O
less O
experienced O
soldiers O
who O
fought O
on O
the O
frontlines O
with O
spears O
and O
swords O
. O

Principes O
likely O
refers O
to O
more O
experienced O
Roman O
soldiers O
who O
fought O
on O
the O
second O
line O
of O
battle O
. O

Known O
tactics O
, O
techniques O
and O
procedures O
Targets O
HP O
researchers O
had O
previously O
analyzed O
samples O
of O
the O
DarkSeoul O
dropper O
, O
and O
findings O
were O
published O
in O
our O
annual O
HP O
Cyber O
Risk O
Report O
2013 O
. O

Analysis O
of O
this O
malware O
is O
included O
in O
Appendix O
C. O
Analysis O
of O
additional O
malware O
used O
in O
these O
campaigns O
produced O
no O
new O
findings O
and O
only O
corroborated O
what O
was O
found O
by O
external O
security O
researchers O
. O

These O
publicly O
available O
analyses O
have O
been O
cited O
throughout O
the O
report O
. O

Some O
of O
the O
malware O
samples O
were O
no O
longer O
publicly O
available O
. O

However O
, O
CrowdStrike O
obtained O
these O
missing O
samples O
before O
they O
disappeared O
from O
the O
wild O
and O
conducted O
thorough O
analysis O
, O
which O
was O
released O
in O
their O
subscription-only O
reports O
. O

While O
we O
can O
not O
divulge O
detailed O
information O
from O
those O
reports O
, O
an O
overview O
of O
the O
findings O
is O
provided O
below O
. O

The O
majority O
of O
the O
malware O
used O
in O
cyber O
incidents O
attributed O
to O
North O
Korea O
were O
variations O
of O
three O
types O
of O
malware O
: O
dropper O
, O
wiper O
, O
and O
IRC O
remote O
access O
trojan O
( O
RAT O
) O
. O

CrowdStrike's O
attribution O
of O
this O
malware O
to O
North O
Korean O
actors O
stemmed O
from O
two O
primary O
factors O
: O
Korean O
language O
characters O
found O
in O
the O
binaries O
and O
the O
propensity O
to O
specifically O
target O
South O
Korean O
entities O
. O

Dropper O
samples O
consistently O
targeted O
AhnLab O
Policy O
Center O
as O
a O
propagation O
method O
. O

This O
information O
is O
corroborated O
in O
a O
Black O
Hat O
Asia O
2014 O
presentation O
by O
Fortinet O
researcher O
Kyle O
Yang O
. O

CrowdStrike O
's O
report O
also O
briefly O
noted O
the O
use O
of O
an O
update O
server O
vector O
. O

Yang O
analyzed O
the O
malware O
's O
update O
config O
metadata O
and O
matched O
its O
format O
to O
the O
AhnLab O
Policy O
Center O
. O

To O
test O
its O
payload O
, O
Yang O
set O
up O
a O
server/client O
and O
executed O
the O
update O
through O
the O
server O
. O

As O
Yang O
had O
predicted O
, O
it O
wiped O
the O
client O
. O

While O
the O
method O
for O
initial O
compromise O
of O
the O
update O
server O
is O
not O
noted O
in O
detail O
, O
CrowdStrike O
's O
report O
cites O
'' O
collateral O
information O
'' O
that O
suggests O
targeted B-Entity
email I-Entity
attacks I-Entity
were B-Action
used I-Action
to B-Modifier
gain B-Entity
initial I-Entity
entry I-Entity
, O
and O
policy B-Entity
servers I-Entity
were B-Action
then I-Action
compromised I-Action
. O

The O
upload O
server O
vector O
included O
a O
time-based O
logic O
bomb O
that O
allowed O
the B-Entity
wiper I-Entity
to O
target B-Action
a B-Entity
large I-Entity
number I-Entity
of I-Entity
systems I-Entity
, O
on B-Modifier
a B-Entity
set I-Entity
time I-Entity
and I-Entity
date I-Entity
, O
with B-Modifier
full B-Entity
permissions I-Entity
on I-Entity
all I-Entity
of I-Entity
the I-Entity
targeted I-Entity
systems I-Entity
. O

According O
to O
CrowdStrike O
, O
the B-Entity
wiper I-Entity
malware I-Entity
was B-Action
dropped I-Action
on B-Modifier
the B-Entity
systems I-Entity
as B-Modifier
AgentBase.exe B-Entity
. O

The B-Entity
wiper I-Entity
used O
the O
Windows O
utility O
'taskkill O
' O
to O
kill B-Action
the B-Entity
processes I-Entity
pasvc.exe I-Entity
and I-Entity
clisvc.exe I-Entity
, O
which O
are O
the O
main O
processes O
for O
the O
Ahnlab O
and O
Hauri O
antivirus O
applications O
. O

The B-Entity
wiper I-Entity
then O
performed B-Action
system B-Entity
reconnaissance I-Entity
, O
gathering B-Action
drive B-Entity
information I-Entity
and I-Entity
operating I-Entity
system I-Entity
version I-Entity
. O

Depending O
on O
the O
OS O
used O
, O
the B-Entity
wiper I-Entity
recursively O
deleted B-Action
files B-Entity
on I-Entity
the I-Entity
file I-Entity
system I-Entity
, O
deleting B-Action
the B-Entity
Windows I-Entity
folder I-Entity
last O
. O

It B-Entity
then O
overwrote B-Action
the B-Entity
MBR I-Entity
with B-Modifier
the B-Entity
strings I-Entity
'' I-Entity
HASTATI I-Entity
'' I-Entity
, I-Entity
'' I-Entity
PRINCPES I-Entity
'' I-Entity
, I-Entity
'' I-Entity
PRINCIPES I-Entity
'' I-Entity
, I-Entity
or I-Entity
'' I-Entity
PR I-Entity
! I-Entity
NCPES I-Entity
'' I-Entity
. O

While O
there O
are O
several O
variants O
of O
the O
wiper O
, O
all O
seem O
to O
have O
been O
used O
on O
the O
same O
date O
. O

It O
is O
unclear O
why O
multiple O
wiper O
variants O
with O
slightly O
differing O
behavior O
were O
used O
for O
the O
same O
campaign O
. O

One O
possible O
explanation O
is O
that O
multiple O
variants O
were O
used O
to O
minimize O
the O
operational O
damage O
to O
the O
mission O
in O
the O
case O
of O
an O
early O
detection O
of O
one O
of O
the O
variants O
. O

For O
example O
, O
if O
one O
wiper O
variant O
was O
compromised O
or O
detected O
by O
antivirus O
or O
IDS O
signatures O
, O
the O
other O
variants O
may O
have O
differed O
enough O
to O
remain O
undetected O
, O
still O
resulting O
in O
mission O
success O
. O

According O
to O
CrowdStrike O
, O
a B-Entity
third I-Entity
malware I-Entity
component I-Entity
downloaded B-Action
an B-Entity
IRC I-Entity
RAT I-Entity
from B-Modifier
various B-Entity
compromised I-Entity
websites I-Entity
. O

This B-Entity
RAT I-Entity
is B-Action
detected I-Action
by O
Symantec B-Entity
as B-Modifier
Backdoor.Prioxer B-Entity
. O

Prioxer O
has O
been O
linked O
to O
other O
2011 O
attacks O
on O
South O
Korea O
. O

It O
is O
unclear O
whether O
these O
downloaders O
were O
pushed O
out O
in O
the O
same O
update O
server O
vector O
as O
the O
wipers O
. O

However O
, O
the O
two O
malware O
types O
both O
use O
the O
same O
packer O
'Jokra O
' O
and O
both O
contain O
the O
strings O
'' O
HASTATI O
'' O
and O
'' O
PRINCPES O
'' O
. O

Based O
on O
the O
information O
above O
, O
we O
have O
identified O
strategic O
challenges O
that O
impact O
the O
development O
of O
North O
Korea O
's O
cyber O
warfare O
capabilities O
. O

We O
have O
also O
noted O
relevant O
implications O
: O
• O
The O
North O
Korean O
regime O
strictly O
controls O
all O
Internet O
infrastructure O
, O
meaning O
cyber O
activity O
by O
dissidents O
or O
autonomous O
hacker O
groups O
are O
very O
unlikely O
. O

In O
other O
words O
, O
any O
cyber O
attacks O
originating O
in O
North O
Korea O
can O
be O
assumed O
to O
be O
state O
sponsored O
. O

For O
this O
reason O
, O
according O
to O
defectors O
, O
the O
regime O
's O
cyber O
operators O
do O
not O
typically O
launch O
attacks O
directly O
from O
within O
North O
Korea O
. O

Instead O
, O
many O
regime-sponsored O
attacks O
are O
launched O
from O
cells O
based O
in O
China O
, O
U.S. O
, O
South O
Asia O
, O
Europe O
, O
and O
even O
South O
Korea O
. O

• O
North O
Korea O
has O
a O
limited O
number O
of O
outgoing O
connections O
. O

For O
this O
reason O
, O
there O
is O
a O
low O
probability O
of O
DDoS O
originating O
from O
within O
. O

However O
, O
this O
does O
not O
preclude O
the O
use O
of O
botnets O
with O
a O
local O
C2 O
server O
or O
the O
use O
of O
networks O
in O
third-party O
nations O
to O
launch O
attacks O
. O

As O
seen O
in O
the O
July O
2009 O
attacks O
on O
South O
Korean O
and O
U.S. O
targets O
, O
North O
Korea O
has O
leveraged O
networks O
in O
countries O
such O
as O
Austria O
, O
Georgia O
, O
Germany O
, O
and O
even O
South O
Korea O
and O
the O
U.S. O
, O
in O
order O
to O
launch O
cyber O
attacks O
. O

North O
Korea O
will O
likely O
be O
forced O
to O
rely O
on O
third O
parties O
for O
quite O
some O
time O
, O
due O
to O
its O
lack O
of O
sufficient O
infrastructure O
for O
launching O
large-scale O
CNO O
. O

• O
Several O
outward O
facing O
websites O
are O
hosted O
in O
China O
and O
other O
countries O
. O

This O
implies O
two O
possibilities O
: O
that O
North O
Korea O
's O
infrastructure O
can O
not O
handle O
a O
heavy O
incoming O
traffic O
load O
or O
that O
the O
regime O
wants O
to O
separate O
the O
propaganda O
crafted O
for O
an O
outside O
target O
audience O
from O
internally-focused O
propaganda O
. O

This O
arrangement O
seems O
unlikely O
to O
change O
in O
the O
foreseeable O
future O
. O

• O
North O
Korea O
is O
known O
to O
have O
unstable O
power O
supplies O
, O
which O
limits O
scalability O
of O
the O
regime O
's O
current O
CNO O
capabilities O
. O

This O
is O
another O
reason O
why O
expansion O
of O
CNO O
capabilities O
using O
the O
nation O
's O
own O
infrastructure O
seems O
unlikely O
in O
the O
foreseeable O
future O
. O

• O
North O
Korea O
is O
known O
to O
have O
monetary O
deficiencies O
, O
which O
further O
limit O
expansion O
of O
infrastructure O
and O
CNO O
capabilities O
, O
at O
least O
without O
third-party O
aid O
. O

North O
Korea O
continues O
to O
rely O
heavily O
on O
China O
for O
sustainment O
. O

• O
Although O
we O
see O
few O
instances O
of O
overt O
cyber O
operations O
, O
that O
North O
Korea O
reportedly O
spends O
so O
much O
of O
its O
limited O
resources O
on O
training O
and O
equipping O
cyber O
operators O
speaks O
volumes O
. O

The O
human O
element O
of O
the O
regime O
's O
cyber O
war O
program O
, O
at O
least O
, O
has O
potential O
. O

• O
Sanctions O
against O
North O
Korea O
and O
export O
laws O
prohibit O
the O
sale O
of O
certain O
technologies O
to O
the O
regime O
. O

In O
other O
words O
, O
in O
order O
to O
obtain O
the O
technology O
needed O
for O
a O
cyber O
warfare O
program O
, O
the O
regime O
must O
improvise O
. O

North O
Korea O
must O
develop O
its O
own O
technology O
, O
manufacture O
technology O
using O
plans O
obtained O
via O
industrial O
espionage O
, O
or O
rely O
on O
third O
parties O
to O
procure O
it O
for O
them O
. O

However O
, O
the O
regime O
has O
historically O
failed O
in O
its O
attempts O
of O
large-scale O
production O
of O
electronic O
components O
. O

At O
present O
, O
North O
Korea O
relies O
on O
China O
to O
provide O
much O
of O
its O
network O
hardware O
, O
including O
servers O
and O
routers O
. O

It O
is O
unlikely O
that O
North O
Korea O
will O
compromise O
on O
its O
nuclear O
program O
, O
meaning O
sanctions O
will O
likely O
be O
longstanding O
, O
and O
the O
regime O
will O
have O
to O
continue O
to O
rely O
on O
third O
parties O
to O
procure O
technology O
. O

Cyber O
incidents O
attributed O
to O
North O
Korean O
actors O
seem O
to O
follow O
distinct O
patterns O
: O
 O
According O
to O
reports O
by O
other O
researchers O
, O
the O
conventions O
and O
C2 O
structure O
used O
by O
North O
Korean O
cyber O
actors O
show O
continuity O
and O
consistency O
over O
time O
. O

 O
The O
majority O
of O
the O
incidents O
attributed O
to O
North O
Korean O
actors O
consistently O
used O
wiper O
malware O
. O

 O
Several O
of O
the O
incidents O
included O
defacements O
, O
with O
a O
different O
group O
taking O
credit O
each O
time O
. O

Additionally O
, O
little O
information O
or O
attack O
history O
was O
found O
about O
any O
of O
the O
groups O
, O
aside O
from O
information O
acknowledged O
in O
this O
report O
. O

These O
factors O
seem O
to O
indicate O
that O
a O
single O
group O
may O
have O
been O
responsible O
for O
several O
attacks O
over O
time O
, O
using O
different O
group O
names O
as O
a O
false O
flag O
. O

 O
On O
more O
than O
one O
occasion O
, O
the O
malware O
included O
provisions O
to O
disable O
security O
software O
made O
by O
South O
Korean O
security O
company O
AhnLab O
. O

This O
detail O
strengthens O
the O
case O
that O
the O
malware O
was O
written O
or O
modified O
to O
specifically O
target O
South O
Korean O
machines O
. O

 O
The O
attacks O
followed O
an O
explicit O
pattern O
: O
most O
were O
around O
the O
time O
of O
U.S. O
– O
South O
Korean O
joint O
military O
exercises O
, O
while O
the O
others O
fell O
on O
a O
significant O
date O
or O
were O
in O
response O
to O
political O
events O
. O

 O
The O
primary O
targets O
were O
South O
Korean O
and O
U.S. O
entities O
. O

While O
these O
nations O
are O
traditionally O
targeted O
by O
the O
regime O
, O
it O
is O
also O
possible O
that O
South O
Korean O
entities O
are O
quick O
to O
attribute O
any O
attack O
on O
their O
infrastructure O
to O
North O
Korean O
actors O
. O

In O
fact O
, O
in O
some O
cases O
, O
South O
Korean O
reports O
were O
the O
only O
source O
of O
attribution O
. O

Does O
North O
Korea O
have O
sufficient O
cyber O
infrastructure O
and O
cyber O
warfare O
capabilities O
to O
harm O
the O
U.S. O
and O
its O
allies O
? O
While O
North O
Korea O
's O
cyber O
warfare O
capabilities O
pale O
in O
comparison O
to O
those O
of O
wealthier O
nations O
, O
the O
regime O
has O
made O
significant O
progress O
in O
developing O
its O
infrastructure O
and O
in O
establishing O
cyber O
operations O
. O

The O
rate O
of O
this O
progress O
warrants O
a O
closer O
look O
at O
North O
Korea's O
motivations O
, O
TTPs O
, O
and O
capabilities O
. O

As O
noted O
above O
, O
North O
Korea O
views O
the O
U.S. O
and O
South O
Korea O
as O
its O
primary O
adversaries O
. O

The O
U.S. O
and O
South O
Korea O
are O
high-tech O
nations O
with O
economies O
that O
depend O
heavily O
on O
technology O
. O

In O
contrast O
, O
North O
Korea O
does O
not O
have O
a O
high O
tech O
culture O
. O

For O
these O
reasons O
, O
we O
should O
not O
overestimate O
the O
regime O
's O
advanced O
cyber O
capability O
, O
yet O
we O
should O
never O
underestimate O
the O
potential O
impact O
of O
North O
Korea O
utilizing O
less O
advanced O
, O
quick-and-dirty O
tactics O
like O
DDoS O
to O
cripple O
their O
high-tech O
targets O
. O

Both O
government O
and O
corporate O
entities O
are O
susceptible O
to O
being O
targeted O
by O
North O
Korean O
cyber O
attacks O
. O

North O
Korean O
juche O
ideology O
places O
the O
survival O
of O
the O
regime O
as O
its O
primary O
goal O
, O
and O
any O
perceived O
threat O
to O
the O
regime O
may O
be O
targeted O
. O

Several O
attacks O
on O
U.S. O
and O
South O
Korean O
government O
, O
financial O
, O
and O
critical O
infrastructure O
entities O
have O
been O
attributed O
to O
North O
Korean O
origins.. O
These O
attacks O
were O
often O
preceded O
by O
or O
occurred O
in O
conjunction O
with O
North O
Korea O
voicing O
negative O
sentiments O
about O
the O
targeted O
entities O
. O

As O
we O
saw O
with O
Iranian O
cyber O
actors O
in O
HPSR O
Security O
Briefing O
Episode O
11 O
, O
state O
sponsored O
cyber O
actors O
often O
launch O
an O
attack O
in O
response O
to O
a O
political O
trigger O
. O

The O
same O
pattern O
seems O
to O
apply O
to O
pro-North O
Korean O
cyber O
actors O
, O
who O
have O
launched O
attacks O
to O
coincide O
with O
U.S O
. O

Independence O
Day O
and O
the O
anniversary O
of O
the O
start O
of O
the O
Korean O
War O
, O
as O
well O
as O
propaganda O
and O
cyber O
attacks O
in O
response O
to O
joint O
military O
exercises O
between O
the O
U.S. O
and O
South O
Korea O
. O

As O
shown O
by O
North O
Korea O
's O
past O
behavior O
( O
which O
is O
consistent O
with O
their O
doctrine O
) O
, O
they O
are O
easily O
'' O
pushed O
into O
a O
corner O
'' O
. O

At O
the O
slightest O
perceived O
threat O
, O
the O
regime O
responds O
with O
saber-rattling O
and O
peacocking O
. O

The O
regime O
is O
extremely O
defensive O
and O
will O
, O
in O
turn O
, O
flex O
its O
muscles O
to O
show O
the O
world O
how O
capable O
it O
is O
, O
even O
if O
this O
is O
an O
inaccurate O
display O
of O
their O
overall O
capabilities O
. O

The O
regime O
fears O
losing O
its O
control O
and O
the O
nation O
's O
culture O
to O
the O
ever-growing O
threat O
of O
outside O
influence O
, O
as O
is O
evidenced O
in O
the O
regime O
's O
reaction O
to O
the O
comedy O
film O
'' O
The O
Interview O
'' O
. O

The O
regime O
has O
represented O
itself O
to O
its O
citizens O
as O
a O
powerful O
and O
capable O
entity O
and O
has O
used O
this O
status O
to O
control O
the O
populace O
. O

For O
this O
reason O
, O
the O
regime O
's O
leaders O
are O
forced O
to O
continually O
demonstrate O
this O
strength O
and O
power O
, O
or O
an O
illusion O
thereof O
, O
both O
domestically O
and O
globally O
, O
in O
order O
to O
maintain O
the O
status O
needed O
to O
ensure O
continued O
suppression O
of O
the O
population O
. O

This O
show O
of O
power O
may O
require O
that O
the O
regime O
takes O
chances O
and O
stretches O
beyond O
its O
abilities O
at O
times O
, O
but O
in O
the O
spirit O
of O
juche O
and O
songun O
, O
the O
regime O
will O
continue O
this O
façade O
, O
fearful O
of O
losing O
the O
image O
its O
leaders O
have O
worked O
so O
hard O
to O
maintain O
. O

North O
Korean O
cyber O
operations O
are O
not O
generally O
observed O
originating O
from O
home O
field O
IP O
address O
space O
, O
so O
geo-IP O
based O
blocking O
of O
traffic O
originating O
from O
those O
net-blocks O
is O
ineffective O
. O

Given O
that O
North O
Korea O
has O
capable O
and O
technically O
trained O
forces O
and O
will O
demonstrate O
their O
power O
when O
they O
feel O
provoked O
, O
western O
entities O
should O
consciously O
avoid O
promoting O
ideas O
or O
doctrine O
that O
is O
blatantly O
slanderous O
to O
the O
regime O
. O

Encouraging O
such O
ideas O
could O
cause O
those O
entities O
to O
become O
a O
focal O
point O
for O
North O
Korean O
cyber O
attacks O
. O

Due O
to O
the O
fact O
that O
North O
Korean O
infrastructure O
is O
aging O
and O
its O
resources O
are O
not O
able O
to O
keep O
up O
with O
the O
rest O
of O
the O
world O
, O
entities O
with O
interesting O
R O
& O
D O
or O
IP O
( O
intellectual O
property O
) O
- O
especially O
military O
in O
nature O
– O
could O
become O
targets O
of O
interest O
for O
North O
Korea O
. O

Interest O
in O
defense-related O
IP O
and O
R O
& O
D O
could O
also O
stem O
from O
North O
Korea O
's O
relationship O
with O
China O
. O

In O
the O
Chinese O
business O
culture O
, O
taking O
another O
entity O
's O
IP O
or O
R O
& O
D O
is O
not O
stealing O
– O
it O
is O
accepted O
as O
business O
as O
usual O
. O

It O
is O
possible O
that O
North O
Korea O
, O
if O
under O
Chinese O
influence O
, O
would O
adopt O
the O
same O
attitude O
, O
given O
the O
regime O
's O
limited O
capacity O
for O
homegrown O
innovation O
. O

Known O
DPRK O
targets O
have O
been O
limited O
primarily O
to O
South O
Korean O
and O
U.S. O
organizations O
and O
government O
entities O
. O

For O
these O
targets O
, O
prudent O
measures O
should O
include O
: O
The O
dropper O
component O
that O
we O
examined O
was O
distributed O
as O
a O
UPX-packed O
binary O
. O

When O
executed O
it O
creates O
the O
following O
files O
in O
the O
affected O
user O
's O
% O
Temp O
% O
directory O
: O
After O
determining O
the O
location O
of O
user O
profile O
directories O
on O
the O
affected O
computer O
, O
the B-Entity
malware I-Entity
searches B-Action
these B-Entity
directories I-Entity
for B-Modifier
configuration B-Entity
files I-Entity
and I-Entity
directories I-Entity
that I-Entity
may I-Entity
be I-Entity
associated I-Entity
with I-Entity
the I-Entity
connection I-Entity
manager I-Entity
clients I-Entity
mRemote I-Entity
and I-Entity
SecureCRT I-Entity
. O

• O
mRemote-an O
open O
source O
tool O
for O
centrally O
managing O
remote O
server O
connections O
using O
a O
GUI O
( O
Kevin O
Kline O
, O
2008 O
) O
. O

This O
tool O
is O
no O
longer O
being O
actively O
developed O
or O
supported O
. O

• O
SecureCRT-a O
commercial O
SSH O
and O
Telnet O
client O
by O
VanDyke O
Software O
. O

If O
an O
mRemote O
installation O
is O
located O
, O
the B-Entity
dropper I-Entity
reads B-Action
the B-Entity
configuration I-Entity
file I-Entity
and O
checks O
if O
there's O
a O
NODE O
that O
is O
defined O
with O
'' O
Username=root O
'' O
, O
'' O
Protocol=SSH O
'' O
, O
and O
a O
password O
that O
is O
not O
blank O
. O

If O
those O
conditions O
are O
satisfied O
it B-Entity
extracts B-Action
the B-Entity
information I-Entity
. O

The O
password O
is O
decrypted O
after O
being O
extracted O
. O

If O
a O
SecureCRT O
installation O
is O
located O
, O
the B-Entity
dropper I-Entity
extracts B-Action
information B-Entity
from B-Modifier
sessions B-Entity
that I-Entity
have I-Entity
Username=root I-Entity
, I-Entity
Protocol=SSH I-Entity
and I-Entity
a I-Entity
saved I-Entity
password I-Entity
. O

If O
these O
conditions O
are O
satisfied O
, O
the O
username O
, O
hostname O
, O
port O
, O
and O
password O
are O
extracted O
. O

The O
password O
is O
then O
decrypted O
. O

After O
extracting O
these O
connection O
and O
server O
details O
, O
the B-Entity
dropper I-Entity
uses O
the O
previously O
dropped O
alg O
. O

exe O
and O
conime.exe O
to O
attempt O
to O
connect B-Action
remote B-Entity
servers I-Entity
, O
upload B-Action
and O
run B-Action
the B-Entity
bash I-Entity
script I-Entity
~pr1.tmp I-Entity
. O

The B-Entity
bash I-Entity
script I-Entity
initially O
checks B-Action
which O
UNIX B-Entity
it O
is O
running O
on O
( O
of O
HP-UX O
, O
SunOS O
, O
Linux O
, O
or O
AIX O
) O
and O
then O
attempts O
to O
wipe B-Action
the B-Entity
/kernel I-Entity
, I-Entity
/usr I-Entity
/etc I-Entity
and I-Entity
/home I-Entity
directories I-Entity
, O
thus O
rendering B-Action
the B-Entity
machine I-Entity
inoperative I-Entity
. O

When O
the B-Entity
AgentBase.exe I-Entity
component I-Entity
is B-Action
executed I-Action
, O
it B-Entity
first O
attempts O
to O
stop B-Action
the B-Entity
following I-Entity
processes I-Entity
, O
presumably O
in O
order O
to O
evade B-Action
detection B-Entity
: O
It B-Entity
then O
enumerates B-Action
all B-Entity
physical I-Entity
drives I-Entity
and O
overwrites B-Action
the B-Entity
first I-Entity
512 I-Entity
bytes I-Entity
with B-Modifier
the B-Entity
string I-Entity
: I-Entity
'' I-Entity
princpes I-Entity
'' I-Entity
, O
effectively O
destroying B-Action
the B-Entity
MBR I-Entity
( I-Entity
master I-Entity
boot I-Entity
record I-Entity
) I-Entity
of I-Entity
the I-Entity
affected I-Entity
drive I-Entity
. O

It B-Entity
continues O
to O
look B-Action
for B-Modifier
removable B-Entity
and I-Entity
fixed I-Entity
drives I-Entity
, O
locates B-Action
the B-Entity
root I-Entity
directory I-Entity
on I-Entity
these I-Entity
drives I-Entity
, O
and O
then O
attempts O
to O
delete B-Action
all B-Entity
files I-Entity
and I-Entity
folders I-Entity
in I-Entity
this I-Entity
directory I-Entity
. O

Finally O
, O
the B-Entity
affected I-Entity
computer I-Entity
is B-Action
shut I-Action
down I-Action
and I-Action
rebooted I-Action
, O
although O
if O
the O
wiping O
mechanisms O
were O
successful O
then O
the O
machine O
will O
not O
be O
able O
to O
boot O
. O

Two O
years O
ago O
, O
we O
published O
our O
research O
into O
RedOctober O
, O
a O
complex O
cyber-espionage O
operation O
targeting O
diplomatic O
embassies O
worldwide O
. O

We O
named O
it O
RedOctober O
because O
we O
started O
this O
investigation O
in O
October O
2012 O
, O
an O
unusually O
hot O
month O
. O

After O
our O
announcement O
in O
January O
2013 O
, O
the O
RedOctober O
operation O
was O
promptly O
shut O
down O
and O
the O
network O
of O
C O
& O
Cs O
was O
dismantled O
. O

As O
usually O
happens O
with O
these O
big O
operations O
, O
considering O
the O
huge O
investment O
and O
number O
of O
resources O
behind O
it O
, O
they O
do O
n't O
just O
'' O
go O
away O
'' O
forever O
. O

Normally O
, O
the O
group O
goes O
underground O
for O
a O
few O
months O
, O
redesigns O
the O
tools O
and O
the O
malware O
and O
resume O
operations O
. O

See O
: O
Since O
January O
2013 O
, O
we O
've O
been O
on O
the O
lookout O
for O
a O
possible O
RedOctober O
comeback O
. O

One O
possible O
hit O
was O
triggered O
when O
we O
observed O
Mevade O
, O
an O
unusual O
piece O
of O
malware O
that O
appeared O
late O
in O
2013 O
. O

The O
Mevade O
C O
& O
C O
name O
styles O
as O
well O
as O
some O
other O
technical O
similarities O
indicated O
a O
connection O
to O
RedOctober O
, O
but O
the O
link O
was O
weak O
. O

It O
was O
n't O
until O
August O
2014 O
that O
we O
observed O
something O
which O
made O
us O
wonder O
if O
RedOctober O
is O
back O
for O
good O
. O

In O
August O
2014 O
, O
some O
of O
our O
users O
observed O
targeted O
attacks O
with O
a O
variation O
of O
CVE-2012-0158 O
and O
an O
unusual O
set O
of O
malware O
. O

We O
did O
a O
quick O
analysis O
of O
the O
malware O
and O
it O
immediately O
stood O
out O
because O
of O
certain O
unusual O
things O
that O
are O
not O
very O
common O
in O
the O
APT O
world O
. O

Some O
of O
the O
filenames O
used O
in O
the O
attacks O
included O
: O
At O
least O
one O
of O
them O
immediately O
reminded O
us O
of O
RedOctober B-Entity
, O
which O
used B-Action
a B-Entity
very I-Entity
similarly I-Entity
named I-Entity
spearphish I-Entity
: I-Entity
'' I-Entity
Diplomatic I-Entity
Car I-Entity
for I-Entity
Sale.doc I-Entity
'' I-Entity
. O

As O
we O
started O
digging O
into O
the O
operation O
, O
more O
details O
emerged O
which O
supported O
this O
theory O
. O

Perhaps O
the O
most O
unusual O
fact O
was O
that O
the O
Microsoft O
Office O
exploit O
did O
n't O
directly O
write O
a O
Windows O
PE O
backdoor O
on O
disk O
. O

Instead O
, O
it B-Entity
writes B-Action
an B-Entity
encrypted I-Entity
Visual I-Entity
Basic I-Entity
Script I-Entity
and O
runs B-Action
it B-Entity
. O

This B-Entity
VBScript I-Entity
drops B-Action
a B-Entity
pair I-Entity
of I-Entity
files I-Entity
on B-Modifier
disk B-Entity
- O
a O
loader O
and O
an O
encrypted O
payload O
. O

The O
loader O
appears O
to O
be O
different O
every O
time O
and O
internal O
strings O
indicate O
it O
is O
'' O
polymorphically O
'' O
generated O
. O

The B-Entity
payload I-Entity
is B-Action
always I-Action
encrypted I-Action
with B-Modifier
a B-Entity
unique I-Entity
key I-Entity
, O
making O
it O
impossible O
to O
decrypt O
unless O
the O
DLL O
is O
available O
. O

We O
observed O
several B-Entity
different I-Entity
spear-phishing I-Entity
documents I-Entity
that O
drop B-Action
uniquely B-Entity
named I-Entity
payloads I-Entity
. O

For O
instance O
, O
the O
'' O
qPd0aKJu.vbs O
'' O
file O
MD5 O
: O
E211C2BAD9A83A6A4247EC3959E2A730 B-Entity
drops B-Action
the B-Entity
following I-Entity
files I-Entity
: O
The B-Entity
VBS I-Entity
also O
adds B-Action
a B-Entity
registry I-Entity
key I-Entity
: I-Entity
HKEYCURRENTUSER\Software\Microsoft\Windows\CurrentVersion\Run\ I-Entity
setting B-Action
the B-Entity
key I-Entity
'' I-Entity
bookstore I-Entity
'' I-Entity
to B-Modifier
the B-Entity
value I-Entity
'' I-Entity
regsvr32 I-Entity
% I-Entity
path I-Entity
% I-Entity
\ctfmonrn.dll I-Entity
/s I-Entity
'' I-Entity
, O
which O
ensures B-Action
the B-Entity
malware I-Entity
runs I-Entity
every I-Entity
time I-Entity
at I-Entity
system I-Entity
boot I-Entity
. O

Some O
of O
the O
DLL O
names O
we O
observed O
include O
: O
Some O
of O
the O
payload O
names O
include O
: O
The O
payload O
includes O
an B-Entity
encrypted I-Entity
configuration I-Entity
block I-Entity
which O
contains B-Action
information B-Entity
about I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
sever I-Entity
: O
The O
information O
from O
the O
config O
includes O
a B-Entity
WebDAV I-Entity
URL I-Entity
which O
is B-Action
used I-Action
for B-Modifier
connections B-Entity
, O
a O
username O
and O
password O
, O
two O
folders O
on O
the O
WebDAV O
server O
used O
to O
store O
plugins/modules O
for O
the O
malware O
and O
where O
data B-Entity
from I-Entity
the I-Entity
victim I-Entity
should O
be B-Action
uploaded I-Action
. O

The B-Entity
Cloud I-Entity
Atlas I-Entity
implants I-Entity
utilize B-Action
a B-Entity
rather I-Entity
unusual I-Entity
C I-Entity
& I-Entity
C I-Entity
mechanism I-Entity
. O

All B-Entity
the I-Entity
malware I-Entity
samples I-Entity
we I-Entity
've I-Entity
seen I-Entity
communicate B-Action
via B-Modifier
HTTPS B-Entity
and I-Entity
WebDav I-Entity
with B-Modifier
the B-Entity
same I-Entity
server I-Entity
'' I-Entity
cloudme.com I-Entity
'' I-Entity
, I-Entity
a I-Entity
cloud I-Entity
services I-Entity
provider I-Entity
. O

According O
to O
their O
website O
, O
CloudMe O
is O
owned O
and O
operated O
by O
CloudMe O
AB O
, O
a O
company O
based O
in O
Linköping O
, O
Sweden O
. O

( O
Important O
note O
: O
we O
do O
not O
believe O
that O
CloudMe O
is O
in O
any O
way O
related O
to O
the O
Cloud O
Atlas O
group O
- O
the O
attackers O
simply O
create O
free O
accounts O
on O
this O
provider O
and O
abuse O
them O
for O
command-and-control O
) O
. O

Each B-Entity
malware I-Entity
set I-Entity
we I-Entity
have I-Entity
observed I-Entity
so I-Entity
far I-Entity
communicates B-Action
with B-Modifier
a B-Entity
different I-Entity
CloudMe I-Entity
account I-Entity
though O
. O

The O
attackers O
upload O
data B-Entity
to O
the O
account O
, O
which O
is B-Action
downloaded I-Action
by O
the B-Entity
implant I-Entity
, O
decrypted O
and O
interpreted O
. O

In O
turn O
, O
the B-Entity
malware I-Entity
uploads B-Action
the B-Entity
replies I-Entity
back B-Modifier
to I-Modifier
the B-Entity
server I-Entity
via B-Modifier
the B-Entity
same I-Entity
mechanism I-Entity
. O

Of O
course O
, O
it O
should O
be O
possible O
to O
reconfigure O
the O
malware O
to O
use O
any O
Cloud-based O
storage O
service O
that O
supports O
WebDAV O
. O

Here O
's O
a O
look O
at O
one O
such O
account O
from O
CloudMe O
: O
The O
data O
from O
the O
account O
: O
The B-Entity
files I-Entity
stored I-Entity
in I-Entity
the I-Entity
randomly I-Entity
named I-Entity
folder I-Entity
were B-Action
uploaded I-Action
by O
the B-Entity
malware I-Entity
and O
contain B-Action
various B-Entity
things I-Entity
, I-Entity
such I-Entity
as I-Entity
system I-Entity
information I-Entity
, I-Entity
running I-Entity
processes I-Entity
and I-Entity
current I-Entity
username I-Entity
. O

The B-Entity
data I-Entity
is B-Action
compressed I-Action
with B-Modifier
LZMA B-Entity
and O
encrypted B-Action
with B-Modifier
AES B-Entity
, O
however O
, O
the O
keys O
are O
stored O
in O
the O
malware O
body O
which O
makes O
it O
possible O
to O
decrypt O
the O
information O
from O
the O
C O
& O
C O
. O

We O
previously O
observed O
only B-Entity
one I-Entity
other I-Entity
group I-Entity
using O
a O
similar O
method O
– O
ItaDuke O
– O
that O
connected B-Action
to B-Modifier
accounts B-Entity
on I-Entity
the I-Entity
cloud I-Entity
provider I-Entity
mydrive.ch I-Entity
. O

Just O
like O
with O
RedOctober O
, O
the O
top O
target O
of O
Cloud O
Atlas O
is O
Russia O
, O
followed O
closely O
by O
Kazakhstan O
, O
according O
to O
data O
from O
the O
Kaspersky O
Security O
Network O
( O
KSN O
) O
. O

Actually O
, O
we O
see O
an O
obvious O
overlap O
of O
targets O
between O
the O
two O
, O
with O
subtle O
differences O
which O
closely O
account O
for O
the O
geopolitical O
changes O
in O
the O
region O
that O
happened O
during O
the O
last O
two O
years O
. O

Interestingly O
, O
some B-Entity
of I-Entity
the I-Entity
spear-phishing I-Entity
documents I-Entity
between I-Entity
Cloud I-Entity
Atlas I-Entity
and I-Entity
RedOctober I-Entity
seem O
to O
exploit B-Action
the B-Entity
same I-Entity
theme I-Entity
and O
were O
used O
to O
target B-Action
the B-Entity
same I-Entity
entity I-Entity
at B-Modifier
different B-Entity
times I-Entity
. O

Both O
Cloud O
Atlas O
and O
RedOctober O
malware O
implants O
rely O
on O
a O
similar O
construct O
, O
with O
a O
loader O
and O
the O
final O
payload O
that O
is O
stored O
encrypted O
and O
compressed O
in O
an O
external O
file O
. O

There O
are O
some O
important O
differences O
though O
, O
especially O
in O
the O
encryption O
algorithms O
used O
– O
RC4 O
in O
RedOctober O
vs O
AES O
in O
Cloud O
Atlas O
. O

The O
usage O
of O
the O
compression O
algorithms O
in O
Cloud O
Altas O
and O
RedOctober O
is O
another O
interesting O
similarity O
. O

Both O
malicious O
programs O
share O
the O
code O
for O
LZMA O
compression O
algorithm O
. O

In O
CloudAtlas O
it O
is O
used O
to O
compress O
the O
logs O
and O
to O
decompress O
the O
decrypted O
payload O
from O
the O
C O
& O
C O
servers O
, O
while O
in O
Red O
October O
the O
'' O
scheduler O
'' O
plugin O
uses O
it O
to O
decompress O
executable O
payloads O
from O
the O
C O
& O
C O
. O

It O
turns O
out O
that O
the O
implementation O
of O
the O
algorithm O
is O
identical O
in O
both O
malicious O
modules O
, O
however O
the O
way O
it O
is O
invoked O
is O
a O
bit O
different O
, O
with O
additional O
input O
sanity O
checks O
added O
to O
the O
CloudAtlas O
version O
. O

Another O
interesting O
similarity O
between O
the O
malware O
families O
is O
the O
configuration O
of O
the O
build O
system O
used O
to O
compile O
the O
binaries O
. O

Every O
binary O
created O
using O
the O
Microsoft O
Visual O
Studio O
toolchain O
has O
a O
special O
header O
that O
contains O
information O
about O
the O
number O
of O
input O
object O
files O
and O
version O
information O
of O
the O
compilers O
used O
to O
create O
them O
, O
the O
'' O
Rich O
'' O
header O
called O
so O
by O
the O
magic O
string O
that O
is O
used O
to O
identify O
it O
in O
the O
file O
. O

We O
have O
been O
able O
to O
identify O
several O
RedOctober O
binaries O
that O
have O
'' O
Rich O
'' O
headers O
describing O
exactly O
the O
same O
layout O
of O
VC O
2010 O
+ O
VC O
2008 O
object O
files O
. O

Although O
this O
does O
n't O
necessarily O
mean O
that O
the O
binaries O
were O
created O
on O
the O
same O
development O
computer O
, O
they O
were O
definitely O
compiled O
using O
the O
same O
version O
of O
the O
Microsoft O
Visual O
Studio O
up O
to O
the O
build O
number O
version O
and O
using O
similar O
project O
configuration O
. O

To O
summarize O
the O
similarities O
between O
the O
two O
: O
Finally O
, O
perhaps O
the O
strongest O
connection O
comes O
from O
targeting O
. O

Based O
on O
observations O
from O
KSN O
, O
some B-Entity
of I-Entity
the I-Entity
victims I-Entity
of I-Entity
RedOctober I-Entity
are O
also O
being B-Action
targeted I-Action
by O
CloudAtlas B-Entity
. O

In O
at O
least O
one O
case O
, O
the O
victim O
's O
computer O
was O
attacked O
only O
twice O
in O
the O
last O
two O
years O
, O
with O
only O
two O
malicious O
programs O
– O
RedOctober O
and O
Cloud O
Atlas O
. O

These O
and O
other O
details O
make O
us O
believe O
that O
CloudAtlas O
represents O
a O
rebirth O
of O
the O
RedOctober O
attacks O
. O

Following O
big O
announcements O
and O
public O
exposures O
of O
targeted O
attack O
operations O
, O
APT O
groups O
behave O
in O
a O
predictable O
manner O
. O

Most B-Entity
Chinese-speaking I-Entity
attackers I-Entity
simply O
relocate B-Action
C B-Entity
& I-Entity
C I-Entity
servers I-Entity
to B-Modifier
a B-Entity
different I-Entity
place I-Entity
, O
recompile O
the O
malware O
and O
carry O
on O
as O
if O
nothing O
happened O
. O

Other O
groups O
that O
are O
more O
nervous O
about O
exposure O
go O
in O
a O
hibernation O
mode O
for O
months O
or O
years O
. O

Some O
may O
never O
return O
using O
the O
same O
tools O
and O
techniques O
. O

However O
, O
when O
a O
major O
cyber-espionage O
operation O
is O
exposed O
, O
the O
attackers O
are O
unlikely O
to O
completely O
shut O
down O
everything O
. O

They O
simply O
go O
offline O
for O
some O
time O
, O
completely O
reshuffle O
their O
tools O
and O
return O
with O
rejuvenated O
forces O
. O

We O
believe O
this O
is O
also O
the O
case O
of O
RedOctober O
, O
which O
makes O
a O
classy O
return O
with O
Cloud O
Atlas O
. O

Kaspersky O
products O
detect O
the O
malware O
from O
the O
Cloud O
Atlas O
toolset O
with O
the O
following O
verdicts O
: O
Blue O
Coat O
Exposes O
Inception O
Framework O
On O
September O
24 O
2014 O
, O
FireEye O
observed O
a O
new O
strategic O
web O
compromise O
( O
SWC O
) O
campaign O
that O
we O
believe O
is O
targeting O
non-profit O
organizations O
and O
non-governmental O
organizations O
( O
NGO O
) O
by O
hosting O
iframes O
on O
legitimate O
websites O
. O

The O
compromised O
websites O
contained O
an B-Entity
iframe I-Entity
to O
direct B-Action
site B-Entity
visitors I-Entity
to B-Modifier
a B-Entity
threat I-Entity
actor-controlled I-Entity
IP I-Entity
address I-Entity
that O
dropped B-Action
a B-Entity
Poison I-Entity
Ivy I-Entity
remote I-Entity
access I-Entity
tool I-Entity
( I-Entity
RAT I-Entity
) I-Entity
onto B-Modifier
victims B-Entity
' I-Entity
systems I-Entity
. O

FireEye O
has O
not O
yet O
attributed O
this O
activity O
though O
we O
have O
identified O
links O
to O
the O
Sunshop O
Digital O
Quartermaster O
, O
a O
collective O
of O
malware O
authors O
that O
supports O
multiple O
China-based O
advanced O
persistent O
threat O
( O
APT O
) O
groups O
. O

FireEye O
previously O
established O
detection O
measures O
for O
this O
threat O
activity O
, O
ensuring O
our O
clients O
were O
prepared O
for O
these O
intrusion O
attempts O
well O
in O
advance O
of O
threat O
actor O
implementation O
. O

On O
September O
24 O
, O
FireEye O
observed O
SWCs O
, O
likely O
conducted O
by O
a O
unitary O
threat O
group O
based O
on O
shared O
infrastructure O
and O
tools O
, O
on O
at O
least O
three O
different O
websites O
: O
an O
international O
non-profit O
organization O
that O
focuses O
on O
environmental O
advocacy O
, O
and O
two O
different O
NGOs O
that O
promote O
democracy O
and O
human O
rights O
. O

The B-Entity
group I-Entity
was O
able O
to O
compromise B-Action
these B-Entity
websites I-Entity
and O
insert B-Action
malicious B-Entity
iframes I-Entity
. O

Figure O
1 O
displays O
one O
of O
the O
iframes O
. O

The B-Entity
threat I-Entity
group I-Entity
obfuscated B-Action
the B-Entity
iframe I-Entity
on B-Modifier
two B-Entity
of I-Entity
the I-Entity
compromised I-Entity
websites I-Entity
. O

The B-Entity
iframes I-Entity
on I-Entity
these I-Entity
websites I-Entity
directed B-Action
visitors B-Entity
to B-Modifier
Java B-Entity
exploits I-Entity
hosted I-Entity
at I-Entity
103.27.108.45 I-Entity
. O

In O
turn O
, O
these B-Entity
exploits I-Entity
downloaded B-Action
and O
decoded O
a B-Entity
payload I-Entity
hosted I-Entity
at I-Entity
: I-Entity
hxxp I-Entity
: I-Entity
//103.27.108.45/img/js.php I-Entity
. O

A O
GET O
request O
to O
this O
URI O
returned O
the O
following O
content O
: O
The O
'bin O
' O
param O
shown O
in O
Figure O
2 O
is O
decoded O
from O
ASCII O
into O
hex O
by O
the O
Java O
exploit O
. O

Once O
decoded O
, O
FireEye O
identified O
the O
payload O
as O
a O
Poison O
Ivy O
variant O
. O

It O
had O
the O
following O
properties O
: O
The O
backdoor O
also O
contained O
the O
below O
versioning O
info O
embedded O
in O
the O
RTVERSION O
of O
one O
of O
the O
PE O
resources O
: O
This B-Entity
versioning I-Entity
info I-Entity
attempted O
to O
masquerade B-Action
as B-Modifier
a B-Entity
Google I-Entity
Chrome I-Entity
file I-Entity
. O

However O
, O
the O
malware O
author O
misspelled O
multiple O
words O
when O
attempting O
to O
put O
in O
versioning O
information O
for O
this O
particular O
build O
. O

The O
Poison O
Ivy O
implant O
had O
the O
following O
configuration O
properties O
: O
The B-Entity
C2 I-Entity
domain I-Entity
quakegoogle.servequake I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
resolved B-Action
to B-Modifier
115.126.62.100 B-Entity
at B-Modifier
the B-Entity
time I-Entity
of I-Entity
the I-Entity
SWCs I-Entity
. O

Other O
domains O
resolving O
to O
the O
same O
IP O
include O
the O
following O
: O
Between O
August O
30 O
, O
2014 O
and O
September O
16 O
, O
2014 O
we O
also O
observed O
SOGU B-Entity
( I-Entity
aka I-Entity
Kaba I-Entity
) I-Entity
callback I-Entity
traffic I-Entity
sent B-Action
to B-Modifier
assign.ddnsking.com B-Entity
over B-Modifier
port B-Entity
443 I-Entity
. O

The O
Poison O
Ivy O
backdoor O
also O
had O
a O
RTMANIFEST O
PE O
resource O
with O
a O
SHA256 O
fingerprint O
of O
82a98c88d3dd57a6ebc0fe7167a86875ed52ebddc6374ad640407efec01b1393 O
. O

This O
same O
RTMANIFEST O
resource O
was O
documented O
in O
our O
previous O
Sunshop O
Digital O
Quartermaster O
report O
. O

FireEye O
previously O
identified O
this O
specific O
RTMANIFEST O
as O
the O
'Sunshop O
Manifest O
, O
' O
and O
we O
have O
observed O
this O
same O
manifest O
resource O
used O
in O
86 O
other O
samples O
. O

As O
we O
stated O
in O
the O
Quartermaster O
report O
, O
we O
believe O
this O
shared O
resource O
is O
an O
artifact O
of O
a O
builder O
toolkit O
made O
available O
to O
a O
number O
of O
China- O
based O
APT O
groups O
. O

This O
activity O
represents O
a O
new O
SWC O
campaign O
. O

We O
suspect O
threat O
actors O
are O
leveraging O
their O
access O
to O
compromised O
websites O
belonging O
to O
NGOs O
and O
non-profits O
to O
target O
other O
organizations O
in O
the O
same O
industries O
. O

These O
websites O
are O
often O
visited O
by O
organization O
employees O
and O
other O
organizations O
in O
the O
same O
industries O
, O
allowing O
threat O
actors O
to O
move O
laterally O
within O
already O
compromised O
networks O
or O
gain O
access O
to O
new O
networks O
. O

While O
FireEye O
has O
not O
attributed O
this O
activity O
to O
a O
specific O
threat O
group O
, O
we O
frequently O
observe O
China-based O
threat O
actors O
target O
non-profits O
and O
NGOs O
, O
and O
we O
suspect O
that O
they O
seek O
to O
monitor O
activity O
within O
their O
borders O
that O
may O
lead O
to O
domestic O
unrest O
or O
embarrass O
the O
Chinese O
government O
. O

For O
example O
, O
in O
2013 O
, O
FireEye O
observed O
China-based O
threat O
actors O
steal O
grant O
applications O
and O
activity O
reports O
specifically O
related O
to O
an O
international O
NGO O
's O
China-based O
activities O
. O

We O
suspects O
threat O
actors O
sought O
to O
monitor O
these O
programs O
and O
involved O
individuals O
. O

The O
three O
organizations O
whose O
websites O
are O
hosting O
the O
malicious O
iframes O
have O
China-based O
operations O
. O

FireEye O
is O
releasing O
information O
on O
this O
campaign O
to O
allow O
organizations O
to O
investigate O
and O
prepare O
for O
this O
activity O
in O
their O
networks O
. O

We O
believe O
non-profits O
and O
NGOs O
remain O
at O
elevated O
risk O
of O
intrusion O
and O
should O
be O
especially O
wary O
of O
attempts O
to O
compromise O
their O
networks O
using O
SWC O
. O

Threat O
actors O
may O
use O
SWCs O
to O
achieve O
this O
goal O
, O
but O
FireEye O
does O
not O
discount O
the O
possibility O
that O
threat O
actors O
will O
use O
other O
means O
at O
their O
disposal O
, O
including O
phishing O
. O

Based O
on O
past O
threat O
actor O
activity O
in O
this O
industry O
, O
FireEye O
expects O
threat O
actors O
are O
motivated O
to O
steal O
programmatic O
data O
and O
monitor O
organizations O
' O
programs O
in O
specific O
countries O
. O

If O
China-based O
threat O
actors O
are O
behind O
the O
observed O
campaign O
, O
FireEye O
expects O
that O
organizations O
with O
operations O
in O
China O
are O
high-priority O
targets O
. O

FireEye O
currently O
has O
detection O
measures O
in O
place O
that O
should O
allow O
users O
of O
FireEye O
products O
to O
detect O
this O
SWC O
activity O
. O

It O
is O
also O
likely O
that O
other O
industries O
or O
organizations O
were O
affected O
by O
this O
SWC O
activity O
, O
since O
these O
sites O
are O
public O
facing O
and O
frequently O
visited O
. O

Special O
thanks O
to O
Google O
's O
Billy O
Leonard O
for O
providing O
additional O
information O
and O
research O
. O

Thanks O
to O
the O
following O
authors O
for O
their O
contributions O
: O
Mike O
Oppenheim O
, O
Ned O
Moran O
, O
and O
Steve O
Stone O
. O

This O
entry O
was O
posted O
in O
Threat O
Intelligence O
, O
Threat O
Research O
by O
Sarah O
Engle O
and O
Ben O
Withnell O
. O

Bookmark O
the O
permalink O
. O

In O
this O
day O
and O
age O
of O
interconnected O
cloud O
services O
and O
distributed O
content O
delivery O
networks O
( O
CDNs O
) O
, O
it O
is O
important O
for O
both O
CDN O
service O
providers O
and O
security O
professionals O
alike O
to O
recognize O
and O
understand O
the O
risks O
that O
these O
systems O
can O
introduce O
within O
an O
modern O
enterprise O
. O

For O
organizations O
within O
both O
public O
and O
private O
sectors O
that O
leverage O
CDN O
platforms O
to O
dynamically O
deliver O
web O
content O
, O
it O
is O
important O
that O
the O
content O
is O
also O
routinely O
monitored O
. O

Otherwise O
, O
malicious O
third-party O
content O
can O
be O
loaded O
into O
a O
target O
organization O
's O
website O
without O
their O
knowledge O
, O
delivering O
untold O
risks O
to O
unwitting O
visitors O
. O

The O
ThreatConnect O
Intelligence O
Research O
Team O
( O
TCIRT O
) O
recently O
observed O
a B-Entity
targeted I-Entity
cross-site I-Entity
scripting I-Entity
( I-Entity
XSS I-Entity
) I-Entity
'' I-Entity
drive-by I-Entity
'' I-Entity
attack I-Entity
that O
leveraged B-Action
a B-Entity
single I-Entity
content I-Entity
delivery I-Entity
network I-Entity
resource I-Entity
to B-Modifier
distribute B-Entity
a I-Entity
malicious I-Entity
Java I-Entity
applet I-Entity
via I-Entity
nearly I-Entity
all I-Entity
of I-Entity
the I-Entity
major I-Entity
official I-Entity
Government I-Entity
of I-Entity
Afghanistan I-Entity
websites I-Entity
. O

The O
compromised O
CDN O
resource O
in O
question O
is O
a O
JavaScript O
file O
hosted O
at O
[ O
http O
: O
] O
//cdn.afghanistan O
[ O
. O

] O
af/scripts/gop-script.js O
The O
domain O
cdn.afghanistan O
[ O
. O

] O
af O
is O
a O
legitimate O
CDN O
site O
used O
by O
the O
Afghan O
Ministry O
of O
Communications O
and O
IT O
( O
MCIT O
) O
to O
host O
web O
content O
that O
is O
displayed O
and O
used O
on O
many O
official O
gov.af O
websites O
. O

The O
javascript O
URL O
( O
[ O
http O
: O
] O
//cdn.afghanistan O
[ O
. O

] O
af/scripts/gop-script.js O
) O
is O
called O
from O
numerous O
official O
Afghan O
Government O
websites O
, O
including O
the O
following O
: O
It O
is O
likely O
that O
this O
javascript O
URL O
itself O
is O
normally O
legitimate O
, O
but O
the O
attackers O
obtained O
access O
to O
the O
file O
and O
prepended O
the O
following O
malicious O
JavaScript O
functions O
to O
the O
beginning O
of O
the O
script O
: O
Note O
that O
the O
gov.af O
websites O
would O
not O
need O
to O
be O
compromised O
individually O
for O
this O
attack O
to O
be O
delivered O
to O
visitors O
of O
the O
sites O
, O
because O
it O
is O
the O
backend O
CDN O
infrastructure O
that O
is O
serving O
up O
the O
malicious O
script O
. O

Judging O
by O
the O
last O
modified O
timestamp O
on O
the O
HTTP O
response O
of O
gop-script.js O
, O
which O
is O
Tue O
, O
16 O
Dec O
2014 O
08:07:06 O
GMT O
, O
this O
malicious O
CDN O
compromise O
was O
very O
recent O
in O
nature O
. O

In O
fact O
, O
it O
occurred O
on O
the O
very O
same O
day O
that O
China O
's O
Prime O
Minister O
Li O
Keqiang O
would O
meet O
with O
Abdullah O
Abdullah O
, O
the O
Chief O
Executive O
Officer O
of O
Afghanistan O
in O
Astana O
Kazakhstan O
, O
they O
would O
discuss O
infrastructure O
development O
and O
bilateral O
cooperation O
issues O
. O

Looking O
at O
the O
EXIF O
metadata O
of O
the O
image O
of O
Keqiang O
meeting O
with O
Abdullah O
that O
is O
hosted O
on O
the O
Chinese O
embassy O
website O
we O
note O
a O
Tue O
, O
16 O
December O
2014 O
07:43:31 O
modify O
time O
as O
well O
as O
the O
www.news O
[ O
. O

] O
cn O
watermark O
in O
the O
bottom O
righthand O
corner O
. O

This O
indicates O
that O
the O
image O
of O
Keqiang O
and O
Abdullah O
was O
likely O
taken O
and O
edited O
sometime O
prior O
to O
07:43:31 O
. O

While O
it O
is O
ambiguous O
as O
to O
which O
timezone O
the O
edits O
actually O
took O
place O
in O
( O
Kazakhstan O
or O
China O
) O
we O
assume O
the O
date O
timestamp O
references O
GMT O
because O
the O
press O
release O
states O
'' O
In O
the O
afternoon O
of O
December O
15 O
local O
time… O
'' O
If O
we O
assume O
the O
photograph O
and O
afternoon O
meeting O
took O
place O
sometime O
prior O
to O
13:43 O
Alma-Ata O
standard O
time O
( O
+0600 O
) O
this O
would O
closely O
correspond O
with O
a O
07:43 O
GMT O
time O
stamp O
. O

The O
modification O
of O
the O
gop-script.js O
by O
the O
attackers O
at O
08:07:06 O
GMT O
likely O
tracks O
extremely O
close O
to O
a O
window O
of O
a O
few O
hours O
in O
which O
Keqiang O
met O
with O
Abdullah O
. O

It O
is O
worth O
mentioning O
that O
a O
similar O
scenario O
occurred O
on O
June O
20th O
when O
security O
researcher O
PhysicalDrive0 O
observed O
a O
malicious O
Java O
file O
hosted O
on O
the O
Embassy O
of O
Greece O
in O
Beijing O
. O

At O
the O
time O
, O
a O
Chinese O
delegation O
led O
by O
Keqiang O
was O
visiting O
Greek O
Prime O
Minister O
Antonis O
Samaras O
in O
Athens O
. O

Security O
researcher O
R136a1 O
aka O
'' O
thegoldenmessenger O
'' O
released O
a O
followup O
blog O
with O
detailed O
analysis O
of O
the O
Greek O
embassy O
compromise O
. O

While O
these O
two O
separate O
events O
are O
not O
directly O
related O
, O
additional O
research O
into O
the O
status O
of O
ministerial O
and O
official O
government O
websites O
on O
or O
around O
the O
dates O
of O
notable O
Chinese O
delegations O
and O
or O
bilateral O
meetings O
may O
yield O
additional O
patterns O
of O
interest O
. O

Upon O
closer O
inspection O
of O
the O
prepended O
malicious O
JavaScript O
code O
, O
one O
will O
notice O
the O
similarity O
in O
the O
update.javaplug-in O
[ O
. O

] O
com O
naming O
convention O
and O
URL O
structure O
to O
the O
C2 O
domain O
java-se O
[ O
. O

] O
com O
found O
in O
the O
Palo O
Alto O
Networks O
blog O
post O
Attacks O
on O
East O
Asia O
using O
Google O
Code O
for O
Command O
and O
Control O
and O
associated O
with O
Operation O
Poisoned O
Hurricane O
. O

However O
, O
the O
malicious O
document.write O
driveby O
URLs O
listed O
above O
both O
result O
in O
403 O
Forbidden O
errors O
as O
of O
December O
18 O
, O
2014 O
. O

While O
the O
403 O
Forbidden O
errors O
may O
seem O
like O
an O
analytic O
dead O
end O
, O
the O
TCIRT O
also O
identified O
a O
malicious O
Java O
applet O
submission O
to O
VirusTotal O
that O
confirms O
the O
nature O
of O
this O
malicious O
activity O
. O

This O
Java O
applet O
, O
SHA1 O
: O
388E6F41462774268491D1F121F333618C6A2C9A O
, O
has O
no O
antivirus O
detections O
as O
of O
December O
21st O
. O

The O
applet O
contains O
its O
malicious O
class O
file O
at O
the O
path O
'' O
jre7u61windows/x86/Update.class O
'' O
. O

This B-Entity
class I-Entity
file I-Entity
downloads B-Action
and I-Action
decodes I-Action
an B-Entity
XOR I-Entity
0xC8 I-Entity
encoded I-Entity
Windows I-Entity
PE I-Entity
executable I-Entity
payload I-Entity
from B-Modifier
[ B-Entity
http I-Entity
: I-Entity
] I-Entity
//mfa.gov I-Entity
[ I-Entity
. I-Entity
] I-Entity
af/content/images/icon35.png I-Entity
, O
hosted O
on O
the O
official O
Afghan O
Ministry O
of O
Foreign O
Affairs O
site O
, O
which O
was O
also O
affected O
by O
the O
gop-script O
XSS O
. O

Using O
historic O
context O
archived O
within O
ThreatConnect O
, O
the O
TCIRT O
concluded O
that O
this O
Java O
applet O
is O
from O
the O
same O
source O
code O
as O
the O
applet O
SHA1 O
: O
ADC162DD909283097E72FC50B7AB0E04AB8A2BCC O
, O
which O
was O
previously O
observed O
by O
the O
TCIRT O
at O
the O
Operation O
Poisoned O
Hurricane O
related O
URL O
[ O
http O
: O
] O
//jre7.java-se O
[ O
. O

] O
com/java.jar O
on O
August O
15 O
, O
2014 O
. O

This B-Entity
applet I-Entity
has O
the O
same O
class O
path O
, O
and O
downloads B-Action
an B-Entity
XOR I-Entity
0xFF I-Entity
encoded I-Entity
payload I-Entity
executable I-Entity
from B-Modifier
the B-Entity
URL I-Entity
[ I-Entity
https I-Entity
: I-Entity
] I-Entity
//amco- I-Entity
triton.co I-Entity
[ I-Entity
. I-Entity
] I-Entity
jp/js/dl/in.jpg I-Entity
. O

Additional O
indicators O
and O
context O
associated O
with O
this O
particular O
Java O
driveby O
activity O
can O
be O
found O
in O
the O
ThreatConnect O
Common O
Community O
Incident O
20140815A O
: O
The B-Entity
XOR I-Entity
0xC8 I-Entity
encoded I-Entity
payload I-Entity
downloaded B-Action
from B-Modifier
[ B-Entity
http I-Entity
: I-Entity
] I-Entity
//mfa.gov I-Entity
[ I-Entity
. I-Entity
] I-Entity
af/content/images/icon35.png I-Entity
decodes O
into O
the O
Windows O
PE O
executable O
SHA1 O
: O
This O
executable O
is O
a O
self-extracting O
( O
SFX O
) O
Microsoft O
Cabinet O
executable O
that O
is O
digitally O
signed O
with O
a O
valid O
certificate O
from O
'' O
OnAndOn O
Information O
System O
Co. O
, O
Ltd. O
'' O
, O
serial O
number O
'' O
1F O
F7 O
D8 O
64 O
18 O
1C O
55 O
5E O
70 O
CF O
DD O
3A O
59 O
34 O
C4 O
7D O
'' O
. O

This O
same O
certificate O
was O
also O
used O
to O
sign O
the O
Java O
applet O
that O
downloaded O
this O
malware O
. O

This B-Entity
executable I-Entity
drops B-Action
the B-Entity
following I-Entity
files I-Entity
: O
Malicious B-Entity
DLL I-Entity
that O
loads B-Action
into B-Modifier
the B-Entity
above I-Entity
dllhost.exe I-Entity
, O
using B-Action
a B-Entity
similar I-Entity
DLL I-Entity
sideloading I-Entity
technique I-Entity
to I-Entity
that I-Entity
most I-Entity
commonly I-Entity
associated I-Entity
with I-Entity
the I-Entity
PlugX I-Entity
backdoor I-Entity
. O

This B-Entity
backdoor I-Entity
connects B-Action
to B-Modifier
the B-Entity
faux I-Entity
Oracle I-Entity
Java I-Entity
themed I-Entity
command I-Entity
and I-Entity
control I-Entity
( I-Entity
C2 I-Entity
) I-Entity
domain I-Entity
oracle0876634.javaplug-in I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
. O

Note O
that O
javaplug-in O
[ O
. O

] O
com O
is O
the O
same O
root O
domain O
found O
in O
the O
compromised O
version O
of O
[ O
http O
: O
] O
//cdn.afghanistan O
[ O
. O

] O
af/scripts/gop-script.js O
as O
[ O
http O
: O
] O
//update.javaplug- O
in O
[ O
. O

] O
com/o/j.js O
, O
confirming O
that O
this O
Java O
malware O
is O
in O
fact O
directly O
associated O
with O
the O
Afghan O
MCIT O
CDN O
XSS O
compromise O
. O

Full O
indicators O
of O
this O
activity O
and O
a O
YARA O
rule O
to O
detect O
the O
malware O
certificate O
can O
be O
found O
in O
the O
ThreatConnect O
Common O
Community O
under O
Incident O
20141217A O
: O
Afghan O
Government O
Java O
Driveby O
and O
signature O
APTOnAndOncert.yara O
. O

As O
the O
US O
and O
NATO O
reduce O
their O
troop O
levels O
in O
Afghanistan O
, O
China O
is O
posturing O
to O
fill O
the O
gap O
of O
influence O
that O
the O
west O
is O
leaving O
behind O
. O

With O
plans O
to O
facilitate O
multilateral O
peace O
talks O
with O
the O
Taliban O
and O
establish O
major O
transportation O
projects O
which O
aim O
to O
bolster O
the O
Afghan O
economy O
, O
Beijing O
has O
been O
eyeing O
Afghanistan O
as O
part O
of O
its O
broader O
South O
Asian O
strategy O
. O

By O
exploiting O
and O
co-opting O
Afghan O
network O
infrastructure O
that O
is O
used O
by O
multiple O
ministerial O
level O
websites O
, O
Chinese B-Entity
intelligence I-Entity
services I-Entity
would O
be O
able O
to O
widely O
distribute B-Action
malicious B-Entity
payloads I-Entity
to B-Modifier
a B-Entity
variety I-Entity
of I-Entity
global I-Entity
targets I-Entity
using B-Modifier
Afghanistan B-Entity
's I-Entity
government I-Entity
websites I-Entity
as I-Entity
a I-Entity
topical I-Entity
and I-Entity
trusted I-Entity
distribution I-Entity
platform I-Entity
, O
exploiting O
a O
single O
hidden O
entry O
point O
. O

This B-Entity
being B-Action
a B-Entity
variant I-Entity
of I-Entity
a I-Entity
typical I-Entity
'' I-Entity
watering-hole I-Entity
'' I-Entity
attack I-Entity
, O
the O
attackers O
will O
most O
likely O
infect O
victims O
outside O
the O
Afghan O
government O
who O
happened O
to O
be O
browsing O
any O
one O
of O
the O
CDN O
client O
systems O
, O
specifically O
, O
partner O
states O
involved O
in O
the O
planned O
troop O
reduction O
. O

It O
is O
important O
to O
consider O
that O
corporate O
enterprises O
are O
not O
immune O
to O
this O
tactic O
, O
and O
this O
is O
not O
just O
a O
technique O
that O
is O
used O
by O
APT O
threat O
actors O
. O

If O
an O
enterprise O
's O
website O
leverages O
a O
CDN O
to O
speed O
up O
content O
delivery O
, O
unintended O
consequences O
must O
be O
anticipated O
. O

Fortunately O
, O
modern O
browsers O
now O
implement O
a O
security O
concept O
called O
'' O
Content O
Security O
Policy O
'' O
. O

As O
long O
as O
the O
server O
's O
response O
headers O
are O
configured O
properly O
, O
third O
party O
content O
may O
be O
restricted O
to O
originating O
from O
a O
narrow O
whitelist O
. O

Just O
as O
attackers O
distribute O
malicious O
content O
to O
users O
en O
masse O
or O
CDN O
services O
distribute O
web O
content O
to O
users O
, O
security O
professionals O
must O
be O
able O
to O
quickly O
distribute O
actionable O
Threat O
Intelligence O
in O
formats O
readable O
by O
both O
humans O
and O
machines O
. O

ThreatConnect O
is O
the O
industry O
's O
first O
comprehensive O
Threat O
Intelligence O
Platform O
that O
enables O
enterprises O
to O
orchestrate O
the O
aggregation O
of O
Threat O
Intelligence O
from O
multiple O
sources O
, O
use O
integrated O
analytics O
and O
a O
robust O
API O
that O
gives O
enterprises O
the O
control O
to O
action O
their O
own O
Threat O
Intelligence O
, O
in O
the O
cloud O
and O
on O
premises O
. O

Register O
for O
a O
free O
account O
now O
to O
view O
the O
Common O
Community O
shares O
and O
more O
. O

Cyber O
espionage O
has O
been O
a O
hot O
topic O
through O
the O
last O
years O
. O

Computer O
attacks O
known O
as O
'' O
APT O
'' O
( O
Advanced O
Persistent O
Threat O
) O
have O
become O
widely O
reported O
and O
emphasized O
by O
the O
media O
, O
damages O
are O
now O
considered O
as O
real O
and O
strategic O
trends O
are O
moving O
in O
cyber O
defense O
. O

AIRBUS O
Defence O
& O
Space O
– O
CyberSecurity O
unit O
responds O
to O
such O
attacks O
for O
its O
customers O
every O
day O
, O
developing O
a O
complete O
range O
of O
solutions O
. O

Today O
, O
we O
decided O
to O
release O
publicly O
information O
on O
a O
specific O
group O
of O
APT O
attackers O
known O
as O
'' O
Pitty O
Tiger O
'' O
. O

This O
information O
comes O
directly O
from O
investigations O
led O
by O
our O
Threat O
Intelligence O
. O

Pitty O
Tiger O
is O
a O
group O
of O
attackers O
that O
have O
been O
active O
since O
at O
least O
2011 O
. O

They O
have O
targeted O
private O
companies O
in O
several O
sectors O
, O
such O
as O
defense O
and O
telecommunications O
, O
but O
also O
at O
least O
one O
government O
. O

We O
have O
been O
able O
to O
track O
down O
this O
group O
of O
attackers O
and O
can O
provide O
detailed O
information O
about O
them O
. O

We O
were O
able O
to O
collect O
and O
reveal O
their O
'' O
malware O
arsenal O
'' O
. O

We O
also O
analyzed O
their O
technical O
organization O
. O

Our O
investigations O
indicate O
that O
Pitty O
Tiger O
has O
not O
used O
any O
0day O
vulnerability O
so O
far O
, O
rather O
they O
prefer O
using O
custom O
malware O
, O
developed O
for O
the O
group O
's O
exclusive O
usage O
. O

Our O
discoveries O
indicate O
that O
Pitty O
Tiger O
is O
a O
group O
of O
attackers O
with O
the O
ability O
to O
stay O
under O
the O
radar O
, O
yet O
still O
not O
as O
mature O
as O
other O
groups O
of O
attackers O
we O
monitor O
. O

Pitty O
Tiger O
is O
probably O
not O
a O
state-sponsored O
group O
of O
attackers O
. O

They O
lack O
the O
experience O
and O
financial O
support O
that O
one O
would O
expect O
from O
state-sponsored O
attackers O
. O

We O
suppose O
this O
group O
is O
opportunistic O
and O
sells O
its O
services O
to O
probable O
competitors O
of O
their O
targets O
in O
the O
private O
sector O
. O

We O
have O
been O
able O
to O
leverage O
several O
attackers O
profiles O
, O
showing O
that O
the O
Pitty O
Tiger O
group O
is O
fairly O
small O
compared O
to O
other O
APT O
groups O
, O
which O
is O
probably O
why O
we O
saw O
them O
work O
on O
a O
very O
limited O
amount O
of O
targets O
. O

At O
the O
end O
of O
this O
report O
, O
we O
provide O
indicators O
of O
compromise O
to O
help O
people O
detect O
current O
Pitty O
Tiger O
attacks O
. O

APT O
attacks O
follow O
what O
we O
call O
the O
'' O
APT O
kill O
chain O
'' O
. O

The O
kill O
chain O
describes O
briefly O
the O
way O
attackers O
do O
perform O
their O
actions O
. O

It O
can O
be O
summarized O
by O
the O
following O
scheme O
: O
The O
reconnaissance O
phase O
commences O
when O
an O
attacker O
selects O
a O
new O
target O
and O
involves O
the O
acquisition O
of O
information O
about O
that O
target O
. O

There O
is O
very O
little O
information O
available O
about O
this O
phase O
, O
and O
there O
is O
little O
data O
about O
it O
. O

The O
only O
way O
to O
collect O
information O
about O
this O
phase O
would O
be O
to O
already O
monitor O
all O
attackers O
' O
actions O
at O
this O
step O
, O
which O
is O
hardly O
feasible O
. O

The O
longer O
the O
attackers O
spend O
time O
in O
attempting O
to O
understand O
their O
target O
and O
its O
online O
presence O
, O
the O
easier O
it O
will O
be O
to O
find O
efficient O
ways O
to O
penetrate O
that O
company O
's O
systems O
. O

This O
reconnaissance O
phase O
is O
both O
about O
finding O
information O
to O
break O
into O
the O
targeted O
network O
successfully O
and O
about O
searching O
for O
data O
which O
could O
help O
to O
accelerate O
sensitive O
information O
isolation O
( O
like O
the O
name O
of O
a O
key O
employee O
for O
example O
) O
. O

This O
phase O
mostly O
relies O
on O
open O
sources O
from O
the O
Internet O
: O
social O
networks O
, O
press O
releases O
, O
white O
papers O
, O
corporate O
websites O
, O
search O
engines O
, O
but O
also O
on O
some O
active O
tools O
like O
vulnerability O
scanners O
etc O
. O

At O
this O
stage O
, O
the O
APT O
attackers O
have O
a O
solid O
knowledge O
of O
their O
target O
and O
its O
key O
employees O
. O

The B-Entity
attackers I-Entity
have O
everything O
they O
need O
to O
start O
looking O
for O
an O
entry O
point O
to O
the O
company O
's O
network O
and O
establish B-Action
one B-Entity
or I-Entity
several I-Entity
permanent I-Entity
backdoors I-Entity
into B-Modifier
the B-Entity
environment I-Entity
. O

The B-Entity
attackers I-Entity
mostly O
rely B-Action
on B-Modifier
two O
techniques O
here O
to O
infect O
one O
or O
several O
computers O
, O
usually O
workstations O
, O
inside O
the O
target O
's O
network O
: O
spear B-Entity
phishing I-Entity
and I-Entity
drive-by I-Entity
downloads I-Entity
. O

Spear B-Entity
phishing I-Entity
can O
be B-Action
described I-Action
as B-Modifier
targeted B-Entity
e-mail I-Entity
phishing I-Entity
. O

In B-Modifier
a B-Entity
spear I-Entity
phishing I-Entity
scheme I-Entity
, O
attackers B-Entity
send B-Action
very B-Entity
few I-Entity
e-mails I-Entity
to B-Modifier
targeted B-Entity
people I-Entity
. O

In O
fact O
, O
they O
can O
even O
send O
just O
a O
single O
e-mail O
. O

The O
trick O
is O
to O
target B-Action
the B-Entity
right I-Entity
victim I-Entity
and O
provide B-Action
it B-Entity
with B-Modifier
the B-Entity
right I-Entity
content I-Entity
, O
so O
that O
they B-Entity
will O
click B-Action
on B-Modifier
a B-Entity
link I-Entity
leading I-Entity
to I-Entity
drive-by I-Entity
download I-Entity
of I-Entity
a I-Entity
malware I-Entity
, O
or O
open B-Action
an B-Entity
attached I-Entity
file I-Entity
which I-Entity
will I-Entity
infect I-Entity
their I-Entity
computer I-Entity
. O

Some B-Entity
groups I-Entity
of I-Entity
attackers I-Entity
also O
use B-Action
'' B-Entity
watering I-Entity
hole I-Entity
'' I-Entity
techniques I-Entity
to B-Modifier
successfully B-Entity
compromise I-Entity
their I-Entity
targets I-Entity
. O

To B-Modifier
build B-Entity
a I-Entity
watering I-Entity
hole I-Entity
attack I-Entity
, O
attackers B-Entity
do O
compromise B-Action
the B-Entity
website I-Entity
of I-Entity
a I-Entity
third I-Entity
party I-Entity
, I-Entity
generally I-Entity
a I-Entity
supplier I-Entity
of I-Entity
the I-Entity
target I-Entity
, I-Entity
which I-Entity
is I-Entity
typically I-Entity
visited I-Entity
by I-Entity
a I-Entity
specific I-Entity
group I-Entity
of I-Entity
professionals I-Entity
and I-Entity
very I-Entity
likely I-Entity
by I-Entity
the I-Entity
target I-Entity
. O

Every B-Entity
visitor I-Entity
of I-Entity
the I-Entity
compromised I-Entity
third I-Entity
party I-Entity
is B-Action
then I-Action
infected I-Action
. O

The O
method O
has O
one O
major O
drawback O
: O
it O
will O
also O
infect O
third O
parties O
who O
visit O
the O
website O
. O

Attackers O
have O
developed O
ways O
to O
avoid O
this O
. O

If O
their O
reconnaissance O
phase O
has O
been O
done O
effectively O
, O
they O
already O
know O
all O
IP O
ranges O
used O
by O
the O
target O
company O
. O

It O
just O
takes O
a O
few O
lines O
of O
code O
in O
the O
infecting O
script O
to O
only O
compromise B-Action
visitors B-Entity
coming I-Entity
from I-Entity
the I-Entity
target I-Entity
IP I-Entity
ranges I-Entity
. O

Direct O
attacks O
against O
servers O
of O
the O
target O
can O
also O
be O
a O
way O
to O
penetrate O
the O
target O
's O
network O
. O

Attackers B-Entity
have O
gained B-Action
access B-Entity
to I-Entity
one I-Entity
or I-Entity
several I-Entity
machines I-Entity
inside I-Entity
the I-Entity
target I-Entity
's I-Entity
corporate I-Entity
network I-Entity
. O

They B-Entity
need O
to O
install B-Action
several B-Entity
different I-Entity
backdoors I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
be B-Entity
able I-Entity
to I-Entity
always I-Entity
access I-Entity
the I-Entity
network I-Entity
. O

In O
case O
one O
backdoor O
falls O
, O
there O
will O
be O
others O
. O

As O
soon O
as O
the O
attackers O
are O
sure O
they O
have O
enough O
access O
, O
they B-Entity
start O
looking B-Action
for B-Modifier
two O
things O
: O
intellectual B-Entity
property I-Entity
( I-Entity
or I-Entity
anything I-Entity
else I-Entity
they I-Entity
want I-Entity
to I-Entity
know I-Entity
or I-Entity
steal I-Entity
) I-Entity
in I-Entity
alignment I-Entity
with I-Entity
predefined I-Entity
mission I-Entity
objectives I-Entity
, O
and O
a B-Entity
means I-Entity
of I-Entity
privilege I-Entity
escalation I-Entity
to I-Entity
facilitate I-Entity
lateral I-Entity
movement I-Entity
within I-Entity
the I-Entity
compromised I-Entity
environment I-Entity
. O

It O
generally O
does O
not O
take O
long O
before O
the B-Entity
attackers I-Entity
gain B-Action
domain B-Entity
administrator I-Entity
privileges I-Entity
and O
dump B-Action
all B-Entity
the I-Entity
Active I-Entity
Directory I-Entity
content I-Entity
. O

They O
use O
lateral O
moves O
between O
machines O
inside O
the O
network O
, O
and O
look O
for O
everything O
they O
need O
. O

This O
step O
is O
very O
hard O
to O
detect O
, O
since O
they O
only O
use O
valid O
credentials O
and O
legitimate O
administration O
tools O
such O
as O
PsExec O
. O

Data B-Entity
exfiltration I-Entity
is B-Action
the B-Entity
last I-Entity
step I-Entity
before O
the O
attackers O
loop O
to O
the O
lateral O
moves O
step O
, O
in O
a O
never-ending O
circle O
of O
prolonged O
access O
and O
information O
theft O
. O

They B-Entity
generally O
create B-Action
archive B-Entity
files I-Entity
containing I-Entity
the I-Entity
content I-Entity
they I-Entity
want I-Entity
to I-Entity
exfiltrate I-Entity
, O
which O
are B-Action
then I-Action
sent I-Action
to B-Modifier
the B-Entity
attackers I-Entity
by B-Modifier
using B-Entity
a I-Entity
remote I-Entity
administration I-Entity
tool I-Entity
( I-Entity
RAT I-Entity
) I-Entity
or I-Entity
transfer I-Entity
protocols I-Entity
such I-Entity
as I-Entity
FTP I-Entity
and I-Entity
HTTP I-Entity
. O

This O
phase O
is O
not O
the O
end O
of O
an O
APT O
attack O
. O

The B-Entity
attackers I-Entity
loop O
to O
the O
access O
strengthening/lateral O
moves O
stage O
and O
generally O
keep O
stealing B-Action
more B-Entity
information I-Entity
and O
stay B-Action
inside B-Modifier
the B-Entity
network I-Entity
for B-Modifier
more B-Entity
data I-Entity
gathering I-Entity
. O

For O
more O
information O
about O
all O
the O
APT O
phases O
, O
please O
refer O
to O
our O
APT O
Kill O
Chain O
blog O
post O
serie O
. O

During O
our O
regular O
investigations O
on O
APT O
cases O
, O
one O
particular O
variant O
of O
malware O
caught O
our O
attention O
, O
because O
we O
had O
not O
faced O
it O
before O
. O

We O
decided O
to O
spend O
some O
time O
to O
investigate O
around O
this O
malware O
and O
found O
out O
that O
it O
was O
used O
exclusively O
by O
a O
single O
group O
of O
attackers O
. O

This O
malware O
family O
is O
known O
as O
'' O
PittyTiger O
'' O
by O
the O
anti-virus O
research O
community O
. O

We O
discovered O
this B-Entity
malware I-Entity
sample I-Entity
in O
June O
2014 O
, O
leading B-Action
to B-Modifier
a B-Entity
command I-Entity
& I-Entity
control I-Entity
( I-Entity
c I-Entity
& I-Entity
c I-Entity
) I-Entity
server I-Entity
still I-Entity
in I-Entity
activity I-Entity
. O

Our O
researches O
around O
this O
particular O
malware O
family O
revealed O
the O
'' O
Pitty O
Tiger O
'' O
group O
has O
been O
active O
since O
2011 O
, O
yet O
we O
found O
other O
publications O
which O
could O
probably O
be O
attributed O
to O
the O
same O
group O
of O
attacker O
back O
in O
2010 O
. O

This O
group O
uses O
other O
malware O
and O
tools O
during O
their O
APT O
operations O
, O
in O
addition O
to O
the O
PittyTiger O
RAT O
. O

A O
variant O
of O
the O
infamous O
Gh0st O
RAT O
dubbed O
'' O
Paladin O
'' O
has O
been O
used O
repeatedly O
by O
the O
PT O
group O
, O
together O
with O
other O
RATs O
which O
seem O
to O
be O
developed O
exclusively O
for O
the O
PT O
group O
: O
'' O
MM O
RAT O
'' O
( O
aka O
Troj/Goldsun-B O
) O
, O
and O
'' O
CT O
RAT O
'' O
. O

Another O
variant O
of O
Gh0st O
RAT O
named O
'' O
Leo O
'' O
has O
been O
found O
inactive O
on O
a O
c O
& O
c O
server O
. O

We O
also O
found O
another O
malware O
, O
named O
'' O
Troj/ReRol.A O
'' O
. O

This B-Entity
one I-Entity
is O
also O
used O
by O
the O
group O
to O
infect B-Action
workstations B-Entity
, O
collect B-Action
system B-Entity
information I-Entity
, O
and O
install B-Action
more B-Entity
malware I-Entity
on B-Modifier
the B-Entity
infected I-Entity
computer I-Entity
. O

It B-Entity
acts B-Action
as B-Modifier
a B-Entity
first I-Entity
stage I-Entity
downloader I-Entity
and O
system B-Entity
data I-Entity
collector I-Entity
often O
used O
in O
the O
initial O
compromise O
of O
the O
Pitty O
Tiger O
campaigns O
, O
generally O
embedded B-Action
in B-Modifier
Microsoft B-Entity
Office I-Entity
documents I-Entity
. O

Thanks O
to O
server O
's O
misconfigurations O
, O
we O
managed O
to O
get O
information O
from O
three B-Entity
c I-Entity
& I-Entity
c I-Entity
servers I-Entity
used B-Action
by O
this B-Entity
group I-Entity
of I-Entity
attackers I-Entity
, O
which O
provided O
us O
with O
insight O
from O
the O
end O
of O
2013 O
to O
the O
beginning O
of O
July O
2014 O
. O

Our O
investigation O
has O
been O
focused O
on O
the O
data O
we O
could O
get O
from O
these O
c O
& O
c O
servers O
but O
also O
on O
the O
Pitty O
Tiger O
environment O
. O

This O
whitepaper O
aims O
to O
expose O
the O
view O
we O
have O
on O
the O
group O
, O
especially O
on O
their O
infrastructure O
and O
capabilities O
. O

We O
hope O
this O
publication O
will O
bring O
further O
counter O
analysis O
from O
the O
research O
community O
to O
enrich O
the O
global O
common O
threat O
knowledge O
. O

Pitty B-Entity
Tiger I-Entity
, O
like O
most O
other O
APT O
groups O
, O
use B-Action
spear B-Entity
phishing I-Entity
e-mails I-Entity
extensively B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
gain B-Entity
an I-Entity
initial I-Entity
foothold I-Entity
within I-Entity
the I-Entity
targeted I-Entity
environment I-Entity
. O

We O
have O
been O
able O
to O
find O
a B-Entity
spear I-Entity
phishing I-Entity
e-mail I-Entity
crafted B-Action
by O
the B-Entity
attackers I-Entity
. O

This B-Entity
e-mail I-Entity
spoofed B-Action
the B-Entity
identity I-Entity
of I-Entity
an I-Entity
employee I-Entity
of I-Entity
a I-Entity
targeted I-Entity
company I-Entity
: O
The O
attached O
file O
is O
a B-Entity
Microsoft I-Entity
Office I-Entity
Word I-Entity
document I-Entity
triggering B-Action
CVE-2014-1761 B-Entity
to B-Modifier
infect B-Entity
the I-Entity
computer I-Entity
it I-Entity
is I-Entity
sent I-Entity
to I-Entity
: O
While O
this O
example O
looks O
very O
'' O
amateur O
'' O
for O
a O
spear O
phishing O
attempt O
, O
we O
suppose O
the B-Entity
group I-Entity
has O
conducted B-Action
more B-Entity
advanced I-Entity
spear I-Entity
phishing I-Entity
campaigns I-Entity
, O
based O
on O
the O
fact O
that O
we O
found O
infected O
Word O
documents O
showing O
content B-Entity
stolen B-Action
from B-Modifier
victims B-Entity
of I-Entity
the I-Entity
group I-Entity
. O

These B-Entity
documents I-Entity
were B-Action
infecting I-Action
the B-Entity
system I-Entity
with B-Modifier
Troj/ReRol.A B-Entity
malware I-Entity
, O
which O
we O
will O
detail O
later O
in O
this O
report O
. O

This O
could O
mean O
that O
the B-Entity
Pitty I-Entity
Tiger I-Entity
group I-Entity
is B-Action
using I-Action
stolen B-Entity
material I-Entity
as B-Modifier
spear B-Entity
phishing I-Entity
content I-Entity
either O
to O
target O
other O
persons O
in O
the O
compromised O
company O
, O
or O
to O
target O
other O
persons O
in O
a O
competitor's O
company O
, O
or O
more O
generally O
to O
compromise O
another O
target O
. O

Pitty B-Entity
Tiger I-Entity
also O
seem O
to O
use B-Action
fake B-Entity
Microsoft I-Entity
Office I-Entity
Excel I-Entity
content I-Entity
, O
yet O
we O
could O
only O
find O
empty O
content O
delivering O
once O
again O
the O
Troj/ReRol.A O
malware O
. O

Although O
we O
have O
not O
been O
able O
to O
find O
evidences O
of O
any O
attack O
aimed O
at O
exploiting O
vulnerabilities O
on O
the O
group O
's O
targets O
servers O
, O
we O
have O
been O
able O
to O
record O
several O
vulnerability B-Entity
scanning I-Entity
launched B-Action
from B-Modifier
one B-Entity
c I-Entity
& I-Entity
c I-Entity
server I-Entity
straight B-Modifier
to I-Modifier
the B-Entity
targets I-Entity
. O

The B-Entity
attackers I-Entity
have O
been B-Action
using I-Action
different B-Entity
vulnerability I-Entity
scanners I-Entity
aimed I-Entity
at I-Entity
their I-Entity
targets I-Entity
. O

While O
some B-Entity
targets I-Entity
have O
been B-Action
scanned I-Action
with B-Modifier
'' B-Entity
generic I-Entity
'' I-Entity
vulnerability I-Entity
scanning I-Entity
tools I-Entity
like I-Entity
HScan I-Entity
or I-Entity
Fluxay I-Entity
and I-Entity
port I-Entity
scanners I-Entity
like I-Entity
Nmap I-Entity
, O
some B-Entity
other I-Entity
targets I-Entity
have O
been B-Action
scanned I-Action
for B-Modifier
very B-Entity
specific I-Entity
vulnerabilities I-Entity
, I-Entity
like I-Entity
a I-Entity
ZyWALL I-Entity
vulnerability I-Entity
or I-Entity
a I-Entity
FORTINET I-Entity
product I-Entity
. O

We O
have O
also O
been O
able O
to O
testify O
that O
the B-Entity
Pitty I-Entity
Tiger I-Entity
group I-Entity
has O
successfully O
collected B-Action
information B-Entity
on I-Entity
some I-Entity
of I-Entity
their I-Entity
targets I-Entity
by B-Modifier
exploiting B-Entity
the I-Entity
HeartBleed I-Entity
bug I-Entity
. O

This O
vulnerability O
which O
exists O
on O
some O
old O
versions O
of O
OpenSSL O
allows O
attackers B-Entity
to O
collect B-Action
data B-Entity
from B-Modifier
chunks B-Entity
of I-Entity
memory I-Entity
from I-Entity
the I-Entity
targeted I-Entity
machine I-Entity
. O

It O
allowed O
the B-Entity
Pitty I-Entity
Tiger I-Entity
group I-Entity
to O
get B-Action
admin B-Entity
credentials I-Entity
from B-Modifier
at B-Entity
least I-Entity
one I-Entity
target I-Entity
, O
for O
example O
. O

Running B-Action
automated B-Entity
vulnerability I-Entity
scanners I-Entity
on B-Modifier
whole B-Entity
ranges I-Entity
of I-Entity
IP I-Entity
addresses I-Entity
used I-Entity
by I-Entity
the I-Entity
targets I-Entity
or O
on B-Modifier
several B-Entity
domains I-Entity
is O
a O
very O
noisy O
way O
to O
collect B-Action
information B-Entity
and O
find B-Action
server B-Entity
vulnerabilities I-Entity
. O

We O
would O
advocate O
that O
this O
method O
is O
unwise O
when O
you O
want O
to O
stay O
furtive O
, O
and O
doing O
it O
from O
a O
c O
& O
c O
server O
is O
very O
surprising O
, O
to O
say O
the O
least O
. O

While O
the O
Pitty O
Tiger O
group O
is O
experienced O
on O
some O
aspects O
on O
its O
running O
APT O
campaigns O
, O
it O
definitely O
lacks O
some O
maturity O
here O
. O

One O
of O
the O
favorite O
methods O
used O
by O
the B-Entity
Pitty I-Entity
Tiger I-Entity
group I-Entity
to B-Modifier
infect B-Entity
users I-Entity
is O
to O
use B-Action
a B-Entity
Microsoft I-Entity
Office I-Entity
Word I-Entity
document I-Entity
which I-Entity
exploits I-Entity
a I-Entity
specific I-Entity
vulnerability I-Entity
. O

The B-Entity
payload I-Entity
infecting B-Action
the B-Entity
system I-Entity
is O
malware O
known O
as O
'' O
Troj/ReRol.A O
'' O
. O

It O
is O
generally O
the O
first O
step O
of O
the O
initial O
compromise O
for O
Pitty O
Tiger O
campaigns O
. O

We O
have O
been O
able O
to O
find O
one B-Entity
such I-Entity
document I-Entity
used I-Entity
by I-Entity
that I-Entity
group I-Entity
of I-Entity
attacker I-Entity
, O
exploiting B-Action
CVE- B-Entity
2012-0158 I-Entity
, I-Entity
an I-Entity
old I-Entity
critical I-Entity
vulnerability I-Entity
impacting I-Entity
Microsoft I-Entity
Office I-Entity
and I-Entity
corrected I-Entity
by I-Entity
Microsoft's I-Entity
MS12-027 I-Entity
fix I-Entity
in I-Entity
April I-Entity
2012 I-Entity
. O

This O
vulnerability O
affects O
Microsoft O
Office O
versions O
up O
to O
Office O
2010 O
. O

We O
also O
found O
one B-Entity
RTF I-Entity
document I-Entity
embedding B-Action
CVE-2014-1761 B-Entity
, O
which O
is O
a O
more O
recent O
exploit O
. O

We O
discovered O
several B-Entity
different I-Entity
documents I-Entity
spreading B-Action
this B-Entity
malware I-Entity
by B-Modifier
triggering B-Entity
CVE-2012-0158 I-Entity
vulnerability I-Entity
, O
yet O
we O
could O
not O
share O
them O
in O
this O
report O
, O
since O
these O
documents O
contain O
information O
about O
victims O
of O
the O
Pitty O
Tiger O
group O
. O

The O
discovery O
of O
this O
'' O
old O
'' O
vulnerability O
exploitation O
in O
June O
2014 O
could O
mean O
that O
the O
Pitty O
Tiger O
group O
has O
no O
direct O
access O
to O
0day O
exploits O
, O
or O
not O
enough O
budgets O
to O
buy O
some O
. O

It O
could O
also O
mean O
they O
use O
their O
low O
range O
exploit O
by O
default O
because O
it O
is O
working O
on O
their O
targets O
and O
is O
sufficient O
to O
compromise O
their O
workstations O
. O

The O
Word O
document O
we O
initially O
found O
was O
probably O
a O
'' O
test O
'' O
document O
used O
by O
the O
group O
. O

When O
opened O
, O
it O
shows O
a O
single O
line O
written O
in O
Chinese O
language O
, O
which O
can O
be O
translated O
as O
'' O
Hello O
! O
'' O
When O
successfully O
triggered O
, O
the B-Entity
exploit I-Entity
infects B-Action
the B-Entity
host I-Entity
by O
dropping B-Action
and O
executing B-Action
a B-Entity
file I-Entity
named I-Entity
'' I-Entity
svohost.exe I-Entity
'' I-Entity
in B-Modifier
the B-Entity
temporary I-Entity
folder I-Entity
of I-Entity
the I-Entity
currently I-Entity
logged-in I-Entity
user I-Entity
: O
This O
binary O
is O
'' O
Troj/ReRol.A O
'' O
according O
to O
Sophos O
naming O
convention O
. O

It O
immediately O
triggers O
alarms O
on O
our O
sandbox O
: O
The B-Entity
binary I-Entity
drops B-Action
a B-Entity
copy I-Entity
of I-Entity
itself I-Entity
in B-Modifier
the B-Entity
Application I-Entity
Data I-Entity
folder I-Entity
of I-Entity
the I-Entity
currently I-Entity
logged-in I-Entity
user I-Entity
: O
The B-Entity
malware I-Entity
initiates B-Action
a B-Entity
communication I-Entity
to B-Modifier
time.windows.com B-Entity
to O
check B-Action
for B-Modifier
connectivity B-Entity
, O
and O
then O
communicates B-Action
with B-Modifier
the B-Entity
c I-Entity
& I-Entity
c I-Entity
server I-Entity
at B-Modifier
mac.avstore.com.tw B-Entity
. O

Very O
few O
variants O
of O
Troj/ReRol.A O
are O
public O
. O

The O
variants O
we O
have O
seen O
did O
use O
that O
same O
User- O
Agent O
: O
The B-Entity
persistence I-Entity
mechanism I-Entity
used B-Action
by O
the B-Entity
malware I-Entity
is B-Action
the B-Entity
creation I-Entity
of I-Entity
a I-Entity
registry I-Entity
key I-Entity
named I-Entity
'' I-Entity
Shell I-Entity
'' I-Entity
containing I-Entity
the I-Entity
path I-Entity
to I-Entity
the I-Entity
malware I-Entity
on I-Entity
the I-Entity
infected I-Entity
system I-Entity
: O
The B-Entity
payload I-Entity
of I-Entity
this I-Entity
malware I-Entity
is B-Action
used I-Action
to B-Modifier
collect B-Entity
information I-Entity
on I-Entity
the I-Entity
newly I-Entity
infected I-Entity
host I-Entity
, O
and O
send B-Action
it B-Entity
back B-Modifier
to I-Modifier
the B-Entity
c I-Entity
& I-Entity
c I-Entity
server I-Entity
. O

It B-Entity
can O
also O
download B-Action
and O
execute B-Action
binaries B-Entity
. O

The B-Entity
data I-Entity
sent B-Action
in B-Modifier
the B-Entity
POST I-Entity
request I-Entity
has O
a O
0x11 O
bytes O
header O
consisting O
of O
a O
fixed-value O
byte O
( O
0xc3 O
) O
followed O
by O
a O
0x10 O
bytes O
encryption O
key O
. O

The B-Entity
data I-Entity
following I-Entity
the I-Entity
header I-Entity
is B-Action
encrypted I-Action
using B-Modifier
RC4 B-Entity
with B-Modifier
the B-Entity
previous I-Entity
key I-Entity
. O

Once O
the O
data O
is O
deciphered O
, O
the O
last O
byte O
of O
the O
clear O
text O
should O
also O
be O
0xc3 O
. O

We O
have O
been O
able O
to O
decrypt O
the O
communications O
and O
confirmed O
what O
is O
transmitted O
to O
the O
c O
& O
c O
server O
. O

Here O
is O
an O
anonymized O
sample O
of O
communication O
showing O
information B-Entity
collected B-Action
by O
the B-Entity
malware I-Entity
: O
This O
information O
is O
very O
useful O
for O
an O
attacker O
: O
it B-Entity
shows B-Action
all B-Entity
software I-Entity
installed I-Entity
on I-Entity
the I-Entity
system I-Entity
, O
and O
running B-Entity
services I-Entity
. O

Once O
this B-Entity
data I-Entity
has O
been B-Action
transferred I-Action
to B-Modifier
the B-Entity
c I-Entity
& I-Entity
c I-Entity
server I-Entity
, O
it B-Entity
responds O
by O
sending B-Action
additional B-Entity
malware I-Entity
to I-Entity
execute I-Entity
on I-Entity
the I-Entity
machine I-Entity
. O

The O
c O
& O
c O
part O
consists O
of O
two O
files O
: O
The O
dr.asp O
registers O
the O
following O
keywords O
: O
These O
two O
binaries O
were O
no O
longer O
available O
on O
the O
server O
. O

However O
, O
we O
found O
various O
files O
which O
could O
have O
been O
used O
as O
'' O
32.exe O
'' O
in O
the O
past O
: O
The O
322.exe O
file O
is O
a O
legitimate O
, O
Chinese O
, O
calc.exe O
tool O
. O

It O
might O
have O
been O
used O
by O
the O
attackers O
to O
perform O
tests O
. O

The O
3 O
others O
binaries O
are O
RATs O
, O
which O
will O
be O
detailed O
in O
the O
next O
parts O
. O

This O
RAT O
is O
the O
origin O
of O
the O
attackers O
' O
group O
name O
. O

'' O
PittyTiger O
'' O
is O
a O
mutex O
used O
by O
the O
malware O
. O

'' O
Pitty O
Tiger O
'' O
is O
also O
a O
string O
transmitted O
in O
the O
network O
communications O
of O
the O
RAT O
, O
as O
you O
will O
see O
in O
this O
chapter O
. O

The O
malware O
, O
when O
running O
in O
our O
sandbox O
, O
triggers O
the O
following O
alarms O
: O
The B-Entity
binary I-Entity
drops B-Action
two B-Entity
files I-Entity
in B-Modifier
'' B-Entity
C I-Entity
: I-Entity
\Windows\System32 I-Entity
'' I-Entity
: O
The B-Entity
'' I-Entity
qmgrxp.exe I-Entity
'' I-Entity
binary I-Entity
is B-Action
a B-Entity
simple I-Entity
copy I-Entity
of I-Entity
the I-Entity
original I-Entity
binary I-Entity
. O

It B-Entity
drops B-Action
the B-Entity
'' I-Entity
packet64.dll I-Entity
'' I-Entity
, O
and O
injects B-Action
it B-Entity
in B-Modifier
'' B-Entity
explorer.exe I-Entity
'' I-Entity
. O

When O
executed O
, O
a B-Entity
mutex I-Entity
called I-Entity
'' I-Entity
PittyTiger I-Entity
'' I-Entity
is B-Action
created I-Action
. O

Persistence B-Entity
is B-Action
achieved I-Action
by B-Modifier
adding B-Entity
the I-Entity
path I-Entity
to I-Entity
the I-Entity
binary I-Entity
to I-Entity
the I-Entity
WinlogonUserInit I-Entity
key I-Entity
: O
The O
'' O
packet64.dll O
'' O
is O
the O
main O
payload O
of O
the O
RAT O
. O

After O
being O
injected O
, O
it B-Entity
starts O
sending B-Action
its B-Entity
Hello I-Entity
packet I-Entity
to B-Modifier
its B-Entity
c I-Entity
& I-Entity
c I-Entity
server I-Entity
: O
All B-Entity
the I-Entity
requests I-Entity
sent B-Action
to B-Modifier
the B-Entity
c I-Entity
& I-Entity
c I-Entity
contains O
the O
string O
'' O
/FC001/ O
'' O
followed O
by O
the O
bot O
id O
. O

This O
id O
consists O
of O
the O
infected O
computer O
name O
followed O
by O
a O
dash O
and O
the O
lower O
word O
of O
the O
disk O
serial O
id O
. O

The B-Entity
data I-Entity
sent I-Entity
is B-Action
simply I-Action
encoded I-Action
using B-Modifier
base64 B-Entity
, O
there O
is O
no O
cipher O
at O
all O
. O

The O
hello O
packet O
, O
once O
decoded O
, O
looks O
like O
the O
following O
: O
Our B-Entity
sample I-Entity
had O
3 B-Entity
c I-Entity
& I-Entity
c I-Entity
servers I-Entity
configured B-Action
: O
The B-Entity
following I-Entity
commands I-Entity
are B-Action
implemented I-Action
: O
Regarding O
the O
controller O
part O
, O
we O
found O
two O
different O
versions O
: O
The O
interface O
handling O
both O
Pitty O
TIGER O
and O
CT O
connections O
is O
very O
interesting O
. O

We O
have O
been O
able O
to O
confirm O
that O
the O
author O
of O
those O
two O
families O
of O
malware O
is O
the O
same O
person O
, O
as O
will O
be O
seen O
in O
the O
next O
chapter O
about O
'' O
CT O
RAT O
'' O
. O

This B-Entity
remote I-Entity
administration I-Entity
tool I-Entity
is B-Action
often I-Action
used I-Action
by O
the B-Entity
Pitty I-Entity
Tiger I-Entity
group I-Entity
. O

We O
have O
been O
able O
to O
acquire O
both O
the O
client O
and O
the O
server O
parts O
. O

We O
found O
two O
instances O
of O
the O
same O
binary O
with O
different O
names O
– O
32mm.exe O
and O
mm32.exe O
. O

This O
RAT O
seems O
to O
be O
an O
evolution O
of O
PittyTiger O
, O
since O
a O
specific O
server O
binary O
we O
found O
could O
handle O
both O
requests O
from O
CT O
and O
PittyTiger O
, O
and O
was O
indicated O
as O
compatible O
with O
PittyTiger O
. O

Moreover O
, O
the B-Entity
same I-Entity
commands I-Entity
are B-Action
implemented I-Action
in B-Modifier
both B-Entity
RATs I-Entity
. O

Unsurprisingly O
, O
when O
running O
in O
our O
sandbox O
, O
the O
RAT O
triggers O
the O
same O
alarms O
as O
PittyTiger O
: O
The B-Entity
binary I-Entity
drops B-Action
two B-Entity
files I-Entity
in B-Modifier
'' B-Entity
C I-Entity
: I-Entity
\Program I-Entity
Files\Internet I-Entity
Explorer I-Entity
'' I-Entity
: O
The B-Entity
'' I-Entity
ieupdate.exe I-Entity
'' I-Entity
is O
a O
simple O
binary O
to O
inject B-Action
the B-Entity
DLL I-Entity
into B-Modifier
'' B-Entity
explorer.exe I-Entity
'' I-Entity
. O

Persistence B-Entity
is B-Action
achieved I-Action
via B-Modifier
the B-Entity
following I-Entity
registry I-Entity
key I-Entity
: O
After O
injection O
, O
the B-Entity
RAT I-Entity
sends B-Action
a B-Entity
first I-Entity
login I-Entity
packet I-Entity
to B-Modifier
its B-Entity
c I-Entity
& I-Entity
c I-Entity
: O
The B-Entity
RAT I-Entity
communication I-Entity
is B-Action
performed I-Action
through B-Modifier
HTTP B-Entity
requests I-Entity
. O

The B-Entity
data I-Entity
is B-Action
sent I-Action
encrypted B-Entity
with I-Entity
RC4 I-Entity
, I-Entity
and I-Entity
base64-encoded I-Entity
. O

The O
RC4 O
key O
is O
the O
Unicode O
form O
of O
the O
requested O
URL O
. O

The O
Login O
packet O
contains O
the O
following O
string O
, O
after O
decoding O
and O
deciphering O
: O
It B-Entity
contains B-Action
the B-Entity
computer I-Entity
name I-Entity
, O
the B-Entity
user I-Entity
name I-Entity
, O
the B-Entity
internal I-Entity
IP I-Entity
address I-Entity
, O
the B-Entity
OS I-Entity
version I-Entity
, O
the B-Entity
RAT I-Entity
internal I-Entity
version I-Entity
and O
the B-Entity
Language I-Entity
ID I-Entity
of I-Entity
the I-Entity
system I-Entity
. O

The B-Entity
RAT I-Entity
can O
then O
receive B-Action
commands B-Entity
from B-Modifier
its B-Entity
c I-Entity
& I-Entity
c I-Entity
. O

Usual O
RAT O
features O
are O
implemented O
: O
Regarding O
the O
configuration O
, O
our B-Entity
sample I-Entity
communicates B-Action
with B-Modifier
'' B-Entity
sop.avstore.com.tw I-Entity
'' I-Entity
, O
and O
contains O
the O
string O
'' O
Nov O
13 O
2013 O
'' O
, O
which O
should O
be O
a O
version O
identifier O
. O

The O
c O
& O
c O
part O
is O
a O
Windows O
binary O
written O
in O
.NET O

. O

We O
found O
2 O
versions O
: O
The O
About O
form O
gives O
the O
name O
of O
the O
developer O
( O
s O
) O
: O
The O
version O
of O
the O
controller O
which O
can O
handle O
both O
PittyTiger O
and O
CT O
shows O
the O
same O
author O
( O
s O
) O
: O
As O
these O
screenshots O
show O
, O
the O
switch O
between O
PittyTiger O
and O
CT O
was O
probably O
in O
the O
last O
semester O
of O
2013 O
. O

The O
text O
can O
be O
translated O
, O
thanks O
to O
Google O
Translate O
, O
as O
: O
Further O
discussion O
about O
this O
author O
is O
provided O
in O
subsequent O
sections O
. O

We O
named O
this O
malware O
'' O
MM O
RAT O
'' O
at O
the O
beginning O
of O
our O
investigation O
, O
before O
we O
found O
an O
existing O
name O
for O
it O
, O
'' O
Troj/Goldsun-B O
'' O
according O
to O
Sophos O
. O

This O
is O
another B-Entity
remote I-Entity
administration I-Entity
tool I-Entity
often O
used B-Action
by O
the B-Entity
Pitty I-Entity
Tiger I-Entity
crew I-Entity
. O

We O
have O
been O
able O
to O
acquire O
both O
a O
client O
and O
server O
part O
for O
it O
. O

The O
binary O
we O
found O
is O
named O
3200.exe O
, O
and O
triggers O
the O
following O
alarms O
in O
our O
sandbox O
: O
The B-Entity
'' I-Entity
release.tmp I-Entity
'' I-Entity
file I-Entity
is B-Action
dropped I-Action
on B-Modifier
the B-Entity
system I-Entity
: O
The B-Entity
binary I-Entity
is B-Action
also I-Action
copied I-Action
to B-Modifier
the B-Entity
user I-Entity
's I-Entity
'' I-Entity
Application I-Entity
Data I-Entity
'' I-Entity
directory I-Entity
, O
and O
injects B-Action
the B-Entity
'' I-Entity
release.tmp I-Entity
'' I-Entity
file I-Entity
in B-Modifier
'' B-Entity
explorer.exe I-Entity
'' I-Entity
. O

Persistence B-Entity
is B-Action
achieved I-Action
by B-Modifier
adding B-Entity
the I-Entity
path I-Entity
to I-Entity
the I-Entity
binary I-Entity
to I-Entity
the I-Entity
Winlogon I-Entity
Shell I-Entity
key I-Entity
: O
The B-Entity
RAT I-Entity
embeds B-Action
its B-Entity
own I-Entity
DNS I-Entity
server I-Entity
IP I-Entity
addresses I-Entity
to B-Modifier
make B-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
domain I-Entity
names I-Entity
resolutions I-Entity
. O

These O
addresses O
are O
listed O
below O
: O
It B-Entity
starts O
resolving B-Action
its B-Entity
domains I-Entity
after B-Modifier
injection B-Entity
, O
and O
immediately O
sends B-Action
requests B-Entity
. O

First O
requests B-Entity
are B-Action
used I-Action
to B-Modifier
check B-Entity
for I-Entity
updates I-Entity
( I-Entity
GET I-Entity
request I-Entity
on I-Entity
/httpdocs/update/update.ini I-Entity
) I-Entity
. O

A B-Entity
Hello I-Entity
packet I-Entity
is B-Action
then I-Action
sent I-Action
: O
The B-Entity
bot I-Entity
then O
repeatedly O
sends B-Action
GET B-Entity
requests I-Entity
on B-Modifier
'' B-Entity
/httpdocs/mm/ I-Entity
< I-Entity
botid I-Entity
> I-Entity
/ComMand.sec I-Entity
'' I-Entity
to O
retrieve B-Action
remote B-Entity
commands I-Entity
. O

The O
communication O
protocol O
is O
quite O
simple O
: O
GET B-Entity
requests I-Entity
are B-Action
used I-Action
to B-Modifier
receive B-Entity
data I-Entity
from I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
, O
and O
POST B-Entity
requests I-Entity
to O
send B-Action
data B-Entity
. O

In B-Modifier
POST B-Entity
commands I-Entity
, O
the B-Entity
CGI I-Entity
name I-Entity
represents B-Action
the B-Entity
command I-Entity
. O

The O
following O
features O
are O
implemented O
: O
The B-Entity
following I-Entity
CGI I-Entity
files I-Entity
can O
be B-Action
requested I-Action
by O
the B-Entity
bot I-Entity
: O
The O
configuration O
is O
stored O
locally O
in O
a O
file O
called O
'' O
schmup.sys O
'' O
. O

The B-Entity
file I-Entity
is B-Action
ciphered I-Action
using B-Modifier
RC4 B-Entity
, O
using B-Modifier
the B-Entity
MD5 I-Entity
hash I-Entity
of I-Entity
'' I-Entity
rEdstArs I-Entity
'' I-Entity
as I-Entity
the I-Entity
key I-Entity
. O

Our B-Entity
sample I-Entity
uses B-Action
'' B-Entity
mca.avstore.com.tw I-Entity
'' I-Entity
, I-Entity
'' I-Entity
star.yamn.net I-Entity
'' I-Entity
and I-Entity
'' I-Entity
bz.kimoo.com.tw I-Entity
'' I-Entity
as B-Modifier
c B-Entity
& I-Entity
c I-Entity
servers I-Entity
. O

It O
contains O
the O
'' O
1.6.0 O
'' O
version O
number O
, O
and O
uses O
the O
password O
'' O
9ol.8ik O
, O
'' O
to O
authenticate O
with O
the O
bots O
. O

Unlike O
others O
c O
& O
c O
binaries O
, O
the B-Entity
c I-Entity
& I-Entity
c I-Entity
part I-Entity
of I-Entity
this I-Entity
RAT I-Entity
does O
not O
have O
a O
graphical O
interface O
, O
but O
can O
be B-Action
remotely I-Action
requested I-Action
to B-Modifier
manage B-Entity
the I-Entity
bots I-Entity
. O

Furthermore O
, O
no O
authentication O
is O
required O
to O
send B-Action
commands B-Entity
to B-Modifier
the B-Entity
c I-Entity
& I-Entity
c I-Entity
( O
but O
you O
need O
to O
know O
the O
configured O
password O
to O
interact O
with O
the O
bots O
) O
. O

The O
management O
protocol O
is O
the O
same O
as O
the O
bots O
protocol O
, O
with O
different O
CGI O
files O
: O
The O
bots O
' O
answers O
to O
remote O
commands O
can O
be O
retrieved O
by O
requesting O
the O
'' O
Reply.sec O
'' O
file O
( O
e.g O
. O

GET O
/httpdocs/mm/ O
< O
botid O
> O
/Reply.sec O
) O
These O
network O
patterns O
might O
ring O
bells O
in O
some O
researcher O
's O
minds O
. O

The O
network O
communication O
used O
by O
this O
binary O
are O
the O
same O
as O
those O
used O
by O
the O
Enfal O
malware O
, O
which O
has O
been O
used O
in O
the O
past O
by O
the O
Lurid O
group O
( O
APT O
attackers O
) O
and O
by O
other O
threat O
actors O
in O
China O
. O

An O
examination O
of O
the O
code O
did O
not O
reveal O
code O
similarities O
with O
the O
Enfal O
malware O
. O

We O
do O
not O
currently O
know O
why O
this B-Entity
malware I-Entity
uses B-Action
the B-Entity
same I-Entity
patterns I-Entity
to B-Modifier
communicate B-Entity
. O

This O
is O
another B-Entity
remote I-Entity
administration I-Entity
tool I-Entity
used B-Action
by O
the B-Entity
Pitty I-Entity
Tiger I-Entity
group I-Entity
. O

We O
have O
been O
able O
to O
get O
both O
a O
client O
and O
server O
part O
of O
it O
. O

The B-Entity
binary I-Entity
we I-Entity
found I-Entity
was B-Action
dropped I-Action
by O
a B-Entity
malicious I-Entity
Word I-Entity
document I-Entity
. O

The O
following O
alarms O
are O
triggered O
in O
the O
sandbox O
: O
The B-Entity
shellcode I-Entity
contained I-Entity
in I-Entity
the I-Entity
Word I-Entity
file I-Entity
drops B-Action
the B-Entity
following I-Entity
file I-Entity
, O
and O
executes B-Action
it B-Entity
: O
This B-Entity
one I-Entity
drops B-Action
in B-Modifier
turn I-Modifier
the B-Entity
following I-Entity
file I-Entity
: O
This B-Entity
tmp I-Entity
file I-Entity
is B-Action
then I-Action
copied I-Action
to B-Modifier
'' B-Entity
C I-Entity
: I-Entity
\Windows\system32\Nwsapagentex.dll I-Entity
'' I-Entity
and O
registered B-Action
as B-Modifier
a B-Entity
service I-Entity
called I-Entity
'' I-Entity
Nwsapagent I-Entity
'' I-Entity
. O

This O
malware O
is O
a O
variant O
of O
the O
infamous O
Gh0st O
RAT O
. O

Our O
specific O
sample O
uses O
'' O
ssss0 O
'' O
instead O
of O
the O
usual O
'' O
Gh0st O
'' O
header O
for O
network O
communications O
. O

The O
commands O
ID O
used O
in O
the O
communication O
protocol O
have O
also O
changed O
, O
but O
the O
features O
are O
quite O
the O
same O
. O

The O
configuration O
is O
directly O
embedded O
in O
the O
binary O
, O
and O
deciphered O
at O
runtime O
. O

Up B-Entity
to I-Entity
5 I-Entity
c I-Entity
& I-Entity
c I-Entity
servers I-Entity
can O
be B-Action
configured I-Action
, O
but O
our O
sample O
only O
had O
one O
: O
'' O
ey.avstore.com.tw:53 O
'' O
. O

'' O
EY O
'' O
could O
stand O
for O
'' O
Ernst O
& O
Young O
'' O
. O

It O
would O
not O
be O
very O
surprising O
, O
since O
a O
lot O
of O
different O
attack O
groups O
do O
use O
anti-virus O
vendors O
or O
other O
big O
company O
's O
names O
to O
try O
to O
look O
more O
legitimate O
. O

Pitty O
Tiger O
is O
no O
exception O
, O
as O
detailed O
later O
in O
this O
report O
. O

We O
also O
found O
two O
c O
& O
c O
binaries O
, O
claiming O
to O
be O
versions O
2.1 O
and O
2.2 O
of O
the O
Paladin O
RAT O
controller O
. O

Version O
2.1 O
answers O
to O
the O
'' O
ssss0 O
'' O
header O
, O
while O
version O
2.2 O
uses O
the O
classical O
'' O
Gh0st O
'' O
header O
. O

Additionally O
to O
the O
Paladin O
RAT O
, O
we O
found O
another O
variant O
of O
Gh0st O
RAT O
, O
named O
'' O
Leo O
'' O
. O

Although O
we O
have O
found O
it O
on O
a O
c O
& O
c O
server O
of O
the O
group O
, O
there O
is O
no O
evidence O
that O
is O
has O
been O
used O
by O
the O
group O
, O
in O
opposition O
to O
Paladin O
which O
is O
used O
often O
by O
Pitty O
Tiger O
. O

Moreover O
, O
the B-Entity
built I-Entity
malware I-Entity
we I-Entity
found I-Entity
in I-Entity
the I-Entity
same I-Entity
folder I-Entity
was O
configured O
to O
connect B-Action
to B-Modifier
a B-Entity
local I-Entity
IP I-Entity
address I-Entity
, O
probably O
for O
testing O
purposes O
. O

Our O
investigation O
has O
focused O
on O
three O
particular O
c O
& O
c O
servers O
used O
by O
the O
group O
. O

These O
c O
& O
c O
servers O
, O
unlike O
the O
other O
c O
& O
cs O
used O
by O
the O
group O
, O
have O
been O
misconfigured O
. O

Once O
parsed O
and O
dumped O
, O
it O
provided O
us O
with O
more O
insight O
. O

We O
found O
several O
domains O
used O
by O
the O
Pitty O
Tiger O
group O
, O
the O
most O
interesting O
ones O
being O
detailed O
in O
this O
chapter O
. O

Pitty O
Tiger O
, O
like O
other O
APT O
attackers O
, O
often O
use O
anti-virus O
'' O
familiar O
names O
'' O
when O
registering O
domains O
or O
creating O
subdomains O
. O

Some O
examples O
can O
be O
avstore.com.tw O
, O
sophos.skypetm.com.tw O
, O
symantecs.com.tw O
, O
trendmicro.org.tw O
etc O
. O

The O
registration O
information O
for O
this O
domain O
has O
been O
the O
same O
since O
2013-06-04 O
: O
This O
information O
has O
been O
used O
to O
register O
another O
domain O
, O
skypetm.com.tw O
, O
which O
has O
also O
been O
used O
by O
the O
Pitty O
Tiger O
group O
. O

Our O
research O
also O
led O
us O
to O
the O
discovery O
of O
four O
different O
malware O
families O
connected O
to O
subdomains O
of O
avstore.com.tw O
: O
This O
domain O
has O
shown O
two O
different O
WHOIS O
entries O
through O
time O
: O
The O
most O
recent O
registration O
information O
is O
also O
used O
for O
avstore.com.tw O
. O

Six B-Entity
malware I-Entity
families I-Entity
have O
been O
identified O
as O
communicating B-Action
with B-Modifier
subdomains B-Entity
of I-Entity
skypetm.com.tw I-Entity
: O
Avstore.com.tw O
and O
skypetm.com.tw O
have O
4 B-Entity
malware I-Entity
families I-Entity
in O
common O
, O
communicating B-Action
to B-Modifier
subdomains B-Entity
of I-Entity
both I-Entity
domains I-Entity
: O
Some O
domains O
registered O
by O
the O
group O
are O
very O
old O
. O

There O
is O
an O
increase O
in O
the O
registrations O
from O
2010 O
on O
. O

All O
the O
e-mail O
addresses O
used O
are O
connected O
to O
the O
Pitty O
Tiger O
group O
. O

Mapping O
the O
victims O
of O
such O
a O
targeted O
campaign O
is O
not O
an O
easy O
task O
. O

We O
have O
found O
the O
Pitty O
Tiger O
group O
to O
be O
very O
active O
against O
one O
particular O
private O
company O
from O
the O
defense O
industry O
and O
one O
academic O
network O
of O
a O
government O
, O
, O
yet O
we O
think O
it O
was O
done O
to O
be O
used O
as O
a O
proxy O
for O
some O
of O
the O
group O
's O
operations O
. O

We O
have O
also O
found O
some O
connections O
from O
other O
companies O
to O
the O
c O
& O
c O
servers O
, O
yet O
we O
did O
not O
find O
evidence O
that O
they O
were O
real O
victims O
. O

These O
alleged O
victims O
do O
work O
in O
different O
sectors O
and O
are O
located O
mostly O
in O
European O
countries O
. O

It O
might O
be O
surprising O
to O
see O
a O
company O
specialized O
in O
web O
development O
here O
, O
yet O
it O
has O
built O
websites O
for O
interesting O
potential O
targets O
. O

We O
suspect O
Pitty B-Entity
Tiger I-Entity
to O
use O
this O
compromise O
to O
spear B-Action
phish I-Action
other B-Entity
companies I-Entity
which I-Entity
are I-Entity
in I-Entity
commercial I-Entity
relation I-Entity
with I-Entity
this I-Entity
web I-Entity
development I-Entity
company I-Entity
. O

We O
have O
to O
mention O
that O
we O
only O
had O
access O
to O
three O
of O
the O
several O
attackers O
' O
servers O
. O

Therefore O
, O
we O
suppose O
the O
Pitty O
Tiger O
group O
could O
have O
more O
targets O
than O
what O
we O
could O
confirm O
. O

We O
also O
found O
a O
lot O
of O
vulnerability B-Entity
scanners I-Entity
launched B-Action
by O
the B-Entity
attackers I-Entity
at B-Modifier
different B-Entity
targets I-Entity
, O
yet O
there O
was O
no O
sign O
of O
compromise O
. O

During O
the O
course O
of O
our O
investigations O
, O
we O
discovered O
a O
RAR O
archive O
on O
the O
attacker O
's O
server O
containing O
5 O
Word O
documents O
and O
one O
small O
C O
source O
code O
. O

These O
documents O
belong O
to O
the O
defense O
company O
which O
has O
been O
compromised O
. O

According O
to O
the O
name O
of O
the O
files O
and O
the O
general O
feel O
of O
the O
archive O
, O
we O
do O
think O
it B-Entity
was B-Action
extracted I-Action
by O
the B-Entity
attackers I-Entity
to B-Modifier
'' B-Entity
show I-Entity
'' I-Entity
someone I-Entity
what I-Entity
kind I-Entity
of I-Entity
data I-Entity
they I-Entity
could I-Entity
get I-Entity
from I-Entity
the I-Entity
compromise I-Entity
of I-Entity
that I-Entity
particular I-Entity
target I-Entity
. O

The O
documents O
were O
still O
exhibiting O
comments O
from O
various O
users O
, O
showing O
it O
was O
an O
ongoing O
work O
and O
not O
old O
documents O
. O

Interestingly O
enough O
, O
we O
saw O
a O
part O
of O
these O
documents O
appear O
on O
Virus-Total O
, O
with O
an O
additional O
'' O
gift O
'' O
from O
the O
attackers O
, O
a B-Entity
payload I-Entity
dropping B-Action
a B-Entity
malware I-Entity
. O

There O
are O
only O
two O
options O
we O
can O
think O
of O
here O
: O
 O
Someone B-Entity
from I-Entity
the I-Entity
same I-Entity
company I-Entity
has O
been B-Action
targeted I-Action
with B-Modifier
this B-Entity
document I-Entity
. O

 O
Someone B-Entity
from I-Entity
another I-Entity
company I-Entity
has O
been B-Action
targeted I-Action
with B-Modifier
this B-Entity
document I-Entity
. O

This O
other O
company O
could O
be O
a O
partner O
or O
competitor O
. O

Since O
we O
were O
unable O
to O
determine O
the O
intended O
use O
of O
this O
specific O
document O
, O
we O
can O
only O
suppose O
that O
it O
could O
be O
used O
to O
provide O
commercial O
advantages O
to O
competitors O
of O
that O
company O
, O
or O
used O
by O
a O
foreign O
state O
. O

During O
our O
investigation O
, O
we O
found O
out O
interesting O
information O
about O
the O
Pitty O
Tiger O
group O
itself O
. O

After O
analyzing O
the O
various O
collected O
elements O
, O
we O
have O
tried O
to O
draw O
a O
portrait O
of O
this O
particular O
threat O
. O

We O
have O
been O
able O
to O
get O
all O
the O
RDP O
connections O
logs O
to O
one O
c O
& O
c O
server O
: O
These O
connections O
are O
either O
VPS O
or O
dynamic O
IP O
addresses O
, O
mostly O
from O
China O
. O

A B-Entity
computer I-Entity
named I-Entity
CHMXY-PC I-Entity
connected B-Action
to B-Modifier
the B-Entity
c I-Entity
& I-Entity
c I-Entity
via B-Modifier
RDP B-Entity
with B-Modifier
IP B-Entity
address I-Entity
58.61.40.5 I-Entity
. O

The O
IP O
is O
in O
an O
ADSL O
dynamic O
pool O
in O
the O
Gangzhou O
area O
( O
Guangdong O
province O
) O
: O
A B-Entity
few I-Entity
connections I-Entity
to I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
were B-Action
done I-Action
by O
a B-Entity
computer I-Entity
named I-Entity
TIEWEISHIPC I-Entity
with I-Entity
IP I-Entity
address I-Entity
27.16.139.143 I-Entity
. O

This O
IP O
address O
belongs O
to O
an O
ADSL O
dynamic O
pool O
in O
the O
Wuhan O
area O
( O
Hubei's O
provincial O
capital O
) O
. O

Some B-Entity
connections I-Entity
to I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
originated B-Action
from B-Modifier
a B-Entity
computer I-Entity
named I-Entity
FLY-THINK I-Entity
with I-Entity
several I-Entity
IP I-Entity
addresses I-Entity
, I-Entity
all I-Entity
located I-Entity
in I-Entity
Fuqing I-Entity
( I-Entity
Fujian I-Entity
province I-Entity
) I-Entity
. O

The O
IP O
addresses O
are O
in O
an O
ADSL O
dynamic O
pool O
: O
Most B-Entity
of I-Entity
the I-Entity
connections I-Entity
to I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
server I-Entity
were B-Action
coming I-Action
from B-Modifier
a B-Entity
computer I-Entity
named I-Entity
50PZ80C- I-Entity
1DFDCB8 I-Entity
with I-Entity
several I-Entity
IP I-Entity
addresses I-Entity
. O

There O
are O
11 O
IP O
addresses O
from O
Chinese O
dynamic O
ADSL O
ranges O
: O
9 O
from O
Fuqing O
( O
Fujian O
province O
) O
, O
one O
from O
Fuzhou O
( O
Fujian O
's O
province O
capital O
) O
and O
one O
from O
Nanchang O
( O
Jiangxi O
's O
province O
capital O
) O
. O

The O
last O
one O
came O
from O
a O
VPS O
instance O
located O
in O
Los O
Angeles O
( O
California O
, O
USA O
) O
but O
purchased O
by O
a O
China O
based O
VPS O
provider O
XeVPS O
which O
belong O
to O
the O
AS38197 O
( O
Sun O
Network O
Hong O
Kong O
Limited O
) O
. O

The B-Entity
two I-Entity
computers I-Entity
FLY-THINK I-Entity
and I-Entity
50PZ80C-1DFDCB8 I-Entity
have O
used B-Action
distinct B-Entity
IP I-Entity
addresses I-Entity
to B-Modifier
connect B-Entity
to I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
, O
yet O
some O
of O
these O
IP O
addresses O
come O
from O
the O
same O
IP O
range O
: O
We O
mapped O
these O
RDP O
connections O
to O
have O
a O
graphical O
view O
: O
We O
found O
that O
a O
member O
of O
this O
group O
of O
attackers O
used O
some O
tools O
on O
his O
own O
system O
, O
for O
testing O
purposes O
. O

This O
information O
was O
still O
available O
when O
we O
got O
access O
to O
the O
c O
& O
c O
server O
. O

He O
launched O
some O
tests O
with O
the O
CT O
RAT O
we O
exposed O
earlier O
: O
Here O
we O
can O
see O
a B-Entity
user I-Entity
'' I-Entity
Toot I-Entity
'' I-Entity
from O
a O
machine O
named O
'' O
toot-2a601225a8 O
'' O
logging O
in O
the O
CT O
RAT O
and O
executing B-Action
some B-Entity
commands I-Entity
. O

The O
c O
& O
c O
IP O
address O
, O
198.100.113.27 O
, O
can O
be O
seen O
there O
. O

Other O
log O
files O
showed O
that O
'' O
Toot O
'' O
is O
using O
virtual O
machines O
for O
his O
tests O
. O

We O
can O
also O
see O
the O
system O
: O
Microsoft O
Windows O
XP O
SP3 O
. O

The O
'' O
P O
'' O
field O
is O
the O
language O
ID O
. O

1028 O
means O
'' O
Chinese O
traditional O
'' O
. O

We O
have O
also O
seen O
tests O
run O
by O
'' O
toot O
'' O
with O
a O
language O
ID O
of O
2052 O
, O
which O
is O
'' O
Chinese O
simplified O
'' O
. O

The O
'' O
M O
'' O
field O
is O
probably O
used O
for O
versioning O
. O

It O
is O
a O
hardcoded O
string O
in O
the O
binary O
. O

After O
these O
tests O
, O
we O
could O
see O
some B-Entity
real I-Entity
connections I-Entity
to I-Entity
a I-Entity
victim I-Entity
using B-Action
this B-Entity
RAT I-Entity
. O

Here O
is O
a O
follow-up O
of O
the O
commands O
launched O
by O
the O
bot O
controller O
, O
in O
a O
standard O
command-line O
shell O
: O
The O
attacker O
goes O
on O
like O
this O
, O
using O
his O
tools O
, O
and O
then O
ends O
the O
communication O
with O
this O
RAT O
on O
that O
computer O
. O

Please O
note O
that O
at O
this O
point O
, O
the B-Entity
attacker I-Entity
has B-Action
at B-Modifier
least I-Modifier
the B-Entity
privileges I-Entity
of I-Entity
a I-Entity
local I-Entity
administrator I-Entity
, O
since O
he B-Entity
is O
allowed O
to O
write B-Action
content B-Entity
in B-Modifier
the B-Entity
system32 I-Entity
folder I-Entity
of I-Entity
a I-Entity
Windows I-Entity
XP I-Entity
system I-Entity
. O

He B-Entity
could O
also O
gain B-Action
the B-Entity
credentials I-Entity
to I-Entity
a I-Entity
sensitive I-Entity
e-mail I-Entity
account I-Entity
. O

In O
addition O
to O
all O
information O
already O
shown O
, O
we O
saw O
Toot O
connect O
to O
an O
account O
on O
a O
cloud O
service O
named O
'' O
Baidu O
Drive O
'' O
. O

The O
e-mail O
address O
linked O
to O
this O
account O
is O
dyanmips O
@ O
qq.com O
( O
QQ-ID O
: O
2589315828 O
) O
. O

We O
could O
find O
traces O
of O
two O
other O
e-mail O
accounts O
associated O
to O
Toot O
, O
ciscodyanmips O
@ O
qq.com O
( O
QQ O
ID O
: O
204156335 O
) O
and O
ciscodynamips O
@ O
qq.com O
( O
QQ O
ID O
: O
1878836793 O
) O
. O

We O
did O
not O
find O
more O
information O
about O
user O
'' O
Toot O
'' O
, O
yet O
we O
miss O
Chinese O
language O
capabilities O
. O

The O
controller O
part O
of O
CT O
RAT/PittyTiger O
RAT O
revealed O
the O
following O
'' O
about O
'' O
information O
, O
once O
translated O
from O
Chinese O
to O
English O
language O
: O
CT O
console O
( O
compatible O
pittytiger O
) O
v1.3 O
2013.12 O
by O
Trees O
and O
snow O
We O
believe O
this O
translation O
of O
the O
author O
's O
name O
might O
not O
be O
accurate O
due O
to O
the O
use O
of O
automated O
translation O
tools O
. O

Moreover O
, O
we O
have O
strong O
suspicions O
that O
there O
is O
not O
a O
single O
individual O
nicknamed O
'' O
Trees O
and O
snow O
'' O
but O
rather O
two O
programmers O
nicknamed O
'' O
Trees O
'' O
and O
'' O
Snow O
'' O
. O

'' O
Trees O
'' O
could O
also O
be O
'' O
Cold O
'' O
. O

We O
noticed O
that O
the O
symbol O
for O
this O
word O
is O
translated O
differently O
according O
to O
the O
context O
it O
is O
used O
in O
. O

Once O
again O
, O
we O
lack O
Chinese O
language O
skills O
. O

We O
identify O
the O
two O
nicknames O
on O
the O
current O
campaign O
as O
Automn O
Snow O
( O
秋雪 O
) O
and O
Cold O
Air O
Kiss O
( O
风吻寒 O
) O
. O

While O
we O
are O
confident O
that O
these O
people O
are O
indeed O
the O
developers O
of O
both O
PittyTiger O
and O
CT O
RAT O
malware O
, O
we O
are O
not O
sure O
they O
belong O
to O
the O
PittyTiger O
group O
. O

These O
developers O
might O
just O
have O
been O
hired O
to O
develop O
these O
RATs O
. O

They O
might O
also O
just O
be O
selling O
it O
to O
the O
PittyTiger O
group O
. O

There O
is O
no O
trace O
of O
usage O
from O
other O
attacking O
groups O
, O
we O
believe O
the O
PittyTiger O
RAT O
is O
exclusively O
used O
by O
this O
group O
of O
attackers O
. O

According O
to O
indicators O
we O
gathered O
and O
threat O
activities O
profiling O
we O
have O
some O
hypothesis O
on O
the O
way O
the O
group O
is O
conducting O
its O
operations O
. O

We O
have O
strong O
evidence O
of O
a O
bot O
operator O
position O
. O

We O
identify O
one O
nickname O
for O
this O
position O
, O
the O
user O
known O
as O
TooT O
. O

As O
we O
did O
not O
see O
other O
nickname O
, O
we O
think O
that O
TooT O
is O
one O
person O
and O
not O
a O
group O
of O
persons O
. O

We O
also O
identified O
a O
malware O
development O
position O
. O

We O
identified O
two O
nicknames O
for O
this O
position O
on O
the O
current O
campaign O
, O
Automn O
Snow O
( O
秋雪 O
) O
and O
Cold O
Air O
Kiss O
( O
风吻寒 O
) O
. O

Yet O
we O
are O
unsure O
that O
they O
belong O
to O
the O
group O
, O
they O
might O
just O
be O
a O
third O
party O
providing O
or O
selling O
their O
malware O
. O

We O
have O
a O
strong O
suspicion O
of O
a O
coordinator O
position O
, O
which O
coordinates O
the O
bot O
operator O
, O
provides O
him O
with O
some O
logistics O
support O
( O
weaponized O
document O
, O
tools… O
) O
and O
reviews O
the O
programmers O
work O
. O

This O
position O
could O
imply O
a O
communication O
channel O
with O
another O
manager O
. O

We O
named O
this O
position O
'Chen O
' O
, O
in O
relation O
with O
several O
references O
of O
this O
common O
Chinese O
name O
in O
c O
& O
c O
WHOIS O
and O
other O
investigation O
materials O
. O

We O
have O
some O
suspicion O
of O
a O
customer O
relationship O
manager O
position O
that O
may O
act O
as O
an O
interface O
between O
a O
customer O
and O
Chen O
. O

We O
named O
this O
position O
'Lilly O
' O
. O

The B-Entity
c I-Entity
& I-Entity
c I-Entity
servers I-Entity
used B-Action
by O
the B-Entity
attackers I-Entity
revealed O
a O
lot O
of O
interesting O
files O
stored O
in O
various O
folders O
: O
This O
is O
quite O
the O
usual O
arsenal O
for O
a O
group O
of O
APT O
attackers O
: O
What O
is O
rare O
to O
find O
is O
the O
controller O
part O
of O
those O
tools O
. O

We O
have O
been O
lucky O
enough O
to O
get O
the O
controller O
part O
of O
Pitty O
Tiger O
and O
CT O
RAT O
, O
and O
even O
to O
get O
a O
kind O
of O
hybrid O
controller O
made O
for O
CT O
RAT O
but O
also O
supporting O
Pitty O
Tiger O
. O

We O
suppose O
that O
the O
CT O
RAT O
is O
the O
new O
evolution O
of O
Pitty O
Tiger O
and O
that O
it O
will O
replace O
Pitty O
Tiger O
in O
the O
following O
months O
. O

The O
presence O
of O
a O
Chinese O
version O
of O
'' O
calc.exe O
'' O
, O
the O
official O
calculator O
provided O
in O
Microsoft O
Windows O
, O
is O
interesting O
. O

Not O
only O
is O
it O
one O
more O
indicator O
of O
a O
probable O
Chinese O
origin O
, O
but O
also O
an O
indicator O
that O
this B-Entity
server I-Entity
was O
probably O
used O
as O
a O
test O
base O
, O
in O
addition O
to O
being O
operational O
and O
controlling B-Action
infected B-Entity
machines I-Entity
from I-Entity
different I-Entity
targets I-Entity
. O

In O
addition O
to O
those O
tools O
, O
we O
found O
some O
interesting O
scripts O
. O

A O
script O
named O
ipc.bat O
uses O
a B-Entity
file I-Entity
named I-Entity
user.txt I-Entity
to O
try O
to O
brute-force B-Action
a B-Entity
shared I-Entity
folder I-Entity
access I-Entity
: O
The O
user.txt O
file O
contains O
thousands O
of O
lines O
, O
each O
one O
being O
a O
couple O
of O
one O
particular O
username O
and O
one O
password O
attempt O
: O
This O
user.txt O
file O
has O
been O
anonymized O
, O
yet O
we O
wanted O
to O
give O
you O
the O
feel O
for O
it O
. O

This O
file O
is O
67320 O
lines O
long O
, O
and O
uses O
5610 O
different O
passwords O
for O
each O
of O
12 O
users O
contained O
in O
this O
file O
. O

The O
user O
names O
are O
clearly O
the O
result O
from O
a O
user O
enumeration O
and O
are O
dedicated O
to O
a O
particular O
French O
victim O
. O

The O
passwords O
listed O
in O
this O
file O
are O
either O
build O
from O
several O
campaigns O
or O
from O
the O
current O
campaign O
. O

A O
lot O
of O
passwords O
are O
related O
to O
the O
targeted O
company O
and O
might O
be O
previous O
passwords O
from O
users O
. O

We O
have O
also O
discovered O
a O
pack O
of O
files O
which O
can O
be O
used O
to O
trigger O
an O
Internet O
Explorer O
vulnerability O
( O
CVE-2014-0322 O
) O
. O

The O
date O
of O
these O
files O
, O
namely O
Tope.swf O
and O
index.html O
, O
was O
2014/02/18 O
, O
a O
few O
days O
after O
the O
revelation O
of O
existing O
exploits O
in O
the O
wild O
used O
in O
APT O
attacks O
. O

We O
do O
not O
know O
if O
the O
Pitty O
Tiger O
group O
used O
this O
exploit O
or O
not O
, O
but O
found O
no O
trace O
indicating O
they O
did O
. O

A O
lot O
of O
different O
attackers O
seem O
to O
have O
used O
that O
vulnerability O
since O
. O

Determining O
who O
is O
exactly O
behind O
an O
APT O
campaign O
is O
difficult O
. O

We O
tried O
to O
extract O
different O
technical O
indicators O
, O
together O
with O
contextual O
elements O
. O

Information O
relating O
to O
the O
tools O
used O
by O
the O
attackers O
has O
been O
leveraged O
for O
attribution O
: O
The B-Entity
IP I-Entity
addresses I-Entity
used B-Action
for B-Modifier
the B-Entity
hosting I-Entity
of I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
domains I-Entity
are O
mainly O
located O
in O
Taipei O
( O
Taïwan O
) O
and O
Hong O
Kong O
City O
( O
Hong O
Kong O
Special O
Administrative O
Region O
, O
PRC O
) O
: O
Most B-Entity
RDP I-Entity
connections I-Entity
to I-Entity
the I-Entity
c I-Entity
& I-Entity
c I-Entity
infrastructure I-Entity
come B-Action
from B-Modifier
Chinese B-Entity
IP I-Entity
ranges I-Entity
in I-Entity
Fuqing I-Entity
( I-Entity
Fujian I-Entity
province I-Entity
, I-Entity
PRC I-Entity
) I-Entity
. O

Yet O
some O
IP O
addresses O
in O
the O
USA O
and O
in O
Hong O
Kong O
have O
also O
been O
found O
; O
All O
the O
items O
listed O
in O
this O
chapter O
are O
strong O
indicators O
that O
the O
attackers O
might O
be O
Chinese O
. O

Pitty O
Tiger O
is O
a O
group O
of O
attackers O
that O
have O
been O
active O
since O
at O
least O
2011 O
. O

Pitty B-Entity
Tiger I-Entity
is O
effective O
and O
mature O
in O
the O
use O
of O
targeted O
malware O
, O
the O
use O
of O
known O
exploits O
to O
infect B-Action
computers B-Entity
with B-Modifier
their B-Entity
malware I-Entity
and O
the O
creation O
of O
an O
infrastructure O
to O
efficiently O
conduct O
APT O
attacks O
. O

They O
are O
quite O
unprofessional O
in O
their O
way O
of O
using O
their O
infrastructure O
: O
they B-Entity
do O
launch B-Action
vulnerability B-Entity
scanners I-Entity
directly B-Modifier
from I-Modifier
a B-Entity
c I-Entity
& I-Entity
c I-Entity
server I-Entity
and O
also O
use O
their O
connection O
for O
personal O
activities O
( O
downloading O
pornographic O
material O
for O
example O
, O
as O
we O
have O
seen O
a O
whole O
folder O
on O
a O
c O
& O
c O
server O
full O
of O
xxx O
torrent O
links O
) O
. O

Pitty O
Tiger O
is O
probably O
not O
a O
state-sponsored O
group O
of O
attackers O
. O

The O
attackers O
lack O
the O
experience O
and O
financial O
support O
that O
one O
would O
expect O
from O
state-sponsored O
attackers O
. O

We O
suppose O
this O
group O
is O
opportunistic O
and O
sells O
its O
services O
to O
probable O
competitors O
of O
their O
targets O
in O
the O
private O
sector O
. O

One O
governmental O
network O
has O
been O
targeted O
by O
the O
group O
, O
yet O
we O
do O
not O
have O
any O
evidence O
of O
the O
purpose O
of O
this O
attack O
. O

We O
suppose O
this O
particular O
attack O
has O
been O
executed O
to O
provide O
a O
usable O
bounce O
for O
the O
group O
. O

The O
campaign O
we O
studied O
has O
been O
largely O
focused O
on O
one O
particular O
target O
. O

We O
suspect O
the O
Pitty O
Tiger O
group O
to O
work O
according O
to O
an O
opportunistic O
business O
model O
: O
this O
group O
might O
offer O
its O
services O
to O
third O
parties O
from O
the O
private O
sector O
. O

This O
group O
seems O
to O
be O
very O
small O
compared O
to O
other O
APT O
groups O
. O

We O
have O
leveraged O
several O
profiles O
and O
could O
identify O
some O
attackers O
to O
a O
certain O
extent O
. O

We O
believe O
this O
group O
might O
keep O
working O
as O
it O
is O
now O
, O
with O
limited O
budgets O
, O
or O
grow O
to O
extend O
its O
attacking O
campaign O
capabilities O
. O

This O
list O
of O
indicators O
is O
provided O
in O
order O
to O
help O
people O
detect O
Pitty O
Tiger O
APT O
campaign O
. O

Domains O
used O
by O
the O
Pitty O
Tiger O
group O
: O
( O
please O
note O
several O
subdomains O
are O
used O
, O
as O
seen O
in O
the O
report O
) O
Cyber O
Squared O
Inc. O
's O
ThreatConnect O
Intelligence O
Research O
Team O
( O
TCIRT O
) O
tracks O
a O
number O
of O
threat O
groups O
around O
the O
world O
. O

Beginning O
in O
the O
summer O
of O
2013 O
, O
TCIRT O
identified O
a O
suspected O
Pakistani-origin O
threat O
group O
. O

This O
group O
was O
revealed O
by O
TCIRT O
publicly O
in O
August O
2013 O
. O

In O
the O
months O
following O
the O
disclosure O
, O
we O
identified O
new O
activity O
. O

Cyber O
Squared O
partnered O
with O
experts O
at O
FireEye O
Labs O
to O
examine O
these O
new O
observations O
in O
an O
attempt O
to O
discover O
new O
research O
and O
insight O
into O
the O
group O
and O
its O
Operation O
'' O
Arachnophobia O
'' O
. O

The O
following O
report O
is O
a O
product O
of O
collaborative O
research O
and O
threat O
intelligence O
sharing O
between O
Cyber O
Squared O
Inc. O
's O
TCIRT O
and O
FireEye O
Labs O
. O

• O
While O
we O
are O
not O
conclusively O
attributing O
BITTERBUG O
activity O
to O
Tranchulas O
or O
a O
specific O
Pakistani O
entity O
, O
we O
can O
confidently O
point O
to O
many O
characteristics O
of O
a O
Pakistan-based O
cyber O
exploitation O
effort O
that O
is O
probably O
directed O
against O
Indian O
targets O
and/or O
those O
who O
are O
involved O
in O
India-Pakistan O
issues O
. O

• O
The B-Entity
threat I-Entity
actors I-Entity
utilized B-Action
a B-Entity
hosting I-Entity
provider I-Entity
that I-Entity
is I-Entity
a I-Entity
Pakistani-based I-Entity
company I-Entity
with I-Entity
subleased I-Entity
VPS I-Entity
space I-Entity
within I-Entity
the I-Entity
U.S. I-Entity
for B-Modifier
command B-Entity
and I-Entity
control I-Entity
( I-Entity
C2 I-Entity
) I-Entity
. O

• O
The B-Entity
customized I-Entity
malware I-Entity
( I-Entity
BITTERBUG I-Entity
) I-Entity
used I-Entity
by I-Entity
these I-Entity
threat I-Entity
actors I-Entity
has O
only O
been O
observed O
hosted B-Action
on B-Modifier
and O
communicating B-Action
with B-Modifier
two B-Entity
IP I-Entity
addresses I-Entity
operated I-Entity
by I-Entity
a I-Entity
Pakistan-based I-Entity
hosting I-Entity
provider I-Entity
. O

• O
Early O
variants O
of O
the O
BITTERBUG O
malware O
had O
build O
paths O
containing O
the O
strings O
'' O
Tranchulas O
'' O
and O
'' O
umairaziz27 O
'' O
. O

Tranchulas O
is O
the O
name O
of O
a O
Pakistani O
security O
firm O
; O
Umair O
Aziz O
is O
the O
name O
of O
a O
Tranchulas O
employee O
. O

• O
Following O
the O
release O
of O
our O
blog O
post O
highlighting O
this O
activity O
and O
the O
malware O
's O
build O
strings O
, O
the O
threat O
actors O
appear O
to O
have O
modified O
their O
binary O
file O
paths O
to O
make O
them O
more O
generic O
. O

• O
Employees O
at O
both O
the O
Pakistan-based O
hosting O
provider O
and O
Tranchulas O
appear O
within O
each O
others O
' O
social O
networks O
. O

On O
August O
2 O
, O
2013 O
, O
the O
TCIRT O
published O
the O
blog O
'' O
Where O
There O
is O
Smoke O
, O
There O
is O
Fire O
: O
South O
Asian O
Cyber O
Espionage O
Heats O
Up O
'' O
in O
which O
TCIRT O
identified O
custom O
malware O
, O
later O
dubbed O
BITTERBUG O
by O
FireEye O
, O
suspected O
to O
be O
linked O
to O
Pakistani-based O
exploitation O
activity O
directed O
against O
Indian O
entities O
. O

We O
found O
debug O
path O
references O
to O
'' O
Tranchulas O
'' O
, O
which O
is O
also O
the O
name O
of O
a O
Pakistani O
security O
company O
. O

Tranchulas O
claims O
to O
support O
'' O
national O
level O
cyber O
security O
programs O
'' O
and O
the O
development O
of O
offensive O
and O
defensive O
cyber O
capabilities O
. O

At O
the O
time O
, O
the O
incident O
seemed O
to O
be O
an O
isolated O
one O
for O
TCIRT O
, O
but O
it O
was O
only O
the O
beginning O
. O

Our O
suspicions O
of O
Tranchulas O
' O
involvement O
in O
the O
activity O
began O
to O
mount O
, O
based O
on O
a O
series O
of O
events O
that O
occurred O
both O
before O
and O
after O
the O
release O
of O
our O
blog O
post O
. O

During O
the O
past O
year O
, O
we O
communicated O
with O
Tranchulas O
and O
the O
Pakistan-based O
hosting O
provider O
. O

Suspicious O
responses O
and O
oddly O
similar O
replies O
received O
from O
both O
companies O
to O
our O
inquiries O
, O
as O
well O
as O
anomalies O
in O
their O
email O
headers O
, O
prompted O
us O
to O
research O
the O
companies O
further O
. O

Our O
research O
revealed O
: O
• O
The O
C2 O
hosting O
provider O
( O
VPSNOC O
) O
has O
likely O
been O
conducting O
business O
operations O
from O
within O
Pakistan O
, O
subleasing O
infrastructure O
from O
U.S. O
providers O
. O

• O
VPNSOC O
and O
Tranchulas O
employees O
have O
maintained O
some O
type O
of O
undefined O
relationship O
given O
connections O
via O
social O
media O
. O

• O
Both O
organizations O
have O
employed O
or O
are O
affiliated O
with O
personnel O
who O
have O
offensive O
cyber O
expertise O
. O

• O
When O
TCIRT O
was O
initially O
contacted O
by O
Tranchulas O
following O
our O
original O
blog O
post O
, O
they O
denied O
any O
involvement O
in O
the O
activity O
. O

Tranchulas O
maintained O
that O
they O
were O
being O
framed O
, O
and O
that O
they O
were O
already O
aware O
of O
the O
activity O
prior O
to O
both O
our O
blog O
post O
and O
our O
contact O
. O

However O
, O
inconsistencies O
in O
their O
claims O
and O
their O
responses O
made O
such O
a O
scenario O
questionable O
. O

TCIRT O
began O
tracking O
a O
set O
of O
activity O
involving O
a O
BITTERBUG O
variant O
in O
May O
2013 O
. O

To O
our O
knowledge O
this B-Entity
customized I-Entity
malware I-Entity
has O
only O
ever O
been O
observed O
hosted B-Action
on B-Modifier
and O
communicating B-Action
with B-Modifier
two B-Entity
command I-Entity
and I-Entity
control I-Entity
nodes I-Entity
: I-Entity
199.91.173.43 I-Entity
and I-Entity
199.91.173.45 I-Entity
. O

According O
to O
Whois O
records O
, O
those O
IP O
addresses O
were O
registered O
to O
a O
web-hosting O
firm O
in O
Kansas O
City O
, O
Missouri O
. O

Based O
on O
public O
records O
, O
this O
organization O
appears O
to O
be O
a O
legal O
entity O
chartered O
to O
conduct O
business O
in O
Missouri O
. O

On O
July O
24 O
, O
2013 O
, O
TCIRT O
contacted O
the O
Kansas O
City-based O
hosting O
provider O
to O
notify O
them O
of O
the O
malicious O
activities O
emanating O
from O
IP O
address O
199.91.173.43 O
. O

The O
hosting O
provider O
subsequently O
introduced O
TCIRT O
to O
their O
client O
VPNSOC O
, O
the O
customer O
responsible O
for O
subleasing O
the O
IP O
address O
. O

Later O
that O
day O
, O
TCIRT O
received O
a O
response O
from O
support O
@ O
vpsnoc.com O
providing O
limited O
information O
on O
the O
server O
and O
related O
traffic O
( O
Figure O
2 O
) O
. O

When O
TCIRT O
sent O
follow-up O
communications O
, O
VPSNOC O
did O
not O
respond O
, O
further O
increasing O
our O
suspicions O
. O

While O
reviewing O
the O
metadata O
of O
VPSNOC O
's O
July O
24 O
, O
2013 O
email O
response O
, O
we O
noticed O
the O
email O
was O
sent O
from O
a O
+0500 O
time O
zone O
. O

This O
time O
zone O
usage O
is O
consistent O
with O
Pakistan O
's O
time O
zone O
. O

The O
TCIRT O
published O
details O
of O
the O
initial O
activity O
in O
the O
aforementioned O
blog O
post O
on O
August O
2 O
, O
2013 O
. O

Four O
days O
later O
on O
August O
, O
2013 O
, O
the O
Tranchulas O
Chief O
Executive O
Officer O
, O
Zubair O
Khan O
, O
contacted O
us O
regarding O
the O
blog O
post O
and O
its O
subsequent O
press O
coverage O
. O

Khan O
submitted O
'' O
ResponseThreatConnect.docx O
'' O
as O
an O
explanation O
of O
the O
observed O
activity O
to O
both O
the O
media O
and O
the O
TCIRT O
indicating O
that O
the O
debug O
paths O
using O
'' O
Tranchulas O
'' O
and O
'' O
umairaziz27 O
'' O
was O
'' O
done O
by O
developer O
of O
malware O
to O
portray O
wrong O
impression O
about O
Tranchulas O
and O
mislead O
malware O
analysts O
'' O
. O

Notably O
, O
Khan O
included O
a O
screenshot O
of O
an O
email O
message O
. O

The O
message O
was O
reportedly O
a O
response O
from O
VPSNOC O
to O
an O
email O
message O
from O
Tranchulas O
sent O
on O
July O
21 O
, O
2013 O
, O
purportedly O
to O
notify O
VPSNOC O
of O
the O
same O
malicious O
activity O
identified O
by O
TCIRT O
. O

However O
, O
we O
noted O
certain O
anomalies O
in O
this O
message O
. O

As O
seen O
in O
Figure O
3 O
the O
'' O
email O
message O
'' O
was O
'' O
sent O
'' O
to O
VPSNOC O
from O
an O
unidentified O
tranchulas.com O
email O
address O
on O
'' O
Tue O
, O
Jul O
21 O
, O
2013 O
at O
11:36 O
PM O
. O

'' O
July O
21 O
, O
2013 O
was O
not O
a O
Tuesday O
and O
in O
fact O
was O
a O
Sunday O
. O

The O
mismatched O
date O
suggests O
that O
this O
email O
message O
was O
potentially O
modified O
in O
order O
to O
support O
the O
claim O
that O
Tranchulas O
was O
aware O
of O
, O
and O
had O
already O
reported O
the O
exploitation O
activity O
. O

TCIRT O
speculates O
that O
'' O
Tuesday O
'' O
was O
hastily O
chosen O
because O
our O
own O
official O
notification O
to O
VPSNOC O
was O
sent O
on O
Wednesday O
the O
24th O
. O

In O
addition O
, O
the O
'' O
response O
'' O
received O
by O
Tranchulas O
is O
nearly O
identical O
to O
that O
received O
by O
TCIRT O
. O

We O
believe O
that O
Tranchulas O
may O
have O
obtained O
information O
about O
TCIRT O
's O
notification O
to O
VPSNOC O
through O
a O
pre-established O
relationship O
. O

The O
TCIRT O
responded O
to O
Mr. O
Khan O
's O
official O
explanation O
with O
a O
follow-up O
inquiry O
, O
offering O
Khan O
an O
opportunity O
to O
explain O
the O
notable O
date O
inconsistency O
within O
the O
email O
screenshot O
. O

The O
TCIRT O
also O
requested O
that O
Mr. O
Khan O
share O
the O
actual O
email O
message O
with O
the O
original O
attached O
headers O
. O

Mr. O
Khan O
did O
not O
address O
the O
TCIRT O
question O
, O
but O
rather O
deferred O
our O
request O
to O
Mr. O
Hamza O
Qamar O
, O
a O
Penetration O
Testing O
Team O
Lead O
at O
Tranchulas O
. O

On O
August O
15 O
, O
2013 O
, O
three O
days O
later O
, O
Qamar O
responded O
to O
TCIRT O
with O
a O
brief O
denial O
of O
any O
modifications O
to O
the O
screenshot O
( O
other O
than O
email O
address O
anonymization O
) O
and O
specifically O
referred O
TCIRT O
back O
to O
VPSNOC O
support O
( O
support O
@ O
vpsnoc.com O
) O
for O
any O
follow O
up O
questions O
. O

Astonished O
by O
this O
dismissal O
and O
deflection O
, O
TCIRT O
immediately O
began O
to O
explore O
the O
relationship O
between O
VPSNOC O
and O
Tranchulas O
. O

During O
our O
research O
into O
VPSNOC O
, O
we O
identified O
that O
it O
is O
actually O
based O
in O
, O
or O
conducts O
partial O
operations O
from O
within O
, O
Pakistan O
. O

The O
company O
only O
gives O
the O
impression O
of O
operating O
from O
Kansas O
City O
through O
marketing O
and O
the O
use O
of O
leased O
IP O
space O
( O
Figure O
4 O
) O
. O

The O
Whois O
records O
for O
vpsnoc.com O
revealed O
that O
the O
domain O
was O
registered O
by O
Digital O
Linx O
Hosting O
. O

Digital O
Linx O
is O
also O
a O
Pakistan-based O
hosting O
company O
( O
Figure O
5 O
) O
. O

As O
seen O
in O
Figure O
6 O
, O
the O
administrative O
email O
address O
is O
admin O
@ O
digitallinx.org O
. O

This O
is O
the O
same O
registrant O
record O
for O
the O
digitallinx.net O
domain O
. O

The O
domains O
digitillinx.org O
, O
digitallinx.net O
, O
and O
digitallinx.com O
share O
current O
and O
historical O
similarities O
in O
their O
WHOIS O
records O
and O
sitemap.xml O
files O
that O
imply O
they O
are O
all O
controlled O
by O
the O
same O
individual O
or O
entity O
. O

The O
domain O
digitallinx.com O
is O
registered O
to O
Muhammad O
Naseer O
Bhatti O
( O
Digital O
Linx O
Founder O
) O
who O
uses O
email O
addresses O
naseer O
@ O
digitallinx.com O
and O
nbhatti O
@ O
gmail.com O
. O

The O
domain O
is O
also O
registered O
to O
the O
address O
638-F O
Johar O
Town O
, O
Lahore O
Pakistan O
. O

The O
contact O
telephone O
number O
listed O
on O
Digital O
Linx O
' O
web O
site O
is O
925-665-1427 O
( O
Figure O
6 O
) O
, O
and O
is O
also O
used O
in O
the O
WHOIS O
record O
for O
defiantmarketing.com O
. O

The O
domain O
defiantmarketing.com O
is O
registered O
to O
Abunasar O
Khan O
. O

The O
registration O
lists O
VPSNOC O
as O
the O
registrant O
organization O
, O
abunasar O
@ O
yahoo.com O
as O
the O
registration O
email O
address O
, O
and O
House O
12 O
, O
Street O
21 O
, O
F-8/1 O
Islamabad O
Federal O
44000 O
as O
the O
registration O
address O
. O

Abunasar O
Khan O
has O
been O
observed O
using O
the O
aliases O
'' O
agnosticon O
'' O
and O
'' O
agnostic O
'' O
. O

From O
this O
we O
were O
able O
to O
locate O
an O
advertisement O
in O
the O
Blackhatworld O
forum O
from O
April O
2012 O
posted O
by O
agnosticon O
promoting O
VPSNOC O
and O
identifying O
it O
as O
a O
subdivision O
of O
Digital O
Linx O
Hosting O
( O
Figure O
7 O
) O
. O

Though O
none O
of O
this O
information O
is O
surprising O
, O
it O
further O
suggests O
that O
both O
Bhatti O
and O
Abunasar O
Khan O
work O
or O
worked O
for O
Digital O
Linx O
and O
VPSNOC O
and O
during O
that O
time O
were O
both O
located O
in O
Pakistan O
. O

Additional O
research O
into O
Abunasar O
Khan O
identified O
several O
registered O
domains O
and O
fragments O
of O
his O
online O
presence O
. O

Based O
on O
his O
websites O
and O
account O
information O
, O
he O
appears O
to O
have O
an O
interest O
or O
participated O
in O
the O
Antisec O
and O
Anonymous O
movements O
( O
Figure O
8 O
) O
. O

He O
also O
used O
'' O
anony O
mo O
us O
'' O
in O
the O
registration O
name O
field O
of O
a O
personal O
account O
. O

In O
addition O
, O
Abunasar O
Khan O
's O
Google+ O
profile O
revealed O
connections O
to O
at O
least O
one O
Tranchulas O
employee O
, O
Hamza O
Qamar O
and O
a O
Digital O
Linx O
employee O
, O
Shoaib O
Riaz O
. O

Hamza O
Qamar O
, O
the O
Team O
Lead O
for O
Penetration O
Testing O
at O
Tranchulas O
, O
with O
whom O
TCIRT O
last O
spoke O
. O

Visiting O
Hamza O
Qamar O
's O
Google+ O
page O
( O
Figure O
9 O
) O
, O
the O
only O
directly O
connected O
person O
was O
Abunasar O
Khan O
. O

At O
this O
point O
, O
it O
shows O
that O
a O
probable O
VPNSOC O
employee O
with O
ties O
or O
interests O
in O
hacking O
has O
an O
undefined O
but O
potentially O
close O
relationship O
with O
Hamza O
Qamar O
, O
the O
Penetration O
Testing O
employee O
from O
Tranchulas O
. O

Qamar O
indicated O
on O
his O
public O
LinkedIn O
profile O
that O
he O
'' O
engaged O
in O
system O
and O
enterprise O
level O
network O
and O
Web O
application O
security O
testing O
for O
clients O
ranging O
from O
large O
federal O
agencies O
, O
DoD O
, O
and O
commercial O
clients O
'' O
, O
though O
it O
is O
unclear O
which O
'' O
DoD O
'' O
is O
referenced O
( O
e.g. O
, O
whether O
the O
Pakistani O
Ministry O
of O
Defense O
or O
some O
other O
nation O
's O
defense O
department O
) O
. O

Tranchulas O
identifies O
government O
( O
presumably O
Pakistan O
's O
government O
) O
as O
an O
operational O
sector O
for O
its O
work O
. O

Tranchulas O
' O
offensive O
cyber O
initiative O
services O
are O
offered O
to O
'' O
national-level O
cyber O
security O
programs O
'' O
indicating O
commercial O
demand O
from O
'' O
national-level O
'' O
customers O
. O

Though O
Tranchulas O
brands O
itself O
as O
a O
multi-national O
company O
, O
with O
respective O
addresses O
within O
the O
United O
Kingdom O
, O
the O
United O
States O
, O
and O
New O
Zealand O
. O

We O
found O
evidence O
that O
these O
addresses O
are O
all O
associated O
with O
either O
virtual O
office O
spaces O
or O
address O
forwarding O
services O
. O

For O
further O
background O
information O
on O
these O
personas O
, O
please O
see O
Appendix O
F O
: O
Personas O
. O

The O
following O
is O
a O
summary O
of O
the O
relationships O
between O
the O
hosting O
organizations O
and O
Tranchulas O
: O
• O
VPNSOC B-Entity
IP I-Entity
space I-Entity
was B-Action
used I-Action
as B-Modifier
command B-Entity
and I-Entity
control I-Entity
nodes I-Entity
for B-Modifier
attackers B-Entity
using I-Entity
variants I-Entity
of I-Entity
the I-Entity
BITTERBUG I-Entity
malware I-Entity
that I-Entity
contained I-Entity
build I-Entity
strings I-Entity
that I-Entity
referenced I-Entity
'' I-Entity
Tranchulas I-Entity
'' I-Entity
and I-Entity
a I-Entity
Tranchulas I-Entity
employee I-Entity
. O

• O
Tranchulas O
and O
VPNSOC O
were O
in O
direct O
communication O
at O
some O
point O
in O
July-August O
2013 O
. O

• O
VPNSOC O
is O
a O
subsidiary O
of O
Digital O
Linx O
. O

• O
Tranchulas O
, O
VPNSOC O
, O
Digital O
Linx O
were O
all O
physically O
located O
in O
Pakistan O
but O
maintained O
virtual O
presence O
within O
the O
U.S. O
• O
Hamza O
Qamar O
was O
an O
employee O
of O
Tranchulas O
. O

• O
Muhammad O
Naseer O
Bhatti O
was O
the O
self-proclaimed O
founder O
of O
Digital O
Linx O
. O

• O
Abunasar O
Khan O
was O
affiliated O
with O
AntiSec O
and O
VPNSOC O
. O

• O
Digital O
Linx O
founder O
Muhammad O
Naseer O
Bhatti O
had O
at O
least O
a O
working O
relationship O
with O
VPNSOC O
employee O
Abunasar O
Khan O
– O
connected O
through O
domain O
registrations O
and O
a O
common O
Google+ O
profile O
for O
Shoaib O
Riaz O
( O
another O
Digital O
Linx O
employee O
) O
. O

• O
VPNSOC O
employee O
Abunasar O
Khan O
had O
a O
direct O
connection O
to O
Tranchulas O
employee O
Hamza O
Qamar O
through O
Google+ O
. O

Note O
: O
A O
walkthrough O
of O
our O
research O
is O
available O
in O
Appendices O
C O
, O
D O
and O
E. O
Metadata O
Analysis O
: O
As O
mentioned O
earlier O
, O
during O
the O
email O
exchanged O
with O
Zubair O
Khan O
, O
he O
sent O
TCIRT O
a O
Microsoft O
Word O
document O
( O
.docx O

) O
. O

In O
reviewing O
the O
document O
metadata O
for O
'' O
ResponseThreatConnect.docx O
'' O
, O
TCIRT O
identified O
that O
it O
contained O
the O
creator O
properties O
of O
'' O
hp O
. O

'' O
TCIRT O
compared O
the O
metadata O
of O
two O
benign O
BITTERBUG-associated O
decoy O
documents O
from O
July O
2013 O
and O
found O
that O
both O
also O
had O
the O
author O
of O
'' O
hp O
'' O
( O
Figure O
10 O
) O
. O

While O
the O
author O
field O
of O
'' O
hp O
'' O
does O
n't O
conclusively O
prove O
a O
relationship O
, O
it O
contributes O
to O
the O
body O
of O
circumstantial O
evidence O
which O
links O
properties O
of O
the O
official O
Tranchulas O
response O
to O
the O
properties O
of O
decoy B-Entity
documents I-Entity
that O
were B-Action
used I-Action
in B-Modifier
conjunction I-Modifier
with I-Modifier
BITTERBUG B-Entity
targeting I-Entity
campaigns I-Entity
. O

CyberSquared O
Inc. O
partnered O
with O
FireEye O
for O
a O
second O
technical O
review O
of O
the O
malware O
associated O
with O
this O
activity O
. O

FireEye B-Entity
analyzed O
the O
malware O
, O
which O
they O
call O
BITTERBUG O
, O
and O
determined B-Action
it B-Entity
to B-Modifier
be B-Entity
a I-Entity
custom I-Entity
backdoor I-Entity
. O

The B-Entity
backdoor I-Entity
relies B-Action
on B-Modifier
various B-Entity
support I-Entity
components I-Entity
, I-Entity
including I-Entity
the I-Entity
non-malicious I-Entity
, I-Entity
publically I-Entity
available I-Entity
Libcurl I-Entity
for B-Modifier
installation B-Entity
, I-Entity
launch I-Entity
, I-Entity
and I-Entity
communications I-Entity
. O

In O
some O
variants O
, O
BITTERBUG B-Entity
has O
the O
ability O
to O
automatically O
target B-Action
and I-Action
exfiltrate I-Action
files B-Entity
with I-Entity
extensions I-Entity
such I-Entity
as I-Entity
.doc I-Entity
, I-Entity
.xls I-Entity
, I-Entity
.pdf I-Entity
, I-Entity
.ppt I-Entity
, I-Entity
.egm I-Entity
, I-Entity
and I-Entity
.xml I-Entity

. O

The O
full O
malware O
report O
is O
included O
in O
Appendix O
A O
: O
Malware O
Details O
. O

The O
earliest O
evidence O
of O
the O
malware O
family O
dates O
to O
April O
2013 O
, O
based O
on O
the O
Portable O
Executable O
( O
PE O
) O
compile O
times O
, O
with O
more O
than O
10 O
BITTERBUG O
variants O
observed O
to O
date O
. O

The O
earliest O
samples O
of O
BITTERBUG O
contain O
the O
'' O
Tranchulas O
'' O
debug O
path O
( O
below O
) O
, O
as O
mentioned O
in O
the O
August O
2013 O
TCIRT O
blog O
post O
. O

These O
BITTERBUG O
variants O
were O
probably O
used O
in O
attacks O
around O
summer O
2013 O
, O
using O
possible O
lures O
related O
to O
the O
then-recent O
death O
of O
'' O
Sarabjit O
Singh O
'' O
( O
an O
Indian O
national O
imprisoned O
in O
Pakistan O
) O
and O
an O
Indian O
Government O
pension O
memorandum O
. O

As O
stated O
in O
the O
original O
blog O
( O
and O
raised O
in O
the O
formal O
Tranchulas O
response O
) O
, O
several O
binaries O
contain O
references O
to O
'' O
Cath O
'' O
in O
the O
debug O
path O
. O

It O
is O
important O
to O
note O
that O
the O
'' O
Cath O
'' O
files O
are O
support O
components O
and O
not O
BITTERBUG O
variants O
, O
so O
it O
is O
probable O
that O
these O
were O
developed O
by O
another O
party O
but O
are O
a O
required O
component O
of O
the O
family O
. O

Additional O
BITTERBUG O
variants O
were O
compiled O
in O
June O
and O
July O
2013 O
that O
contained O
different O
identifiers O
in O
the O
debug O
paths O
: O
'' O
Cert-India O
'' O
( O
3 O
samples O
) O
and O
'' O
umairaziz27 O
'' O
( O
1 O
sample O
) O
. O

The O
presence O
of O
'' O
umairaziz27 O
'' O
in O
a O
debug O
path O
from O
one O
sample O
makes O
us O
wonder O
if O
this O
represents O
an O
operational O
security O
mistake O
. O

The O
debug O
path O
of O
'' O
umairaziz27 O
'' O
led O
us O
to O
Twitter O
and O
LinkedIn O
accounts O
( O
on O
which O
a O
matching O
alias O
is O
used O
) O
that O
belong O
to O
a O
Tranchulas O
employee O
named O
Umair O
Aziz O
, O
who O
identified O
himself O
as O
an O
Information O
Security O
Analyst O
and O
graduate O
of O
National O
University O
of O
Sciences O
and O
Technology O
( O
NUST O
) O
. O

One B-Entity
of I-Entity
these I-Entity
samples I-Entity
was O
probably O
used O
in O
attacks O
in O
late O
summer O
2013 O
, O
using B-Action
a B-Entity
'' I-Entity
leaked I-Entity
report I-Entity
'' I-Entity
lure I-Entity
which I-Entity
contained I-Entity
a I-Entity
decoy I-Entity
document I-Entity
related I-Entity
to I-Entity
Pakistan I-Entity
's I-Entity
alleged I-Entity
inability I-Entity
to I-Entity
locate I-Entity
Osama I-Entity
Bin I-Entity
Laden I-Entity
. O

After O
publication O
of O
the O
TCIRT O
blog O
and O
our O
communications O
with O
Tranchulas O
occurred O
in O
August O
2013 O
, O
no O
new O
samples O
of O
BITTERBUG O
or O
its O
support O
components O
( O
based O
on O
compile O
times O
) O
were O
identified O
until O
September O
( O
various O
support O
components O
) O
and O
October O
( O
a O
new O
BITTERBUG O
variant O
) O
. O

Interestingly O
, O
the O
samples O
compiled O
following O
the O
blog O
publication O
used O
entirely O
new O
and O
generic O
debug O
paths O
( O
Figure O
11 O
) O
as O
well O
as O
a B-Entity
compilation I-Entity
tactic I-Entity
to O
conceal B-Action
the B-Entity
C2 I-Entity
address I-Entity
from I-Entity
static I-Entity
analysis I-Entity
. O

Between O
September O
and O
December O
, O
we O
observed O
more O
variations O
of O
BITTERBUG O
and O
its O
support O
components O
in O
terms O
of O
packaging O
, O
host-based O
activities O
, O
and O
decoys O
( O
or O
the O
lack O
of O
them O
) O
compared O
to O
the O
samples O
before O
our O
blog O
post O
. O

This O
could O
indicate O
that O
the O
threat O
actors O
were O
aware O
of O
the O
blog O
post O
and O
modified O
their O
malware O
and O
related O
components O
to O
distance O
them O
from O
prior O
indicators O
. O

Between O
December O
2013 O
and O
late O
March O
2014 O
, O
we O
observed O
several B-Entity
new I-Entity
lures I-Entity
used B-Action
in B-Modifier
BITTERBUG B-Entity
self-extracting I-Entity
RAR I-Entity
( I-Entity
SFXRAR I-Entity
) I-Entity
files I-Entity
. O

One B-Entity
from I-Entity
December I-Entity
contained O
several O
BITTERBUG O
variants O
and O
used B-Action
a B-Entity
decoy I-Entity
PDF I-Entity
document I-Entity
( I-Entity
Figure I-Entity
12 I-Entity
) I-Entity
related I-Entity
to I-Entity
the I-Entity
December I-Entity
arrest I-Entity
of I-Entity
Devyani I-Entity
Khobragade I-Entity
, I-Entity
an I-Entity
Indian I-Entity
diplomat I-Entity
in I-Entity
the I-Entity
United I-Entity
States I-Entity
. O

In O
spring O
2014 O
, O
we B-Entity
observed B-Action
a B-Entity
SFXRAR I-Entity
file I-Entity
with I-Entity
a I-Entity
filename I-Entity
lure I-Entity
related I-Entity
to I-Entity
the I-Entity
March I-Entity
2014 I-Entity
disappearance I-Entity
of I-Entity
Malaysis I-Entity
Airlines I-Entity
Flight I-Entity
370 I-Entity
( I-Entity
cast I-Entity
as I-Entity
a I-Entity
Pakistan-related I-Entity
hijacking I-Entity
) I-Entity
. O

This O
SFXRAR O
contained O
the O
latest O
BITTERBUG O
variant O
, O
which O
had O
new O
dependencies O
on O
support O
components O
. O

Interestingly O
, O
this B-Entity
SFXRAR I-Entity
's I-Entity
filename I-Entity
was B-Action
the B-Entity
only I-Entity
lure I-Entity
element I-Entity
related I-Entity
to I-Entity
the I-Entity
MH370 I-Entity
event I-Entity
; O
it O
did O
not O
contain O
a O
decoy O
document O
. O

We O
provide O
a O
more O
detailed O
report O
on O
this O
SFX O
and O
the O
related O
variant O
in O
Appendix O
A O
: O
Malware O
Details O
. O

BITTERBUG B-Entity
continued O
to O
rely B-Action
on B-Modifier
the B-Entity
same I-Entity
network I-Entity
behaviors I-Entity
to B-Modifier
communicate B-Entity
with I-Entity
its I-Entity
C2s I-Entity
. O

Connections B-Entity
to I-Entity
its I-Entity
C2 I-Entity
nodes I-Entity
relied B-Action
on B-Modifier
PHP B-Entity
and O
used B-Action
communications B-Entity
that I-Entity
included I-Entity
'' I-Entity
.php I-Entity
? I-Entity
compname= I-Entity
'' I-Entity
and I-Entity
'' I-Entity
.php I-Entity
? I-Entity
srs= I-Entity
'' I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
direct I-Entity
file/component I-Entity
retrieval I-Entity
from I-Entity
the I-Entity
C2s I-Entity
. O

Though O
many B-Entity
of I-Entity
the I-Entity
samples I-Entity
that I-Entity
we I-Entity
have I-Entity
observed I-Entity
use B-Action
direct B-Entity
IPs I-Entity
for B-Modifier
HTTP B-Entity
communications I-Entity
, O
we B-Entity
have O
observed B-Action
more B-Entity
limited I-Entity
use I-Entity
of I-Entity
a I-Entity
No-IP I-Entity
domain I-Entity
. O

Operation O
Arachnophobia O
consists O
of O
an O
apparent O
targeted O
exploitation O
campaign O
, O
dating O
back O
to O
early O
2013 O
, O
using O
the O
BITTERBUG O
malware O
family O
and O
seemingly O
directed O
against O
entities O
involved O
in O
India-Pakistan O
issues O
. O

The B-Entity
threat I-Entity
actor I-Entity
appears O
to O
have O
exclusively O
used B-Action
VPSNOC B-Entity
, I-Entity
a I-Entity
probable I-Entity
Pakistan-based I-Entity
VPS I-Entity
service I-Entity
provider I-Entity
who I-Entity
leased I-Entity
U.S. I-Entity
hosting I-Entity
services I-Entity
, O
for B-Modifier
both B-Entity
the I-Entity
delivery I-Entity
and I-Entity
C2 I-Entity
phases I-Entity
of I-Entity
attack I-Entity
. O

Research O
later O
identified O
that O
a O
Pakistan-based O
VPSNOC O
representative O
had O
a O
social O
network O
affiliation O
with O
a O
Tranchulas O
employee O
as O
well O
as O
apparent O
affiliations O
with O
the O
Anonymous O
and O
AntiSec O
movements O
. O

After O
the O
August O
6 O
, O
2013 O
blog O
, O
Tranchulas O
provided O
TCIRT O
and O
the O
media O
an O
official O
statement O
and O
explanation O
of O
BITTERBUG O
activity O
, O
however O
, O
this O
explanation O
contained O
discrepancies O
. O

The O
TCIRT O
addressed O
some O
of O
these O
discrepancies O
with O
Tranchulas O
personnel O
, O
who O
were O
unresponsive O
, O
increasing O
our O
suspicion O
of O
the O
activity O
. O

We O
later O
observed O
BITTERBUG O
activity O
following O
August O
2013 O
with O
subtle O
changes O
that O
further O
generalized O
debug O
paths O
. O

It O
was O
this O
chain O
of O
events O
that O
served O
as O
a O
catalyst O
for O
extra O
scrutiny O
of O
the O
activity O
and O
collaboration O
between O
the O
ThreatConnect O
and O
FireEye O
Labs O
teams O
to O
share O
information O
. O

While O
we O
are O
not O
conclusively O
attributing O
BITTERBUG O
activity O
to O
Tranchulas O
or O
a O
specific O
Pakistani O
entity O
, O
we O
can O
confidently O
point O
to O
many O
characteristics O
of O
a O
Pakistan-based O
cyber O
exploitation O
effort O
that O
is O
probably O
directed O
against O
Indian O
targets O
or O
those O
who O
are O
involved O
in O
India-Pakistan O
issues O
. O

Many O
of O
the O
notable O
characteristics O
of O
the O
BITTERBUG O
activity O
suggest O
that O
this O
is O
indeed O
part O
of O
a B-Entity
Pakistan-based I-Entity
cyber I-Entity
exploitation I-Entity
effort I-Entity
that O
has O
apparently O
attempted O
to O
obfuscate B-Action
its B-Entity
malware I-Entity
characteristics I-Entity
and O
origins O
( O
behind O
U.S. O
infrastructure O
) O
, O
before O
and O
after O
public O
disclosure O
in O
August O
2013 O
. O

On O
the O
surface O
, O
BITTERBUG O
serves O
as O
an O
example O
of O
how O
threat O
actors O
mask O
their O
operations O
across O
social O
, O
cultural O
and O
geographic O
boundaries O
. O

More O
importantly O
, O
it O
demonstrates O
the O
value O
of O
threat O
intelligence O
sharing O
and O
industry O
collaboration O
. O

As O
one O
organization O
begins O
to O
pull O
at O
a O
thread O
of O
evidence O
and O
share O
their O
findings O
with O
another O
, O
a O
larger O
understanding O
and O
shared O
perspective O
is O
revealed O
. O

It O
is O
through O
this O
process O
that O
a O
shared O
awareness O
emerges O
into O
a O
larger O
, O
more O
comprehensive O
story O
that O
explains O
what O
we O
are O
seeing O
and O
why O
- O
ultimately O
it O
is O
this O
story O
that O
better O
serves O
us O
all O
. O

BITTERBUG B-Entity
is B-Action
a B-Entity
backdoor I-Entity
executable I-Entity
capable O
of O
uploading B-Action
and O
downloading B-Action
files B-Entity
, O
listing B-Action
running B-Entity
processes I-Entity
, O
generating B-Action
file B-Entity
listings I-Entity
, O
and O
automatically O
transferring B-Action
selected B-Entity
files I-Entity
to B-Modifier
its B-Entity
command I-Entity
and I-Entity
control I-Entity
( I-Entity
C2 I-Entity
) I-Entity
server I-Entity
. O

BITTERBUG B-Entity
appears B-Action
to B-Modifier
be B-Entity
virtual I-Entity
machine I-Entity
aware I-Entity
and O
may O
not B-Action
execute I-Action
on B-Modifier
a B-Entity
VMWare I-Entity
or I-Entity
VirtualBox I-Entity
VM I-Entity
. O

We O
have O
observed O
BITTERBUG B-Entity
installed B-Action
by O
a B-Entity
self-extracting I-Entity
RAR I-Entity
archive I-Entity
disguised B-Action
as B-Modifier
a B-Entity
screensaver I-Entity
. O

Upon O
execution O
, O
the B-Entity
self-extracting I-Entity
RAR I-Entity
archive I-Entity
may O
extract B-Action
configuration B-Entity
files I-Entity
, I-Entity
dependency I-Entity
DLLs I-Entity
, I-Entity
and I-Entity
the I-Entity
BITTERBUG I-Entity
executable I-Entity
. O

The O
timeline O
below O
is O
of O
BITTERBUG O
activity O
from O
May O
2013 O
through O
March O
2014 O
. O

Upon O
execution O
the B-Entity
self-extracting I-Entity
RAR I-Entity
may O
install B-Action
< B-Entity
BITTERBUG I-Entity
> I-Entity
.exe I-Entity
and I-Entity
the I-Entity
following I-Entity
DLLs I-Entity
: O
The B-Entity
self-extracting I-Entity
RAR I-Entity
may O
install B-Action
the B-Entity
following I-Entity
benign I-Entity
configuration I-Entity
files I-Entity
: O
BITTERBUG B-Entity
first O
may O
execute B-Action
the B-Entity
following I-Entity
Windows I-Entity
Management I-Entity
Instrumentation I-Entity
( I-Entity
WMI I-Entity
) I-Entity
command I-Entity
to B-Modifier
detect B-Entity
the I-Entity
presence I-Entity
of I-Entity
a I-Entity
virtual I-Entity
machine I-Entity
( I-Entity
VM I-Entity
) I-Entity
: O
BITTERBUG B-Entity
then O
may O
open B-Action
recovery.txt B-Entity
and O
check B-Action
for B-Modifier
the B-Entity
presence I-Entity
of I-Entity
strings I-Entity
VBox I-Entity
or I-Entity
VMware I-Entity
. O

The B-Entity
backdoor I-Entity
then O
may O
enter B-Action
an B-Entity
infinite I-Entity
sleep I-Entity
loop I-Entity
if B-Modifier
recovery.txt B-Entity
contains I-Entity
either I-Entity
one I-Entity
of I-Entity
the I-Entity
aforementioned I-Entity
strings I-Entity
( I-Entity
Example I-Entity
in I-Entity
Figure I-Entity
13 I-Entity
) I-Entity
. O

Next O
BITTERBUG B-Entity
typically O
will O
beacon B-Action
to B-Modifier
the B-Entity
C2 I-Entity
server I-Entity
by B-Modifier
sending B-Entity
the I-Entity
computer I-Entity
name I-Entity
and I-Entity
username I-Entity
of I-Entity
the I-Entity
compromised I-Entity
system I-Entity
. O

An O
example O
beacon O
request O
is O
shown O
in O
Figure O
14 O
. O

BITTERBUG B-Entity
then O
may O
perform B-Action
an B-Entity
HTTP I-Entity
GET I-Entity
request I-Entity
for I-Entity
the I-Entity
following I-Entity
URI I-Entity
: O
If O
the O
C2 O
server O
responds O
with O
a O
filename O
, O
the B-Entity
filename I-Entity
received I-Entity
is B-Action
deleted I-Action
from B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\Microsoft I-Entity
< I-Entity
FILENAMEFROM I-Entity
C2 I-Entity
> I-Entity
. O

The O
purpose O
of O
this B-Entity
command I-Entity
might O
be O
to O
delete B-Action
older B-Entity
versions I-Entity
of I-Entity
BITTERBUG I-Entity
, O
although O
we O
have O
not O
observed O
this O
command O
occurring O
in O
the O
wild O
. O

BITTERBUG B-Entity
then O
may O
attempt O
to O
download B-Action
the B-Entity
files I-Entity
listed I-Entity
in I-Entity
Table I-Entity
1 I-Entity
. O

The O
purpose O
of O
the O
first O
three O
files O
is O
unknown O
. O

The B-Entity
final I-Entity
two I-Entity
files I-Entity
are B-Action
downloaded I-Action
to B-Modifier
the B-Entity
user I-Entity
's I-Entity
Startup I-Entity
directory I-Entity
and O
executed B-Action
at B-Modifier
startup B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
maintain B-Entity
persistence I-Entity
. O

Next O
, O
BITTERBUG B-Entity
may O
scan B-Action
through B-Modifier
each B-Entity
drive I-Entity
letter I-Entity
and O
search B-Action
recursively O
for B-Modifier
files B-Entity
with I-Entity
the I-Entity
following I-Entity
file I-Entity
extensions I-Entity
: O
BITTERBUG B-Entity
then O
typically O
creates B-Action
a B-Entity
file I-Entity
list I-Entity
containing I-Entity
all I-Entity
documents I-Entity
( I-Entity
excluding I-Entity
those I-Entity
whose I-Entity
filename I-Entity
contains I-Entity
MediaUtils I-Entity
) I-Entity
to B-Modifier
the B-Entity
following I-Entity
locations I-Entity
: O
BITTERBUG B-Entity
may O
also O
write B-Action
a B-Entity
list I-Entity
of I-Entity
all I-Entity
running I-Entity
processes I-Entity
to O
: O
Finally O
, O
BITTERBUG B-Entity
typically O
uploads B-Action
the B-Entity
running I-Entity
process I-Entity
list I-Entity
, I-Entity
document I-Entity
file I-Entity
list I-Entity
, I-Entity
and I-Entity
all I-Entity
documents I-Entity
to B-Modifier
the B-Entity
following I-Entity
URI I-Entity
: O
BITTERBUG O
may O
be O
extracted O
along O
with O
the O
following O
embedded O
files O
: O
The B-Entity
malware I-Entity
may O
create B-Action
the B-Entity
following I-Entity
files I-Entity
: O
• O
The B-Entity
malware I-Entity
typically O
communicates B-Action
on B-Modifier
TCP B-Entity
port I-Entity
80 I-Entity
: O
• O
The B-Entity
malware I-Entity
may O
perform B-Action
HTTP B-Entity
requests I-Entity
for B-Modifier
the B-Entity
following I-Entity
URIs I-Entity
: O
We O
observed O
other O
interesting O
operational O
security-oriented O
challenges O
in O
the O
post-blog O
post O
samples O
. O

In O
one O
case O
, O
an O
actor O
appeared O
to O
manually O
null O
out O
the O
'' O
Cert-India O
'' O
user O
directory O
in O
one O
of O
the O
file O
paths O
( O
see O
figures O
15 O
and O
16 O
below O
) O
contained O
in O
two O
binaries O
( O
support O
components O
) O
. O

These O
files O
shared O
the O
same O
import O
hash O
( O
4e96e86db5a8a025b996aefdc218ff74 O
) O
and O
were O
virtually O
the O
same O
files O
minus O
modification O
to O
a O
few O
bytes O
in O
the O
second O
sample O
. O

As O
these O
samples O
point O
to O
, O
we O
also O
observed O
use O
of O
the O
C++ O
Boost O
libraries O
, O
which O
introduced O
a O
new O
file O
path O
to O
monitor O
for O
operational O
security O
purposes O
. O

We O
observed O
at O
least O
one O
case O
in O
which O
files O
mixed O
old O
and O
new O
file O
paths O
, O
as O
seen O
in O
the O
figures O
17 O
and O
18 O
below O
. O

In O
both O
cases O
, O
it O
is O
possible O
that O
the O
actors O
intentionally O
did O
this O
in O
an O
attempt O
to O
mislead O
further O
research O
efforts O
into O
post-blog O
samples O
or O
cast O
suspicion O
on O
'' O
Cert-India O
'' O
as O
a O
more-revealing O
element O
. O

For O
example O
, O
analysis O
of O
files O
deployed O
alongside O
the O
nulled-out O
'' O
Cert-India O
'' O
sample O
mentioned O
above O
revealed O
a O
lack O
of O
concern O
over O
the O
same O
string O
. O

Alternatively O
, O
these O
inconsistencies O
could O
also O
indicate O
sloppy O
tradecraft O
and/or O
teamwork O
. O

BITTERBUG O
Hashes O
BITTERBUG O
and O
Support O
Component O
Debug O
Strings O
( O
in O
order O
of O
first O
use O
) O
BITTERBUG O
Import O
Hashes O
HTTP O
Requests O
BITTERBUG O
Domain O
& O
IPs O
The O
Kansas-City-based O
hosting O
provider O
sent O
an O
introductory O
email O
message O
on O
July O
24th O
, O
2013 O
at O
1500 O
CDT O
and O
would O
be O
received O
by O
TCIRT O
at O
1400 O
EDT O
and O
VPSNOC O
on O
Thursday O
July O
25th O
, O
2013 O
at O
1200 O
PKT O
. O

Analysis O
of O
the O
VPSNOC O
email O
header O
indicated O
that O
the O
message O
was O
sent O
on O
Thursday O
25 O
July O
at O
02:28:41 O
+0500 O
GMT O
, O
which O
is O
consistent O
with O
Pakistan O
's O
time O
zone O
. O

Of O
note O
, O
the O
email O
message O
was O
sent O
with O
an O
X-Originating O
IP O
Address O
of O
184.75.214.10 O
corresponding O
to O
a O
Private O
Internet O
Access O
Canadian O
proxy O
. O

VPSNOC O
's O
use O
of O
this O
commercial O
proxy O
service O
likely O
demonstrates O
the O
intent O
to O
mask O
the O
apparent O
origin O
of O
the O
sender O
. O

These O
two O
examples O
highlight O
that O
VPSNOC O
's O
inbound O
and O
outbound O
email O
communications O
consistently O
utilized O
a O
+0500 O
Pakistani O
timezone O
. O

Due O
to O
the O
apparent O
Pakistani O
nexus O
within O
the O
BITTERBUG O
malware O
and O
the O
Pakistan O
time O
zone O
consistently O
observed O
within O
the O
VPSNOC O
emails O
, O
the O
TCIRT O
applied O
additional O
scrutiny O
and O
research O
of O
the O
content O
within O
the O
Tranchulas O
'' O
Response O
ThreatConnect.docx O
'' O
to O
validate O
their O
claims O
. O

In O
the O
following O
section O
we O
will O
examine O
the O
inconsistencies O
observed O
. O

Within O
the O
response O
we O
observed O
the O
following O
inconsistencies O
: O
Our O
review O
of O
the O
'' O
ResponseThreatConnect.docx O
'' O
focused O
in O
on O
the O
email O
screenshot O
( O
Figure O
3 O
) O
image1.png O
that O
Khan O
provided O
revealing O
that O
the O
date O
probably O
had O
been O
modified O
to O
appear O
as O
though O
they O
were O
the O
first O
to O
notify O
VPSNOC O
. O

Within O
the O
official O
response O
, O
Zubair O
Khan O
indicated O
that O
Tranchulas O
was O
'' O
already O
aware O
of O
this O
incident O
... O

and O
contacted O
hosting O
company O
. O

'' O
The O
official O
response O
included O
a O
screenshot O
depicting O
an O
email O
sent O
to O
VPSNOC O
from O
an O
unidentified O
( O
redacted O
) O
tranchulas.com O
email O
address O
that O
was O
sent O
on O
'' O
Tue O
, O
Jul O
21 O
, O
2013 O
at O
11:36 O
PM O
'' O
with O
no O
evidence O
of O
the O
date O
in O
which O
it O
was O
received O
by O
or O
responded O
to O
by O
VPSNOC O
. O

This O
message O
contained O
a O
notable O
misalignment O
between O
the O
date O
and O
day O
of O
the O
week O
. O

July O
21 O
, O
2013 O
was O
a O
Sunday O
, O
not O
a O
Tuesday O
. O

'' O
Tuesday O
'' O
would O
have O
pre-dated O
our O
official O
notification O
that O
occurred O
on O
Wednesday O
July O
24 O
, O
2013 O
, O
and O
could O
indicate O
that O
Tranchulas O
may O
have O
obtained O
insight O
into O
the O
original O
TCIRT O
notification O
through O
Pakistan- O
based O
contacts O
within O
VPSNOC O
. O

The O
TCIRT O
subsequently O
responded O
to O
Mr. O
Khan O
's O
official O
explanation O
with O
a O
follow-up O
inquiry O
, O
offering O
Khan O
an O
opportunity O
to O
explain O
the O
date O
inconsistency O
within O
the O
email O
screenshot O
. O

Mr. O
Khan O
deferred O
our O
request O
to O
Mr. O
Hamza O
Qamar O
, O
a O
Penetration O
Testing O
Team O
Lead O
at O
Tranchulas O
, O
who O
later O
responded O
with O
a O
simple O
denial O
that O
the O
email O
message O
had O
not O
been O
altered O
apart O
from O
blurring O
the O
name O
of O
the O
original O
sender O
. O

The O
email O
screenshot O
( O
image1.png O
) O
from O
within O
the O
Tranchulas O
response O
demonstrated O
awareness O
of O
information O
that O
we O
initially O
withheld O
and O
later O
released O
in O
our O
blog O
post O
: O
one O
malware O
variant O
that O
contained O
a O
debug O
string O
with O
'' O
umairaziz27 O
'' O
the O
same O
username O
as O
a O
Tranchulas O
employee O
. O

The O
Tranchulas O
message O
to O
VPSNOC O
incorrectly O
claimed O
to O
identify O
malware O
on O
199.91.173.43 O
that O
contained O
the O
'' O
company O
's O
name O
and O
... O

employee O
's O
name O
'' O
. O

While O
it O
is O
possible O
that O
Tranchulas O
' O
analysts O
discovered O
this O
variant O
independent O
of O
the O
blog O
post O
, O
it O
added O
to O
the O
inconsistent O
elements O
of O
the O
response O
and O
further O
suggested O
that O
the O
blog O
post O
may O
have O
inspired O
its O
communications O
with O
VPSNOC O
. O

We O
note O
that O
we O
requested O
additional O
information O
such O
as O
the O
'' O
detailed O
analysis O
report O
'' O
within O
the O
exchange O
from O
Tranchulas O
but O
did O
not O
receive O
a O
response O
. O

The O
Tranchulas O
response O
indicates O
that O
'' O
Tranchulas O
' O
research O
team O
was O
already O
aware O
of O
this O
incident O
before O
publication O
of O
this O
report O
. O

Our O
team O
contacted O
hosting O
company O
of O
server O
to O
seek O
an O
explanation O
. O

'' O
Considering O
there O
are O
no O
public O
references O
to O
the O
identified O
infrastructure O
identifying O
VPSNOC O
as O
the O
'' O
hosting O
company O
'' O
. O

The O
only O
way O
for O
Tranchulas O
to O
identify O
VPSNOC O
as O
the O
hosting O
company O
was O
to O
either O
have O
previous O
insider O
knowledge O
of O
the O
activity O
, O
or O
to O
have O
been O
privately O
introduced O
by O
the O
Kansas-City-based O
service O
provider O
to O
their O
'' O
client O
'' O
VPSNOC O
, O
of O
which O
was O
never O
mentioned O
or O
discussed O
when O
we O
initially O
exchanged O
with O
either O
the O
Kansas-City O
or O
Pakistan-based O
hosting O
providers O
. O

Public O
registration O
of O
the O
199.91.173.43 O
reveals O
the O
Kansas-City-based O
hosting O
provider O
as O
the O
official O
registrant O
and O
owner O
of O
the O
infrastructure O
. O

The O
only O
way O
to O
know O
that O
VPSNOC O
was O
subleasing O
the O
infrastructure O
was O
to O
obtain O
this O
information O
directly O
from O
them O
. O

There O
was O
no O
public O
reference O
which O
would O
have O
revealed O
VPSNOC O
as O
the O
entity O
which O
maintained O
root O
access O
to O
the O
199.91.173.43 O
. O

Had O
Tranchulas O
legitimately O
conducted O
an O
initial O
victim O
notification O
sometime O
in O
late O
July O
2013 O
, O
they O
would O
have O
likely O
done O
so O
through O
the O
Kansas-City-based O
hosting O
provider O
and O
not O
VPSNOC O
. O

On O
August O
15 O
, O
2013 O
, O
Hamza O
Qamar O
's O
response O
to O
TCIRT O
's O
follow O
up O
inquiry O
to O
the O
observed O
inconsistencies O
redirected O
TCIRT O
personnel O
to O
VPSNOC O
to O
obtain O
an O
explanation O
versus O
attempting O
to O
explain O
the O
observed O
day O
date O
inconsistency O
and O
document O
properties O
within O
the O
Tranchulas O
email O
. O

The O
TCIRT O
's O
suspicion O
mounted O
when O
presenting O
Tranchulas O
with O
the O
opportunity O
to O
set O
the O
record O
straight O
, O
that O
Tranchulas O
could O
not O
substantiate O
their O
claims O
, O
rather O
deferring O
the O
TCIRT O
inquiry O
to O
a O
third O
party O
( O
VPSNOC O
) O
. O

Within O
the O
'' O
ResponseThreatConnect.docx O
'' O
the O
image O
'' O
image1.png O
'' O
contains O
an O
undated O
response O
from O
VPSNOC O
to O
the O
'' O
Tue O
, O
Jul O
21 O
, O
2013 O
'' O
Tranchulas O
notification O
. O

The O
undated O
VPSNOC O
response O
that O
Tranchulas O
received O
is O
nearly O
identical O
to O
the O
response O
that O
TCIRT O
and O
the O
Kansas-City-based O
service O
provider O
obtained O
on O
July O
24th O
. O

Tranchulas O
does O
not O
include O
the O
date O
or O
time O
as O
to O
when O
they O
obtained O
a O
response O
from O
VPSNOC O
. O

The O
TCIRT O
found O
it O
unusual O
that O
neither O
the O
Kansas-City-based O
service O
provider O
or O
VPSNOC O
personnel O
ever O
indicated O
either O
way O
that O
they O
knew O
about O
the O
activity O
or O
had O
been O
previously O
contacted O
by O
either O
party O
. O

When O
considering O
all O
of O
the O
inconsistencies O
, O
order O
of O
events O
and O
studying O
, O
Gmail O
webmail O
layout O
, O
similarities O
of O
keywords O
, O
salutations O
and O
closings O
within O
the O
'' O
Tue O
, O
Jul O
21 O
, O
2013 O
'' O
Tranchulas O
notification O
and O
the O
respective O
VPSNOC O
response O
. O

The O
TCIRT O
grew O
increasingly O
suspicious O
of O
the O
exchanges O
with O
VPSNOC O
and O
subsequent O
exchanges O
with O
Tranchulas O
personnel O
. O

Analysis O
of O
metadata O
within O
two B-Entity
benign I-Entity
decoy I-Entity
documents I-Entity
that O
were B-Action
originally I-Action
used I-Action
within B-Modifier
July B-Entity
2013 I-Entity
BITTERBUG I-Entity
operations I-Entity
, O
Report.docx O
and O
NaxalitesFundedbyPakistan.docx O
, O
both O
maintained O
the O
author O
properties O
of O
'' O
hp O
'' O
. O

In O
reviewing O
the O
document O
metadata O
within O
the O
'' O
ResponseThreatConnect.docx O
'' O
that O
was O
sent O
from O
Mr. O
Zubair O
Khan O
on O
August O
6 O
, O
2013 O
, O
the O
TCIRT O
also O
identified O
that O
this O
document O
maintained O
the O
creator O
properties O
of O
'' O
hp O
. O

'' O
( O
Figure O
10 O
) O
While O
the O
author O
field O
of O
'' O
hp O
'' O
does O
n't O
conclusively O
prove O
a O
relationship O
, O
it O
contributes O
to O
a O
body O
of O
circumstantial O
evidence O
which O
matches O
the O
document O
properties O
of O
the O
official O
Tranchulas O
response O
to O
the O
document O
properties O
that O
were O
also O
found O
within O
decoy O
documents O
that O
were O
bundled O
with O
BITTERBUG O
implants O
. O

According O
to O
the O
vpsnoc.com O
website O
'' O
In O
2007 O
five O
VPS O
experts O
decided O
to O
invest O
in O
their O
very O
own O
private O
rack O
space O
in O
the O
heart O
of O
Kansas O
, O
the O
United O
States O
. O

Their O
aim O
? O
To O
bring O
service-oriented O
, O
quality O
managed O
and O
unmanaged O
VPS O
solutions O
to O
clients O
all O
over O
the O
world O
. O

Just O
1 O
year O
later O
, O
after O
beginning O
their O
enterprise O
on O
3 O
servers O
they O
had O
filled O
2 O
server O
racks O
with O
happy O
clients O
receiving O
quality O
U.S O
support O
. O

Their O
company O
continued O
to O
build O
momentum O
. O

'' O
Whois O
records O
for O
vpsnoc.com O
indicate O
that O
another O
individual O
registered O
the O
domain O
and O
listed O
Digital O
Linx O
Hosting O
as O
the O
registrant O
organization O
with O
a O
Kansas O
City-based O
address O
, O
telephone O
number O
925-665-1427 O
, O
and O
administrative O
email O
address O
admin O
@ O
digitallinx O
. O

org O
. O

This O
is O
the O
same O
registrant O
record O
for O
the O
digitallinx.net O
domain O
. O

The O
digitallinx.net/sitemap.xml O
and O
the O
corresponding O
Google O
cache O
for O
digitallinx.net/sitemap.xml O
indiciate O
that O
both O
digitallinx.net O
and O
digitallinx.com O
have O
shared O
the O
same O
sitemap.xml O
at O
the O
same O
time O
. O

The O
digitallinx.net/Contact.html O
identified O
similar O
overlaps O
with O
data O
across O
the O
.org O

, O
.net O

, O
and O
.com O

domains O
. O

The O
domain O
digitallinx.com O
is O
registered O
to O
Perasona O
# O
1 O
. O

He O
uses O
email O
addresses O
naseer O
@ O
digitallinx.com O
and O
nbhatti O
@ O
gmail.com O
as O
the O
domain O
registrant O
email O
address O
, O
along O
with O
address O
638-F O
Johar O
Town O
, O
Lahore O
Pakistan O
and O
telephone O
966.548805579 O
. O

The O
DigitalLinx O
( O
digitallinx.com O
) O
website O
states O
that O
it O
is O
'' O
a O
web O
hosting O
/ O
Web O
Solutions O
& O
Processing O
Outsourcing O
Company O
based O
in O
Pakistan O
'' O
. O

Open O
source O
research O
of O
the O
phone O
number O
925-665-1427 O
indicates O
that O
it O
is O
also O
used O
within O
site O
content O
as O
a O
phone O
number O
for O
defiantmarketing.com O
. O

This O
domain O
is O
registered O
by O
Persona O
# O
2 O
who O
uses O
the O
aliases O
'' O
agnosticon O
'' O
and O
'' O
agnostic O
'' O
. O

Persona O
# O
2 O
lists O
VPSNOC O
as O
the O
registrant O
organization O
, O
and O
uses O
the O
registration O
email O
address O
of O
abunasar O
@ O
yahoo.com O
with O
an O
address O
of O
House O
12 O
, O
Street O
21 O
, O
F-8/1 O
Islamabad O
Federal O
44000 O
. O

The O
domain O
defiantmarketing.com O
domain O
has O
used O
ns1.abunasar.net O
and O
ns2.abunasar.net O
for O
name O
services O
. O

Within O
a O
January O
2009 O
posting O
to O
a O
Debian O
users O
forum O
, O
Persona O
# O
2 O
sends O
an O
email O
from O
the O
abunasar O
@ O
yahoo.com O
with O
a O
reply-to O
as O
abunasar O
@ O
army.com O
. O

Within O
the O
post O
, O
Persona O
# O
2 O
responds O
to O
the O
question O
'' O
Who O
's O
using O
Debian O
'' O
listing O
DigitalLinx O
, O
Kansas O
City O
MO O
and O
the O
link O
to O
digitallinx.com O
. O

Also O
, O
the O
seemingly O
abandoned O
Twitter O
profile O
for O
Persona O
# O
2 O
is O
only O
following O
the O
Twitter O
profile O
for O
@ O
VPSNOC O
. O

In O
an O
April O
2012 O
post O
to O
blackhatworld.com O
, O
a O
user O
with O
the O
alias O
'' O
agnosticon O
'' O
posted O
promotional O
codes O
for O
VPSNOC O
hosting O
services O
, O
engaging O
with O
customers O
, O
providing O
them O
feedback O
regarding O
VPS O
services O
and O
thanking O
them O
for O
positive O
reviews O
. O

Within O
the O
posting O
the O
user O
'' O
agnosticon O
'' O
included O
an O
image O
which O
was O
an O
actual O
advertisement O
that O
was O
hosted O
at O
http O
: O
//vpsnoc O
. O

com/order.png O
. O

Within O
the O
posted O
image O
it O
states O
'' O
VPSNOC O
is O
a O
subdivision O
of O
Digital O
Linx O
Hosting O
. O

We O
have O
been O
in O
business O
since O
2008 O
'' O
. O

The O
posting O
concludes O
with O
'' O
If O
you O
have O
any O
further O
questions/queries O
please O
contact O
us O
directly O
at O
: O
support O
@ O
vpsnoc.com O
'' O
Muhammad O
Naseer O
Bhatti O
's O
LinkedIn O
profile O
indicates O
that O
he O
is O
currently O
the O
founder O
for O
Digital O
Linx O
LLC O
and O
vBilling O
( O
vbilling.org O
) O
as O
well O
as O
a O
consultant O
for O
a O
U.S. O
company O
. O

Both O
Bhatti O
and O
Digital O
Linx O
are O
listed O
as O
the O
registrants O
for O
vbilling.org O
, O
v-billing O
. O

com O
, O
vgriffins.com O
and O
my-server.co O
, O
which O
use O
P.O O
. O

Box O
295658 O
, O
Riyadh O
Saudi O
Arabia O
as O
the O
registration O
address O
. O

This O
is O
also O
the O
address O
for O
two O
U.S. O
companies O
' O
local O
operations O
. O

Bhatti O
is O
also O
listed O
as O
the O
owner O
of O
the O
netblock O
46.4.139.224/28 O
. O

Both O
passive O
DNS O
sources O
as O
well O
as O
Robtex O
highlight O
this O
overlapping O
infrastructure O
. O

From O
September O
7 O
- O
9 O
, O
2011 O
, O
Tranchulas O
in O
cooperation O
with O
the O
Pakistan O
National O
University O
of O
Sciences O
and O
Technology O
( O
NUST O
) O
, O
offered O
a O
Certified O
Penetration O
Testing O
Profession O
( O
CPTP O
) O
Workshop O
( O
Figure O
17 O
) O
. O

During O
the O
workshop O
, O
basic O
penetration O
techniques O
and O
skills O
were O
presented O
. O

It O
is O
likely O
that O
CPTP O
workshops O
and O
alignment O
with O
NUST O
have O
allowed O
Tranchulas O
the O
opportunity O
to O
recruit O
student O
interns O
. O

Within O
the O
CPTP O
event O
registration O
contact O
information O
for O
Muhammad O
Naseer O
was O
listed O
next O
to O
a O
Tranchulas O
office O
number O
( O
051- O
2871433 O
) O
. O

It O
is O
important O
to O
note O
that O
Muhammad O
Naseer O
Bhatti O
has O
been O
previously O
known O
to O
drop O
the O
family O
name O
'' O
Bhatti O
'' O
within O
online O
correspondence O
( O
Figure O
18 O
) O
. O

In O
a O
June O
2012 O
episode O
of O
Engineering O
and O
Technology O
Magazine O
podcast O
a O
Mohammed O
Nasser O
, O
Penetration O
Tester O
at O
Tranchulas O
was O
interviewed O
. O

A O
Mohammed O
Nasser O
may O
also O
be O
directly O
affiliated O
with O
Tranchulas O
. O

This O
links O
Tranchulas O
to O
a O
Pakistani O
employee O
or O
consultant O
also O
named O
Muhammad O
Naseer O
. O

It O
is O
unknown O
if O
this O
is O
the O
same O
Muhammad O
Naseer O
that O
is O
associated O
with O
VPSNOC O
's O
parent O
company O
Digital O
Linx O
, O
the O
Pakistan-based O
service O
provider O
which O
hosted O
the O
original O
BITTERBUG O
malware O
. O

Abunasar O
Khan O
also O
maintains O
the O
aliases O
'' O
agnosticon O
'' O
and O
'' O
agnostic O
'' O
in O
addition O
to O
the O
email O
addresses O
abunasar O
@ O
yahoo O
. O

com O
and O
abunasar O
@ O
army.com O
. O

He O
has O
been O
previously O
associatedwith O
VPSNOC O
& O
Digital O
Linx O
. O

An O
April O
2012 O
Whois O
registrant O
record O
for O
the O
domain O
zeusadnetwork.com O
includes O
the O
first O
and O
last O
name O
Khan O
along O
with O
the O
same O
( O
925 O
) O
665-1427 O
phone O
number O
seen O
within O
the O
Digial O
Linx O
Hosting O
domains O
. O

Khan O
registered O
a O
variety O
of O
domains O
, O
many O
of O
which O
use O
his O
abunasar.net O
for O
name O
services O
and O
abunasar.yahoo.com O
within O
the O
Start O
of O
Authority O
( O
SOA O
) O
records O
. O

For O
example O
a O
July O
2014 O
record O
( O
Figure O
19 O
) O
for O
defiantmarketing.com O
and O
an O
August O
2013 O
record O
( O
Figure O
20 O
) O
for O
ns2.vpsnoc.com O
both O
maintain O
these O
references O
. O

Abunasar O
Khan O
registered O
abunasar.net O
and O
previously O
( O
May O
2007 O
) O
and O
maintained O
whitehate.org O
, O
which O
have O
both O
been O
used O
to O
demonstrate O
an O
affinity O
for O
and O
alignment O
with O
AntiSec O
and O
Anonymous O
movements O
. O

The O
abunasar.net O
website O
prominently O
displays O
ascii O
art O
of O
the O
term O
'' O
antisec O
'' O
with O
antisec O
related O
content O
'' O
Blend O
in O
. O

Get O
trusted O
. O

Trust O
nobody O
. O

Own O
everybody O
. O

Disclose O
nothing O
. O

Destroy O
everything O
. O

Take O
back O
the O
scene O
. O

'' O
This O
is O
a O
shared O
affinity O
that O
is O
also O
reflected O
amongst O
with O
the O
culture O
of O
Tranchulas O
employees O
. O

The O
pure.whitehate.org O
domain O
has O
also O
been O
previously O
associated O
with O
Khan O
, O
examples O
can O
be O
found O
within O
# O
phrack O
and O
# O
darknet O
IRC O
sessions O
. O

Ironically O
, O
in O
February O
2011 O
, O
Khan O
's O
Rootkit.com O
user O
profile O
was O
compromised O
revealing O
his O
profile O
's O
username O
, O
password O
hash O
, O
email O
( O
abunasar O
@ O
army.com O
) O
, O
and O
the O
registration O
IP O
address O
of O
202.125.143.67 O
( O
Islamabad O
, O
Pakistan O
) O
. O

During O
his O
registration O
, O
Khan O
specified O
the O
name O
'' O
anony O
mo O
us O
'' O
when O
registering O
the O
profile O
. O

As O
of O
16 O
August O
2013 O
, O
a O
Pastebin O
post O
contained O
details O
of O
a O
customer O
database O
compromise O
for O
nowclothing.pk O
, O
which O
included O
Khan O
's O
name O
, O
email O
abunasar O
@ O
army.com O
, O
and O
cell O
phone O
number O
03215488881 O
. O

Research O
of O
the O
03215488881 O
cell O
phone O
number O
yields O
a O
user O
profile O
'' O
abunasark O
'' O
in O
an O
April O
2009 O
posting O
. O

Khan O
posts O
pictures O
of O
his O
blue O
Baleno O
and O
includes O
another O
phone O
number O
03234764838 O
. O

In O
a O
secondary O
profile O
user O
'' O
Ak O
'' O
uses O
the O
same O
cell O
phone O
number O
03215488881 O
in O
a O
2009 O
sales O
posting O
for O
a O
2004 O
blue O
Baleno O
. O

Khan O
's O
affinity O
for O
Suzuki O
Baleno O
cars O
is O
made O
obvious O
in O
a O
May O
2009 O
registration O
for O
clubaleno.co.uk O
that O
was O
registered O
by O
Khan O
at O
VPSNOC O
using O
the O
name O
services O
of O
ns1.abunasar.net O
and O
ns2.abunasar.net O
with O
a O
SOA O
record O
of O
abunasar.yahoo.com O
. O

Later O
in O
a O
June O
2009 O
posting O
, O
Khan O
using O
the O
alias O
'' O
agnostic O
'' O
attempts O
to O
sell O
the O
domain O
clubaleno.co.uk O
and O
uses O
his O
abunasar O
@ O
army.com O
email O
address O
as O
a O
point O
of O
contact O
. O

Khan O
is O
also O
observed O
using O
the O
alias O
'' O
agnosticon O
'' O
and O
a O
Toyota O
Racing O
Development O
avitar O
within O
posts O
to O
blackhatworld.com O
and O
again O
within O
a O
2011 O
post O
where O
he O
posts O
a O
cpanel O
error O
that O
also O
includes O
his O
'' O
abunasar O
'' O
username O
within O
system O
output O
. O

The O
Google+ O
profile O
for O
Khan O
reveals O
established O
social O
network O
links O
to O
a O
Team O
Lead O
for O
Penetration O
Testing O
at O
Tranchulas O
and O
a O
Digital O
Linx O
employee O
Shoaib O
Riaz O
who O
also O
maintains O
a O
social O
network O
association O
with O
the O
Digital O
Linx O
founder O
Muhammad O
Nasser O
Bhatti O
. O

The O
Tranchulas O
website O
states O
that O
they O
provide O
a O
range O
of O
security O
services O
and O
training O
to O
include O
penetration O
and O
offensive O
cyber O
initiative O
( O
OCI O
) O
, O
in O
which O
they O
'' O
help O
national O
level O
cyber O
security O
programs O
on O
strategies O
for O
managing O
offensive O
technical O
threats O
'' O
. O

In O
a O
September O
2011 O
YouTube O
user O
'' O
tranchulascert O
'' O
posted O
a O
video O
titled O
'' O
Tranchulas O
Cyber O
Ranges O
- O
P O
@ O
sha O
ICT O
Awards O
2011 O
'' O
, O
where O
they O
awarded O
runner O
up O
. O

Within O
the O
video O
, O
the O
cyber O
ranges O
were O
referenced O
as O
being O
developed O
for O
'' O
defense O
forces O
'' O
that O
were O
aimed O
to O
'' O
help O
them O
in O
developing O
offensive O
and O
defensive O
warfare O
skills O
'' O
and O
'' O
combating O
anti-state O
hackers O
'' O
. O

Although O
Tranchulas O
brands O
itself O
as O
a O
multi-national O
company O
, O
their O
respective O
operating O
addresses O
within O
United O
Kingdom O
the O
United O
States O
and O
New O
Zealand O
are O
all O
associated O
with O
either O
virtual O
office O
spaces O
or O
address O
forwarding O
services O
. O

The O
Tranchulas O
website O
lists O
its O
Pakistan O
address O
within O
the O
2nd O
floor O
of O
the O
Evacuee O
Trust O
Complex O
on O
Sir O
Agha O
Khan O
Road O
F-5/1 O
Islamabad O
44000 O
. O

The O
Evacuee O
Trust O
Complex O
is O
also O
known O
as O
Software O
Technology O
Park O
2 O
or O
STP2 O
and O
hosts O
a O
variety O
of O
other O
commercial O
and O
government O
offices O
. O

The O
Tranchulas O
employee O
, O
Hamza O
Qamar O
, O
that O
handled O
the O
response O
to O
our O
inquiry O
has O
a O
public O
LinkedIn O
profile O
that O
states O
that O
he O
'' O
Engaged O
in O
system O
and O
enterprise O
level O
network O
and O
Web O
application O
security O
testing O
for O
clients O
ranging O
from O
large O
federal O
agencies O
, O
DoD O
, O
and O
commercial O
clients O
. O

'' O
The O
profile O
does O
not O
specify O
if O
DoD O
is O
a O
reference O
to O
the O
U.S. O
Department O
of O
Defense O
or O
another O
country O
's O
Ministry O
of O
Defense O
. O

Interestingly O
, O
Qamar O
's O
Google+ O
page O
showed O
one O
'' O
friend O
'' O
in O
his O
circle O
despite O
more O
than O
40 O
followers O
, O
Abunasar O
Khan O
a O
VPSNOC O
employee O
. O

It O
is O
likely O
that O
Tranchulas O
provides O
services O
to O
the O
Pakistani O
government O
. O

The O
offensive O
cyber O
initiative O
services O
offered O
by O
Tranchulas O
is O
offered O
to O
'' O
national-level O
cyber O
security O
programs O
'' O
suggesting O
a O
commercial O
demand O
from O
'' O
national-level O
'' O
customers O
. O

The O
stated O
purpose O
and O
intent O
of O
the O
Tranchulas O
'' O
Cyber O
Ranges O
'' O
P O
@ O
sha O
ICT O
2011 O
awards O
video O
suggests O
the O
ranges O
were O
specifically O
developed O
in O
support O
of O
national O
interests O
for O
offensive O
and O
defensive O
purposes O
. O

The O
domain O
registration O
by O
Zubair O
Khan O
using O
an O
official O
Pakistani O
government O
address O
with O
his O
zubair O
@ O
tranchulas.com O
email O
address O
indicates O
that O
Khan O
may O
have O
or O
currently O
maintains O
a O
physical O
address O
at O
a O
location O
where O
other O
Pakistani O
government O
officials O
reside O
. O

Historic O
Whois O
registration O
records O
for O
the O
domains O
textcrypter.com O
, O
taggnation.com O
, O
bookadoconline.com O
and O
saadiakhan O
. O

net O
lists O
Tranchulas O
CEO O
Zubair O
Khan O
( O
zubair O
@ O
tranchulas.com O
) O
as O
the O
registrant O
for O
the O
domains O
. O

At O
the O
time O
of O
registration O
Khan O
used O
the O
address O
15-B O
, O
Mehran O
Block O
of O
the O
Gulshan-e-Jinnah O
F-5/1 O
Islamabad O
Pakistan O
for O
the O
domains O
. O

In O
an O
April O
2008 O
Request O
for O
Proposals O
, O
the O
Pakistan O
Public O
Works O
Department O
issued O
a O
tender O
for O
the O
Constriction O
of O
Government O
Servant O
Quarters O
and O
Garages O
at O
Gulshan-e-Jinnah O
Complex O
F-5/1 O
Islamabad O
. O

Later O
in O
May O
of O
2010 O
within O
a O
Pakistani O
Senate O
question O
and O
answer O
session O
, O
the O
Gulshan-e-Jinnah O
Complex O
was O
cited O
under O
Federal O
Lodges O
/ O
Hostels O
in O
Islamabad O
under O
the O
control O
of O
Pakistan O
Ministry O
for O
Housing O
and O
Works O
. O

A O
December O
2010 O
TheNews O
Pakistan O
ran O
a O
story O
that O
detailed O
the O
differential O
in O
rents O
between O
commoners O
within O
Islamabad O
and O
Pakistani O
government O
officers O
accommodated O
at O
Gulshan-e-Jinnah O
. O

According O
to O
Google O
Maps O
it O
is O
approximately O
650 O
meters O
( O
8 O
minute O
walk O
) O
from O
the O
Gulshan-e-Jinnah O
Complex O
to O
the O
Tranchulas O
offices O
within O
the O
Evacuee O
Trust O
Complex O
. O

Within O
a O
May O
2013 O
interview O
Khan O
specified O
that O
he O
comes O
from O
a O
family O
with O
a O
strong O
military O
background O
. O

He O
detailed O
his O
interest O
in O
'' O
the O
world O
of O
hacking O
'' O
grew O
during O
his O
teen O
years O
, O
referencing O
his O
father O
's O
diplomatic O
assignment O
to O
the O
Philippines O
in O
2003 O
. O

Khan O
would O
go O
on O
to O
establish O
Tranchulas O
in O
February O
2006 O
after O
an O
independent O
audit O
of O
Pakistani O
Governments O
National O
Database O
and O
Registration O
Authority O
( O
NADRA O
) O
. O

Digital O
Appendix O
1 O
contains O
additional O
research O
collateral O
collected O
when O
conducting O
Operation O
Arachnophobia O
research O
. O

Digital O
Appendix O
2 O
contains O
raw O
email O
communications O
. O

These O
.eml O

files O
include O
raw O
SMTP O
headers O
, O
content O
and O
attachments O
. O

Digital O
Appendix O
3 O
contains O
screenshots O
of O
web O
content O
used O
to O
conduct O
analysis O
. O

Digital O
Appendix O
4 O
contains O
visualization O
files O
that O
depict O
relationships O
and O
contain O
metadata O
associated O
with O
our O
Operation O
Arachnophobia O
research O
. O

Original O
release O
date O
: O
December O
19 O
, O
2014 O
Microsoft O
Windows O
US-CERT O
was O
recently O
notified O
by O
a O
trusted O
third O
party O
of O
cyber O
threat O
actors O
using O
a O
Server O
Message O
Block O
( O
SMB O
) O
Worm O
Tool O
to O
conduct O
cyber O
exploitation O
activities O
recently O
targeting O
a O
major O
entertainment O
company O
. O

This B-Entity
SMB I-Entity
Worm I-Entity
Tool I-Entity
is B-Action
equipped I-Action
with B-Modifier
a B-Entity
Listening I-Entity
Implant I-Entity
, O
Lightweight B-Entity
Backdoor I-Entity
, O
Proxy B-Entity
Tool I-Entity
, O
Destructive B-Entity
Hard I-Entity
Drive I-Entity
Tool I-Entity
, O
and O
Destructive B-Entity
Target I-Entity
Cleaning I-Entity
Tool I-Entity
. O

SMB O
Worm O
Tool O
: O
This B-Entity
worm I-Entity
uses B-Action
a B-Entity
brute I-Entity
force I-Entity
authentication I-Entity
attack I-Entity
to O
propagate B-Action
via B-Modifier
Windows B-Entity
SMB I-Entity
shares I-Entity
. O

It B-Entity
connects B-Action
home B-Entity
every B-Modifier
five B-Entity
minutes I-Entity
to O
send B-Action
log B-Entity
data I-Entity
back B-Modifier
to I-Modifier
command B-Entity
and I-Entity
control I-Entity
( I-Entity
C2 I-Entity
) I-Entity
infrastructure I-Entity
if O
it B-Entity
has O
successfully O
spread B-Action
to B-Modifier
other B-Entity
Windows I-Entity
hosts I-Entity
via B-Modifier
SMB B-Entity
port I-Entity
445 I-Entity
. O

The B-Entity
tool I-Entity
also O
accepts B-Action
new B-Entity
scan I-Entity
tasking I-Entity
when B-Modifier
it B-Entity
connects I-Entity
to I-Entity
C2 I-Entity
. O

There O
are O
two O
main O
threads O
: O
the B-Entity
first I-Entity
thread I-Entity
calls B-Action
home B-Entity
and O
sends B-Action
back B-Modifier
logs B-Entity
( I-Entity
a I-Entity
list I-Entity
of I-Entity
successful I-Entity
SMB I-Entity
exploitations I-Entity
) I-Entity
, O
and O
the B-Entity
second I-Entity
thread I-Entity
attempts O
to O
guess B-Action
passwords B-Entity
for B-Modifier
SMB B-Entity
connections I-Entity
. O

If O
the O
password O
is O
correctly O
guessed O
, O
a B-Entity
file I-Entity
share I-Entity
is B-Action
established I-Action
and O
file B-Entity
is B-Action
copied I-Action
and O
run B-Action
on B-Modifier
the B-Entity
newly-infected I-Entity
host I-Entity
. O

Listening O
Implant O
: O
During O
installation O
of O
this O
tool O
, O
a O
portion O
of O
the O
binaries O
is O
decrypted O
using O
AES O
, O
with O
a O
key O
derived O
from O
the O
phrase O
'' O
National O
Football O
League O
. O

'' O
Additionally O
, O
this B-Entity
implant I-Entity
listens B-Action
for B-Modifier
connections B-Entity
on B-Modifier
TCP B-Entity
port I-Entity
195 I-Entity
( I-Entity
for I-Entity
'' I-Entity
sensvc.exe I-Entity
'' I-Entity
and I-Entity
'' I-Entity
msensvc.exe I-Entity
'' I-Entity
) I-Entity
and I-Entity
TCP I-Entity
port I-Entity
444 I-Entity
( I-Entity
for I-Entity
'' I-Entity
netcfg.dll I-Entity
'' I-Entity
) I-Entity
. O

Each B-Entity
message I-Entity
sent B-Action
to B-Modifier
and O
from B-Modifier
this B-Entity
implant I-Entity
is O
preceded O
with O
its O
length O
, O
then O
XOR B-Action
encoded I-Action
with B-Modifier
the B-Entity
byte I-Entity
0x1F I-Entity
. O

Upon O
initial O
connection O
, O
the B-Entity
victim I-Entity
sends B-Action
the B-Entity
string I-Entity
, I-Entity
'' I-Entity
HTTP/1.1 I-Entity
GET I-Entity
/dns I-Entity
? I-Entity
\x00 I-Entity
. I-Entity
'' I-Entity
The B-Entity
controller I-Entity
then O
responds B-Action
with B-Modifier
the B-Entity
string I-Entity
'' I-Entity
200 I-Entity
www.yahoo.com I-Entity
! I-Entity
\x00 I-Entity
'' I-Entity
( I-Entity
for I-Entity
'' I-Entity
sensvc.exe I-Entity
'' I-Entity
and I-Entity
'' I-Entity
msensvc.exe I-Entity
'' I-Entity
) I-Entity
or O
with B-Modifier
the B-Entity
string I-Entity
'' I-Entity
RESPONSE I-Entity
200 I-Entity
OK I-Entity
! I-Entity
! I-Entity
'' I-Entity
( I-Entity
for I-Entity
'' I-Entity
netcfg.dll I-Entity
'' I-Entity
) I-Entity
. O

The B-Entity
controller I-Entity
sends B-Action
the B-Entity
byte I-Entity
'' I-Entity
! I-Entity
'' I-Entity
( I-Entity
0x21 I-Entity
) I-Entity
to B-Modifier
end B-Entity
the I-Entity
network I-Entity
connection I-Entity
. O

This O
special O
message O
is O
not O
preceded O
with O
a O
length O
or O
XOR O
encoded O
. O

Lightweight O
Backdoor O
: O
This B-Entity
is B-Action
a B-Entity
backdoor I-Entity
listener I-Entity
that O
is O
designed O
as O
a O
service O
DLL O
. O

It B-Entity
includes B-Action
functionality O
such O
as O
file B-Entity
transfer I-Entity
, O
system B-Entity
survey I-Entity
, O
process B-Entity
manipulation I-Entity
, O
file B-Entity
time I-Entity
matching I-Entity
and O
proxy B-Entity
capability I-Entity
. O

The B-Entity
listener I-Entity
can O
also O
perform B-Action
arbitrary B-Entity
code I-Entity
execution I-Entity
and O
execute B-Action
commands B-Entity
on B-Modifier
the B-Entity
command I-Entity
line I-Entity
. O

This B-Entity
tool I-Entity
includes O
functionality O
to O
open B-Action
ports B-Entity
in B-Modifier
a B-Entity
victim I-Entity
host I-Entity
's I-Entity
firewall I-Entity
and O
take O
advantage O
of O
universal O
Plug O
and O
Play O
( O
UPNP O
) O
mechanisms O
to O
discover B-Action
routers B-Entity
and I-Entity
gateway I-Entity
devices I-Entity
, O
and O
add B-Action
port B-Entity
mappings I-Entity
, O
allowing B-Action
inbound B-Entity
connections I-Entity
to B-Modifier
victim B-Entity
hosts I-Entity
on B-Modifier
Network B-Entity
Address I-Entity
Translated I-Entity
( I-Entity
NAT I-Entity
) I-Entity
private I-Entity
networks I-Entity
. O

There O
are O
no O
callback O
domains O
associated O
with O
this O
malware O
since O
connections O
are O
inbound O
only O
on O
a O
specified O
port O
number O
. O

Proxy O
Tool O
: O
Implants B-Entity
in I-Entity
this I-Entity
malware I-Entity
family I-Entity
are B-Action
typically I-Action
loaded I-Action
via B-Modifier
a B-Entity
dropper I-Entity
installed B-Action
as B-Modifier
a B-Entity
service I-Entity
, O
then O
configured O
to O
listen B-Action
on B-Modifier
TCP B-Entity
port I-Entity
443 I-Entity
. O

The O
implant O
may O
have O
an O
associated O
configuration O
file O
which O
can O
contain O
a O
configurable O
port O
. O

This B-Entity
proxy I-Entity
tool I-Entity
has B-Action
basic B-Entity
backdoor I-Entity
functionality I-Entity
, O
including O
the O
ability O
to O
fingerprint B-Action
the B-Entity
victim I-Entity
machine I-Entity
, O
run B-Action
remote B-Entity
commands I-Entity
, O
perform B-Action
directory B-Entity
listings I-Entity
, O
perform B-Action
process B-Entity
listings I-Entity
, O
and O
transfer B-Action
files B-Entity
. O

Destructive O
Hard O
Drive O
Tool O
: O
This B-Entity
tool I-Entity
is B-Action
a B-Entity
tailored I-Entity
hard-drive I-Entity
wiping I-Entity
tool I-Entity
that O
is O
intended O
to O
destroy B-Action
data B-Entity
past B-Modifier
the B-Entity
point I-Entity
of I-Entity
recovery I-Entity
and O
to O
complicate B-Action
the B-Entity
victim I-Entity
machine I-Entity
's I-Entity
recovery I-Entity
. O

If O
the O
CNE O
operator O
has O
administrator-level O
privileges O
on O
the O
host O
, O
the B-Entity
program I-Entity
will O
over-write B-Action
portions B-Entity
of I-Entity
up-to I-Entity
the I-Entity
first I-Entity
four I-Entity
physical I-Entity
drives I-Entity
attached I-Entity
, O
and O
over-write B-Action
the B-Entity
master I-Entity
boot I-Entity
record I-Entity
( I-Entity
MBR I-Entity
) I-Entity
with B-Modifier
a B-Entity
program I-Entity
designed I-Entity
to I-Entity
cause I-Entity
further I-Entity
damage I-Entity
if I-Entity
the I-Entity
hard I-Entity
drive I-Entity
is I-Entity
re-booted I-Entity
. O

This B-Entity
further O
results B-Action
in I-Action
the B-Entity
victim I-Entity
machine I-Entity
being I-Entity
non-operational I-Entity
with I-Entity
irrecoverable I-Entity
data I-Entity
. O

( O
There O
is O
a O
caveat O
for O
machines O
installed O
with O
the O
windows O
7 O
operating O
system O
: O
windows O
7 O
machines O
will O
continue O
to O
operate O
in O
a O
degraded O
state O
with O
the B-Entity
targeted I-Entity
files I-Entity
destroyed B-Action
until O
after O
reboot O
, O
in O
which O
the B-Entity
infected I-Entity
MBR I-Entity
then O
wipes B-Action
the B-Entity
drive I-Entity
. O

) O
If O
the O
actor O
has O
user-level O
access O
, O
the O
result O
includes O
specific B-Entity
files I-Entity
being B-Action
deleted I-Action
and O
practically O
irrecoverable O
, O
but O
the O
victim O
machine O
would O
remain O
usable O
. O

Destructive O
Target O
Cleaning O
Tool O
: O
This B-Entity
tool I-Entity
renders B-Action
victim B-Entity
machines I-Entity
inoperable B-Entity
by O
overwriting B-Action
the B-Entity
Master I-Entity
Boot I-Entity
Record I-Entity
. O

The B-Entity
tool I-Entity
is B-Action
dropped I-Action
and I-Action
installed I-Action
by O
another B-Entity
executable I-Entity
and O
consists O
of O
three O
parts O
: O
an B-Entity
executable I-Entity
and I-Entity
a I-Entity
dll I-Entity
which O
contain B-Action
the B-Entity
destructive I-Entity
components I-Entity
, O
and O
an B-Entity
encoded I-Entity
command I-Entity
file I-Entity
that O
contains B-Action
the B-Entity
actual I-Entity
destruction I-Entity
commands I-Entity
to I-Entity
be I-Entity
executed I-Entity
. O

Network O
Propagation O
Wiper O
: O
The B-Entity
malware I-Entity
has O
the O
ability O
to O
propagate B-Action
throughout B-Modifier
the B-Entity
target I-Entity
network I-Entity
via B-Modifier
built-in B-Entity
Windows I-Entity
shares I-Entity
. O

Based O
on O
the O
username/password O
provided O
in O
the O
configuration O
file O
and O
the O
hostname/IP O
address O
of O
target O
systems O
, O
the B-Entity
malware I-Entity
will O
access B-Action
remote B-Entity
network I-Entity
shares I-Entity
in O
order O
to O
upload B-Action
a B-Entity
copy I-Entity
of I-Entity
the I-Entity
wiper I-Entity
and O
begin B-Action
the B-Entity
wiping I-Entity
process I-Entity
on B-Modifier
these B-Entity
remote I-Entity
systems I-Entity
. O

The B-Entity
malware I-Entity
uses O
several O
methods O
to O
access B-Action
shares B-Entity
on B-Modifier
the B-Entity
remote I-Entity
systems I-Entity
to O
begin O
wiping B-Action
files B-Entity
. O

Checking B-Action
for B-Modifier
existing B-Entity
shares I-Entity
via B-Modifier
'' B-Entity
\\hostname\admin I-Entity
$ I-Entity
\system32 I-Entity
'' I-Entity
and I-Entity
'' I-Entity
\\hostname\shared I-Entity
$ I-Entity
\system32 I-Entity
'' I-Entity
or O
create B-Action
a B-Entity
new I-Entity
share I-Entity
'' I-Entity
cmd.exe I-Entity
/q I-Entity
/c I-Entity
net I-Entity
share I-Entity
shared I-Entity
$ I-Entity
= I-Entity
% I-Entity
SystemRoot I-Entity
% I-Entity
/GRANT I-Entity
: I-Entity
everyone I-Entity
, I-Entity
FULL I-Entity
'' I-Entity
. O

Once O
successful O
, O
the B-Entity
malware I-Entity
uploads B-Action
a B-Entity
copy I-Entity
of I-Entity
the I-Entity
wiper I-Entity
file I-Entity
'' I-Entity
taskhostXX.exe I-Entity
'' I-Entity
, O
changes B-Action
the B-Entity
file-time I-Entity
to B-Modifier
match B-Entity
that I-Entity
of I-Entity
the I-Entity
built-in I-Entity
file I-Entity
'' I-Entity
calc.exe I-Entity
'' I-Entity
, O
and O
starts B-Action
the B-Entity
remote I-Entity
process I-Entity
. O

The B-Entity
remote I-Entity
process I-Entity
is B-Action
started I-Action
via B-Modifier
the B-Entity
command I-Entity
'' I-Entity
cmd.exe I-Entity
/c I-Entity
wmic.exe I-Entity
/node I-Entity
: I-Entity
hostname I-Entity
/user I-Entity
: I-Entity
username I-Entity
/password I-Entity
: I-Entity
pass I-Entity
PROCESS I-Entity
CALL I-Entity
CREATE I-Entity
'' I-Entity
. O

Hostname O
, O
username O
, O
and O
password O
are O
then O
obtained O
from O
the O
configuration O
file O
. O

Afterwards O
, O
the B-Entity
remote I-Entity
network I-Entity
share I-Entity
is B-Action
removed I-Action
via B-Modifier
'' B-Entity
cmd.exe I-Entity
/q I-Entity
/c I-Entity
net I-Entity
share I-Entity
shared I-Entity
$ I-Entity
/delete I-Entity
'' I-Entity
. O

Once O
the B-Entity
wiper I-Entity
has O
been B-Action
uploaded I-Action
, O
the B-Entity
malware I-Entity
reports B-Action
its B-Entity
status I-Entity
back B-Modifier
to I-Modifier
one B-Entity
of I-Entity
the I-Entity
four I-Entity
C2 I-Entity
IP I-Entity
addresses I-Entity
. O

Technical O
and O
strategic O
mitigation O
recommendations O
are O
included O
in O
the O
Solution O
section O
below O
. O

US-CERT O
recommends O
reviewing O
the O
Security O
Tip O
Handling O
Destructive O
Malware O
# O
ST13-003 O
. O

Cyber O
threat O
actors O
are O
using O
an O
SMB O
worm O
to O
conduct O
cyber O
exploitation O
activities O
. O

This B-Entity
tool I-Entity
contains B-Action
five O
components O
– O
a B-Entity
listening I-Entity
implant I-Entity
, O
lightweight B-Entity
backdoor I-Entity
, O
proxy B-Entity
tool I-Entity
, O
destructive B-Entity
hard I-Entity
drive I-Entity
tool I-Entity
, O
and O
destructive B-Entity
target I-Entity
cleaning I-Entity
tool I-Entity
. O

The B-Entity
SMB I-Entity
worm I-Entity
propagates B-Action
throughout B-Modifier
an B-Entity
infected I-Entity
network I-Entity
via B-Modifier
brute-force B-Entity
authentication I-Entity
attacks I-Entity
, O
and O
connects B-Action
to B-Modifier
a B-Entity
C2 I-Entity
infrastructure I-Entity
. O

Due O
to O
the O
highly O
destructive O
functionality O
of O
this O
malware O
, O
an O
organization O
infected O
could O
experience O
operational O
impacts O
including O
loss O
of O
intellectual O
property O
and O
disruption O
of O
critical O
systems O
. O

Users O
and O
administrators O
are O
recommended O
to O
take O
the O
following O
preventive O
measures O
to O
protect O
their O
computer O
networks O
: O
Use O
and O
maintain O
anti-virus O
software O
– O
Anti-virus O
software O
recognizes O
and O
protects O
your O
computer O
against O
most O
known O
viruses O
. O

It O
is O
important O
to O
keep O
your O
anti-virus O
software O
up-to-date O
( O
see O
Understanding O
Anti-Virus O
Software O
for O
more O
information O
) O
. O

Keep O
your O
operating O
system O
and O
application O
software O
up-to-date O
– O
Install O
software O
patches O
so O
that O
attackers O
ca O
n't O
take O
advantage O
of O
known O
problems O
or O
vulnerabilities O
. O

Many O
operating O
systems O
offer O
automatic O
updates O
. O

If O
this O
option O
is O
available O
, O
you O
should O
enable O
it O
( O
see O
Understanding O
Patches O
for O
more O
information O
) O
. O

Review O
Security O
Tip O
Handling O
Destructive O
Malware O
# O
ST13-003 O
and O
evaluate O
their O
capabilities O
encompassing O
planning O
, O
preparation O
, O
detection O
, O
and O
response O
for O
such O
an O
event O
. O

Review O
Recommended O
Practices O
for O
Control O
Systems O
, O
and O
Improving O
Industrial O
Control O
Systems O
Cybersecurity O
with O
Defense-in-Depth O
Strategies O
( O
pdf O
) O
. O

The O
following O
is O
a O
list O
of O
the O
Indicators O
of O
Compromise O
( O
IOCs O
) O
that O
can O
be O
added O
to O
network O
security O
solutions O
to O
determine O
whether O
they O
are O
present O
on O
a O
network O
. O

The O
malware O
has O
the O
following O
characteristics O
: O
While O
the O
original O
filename O
of O
this O
file O
is O
unknown O
, O
it O
was O
likely O
'' O
diskpartmg16.exe O
'' O
. O

This B-Entity
file I-Entity
serves B-Action
as B-Modifier
a B-Entity
dropper I-Entity
. O

It B-Entity
drops B-Action
destructive B-Entity
malware I-Entity
: I-Entity
'' I-Entity
igfxtrayex.exe I-Entity
'' I-Entity
. O

When O
the B-Entity
dropper I-Entity
file I-Entity
was B-Action
executed I-Action
, O
it B-Entity
started B-Action
a B-Entity
second I-Entity
instance I-Entity
of I-Entity
itself I-Entity
with B-Modifier
'' B-Entity
-i I-Entity
'' I-Entity
as I-Entity
an I-Entity
argument I-Entity
, O
and O
then O
terminated B-Action
. O

The B-Entity
second I-Entity
instance I-Entity
of I-Entity
the I-Entity
dropper I-Entity
file I-Entity
installed B-Action
itself B-Entity
as B-Modifier
the B-Entity
'' I-Entity
WinsSchMgmt I-Entity
'' I-Entity
service I-Entity
with B-Modifier
'' B-Entity
-k I-Entity
'' I-Entity
as I-Entity
a I-Entity
command I-Entity
line I-Entity
argument I-Entity
, O
started B-Action
the B-Entity
service I-Entity
, O
and O
then O
terminated B-Action
. O

The B-Entity
'' I-Entity
WinsSchMgmt I-Entity
'' I-Entity
service I-Entity
executed B-Action
the B-Entity
file I-Entity
with B-Modifier
'' B-Entity
-k I-Entity
'' I-Entity
as I-Entity
an I-Entity
argument I-Entity
, O
which O
started B-Action
another B-Entity
instance I-Entity
of I-Entity
the I-Entity
file I-Entity
using B-Modifier
'' B-Entity
-s I-Entity
'' I-Entity
as I-Entity
an I-Entity
argument I-Entity
. O

The B-Entity
'' I-Entity
-s I-Entity
'' I-Entity
instance I-Entity
dropped B-Action
and O
executed B-Action
'' B-Entity
igfxtrayex.exe I-Entity
'' I-Entity
, O
created B-Action
'' B-Entity
netver.dat I-Entity
'' I-Entity
, O
and O
began O
generating B-Action
network B-Entity
traffic I-Entity
over B-Modifier
TCP B-Entity
ports I-Entity
445 I-Entity
and I-Entity
139 I-Entity
to B-Modifier
victim B-Entity
IP I-Entity
addresses I-Entity
. O

This O
is O
a B-Entity
log I-Entity
file I-Entity
created B-Action
by O
the B-Entity
dropper I-Entity
, O
and O
appended O
to O
as O
the O
scans O
progress O
. O

It O
contains O
what O
appear O
to O
be O
hostnames O
, O
IP O
addresses O
, O
and O
the O
number O
2 O
. O

Entries O
in O
the O
file O
have O
the O
structure O
'' O
HOSTNAME O
| O
IP O
Address O
| O
2 O
'' O
. O

This B-Entity
file I-Entity
is B-Action
destructive B-Entity
malware I-Entity
: O
a O
disk O
wiper O
with O
network O
beacon O
capabilities O
. O

If O
'' O
igfxtrayex.exe O
'' O
is O
run O
with O
no O
parameters O
, O
it B-Entity
creates B-Action
and O
starts B-Action
a B-Entity
copy I-Entity
of I-Entity
itself I-Entity
with B-Modifier
the B-Entity
'' I-Entity
–i I-Entity
'' I-Entity
argument I-Entity
. O

After O
10 O
minutes O
, O
the B-Entity
'' I-Entity
igfxtrayex.exe I-Entity
'' I-Entity
makes B-Action
three B-Entity
copies I-Entity
of I-Entity
itself I-Entity
and O
places O
them O
in O
the O
same O
directory O
from O
which O
it O
was O
executed O
. O

These O
copies O
are O
named O
according O
to O
the O
format O
'' O
taskhostXX.exe O
'' O
( O
where O
X O
is O
a O
randomly O
generated O
ASCII O
character O
) O
. O

These B-Entity
copies I-Entity
are B-Action
then I-Action
executed I-Action
, O
each O
with O
a O
different O
argument O
( O
one O
being O
'' O
-m O
'' O
, O
one O
being O
'' O
-d O
'' O
and O
the O
other O
'' O
-w O
'' O
) O
. O

Network B-Entity
connection I-Entity
attempts I-Entity
are B-Action
made I-Action
to B-Modifier
one B-Entity
of I-Entity
three I-Entity
hard-coded I-Entity
IP I-Entity
addresses I-Entity
in B-Modifier
a B-Entity
random I-Entity
order I-Entity
to B-Modifier
port B-Entity
8080 I-Entity
or I-Entity
8000 I-Entity
. O

If O
a O
connection O
to O
the O
IP O
address O
can O
not O
be O
made O
, O
it B-Entity
attempts O
to O
connect B-Action
to B-Modifier
another B-Entity
of I-Entity
the I-Entity
three I-Entity
IP I-Entity
addresses I-Entity
, O
until B-Modifier
connections B-Entity
to I-Entity
all I-Entity
three I-Entity
IP I-Entity
addresses I-Entity
have I-Entity
been I-Entity
attempted I-Entity
. O

The O
following O
command-line O
string O
is O
then O
executed O
: O
'' O
cmd.exe O
/c O
net O
stop O
MSExchangeIS O
/y O
'' O
. O

A B-Entity
120-minute I-Entity
( I-Entity
2 I-Entity
hour I-Entity
) I-Entity
sleep I-Entity
command I-Entity
is B-Action
issued I-Action
after O
which O
the B-Entity
computer I-Entity
is B-Action
shut I-Action
down I-Action
and I-Action
rebooted I-Action
. O

This B-Entity
file I-Entity
, O
when O
executed O
, O
starts B-Action
a B-Entity
listener I-Entity
on B-Modifier
localhost B-Entity
port I-Entity
80 I-Entity
. O

It O
has O
3 O
files O
contained O
in O
the O
resource O
section O
; O
all B-Entity
xor B-Action
'd I-Action
with B-Modifier
0x63 B-Entity
. O

This O
SYS O
file O
is O
a O
commercially O
available O
tool O
that O
allows O
read/write O
access O
to O
files O
and O
raw O
disk O
sectors O
for O
user O
mode O
applications O
in O
Windows O
2000 O
, O
XP O
, O
2003 O
, O
Vista O
, O
2008 O
( O
32-bit O
) O
. O

It B-Entity
is B-Action
dropped I-Action
from B-Modifier
resource B-Entity
ID I-Entity
0x81 I-Entity
of I-Entity
'' I-Entity
igfxtrayex.exe I-Entity
'' I-Entity
. O

This O
SYS O
file O
is O
a O
also O
a O
commercially O
available O
tool O
that O
allows O
read/write O
access O
to O
files O
and O
raw O
disk O
sectors O
for O
user O
mode O
applications O
in O
Windows O
2000 O
, O
XP O
, O
2003 O
, O
Vista O
, O
2008 O
( O
64-bit O
) O
. O

It B-Entity
is B-Action
dropped I-Action
from B-Modifier
resource B-Entity
ID I-Entity
0x83 I-Entity
of I-Entity
'' I-Entity
igfxtrayex.exe I-Entity
'' I-Entity
. O

A O
summary O
of O
the O
C2 O
IP O
addresses O
: O
Snort O
signatures O
: O
Listening O
Implant O
: O
Lightweight O
Backdoor O
: O
Proxy O
Tool O
: O
Malware O
associated O
with O
the O
cyber O
threat O
actor O
: O
Below O
are O
potential O
YARA O
signatures O
to O
detect O
malware O
binaries O
on O
host O
machines O
: O
Because O
of O
the O
highly O
destructive O
functionality O
of O
the O
malware O
, O
an O
organization O
infected O
with O
the O
malware O
could O
experience O
operational O
impacts O
including O
loss O
of O
intellectual O
property O
( O
IP O
) O
and O
disruption O
of O
critical O
systems O
. O

Actual O
impact O
to O
organizations O
may O
vary O
depending O
on O
the O
type O
and O
number O
of O
systems O
impacted O
. O

Implement O
the O
indicators O
of O
compromise O
within O
your O
systems O
for O
detection O
and O
mitigation O
purposes O
. O

Encourage O
users O
to O
transfer O
critical O
files O
to O
network O
shares O
, O
to O
allow O
for O
central O
backed O
up O
. O

Execute O
daily O
backups O
of O
all O
critical O
systems O
. O

Periodically O
execute O
an O
'' O
offline O
'' O
backup O
of O
critical O
files O
to O
removable O
media O
. O

Establish O
emergency O
communications O
plans O
should O
network O
resources O
become O
unavailable O
. O

Isolate O
any O
critical O
networks O
( O
including O
operations O
networks O
) O
from O
business O
systems O
. O

Identify O
critical O
systems O
and O
evaluate O
the O
need O
for O
having O
on-hand O
spares O
to O
quickly O
restore O
service O
. O

Ensure O
antivirus O
is O
up O
to O
date O
. O

Disable O
credential O
caching O
for O
all O
desktop O
devices O
with O
particular O
importance O
on O
critical O
systems O
such O
as O
servers O
and O
restrict O
the O
number O
of O
cached O
credential O
for O
all O
portable O
devices O
to O
no O
more O
than O
three O
if O
possible O
. O

This O
can O
be O
accomplished O
through O
a O
Group O
Policy O
Object O
( O
GPO O
) O
. O

Disable O
AutoRun O
and O
Autoplay O
for O
any O
removable O
media O
device O
. O

Prevent O
or O
limit O
the O
use O
of O
all O
removable O
media O
devices O
on O
systems O
to O
limit O
the O
spread O
or O
introduction O
of O
malicious O
software O
and O
possible O
exfiltration O
data O
, O
except O
where O
there O
is O
a O
valid O
business O
case O
for O
use O
. O

This O
business O
case O
must O
be O
approved O
by O
the O
organization O
Chief O
IT O
Security O
Officer O
, O
with O
policy/guidance O
on O
how O
such O
media O
should O
be O
used O
. O

Consider O
restricting O
account O
privileges O
. O

It O
is O
our O
recommendation O
that O
all O
daily O
operations O
should O
be O
executed O
using O
standard O
user O
accounts O
unless O
administrative O
privileges O
are O
required O
for O
that O
specific O
function O
. O

Configure O
all O
standard O
user O
accounts O
to O
prevent O
the O
execution O
and O
installation O
of O
any O
unknown O
or O
unauthorized O
software O
. O

Both O
standard O
and O
administrative O
accounts O
should O
have O
access O
only O
to O
services O
required O
for O
nominal O
daily O
duties O
, O
enforcing O
the O
concept O
of O
separation O
of O
duties O
. O

Lastly O
, O
disable O
Web O
and O
email O
capabilities O
on O
administrative O
accounts O
. O

Compromise O
of O
admin O
accounts O
is O
one O
vector O
that O
allows O
malicious O
activity O
to O
become O
truly O
persistent O
in O
a O
network O
environment O
. O

Ensure O
that O
password O
policy O
rules O
are O
enforced O
and O
Admin O
password O
values O
are O
changed O
periodically O
. O

Consider O
prohibiting O
hosts O
within O
the O
production O
environment O
or O
DMZ O
from O
sharing O
an O
Active O
Directory O
enterprise O
with O
hosts O
on O
other O
networks O
. O

Each O
environment O
should O
have O
separate O
forests O
within O
Active O
Directory O
, O
with O
no O
trust O
relationships O
allowed O
between O
the O
forests O
if O
at O
all O
possible O
. O

If O
necessary O
, O
the O
trust O
relationships O
should O
be O
one-way O
with O
the O
low O
integrity O
environment O
trusting O
the O
higher O
integrity O
environment O
. O

Consider O
deployment O
of O
a O
coaching O
page O
with O
click O
through O
acceptance O
; O
these O
are O
traditionally O
deployed O
in O
an O
environment O
to O
log O
the O
acceptance O
of O
network O
acceptable O
use O
policy O
or O
to O
notify O
users O
of O
monitoring O
. O

Coaching O
pages O
also O
provide O
some O
measure O
of O
protection O
from O
automated O
malicious O
activity O
. O

This O
occurs O
because O
automated O
malware O
is O
normally O
incapable O
of O
physically O
clicking O
an O
acceptance O
radial O
button O
. O

Automated O
malware O
is O
traditionally O
hardcoded O
to O
execute O
, O
then O
retrieve O
commands O
or O
additional O
executables O
from O
the O
Internet O
. O

If O
the O
malware O
is O
unable O
to O
initiate O
an O
active O
connection O
, O
the O
full O
train O
of O
infection O
is O
potentially O
halted O
. O

The O
danger O
still O
exists O
that O
the O
physical O
user O
will O
authorize O
access O
, O
but O
through O
the O
use O
of O
coaching O
pages O
, O
infections O
can O
be O
limited O
or O
at O
least O
the O
rate O
of O
infection O
reduced O
. O

Monitor O
logs O
-- O
Maintain O
and O
actively O
monitor O
a O
centralized O
logging O
solution O
that O
keeps O
track O
of O
all O
anomalous O
and O
potentially O
malicious O
activity O
. O

Ensure O
that O
all O
network O
operating O
systems O
, O
web O
browsers O
, O
and O
other O
related O
network O
hardware O
and O
software O
remain O
updated O
with O
all O
current O
patches O
and O
fixes O
. O

Organizations O
should O
review O
Security O
Tip O
Handling O
Destructive O
Malware O
# O
ST13-003 O
and O
evaluate O
their O
capabilities O
encompassing O
planning O
, O
preparation O
, O
detection O
, O
and O
response O
for O
such O
an O
event O
. O

Always O
keep O
your O
patch O
levels O
up O
to O
date O
, O
especially O
on O
computers O
that O
host O
public O
services O
accessible O
through O
the O
firewall O
, O
such O
as O
HTTP O
, O
FTP O
, O
mail O
, O
and O
DNS O
services O
. O

Build O
host O
systems O
, O
especially O
critical O
systems O
such O
as O
servers O
, O
with O
only O
essential O
applications O
and O
components O
required O
to O
perform O
the O
intended O
function O
. O

Any O
unused O
applications O
or O
functions O
should O
be O
removed O
or O
disabled O
, O
if O
possible O
, O
to O
limit O
the O
attack O
surface O
of O
the O
host O
. O

Implement O
network O
segmentation O
through O
V-LANs O
to O
limit O
the O
spread O
of O
malware O
. O

Consider O
the O
deployment O
of O
Software O
Restriction O
Policy O
set O
to O
only O
allow O
the O
execution O
of O
approved O
software O
( O
application O
whitelisting O
) O
. O

Recommend O
the O
whitelisting O
of O
legitimate O
executable O
directories O
to O
prevent O
the O
execution O
of O
potentially O
malicious O
binaries O
. O

Consider O
the O
use O
of O
two-factor O
authentication O
methods O
for O
accessing O
privileged O
root O
level O
accounts O
or O
systems O
. O

Consider O
deploying O
a O
two-factor O
authentication O
through O
a O
hardened O
IPsec/VPN O
gateway O
with O
split-tunneling O
prohibited O
for O
secure O
remote O
access O
. O

Deny O
direct O
Internet O
access O
, O
except O
through O
the O
use O
of O
proxies O
for O
Enterprise O
servers O
and O
workstations O
. O

Perform O
regular O
content O
filtering O
at O
the O
proxies O
or O
external O
firewall O
points O
of O
presence O
. O

Also O
consider O
the O
deployment O
of O
an O
explicit O
versus O
transparent O
proxy O
policy O
. O

Implement O
a O
Secure O
Socket O
Layer O
( O
SSL O
) O
inspection O
capability O
to O
inspect O
both O
ingress O
and O
egress O
encrypted O
network O
traffic O
for O
potential O
malicious O
activity O
. O

Isolate O
network O
services O
, O
such O
as O
email O
and O
Web O
application O
servers O
by O
utilizing O
a O
secure O
multi-tenant O
virtualization O
technology O
. O

This O
will O
limit O
the O
damage O
sustained O
from O
a O
compromise O
or O
attack O
of O
a O
single O
network O
component O
. O

Implement O
best O
practice O
guidance O
and O
policy O
to O
restrict O
the O
use O
of O
non-Foundation O
assets O
for O
processing O
or O
accessing O
Foundation-controlled O
data O
or O
systems O
( O
e.g. O
, O
working O
from O
home O
, O
or O
using O
a O
personal O
device O
while O
at O
the O
office O
) O
. O

It O
is O
difficult O
to O
enforce O
corporate O
policies O
, O
detect O
intrusions O
, O
and O
conduct O
forensic O
analysis O
or O
remediate O
compromises O
on O
non-corporate O
owned O
devices O
. O

Minimize O
network O
exposure O
for O
all O
control O
system O
devices O
. O

Control O
system O
devices O
should O
not O
directly O
face O
the O
Internet O
. O

Place O
control O
system O
networks O
behind O
firewalls O
, O
and O
isolate O
or O
air O
gap O
them O
from O
the O
business O
network O
. O

When O
remote O
access O
is O
required O
, O
use O
secure O
methods O
, O
such O
as O
Virtual O
Private O
Networks O
( O
VPNs O
) O
, O
recognizing O
that O
VPN O
is O
only O
as O
secure O
as O
the O
connected O
devices O
. O

Industrial O
Control O
System O
( O
ICS O
) O
-CERT O
and O
US-CERT O
remind O
organizations O
to O
perform O
proper O
impact O
analysis O
and O
risk O
assessment O
prior O
to O
taking O
defensive O
measures O
. O

N/A O
December O
19 O
, O
2014 O
: O
Initial O
Release O
APT3 O
( O
also O
known O
as O
UPS O
) O
, O
the B-Entity
actors I-Entity
responsible I-Entity
for I-Entity
Operation I-Entity
Clandestine I-Entity
Fox I-Entity
has O
quietly O
continued O
to O
send B-Action
waves B-Entity
of I-Entity
spearphishing I-Entity
messages I-Entity
over B-Modifier
the B-Entity
past I-Entity
few I-Entity
months I-Entity
. O

This O
actor O
initiated O
their O
most O
recent O
campaign O
on O
November O
19 O
, O
2014 O
targeting O
multiple O
organizations O
. O

The O
attacker O
leveraged O
multiple O
exploits O
, O
targeting O
both O
CVE-2014-6332 O
and O
CVE-2014-4113 O
. O

CVE-2014-6332 B-Entity
was O
disclosed O
publicly O
on O
2014-11-11 O
and O
is B-Action
a B-Entity
Windows I-Entity
OLE I-Entity
Automation I-Entity
Array I-Entity
Remote I-Entity
Code I-Entity
Execution I-Entity
vulnerability I-Entity
. O

CVE-2014- B-Entity
4113 I-Entity
is B-Action
a B-Entity
privilege I-Entity
escalation I-Entity
vulnerability I-Entity
that O
was O
disclosed O
publicly O
on O
2014-10-14 O
. O

The O
use O
of O
CVE-2014-6332 O
is O
notable O
, O
as O
it O
demonstrates O
that O
multiple O
classes O
of O
actors O
, O
both O
criminal O
and O
APT O
alike O
, O
have O
now O
incorporated O
this O
exploit O
into O
their O
toolkits O
. O

Further O
, O
the O
use O
of O
both O
of O
these O
two O
known O
vulnerabilities O
in O
tandem O
is O
notable O
for O
APT3 O
. O

This O
actor O
is O
historically O
known O
for O
leveraging O
zero- O
day O
vulnerabilities O
in O
widespread O
but O
infrequent O
phishing O
campaigns O
. O

The O
use O
of O
known O
exploits O
and O
more O
frequent O
attacks O
may O
indicate O
both O
a O
shift O
in O
strategy O
and O
operational O
tempo O
for O
this O
group O
. O

The O
body O
of O
the O
message O
is O
below O
: O
One O
Month O
's O
Free O
Membership O
for O
The O
PLAYBOY O
ClUB O
1080P O
HD O
VIDEOS O
100,000 O
PHOTOS O
4,000 O
MODELS O
Nude O
Celebrities O
, O
Playmates O
, O
Cybergirls O
& O
More O
! O
Click O
hxxp O
: O
//join.playboysplus.com/signup/ O
To O
Get O
a O
Free O
Plus O
Member O
Now O
& O
Never O
Miss O
Another O
Update O
. O

Your O
Member O
referrals O
must O
remain O
active O
. O

If O
anyone O
getting O
'' O
Promotion O
not O
available O
'' O
for O
1 O
month O
free O
membership O
, O
you O
might O
get O
the O
issue O
up O
to O
48 O
hrs O
once O
your O
membership O
is O
expired O
and O
make O
sure O
to O
Clear O
out O
cookies O
or O
use O
another O
browser O
or O
use O
another O
PC O
. O

The O
webpage O
contained O
both O
CVE-2014-6332 O
exploit O
code O
and O
a B-Entity
VBScript I-Entity
that O
invoked O
PowerShell O
on O
the O
affected O
users O
' O
system O
to O
download B-Action
the B-Entity
below I-Entity
payload I-Entity
: O
The O
CVE-2014-6332 O
exploit O
code O
seen O
in O
this O
incident O
is O
derived O
from O
the O
code O
published O
at O
http O
: O
//www.exploit-db.com/exploits/35230/ O
, O
which O
has O
also O
been O
incorporated O
in O
the O
Metasploit O
project O
. O

After O
the O
exploit O
or O
script O
executes O
, O
the B-Entity
system I-Entity
downloads B-Action
install.exe B-Entity
, O
which O
has O
the O
following O
metadata O
: O
The B-Entity
file I-Entity
install.exe I-Entity
attempts O
to O
write B-Action
two B-Entity
files I-Entity
( I-Entity
doc.exe I-Entity
and I-Entity
test.exe I-Entity
) I-Entity
to B-Modifier
the B-Entity
hard-coded I-Entity
path I-Entity
'' I-Entity
C I-Entity
: I-Entity
\Users\Public I-Entity
'' I-Entity
, O
which O
fails O
on O
Windows O
XP O
because O
that O
path O
is O
not O
present O
by O
default O
. O

The B-Entity
first I-Entity
dropped I-Entity
file I-Entity
, I-Entity
doc.exe I-Entity
, O
contains B-Action
the B-Entity
CVE-2014-4113 I-Entity
exploit I-Entity
and O
then O
attempts O
to O
execute B-Action
test.exe B-Entity
with B-Modifier
the B-Entity
elevated I-Entity
privileges I-Entity
. O

These O
files O
have O
the O
following O
metadata O
: O
These O
payload O
files O
also O
have O
interesting O
PDB O
debug O
strings O
. O

The O
most O
interesting O
PDB O
string O
is O
the O
'' O
4113.pdb O
, O
'' O
which O
appears O
to O
reference O
CVE-2014-4113 O
. O

This B-Entity
CVE I-Entity
is O
a O
local O
kernel O
vulnerability O
that O
, O
with O
successful O
exploitation O
, O
would O
give B-Action
any B-Entity
user I-Entity
SYSTEM B-Entity
access I-Entity
on I-Entity
the I-Entity
machine I-Entity
. O

The B-Entity
malware I-Entity
component I-Entity
, I-Entity
test.exe I-Entity
, O
uses B-Action
the B-Entity
Windows I-Entity
command I-Entity
'' I-Entity
cmd.exe I-Entity
'' I-Entity
/C I-Entity
whoami I-Entity
'' I-Entity
to B-Modifier
verify B-Entity
it I-Entity
is I-Entity
running I-Entity
with I-Entity
the I-Entity
elevated I-Entity
privileges I-Entity
of I-Entity
'' I-Entity
System I-Entity
'' I-Entity
and O
creates B-Action
persistence B-Entity
by B-Modifier
creating B-Entity
the I-Entity
following I-Entity
scheduled I-Entity
task I-Entity
: O
When O
executed O
, O
the B-Entity
malware I-Entity
first O
establishes B-Action
a B-Entity
SOCKS5 I-Entity
connection I-Entity
to B-Modifier
192.157.198.103 B-Entity
using B-Modifier
TCP B-Entity
port I-Entity
1913 I-Entity
. O

The B-Entity
malware I-Entity
sends B-Action
the B-Entity
SOCKS5 I-Entity
connection I-Entity
request I-Entity
'' I-Entity
05 I-Entity
01 I-Entity
00 I-Entity
'' I-Entity
and O
verifies B-Action
the B-Entity
server I-Entity
response I-Entity
starts I-Entity
with I-Entity
'' I-Entity
05 I-Entity
00 I-Entity
'' I-Entity
. O

The B-Entity
malware I-Entity
then O
requests B-Action
a B-Entity
connection I-Entity
to I-Entity
192.184.60.229 I-Entity
on I-Entity
TCP I-Entity
port I-Entity
81 I-Entity
using B-Modifier
the B-Entity
command I-Entity
'' I-Entity
05 I-Entity
01 I-Entity
00 I-Entity
01 I-Entity
c0 I-Entity
b8 I-Entity
3c I-Entity
e5 I-Entity
00 I-Entity
51 I-Entity
'' I-Entity
and O
verifies B-Action
that B-Modifier
the B-Entity
first I-Entity
two I-Entity
bytes I-Entity
from I-Entity
the I-Entity
server I-Entity
are I-Entity
'' I-Entity
05 I-Entity
00 I-Entity
'' I-Entity
( O
c0 O
b8 O
3c O
e5 O
is O
the O
IP O
address O
and O
00 O
51 O
is O
the O
port O
in O
network O
byte O
order O
) O
. O

Once B-Modifier
the B-Entity
connection I-Entity
to I-Entity
the I-Entity
server I-Entity
is I-Entity
established I-Entity
, O
the B-Entity
malware I-Entity
expects B-Action
a B-Entity
message I-Entity
containing I-Entity
at I-Entity
least I-Entity
three I-Entity
bytes I-Entity
from I-Entity
the I-Entity
server I-Entity
. O

These O
first O
three O
bytes O
are O
the O
command O
identifier O
. O

The O
following O
commands O
are O
supported O
by O
the O
malware O
: O
On O
October O
28 O
, O
we O
observed O
APT3 B-Entity
sending B-Action
out B-Modifier
spearphishing B-Entity
messages I-Entity
containing I-Entity
a I-Entity
compressed I-Entity
executable I-Entity
attachment I-Entity
. O

The B-Entity
deflated I-Entity
exe I-Entity
was B-Action
a B-Entity
variant I-Entity
of I-Entity
the I-Entity
same I-Entity
downloader I-Entity
described I-Entity
above I-Entity
and O
connected B-Action
to B-Modifier
198.55.115.71 B-Entity
over B-Modifier
port B-Entity
1913 I-Entity
via B-Modifier
SOCKS5 B-Entity
proxy I-Entity
. O

The B-Entity
secondary I-Entity
payload I-Entity
in O
that O
case O
was B-Action
detected I-Action
as B-Modifier
Backdoor.APT.CookieCutter B-Entity
( I-Entity
aka I-Entity
Pirpi I-Entity
) I-Entity
and O
also O
named O
newnotepad.exe O
( O
MD5 O
8849538ef1c3471640230605c2623c67 O
) O
and O
connected B-Action
to B-Modifier
the B-Entity
known I-Entity
APT3 I-Entity
domains I-Entity
: O
The O
192.184.60.229 O
IP O
address O
seen O
in O
this O
current O
campaign O
also O
hosts O
securitywap O
[ O
. O

] O
com O
– O
another O
known O
domain O
referenced O
in O
our O
Operation O
Clandestine O
Fox O
blog O
. O

In O
addition O
, O
the O
join.playboysplus O
[ O
. O

] O
com O
exploit O
and O
payload O
delivery O
site O
resolves O
to O
104.151.248.173 O
. O

This O
IP O
has O
hosted O
other O
domains O
used O
by O
APT3 O
in O
past O
campaigns O
: O
As O
we O
discussed O
in O
our O
previous O
blog O
detailing O
previous O
APT3 O
activity O
, O
the B-Entity
walterclean I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
served B-Action
as B-Modifier
a B-Entity
Plugx/Kaba I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O

Although O
APT3 O
is O
well O
known O
for O
employing O
zero-day O
exploits O
in O
their O
attacks O
, O
recent O
activity O
has O
demonstrated O
that O
they B-Entity
will O
also O
attack B-Action
targets B-Entity
with B-Modifier
known B-Entity
exploits I-Entity
or I-Entity
social I-Entity
engineering I-Entity
. O

Since O
Operation O
Clandestine O
Fox O
, O
we O
have O
observed O
this O
actor O
execute O
multiple O
attacks O
that O
did O
not O
rely O
on O
zero-day O
exploits O
. O

The O
combination O
of O
this O
sustained O
operational O
tempo O
and O
lack O
of O
zero-day O
exploits O
may O
indicate O
that O
this O
group O
has O
changed O
strategy O
and O
has O
decided O
to O
attack O
more O
frequently O
and O
does O
not O
have O
steady O
access O
to O
zero-day O
exploit O
code O
. O

No O
matter O
the O
strategy O
, O
this O
actor O
has O
shown O
an O
ability O
to O
operate O
successfully O
. O

IOCs O
for O
this O
threat O
can O
be O
found O
here O
. O

Downloaders O
, O
injectors O
, O
infostealers O
Example O
md5s O
of O
files O
detected O
with O
Kaspersky O
's O
Virus.Win32.Pioneer.dx O
and O
Symantec O
's O
Infostealer.Nemim O
! O
inf O
: O
To O
ensure B-Action
only B-Entity
single I-Entity
instance I-Entity
of I-Entity
the I-Entity
module I-Entity
is I-Entity
running I-Entity
, O
the B-Entity
module I-Entity
verifies O
if O
system O
mutex O
named O
«132DF6E» O
exists O
. O

If O
it O
exists O
the O
module O
exits O
, O
if O
not O
­the O
module O
creates O
one O
. O

The B-Entity
module I-Entity
implements B-Action
a B-Entity
method I-Entity
to B-Modifier
resist B-Entity
running I-Entity
in I-Entity
virtual I-Entity
environment I-Entity
. O

It B-Entity
gets B-Action
CPU B-Entity
name I-Entity
and I-Entity
identifier I-Entity
from B-Modifier
the B-Entity
registry I-Entity
at I-Entity
HKLM\HARDWARE\DESCRIPTION\ I-Entity
System\CentralProcessor\0 I-Entity
and O
collects B-Action
IP B-Entity
and I-Entity
MAC I-Entity
addresses I-Entity
of I-Entity
local I-Entity
network I-Entity
adapters I-Entity
. O

After O
that O
it O
compiles O
a O
string O
describing O
the O
system O
in O
the O
following O
format O
: O
« O
C O
P O
U O
: O
% O
CPUNAME O
% O
< O
br O
> O
Net O
card O
: O
% O
IP O
% O
( O
% O
MACADDR O
% O
) O
< O
br O
> O
» O
. O

Next O
it O
checks O
if O
this O
string O
contains O
one O
of O
the O
following O
substrings O
: O
If O
any O
of O
these O
strings O
is O
found O
, O
the O
module O
terminates O
. O

After O
that O
, O
there O
is O
a O
hardcoded O
value O
of O
10 O
, O
which O
delays O
further O
execution O
of O
the O
module O
for O
10 O
seconds O
. O

Then O
the B-Entity
module I-Entity
attempts O
to O
delete B-Action
some B-Entity
other I-Entity
, I-Entity
prob- I-Entity
ably I-Entity
older I-Entity
, I-Entity
components I-Entity
which I-Entity
might I-Entity
be I-Entity
present I-Entity
on I-Entity
the I-Entity
system I-Entity
. O

The O
list O
of O
deleted O
files O
includes O
the O
following O
: O
The O
next O
is O
step O
is O
to O
check B-Action
if B-Entity
current I-Entity
directory I-Entity
has I-Entity
a I-Entity
file I-Entity
named I-Entity
«U» I-Entity
. O

If O
not O
, O
the O
module O
proceeds O
with O
network O
communication O
routine O
. O

But O
if O
this O
file O
is O
found O
it O
does O
some O
additional O
checks O
. O

If O
«U» O
file O
is O
older O
than O
180 O
days O
, O
the B-Entity
module I-Entity
wipes B-Action
the B-Entity
file I-Entity
. O

If O
not O
, O
it O
triggers O
a B-Entity
special I-Entity
variable I-Entity
that O
makes B-Action
module B-Entity
dormant B-Entity
and O
dis- O
ables O
further O
communication O
with O
C O
& O
C O
server O
. O

After O
all O
, O
if O
the O
module O
is O
ready O
and O
allowed O
to O
communicate O
with O
C O
& O
C O
server O
it O
does O
that O
in O
the O
following O
manner O
. O

1 O
. O

The B-Entity
module I-Entity
connects B-Action
to B-Modifier
autolace.twilightparadox.com B-Entity
( I-Entity
or I-Entity
automachine I-Entity
. I-Entity
servequake.com I-Entity
) I-Entity
and O
issues B-Action
a B-Entity
HTTP I-Entity
GET I-Entity
request I-Entity
with B-Modifier
hardcoded B-Entity
User­Agent I-Entity
string I-Entity
: O
The O
server O
response O
should O
contain O
«DEXT87» B-Entity
string I-Entity
which O
is B-Action
used I-Action
to B-Modifier
rec- B-Entity
ognize I-Entity
valid I-Entity
response I-Entity
. O

The O
malware O
locates O
«DEXT87» O
and O
reads O
the O
data O
appended O
to O
it O
. O

The O
appended O
data O
should O
be O
an O
IP O
address O
in O
plaintext O
. O

This O
is O
used O
a O
real O
C O
& O
C O
IP O
address O
. O

Reading O
stops O
when O
non­digit O
or O
dot O
symbol O
is O
found O
. O

Here O
is O
an O
example O
of O
shortest O
possible O
valid O
server O
response O
: O
2 O
. O

If O
the O
real O
C O
& O
C O
IP O
address O
is O
not O
valid O
the B-Entity
module I-Entity
may O
try O
to O
send B-Action
identical B-Entity
request I-Entity
again B-Entity
but O
using B-Modifier
a B-Entity
different I-Entity
HTTP I-Entity
path I-Entity
: O
If O
the O
C O
& O
C O
IP O
address O
is O
valid O
, O
the B-Entity
module I-Entity
issues B-Action
another B-Entity
HTTP I-Entity
request I-Entity
: O
The O
server O
response O
can O
be O
one O
of O
the O
following O
: O
Where O
< O
DATASIZE O
> O
is O
a O
decimal O
integer O
that O
represents O
length O
of O
< O
DATA O
> O
field O
in O
bytes; O
< O
DATA O
> O
is O
a O
binary O
data O
separated O
from O
< O
DATASIZE O
> O
field O
by O
semicolon O
. O

Please O
note O
, O
that O
after O
receiving O
< O
DATA O
> O
, O
it B-Entity
is B-Action
XORed I-Action
with B-Modifier
byte B-Entity
value I-Entity
0x55 I-Entity
and O
saved B-Action
to B-Modifier
a B-Entity
disk I-Entity
in B-Modifier
a B-Entity
file I-Entity
named I-Entity
«ctfmon.exe» I-Entity
( O
current O
directory O
is O
used O
) O
. O

Upon O
successful O
receiving O
of O
the O
file O
it O
is O
started O
in O
a O
new O
process O
. O

This O
module O
is O
relatively O
large O
( O
455Kb O
) O
and O
comes O
as O
a O
part O
of O
WinRar B-Entity
SFX I-Entity
file I-Entity
that O
drops B-Action
and O
starts B-Action
the B-Entity
module I-Entity
from B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\Microsoft\Display\DmaUp3 I-Entity
. I-Entity
exe I-Entity
. O

The O
main O
purpose O
of O
the B-Entity
module I-Entity
is O
to O
collect B-Action
various B-Entity
secrets I-Entity
stored I-Entity
on I-Entity
a I-Entity
local I-Entity
system I-Entity
. O

This O
module O
is O
designed O
not O
to O
run O
on O
Windows O
with O
system O
default O
codepage O
set O
to O
Korean O
. O

From O
the O
very O
beginning O
this B-Entity
module I-Entity
checks B-Action
if B-Entity
«bdagent.exe» I-Entity
process I-Entity
is I-Entity
running I-Entity
on I-Entity
current I-Entity
system I-Entity
. O

Bdagent.exe O
is O
a O
name O
for O
BitDefender O
Antivirus O
component O
. O

If O
it O
is O
running O
, O
it B-Entity
uses B-Action
simple B-Entity
AV I-Entity
heuristics I-Entity
evasion I-Entity
technique I-Entity
. O

The B-Entity
code I-Entity
starts B-Action
a B-Entity
thread I-Entity
that I-Entity
simulates I-Entity
keystrokes I-Entity
of I-Entity
ESC I-Entity
keyboard I-Entity
key I-Entity
and I-Entity
then I-Entity
shows I-Entity
a I-Entity
system I-Entity
modal I-Entity
message I-Entity
box I-Entity
. O

Pushing O
ESC O
key O
closes O
the O
modal O
message O
box O
. O

Right O
after O
that O
keystroke B-Entity
generation I-Entity
thread I-Entity
is B-Action
terminated I-Action
and O
the O
module O
continues O
normal O
execution O
as O
if O
«bdagent.exe» O
was O
not O
running O
. O

Next O
the B-Entity
module I-Entity
makes B-Action
sure I-Action
only B-Entity
one I-Entity
instance I-Entity
of I-Entity
current I-Entity
code I-Entity
is I-Entity
running I-Entity
by B-Modifier
checking B-Entity
if I-Entity
system I-Entity
mutex I-Entity
object I-Entity
named I-Entity
«920111215» I-Entity
exists I-Entity
. O

After O
that O
, O
the B-Entity
mod- I-Entity
ule I-Entity
collects B-Action
information B-Entity
about I-Entity
current I-Entity
system I-Entity
which I-Entity
includes I-Entity
the I-Entity
following I-Entity
: O
If O
the O
module O
reveals O
that O
current O
System O
default O
codepage O
is O
0412 O
( O
Korean O
) O
it O
terminates O
. O

There O
is O
one O
interesting O
specifics O
in O
Microsoft O
IntelliForms O
which O
reveals O
attack- O
er O
's O
interests O
. O

IntelliForms O
technology O
keeps O
login/password O
information O
in O
the O
registry O
in O
encrypted O
form O
. O

However O
, O
there O
is O
no O
clear O
information O
about O
the O
corre- O
sponding O
website O
which O
requires O
given O
login O
and O
password O
. O

The O
only O
information O
Intelliforms O
offers O
about O
the O
place O
where O
given O
login/password O
should O
be O
used O
is O
a O
hash O
of O
the O
webpage O
URL O
. O

So O
far O
, O
the B-Entity
attackers I-Entity
can O
steal B-Action
logins B-Entity
and I-Entity
pass- I-Entity
words I-Entity
but O
to O
understand O
where O
they O
are O
from O
they O
must O
guess O
the O
string O
which O
produced O
given O
hash O
. O

They O
have O
implemented O
this O
logics O
in O
the O
malware O
. O

When O
IntelliForms B-Entity
information I-Entity
is B-Action
stolen I-Action
the O
malware O
tries O
to O
check O
the O
list O
of O
known O
login O
page O
URLs O
to O
recover O
the O
originating O
webpage O
address O
. O

Here O
is O
the O
list O
of O
URLs O
that O
are O
checked O
by O
the O
malware O
: O
The O
list O
of O
targeted O
services O
includes O
some O
local O
services O
specifically O
popular O
in O
: O
The B-Entity
module I-Entity
uses B-Action
several B-Entity
simple I-Entity
XOR­based I-Entity
algorithms I-Entity
to B-Modifier
encrypt B-Entity
embedded I-Entity
string I-Entity
data I-Entity
. O

String O
encryption/decryption O
functions O
use O
the O
following O
keys O
: O
The O
module O
works O
with O
all O
Firefox O
versions O
prior O
to O
Mozilla O
Firefox O
12.0 O
. O

Depend- O
ing O
on O
version O
of O
Firefox O
, O
it O
can O
read O
Firefox O
database O
directly O
to O
dump O
stored O
se- O
crets O
or O
utilize O
one O
Firefox O
libraries O
to O
access O
the O
configuration O
data O
. O

In O
addition O
it O
makes O
use O
of O
the O
following O
Mozilla O
Firefox O
libraries O
depending O
on O
Firefox O
version O
: O
When O
stealing B-Action
secrets B-Entity
from B-Modifier
Firefox B-Entity
and I-Entity
Chrome I-Entity
it B-Entity
uses O
built­in O
SQLite O
library O
code O
. O

The O
module O
is O
linked O
with O
SQLite O
version O
3.7.5 O
release O
candidate O
2 O
, O
release O
hash O
ed759d5a9edb3bba5f48f243df47be29e3fe8cd7 O
dated O
as O
2011­01­28 O
17:03:50 O
. O

After O
stealing B-Action
secrets B-Entity
from B-Modifier
local B-Entity
system I-Entity
the B-Entity
malware I-Entity
executes B-Action
some B-Entity
kind I-Entity
of I-Entity
embedded I-Entity
script I-Entity
. O

It B-Entity
is B-Action
logging I-Action
all B-Entity
actions I-Entity
to B-Modifier
inform B-Entity
the I-Entity
operator I-Entity
what I-Entity
exactly I-Entity
was I-Entity
executed I-Entity
by I-Entity
this I-Entity
variant I-Entity
of I-Entity
the I-Entity
malware I-Entity
. O

The B-Entity
result I-Entity
of I-Entity
this I-Entity
execution I-Entity
is O
appended O
to O
the O
stolen O
data O
and O
uploaded B-Action
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

The B-Entity
module I-Entity
uploads B-Action
all B-Entity
collected I-Entity
information I-Entity
to B-Modifier
one B-Entity
of I-Entity
the I-Entity
following I-Entity
URLs I-Entity
via B-Modifier
POST B-Entity
request I-Entity
: O
It O
's O
the O
first O
time O
we O
see O
.pn O

domain O
used O
in O
malware O
. O

This O
top O
level O
country O
code O
domain O
is O
quite O
exotic O
and O
is O
assigned O
to O
Pitcairn O
Islands O
, O
which O
is O
Overseas O
ter- O
ritory O
of O
the O
United O
Kingdom O
in O
the O
Pacific O
. O

As O
of O
2013 O
estimated O
population O
of O
Pitcairn O
Islands O
is O
only O
56 O
people O
. O

An O
official O
.pn O

domain O
costs O
$ O
100/year O
from O
the O
registry O
, O
however O
.eu.pn O

domains O
seem O
to O
be O
given O
away O
for O
free O
. O

The O
malware O
uses O
fixed O
User­Agent O
string O
: O
The B-Entity
data I-Entity
is B-Action
uploaded I-Action
as B-Modifier
a B-Entity
POST I-Entity
request I-Entity
binary I-Entity
in B-Modifier
the B-Entity
following I-Entity
format I-Entity
: O
where O
< O
UserId O
> O
is O
hardcoded O
identifier O
( O
i.e O
. O

«user2» O
in O
current O
sample O
) O
; O
< O
UniqueMachineId O
> O
is O
a O
32 O
characters O
long O
hex O
string O
which O
derived O
from O
net- O
work O
card O
MAC O
address; O
< O
EncryptionKey O
> O
is O
symmetrical O
encryption O
key O
used O
to O
encrypt O
< O
UserId O
> O
and O
< O
GeneralSysInfo O
> O
values O
. O

The O
malware O
uses O
text O
protocol O
, O
which O
is O
why O
potentially O
binary O
values O
of O
< O
UserId O
> O
and O
< O
GeneralSysInfo O
> O
are O
ad- O
ditionally O
encoded O
using O
Base64 O
algorithm O
. O

< O
GeneralSysInfo O
> O
field O
contains O
only O
basic O
information O
about O
the O
system O
, O
i.e O
. O

: O
If O
the O
server O
reply O
contains O
a O
keyword O
«minmei» O
it B-Entity
continues O
sending B-Action
additional B-Entity
in- I-Entity
formation I-Entity
. O

«Minmei» O
may O
be O
a O
reference O
to O
a O
popular O
Japanese O
anime O
and O
manga O
known O
as O
«The O
Super O
Dimension O
Fortress O
Macross» O
. O

A O
quote O
from O
Wikipedia O
: O
«Born O
in O
Yokohama O
Chinatown O
, O
Japan O
( O
though O
she O
is O
of O
partial O
Chinese O
descent O
) O
as O
Linn O
Minmei O
, O
Minmay O
moved O
in O
with O
her O
uncle O
Shaochin O
( O
少江 O
) O
and O
aunt O
Feic- O
hun O
( O
慧中 O
) O
on O
South O
Ataria O
Island O
in O
hopes O
of O
finding O
the O
path O
to O
fulfill O
her O
dream O
of O
becoming O
a O
star.» O
The B-Entity
trojan I-Entity
iterates B-Action
through B-Modifier
running B-Entity
processes I-Entity
and O
looks B-Action
for B-Modifier
security B-Entity
software I-Entity
basing I-Entity
on I-Entity
executable I-Entity
filenames I-Entity
from I-Entity
the I-Entity
list I-Entity
below I-Entity
. O

If O
the O
process O
is O
found O
it O
keeps O
a O
record O
of O
the O
software O
name O
using O
short O
AV O
Identifier O
string O
from O
the O
fol- O
lowing O
table O
of O
rules O
The B-Entity
malware I-Entity
uses O
a O
trick O
to O
evade B-Action
running B-Entity
on I-Entity
a I-Entity
VMware I-Entity
. O

First O
, O
it B-Entity
checks B-Action
if B-Entity
cur- I-Entity
rent I-Entity
process I-Entity
is I-Entity
running I-Entity
in I-Entity
WOW64 I-Entity
environment I-Entity
. O

If O
yes O
it O
does O
additional O
port O
I/O O
specific O
to O
VMWare O
virtual O
machine O
( O
the O
VMware O
hypervisor O
port O
: O
0x5658; O
VMware O
hypervisor O
magic O
value O
: O
0x564D5868 O
) O
. O

Another B-Entity
method I-Entity
to O
detect B-Action
VM B-Entity
en- I-Entity
vironment I-Entity
is O
to O
check B-Action
local B-Entity
network I-Entity
adapter I-Entity
's I-Entity
IP I-Entity
address I-Entity
. O

If O
it O
belongs O
to O
subnet O
192.168.100 O
. O

* O
then O
the O
malware O
believes O
it O
's O
running O
in O
a O
VM O
. O

If B-Modifier
VM B-Entity
is I-Entity
detected I-Entity
the B-Entity
process I-Entity
instantly O
terminates B-Action
. O

Next O
the B-Entity
malware I-Entity
submits B-Action
collected B-Entity
information I-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
using B-Modifier
HTTP B-Entity
GET I-Entity
request I-Entity
and I-Entity
the I-Entity
following I-Entity
URL I-Entity
format I-Entity
: I-Entity
http I-Entity
: I-Entity
// I-Entity
< I-Entity
C2DOMAIN I-Entity
> I-Entity
/bin/readi.php I-Entity
? I-Entity
a1= I-Entity
% I-Entity
STEPID I-Entity
% I-Entity
& I-Entity
a2= I-Entity
% I-Entity
HOSTID I-Entity
% I-Entity
& I-Entity
a3= I-Entity
% I-Entity
SYSINFO I-Entity
% I-Entity
& I-Entity
a4= I-Entity
% I-Entity
AVSOFTID I-Entity
% I-Entity
, I-Entity
where I-Entity
% I-Entity
C2DOMAIN I-Entity
% I-Entity
is I-Entity
one I-Entity
of I-Entity
the I-Entity
following I-Entity
C I-Entity
& I-Entity
C I-Entity
domains I-Entity
: O
% O
STEPID O
% O
is O
special O
text O
string O
indicating O
stage O
of O
malware O
operation O
. O

This O
string O
varies O
depending O
on O
the O
local O
system O
language O
and O
may O
be O
one O
of O
the O
following O
: O
% O
HOSTID O
% O
is O
a O
special O
value O
generated O
from O
local O
network O
card O
MAC O
address; O
% O
SYSINFO O
% O
is O
a O
string O
with O
general O
system O
information O
( O
please O
see O
description O
above O
) O
; O
% O
AVSOFTID O
% O
is O
a O
string O
that O
contains O
indexes O
of O
AV O
software O
names O
in O
internal O
table O
of O
AV O
Identifiers O
( O
please O
see O
the O
table O
above O
) O
. O

Igfxext.exe B-Entity
can O
download B-Action
a B-Entity
file I-Entity
and O
drop B-Action
it B-Entity
to B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\microsoft\dis- I-Entity
play\ctfmon.exe I-Entity
( I-Entity
md5= I-Entity
e8bfb82b0dd5cef46116d61f62c25060 I-Entity
) I-Entity
. O

After O
execution O
, O
the B-Entity
downloaded I-Entity
file I-Entity
drops B-Action
SMAGENT.EXE B-Entity
( I-Entity
md5 I-Entity
0306f9ae- I-Entity
7786570139f78e78bc940597 I-Entity
) I-Entity
to B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\MICROSOFT\DISPLAY I-Entity
and O
ex- B-Action
ecutes I-Action
it B-Entity
. O

This B-Entity
component I-Entity
is O
a O
virus O
, O
and O
is O
used O
to O
selectively O
infiltrate B-Action
into B-Modifier
other B-Entity
computers I-Entity
via B-Modifier
USB B-Entity
or O
network B-Entity
shares I-Entity
. O

A O
large O
number O
of O
files O
are O
detected O
by O
Kaspersky O
Lab O
scanners O
as O
Virus.Win32 O
. O

Pioneer.dx O
. O

These B-Entity
files I-Entity
are O
all O
legitimate O
files O
that O
have O
been B-Action
infected I-Action
by O
another B-Entity
Darkhotel I-Entity
component I-Entity
. O

All B-Entity
of I-Entity
these I-Entity
infected I-Entity
files I-Entity
drop B-Action
a B-Entity
63kb I-Entity
self I-Entity
injecting I-Entity
compo- I-Entity
nent I-Entity
. O

This O
malware O
is O
63kb O
in O
size O
. O

It O
is O
bound O
to O
a O
variety O
of O
other O
software O
packages O
that O
vary O
in O
name O
, O
but O
the O
host O
package O
is O
consistently O
detected O
as O
'' O
Virus.Win32 O
. O

Pioneer.dx O
'' O
. O

The B-Entity
igfxext.exe I-Entity
component I-Entity
is B-Action
dropped I-Action
to B-Modifier
disk B-Entity
and O
run B-Action
. O

It B-Entity
spawns B-Action
an- B-Entity
other I-Entity
suspended I-Entity
process I-Entity
with B-Modifier
its B-Entity
own I-Entity
igfxext.exe I-Entity
image I-Entity
, O
but O
decrypts O
a O
smaller O
32kb O
executable O
( O
cf1319d94f33380622ba000b7d8ad6e9 O
, O
Trojan­Downloader O
. O

Win32.Agent.xwge O
) O
from O
its O
.data O

section O
in O
memory O
with O
a O
simple O
xor O
0xbb O
. O

The B-Entity
running I-Entity
process I-Entity
overwrites B-Action
the B-Entity
igfxext.exe I-Entity
image I-Entity
in B-Modifier
the B-Entity
suspended I-Entity
process I-Entity
with B-Modifier
this B-Entity
smaller I-Entity
chunk I-Entity
of I-Entity
code I-Entity
. O

It O
then O
resumes O
the O
thread O
in O
the O
new O
process O
. O

This O
smaller O
code O
section O
maintains O
similar O
functionality O
to O
the O
'' O
worm O
'' O
compo- O
nent O
: O
Host B-Entity
package I-Entity
files I-Entity
detected I-Entity
as I-Entity
'' I-Entity
Virus.Win32.Pioneer.dx I-Entity
'' I-Entity
are B-Action
infected B-Entity
legitimate I-Entity
files I-Entity
, O
that O
do O
not O
have O
any O
self­propagation O
routines O
. O

It O
is O
signed O
with O
the O
familiar O
'' O
'' O
digital O
certificate O
. O

This B-Entity
sample I-Entity
is B-Action
started I-Action
by O
code B-Entity
running I-Entity
within I-Entity
svchost.exe I-Entity
on I-Entity
WinXP I-Entity
SP3 I-Entity
. O

It B-Entity
drops B-Action
a B-Entity
keylogger I-Entity
. O

The O
debug O
path O
inside O
: O
The B-Entity
dropper I-Entity
above I-Entity
maintains B-Action
, I-Action
drops I-Action
and I-Action
installs I-Action
this B-Entity
kernel I-Entity
mode I-Entity
keylogger I-Entity
: O
Likely O
, O
it O
was O
developed O
as O
a O
part O
of O
a O
mid­to­late O
2009 O
project O
: O
This O
driver O
package O
is O
built O
to O
look O
like O
a O
legitimate O
low O
level O
Microsoft O
system O
device O
. O

It B-Entity
is B-Action
installed I-Action
as B-Modifier
a B-Entity
system I-Entity
kernel I-Entity
driver I-Entity
'' I-Entity
Ndiskpro I-Entity
'' I-Entity
service I-Entity
, O
described O
as O
a O
'' O
Microcode O
Update O
Device O
'' O
. O

It O
is O
somewhat O
surprising O
that O
there O
is O
no O
rootkit O
functionality O
hiding O
this O
service O
: O
When O
loaded B-Action
, O
the B-Entity
NDISKPRO.SYS I-Entity
driver I-Entity
hooks B-Action
both B-Entity
INT I-Entity
0x01 I-Entity
and I-Entity
INT I-Entity
0xff I-Entity
, O
and O
retrieves B-Action
keystroke B-Entity
data I-Entity
directly B-Modifier
from I-Modifier
port B-Entity
0x60 I-Entity
, I-Entity
the I-Entity
motherboard I-Entity
keyboard I-Entity
con- I-Entity
troller I-Entity
itself I-Entity
. O

Here O
we O
see O
the O
local O
port O
variables O
assigned O
values O
And O
here O
, O
the O
ports O
are O
directly O
being O
read O
with O
READPORTUCHAR O
( O
0x64 O
) O
and O
then O
READPORTUCHAR O
( O
0x60 O
) O
: O
It O
buffers O
, O
then O
communicates O
the O
data O
to O
the O
running O
user O
mode O
component O
. O

This B-Entity
component I-Entity
then O
encrypts B-Action
and O
writes B-Action
the B-Entity
retrieved I-Entity
values I-Entity
ondisk I-Entity
to B-Modifier
a B-Entity
ran- I-Entity
domly I-Entity
named I-Entity
.tmp I-Entity
, I-Entity
file I-Entity
like I-Entity
ffffz07131101.tmp I-Entity
. O

This O
file O
is O
located O
in O
the O
same O
directory O
as O
the B-Entity
original I-Entity
dropper I-Entity
, O
which O
maintains B-Action
persistence B-Entity
across B-Modifier
reboots B-Entity
with B-Modifier
a B-Entity
simple I-Entity
addition I-Entity
to I-Entity
the I-Entity
HKCU I-Entity
run I-Entity
key I-Entity
. O

Here O
is O
debug O
output O
demonstrating O
this O
component O
's O
data O
retrieval O
when O
the O
letter O
'' O
D O
'' O
is O
repeatedly O
pressed O
on O
the O
keyboard O
. O

Keyscan O
make O
and O
break O
codes O
are O
'' O
0x20 O
'' O
and O
'' O
0xA0 O
'' O
and O
for O
the O
key O
press O
and O
key O
release O
for O
the O
'' O
D O
'' O
key O
. O

The O
'' O
0x1D O
'' O
value O
from O
port O
0x64 O
that O
you O
see O
below O
is O
basically O
an O
indication O
that O
the O
output O
buffer O
is O
full O
and O
the O
keyboard O
is O
locked O
, O
so O
it O
is O
safe O
for O
the O
driver O
to O
access O
the O
key O
value O
in O
port O
0x60 O
: O
These O
debug O
messages O
and O
code O
style O
are O
duplicates O
of O
what O
chpie O
posted O
in O
the O
past O
. O

This B-Entity
keylogger I-Entity
module I-Entity
encrypts B-Action
and O
stores B-Action
gathered B-Entity
data I-Entity
in B-Modifier
a B-Entity
log I-Entity
file I-Entity
, O
as O
men- O
tioned O
previously O
. O

Its O
encryption O
algorithm O
is O
similar O
to O
RC4 O
. O

Interesting O
part O
is O
that O
the O
module O
randomly O
generates O
the O
key O
and O
stores O
it O
in O
an O
unexpected O
place O
: O
in O
the O
middle O
of O
the O
log O
file O
name O
. O

Hence O
, O
the O
numeric O
part O
of O
the O
filename O
is O
used O
as O
a O
seed O
for O
the O
pseudorandom O
number O
generator O
. O

Rand O
function O
is O
statically O
linked O
to O
insure O
same O
results O
on O
different O
computers O
. O

Here O
is O
the O
commented O
RC4 O
encryption O
code O
: O
The O
attackers O
behind O
the O
breach O
of O
the O
New O
York O
Times O
' O
computer O
network O
late O
last O
year O
appear O
to O
be O
mounting O
fresh O
assaults O
that O
leverage O
new O
and O
improved O
versions O
of O
malware O
. O

The O
new O
campaigns O
mark O
the O
first O
significant O
stirrings O
from O
the O
group O
since O
it O
went O
silent O
in O
January O
in O
the O
wake O
of O
a O
detailed O
expose O
of O
the O
group O
and O
its O
exploits O
- O
and O
a O
retooling O
of O
what O
security O
researchers O
believe O
is O
a O
massive O
spying O
operation O
based O
in O
China O
. O

The O
newest O
campaign O
uses O
updated O
versions O
of O
Aumlib O
and O
Ixeshe O
. O

Aumlib B-Entity
, O
which O
for O
years O
has O
been O
used O
in O
targeted O
attacks O
, O
now O
encodes B-Action
certain B-Entity
HTTP I-Entity
communications I-Entity
. O

FireEye O
researchers O
spotted O
the O
malware O
when O
analyzing O
a O
recent O
attempted O
attack O
on O
an O
organization O
involved O
in O
shaping O
economic O
policy O
. O

And O
a B-Entity
new I-Entity
version I-Entity
of I-Entity
Ixeshe I-Entity
, O
which O
has O
been O
in O
service O
since O
2009 O
to O
attack O
targets O
in O
East O
Asia O
, O
uses B-Action
new B-Entity
network I-Entity
traffic I-Entity
patterns I-Entity
, O
possibly O
to B-Modifier
evade B-Entity
traditional I-Entity
network I-Entity
security I-Entity
systems I-Entity
. O

The O
updates O
are O
significant O
for O
both O
of O
the O
longstanding O
malware O
families O
; O
before O
this O
year O
, O
Aumlib O
had O
not O
changed O
since O
at O
least O
May O
2011 O
, O
and O
Ixeshe O
had O
not O
evolved O
since O
at O
least O
December O
2011 O
. O

Cybercriminals O
are O
constantly O
evolving O
and O
adapting O
in O
their O
attempts O
to O
bypass O
computer O
network O
defenses O
. O

But O
, O
larger O
, O
more O
successful O
threat O
actors O
tend O
to O
evolve O
at O
a O
slower O
rate O
. O

As O
long O
as O
these O
actors O
regularly O
achieve O
their O
objective O
( O
stealing O
sensitive O
data O
) O
, O
they O
are O
not O
motivated O
to O
update O
or O
rethink O
their O
techniques O
, O
tactics O
, O
or O
procedures O
( O
TTPs O
) O
. O

These O
threat O
actors O
' O
tactics O
follow O
the O
same O
principles O
of O
evolution O
– O
successful O
techniques O
propagate O
, O
and O
unsuccessful O
ones O
are O
abandoned O
. O

Attackers O
do O
not O
change O
their O
approach O
unless O
an O
external O
force O
or O
environmental O
shift O
compels O
them O
to O
. O

As O
the O
old O
saying O
goes O
: O
If O
it O
ai O
n't O
broke O
, O
do O
n't O
fix O
it O
. O

So O
when O
a O
larger O
, O
successful O
threat O
actor O
changes O
up O
tactics O
, O
the O
move O
always O
piques O
our O
attention O
. O

Naturally O
, O
our O
first O
priority O
is O
ensuring O
that O
we O
detect O
the O
new O
or O
altered O
TTPs O
. O

But O
we O
also O
attempt O
to O
figure O
out O
why O
the O
adversary O
changed O
- O
what O
broke O
? O
- O
so O
that O
we O
can O
predict O
if O
and O
when O
they O
will O
change O
again O
in O
the O
future O
. O

We O
observed O
an O
example O
of O
this O
phenomenon O
around O
May O
. O

About O
four O
months O
after O
The O
New O
York O
Times O
publicized O
an O
attack O
on O
its O
network O
, O
the B-Entity
attackers I-Entity
behind I-Entity
the I-Entity
intrusion I-Entity
deployed B-Action
updated B-Entity
versions I-Entity
of I-Entity
their I-Entity
Backdoor.APT.Aumlib I-Entity
and I-Entity
Backdoor.APT.Ixeshe I-Entity
malware I-Entity
families I-Entity
. O

The O
previous O
versions O
of O
Aumlib O
had O
not O
changed O
since O
at O
least O
May O
2011 O
, O
and O
Ixeshe O
had O
not O
evolved O
since O
at O
least O
December O
2011 O
. O

We O
can O
not O
say O
for O
sure O
whether O
the O
attackers O
were O
responding O
to O
the O
scrutiny O
they O
received O
in O
the O
wake O
of O
the O
episode O
. O

But O
we O
do O
know O
the O
change O
was O
sudden O
. O

Akin O
to O
turning O
a O
battleship O
, O
retooling O
TTPs O
of O
large O
threat O
actors O
is O
formidable O
. O

Such O
a O
move O
requires O
recoding O
malware O
, O
updating O
infrastructure O
, O
and O
possibly O
retraining O
workers O
on O
new O
processes O
. O

The O
following O
sections O
detail O
the O
changes O
to O
Backdoor.APT.Aumlib O
and O
Backdoor.APT.Ixeshe O
. O

Aumlib O
has O
been O
used O
in O
targeted O
attacks O
for O
years O
. O

Older B-Entity
variants I-Entity
of I-Entity
this I-Entity
malware I-Entity
family I-Entity
generated B-Action
the B-Entity
following I-Entity
POST I-Entity
request I-Entity
: O
Data B-Entity
sent B-Action
via B-Modifier
this B-Entity
POST I-Entity
request I-Entity
transmitted O
in O
clear O
text O
in O
the O
following O
structure O
: O
A O
recently O
observed O
malware O
sample O
( O
hash O
value O
832f5e01be536da71d5b3f7e41938cfb O
) O
appears O
to O
be O
a O
modified O
variant O
of O
Aumlib O
. O

The O
sample O
, O
which O
was O
deployed O
against O
an O
organization O
involved O
in O
shaping O
economic O
policy O
, O
was O
downloaded O
from O
the O
following O
URL O
: O
The O
sample O
generated O
the O
following O
traffic O
: O
This O
output O
reveals O
the O
following O
changes O
when O
compared O
with O
earlier O
variants O
: O
The O
POST O
URI O
is O
changed O
to O
/bbs/search.asp O
( O
as O
mentioned O
, O
earlier O
Aumlib O
variants O
used O
a O
POST O
URI O
of O
/bbs/info.asp O
. O

) O
The B-Entity
POST I-Entity
body I-Entity
is B-Action
now I-Action
encoded I-Action
. O

Additional O
requests O
from O
the O
sample O
generated O
the O
following O
traffic O
: O
These O
subtle O
changes O
may O
be O
enough O
to O
circumvent O
existing O
IDS O
signatures O
designed O
to O
detect O
older O
variants O
of O
the O
Aumlib O
family O
. O

The O
sample O
832f5e01be536da71d5b3f7e41938cfb O
shares O
code O
with O
an O
older O
Aumlib O
variant O
with O
the O
hash O
cb3dcde34fd9ff0e19381d99b02f9692 O
. O

The B-Entity
sample I-Entity
cb3dcde34fd9ff0e19381d99b02f9692 I-Entity
connected B-Action
to B-Modifier
documents B-Entity
[ I-Entity
. I-Entity
] I-Entity
myPicture I-Entity
[ I-Entity
. I-Entity
] I-Entity
info I-Entity
and I-Entity
www I-Entity
[ I-Entity
. I-Entity
] I-Entity
documents I-Entity
[ I-Entity
. I-Entity
] I-Entity
myPicture I-Entity
[ I-Entity
. I-Entity
] I-Entity
info I-Entity
and O
as O
expected O
generated B-Action
the O
a B-Entity
POST I-Entity
request I-Entity
to B-Modifier
/bbs/info.asp B-Entity
. O

Ixeshe O
has O
been O
used O
in O
targeted O
attacks O
since O
2009 O
, O
often O
against O
entities O
in O
East O
Asia O
. O

Although O
the B-Entity
network I-Entity
traffic I-Entity
is B-Action
encoded I-Action
with B-Modifier
a B-Entity
custom I-Entity
Base64 I-Entity
alphabet I-Entity
, O
the O
URI O
pattern O
has O
been O
largely O
consistent O
: O
We O
analyzed O
a O
recent O
sample O
that O
appears O
to O
have O
targeted O
entities O
in O
Taiwan O
, O
a O
target O
consistent O
with O
previous O
Ixeshe O
activity O
. O

This B-Entity
sample I-Entity
( I-Entity
aa873ed803ca800ce92a39d9a683c644 I-Entity
) I-Entity
exhibited O
network O
traffic O
that O
does O
not O
match O
the O
earlier O
pattern O
and O
therefore O
may O
evade B-Action
existing B-Entity
network I-Entity
traffic I-Entity
signatures I-Entity
designed I-Entity
to I-Entity
detect I-Entity
Ixeshe I-Entity
related I-Entity
infections I-Entity
. O

The B-Entity
Base64-encoded I-Entity
data I-Entity
still O
contains B-Action
information B-Entity
including I-Entity
the I-Entity
victim I-Entity
's I-Entity
hostname I-Entity
and I-Entity
IP I-Entity
address I-Entity
but O
also O
a O
'' O
mark O
'' O
or O
'' O
campaign O
tag/code O
'' O
that O
the O
threat O
actors O
use O
to O
keep O
track O
of O
their O
various O
attacks O
. O

The O
mark O
for O
this O
particular O
attack O
was O
[ O
ll65 O
] O
. O

Based O
on O
our O
observations O
, O
the O
most O
successful O
threat O
actors O
evolve O
slowly O
and O
deliberately O
. O

So O
when O
they O
do O
change O
, O
pay O
close O
attention O
. O

Knowing O
how O
attackers O
' O
strategy O
is O
shifting O
is O
crucial O
to O
detecting O
and O
defending O
against O
today O
's O
advanced O
threats O
. O

But O
knowing O
the O
'' O
why O
'' O
is O
equally O
important O
. O

That O
additional O
degree O
of O
understanding O
can O
help O
organizations O
forecast O
when O
and O
how O
a O
threat O
actor O
might O
change O
their O
behavior O
- O
because O
if O
you O
successfully O
foil O
their O
attacks O
, O
they O
probably O
will O
. O

This O
entry O
was O
posted O
in O
Threat O
Intelligence O
, O
Threat O
Research O
by O
Ned O
Moran O
and O
Nart O
Villeneuve O
. O

Bookmark O
the O
permalink O
. O

Complex O
malware O
known O
as O
Regin O
is O
the O
suspected O
technology O
behind O
sophisticated O
cyberattacks O
conducted O
by O
U.S. O
and O
British O
intelligence O
agencies O
on O
the O
European O
Union O
and O
a O
Belgian O
telecommunications O
company O
, O
according O
to O
security O
industry O
sources O
and O
technical O
analysis O
conducted O
by O
The O
Intercept O
. O

Regin B-Entity
was O
found O
on O
infected O
internal O
computer O
systems O
and O
email O
servers O
at O
Belgacom O
, O
a O
partly O
state-owned O
Belgian O
phone O
and O
internet O
provider O
, O
following O
reports O
last O
year O
that O
the O
company O
was O
targeted O
in O
a O
top-secret O
surveillance O
operation O
carried O
out O
by O
British O
spy O
agency O
Government O
Communications O
Headquarters O
, O
industry O
sources O
told O
The O
Intercept O
. O

The B-Entity
malware I-Entity
, O
which O
steals B-Action
data B-Entity
from B-Modifier
infected B-Entity
systems I-Entity
and O
disguises B-Action
itself B-Entity
as B-Modifier
legitimate B-Entity
Microsoft I-Entity
software I-Entity
, O
has O
also O
been O
identified O
on O
the O
same O
European O
Union O
computer O
systems O
that O
were O
targeted O
for O
surveillance O
by O
the O
National O
Security O
Agency O
. O

The O
hacking O
operations O
against O
Belgacom O
and O
the O
European O
Union O
were O
first O
revealed O
last O
year O
through O
documents O
leaked O
by O
NSA O
whistleblower O
Edward O
Snowden O
. O

The O
specific O
malware O
used O
in O
the O
attacks O
has O
never O
been O
disclosed O
, O
however O
. O

The O
Regin O
malware O
, O
whose O
existence O
was O
first O
reported O
by O
the O
security O
firm O
Symantec O
on O
Sunday O
, O
is O
among O
the O
most O
sophisticated O
ever O
discovered O
by O
researchers O
. O

Symantec O
compared O
Regin O
to O
Stuxnet O
, O
a O
state-sponsored O
malware O
program O
developed O
by O
the O
U.S. O
and O
Israel O
to O
sabotage O
computers O
at O
an O
Iranian O
nuclear O
facility O
. O

Sources O
familiar O
with O
internal O
investigations O
at O
Belgacom O
and O
the O
European O
Union O
have O
confirmed O
to O
The O
Intercept O
that O
the O
Regin O
malware O
was O
found O
on O
their O
systems O
after O
they O
were O
compromised O
, O
linking O
the O
spy O
tool O
to O
the O
secret O
GCHQ O
and O
NSA O
operations O
. O

Ronald O
Prins O
, O
a O
security O
expert O
whose O
company O
Fox O
IT O
was O
hired O
to O
remove O
the O
malware O
from O
Belgacom O
's O
networks O
, O
told O
The O
Intercept O
that O
it O
was O
'' O
the O
most O
sophisticated O
malware O
'' O
he O
had O
ever O
studied O
. O

'' O
Having O
analyzed O
this O
malware O
and O
looked O
at O
the O
[ O
previously O
published O
] O
Snowden O
documents O
, O
'' O
Prins O
said O
, O
'' O
I O
'm O
convinced O
Regin O
is O
used O
by O
British O
and O
American O
intelligence O
services O
. O

'' O
A O
spokesman O
for O
Belgacom O
declined O
to O
comment O
specifically O
about O
the O
Regin O
revelations O
, O
but O
said O
that O
the O
company O
had O
shared O
'' O
every O
element O
about O
the O
attack O
'' O
with O
a O
federal O
prosecutor O
in O
Belgium O
who O
is O
conducting O
a O
criminal O
investigation O
into O
the O
intrusion O
. O

'' O
It O
's O
impossible O
for O
us O
to O
comment O
on O
this O
, O
'' O
said O
Jan O
Margot O
, O
a O
spokesman O
for O
Belgacom O
. O

'' O
It O
's O
always O
been O
clear O
to O
us O
the O
malware O
was O
highly O
sophisticated O
, O
but O
ever O
since O
the O
clean-up O
this O
whole O
story O
belongs O
to O
the O
past O
for O
us O
. O

'' O
In O
a O
hacking O
mission O
codenamed O
Operation O
Socialist O
, O
GCHQ B-Entity
gained B-Action
access B-Entity
to I-Entity
Belgacom I-Entity
's I-Entity
internal I-Entity
systems I-Entity
in O
2010 O
by O
targeting O
engineers O
at O
the O
company O
. O

The O
agency O
secretly O
installed O
so-called O
malware O
'' O
implants O
'' O
on O
the O
employees O
' O
computers O
by O
sending O
their O
internet O
connection O
to O
a O
fake O
LinkedIn O
page O
. O

The O
malicious O
LinkedIn O
page O
launched O
a B-Entity
malware I-Entity
attack I-Entity
, O
infecting B-Action
the B-Entity
employees I-Entity
' I-Entity
computers I-Entity
and O
giving B-Action
the O
spies O
total B-Entity
control I-Entity
of I-Entity
their I-Entity
systems I-Entity
, O
allowing O
GCHQ B-Entity
to O
get O
deep O
inside O
Belgacom O
's O
networks O
to O
steal B-Action
data B-Entity
. O

The B-Entity
implants I-Entity
allowed O
GCHQ O
to O
conduct B-Action
surveillance B-Entity
of I-Entity
internal I-Entity
Belgacom I-Entity
company I-Entity
communications I-Entity
and O
gave O
British O
spies O
the O
ability O
to O
gather B-Action
data B-Entity
from O
the O
company O
's O
network O
and O
customers O
, O
which O
include O
the O
European O
Commission O
, O
the O
European O
Parliament O
, O
and O
the O
European O
Council O
. O

The O
software O
implants O
used O
in O
this O
case O
were O
part O
of O
the O
suite O
of O
malware O
now O
known O
as O
Regin O
. O

One O
of O
the O
keys O
to O
Regin O
is O
its O
stealth O
: O
To O
avoid B-Action
detection B-Entity
and O
frustrate B-Action
analysis B-Entity
, O
malware B-Entity
used O
in O
such O
operations O
frequently O
adhere O
to O
a O
modular O
design O
. O

This O
involves O
the O
deployment O
of O
the O
malware O
in O
stages O
, O
making O
it O
more O
difficult O
to O
analyze O
and O
mitigating O
certain O
risks O
of O
being O
caught O
. O

Based O
on O
an O
analysis O
of O
the O
malware O
samples O
, O
Regin O
appears O
to O
have O
been O
developed O
over O
the O
course O
of O
more O
than O
a O
decade O
; O
The O
Intercept O
has O
identified O
traces O
of O
its O
components O
dating O
back O
as O
far O
as O
2003 O
. O

Regin O
was O
mentioned O
at O
a O
recent O
Hack.lu O
conference O
in O
Luxembourg O
, O
and O
Symantec O
's O
report O
on O
Sunday O
said O
the O
firm O
had O
identified O
Regin O
on O
infected O
systems O
operated O
by O
private O
companies O
, O
government O
entities O
, O
and O
research O
institutes O
in O
countries O
such O
as O
Russia O
, O
Saudi O
Arabia O
, O
Mexico O
, O
Ireland O
, O
Belgium O
, O
and O
Iran O
. O

The O
use O
of O
hacking O
techniques O
and O
malware O
in O
state-sponsored O
espionage O
has O
been O
publicly O
documented O
over O
the O
last O
few O
years O
: O
China O
has O
been O
linked O
to O
extensive O
cyber O
espionage O
, O
and O
recently O
the O
Russian O
government O
was O
also O
alleged O
to O
have O
been O
behind O
a O
cyber O
attack O
on O
the O
White O
House O
. O

Regin O
further O
demonstrates O
that O
Western O
intelligence O
agencies O
are O
also O
involved O
in O
covert O
cyberespionage O
. O

GCHQ O
declined O
to O
comment O
for O
this O
story O
. O

The O
agency O
issued O
its O
standard O
response O
to O
inquiries O
, O
saying O
that O
'' O
it O
is O
longstanding O
policy O
that O
we O
do O
not O
comment O
on O
intelligence O
matters O
'' O
and O
'' O
all O
of O
GCHQ O
's O
work O
is O
carried O
out O
in O
accordance O
with O
a O
strict O
legal O
and O
policy O
framework O
, O
which O
ensures O
that O
our O
activities O
are O
authorised O
, O
necessary O
and O
proportionate O
. O

'' O
The O
NSA O
said O
in O
a O
statement O
, O
'' O
We O
are O
not O
going O
to O
comment O
on O
The O
Intercept O
's O
speculation O
. O

'' O
The O
Intercept O
has O
obtained O
samples O
of O
the O
malware O
from O
sources O
in O
the O
security O
community O
and O
is O
making O
it O
available O
for O
public O
download O
in O
an O
effort O
to O
encourage O
further O
research O
and O
analysis O
. O

( O
To O
download O
the O
malware O
, O
click O
here O
. O

The O
file O
is O
encrypted O
; O
to O
access O
it O
on O
your O
machine O
use O
the O
password O
'' O
infected O
. O

'' O
) O
What O
follows O
is O
a O
brief O
technical O
analysis O
of O
Regin O
conducted O
by O
The O
Intercept O
's O
computer O
security O
staff O
. O

Regin O
is O
an O
extremely O
complex O
, O
multi-faceted O
piece O
of O
work O
and O
this O
is O
by O
no O
means O
a O
definitive O
analysis O
. O

In O
the O
coming O
weeks O
, O
The O
Intercept O
will O
publish O
more O
details O
about O
Regin O
and O
the O
infiltration O
of O
Belgacom O
as O
part O
of O
an O
investigation O
in O
partnership O
with O
Belgian O
and O
Dutch O
newspapers O
De O
Standaard O
and O
NRC O
Handelsblad O
. O

In O
Nordic O
mythology O
, O
the O
name O
Regin O
is O
associated O
with O
a O
violent O
dwarf O
who O
is O
corrupted O
by O
greed O
. O

It O
is O
unclear O
how O
the O
Regin O
malware O
first O
got O
its O
name O
, O
but O
the O
name O
appeared O
for O
the O
first O
time O
on O
the O
VirusTotal O
website O
on O
March O
9th O
2011 O
. O

Der O
Spiegel O
reported O
that O
, O
according O
to O
Snowden O
documents O
, O
the O
computer O
networks O
of O
the O
European O
Union O
were O
infiltrated O
by O
the O
NSA O
in O
the O
months O
before O
the O
first O
discovery O
of O
Regin O
. O

Industry O
sources O
familiar O
with O
the O
European O
Parliament O
intrusion O
told O
The O
Intercept O
that O
such O
attacks O
were O
conducted O
through O
the O
use O
of O
Regin O
and O
provided O
samples O
of O
its O
code O
. O

This O
discovery O
, O
the O
sources O
said O
, O
may O
have O
been O
what O
brought O
Regin O
to O
the O
wider O
attention O
of O
security O
vendors O
. O

Also O
on O
March O
9th O
2011 O
, O
Microsoft O
added O
related O
entries O
to O
its O
Malware O
Encyclopedia O
: O
Two O
more O
variants O
of O
Regin O
have O
been O
added O
to O
the O
Encyclopedia O
, O
Regin.B O
and O
Regin.C O
. O

Microsoft O
appears O
to O
detect O
the O
64-bit O
variants O
of O
Regin O
as O
Prax.A O
and O
Prax.B O
. O

None O
of O
the O
Regin/Prax O
entries O
are O
provided O
with O
any O
sort O
of O
summary O
or O
technical O
information O
. O

The O
following O
Regin O
components O
have O
been O
identified O
: O
The B-Entity
first I-Entity
stage I-Entity
are O
drivers O
which O
act B-Action
as I-Action
loaders B-Entity
for I-Entity
a I-Entity
second I-Entity
stage I-Entity
. O

They O
have O
an O
encrypted O
block O
which O
points O
to O
the O
location O
of O
the O
2nd O
stage O
payload O
. O

On O
NTFS O
, O
that O
is O
an O
Extended O
Attribute O
Stream O
; O
on O
FAT O
, O
they O
use O
the O
registry O
to O
store O
the O
body O
. O

When O
started O
, O
this B-Entity
stage I-Entity
simply O
loads B-Action
and I-Action
executes I-Action
Stage B-Entity
2 I-Entity
. O

The B-Entity
Regin I-Entity
loaders I-Entity
that O
are B-Action
disguised I-Action
as I-Action
Microsoft B-Entity
drivers I-Entity
with O
names O
such O
as O
: O
Mimicking B-Action
Microsoft B-Entity
drivers I-Entity
allows O
the B-Entity
loaders I-Entity
to O
better O
disguise B-Action
their B-Entity
presence I-Entity
on I-Entity
the I-Entity
system I-Entity
and O
appear B-Action
less B-Entity
suspicious I-Entity
to B-Modifier
host B-Entity
intrusion I-Entity
detection I-Entity
systems I-Entity
. O

When O
launched O
, O
it B-Entity
cleans B-Action
traces B-Entity
of I-Entity
the I-Entity
initial I-Entity
loader I-Entity
, O
loads B-Action
the B-Entity
next I-Entity
part I-Entity
of I-Entity
the I-Entity
toolkit I-Entity
and O
monitors B-Action
its B-Entity
execution I-Entity
. O

On B-Modifier
failure B-Entity
, O
Stage B-Entity
2 I-Entity
is O
able O
to O
disinfect B-Action
the B-Entity
compromised I-Entity
device I-Entity
. O

The B-Entity
malware I-Entity
zeroes B-Action
out I-Action
its B-Entity
PE I-Entity
( I-Entity
Portable I-Entity
Executable I-Entity
, I-Entity
the I-Entity
Windows I-Entity
executable I-Entity
format I-Entity
) I-Entity
headers I-Entity
in I-Entity
memory I-Entity
, O
replacing B-Action
'' B-Entity
MZ I-Entity
'' I-Entity
with B-Modifier
its B-Entity
own I-Entity
magic I-Entity
marker I-Entity
0xfedcbafe I-Entity
. O

This O
component O
consists O
of O
a O
service O
orchestrator O
working O
in O
Windows O
' O
kernel O
. O

It B-Entity
initializes B-Action
the B-Entity
core I-Entity
components I-Entity
of I-Entity
the I-Entity
architecture I-Entity
and O
loads B-Action
the B-Entity
next I-Entity
parts I-Entity
of I-Entity
the I-Entity
malware I-Entity
. O

This O
stage O
is O
composed O
of O
a O
service O
orchestrator O
located O
in O
user O
land O
, O
provided O
with O
many O
modules O
which O
are O
loaded O
dynamically O
as O
needed O
. O

These B-Entity
modules I-Entity
can O
include B-Action
data B-Entity
collectors I-Entity
, O
a B-Entity
self-defense I-Entity
engine I-Entity
which O
detects B-Action
if O
attempts B-Entity
to I-Entity
detect I-Entity
the I-Entity
toolkit I-Entity
occur O
, O
functionality O
for O
encrypted B-Action
communications B-Entity
, O
network B-Entity
capture I-Entity
programs I-Entity
, O
and O
remote B-Entity
controllers I-Entity
of I-Entity
different I-Entity
kinds I-Entity
. O

The O
Intercept O
's O
investigation O
revealed O
a B-Entity
sample I-Entity
uploaded O
on O
VirusTotal O
on O
March O
14th O
2012 O
that O
presents O
the O
unique O
0xfedcbafe O
header O
, O
which O
is O
a O
sign O
that O
it O
might O
have O
been O
loaded B-Action
by O
a B-Entity
Regin I-Entity
driver I-Entity
and O
it B-Entity
appears O
to O
provide B-Action
stealth B-Entity
functionality I-Entity
for B-Modifier
the B-Entity
tool I-Entity
kit I-Entity
. O

In O
order O
to O
access B-Action
information B-Entity
stored I-Entity
in I-Entity
the I-Entity
computer I-Entity
's I-Entity
memory I-Entity
, O
programs B-Entity
use O
objects O
that O
reference O
specific O
locations O
in O
memory O
called O
pointers O
. O

This O
binary O
file O
contains O
some O
of O
such O
pointers O
initialized O
, O
which O
corroborates O
the O
hypothesis O
that O
the B-Entity
file I-Entity
was B-Action
dumped I-Action
from B-Modifier
memory B-Entity
during O
a O
forensic O
analysis O
of O
a O
compromised O
system O
. O

The O
sample O
has O
the O
following O
SHA256 O
hash O
: O
This O
sample O
gives O
a O
sense O
of O
the O
sophistication O
of O
the O
actors O
and O
the O
length O
of O
the O
precautions O
they O
have O
been O
taking O
in O
order O
to O
operate O
as O
stealthily O
as O
possible O
. O

When O
a O
Windows O
kernel O
driver O
needs O
to O
allocate O
memory O
to O
store O
some O
type O
of O
data O
, O
it O
creates O
so O
called O
kernel O
pools O
. O

Such O
memory O
allocations O
have O
specific O
headers O
and O
tags O
that O
are O
used O
to O
identify O
the O
type O
of O
objects O
contained O
within O
the O
block O
. O

For O
example O
such O
tags O
could O
be O
Proc O
, O
Thrd O
or O
File O
, O
which O
respectively O
indicate O
that O
the O
given O
block O
would O
contain O
a O
process O
, O
thread O
or O
file O
object O
structure O
. O

When O
performing O
forensic O
analysis O
of O
a O
computer O
's O
memory O
, O
it O
is O
common O
to O
use O
a O
technique O
called O
pool O
scanning O
to O
parse O
the O
kernel O
memory O
, O
enumerate O
such O
kernel O
pools O
, O
identify O
the O
type O
of O
content O
and O
extract O
it O
. O

Just O
like O
Regin O
loader O
drivers O
, O
this O
driver O
repeatedly O
uses O
the O
generic O
'' O
Ddk O
'' O
tag O
with O
ExAllocatePoolWithTag O
( O
) O
when O
allocating O
all O
kernel O
pools O
: O
The O
generic O
tag O
which O
is O
used O
throughout O
the O
operating O
system O
when O
a O
proper O
tag O
is O
not O
specified O
. O

This O
makes O
it O
more O
difficult O
for O
forensic O
analysts O
to O
find O
any O
useful O
information O
when O
doing O
pool O
scanning O
, O
since O
all O
its O
memory O
allocations O
will O
mix O
with O
many O
generic O
others O
. O

In O
addition O
, O
when O
freeing O
memory O
using O
ExFreePool O
( O
) O
, O
the B-Entity
driver I-Entity
zeroes B-Action
the B-Entity
content I-Entity
, O
probably O
to O
avoid B-Action
leaving B-Entity
traces I-Entity
in I-Entity
pool I-Entity
memory I-Entity
. O

The B-Entity
driver I-Entity
also O
contains O
routines O
to O
check B-Action
for I-Action
specific B-Entity
builds I-Entity
of I-Entity
the I-Entity
Windows I-Entity
kernel I-Entity
in I-Entity
use I-Entity
, O
including O
very O
old O
versions O
such O
as O
for O
Windows O
NT4 O
Terminal O
Server O
and O
Windows O
2000 O
, O
and O
then O
adapts B-Action
its B-Entity
behavior I-Entity
accordingly O
. O

Windows O
kernel O
drivers O
operate O
on O
different O
levels O
of O
priority O
, O
from O
the O
lowest O
PASSIVELEVEL O
to O
the O
highest O
HIGHLEVEL O
. O

This O
level O
is O
used O
by O
the O
processor O
to O
know O
what O
service O
give O
execution O
priority O
to O
and O
to O
make O
sure O
that O
the O
system O
does O
n't O
try O
to O
allocate O
used O
resources O
which O
could O
result O
in O
a O
crash O
. O

This B-Entity
Regin I-Entity
driver I-Entity
recurrently O
checks B-Action
that O
the B-Entity
current I-Entity
IRQL I-Entity
( I-Entity
Interrupt I-Entity
Request I-Entity
Level I-Entity
) I-Entity
is O
set O
to O
PASSIVELEVEL O
using O
the O
KeGetCurrentIrql O
( O
) O
function O
in O
many O
parts O
of O
the O
code O
, O
probably O
in O
order O
to O
operate O
as O
silently O
as O
possible O
and O
to O
prevent O
possible O
IRQL O
confusion O
. O

This O
technique O
is O
another O
example O
of O
the O
level O
of O
precaution O
the O
developers O
took O
while O
designing O
this O
malware O
framework O
. O

Upon O
execution O
of O
the O
unload O
routine O
( O
located O
at O
0xFDEFA04A O
) O
, O
the B-Entity
driver I-Entity
performs O
a O
long O
sequence O
of O
steps O
to O
remove B-Action
remaining B-Entity
traces I-Entity
and I-Entity
artifacts I-Entity
. O

In O
an O
interview O
given O
to O
the O
Belgian O
magazine O
MondiaalNiews O
, O
Fabrice O
Clément O
, O
head O
of O
security O
of O
Belgacom O
, O
said O
that O
the O
company O
first O
identified O
the O
attack O
on O
June O
21 O
, O
2013 O
. O

In O
the O
same O
interview O
Clément O
says O
that O
the O
computers O
targeted O
by O
the O
attackers O
included O
staff O
workstations O
as O
well O
as O
email O
servers O
. O

These O
statements O
confirm O
the O
timing O
and O
techniques O
used O
in O
the O
attack O
. O

From O
previously O
identified O
Regin O
samples O
, O
The O
Intercept O
developed O
unique O
signatures O
which O
could O
identify O
this O
toolkit O
. O

A O
zip O
archive O
with O
a O
sample O
identified O
as O
Regin/Prax O
was O
found O
in O
VirusTotal O
, O
a O
free O
, O
online O
website O
which O
allows O
people O
to O
submit O
files O
to O
be O
scanned O
by O
several O
anti-virus O
products O
. O

The O
zip O
archive O
was O
submitted O
on O
2013-06-21 O
07:58:37 O
UTC O
from O
Belgium O
, O
the O
date O
identified O
by O
Clément O
. O

Sources O
familiar O
with O
the O
Belgacom O
intrusion O
told O
The O
Intercept O
that O
this O
sample O
was O
uploaded O
by O
a O
systems O
administrator O
at O
the O
company O
, O
who O
discovered O
the O
malware O
and O
uploaded O
it O
in O
an O
attempt O
to O
research O
what O
type O
of O
malware O
it O
was O
. O

The O
archive O
contains O
: O
Along O
with O
other O
files O
The O
Intercept O
found O
the O
output O
of O
a O
forensic O
tool O
, O
GetThis O
, O
which O
is O
being O
run O
on O
target O
systems O
looking O
for O
malware O
. O

From O
the O
content O
of O
the O
GetThis.log O
file O
, O
we O
can O
see O
that O
a O
sample O
called O
'' O
svcsstat.exe O
'' O
and O
located O
in O
C O
: O
\Windows\System32\ O
was O
collected O
and O
a O
copy O
of O
it O
was O
stored O
. O

The O
malware O
in O
question O
is O
'' O
0001000000000C1Csvcsstat.exesample O
'' O
. O

This O
is O
a O
64bit O
variant O
of O
the O
first O
stage O
Regin O
loader O
aforementioned O
. O

The O
archive O
also O
contains O
the O
output O
of O
ProcMon O
, O
'' O
Process O
Monitor O
'' O
, O
a O
system O
monitoring O
tool O
distributed O
by O
Microsoft O
and O
commonly O
used O
in O
forensics O
and O
intrusion O
analysis O
. O

This O
file O
identifies O
the O
infected O
system O
and O
provides O
a O
variety O
of O
interesting O
information O
about O
the O
network O
. O

For O
instance O
: O
The O
following O
environment O
variable O
shows O
that O
the O
system O
was O
provided O
with O
a O
Microsoft O
SQL O
server O
and O
a O
Microsoft O
Exchange O
server O
, O
indicating O
that O
it O
might O
one O
of O
the O
compromised O
corporate O
mail O
server O
Fabrice O
Clément O
mentioned O
to O
Mondiaal O
News O
: O
Below O
is O
a O
list O
of O
hashes O
for O
the O
files O
The O
Intercept O
is O
making O
available O
for O
download O
. O

Given O
that O
that O
it O
has O
been O
over O
a O
year O
since O
the O
Belgacom O
operation O
was O
publicly O
outed O
, O
The O
Intercept O
considers O
it O
likely O
that O
the O
GCHQ/NSA O
has O
replaced O
their O
toolkit O
and O
no O
current O
operations O
will O
be O
affected O
by O
the O
publication O
of O
these O
samples O
. O

Hikit O
consists O
of O
at B-Entity
least I-Entity
two I-Entity
generations I-Entity
of I-Entity
malware I-Entity
that O
provides B-Action
basic B-Entity
RAT I-Entity
functionality I-Entity
. O

The B-Entity
first I-Entity
generation I-Entity
of I-Entity
Hikit I-Entity
( I-Entity
referred I-Entity
to I-Entity
as I-Entity
'' I-Entity
Gen I-Entity
1 I-Entity
'' I-Entity
) I-Entity
operates B-Action
as B-Modifier
a B-Entity
server I-Entity
and O
requires O
an O
externally O
exposed O
network O
interface O
in O
order O
for O
an B-Entity
attacker I-Entity
to O
access B-Action
the B-Entity
victim I-Entity
machine I-Entity
. O

The B-Entity
second I-Entity
generation I-Entity
of I-Entity
Hikit I-Entity
( I-Entity
referred I-Entity
to I-Entity
as I-Entity
'' I-Entity
Gen I-Entity
2 I-Entity
'' I-Entity
) I-Entity
uses O
the O
more O
traditional O
client O
model O
and O
beacons B-Action
out B-Modifier
to I-Modifier
an B-Entity
attacker I-Entity
's I-Entity
C2 I-Entity
server I-Entity
. O

While O
the O
communication O
models O
shifted O
dramatically O
between O
Gen O
1 O
and O
Gen O
2 O
, O
both B-Entity
generations I-Entity
of I-Entity
Hikit I-Entity
retain B-Action
the B-Entity
same I-Entity
basic I-Entity
RAT I-Entity
function I-Entity
consisting I-Entity
of I-Entity
remote I-Entity
command I-Entity
shell I-Entity
, I-Entity
file I-Entity
management I-Entity
, I-Entity
network I-Entity
proxy I-Entity
and I-Entity
port I-Entity
forwarding I-Entity
. O

Both O
Gen O
1 O
and O
Gen O
2 O
sub-families O
of O
Hikit O
consist O
of O
a B-Entity
main I-Entity
DLL I-Entity
( I-Entity
referred I-Entity
to I-Entity
as I-Entity
'' I-Entity
the I-Entity
DLL I-Entity
'' I-Entity
) I-Entity
that O
contains B-Action
the B-Entity
RAT I-Entity
functionality I-Entity
; O
a O
kernel O
driver O
( O
referred O
to O
as O
'' O
the O
Driver O
'' O
) O
with O
Gen O
2 O
also O
employs O
an O
additional O
component O
: O
a O
loader O
executable O
. O

The O
driver O
component O
of O
Gen O
1 O
and O
Gen O
2 O
are O
drastically O
different O
in O
their O
operation O
and O
intent O
. O

For O
the O
Gen O
1 O
sub-family O
of O
Hikit O
, O
the O
driver O
acts O
as O
a O
NDIS O
( O
network O
) O
driver O
that O
is O
responsible O
for O
interfacing O
the O
DLL O
to O
the O
network O
while O
preventing O
a O
direct O
WinSock O
interface O
from O
occurring O
. O

The B-Entity
Gen I-Entity
1 I-Entity
Driver I-Entity
listens B-Action
to B-Modifier
network B-Entity
traffic I-Entity
arriving I-Entity
at I-Entity
the I-Entity
local I-Entity
network I-Entity
interface I-Entity
and O
waits O
for O
a O
specific O
trigger O
string O
. O

The O
trigger O
string O
varies O
by O
Driver O
and O
DLL O
sample O
. O

The B-Entity
Gen I-Entity
2 I-Entity
Driver I-Entity
is O
a O
simpler O
system O
driver O
that O
acts O
as O
a O
rootkit O
to O
hide B-Action
processes B-Entity
, I-Entity
registry I-Entity
keys I-Entity
and I-Entity
network I-Entity
connections I-Entity
associated I-Entity
with I-Entity
Gen I-Entity
2 I-Entity
activity I-Entity
on I-Entity
the I-Entity
victim I-Entity
's I-Entity
system I-Entity
. O

Gen O
2 O
uses O
a O
standard O
client-server O
malware O
model O
meaning O
that O
the O
malware O
no O
longer O
requires O
a O
direct O
Internet-facing O
network O
card O
, O
no O
longer O
uses O
a O
network O
driver O
for O
networking O
, O
and O
provides O
the O
ability O
to O
network O
multiple O
Gen O
2 O
samples O
behind O
a O
firewall O
with O
greater O
ease O
( O
from O
the O
attacker's O
perspective O
) O
. O

The O
Gen O
2 O
sub-family O
, O
however O
, O
no O
longer O
employs O
network O
stealth O
provided O
by O
the O
Gen O
1 O
network O
driver O
which O
exposes O
the O
C2 O
server O
addresses O
to O
analysts O
. O

Each O
of O
the O
Hikit O
generations O
contains O
multiple O
sub-generations O
as O
the O
author O
( O
s O
) O
of O
Hikit O
have O
evolved O
their O
code O
over O
time O
. O

There O
is O
a O
noticeable O
steep O
improvement O
over O
the O
code O
base O
of O
Gen O
1 O
Hikit O
family O
during O
its O
2011 O
development O
period O
. O

The O
Gen O
2 O
sub-generations O
share O
a O
similar O
improvement O
scale O
between O
late O
2011 O
and O
late O
2013 O
. O

The O
earliest O
known O
Hikit O
sample O
dates O
back O
to O
31 O
March O
2011 O
. O

Known O
as O
the O
Gen O
1.0 O
sub-generation O
of O
Hikit O
Gen O
1 O
, O
the O
first O
known O
sample O
of O
Hikit O
deviated O
from O
the O
later O
traditional O
Gen O
1 O
model O
. O

The O
Gen O
1.0 O
sample O
was O
a O
standalone O
executable O
whereas O
subsequent O
Gen O
1 O
sub-generations O
use O
a O
DLL O
running O
as O
a O
service O
. O

The O
Gen O
1.0 O
sample O
is O
clearly O
a O
work-in-progress O
. O

The O
Gen O
1.0 O
sample O
, O
while O
different O
than O
subsequent O
sub-generations O
, O
does O
still O
rely O
on O
the O
Driver O
component O
and O
for O
the O
most O
part O
the O
structure O
of O
the O
code O
does O
not O
differ O
much O
going O
forward O
into O
the O
Gen O
1 O
evolution O
. O

Less O
than O
three O
weeks O
after O
Gen O
1.0 O
, O
the O
author O
( O
s O
) O
of O
Hikit O
move O
into O
Gen O
1.1 O
. O

The O
notable O
change O
is O
that O
the O
Hikit O
model O
of O
using O
a O
DLL O
and O
driver O
, O
which O
has O
remained O
until O
present O
day O
, O
comes O
into O
being O
. O

The O
code O
matures O
slightly O
between O
Gen O
1.0 O
and O
Gen O
1.1 O
but O
the O
functionality O
does O
not O
change O
. O

Both O
Gen O
1.0 O
and O
Gen O
1.1 O
use O
plaintext O
data O
transmissions O
. O

Development O
appears O
to O
halt O
on O
Gen O
1 O
for O
4 O
months O
between O
20 O
June O
2011 O
and O
23 O
October O
2011 O
based O
on O
a O
lack O
of O
available O
samples O
found O
. O

During O
this O
time O
the O
development O
of O
Hikit O
appears O
to O
change O
locations O
. O

Gen O
1 O
samples O
have O
Program O
Database O
( O
PDB O
) O
file O
strings O
that O
identify O
the O
file O
path O
of O
the O
Hikit O
source O
code O
. O

For O
Gen O
1.0 O
and O
Gen O
1.1 O
samples O
, O
the O
file O
path O
of O
the O
Hikit O
source O
code O
is O
consistently O
h O
: O
\JmVodServer\hikit O
. O

Starting O
with O
Gen O
1.2 O
, O
the O
file O
path O
switches O
to O
e O
: O
\SourceCode\hikitnew O
. O

It O
is O
at O
this O
time O
that O
the O
functionality O
of O
Hikit O
Gen O
1 O
begins O
to O
mature O
. O

In O
Gen O
1.2 O
, O
the B-Entity
communication I-Entity
between I-Entity
the I-Entity
infected I-Entity
machine I-Entity
and I-Entity
the I-Entity
attacker I-Entity
is B-Action
encrypted I-Action
using B-Modifier
an B-Entity
XOR I-Entity
mask I-Entity
. O

A O
more O
subtle O
change O
is O
the O
renaming O
of O
the O
'' O
socks5 O
'' O
command O
to O
simply O
'' O
proxy O
'' O
within O
the O
code O
. O

The O
code O
within O
Hikit O
begins O
to O
mature O
but O
the O
overall O
functionality O
does O
not O
expand O
beyond O
the O
original O
set O
of O
commands O
found O
in O
Gen O
1.0 O
. O

The O
other O
remarkable O
change O
within O
the O
Gen O
1.1 O
to O
Gen O
1.2 O
development O
is O
the O
way O
in O
which O
the O
session O
handshake O
trigger O
operates O
. O

In O
Gen O
1.0 O
and O
Gen O
1.1 O
, O
the O
DLL O
instructs O
the O
Driver O
to O
listen O
for O
a O
specific O
string O
( O
typically O
a O
HTTP O
request O
string O
) O
and O
responds O
with O
another O
string O
. O

In O
Gen O
1.2 O
, O
the O
Driver O
has O
a O
hardcoded O
trigger O
string O
( O
a O
specific O
HTTP O
request O
string O
) O
and O
the O
DLL O
instructs O
the O
Driver O
to O
inspect O
a O
specific O
HTTP O
header O
field O
for O
a O
specific O
hexadecimal O
value O
. O

This O
moves O
Gen O
1.2 O
into O
more O
of O
a O
username/password O
authentication O
scheme O
whereas O
previous O
sub-generations O
could O
potentially O
be O
accessed O
by O
accidental O
HTTP O
requests O
. O

At O
the O
same O
time O
, O
the O
Driver O
responds O
with O
a O
specific O
value O
with O
in O
the O
Etag O
HTTP O
header O
field O
. O

This O
places O
Gen O
1.2 O
into O
a O
more O
stealth O
position O
as O
a O
random O
, O
non-HTTP O
compliant O
response O
from O
Gen O
1.0 O
and O
Gen O
1.1 O
samples O
is O
more O
obvious O
than O
a O
legitimate O
HTTP O
response O
with O
a O
specially O
crafted O
Etag O
header O
. O

Gen O
1.2 O
's O
development O
cycle O
appears O
to O
exist O
between O
23 O
October O
2011 O
and O
2 O
November O
2011 O
with O
several O
new O
samples O
being O
found O
on O
the O
Internet O
having O
legitimate O
compile O
times O
during O
this O
time O
window O
. O

There O
is O
, O
however O
, O
evidence O
that O
the O
development O
of O
Hikit O
Gen O
1 O
and O
Gen O
2 O
overlap O
by O
several O
months O
. O

The O
earliest O
Gen O
2 O
sample O
known O
to O
exist O
dates O
to O
28 O
August O
2011 O
, O
two O
months O
before O
the O
first O
known O
Gen O
1.2 O
sample O
. O

The O
last O
known O
Gen O
1.2 O
sample O
, O
and O
by O
extension O
, O
the O
last O
known O
Gen O
1 O
sample O
, O
dates O
to O
9 O
April O
2012 O
. O

The O
first O
known O
Gen O
2 O
sub-generation O
, O
Gen O
2.0 O
Alpha O
, O
much O
like O
Gen O
1.0 O
, O
represents O
an O
early O
development O
version O
of O
the O
Gen O
2 O
Hikit O
sub-family O
. O

Gen O
2.0 O
Alpha O
is O
a O
stand-alone O
Windows O
console O
executable O
that O
can O
run O
as O
a O
service O
executable O
. O

Gen O
2.0 O
Alpha O
supports O
the O
same O
commands O
as O
Gen O
1.2 O
with O
an O
additional O
command O
that O
returns O
the O
infection O
's O
configuration O
information O
. O

On O
9 O
February O
2012 O
the O
first O
known O
sample O
for O
Gen O
2.0 O
Beta O
is O
compiled O
by O
the O
developer O
( O
s O
) O
of O
Hikit O
. O

Also O
a O
stand-alone O
console O
executable O
like O
Gen O
2.0 O
Alpha O
, O
the O
Gen O
2.0 O
Beta O
code O
changes O
internally O
without O
providing O
significant O
functionality O
improvements O
with O
the O
exception O
of O
now O
the O
executable O
uses O
a O
device O
driver O
to O
hide O
network O
, O
file O
, O
and O
registry O
artifacts O
related O
to O
its O
operation O
. O

Both O
Gen O
2.0 O
Alpha O
and O
Gen O
2.0 O
Beta O
still O
retain O
PDB O
file O
path O
information O
within O
their O
binaries O
. O

During O
the O
development O
phase O
of O
Gen O
2.0 O
Alpha O
, O
development O
of O
the O
Gen O
2.0 O
Alpha O
variants O
changes O
locations O
. O

First O
version O
of O
the O
Gen O
2.0 O
Alpha O
malware O
, O
from O
28 O
August O
2011 O
, O
has O
the O
PDB O
path O
located O
in O
H O
: O
\JmVodServer\Matrixnew2 O
whereas O
the O
file O
path O
for O
later O
Gen O
2.0 O
Alpha O
and O
Gen O
2.0 O
Beta O
binaries O
has O
the O
PDB O
path O
in O
E O
: O
\SourceCode\Matrixnew O
which O
suggests O
that O
the O
source O
code O
for O
both O
Gen O
1 O
and O
Gen O
2 O
existed O
on O
the O
same O
machine O
and O
moved O
at O
roughly O
the O
same O
time O
. O

This O
may O
indicate O
either O
a O
single O
developer O
or O
a O
team O
( O
or O
set O
of O
teams O
) O
with O
shared O
resources O
. O

The O
first O
known O
Gen O
2.1 O
binary O
has O
a O
compile O
date O
of O
17 O
April O
2012 O
. O

Gen O
2.1 O
represents O
the O
first O
Gen O
2 O
sub-generation O
to O
use O
an O
executable-based O
loader O
, O
DLL O
and O
driver O
model O
, O
a O
model O
that O
all O
subsequent O
Gen O
2 O
sub-generations O
employ O
. O

The O
functionality O
of O
the O
Gen O
2.1 O
sub-generation O
is O
the O
same O
as O
the O
previous O
generations O
with O
no O
new O
commands O
being O
introduced O
. O

Gen O
2.1 O
is O
the O
first O
sub-generation O
in O
the O
Gen O
2 O
sub-family O
to O
introduce O
64-bit O
binaries O
. O

The O
Gen O
2.2 O
sub-generation O
appears O
to O
have O
begun O
on O
20 O
July O
2012 O
. O

Gen O
2.2 O
is O
notable O
for O
altering O
where O
the O
configuration O
information O
of O
the O
RAT O
is O
stored O
and O
using O
both O
DLL-based O
and O
executable- O
based O
loaders O
. O

Also O
notable O
is O
the O
fact O
that O
the O
sub-generation O
spans O
a O
significant O
amount O
of O
time O
with O
intermittent O
periods O
of O
development O
. O

The O
bulk O
of O
the O
Gen O
2.2 O
samples O
that O
have O
the O
tell-tale O
marks O
of O
being O
the O
product O
of O
a O
builder O
have O
a O
compile O
date O
of O
26 O
July O
2013 O
, O
a O
full O
year O
after O
the O
first O
known O
Gen O
2.2 O
sample O
. O

Between O
21 O
July O
2012 O
and O
20 O
February O
2013 O
, O
there O
are O
no O
known O
Gen O
2.2 O
binaries O
. O

The O
two O
20 O
July O
2012 O
samples O
have O
different O
compile O
times O
indicating O
they O
were O
not O
the O
product O
of O
a O
builder O
but O
rather O
unique O
compilations O
. O

Between O
21 O
February O
2013 O
and O
27 O
February O
2013 O
, O
there O
are O
4 O
unique O
compilation O
dates O
for O
the O
DLL O
component O
with O
7 O
unique O
, O
known O
Gen O
2.2 O
DLLs O
. O

The O
bulk O
of O
Gen O
2.2 O
samples O
have O
a O
compile O
date O
of O
26 O
July O
2013 O
. O

There O
are O
approximately O
25 O
known O
Gen O
2.2 O
DLLs O
with O
the O
26 O
July O
2013 O
compile O
date O
. O

The O
Gen O
2.2 O
sub-generation O
appears O
to O
exist O
through O
at O
least O
19 O
September O
2013 O
. O

The O
last O
known O
Gen O
2 O
sub-generation O
, O
Gen O
2.3 O
, O
began O
on O
12 O
December O
2013 O
. O

Gen O
2.3 O
is O
notable O
for O
its O
use O
of O
a O
legitimate O
SSL O
certificate O
as O
part O
of O
the O
handshake O
between O
the O
infected O
machine O
and O
the O
attacker O
's O
C2 O
. O

The B-Entity
DLL I-Entity
will O
send B-Action
a B-Entity
legitimate I-Entity
SSL I-Entity
certificate I-Entity
as B-Modifier
a B-Entity
means I-Entity
to I-Entity
disrupt I-Entity
heuristic I-Entity
IDS I-Entity
sensors I-Entity
that I-Entity
look I-Entity
for I-Entity
encrypted I-Entity
traffic I-Entity
. O

Another O
interesting O
aspect O
of O
the O
Gen O
2.3 O
sub-generation O
is O
that O
there O
is O
no O
longer O
a O
marker O
to O
designate O
the O
beginning O
of O
the O
embedded O
configuration O
. O

Gen O
2.1 O
and O
Gen O
2.2 O
uses O
a O
specific O
string O
to O
indicate O
the O
beginning O
of O
the O
embedded O
configuration O
presumably O
in O
order O
to O
allow O
the O
builder O
to O
locate O
the O
configuration O
space O
when O
constructing O
a O
new O
configuration O
for O
the O
binaries O
. O

Gen O
2.3 O
, O
however O
, O
uses O
a O
specific O
location O
instead O
, O
requiring O
the O
builder O
to O
calculate O
the O
specific O
location O
using O
the O
PE/COFF O
header O
of O
the O
binary O
. O

Also O
, O
while O
Gen O
2.1 O
and O
Gen O
2.2 O
retain O
the O
configuration O
within O
the O
DLL O
component O
, O
Gen O
2.3 O
stores O
the O
configuration O
within O
the O
loader O
component O
. O

This O
allows O
the O
attackers O
to O
configure O
the O
loader O
without O
having O
to O
update O
the O
DLL O
. O

The O
evolution O
of O
Hikit O
is O
a O
long O
and O
drawn O
out O
series O
of O
small O
, O
incremental O
development O
changes O
. O

The O
important O
take O
away O
from O
the O
evolution O
of O
Hikit O
is O
that O
the O
developers O
for O
Gen O
1 O
appear O
to O
have O
changed O
in O
late O
2011 O
and O
development O
of O
Gen O
2 O
has O
a O
several O
month O
overlap O
with O
the O
development O
and O
usage O
of O
Gen O
1 O
. O

The O
following O
table O
provides O
a O
quick O
reference O
to O
the O
generational O
( O
and O
sub-generational O
) O
designations O
of O
Hikit O
. O

The O
Driver O
component O
for O
Hikit O
varies O
based O
on O
the O
specific O
Hikit O
sub-family O
( O
Gen O
1 O
or O
Gen O
2 O
) O
. O

As O
such O
it O
is O
necessary O
to O
describe O
each O
in O
the O
context O
of O
its O
specific O
sub-family O
. O

The O
Driver O
component O
of O
Gen O
1 O
Hikit O
variants O
provides O
the O
interface O
between O
the O
victim O
's O
network O
interface O
card O
( O
NIC O
) O
and O
the O
DLL O
. O

The O
Driver O
is O
a O
NDIS O
( O
network O
) O
driver O
that O
integrates O
into O
the O
victim's O
network O
stack O
. O

The B-Entity
Driver I-Entity
intercepts B-Action
any B-Entity
and I-Entity
all I-Entity
network I-Entity
communication I-Entity
that I-Entity
traverses I-Entity
the I-Entity
Windows I-Entity
network I-Entity
stack I-Entity
and O
potentially O
removes O
the O
data O
from O
the O
network O
stack O
under O
very O
specific O
conditions O
. O

When O
the O
Driver O
removes O
data O
from O
the O
network O
stack O
, O
the O
Driver O
stores O
the O
removed O
data O
in O
local O
buffers O
for O
the O
Gen O
1 O
DLL O
to O
query O
against O
. O

The O
purpose O
of O
this O
behavior O
is O
to O
allow O
the B-Entity
DLL I-Entity
to O
interact B-Action
with B-Modifier
the B-Entity
network I-Entity
without B-Modifier
utilizes B-Entity
the I-Entity
WinSock I-Entity
API I-Entity
which I-Entity
could I-Entity
potentially I-Entity
reveal I-Entity
the I-Entity
presence I-Entity
of I-Entity
Hikit I-Entity
. O

In O
order O
to O
interact O
with O
the O
Driver O
, O
the O
DLL O
uses O
the O
function O
The O
Driver O
will O
remove O
data O
from O
the O
network O
stack O
only O
if O
a O
new O
channel O
is O
being O
established O
. O

A O
new O
channel O
occurs O
when O
the O
Driver O
detects O
a O
trigger O
string O
. O

The O
trigger O
string O
is O
typically O
a O
short O
form O
HTTP O
request O
with O
the O
following O
trigger O
strings O
found O
in O
the O
wild O
: O
Up O
to O
and O
including O
Gen O
1.1 O
Drivers O
required O
the O
DLL O
to O
specify O
the O
trigger O
string O
in O
addition O
to O
the O
authentication O
value O
whereas O
Gen O
1.2 O
Drivers O
had O
the O
trigger O
strings O
hardcoded O
. O

In O
Gen O
1.2 O
, O
whenever O
the O
Driver O
detects O
a O
trigger O
string O
, O
the O
Driver O
inspects O
the O
rest O
of O
the O
data O
received O
for O
the O
authentication O
value O
. O

If O
the O
token O
follows O
the O
trigger O
string O
( O
there O
is O
no O
specific O
limitation O
on O
how O
far O
from O
the O
trigger O
string O
the O
password O
token O
must O
be O
) O
, O
then O
the O
Driver O
generates O
a O
new O
channel O
that O
the O
DLL O
will O
use O
as O
the O
conduit O
between O
the O
DLL O
and O
the O
client O
. O

The O
Driver O
appears O
to O
be O
based O
off O
the O
NDIS O
example O
source O
code O
PassThru O
. O

More O
specifically O
, O
the O
author O
( O
s O
) O
of O
the O
Driver O
appear O
to O
have O
used O
the O
modified O
version O
of O
the O
PassThru O
example O
, O
PassThruEx O
, O
by O
James O
Antognini O
and O
Thomas O
Devine O
from O
a O
2003 O
blog O
post O
. O

The B-Entity
Gen I-Entity
2 I-Entity
sub-family I-Entity
, I-Entity
beginning I-Entity
with I-Entity
Gen I-Entity
2.0 I-Entity
Beta I-Entity
, O
employs B-Action
a B-Entity
Windows I-Entity
device I-Entity
driver I-Entity
( I-Entity
'' I-Entity
the I-Entity
Driver I-Entity
'' I-Entity
) I-Entity
to B-Modifier
hide B-Entity
aspects I-Entity
of I-Entity
the I-Entity
DLL I-Entity
's I-Entity
functionality I-Entity
from I-Entity
normal I-Entity
system I-Entity
processes I-Entity
. O

The O
Driver O
is O
a O
relatively O
straightforward O
piece O
of O
software O
. O

It O
does O
not O
attempt O
to O
obfuscate O
its O
functionality O
from O
static O
analysis O
and O
it B-Entity
hooks B-Action
a B-Entity
minimum I-Entity
number I-Entity
of I-Entity
kernel I-Entity
API I-Entity
functions I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
hide B-Entity
different I-Entity
pieces I-Entity
of I-Entity
information I-Entity
. O

The O
Driver O
is O
based O
primarily O
on O
the O
open O
source O
Agony O
rootkit O
and O
it O
has O
evidence O
of O
some O
portions O
of O
the O
code O
coming O
directly O
from O
a O
Chinese O
blog O
. O

The O
Driver O
expose O
an O
IOCTL O
interface O
that O
supports O
the O
following O
OIDs O
: O
The B-Entity
Driver I-Entity
is O
capable O
of O
hiding B-Action
processes B-Entity
( O
by O
PID O
, O
not O
name O
) O
, O
system B-Entity
modules I-Entity
, O
services B-Entity
, O
network B-Entity
connections I-Entity
, O
listening B-Entity
ports I-Entity
, O
directories B-Entity
( O
and O
by O
extension O
, O
files B-Entity
) O
, O
as O
well O
as O
registry B-Entity
keys I-Entity
and I-Entity
values I-Entity
. O

In B-Modifier
order I-Modifier
to I-Modifier
hide B-Entity
these I-Entity
items I-Entity
, O
the B-Entity
Driver I-Entity
hooks B-Action
various B-Entity
Windows I-Entity
Kernel I-Entity
API I-Entity
calls I-Entity
. O

The O
following O
table O
maps O
the B-Entity
items I-Entity
the B-Entity
Driver I-Entity
can O
hide B-Action
to O
the B-Entity
API I-Entity
function I-Entity
that O
the B-Entity
Driver I-Entity
hooks B-Action
: O
In O
order O
to O
hide B-Action
services B-Entity
, O
the B-Entity
Driver I-Entity
will O
access B-Action
the B-Entity
memory I-Entity
of I-Entity
the I-Entity
services.exe I-Entity
process I-Entity
, O
locate O
the O
linked O
list O
of O
services O
and O
remove B-Action
the B-Entity
service I-Entity
entry I-Entity
that I-Entity
the I-Entity
Driver I-Entity
wishes I-Entity
to I-Entity
hide I-Entity
. O

This O
is O
a O
surprisingly O
invasive O
method O
to O
obfuscate B-Action
a B-Entity
process I-Entity
. O

Upon O
activation O
, O
the B-Entity
Driver I-Entity
will O
expose O
its O
interface O
by O
calling B-Action
IoCreateDevice B-Entity
with B-Modifier
the B-Entity
name I-Entity
\Device\agony I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.0 I-Entity
Beta I-Entity
samples I-Entity
) I-Entity
, I-Entity
\Device\HTTPS I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.1 I-Entity
samples I-Entity
) I-Entity
, I-Entity
\Device\advcachemgr I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.2 I-Entity
samples I-Entity
) I-Entity
or I-Entity
\Device\diskdump I-Entity
( I-Entity
for I-Entity
Gen I-Entity
2.3 I-Entity
samples I-Entity
) I-Entity
. O

The B-Entity
Driver I-Entity
also O
creates B-Action
a B-Entity
symbolic I-Entity
link I-Entity
to B-Modifier
the B-Entity
device I-Entity
using B-Modifier
the B-Entity
same I-Entity
name I-Entity
but I-Entity
under I-Entity
the I-Entity
\DosDevices\ I-Entity
tree I-Entity
. O

For O
reasons O
unknown O
, O
the O
authors O
of O
the O
Driver O
used O
code O
from O
a O
Chinese O
blog O
that O
details O
how O
to O
hide O
network O
connections O
on O
Windows O
Vista O
and O
later O
decided O
to O
keep O
the O
example O
IP O
address O
within O
the O
code O
. O

The B-Entity
Hikit I-Entity
family I-Entity
has O
supported B-Action
roughly B-Entity
the I-Entity
same I-Entity
set I-Entity
of I-Entity
commands I-Entity
since B-Modifier
the B-Entity
first I-Entity
known I-Entity
samples I-Entity
of I-Entity
Gen I-Entity
1.0 I-Entity
. O

Gen O
2.0 O
introduced O
a O
single O
command O
to O
provide O
insight O
into O
an O
infected O
machine O
's O
Hikit O
configuration O
( O
something O
that O
is O
not O
necessary O
for O
Gen O
1 O
variants O
since O
they O
are O
server-based O
) O
. O

The B-Entity
RAT I-Entity
supports B-Action
the B-Entity
following I-Entity
commands I-Entity
: O
The B-Entity
shell I-Entity
command I-Entity
activates B-Action
a B-Entity
remote I-Entity
shell I-Entity
on B-Modifier
the B-Entity
victim I-Entity
's I-Entity
computer I-Entity
. O

The O
remote O
shell O
function O
uses O
the O
standard O
pipe O
redirection O
method O
for O
interfacing O
a O
network O
application O
( O
in O
this O
case O
, O
the O
DLL O
) O
to O
a O
hidden O
command O
shell O
. O

The B-Entity
file I-Entity
command I-Entity
provides O
an O
attacker O
with O
a O
variety O
of O
disk O
access O
options O
such O
as O
listing B-Action
directories B-Entity
, O
changing O
the O
current O
directory O
, O
and O
uploading B-Action
and O
downloading B-Action
files B-Entity
. O

The O
connect O
function O
provides O
the O
functionality O
to O
allow O
one O
Hikit O
DLL O
to O
interface O
with O
another O
DLL O
of O
a O
similar O
version O
. O

The O
use O
of O
this O
functionality O
can O
best O
be O
illustrated O
by O
considering O
the O
fact O
that O
the O
Gen O
1 O
Driver O
requires O
an O
exposed O
network O
interface O
in O
order O
for O
an O
external O
attacker O
to O
access O
the O
Gen O
1 O
's O
RAT O
function O
. O

This O
would O
prohibit O
lateral O
movement O
within O
a O
victim O
's O
network O
as O
the O
bulk O
of O
any O
organization O
's O
network O
infrastructure O
is O
not O
directly O
exposed O
to O
the O
Internet O
. O

By O
using O
the O
connect O
command O
, O
an O
attacker O
can O
instruct O
the O
externally O
exposed O
Gen O
1 O
DLL O
to O
route O
traffic O
to O
a O
Gen O
1 O
DLL O
that O
is O
behind O
the O
firewall O
, O
effectively O
making O
the O
externally O
exposed O
Gen O
1 O
DLL O
a O
local O
router O
for O
Hikit O
traffic O
. O

The O
proxy O
( O
or O
socks5 O
) O
command O
allows O
an B-Entity
attacker I-Entity
to O
utilize B-Action
a B-Entity
Hikit-infected I-Entity
machine I-Entity
as B-Modifier
a B-Entity
proxy I-Entity
. O

Gen B-Entity
2 I-Entity
samples I-Entity
rely B-Action
on B-Modifier
a B-Entity
configuration I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
know B-Entity
where I-Entity
the I-Entity
C2 I-Entity
server I-Entity
exists I-Entity
along O
with O
other O
operational O
aspects O
such O
as O
the O
name O
of O
its O
service O
and O
operational O
times O
. O

This O
information O
is O
important O
for O
the O
attacker O
to O
have O
access O
to O
in O
order O
to O
determine O
if O
any O
aspect O
of O
the O
configuration O
is O
out O
of O
date O
( O
thus O
requiring O
a O
new O
variant O
of O
the O
Gen O
2 O
binary O
to O
be O
configured O
and O
deployed O
) O
. O

The O
information O
command O
returns O
to O
the O
attacker O
the O
complete O
configuration O
and O
current O
state O
of O
the O
Gen O
2 O
malware O
. O

As O
the O
name O
implies O
, O
the O
exit O
command O
causes O
the O
DLL O
to O
discontinue O
the O
current O
connection O
. O

With O
the O
Gen O
1 O
sub-family O
using O
a O
server O
model O
and O
the O
Gen O
2 O
sub-family O
using O
the O
client O
model O
, O
understanding O
how O
each O
of O
the O
DLL O
components O
of O
the O
sub-families O
works O
is O
best O
done O
, O
as O
with O
the O
Driver O
above O
, O
in O
the O
context O
of O
the O
specific O
sub-family O
. O

As O
noted O
previously O
in O
this O
report O
, O
the O
Gen O
1 O
sub-family O
has O
several O
sub-generations O
but O
overall O
the O
functionality O
of O
the O
Gen O
1 O
sub-family O
has O
remained O
constant O
. O

With O
the O
exception O
of O
Gen O
1.0 O
, O
the O
functionality O
of O
Gen O
1 O
comes O
from O
the O
DLL O
component O
( O
Gen O
1.0 O
uses O
a O
stand-alone O
executable O
to O
achieve O
the O
same O
results O
) O
. O

The O
DLL O
operates O
as O
a O
service O
, O
requiring O
an B-Entity
attacker I-Entity
is B-Action
install I-Action
the B-Entity
DLL I-Entity
as B-Modifier
a B-Entity
service I-Entity
at B-Modifier
some B-Entity
point I-Entity
prior I-Entity
to I-Entity
activation I-Entity
. O

The O
DLL O
contains O
only O
two O
exports O
: O
DllEntryPoint O
and O
DllRegisterServer O
. O

Ultimately O
, O
both B-Entity
exports I-Entity
generate B-Action
a B-Entity
new I-Entity
thread I-Entity
of I-Entity
the I-Entity
same I-Entity
function I-Entity
( I-Entity
'' I-Entity
mainThread I-Entity
'' I-Entity
) I-Entity
. O

The O
difference O
between O
the O
two O
exports O
is O
that O
DllRegisterServer O
can O
take O
an O
optional O
command O
line O
argument O
of O
the O
letter O
'' O
u O
'' O
which O
will O
instruct O
the B-Entity
main I-Entity
thread I-Entity
to O
uninstall B-Action
the B-Entity
Gen I-Entity
1 I-Entity
system I-Entity
from B-Modifier
a B-Entity
victim I-Entity
's I-Entity
computer I-Entity
. O

If O
the O
uninstall O
argument O
exists O
, O
mainThread B-Entity
will O
simply O
remove B-Action
the B-Entity
Driver I-Entity
from B-Modifier
the B-Entity
victim I-Entity
's I-Entity
machine I-Entity
and O
terminate O
. O

The O
authors O
of O
Gen O
1 O
used O
freely O
available O
source O
code O
found O
online O
for O
their O
removal O
function O
. O

When O
the O
DLL O
activates O
, O
either O
by O
a O
call O
to O
DllEntryPoint O
or O
by O
calling B-Action
DllRegisterServer B-Entity
without B-Modifier
the B-Entity
u I-Entity
parameter I-Entity
, O
mainThread O
begins O
by O
verifying O
the O
version O
of O
the O
Driver O
installed O
on O
the O
victim O
's O
machine O
. O

This O
requires O
sending O
OID O
0x12C850 O
to O
the O
Driver O
and O
comparing O
the O
resulting O
32-bit O
value O
with O
the O
required O
driver O
version O
. O

If O
the O
version O
is O
incorrect O
( O
i.e O
. O

it O
does O
n't O
match O
the O
specified O
version O
) O
, O
the B-Entity
DLL I-Entity
installs B-Action
the B-Entity
version I-Entity
of I-Entity
the I-Entity
Driver I-Entity
found I-Entity
within I-Entity
the I-Entity
DLL I-Entity
's I-Entity
resource I-Entity
section I-Entity
( I-Entity
under I-Entity
the I-Entity
BIN I-Entity
resource I-Entity
tree I-Entity
) I-Entity
. O

With O
the O
Driver O
version O
verified O
( O
or O
forcibly O
corrected O
by O
installing B-Action
the B-Entity
appropriate I-Entity
Driver I-Entity
) O
, O
the O
DLL O
will O
instruct O
the O
Driver O
to O
use O
a O
specified O
string O
( O
for O
Gen O
1.0 O
and O
Gen O
1.1 O
samples O
) O
or O
a O
DWORD O
( O
for O
Gen O
1.2 O
samples O
) O
as O
the O
acknowledgment O
value O
to O
send O
to O
a O
connecting O
client O
who O
requests O
the O
appropriate O
URL O
. O

The O
DLL O
again O
checks O
the O
version O
of O
the O
Driver O
and O
, O
in O
some O
versions O
of O
the O
DLL O
, O
will O
print O
a O
message O
indicating O
the O
version O
of O
the O
Driver O
installed O
and O
report O
the O
'' O
Transate O
version O
'' O
( O
the O
word O
translate O
is O
misspelled O
within O
the O
binary O
) O
. O

It O
appears O
that O
the O
Driver O
and O
the O
communication O
protocol O
version O
do O
not O
necessarily O
have O
to O
match O
exactly O
, O
allowing O
the O
possibility O
that O
the O
Driver O
and O
the O
DLL O
could O
be O
compiled O
at O
separate O
times O
. O

If O
the O
Driver O
version O
is O
less O
than O
the O
'' O
Transate O
'' O
version O
( O
indicating O
that O
the O
Driver O
is O
a O
version O
too O
old O
to O
support O
the O
necessary O
communication O
protocols O
) O
, O
the O
DLL O
will O
, O
in O
some O
version O
of O
the O
DLL O
, O
print O
out O
a O
line O
to O
the O
screen O
indicating O
the O
DRIVERMINVERSION O
required O
along O
with O
the O
current O
Driver O
version O
. O

Following O
this O
, O
the B-Entity
DLL I-Entity
will O
then O
attempt O
to O
install B-Action
the B-Entity
correct I-Entity
version I-Entity
of I-Entity
the I-Entity
Driver I-Entity
prior B-Modifier
to I-Modifier
terminating B-Entity
. O

It O
is O
unclear O
why O
this O
code O
exists O
given O
that O
the O
DLL O
will O
check O
the O
Driver O
version O
and O
correct O
the O
Driver O
if O
necessary O
prior O
to O
reaching O
the O
portion O
of O
the O
code O
that O
reports O
the O
DRIVERMINVERSION O
. O

It O
is O
possible O
that O
the B-Entity
second I-Entity
Driver I-Entity
version I-Entity
check I-Entity
is O
a O
last O
ditch O
effort O
to O
ensure B-Action
the B-Entity
correct I-Entity
Driver I-Entity
is I-Entity
installed I-Entity
. O

The O
DLL O
enters O
an O
infinite O
loop O
where O
the O
DLL O
waits O
for O
the O
Driver O
to O
report O
a O
new O
channel O
exists O
. O

A O
channel O
represents O
an O
established O
connection O
between O
the O
Driver O
and O
an O
external O
party O
that O
has O
provided O
the O
proper O
initial O
request O
and O
, O
for O
Gen O
1.2 O
variants O
, O
provided O
the O
proper O
authentication O
value O
. O

When O
the O
Driver O
establishes O
a O
new O
channel O
, O
the B-Entity
DLL I-Entity
generates O
a O
runtime O
data O
structure O
before O
generating B-Action
a B-Entity
new I-Entity
thread I-Entity
( I-Entity
'' I-Entity
HikitThreadFunc I-Entity
'' I-Entity
) I-Entity
which I-Entity
will I-Entity
service I-Entity
any I-Entity
request I-Entity
coming I-Entity
from I-Entity
the I-Entity
new I-Entity
channel I-Entity
. O

This O
allows O
the O
DLL O
to O
service O
multiple O
channels O
at O
one O
time O
. O

The O
HikitThreadFunc O
function O
is O
, O
at O
its O
core O
, O
a O
simple O
wait O
and O
respond O
loop O
. O

The O
function O
begins O
by O
transmitting O
a O
Hikit O
command O
prompt O
to O
the O
client O
( O
Hikit O
> O
) O
before O
settling O
into O
an O
infinite O
loop O
of O
The O
communication O
scheme O
between O
the O
DLL O
and O
the O
client O
consists O
of O
a O
20 O
to O
24 O
byte O
header O
( O
for O
Gen O
1.0 O
and O
Gen O
1.1 O
) O
or O
a O
28 O
byte O
header O
( O
for O
Gen O
1.2 O
) O
followed O
by O
an O
optional O
payload O
. O

The O
format O
of O
the O
Gen O
1.0 O
and O
Gen O
1.1 O
header O
is O
as O
follows O
: O
While O
the O
Gen O
1.2 O
header O
is O
: O
For O
Gen O
1.0 O
and O
Gen O
1.1 O
samples O
, O
the O
magic O
field O
contains O
the O
string O
'' O
.. O

.. O

'' O
( O
two O
dots O
followed O
by O
a O
space O
then O
two O
more O
dots O
) O
. O

Whereas O
the O
key O
field O
in O
Gen O
1.2 O
samples O
contains O
a O
32-bit O
value O
that O
represents O
the O
XOR O
key O
for O
the O
remainder O
of O
the O
PacketHeader O
and O
any O
additional O
payload O
data O
. O

The O
XOR O
scheme O
works O
on O
32-bit O
chunks O
of O
data O
where O
each O
32-bit O
chunk O
of O
data O
is O
XOR O
'd O
against O
the O
key O
value O
. O

Version O
checking O
is O
important O
in O
all O
Gen O
1 O
variants O
. O

The B-Entity
dwHikitVersion I-Entity
field I-Entity
allows B-Action
the B-Entity
client I-Entity
and I-Entity
the I-Entity
DLL I-Entity
to B-Modifier
ensure B-Entity
that I-Entity
they I-Entity
have I-Entity
a I-Entity
compatible I-Entity
communication I-Entity
scheme I-Entity
in I-Entity
place I-Entity
prior B-Modifier
to I-Modifier
executing B-Entity
commands I-Entity
. O

Gen O
1 O
samples O
have O
a O
particular O
interest O
in O
the O
victim O
's O
locale O
language O
preferences O
. O

While O
it O
is O
typical O
for O
most O
RATs O
that O
provide O
remote O
shells O
to O
simply O
pass O
data O
unfiltered O
from O
client O
to O
server O
and O
server O
to O
client O
without O
regard O
to O
code O
pages O
, O
Gen O
1 O
samples O
take O
special O
care O
to O
record O
the O
code O
page O
and O
locale O
information O
in O
each O
and O
every O
packet O
header O
that O
traverses O
the O
divide O
between O
client O
and O
server O
and O
server O
and O
client O
. O

This O
could O
indicate O
that O
the O
authors O
of O
Gen O
1 O
understood O
from O
an O
early O
stage O
in O
the O
development O
of O
Gen O
1 O
that O
they O
would O
be O
attacking O
computer O
systems O
with O
different O
locales O
and O
code O
pages O
. O

The B-Entity
Gen I-Entity
2 I-Entity
sub-family I-Entity
, O
like O
Gen O
1.2 O
, O
uses B-Action
a B-Entity
DLL I-Entity
for B-Modifier
the B-Entity
core I-Entity
of I-Entity
its I-Entity
RAT I-Entity
functionality I-Entity
. O

In B-Modifier
order I-Modifier
for I-Modifier
the B-Entity
DLL I-Entity
to I-Entity
load I-Entity
, O
Gen B-Entity
2 I-Entity
( O
starting O
with O
Gen O
2.1 O
) O
uses B-Action
a B-Entity
loader I-Entity
application I-Entity
( O
referred O
to O
simply O
as O
'' O
the O
Loader O
'' O
) O
. O

The O
Loader O
comes O
in O
the O
form O
of O
a O
standard O
executable O
image O
or O
a O
DLL O
image O
. O

Despite O
the O
different O
models O
, O
both B-Entity
variants I-Entity
of I-Entity
the I-Entity
Loader I-Entity
load B-Action
the B-Entity
embedded I-Entity
DLL I-Entity
in B-Modifier
the B-Entity
exact I-Entity
same I-Entity
way I-Entity
. O

The O
only O
difference O
between O
the O
executable O
and O
DLL O
versions O
of O
the O
Loader O
comes O
in O
how O
they O
handle O
the O
initialization O
of O
the O
embedded O
DLL O
. O

Figure O
1 O
provides O
a O
side O
by O
side O
comparison O
of O
the O
startup O
routines O
for O
the O
executable O
and O
DLL O
Loaders O
. O

Both B-Entity
versions I-Entity
of I-Entity
the I-Entity
Loader I-Entity
begin O
by O
loading B-Action
the B-Entity
embedded I-Entity
DLL I-Entity
from B-Modifier
the B-Entity
Loader I-Entity
's I-Entity
resources I-Entity
( O
item O
102 O
under O
the O
Group O
Icons O
resource O
tree O
) O
, O
decrypting O
and O
decompressing O
the O
image O
into O
memory O
, O
then O
manually O
loading B-Action
the B-Entity
DLL I-Entity
into B-Modifier
memory B-Entity
using B-Modifier
a B-Entity
custom I-Entity
loading I-Entity
routine I-Entity
. O

The O
function O
LoadEmbeddedImage O
, O
as O
seen O
in O
part O
in O
Figure O
2 O
, O
is O
responsible O
for O
this O
operation O
. O

The O
Loader O
obfuscates O
many O
strings O
by O
using O
a O
simple O
XOR O
encoding O
scheme O
. O

Decryption O
of O
encoded O
strings O
consists O
of O
taking O
the O
first O
value O
of O
the O
string O
as O
the O
XOR O
key O
, O
XOR'ing O
all O
subsequent O
bytes O
until O
the O
result O
of O
the O
XOR O
returns O
0 O
. O

The O
decoding O
of O
the O
encoded O
strings O
is O
handled O
by O
the O
DecodeString O
function O
. O

The O
Loader O
stores O
the O
embedded O
DLL O
within O
a O
Group O
Icon O
resource O
within O
a O
legitimate O
icon O
image O
. O

In O
order O
to O
locate O
the O
embedded O
DLL O
, O
LoadEmbeddedImage O
will O
use O
the O
DecodeString O
function O
to O
decrypt O
the O
delimiter O
string O
( O
which O
is O
typically O
zzzzzzzzzz O
or O
yyyyyyyyyy O
) O
and O
then O
search O
the O
icon's O
resource O
memory O
for O
the O
delimiter O
string O
. O

Once O
located O
, O
LoadEmbeddedImage O
will O
use O
the O
first O
12 O
bytes O
immediately O
after O
the O
string O
as O
the O
information O
structure O
about O
the O
embedded O
DLL O
. O

The O
structure O
( O
seen O
below O
) O
defines O
the O
size O
of O
the O
embedded O
DLL O
within O
the O
icon O
's O
resource O
memory O
, O
the O
size O
of O
the O
DLL O
after O
it O
is O
decompressed O
and O
a O
4-byte O
XOR O
key O
that O
LoadEmbeddedImage O
must O
use O
to O
decode O
the O
embedded O
DLL O
prior O
to O
decompression O
. O

LoadEmbeddedImage B-Entity
copies B-Action
the B-Entity
compressed I-Entity
embedded I-Entity
DLL I-Entity
into B-Modifier
a B-Entity
newly I-Entity
allocated I-Entity
heap I-Entity
buffer I-Entity
and O
then O
calls B-Action
the B-Entity
function I-Entity
decodeBuffer I-Entity
( I-Entity
using I-Entity
the I-Entity
EncodingKey I-Entity
value I-Entity
) I-Entity
to B-Modifier
decrypt B-Entity
the I-Entity
embedded I-Entity
DLL I-Entity
. O

Another O
heap O
buffer O
is O
allocated O
with O
a O
size O
equal O
to O
the O
value O
of O
dwImageSizeDecompressed O
. O

The O
decompression O
buffer O
along O
with O
the O
now O
decoded O
compressed O
buffer O
are O
given O
to O
lzodecompress O
which O
decompresses O
the O
compressed O
image O
using O
the O
LZO1X O
algorithm O
. O

With O
the O
embedded O
DLL O
now O
decompressed O
into O
a O
heap O
buffer O
, O
LoadEmbeddedImage B-Entity
calls B-Action
ImageLoaderData B-Entity
: I-Entity
:LoadDll I-Entity
to O
manually O
load B-Action
the B-Entity
DLL I-Entity
into B-Modifier
memory B-Entity
. O

ImageLoaderData B-Entity
: I-Entity
:LoadDll I-Entity
interprets O
the O
PE/COFF O
header O
of O
the O
DLL O
image O
, O
loads B-Action
the B-Entity
image I-Entity
into B-Modifier
the B-Entity
appropriate I-Entity
memory I-Entity
configuration I-Entity
, O
performs O
the O
necessary O
relocation O
operations O
, O
and O
calls B-Action
the B-Entity
DllMain I-Entity
( I-Entity
DLL I-Entity
's I-Entity
entry I-Entity
point I-Entity
) I-Entity
function I-Entity
. O

After O
loading B-Action
the B-Entity
embedded I-Entity
DLL I-Entity
image I-Entity
into B-Modifier
memory B-Entity
, O
the B-Entity
Loader I-Entity
will O
either O
call B-Action
the B-Entity
DLL's I-Entity
StartServer I-Entity
or I-Entity
MatrixMain I-Entity
function I-Entity
depending O
on O
the O
type O
of O
Loader O
. O

The B-Entity
standalone I-Entity
Loaders I-Entity
use B-Action
the B-Entity
MatrixMain I-Entity
function I-Entity
while O
the B-Entity
DLL I-Entity
Loaders I-Entity
will O
call B-Action
the B-Entity
StartServer I-Entity
function I-Entity
. O

The B-Entity
Loaders I-Entity
, O
upon B-Modifier
unloading B-Entity
, O
will O
call B-Action
the B-Entity
StopServer I-Entity
function I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
shut B-Entity
down I-Entity
the I-Entity
embedded I-Entity
DLL I-Entity
. O

The O
Gen O
2 O
DLL O
exposes O
five O
exported O
functions O
( O
besides O
the O
DllEntryPoint/DllMain O
) O
. O

MatrixMain B-Entity
and I-Entity
StartServer I-Entity
both O
ultimately O
generate B-Action
a B-Entity
new I-Entity
thread I-Entity
( O
using B-Modifier
the B-Entity
POSIX I-Entity
API I-Entity
function I-Entity
beginthreadex I-Entity
instead B-Modifier
of I-Modifier
the B-Entity
more I-Entity
common I-Entity
CreateThread I-Entity
) O
that O
contains O
the O
main O
loop O
of O
the O
Gen O
2 O
RAT O
functionality O
. O

MatrixMain O
, O
however O
, O
has O
added O
functionality O
. O

The O
prototype O
for O
MatrixMain O
is O
as O
follows O
: O
where O
Arguments O
parameter O
can O
be O
: O
If O
the O
i O
parameter O
is O
given O
, O
the B-Entity
DLL I-Entity
will O
install B-Action
itself B-Entity
as B-Modifier
a B-Entity
service I-Entity
on B-Modifier
the B-Entity
victim I-Entity
's I-Entity
machine I-Entity
. O

The B-Entity
DLL I-Entity
will O
create B-Action
a B-Entity
new I-Entity
service I-Entity
( O
e.g O
. O

'' O
Network O
DDE O
Service O
'' O
) O
and O
assign O
itself O
as O
the O
executable O
for O
the O
service O
. O

The B-Entity
DLL I-Entity
's I-Entity
RAT I-Entity
functionality I-Entity
provides B-Action
basic O
features O
such O
as O
network O
port O
forwarding O
( O
proxying O
) O
, O
file O
transfer O
, O
and O
remote B-Entity
command I-Entity
shell I-Entity
. O

The O
RAT O
functionality O
provides O
an O
attacker O
with O
the O
ability O
to O
establish O
a O
phantom O
network O
within O
a O
victim O
's O
infrastructure O
by O
having O
individual B-Entity
instances I-Entity
of I-Entity
Gen I-Entity
2 I-Entity
DLL I-Entity
listen B-Action
for B-Modifier
incoming B-Entity
connections I-Entity
on B-Modifier
local B-Entity
ports I-Entity
( O
presumably O
, O
NAT O
'd O
ports O
) O
and O
accept B-Action
commands B-Entity
from B-Modifier
the B-Entity
inbound I-Entity
connection I-Entity
. O

This O
allows O
an O
attacker O
to O
establish O
several O
Gen2 O
infections O
within O
a O
victim's O
infrastructure O
and O
if O
outbound O
connectivity O
is O
prohibited O
for O
any O
of O
the O
infected O
machines O
, O
the O
attacker O
can O
route O
commands O
to O
the O
pseudo-isolated O
infections O
through O
accessible O
infected O
machines O
providing B-Action
a B-Entity
high I-Entity
level I-Entity
of I-Entity
persistence I-Entity
to B-Modifier
the B-Entity
malware I-Entity
. O

Each B-Entity
Gen I-Entity
2 I-Entity
infection I-Entity
can O
support B-Action
up B-Modifier
to I-Modifier
10 B-Entity
listening I-Entity
ports I-Entity
. O

The B-Entity
communication I-Entity
between I-Entity
the I-Entity
Gen I-Entity
2 I-Entity
malware I-Entity
and I-Entity
the I-Entity
C2 I-Entity
( O
or O
other O
Gen O
2 O
malware O
, O
in O
the O
case O
of O
the O
internal O
routing O
functionality O
) O
is B-Action
encrypted I-Action
using B-Modifier
a B-Entity
simple I-Entity
DWORD I-Entity
XOR I-Entity
scheme I-Entity
. O

Each O
communication O
burst O
( O
either O
between O
the O
malware O
and O
the O
C2 O
or O
the O
malware O
and O
neighboring O
malware O
) O
begins O
with O
a O
24-byte O
header O
identical O
to O
the O
header O
found O
in O
Gen O
1.2 O
. O

Immediately O
following O
the O
header O
is O
the O
type-specific O
( O
as O
indicated O
by O
the O
dwPayloadType O
field O
) O
payload O
data O
. O

Note O
that O
the O
dwXORKey O
value O
is O
NOT O
encoded O
with O
the O
XOR O
value O
, O
but O
rather O
is O
the O
value O
that O
is O
used O
for O
encoding O
the O
header O
and O
payload O
. O

Each O
DLL O
includes O
a O
hardcoded O
, O
default O
configuration O
. O

At O
the O
time O
that O
the O
RAT O
functionality O
activates O
, O
the O
DLL O
will O
drop O
the O
current O
configuration O
to O
disk O
. O

If O
the O
configuration O
file O
already O
exists O
, O
then O
the O
RAT O
will O
use O
the O
file O
version O
of O
the O
configuration O
over O
the O
default O
configuration O
. O

The O
configuration O
data O
structure O
( O
seen O
below O
) O
doubles O
as O
a O
current O
state O
record O
for O
some O
aspects O
of O
the O
communication O
subsystem O
of O
the O
DLL O
. O

When O
stored O
on O
disk O
, O
the O
configuration O
is O
preceded O
by O
a O
GUID O
value O
( O
16 O
bytes O
) O
that O
represents O
the O
unique O
identifier O
for O
the O
specific O
infection O
. O

The O
configuration O
is O
XOR O
encoded O
using O
the O
first O
4 O
bytes O
( O
as O
a O
DWORD O
) O
of O
the O
GUID O
. O

In O
order O
to O
provide O
some O
level O
of O
stealth O
, O
the B-Entity
RAT I-Entity
will O
install B-Action
a B-Entity
rootkit I-Entity
on B-Modifier
32-bit B-Entity
versions I-Entity
of I-Entity
Windows I-Entity
. O

The O
DLL O
contains O
a O
device O
driver O
image O
embedded O
within O
an O
encoded O
buffer O
which O
the O
RAT O
functionality O
code O
will O
extract O
to O
the O
% O
TEMP O
% O
directory O
( O
after O
XOR'ing O
the O
buffer O
with O
0x76 O
) O
. O

To O
activate O
the O
rootkit O
, O
the B-Entity
RAT I-Entity
functionality I-Entity
code I-Entity
creates B-Action
a B-Entity
service I-Entity
with B-Modifier
the B-Entity
driver I-Entity
in I-Entity
the I-Entity
% I-Entity
TEMP I-Entity
% I-Entity
directory I-Entity
as I-Entity
the I-Entity
executable I-Entity
for I-Entity
the I-Entity
service I-Entity
. O

The B-Entity
RAT I-Entity
functionality I-Entity
code I-Entity
then O
activates B-Action
the B-Entity
service I-Entity
and O
opens O
a O
handle O
to O
device O
driver O
's O
interface O
( O
e.g O
. O

\Globals\HTTPS O
) O
. O

With O
the O
handle O
open O
to O
the O
rootkit O
driver O
, O
the B-Entity
RAT I-Entity
functionality I-Entity
code I-Entity
deletes B-Action
the B-Entity
service I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
reduce B-Entity
the I-Entity
visible I-Entity
footprint I-Entity
of I-Entity
the I-Entity
new I-Entity
driver I-Entity
. O

To O
further O
reduce O
the O
footprint O
of O
the O
driver O
, O
the B-Entity
RAT I-Entity
functionality I-Entity
code I-Entity
also O
uses O
the O
cloaking O
functionality O
of O
the O
rootkit O
to O
hide B-Action
the B-Entity
DLL I-Entity
's I-Entity
PID I-Entity
, O
any O
references O
to O
the O
GUID O
{ O
4AE26357-79A3-466D-A6D9- O
FC38BFB67DEA O
} O
, O
the B-Entity
DLL I-Entity
's I-Entity
service I-Entity
names I-Entity
( I-Entity
e.g I-Entity
. I-Entity
'' I-Entity
NetDDESrv I-Entity
'' I-Entity
and I-Entity
'' I-Entity
Network I-Entity
DDE I-Entity
Service I-Entity
'' I-Entity
) I-Entity
and I-Entity
the I-Entity
service I-Entity
entry I-Entity
as I-Entity
well I-Entity
. O

Additionally O
, O
the B-Entity
code I-Entity
also O
attempts O
to O
hide B-Action
a B-Entity
service I-Entity
named I-Entity
'' I-Entity
Hitx I-Entity
'' I-Entity
. O

In O
addition O
to O
the O
main O
Hikit O
malware O
, O
there O
are O
at O
least O
two O
examples O
of O
support O
programs O
that O
belong O
to O
the O
Hikit O
family O
. O

Samples O
b04de6c417b6f8836e3f2d8822be2e68f4f9722b O
and O
7c4da9deff3e5c7611b9e1bd67d0e74aa7d2d0f6 O
are O
examples O
of O
Gen O
1.0 O
and O
Gen O
1.2 O
operator O
consoles O
. O

The B-Entity
console I-Entity
is O
a O
text O
based O
application O
that O
takes O
a O
Gen O
1.0 O
or O
Gen O
1.2 O
infection O
's O
IP O
address O
and O
proceeds O
to O
connect B-Action
and I-Action
authenticate I-Action
with B-Modifier
the B-Entity
infected I-Entity
server I-Entity
. O

Once O
connected O
, O
the B-Entity
operator I-Entity
has B-Action
the B-Entity
basic I-Entity
Hikit I-Entity
functionalities I-Entity
available I-Entity
to I-Entity
them I-Entity
via B-Modifier
commands B-Entity
such I-Entity
as I-Entity
file I-Entity
and I-Entity
shell I-Entity
. O

Detecting O
Hikit O
variants O
on O
disk O
and O
in O
memory O
is O
possible O
using O
the O
following O
YARA O
signature O
developed O
by O
Symantec O
: O
Detecting O
nominal O
Gen O
1.2 O
and O
later O
network O
activity O
is O
problematic O
given O
the O
nature O
of O
the O
communication O
structure O
. O

The O
encrypted O
nature O
of O
the O
nominal O
Gen O
1.2 O
and O
later O
network O
traffic O
makes O
a O
signature O
difficult O
. O

Snort O
signature O
30948 O
may O
detect O
some O
Hikit O
based O
network O
traffic O
for O
only O
Gen O
1.0 O
and O
Gen O
1.1 O
. O

From O
a O
system O
objects O
perspective O
, O
Gen B-Entity
2 I-Entity
samples I-Entity
produce B-Action
up B-Modifier
to I-Modifier
three B-Entity
named I-Entity
events I-Entity
. O

The O
event O
names O
change O
per O
infection O
, O
but O
have O
a O
common O
format O
. O

The O
following O
three O
strings O
represent O
the O
known O
mutex O
strings O
for O
Gen O
2 O
samples O
: O
where O
the O
% O
s O
format O
variable O
is O
replaced O
with O
a O
UUID O
value O
string O
specific O
to O
the O
infected O
machine. O
In O
May O
2014 O
, O
the O
U.S. O
Department O
of O
Justice O
charged O
five O
Chinese O
nationals O
for O
economic O
espionage O
against O
U.S. O
corporations O
. O

The O
five O
known O
state O
actors O
are O
officers O
in O
Unit O
61398 O
of O
the O
Chinese O
People O
's O
Liberation O
Army O
( O
PLA O
) O
. O

In O
response O
, O
the O
Chinese O
government O
stated O
that O
the O
claims O
were O
'' O
absurd O
'' O
and O
based O
on O
'' O
fabricated O
facts O
'' O
. O

China O
then O
went O
even O
further O
, O
stating O
'' O
The O
Chinese O
government O
, O
the O
Chinese O
military O
and O
their O
relevant O
personnel O
have O
never O
engaged O
or O
participated O
in O
cyber O
theft O
of O
trade O
secrets O
. O

'' O
We O
believe O
that O
organizations O
, O
be O
they O
governments O
or O
corporations O
, O
global O
or O
domestic O
, O
must O
keep O
up O
the O
pressure O
and O
hold O
China O
accountable O
until O
lasting O
change O
is O
achieved O
. O

Not O
only O
did O
the O
U.S. O
Government O
offer O
in O
its O
criminal O
indictment O
the O
foundation O
of O
evidence O
designed O
to O
prove O
China O
's O
culpability O
in O
electronic O
espionage O
, O
but O
also O
illustrated O
that O
the O
charges O
are O
only O
the O
tip O
of O
a O
very O
large O
iceberg O
. O

Those O
reading O
the O
indictment O
should O
not O
conclude O
that O
the O
People O
's O
Republic O
of O
China O
( O
PRC O
) O
hacking O
campaign O
is O
limited O
to O
five O
soldiers O
in O
one O
military O
unit O
, O
or O
that O
they O
solely O
target O
the O
United O
States O
government O
and O
corporations O
. O

Rather O
, O
China O
's O
decade-long O
economic O
espionage O
campaign O
is O
massive O
and O
unrelenting O
. O

Through O
widespread O
espionage O
campaigns O
, O
Chinese O
threat O
actors O
are O
targeting O
companies O
and O
governments O
in O
every O
part O
of O
the O
globe O
. O

At O
CrowdStrike O
, O
we O
see O
evidence O
of O
this O
activity O
first-hand O
as O
our O
services O
team O
conducts O
Incident O
Response O
investigations O
and O
responds O
to O
security O
breaches O
at O
some O
of O
the O
largest O
organizations O
around O
the O
world O
. O

We O
have O
first-hand O
insight O
into O
the O
billions O
of O
dollars O
of O
intellectual O
property O
systematically O
leaving O
many O
of O
the O
largest O
corporations O
- O
often O
times O
unbeknownst O
to O
their O
executives O
and O
boards O
of O
directors O
. O

The O
campaign O
that O
is O
the O
subject O
of O
this O
report O
further O
points O
to O
espionage O
activity O
outside O
of O
Unit O
61398 O
, O
and O
reveals O
the O
activities O
of O
Unit O
61486 O
. O

Unit O
61486 O
is O
the O
12th O
Bureau O
of O
the O
PLA O
's O
3rd O
General O
Staff O
Department O
( O
GSD O
) O
and O
is O
headquartered O
in O
Shanghai O
, O
China O
. O

The O
CrowdStrike O
Intelligence O
team O
has O
been O
tracking O
this O
particular O
unit O
since O
2012 O
, O
under O
the O
codename O
PUTTER O
PANDA O
, O
and O
has O
documented O
activity O
dating O
back O
to O
2007 O
. O

The O
report O
identifies O
Chen O
Ping O
, O
aka O
cpyy O
, O
and O
the O
primary O
location O
of O
Unit O
61486 O
. O

This O
particular O
unit O
is O
believed O
to O
hack O
into O
victim O
companies O
throughout O
the O
world O
in O
order O
to O
steal O
corporate O
trade O
secrets O
, O
primarily O
relating O
to O
the O
satellite O
, O
aerospace O
and O
communication O
industries O
. O

With O
revenues O
totaling O
$ O
189.2 O
billion O
in O
2013 O
, O
the O
satellite O
industry O
is O
a O
prime O
target O
for O
espionage O
campaigns O
that O
result O
in O
the O
theft O
of O
high-stakes O
intellectual O
property O
. O

While O
the O
gains O
from O
electronic O
theft O
are O
hard O
to O
quantify O
, O
stolen O
information O
undoubtedly O
results O
in O
an O
improved O
competitive O
edge O
, O
reduced O
research O
and O
development O
timetables O
, O
and O
insight O
into O
strategy O
and O
vulnerabilities O
of O
the O
targeted O
organization O
. O

Parts O
of O
the O
PUTTER O
PANDA O
toolset O
and O
tradecraft O
have O
been O
previously O
documented O
, O
both O
by O
CrowdStrike O
, O
and O
in O
open O
source O
, O
where O
they O
are O
referred O
to O
as O
the O
MSUpdater O
group O
. O

This O
report O
contains O
details O
on O
the O
tactics O
, O
tools O
, O
and O
techniques O
used O
by O
PUTTER O
PANDA O
, O
and O
provides O
indicators O
and O
signatures O
that O
can O
be O
leveraged O
by O
organizations O
to O
protect O
themselves O
against O
this O
activity O
. O

Our O
Global O
Intelligence O
Team O
actively O
tracks O
and O
reports O
on O
more O
than O
70 O
espionage O
groups O
, O
approximately O
half O
of O
which O
operate O
out O
of O
China O
and O
are O
believed O
to O
be O
tied O
to O
the O
Chinese O
government O
. O

This O
report O
is O
part O
of O
our O
extensive O
intelligence O
library O
and O
was O
made O
available O
to O
our O
intelligence O
subscribers O
in O
April O
2014 O
, O
prior O
to O
the O
US O
Government O
's O
criminal O
indictment O
and O
China O
's O
subsequent O
refusal O
to O
engage O
in O
a O
constructive O
dialog O
. O

Targeted O
economic O
espionage O
campaigns O
compromise O
technological O
advantage O
, O
diminish O
global O
competition O
, O
and O
ultimately O
have O
no O
geographic O
borders O
. O

We O
believe O
the O
U.S. O
Government O
indictments O
and O
global O
acknowledgment O
and O
awareness O
are O
important O
steps O
in O
the O
right O
direction O
. O

In O
support O
of O
these O
efforts O
, O
we O
are O
making O
this O
report O
available O
to O
the O
public O
to O
continue O
the O
dialog O
around O
this O
ever-present O
threat O
. O

CrowdStrike O
has O
been O
tracking O
the O
activity O
of O
a O
cyber O
espionage O
group O
operating O
out O
of O
Shanghai O
, O
China O
, O
with O
connections O
to O
the O
People O
's O
Liberation O
Army O
Third O
General O
Staff O
Department O
( O
GSD O
) O
12th O
Bureau O
Military O
Unit O
Cover O
Designator O
( O
MUCD O
) O
61486 O
, O
since O
2012 O
. O

The O
attribution O
provided O
in O
this O
report O
points O
to O
Chen O
Ping O
, O
aka O
cpyy O
( O
born O
on O
May O
29 O
, O
1979 O
) O
, O
as O
an O
individual O
responsible O
for O
the O
domain O
registration O
for O
the O
Command O
and O
Control O
( O
C2 O
) O
of O
PUTTER O
PANDA O
malware O
. O

In O
addition O
to O
cpyy O
, O
the O
report O
identifies O
the O
primary O
location O
of O
Unit O
61486 O
. O

PUTTER O
PANDA O
is O
a O
determined O
adversary O
group O
, O
conducting O
intelligence-gathering O
operations O
targeting O
the O
Government O
, O
Defense O
, O
Research O
, O
and O
Technology O
sectors O
in O
the O
United O
States O
, O
with O
specific O
targeting O
of O
the O
US O
Defense O
and O
European O
satellite O
and O
aerospace O
industries O
. O

The O
PLA O
's O
GSD O
Third O
Department O
is O
generally O
acknowledged O
to O
be O
China O
's O
premier O
Signals O
Intelligence O
( O
SIGINT O
) O
collection O
and O
analysis O
agency O
, O
and O
the O
12th O
Bureau O
Unit O
61486 O
, O
headquartered O
in O
Shanghai O
, O
supports O
China O
's O
space O
surveillance O
network O
. O

Domains O
registered O
by O
Chen O
Ping O
were O
used O
to O
control O
PUTTER O
PANDA O
malware O
. O

These O
domains O
were O
registered O
to O
an O
address O
corresponding O
to O
the O
physical O
location O
of O
the O
Shanghai O
headquarters O
of O
12th O
Bureau O
, O
specifically O
Unit O
61486 O
. O

The O
report O
illuminates O
a B-Entity
wide I-Entity
set I-Entity
of I-Entity
tools I-Entity
in O
use B-Action
by O
the B-Entity
actors I-Entity
, O
including B-Modifier
several B-Entity
Remote I-Entity
Access I-Entity
Tools I-Entity
( I-Entity
RATs I-Entity
) I-Entity
. O

The B-Entity
RATs I-Entity
are B-Action
used I-Action
by O
the B-Entity
PUTTER I-Entity
PANDA I-Entity
actors I-Entity
to O
conduct B-Action
intelligence-gathering B-Entity
operations I-Entity
with O
a O
significant O
focus O
on O
the O
space O
technology O
sector O
. O

This B-Entity
toolset I-Entity
provides B-Action
a B-Entity
wide I-Entity
degree I-Entity
of I-Entity
control I-Entity
over I-Entity
a I-Entity
victim I-Entity
system I-Entity
and O
can O
provide O
the O
opportunity O
to O
deploy B-Action
additional B-Entity
tools I-Entity
at B-Modifier
will B-Entity
. O

They B-Entity
focus O
their O
exploits O
against O
popular O
productivity O
applications O
such O
as O
Adobe O
Reader O
and O
Microsoft O
Office O
to O
deploy B-Action
custom B-Entity
malware I-Entity
through B-Modifier
targeted B-Entity
email I-Entity
attacks I-Entity
. O

This O
report O
contains O
additional O
details O
on O
the O
tactics O
, O
tools O
, O
and O
techniques O
used O
by O
PUTTER O
PANDA O
, O
and O
provides O
indicators O
and O
signatures O
that O
can O
be O
leveraged O
by O
organizations O
to O
protect O
themselves O
against O
this O
activity O
. O

➔ O
Putter O
Panda O
is O
a O
cyber O
espionage O
actor O
that O
conducts O
operations O
from O
Shanghai O
, O
China O
, O
likely O
on O
behalf O
of O
the O
Chinese O
People O
's O
Liberation O
Army O
( O
PLA O
) O
3rd O
General O
Staff O
Department O
12th O
Bureau O
Unit O
61486 O
. O

This O
unit O
is O
supports O
the O
space O
based O
signals O
 O
intelligence O
( O
SIGINT O
) O
mission O
. O

➔ O
The O
12th O
Bureau O
Unit O
61486 O
, O
headquartered O
in O
Shanghai O
, O
is O
widely O
accepted O
to O
be O
China O
's O
primary O
SIGINT O
collection O
and O
analysis O
agency O
, O
supporting O
China O
's O
space O
surveillance O
network O
. O

➔ O
This O
is O
a O
determined O
adversary O
group O
, O
conducting O
intelligence- O
gathering O
operations O
targeting O
the O
Government O
, O
Defense O
, O
Research O
, O
and O
Technology O
sectors O
in O
the O
United O
States O
, O
with O
specific O
targeting O
of O
space O
, O
aerospace O
, O
and O
communications O
. O

➔ O
They B-Entity
focus O
their O
exploits O
against O
popular O
productivity O
applications O
such O
as O
Adobe O
Reader O
and O
Microsoft O
Office O
to O
deploy B-Action
custom B-Entity
malware I-Entity
through B-Modifier
targeted B-Entity
email I-Entity
attacks I-Entity
. O

➔ O
CrowdStrike O
identified O
Chen O
Ping O
, O
aka O
cpyy O
, O
a O
suspected O
member O
of O
the O
PLA O
responsible O
for O
procurement O
of O
the O
domains O
associated O
with O
operations O
conducted O
by O
Putter O
Panda O
. O

➔ O
The O
group O
has O
been O
operating O
since O
at O
least O
2007 O
and O
has O
been O
observed O
heavily O
targeting O
the O
US O
Defense O
and O
European O
satellite O
and O
aerospace O
industries O
. O

➔ O
There O
is O
infrastructure O
overlap O
with O
Comment O
Panda O
, O
and O
evidence O
of O
interaction O
between O
actors O
tied O
to O
both O
groups O
. O

There O
are O
several O
pieces O
of O
evidence O
to O
indicate O
that O
the O
activity O
tracked O
by O
CrowdStrike O
as O
PUTTER O
PANDA O
is O
attributable O
to O
a O
set O
of O
actors O
based O
in O
China O
, O
operating O
on O
behalf O
of O
the O
Chinese O
People O
's O
Liberation O
Army O
( O
PLA O
) O
. O

Specifically O
, O
an O
actor O
known O
as O
cpyy O
( O
Chen O
Ping O
) O
appears O
to O
have O
been O
involved O
in O
a O
number O
of O
historical O
PUTTER O
PANDA O
campaigns O
, O
during O
which O
time O
he O
was O
likely O
working O
in O
Shanghai O
within O
the O
12th O
Bureau O
, O
3rd O
General O
Staff O
Department O
( O
GSD O
) O
. O

PUTTER O
PANDA O
has O
several O
connections O
to O
actors O
and O
infrastructure O
tied O
to O
COMMENT O
PANDA O
, O
a O
group O
previously O
attributed O
to O
Unit O
61398 O
of O
the O
PLA O
. O

Although O
some B-Entity
of I-Entity
the I-Entity
domains I-Entity
used B-Action
for B-Modifier
command B-Entity
and I-Entity
control I-Entity
of I-Entity
the I-Entity
tools I-Entity
described I-Entity
later I-Entity
in I-Entity
this I-Entity
report I-Entity
appear O
to O
be O
legitimate O
sites O
that O
have O
been O
compromised O
in O
some O
way O
, O
many O
of O
them O
appear O
to O
have O
been O
originally O
registered O
by O
the O
operators O
. O

Table O
1 O
shows O
the O
domains O
that O
appear O
to O
have O
been O
registered O
by O
these O
actors O
, O
and O
the O
original O
email O
address O
used O
where O
known O
. O

The O
most O
significant O
finding O
is O
that O
an O
actor O
known O
as O
cpyy O
appears O
to O
have O
registered O
a O
significant O
number O
of O
C2 O
domains O
. O

This O
actor O
is O
discussed O
in O
the O
next O
section O
. O

Many O
of O
the O
domains O
have O
had O
their O
registrant O
information O
changed O
, O
likely O
in O
an O
attempt O
to O
obfuscate O
the O
identity O
of O
the O
operators O
. O

For O
instance O
, O
several O
domains O
originally O
registered O
by O
cpyy O
had O
their O
email O
address O
updated O
to O
van.dehaim O
@ O
gmail.com O
around O
the O
end O
of O
2009 O
; O
for O
siseau.com O
the O
change O
occurred O
between O
July O
2009 O
and O
November O
2009 O
, O
and O
for O
vssigma.com O
, O
the O
change O
occurred O
between O
August O
2009 O
and O
December O
2009 O
. O

Historical O
registrant O
information O
for O
anfoundation.us O
, O
rwchateau.com O
, O
and O
succourtion.org O
was O
not O
available O
prior O
to O
2010 O
, O
but O
it O
is O
likely O
that O
these O
domains O
were O
also O
originally O
registered O
to O
a O
personally O
attributable O
email O
account O
. O

Similarly O
, O
several O
domains O
registered O
to O
mike.johnsonmj O
@ O
yahoo.com O
have O
had O
their O
registrant O
email O
updated O
during O
March O
2014 O
( O
see O
Table O
2 O
) O
. O

These O
registrant O
changes O
may O
indicate O
an O
increased O
awareness O
of O
operational O
security O
( O
OPSEC O
) O
from O
the O
PUTTER O
PANDA O
actors O
. O

The O
recent O
changes O
to O
the O
domains O
shown O
in O
Table O
2 O
may O
indicate O
that O
the O
operators O
are O
preparing O
new O
campaigns O
that O
make O
use O
of O
this O
infrastructure O
, O
or O
they O
are O
attempting O
to O
disassociate O
all O
these O
. O

Although O
no O
attributable O
information O
was O
found O
on O
the O
email O
addresses O
associated O
with O
the O
domains O
described O
above O
( O
aside O
from O
cpyy O
and O
httpchen O
– O
see O
below O
) O
, O
several O
other O
domains O
were O
found O
to O
have O
been O
registered O
by O
some O
of O
these O
addresses O
. O

These B-Entity
are O
shown O
in O
Table O
3 O
, O
and O
may O
be B-Action
used I-Action
for B-Modifier
command B-Entity
and I-Entity
control I-Entity
of I-Entity
PUTTER I-Entity
PANDA I-Entity
tools I-Entity
. O

domains O
from O
a O
single O
email O
address O
, O
perhaps O
due O
to O
OPSEC O
concerns O
or O
issues O
with O
the O
specific O
email O
account O
. O

The O
subdomains O
associated O
with O
these O
domains O
via O
DNS O
records O
, O
along O
with O
some O
of O
the O
domain O
names O
themselves O
, O
point O
to O
some O
areas O
of O
interest O
for O
the O
PUTTER O
PANDA O
operators O
( O
see O
also O
Droppers O
in O
the O
following O
Technical O
Analysis O
section O
) O
: O
• O
Space O
, O
satellite O
, O
and O
remote O
sensing O
technology O
( O
particularly O
within O
Europe O
) O
; O
• O
Aerospace O
, O
especially O
European O
aerospace O
companies O
; O
• O
Japanese O
and O
European O
telecommunications O
. O

It O
is O
likely O
that O
PUTTER O
PANDA O
will O
continue O
to O
attack O
targets O
of O
this O
nature O
in O
future O
intelligence- O
gathering O
operations O
. O

Based O
on O
passive O
DNS O
records O
, O
several O
PUTTER O
PANDA O
associated O
domains O
have O
resolved O
to O
IP O
address O
100.42.216.230 O
: O
Additionally O
, O
several O
subdomains O
of O
ujheadph.com O
resolved O
to O
this O
IP O
: O
Another O
subdomain O
of O
ujheadph.com O
has O
been O
observed O
in O
connection O
with O
distinctive O
traffic O
originating O
from O
the O
3PARA O
RAT O
( O
described O
below O
) O
, O
making O
it O
probable O
that O
this O
domain O
is O
also O
associated O
with O
PUTTER O
PANDA O
. O

The O
decipherment.net O
domains O
resolved O
to O
this O
IP O
address O
from O
11 O
October O
2012 O
to O
at O
least O
25 O
February O
2013 O
, O
and O
the O
botanict.com O
domain O
resolved O
from O
11 O
October O
2012 O
to O
24 O
March O
2013 O
. O

During O
part O
of O
this O
timeframe O
( O
30 O
June O
2012 O
- O
30 O
October O
2012 O
) O
, O
a O
domain O
associated O
with O
COMMENT O
PANDA O
resolved O
to O
this O
same O
IP O
address O
: O
login O
. O

aolon1ine.com O
. O

Additionally O
, O
for O
a O
brief O
period O
in O
April O
2012 O
, O
update8.firefoxupdata.com O
also O
resolved O
to O
this O
IP O
address O
. O

The O
use O
of O
the O
same O
IP O
address O
during O
the O
same O
time O
suggests O
that O
there O
is O
perhaps O
some O
cooperation O
or O
shared O
resources O
between O
COMMENT O
PANDA O
and O
PUTTER O
PANDA O
. O

Although O
not O
as O
conclusive O
as O
the O
links O
to O
COMMENT O
PANDA O
, O
IP O
address O
31.170.110.163 O
was O
associated O
with O
VIXEN O
PANDA O
domain O
blog O
. O

strancorproduct.info O
from O
November O
to O
December O
2013 O
. O

In O
February O
2014 O
, O
this O
IP O
address O
was O
also O
associated O
with O
PUTTER O
PANDA O
domain O
ske.hfmforum O
. O

com O
. O

While O
not O
directly O
overlapping O
, O
this O
potential O
infrastructure O
link O
is O
interesting O
, O
as O
VIXEN O
PANDA O
has O
previously O
displayed O
TTPs O
similar O
to O
COMMENT O
PANDA O
( O
other O
CrowdStrike O
reporting O
describes O
VIXEN O
PANDA O
malware O
that O
extracts O
C2 O
commands O
embedded O
between O
delimiters O
in O
web O
content O
) O
, O
and O
has O
extensively O
targeted O
European O
entities O
. O

11 O
Several O
email O
addresses O
have O
been O
associated O
with O
cpyy O
, O
who O
also O
appears O
to O
use O
the O
alternate O
handles O
cpiyy O
and O
cpyy.chen O
: O
The O
cpyy.net O
domain O
lists O
'' O
Chen O
Ping O
'' O
as O
the O
registrant O
name O
, O
which O
may O
be O
cpyy O
's O
real O
name O
, O
as O
this O
correlates O
with O
the O
initials O
'' O
cp O
'' O
in O
'' O
cpyy O
'' O
. O

A O
personal O
blog O
for O
cpyy O
was O
found O
at O
http O
: O
//cpiyy.blog.163.com/ O
. O

The O
profile O
on O
this O
blog O
( O
shown O
in O
Figure O
2 O
below O
) O
indicates O
that O
the O
user O
is O
male O
, O
was O
born O
on O
25 O
May O
1979 O
, O
and O
works O
for O
the O
'' O
military/police O
'' O
( O
其他- O
军人/警察 O
) O
. O

This O
blog O
contains O
two O
postings O
in O
the O
'' O
IT O
'' O
category O
that O
indicate O
at O
least O
a O
passing O
interest O
in O
the O
topics O
of O
networking O
and O
programming O
. O

A O
related O
CSDN O
profile O
for O
user O
cpiyy O
indicates O
that O
cpyy O
was O
working O
on O
or O
studying O
these O
topics O
in O
2002 O
and O
2003 O
. O

Another O
personal O
blog O
for O
cpyy O
( O
http O
: O
//www.tianya.cn/1569234/bbs O
) O
appears O
to O
have O
last O
been O
updated O
in O
2007 O
. O

This O
states O
that O
the O
user O
lives O
in O
Shanghai O
, O
and O
has O
a O
birthdate O
identical O
to O
that O
in O
the O
163.com O
blog O
. O

cpyy O
was O
also O
active O
on O
a O
social O
networking O
site O
called O
XCar O
, O
stating O
that O
he O
lived O
in O
Shanghai O
as O
early O
as O
2005 O
through O
2007 O
; O
he O
said O
in O
a O
post O
, O
'' O
Soldier O
's O
duty O
is O
to O
defend O
the O
country O
, O
as O
long O
as O
our O
country O
is O
safe O
, O
our O
military O
is O
excellent O
'' O
, O
indicating O
a O
feeling O
of O
patriotism O
that O
could O
be O
consistent O
with O
someone O
who O
chose O
a O
military O
or O
police-based O
career O
. O

On O
the O
XCar O
forum O
, O
cpyy.chen O
used O
a O
subforum O
called O
POLO O
( O
hacker O
slang O
for O
'' O
Volkswagen O
cars O
'' O
) O
to O
communicate O
with O
other O
users O
Linxder O
, O
peggycat O
, O
'' O
Naturally O
do O
not O
understand O
romance O
'' O
( O
天生不懂浪漫 O
) O
, O
'' O
a O
wolf O
'' O
( O
一只大灰狼 O
) O
, O
'' O
large O
tile O
'' O
( O
大瓦片 O
) O
, O
'' O
winter O
'' O
( O
冬夜 O
) O
, O
'' O
chunni O
'' O
( O
春妮 O
) O
, O
papaya O
, O
kukuhaha O
, O
Cranbing O
, O
'' O
dusty O
sub O
'' O
( O
多尘子 O
) O
, O
z11829 O
, O
'' O
ice O
star O
harbor O
'' O
( O
冰星港 O
) O
, O
'' O
polytechnic O
Aberdeen O
'' O
( O
理工仔 O
) O
, O
'' O
I O
love O
pineapple O
pie O
'' O
( O
我爱菠罗派 O
) O
, O
and O
'' O
she O
's O
distant O
'' O
in O
2007 O
. O

Although O
superficially O
the O
discussion O
is O
about O
cars O
, O
there O
is O
a O
repeated O
word O
in O
the O
text O
, O
'' O
milk O
yellow O
package O
'' O
or O
'' O
custard O
package O
'' O
or O
'' O
yoke O
package O
'' O
( O
奶黄包 O
) O
. O

This O
could O
be O
a O
hacker O
slang O
word O
, O
but O
it O
is O
unclear O
as O
to O
the O
definition O
. O

The O
conversation O
alludes O
to O
Linxder O
being O
the O
'' O
teacher O
'' O
or O
'' O
landlord O
'' O
and O
the O
other O
aforementioned O
users O
are O
his O
'' O
students O
'' O
. O

Linxder O
references O
how O
he O
has O
'' O
found O
jobs O
'' O
for O
them O
. O

It O
is O
possible O
that O
this O
is O
a O
reference O
to O
hacking O
jobs O
wrapped O
up O
in O
car O
metaphors O
. O

Linxder O
is O
the O
handle O
of O
an O
actor O
associated O
with O
the O
likely O
Shanghai-based O
COMMENT O
PANDA O
group O
. O

Linxder O
, O
cpyy O
, O
and O
xiaobai O
have O
all O
discussed O
programming O
and O
security O
related O
topics O
on O
cpyy O
's O
site O
, O
cpyy.org O
, O
which O
hosted O
a O
discussion O
forum O
for O
the O
711 O
Network O
Security O
Team O
( O
see O
below O
) O
. O

cpyy O
also O
appears O
to O
have O
a O
keen O
interest O
in O
photography O
; O
his O
163.com O
blog O
includes O
several O
photographs O
taken O
by O
cpyy O
in O
the O
blog O
postings O
and O
albums O
section O
. O

Some O
of O
these O
photographs O
also O
appear O
in O
a O
Picasa O
site O
( O
examples O
are O
shown O
in O
Figures O
5 O
and O
6 O
) O
belonging O
to O
a O
user O
cpyy.chen O
. O

An O
album O
in O
this O
site O
named O
'' O
me O
'' O
has O
several O
shots O
of O
what O
is O
likely O
cpyy O
himself O
, O
from O
2005 O
, O
2006 O
, O
and O
2007 O
, O
shown O
to O
the O
right O
: O
An O
account O
on O
rootkit.com O
, O
a O
popular O
low-level O
software O
security O
site O
, O
existed O
for O
user O
cpyy O
and O
was O
accessed O
in O
at O
least O
May O
2004 O
. O

This O
account O
was O
registered O
with O
primary O
email O
address O
cpyy O
@ O
cpyy.net O
and O
backup O
email O
address O
cpyy O
@ O
hotmail.com O
; O
it O
listed O
a O
date O
of O
birth O
as O
24 O
May O
1979 O
, O
consistent O
with O
cpyy O
's O
other O
profiles O
. O

The O
IP O
address O
218.242.252.214 O
was O
associated O
with O
this O
account O
; O
it O
is O
owned O
by O
the O
Oriental O
Cable O
Network O
Co. O
, O
Ltd. O
, O
an O
ISP O
located O
in O
Shanghai O
. O

Registration O
on O
this O
forum O
shows O
that O
cpyy O
had O
an O
interest O
in O
security-related O
programming O
topics O
, O
which O
is O
backed O
up O
by O
the O
postings O
on O
his O
personal O
blog O
and O
CSDN O
account O
. O

One O
of O
the O
sites O
registered O
to O
cpyy O
was O
used O
to O
host O
a O
web-based O
email O
service O
, O
along O
with O
a O
forum O
on O
www O
. O

cpyy.net O
. O

Both O
of O
these O
services O
were O
apparently O
run O
by O
the O
711 O
Network O
Security O
Team O
( O
711网络安全小组 O
) O
, O
a O
group O
that O
is O
now O
likely O
defunct O
, O
but O
has O
previously O
published O
security-based O
articles O
that O
have O
been O
re-posted O
on O
popular O
Chinese O
hacking O
sites O
such O
as O
xfocus.net O
. O

One O
of O
these O
articles O
, O
entitled O
'' O
IMD-based O
packet O
filtering O
firewall O
to O
achieve O
the O
principles O
'' O
, O
is O
apparently O
authored O
by O
xiaobai O
, O
with O
email O
address O
xiaobai O
@ O
openfind.com.cn O
; O
it O
was O
published O
on O
the O
'' O
GRATEFUL O
'' O
( O
饮水思源 O
) O
security O
digest O
list O
that O
is O
hosted O
by O
Shanghai O
Jiao O
Tong O
University O
( O
SJTU O
) O
. O

This O
digest O
list/bulletin O
board O
was O
also O
frequented O
by O
ClassicWind O
, O
an O
actor O
possibly O
linked O
to O
the O
Shanghai-based O
, O
PLA-sponsored O
adversary O
group O
COMMENT O
PANDA O
, O
as O
described O
in O
. O

This O
Tipper O
also O
indicates O
that O
'' O
the O
Chinese O
Communist O
Party O
( O
CCP O
) O
and O
the O
People O
's O
Liberation O
Army O
( O
PLA O
) O
aggressively O
target O
SJTU O
and O
its O
School O
of O
Information O
Security O
Engineering O
( O
SISE O
) O
as O
a O
source O
of O
research O
and O
student O
recruitment O
to O
conduct O
network O
offense O
and O
defense O
campaigns O
'' O
, O
so O
it O
is O
possible O
that O
the O
711 O
Network O
Security O
Team O
members O
came O
to O
the O
attention O
of O
the O
Chinese O
state O
via O
this O
institution O
. O

An O
additional O
connection O
to O
SJTU O
comes O
from O
a O
C2 O
domain O
, O
checalla.com O
, O
used O
with O
the O
4H O
RAT O
in O
2008 O
. O

This O
domain O
was O
registered O
to O
httpchen O
@ O
gmail O
. O

com O
at O
the O
time O
, O
and O
this O
address O
was O
also O
used O
to O
make O
a O
posting O
on O
the O
GRATEFUL O
BBS O
( O
shown O
in O
Figure O
7 O
) O
. O

The O
posting O
indicates O
that O
httpchen O
is O
located O
at O
the O
闵行 O
( O
Minhang O
) O
campus O
of O
SJTU O
and O
was O
posting O
using O
IP O
address O
58.196.156.15 O
, O
which O
is O
associated O
with O
the O
China O
Education O
and O
Research O
Network O
( O
CERNET O
) O
, O
a O
nationwide O
network O
managed O
by O
the O
Chinese O
Ministry O
of O
Education O
. O

It O
also O
states O
that O
httpchen O
is O
studying O
at O
the O
school O
of O
Information O
Security O
Engineering O
within O
SJTU O
. O

Several O
pieces O
of O
evidence O
indicate O
that O
cpyy O
probably O
has O
connections O
to O
, O
or O
is O
part O
of O
, O
the O
Chinese O
military O
– O
specifically O
the O
PLA O
Army O
. O

In O
addition O
to O
his O
declaration O
on O
his O
personal O
blog O
that O
he O
works O
for O
the O
'' O
military/ O
police O
'' O
, O
and O
contacts O
with O
actors O
such O
as O
Linxder O
that O
have O
been O
previously O
associated O
with O
hacking O
units O
within O
the O
PLA O
, O
cpyy O
's O
Picasa O
site O
contains O
several O
photographs O
that O
hint O
at O
military O
connections O
. O

First O
, O
a O
monochrome O
picture O
from O
the O
大学时代 O
( O
'' O
college O
'' O
) O
album O
posted O
in O
February O
2007 O
shows O
several O
uniformed O
individuals O
: O
It O
is O
not O
clear O
whether O
this O
picture O
includes O
cpyy O
, O
or O
just O
friends/ O
associates/relatives O
. O

A O
picture O
from O
the O
中学时代 O
( O
'' O
high O
school O
'' O
) O
album O
posted O
in O
February O
2007 O
shows O
a O
male O
– O
likely O
cpyy O
based O
on O
the O
clothing O
shown O
in O
the O
second O
picture O
, O
which O
matches O
the O
pictures O
of O
cpyy O
shown O
above O
– O
performing O
exercise O
in O
front O
of O
a O
group O
of O
likely O
soldiers O
and O
an O
officer O
: O
Although O
somewhat O
unclear O
, O
pictures O
from O
the O
album O
2002年的生日 O
( O
'' O
2002 O
birthday O
'' O
) O
, O
also O
posted O
in O
February O
2007 O
, O
show O
the O
celebrant O
( O
likely O
cpyy O
) O
in O
khaki O
clothes O
that O
are O
possibly O
military O
wear O
. O

The O
most O
compelling O
pictures O
, O
however O
, O
are O
found O
in O
the O
宿舍 O
and O
办公室 O
albums O
( O
'' O
dormitory O
'' O
and O
'' O
office O
'' O
) O
. O

A O
shot O
of O
probably O
cpyy O
's O
dormitory O
room O
shows O
in O
the O
background O
two O
military O
hats O
that O
appear O
to O
be O
Type O
07 O
PLA O
Army O
officer O
peak O
hats O
: O
18 O
This O
album O
also O
contains O
a O
shot O
of O
the O
exterior O
of O
a O
building O
with O
several O
large O
satellite O
dishes O
outside O
: O
This O
same O
building O
and O
the O
satellite O
dishes O
also O
appear O
in O
the O
'' O
office O
'' O
album O
. O

The O
reflection O
effects O
observed O
on O
the O
windows O
of O
this O
building O
could O
be O
due O
to O
coatings O
applied O
to O
resist O
eavesdropping O
via O
laser O
microphones O
and O
to O
increase O
privacy O
, O
which O
would O
be O
consistent O
with O
a O
military O
installation O
conducting O
sensitive O
work O
. O

Above O
is O
an O
image O
from O
the O
same O
album O
of O
what O
appears O
to O
be O
a O
larger O
dish O
, O
in O
front O
of O
the O
Oriental O
Pearl O
Tower O
, O
a O
significant O
landmark O
in O
Shanghai O
: O
As O
mentioned O
above O
, O
checalla.com O
was O
used O
for O
command O
and O
control O
with O
the O
PUTTER O
PANDA O
4H O
RAT O
in O
2008 O
. O

This O
domain O
was O
registered O
to O
httpchen O
@ O
gmail.com O
, O
and O
in O
May O
2009 O
the O
domain O
registration O
details O
were O
updated O
to O
include O
a O
Registrant O
Address O
of O
'' O
shanghai O
yuexiulu O
46 O
45 O
202 O
# O
'' O
. O

A O
search O
for O
this O
location O
reveals O
an O
area O
of O
Shanghai O
shown O
in O
Figure O
8 O
. O

Figure O
9 O
shows O
an O
enlargement O
of O
satellite O
imagery O
from O
within O
this O
area O
, O
depicting O
a O
facility O
containing O
several O
satellite O
dishes O
within O
green O
areas O
, O
sports O
courts O
and O
a O
large O
office O
building O
. O

Satellite O
imagery O
from O
2009 O
showing O
another O
aspect O
of O
this O
office O
building O
, O
along O
with O
a O
likely O
vantage O
point O
and O
direction O
of O
camera O
, O
alongside O
probably O
cpyy O
's O
photograph O
from O
the O
same O
angle O
, O
is O
shown O
in O
Figure O
10 O
: O
Based O
on O
the O
Shanghai O
location O
, O
and O
common O
features O
, O
it O
is O
highly O
likely O
that O
the O
location O
shown O
above O
is O
the O
same O
as O
that O
photographed O
by O
cpyy O
and O
shown O
in O
the O
'' O
office O
'' O
and O
'' O
dormitory O
'' O
albums O
. O

Further O
confirmation O
can O
be O
found O
from O
photos O
uploaded O
by O
a O
user O
on O
Panoramio O
who O
tags O
the O
image O
as O
being O
located O
in O
Chabei O
, O
Shanghai O
, O
China O
( O
31° O
17 O
' O
18.86 O
'' O
N O
121° O
27 O
' O
9.83 O
'' O
E O
) O
. O

This O
image O
is O
exceptionally O
similar O
to O
building O
shown O
in O
cpyy O
's O
'' O
office O
'' O
album O
( O
see O
Figure O
11 O
below O
) O
. O

According O
to O
a O
public O
report O
on O
the O
Chinese O
PLA O
's O
General O
Staff O
Department O
( O
GSD O
) O
, O
the O
12th O
Bureau O
of O
the O
3rd O
GSD O
is O
headquartered O
in O
the O
Zhabei O
district O
of O
Shanghai O
and O
'' O
appears O
to O
have O
a O
functional O
mission O
involving O
satellites O
, O
likely O
inclusive O
of O
intercept O
of O
satellite O
communications O
and O
possibly O
space-based O
SIGINT O
collection O
'' O
. O

The O
same O
report O
also O
lists O
a O
Military O
Unit O
Cover O
Designator O
( O
MUCD O
) O
of O
61486 O
for O
this O
bureau O
. O

A O
webpage O
published O
on O
a O
Chinese O
government O
site O
detailing O
theatrical O
performances O
involving O
members O
of O
the O
PLA O
lists O
an O
address O
of O
'' O
闸北区粤秀路46号 O
'' O
( O
46 O
Yue O
Xiu O
Road O
, O
Zhabei O
District O
) O
for O
'' O
总参61486部队 O
'' O
( O
61486 O
Forces O
General O
Staff O
) O
. O

A O
search O
for O
this O
location O
shows O
an O
identical O
area O
to O
that O
shown O
in O
Figure O
8 O
. O

It O
can O
therefore O
be O
concluded O
with O
high O
confidence O
that O
the O
location O
shown O
in O
cpyy O
's O
imagery O
, O
along O
with O
the O
satellite O
images O
above O
, O
is O
the O
headquarters O
of O
the O
12th O
Bureau O
, O
3rd O
GSD O
, O
Chinese O
PLA O
– O
also O
known O
as O
Unit O
61486 O
. O

This O
unit O
's O
suspected O
involvement O
in O
'' O
space O
surveillance O
'' O
and O
'' O
intercept O
of O
satellite O
communications O
'' O
fits O
with O
their O
observed O
targeting O
preferences O
for O
Western O
companies O
producing O
technologies O
in O
the O
space O
and O
imaging/remote O
sensing O
sectors O
. O

The O
size O
and O
number O
of O
dishes O
present O
in O
the O
area O
is O
also O
consistent O
with O
these O
activities O
. O

Observed O
build O
times O
for O
the O
PUTTER O
PANDA O
tools O
described O
in O
this O
report O
range O
from O
2007 O
to O
late O
2013 O
, O
indicating O
that O
the O
actors O
have O
conducted O
several O
campaigns O
against O
their O
objectives O
over O
a O
period O
of O
several O
years O
. O

A O
build O
time O
analysis O
of O
all O
known O
samples O
is O
shown O
in O
Figure O
1 O
below O
, O
relative O
to O
China O
time O
. O

Although O
this O
shows O
that O
there O
is O
some O
bias O
in O
the O
build O
time O
distribution O
to O
daylight O
or O
working O
hours O
in O
China O
, O
which O
is O
more O
significant O
if O
a O
possible O
three-shift O
system O
of O
hours O
is O
considered O
( O
0900-1200 O
, O
1400-1700 O
, O
and O
2000-2300 O
) O
, O
this O
evidence O
is O
not O
conclusive O
. O

There O
is O
also O
some O
evidence O
that O
build O
times O
are O
manipulated O
by O
the O
adversary O
; O
for O
example O
, O
the O
sample O
with O
MD5 O
hash O
bc4e9dad71b844dd3233cfbbb96c1bd3 O
has O
a O
build O
time O
of O
18 O
July O
2013 O
, O
but O
was O
supposedly O
first O
submitted O
to O
VirusTotal O
on O
9 O
January O
2013 O
. O

This O
shows O
that O
the O
attackers O
– O
at O
least O
in O
2013 O
– O
were O
aware O
of O
some O
operational O
security O
considerations O
and O
were O
likely O
taking O
deliberate O
steps O
to O
hide O
their O
origins O
. O

There O
is O
strong O
evidence O
to O
tie O
cpyy O
, O
an O
actor O
who O
appears O
to O
have O
been O
involved O
in O
historical O
PUTTER O
PANDA O
operations O
, O
to O
the O
PLA O
army O
and O
a O
location O
in O
Shanghai O
that O
is O
operated O
by O
the O
12th O
Bureau O
, O
3rd O
GSD O
of O
the O
PLA O
( O
Unit O
61486 O
) O
. O

Another O
actor O
tied O
to O
this O
activity O
, O
httpchen O
, O
has O
declared O
publically O
that O
he O
was O
attending O
the O
School O
of O
Information O
Security O
Engineering O
at O
SJTU O
. O

This O
university O
has O
previously O
been O
posited O
as O
a O
recruiting O
ground O
for O
the O
PLA O
to O
find O
personnel O
for O
its O
cyber O
intelligence O
gathering O
units O
, O
and O
there O
is O
circumstantial O
evidence O
linked O
cpyy O
to O
other O
actors O
based O
at O
SJTU O
. O

Given O
the O
evidence O
outlined O
above O
, O
CrowdStrike O
attributes O
the O
PUTTER O
PANDA O
group O
to O
PLA O
Unit O
61486 O
within O
Shanghai O
, O
China O
with O
high O
confidence O
. O

It O
is O
likely O
that O
this O
organization O
is O
staffed O
in O
part O
by O
current O
or O
former O
students O
of O
SJTU O
, O
and O
shares O
some O
resources O
and O
direction O
with O
PLA O
Unit O
61398 O
( O
COMMENT O
PANDA O
) O
. O

Several B-Entity
RATs I-Entity
are B-Action
used I-Action
by O
PUTTER B-Entity
PANDA I-Entity
. O

The O
most O
common O
of O
these O
, O
the O
4H O
RAT O
and O
the O
3PARA O
RAT O
, O
have O
been O
documented O
previously O
by O
CrowdStrike O
in O
previous O
CrowdStrike O
Intelligence O
reporting O
. O

This O
analysis O
will O
be O
revisited O
below O
, O
along O
with O
an O
examination O
of O
two O
other O
PUTTER O
PANDA O
tools O
: O
pngdowner O
and O
httpclient O
. O

Two B-Entity
droppers I-Entity
have O
been B-Action
associated I-Action
with B-Modifier
the B-Entity
PUTTER I-Entity
PANDA I-Entity
toolset I-Entity
; O
these O
are O
also O
briefly O
examined O
below O
. O

This O
RAT O
was O
first O
analyzed O
by O
CrowdStrike O
in O
April O
2012 O
, O
but O
a O
historical O
analysis O
shows O
that O
it O
has O
been O
in O
use O
since O
at O
least O
2007 O
by O
the O
PUTTER O
PANDA O
actors O
. O

A O
listing O
of O
metadata O
for O
known O
samples O
, O
including O
C2 O
information O
, O
is O
shown O
in O
Appendix O
1 O
. O

The O
operation O
of O
this O
RAT O
is O
described O
in O
detail O
in O
other O
CrowdStrike O
reporting O
, O
but O
is O
useful O
to O
revisit O
here O
to O
highlight O
the O
characteristics O
of O
the O
RAT O
: O
• O
C2 B-Entity
occurs B-Action
over B-Modifier
HTTP B-Entity
, O
after B-Modifier
connectivity B-Entity
has I-Entity
been I-Entity
verified I-Entity
by I-Entity
making I-Entity
a I-Entity
distinctive I-Entity
request I-Entity
( I-Entity
to I-Entity
the I-Entity
URI I-Entity
/ I-Entity
search I-Entity
? I-Entity
qu= I-Entity
at I-Entity
www.google.com I-Entity
) I-Entity
. O

• O
A B-Entity
victim I-Entity
identifier I-Entity
is B-Action
generated I-Action
from B-Modifier
the B-Entity
infected I-Entity
machine I-Entity
's I-Entity
hard I-Entity
disk I-Entity
serial I-Entity
number I-Entity
, O
XOR'ed O
with O
the O
key O
ldd46 O
! O
yo O
, O
and O
finally O
nibble-wise O
encoded O
as O
upper-case O
ASCII O
characters O
in O
the O
range O
( O
A-P O
) O
– O
e.g. O
, O
the O
byte O
value O
0x1F O
becomes O
'' O
BP O
'' O
. O

• O
A B-Entity
series I-Entity
of I-Entity
HTTP I-Entity
requests I-Entity
characterizes B-Action
the B-Entity
RAT I-Entity
's I-Entity
C2 I-Entity
. O

The B-Entity
initial I-Entity
beacon I-Entity
uses B-Action
a B-Entity
request I-Entity
with I-Entity
four I-Entity
parameters I-Entity
( I-Entity
h1 I-Entity
, I-Entity
h2 I-Entity
, I-Entity
h3 I-Entity
, I-Entity
and I-Entity
h4 I-Entity
) I-Entity
– O
as O
shown O
in O
Figure O
8 O
– O
to B-Modifier
register B-Entity
the I-Entity
implant I-Entity
with I-Entity
the I-Entity
C2 I-Entity
server I-Entity
. O

• O
Communication B-Entity
to I-Entity
and I-Entity
from I-Entity
the I-Entity
C2 I-Entity
server I-Entity
is B-Action
obfuscated I-Action
using B-Modifier
a B-Entity
1-byte I-Entity
XOR I-Entity
with I-Entity
the I-Entity
key I-Entity
0xBE I-Entity
. O

• O
The B-Entity
commands I-Entity
supported B-Action
by O
the B-Entity
RAT I-Entity
enable O
several O
capabilities O
, O
including O
: O
The O
3PARA O
RAT O
was O
described O
in O
some O
detail O
in O
other O
CrowdStrike O
reporting O
, O
which O
examined O
a O
DLL-based O
sample O
with O
an O
exported O
filename O
of O
ssdpsvc.dll O
. O

Other O
observed O
exported O
filenames O
are O
msacem.dll O
and O
mrpmsg.dll O
, O
although O
the O
RAT O
has O
also O
been O
observed O
in O
plain O
executable O
( O
EXE O
) O
format O
. O

On O
startup O
, O
the B-Entity
RAT I-Entity
attempts O
to O
create B-Action
a B-Entity
file I-Entity
mapping I-Entity
named I-Entity
& I-Entity
*SDKJfhksdf89*DIUKJDSF I-Entity
& I-Entity
*sdfsdf78sdfsdf I-Entity
. O

This B-Entity
is B-Action
used I-Action
to B-Modifier
prevent B-Entity
multiple I-Entity
instances I-Entity
of I-Entity
the I-Entity
RAT I-Entity
being I-Entity
executed I-Entity
simultaneously I-Entity
. O

The B-Entity
RAT I-Entity
will O
then O
use B-Action
a B-Entity
byte-wise I-Entity
subtraction- I-Entity
based I-Entity
algorithm I-Entity
( I-Entity
using I-Entity
a I-Entity
hard-coded I-Entity
modulo I-Entity
value I-Entity
) I-Entity
to B-Modifier
decode B-Entity
C2 I-Entity
server I-Entity
details I-Entity
consisting I-Entity
of I-Entity
a I-Entity
server I-Entity
hostname I-Entity
and I-Entity
port I-Entity
number I-Entity
, I-Entity
in I-Entity
this I-Entity
example I-Entity
nsc.adomhn I-Entity
. I-Entity
com I-Entity
, I-Entity
port I-Entity
80 I-Entity
. O

The O
decoding O
algorithm O
is O
illustrated O
in O
Figure O
10 O
below O
. O

The O
key O
and O
modulo O
values O
vary O
on O
a O
per-sample O
basis O
. O

Decoded O
C2 O
settings O
, O
along O
with O
sample O
metadata O
, O
are O
listed O
in O
Appendix O
2 O
. O

The O
RAT O
is O
programmed O
in O
C++ O
using O
Microsoft O
Visual O
Studio O
, O
and O
it O
makes O
use O
of O
the O
object-oriented O
and O
parallel O
programming O
features O
of O
this O
environment O
; O
Standard O
Template O
Library O
( O
STL O
) O
objects O
are O
used O
to O
represent O
data O
structures O
such O
as O
strings O
and O
lists O
, O
and O
custom O
objects O
are O
used O
to O
represent O
some O
of O
the O
C2 O
command O
handlers O
( O
e.g. O
, O
CCommandCMD O
) O
. O

Several O
threads O
are O
used O
to O
handle O
different O
stages O
of O
the O
C2 O
protocol O
, O
such O
as O
receiving B-Action
data B-Entity
from B-Modifier
the B-Entity
server I-Entity
, O
decrypting B-Action
data B-Entity
, O
and O
processing B-Action
commands B-Entity
. O

Standard O
Windows O
primitives O
such O
as O
Events O
are O
used O
to O
synchronize O
across O
these O
threads O
, O
with O
a O
shared O
global O
structure O
used O
to O
hold O
state O
. O

Once O
running O
, O
the B-Entity
RAT I-Entity
will O
load B-Action
a B-Entity
binary I-Entity
representation I-Entity
of I-Entity
a I-Entity
date/time I-Entity
value I-Entity
from B-Modifier
a B-Entity
file I-Entity
C I-Entity
: I-Entity
\RECYCLER\restore.dat I-Entity
, O
and O
it B-Entity
will O
sleep B-Action
until B-Modifier
after I-Modifier
this B-Entity
date/time I-Entity
has I-Entity
passed I-Entity
. O

Database O
provides O
a O
mechanism O
for O
the O
operators O
to O
allow O
the B-Entity
RAT I-Entity
to O
remain B-Action
dormant B-Entity
until B-Modifier
a B-Entity
fixed I-Entity
time I-Entity
, O
perhaps O
to O
allow O
a O
means O
of O
regaining O
access O
if O
other O
parts O
of O
their O
toolset O
are O
removed O
from O
a O
victim O
system O
. O

As O
with O
the O
4H O
RAT O
, O
the B-Entity
C2 I-Entity
protocol I-Entity
used B-Action
by O
the B-Entity
3PARA I-Entity
RAT I-Entity
is B-Action
HTTP B-Entity
based I-Entity
, O
using B-Action
both O
GET B-Entity
and O
POST B-Entity
requests I-Entity
. O

An B-Entity
initial I-Entity
request I-Entity
is B-Action
made I-Action
to B-Modifier
the B-Entity
C2 I-Entity
server I-Entity
( O
illustrated O
in O
Figure O
11 O
above O
) O
, O
but O
the O
response O
value O
is O
effectively O
ignored O
; O
it O
is O
likely O
that O
this B-Entity
request I-Entity
serves B-Action
only O
as B-Modifier
a B-Entity
connectivity I-Entity
check I-Entity
, O
as O
further O
C2 O
activity O
will O
only O
occur O
if O
this O
first O
request O
is O
successful O
. O

In O
this O
case O
, O
the B-Entity
RAT I-Entity
will O
transmit B-Action
some B-Entity
basic I-Entity
victim I-Entity
information I-Entity
to I-Entity
the I-Entity
C2 I-Entity
server I-Entity
along B-Modifier
with I-Modifier
a B-Entity
256-byte I-Entity
hash I-Entity
of I-Entity
the I-Entity
hard-coded I-Entity
string I-Entity
HYF54 I-Entity
& I-Entity
% I-Entity
9 I-Entity
& I-Entity
jkMCXuiS I-Entity
. O

It O
is O
likely O
that O
this B-Entity
request I-Entity
functions O
as O
a O
means O
to O
authenticate O
the O
RAT O
to O
the O
C2 O
server O
and O
register B-Action
a B-Entity
new I-Entity
victim I-Entity
machine I-Entity
with B-Modifier
the B-Entity
controller I-Entity
. O

A O
sample O
request O
and O
its O
structure O
are O
shown O
in O
Figure O
12 O
. O

If O
this O
request O
is O
also O
successful O
, O
the B-Entity
RAT I-Entity
will O
attempt O
to O
retrieve B-Action
tasking B-Entity
from B-Modifier
the B-Entity
controller I-Entity
using B-Modifier
a B-Entity
further I-Entity
distinctive I-Entity
HTTP I-Entity
request I-Entity
shown I-Entity
in I-Entity
Figure I-Entity
13 I-Entity
, O
repeating O
this O
request O
every O
two O
seconds O
until O
valid O
tasking O
is O
returned O
. O

Returned O
tasking O
is O
decrypted O
using O
the O
DES O
algorithm O
in O
CBC O
mode O
with O
a O
key O
derived O
from O
the O
MD5 O
hash O
of O
the O
string O
HYF54 O
& O
% O
9 O
& O
jkMCXuiS O
( O
as O
used O
in O
the O
secondary O
beacon O
shown O
above O
) O
. O

If O
this O
fails O
, O
the O
RAT O
will O
fall O
back O
to O
decoding O
the O
data O
using O
an O
8-byte O
XOR O
with O
a O
key O
derived O
from O
data O
returned O
from O
the O
HashData O
API O
with O
the O
same O
key O
string O
. O

Output B-Entity
data I-Entity
produced I-Entity
by I-Entity
tasking I-Entity
instructions I-Entity
is B-Action
encrypted I-Action
in B-Modifier
the B-Entity
same I-Entity
manner I-Entity
as I-Entity
it I-Entity
was I-Entity
decrypted I-Entity
and O
sent B-Action
back B-Modifier
to I-Modifier
the B-Entity
C2 I-Entity
server I-Entity
via B-Modifier
HTTP B-Entity
POST I-Entity
request I-Entity
to I-Entity
a I-Entity
URI I-Entity
of I-Entity
the I-Entity
form I-Entity
/microsoft/errorpost/ I-Entity
default.aspx I-Entity
? I-Entity
ID= I-Entity
, O
where O
the O
ID O
value O
is O
a O
random O
number O
in O
decimal O
representation O
– O
as O
with O
the O
initial O
request O
shown O
in O
Figure O
4 O
. O

The B-Entity
set I-Entity
of I-Entity
commands I-Entity
supported B-Action
by O
the B-Entity
RAT I-Entity
is O
somewhat O
limited O
, O
indicating O
that O
perhaps O
the O
RAT O
is O
intended O
to O
be O
used O
as O
a O
second-stage O
tool O
, O
or O
as O
a O
failsafe O
means O
for O
the O
attackers O
to O
regain O
basic O
access O
to O
a O
compromised O
system O
( O
which O
is O
consistent O
with O
its O
support O
for O
sleeping B-Action
until B-Modifier
a B-Entity
certain I-Entity
date/time I-Entity
) O
. O

Some O
of O
the O
supported O
commands O
are O
implemented O
using O
C++ O
classes O
derived O
from O
a O
base O
CCommand O
class O
: O
•C O
CommandAttribe O
– O
Retrieve O
metadata O
for O
files O
on O
disk O
, O
or O
set O
certain O
attributes O
such O
as O
creation/ O
modification O
timestamps O
. O

• O
CCommandCD O
– O
Change O
the O
working O
directory O
for O
the O
current O
C2 O
session O
. O

•C O
CommandCMD O
– O
Execute O
a O
command O
, O
with O
standard O
input/output/error O
redirected O
over O
the O
C2 O
channel O
. O

• O
CCommandNOP O
– O
List O
the O
current O
working O
directory O
. O

However O
, O
other O
commands O
are O
not O
implemented O
in O
this O
way O
. O

These O
other O
commands O
contain O
functionality O
to O
: O
• O
Pause O
C2 O
activity O
for O
a O
random O
time O
interval O
. O

• O
Shutdown O
C2 O
activity O
and O
exit O
. O

•P O
rovide O
a O
date O
and O
time O
before O
which O
beaconing O
will O
not O
resume O
, O
recorded O
in O
the O
file O
C O
: O
\RECYCLER\ O
restore.dat O
as O
noted O
above O
. O

The O
use O
of O
C++ O
classes O
that O
inherit O
from O
a O
base O
class O
to O
carry O
out O
some O
of O
the O
tasking O
commands O
, O
along O
with O
the O
use O
of O
concurrency O
features O
, O
indicates O
that O
the O
developers O
of O
the O
RAT O
put O
some O
thought O
into O
the O
architecture O
and O
design O
of O
their O
tool O
, O
although O
the O
decision O
to O
implement O
some O
commands O
outside O
of O
the O
class-based O
framework O
is O
curious O
, O
and O
may O
indicate O
multiple O
developers O
worked O
on O
the O
RAT O
( O
or O
a O
single O
developer O
with O
shifting O
preferences O
for O
his O
coding O
style O
) O
. O

The O
pngdowner O
malware O
is O
a O
simple O
tool O
constructed O
using O
Microsoft O
Visual O
Studio O
and O
implemented O
via O
single O
C++ O
source O
code O
file O
. O

This O
sample O
contains O
a O
PDB O
path O
of O
Y O
: O
\Visual O
Studio O
2005\Projects\branch-downer\ O
downer\Release\downer.pdb O
, O
but O
other O
similar O
paths O
Z O
: O
\Visual O
Studio O
2005\Projects\pngdowner\Release\ O
pngdowner.pdb O
and O
Z O
: O
\Visual O
Studio O
2005\Projects\downer\Release\downer.pdb O
have O
also O
been O
observed O
in O
other O
samples O
. O

Appendix O
3 O
lists O
metadata O
for O
known O
pngdowner O
samples O
. O

Initially O
, O
the B-Entity
malware I-Entity
will O
perform B-Action
a B-Entity
connectivity I-Entity
check I-Entity
to B-Modifier
a B-Entity
hard-coded I-Entity
URL I-Entity
( I-Entity
http I-Entity
: I-Entity
//www.microsoft.com I-Entity
) I-Entity
, O
using B-Modifier
a B-Entity
constant I-Entity
user I-Entity
agent I-Entity
Mozilla/4.0 I-Entity
( I-Entity
Compatible I-Entity
; I-Entity
MSIE I-Entity
6.0 I-Entity
; I-Entity
) I-Entity
. O

If O
this O
request O
fails O
, O
the B-Entity
malware I-Entity
will O
attempt O
to O
extract B-Action
proxy B-Entity
details I-Entity
and I-Entity
credentials I-Entity
from B-Modifier
Windows B-Entity
Protected I-Entity
Storage I-Entity
, O
and O
from B-Modifier
the B-Entity
IE I-Entity
Credentials I-Entity
Store I-Entity
using B-Modifier
publicly B-Entity
known I-Entity
methods15 I-Entity
, O
using O
the O
proxy O
credentials O
for O
subsequent O
requests O
if O
they O
enable O
outbound O
HTTP O
access O
. O

An B-Entity
initial I-Entity
request I-Entity
is B-Action
then I-Action
made I-Action
to B-Modifier
the B-Entity
hard-coded I-Entity
C2 I-Entity
server I-Entity
and I-Entity
initial I-Entity
URI I-Entity
– O
forming O
a O
URL O
of O
the O
form O
( O
in O
this O
sample O
) O
http O
: O
//login.stream-media.net/files/xx11/index.asp O
? O
95027775 O
, O
where O
the O
numerical O
parameter O
represents O
a O
random O
integer O
. O

A O
hard-coded O
user O
agent O
of O
myAgent O
is O
used O
for O
thisrequest O
, O
and O
subsequent O
communication O
with O
the O
C2 O
server O
. O

Content O
returned O
from O
this O
request O
to O
the O
C2 O
server O
will O
be O
saved O
to O
a O
file O
named O
index.dat O
in O
the O
user's O
temporary O
directory O
( O
i.e. O
, O
% O
TEMP O
% O
) O
. O

This O
file O
is O
expected O
to O
contain O
a O
single O
line O
, O
specifying O
a O
URL O
and O
a O
filename O
. O

The B-Entity
malware I-Entity
will O
then O
attempt O
to O
download B-Action
content B-Entity
from B-Modifier
the B-Entity
specified I-Entity
URL I-Entity
to B-Modifier
the B-Entity
filename I-Entity
within I-Entity
the I-Entity
user I-Entity
's I-Entity
temporary I-Entity
directory I-Entity
, O
and O
then O
execute B-Action
this B-Entity
file I-Entity
via B-Modifier
the B-Entity
WinExec I-Entity
API I-Entity
. O

If O
this O
execution O
attempt O
succeeds O
, O
a B-Entity
final I-Entity
C2 I-Entity
request I-Entity
will O
be B-Action
made I-Action
– O
in O
this O
case O
to B-Modifier
a B-Entity
URL I-Entity
using I-Entity
the I-Entity
same I-Entity
path I-Entity
as I-Entity
the I-Entity
initial I-Entity
request I-Entity
( I-Entity
and I-Entity
a I-Entity
similarly I-Entity
random I-Entity
parameter I-Entity
) I-Entity
, O
but O
with O
a O
filename O
of O
success.asp O
. O

Content O
returned O
from O
this O
request O
will O
be O
saved O
to O
a O
file O
, O
but O
then O
immediately O
deleted O
. O

Finally O
, O
the B-Entity
malware I-Entity
will O
delete B-Action
the B-Entity
content I-Entity
saved I-Entity
from I-Entity
the I-Entity
first I-Entity
request I-Entity
, O
and O
exit O
. O

The O
limited O
functionality O
, O
and O
lack O
of O
persistence O
of O
this O
tool O
, O
implies O
that O
it B-Entity
is B-Action
used I-Action
only O
as B-Modifier
a B-Entity
simple I-Entity
download- I-Entity
and-execute I-Entity
utility I-Entity
. O

Although O
the O
version O
mentioned O
here O
uses O
C++ O
, O
along O
with O
Visual O
Studios O
Standard O
Template O
Library O
( O
STL O
) O
, O
older O
versions O
of O
the O
RAT O
( O
such O
as O
MD5 O
hash O
b54e91c234ec0e739ce429f47a317313 O
) O
, O
built O
in O
2011 O
, O
use O
plain O
C. O
This O
suggests O
that O
despite O
the O
simple O
nature O
of O
the O
tool O
, O
the O
developers O
have O
made O
some O
attempts O
to O
modify O
and O
perhaps O
modernize O
the O
code O
. O

Both O
versions O
contain O
debugging/progress O
messages O
such O
as O
'' O
down O
file O
success O
'' O
. O

Although O
these O
are O
not O
displayed O
to O
the O
victim O
, O
they O
were O
likely O
used O
by O
the O
developers O
as O
a O
simple O
means O
to O
verify O
functionality O
of O
their O
code O
. O

Like O
pngdowner O
, O
the B-Entity
httpclient I-Entity
malware I-Entity
is O
a O
simple O
tool O
that O
provides O
a O
limited O
range O
of O
functionality O
and O
uses B-Action
HTTP B-Entity
for B-Modifier
its B-Entity
C2 I-Entity
channel I-Entity
. O

This B-Entity
malware I-Entity
also O
initially O
performs B-Action
a B-Entity
connectivity I-Entity
check I-Entity
to B-Modifier
www.microsoft.com B-Entity
using B-Modifier
the B-Entity
hard-coded I-Entity
user I-Entity
agent I-Entity
Mozilla/4.0 I-Entity
( I-Entity
Compatible I-Entity
; I-Entity
MSIE I-Entity
6.0 I-Entity
; I-Entity
) I-Entity
, O
although O
in O
this O
variant O
no O
attempt O
is O
made O
to O
extract O
proxy O
credentials O
. O

The B-Entity
malware I-Entity
will O
then O
connect B-Action
to B-Modifier
its B-Entity
configured I-Entity
C2 I-Entity
infrastructure I-Entity
( I-Entity
file.anyoffice.info I-Entity
) I-Entity
and O
perform B-Action
a B-Entity
HTTP I-Entity
request I-Entity
of I-Entity
the I-Entity
form I-Entity
shown I-Entity
in I-Entity
Figure I-Entity
14 I-Entity
below I-Entity
: O
Content O
returned O
from O
the O
C2 O
server O
is O
deobfuscated O
by O
XOR'ing O
the O
content O
with O
a O
single O
byte O
, O
0x12 O
. O

The O
decoded O
data O
is O
then O
checked O
for O
the O
string O
runshell O
. O

If O
this O
string O
is O
not O
present O
, O
the B-Entity
C2 I-Entity
request I-Entity
is B-Action
repeated I-Action
every B-Modifier
0.5 B-Entity
seconds I-Entity
. O

Otherwise O
, O
a B-Entity
shell I-Entity
process I-Entity
is B-Action
started I-Action
( O
i.e. O
, O
cmd.exe O
) O
, O
with B-Modifier
input/output B-Entity
redirected I-Entity
over I-Entity
the I-Entity
C2 I-Entity
channel I-Entity
. O

Shell O
commands O
from O
the O
server O
are O
followed O
by O
an O
encoded O
string O
$ O
$ O
$ O
, O
which O
indicates O
that O
the O
shell O
session O
should O
continue O
. O

If O
the O
session O
is O
ended O
, O
two B-Entity
other I-Entity
commands I-Entity
are B-Action
supported I-Action
: O
m2b O
( O
upload B-Action
file B-Entity
) O
and O
b2m O
( O
download B-Action
file B-Entity
) O
. O

Slight O
variations O
on O
the O
C2 O
URLs O
are O
used O
for O
different O
phases O
of O
the O
C2 O
interaction O
: O
Given O
the O
lack O
of O
a O
persistence O
mechanism O
and O
low O
level O
of O
sophistication O
, O
it O
is O
likely O
that O
httpclient O
– O
like O
pngdowner O
– O
is O
used O
as O
a O
second-stage O
or O
supplementary/backup O
tool O
. O

Appendix O
4 O
lists O
metadata O
for O
observed O
httpclient O
samples O
. O

Other O
CrowdStrike O
reporting O
describes O
a B-Entity
dropper I-Entity
used B-Action
by O
PUTTER B-Entity
PANDA I-Entity
( O
abc.scr O
) O
to O
install B-Action
the B-Entity
4H I-Entity
RAT I-Entity
. O

This B-Entity
dropper I-Entity
uses O
RC4 O
to O
decrypt O
an O
embedded O
payload O
from O
data O
in O
an O
embedded O
resource O
before O
writing B-Action
the B-Entity
payload I-Entity
to B-Modifier
disk B-Entity
and O
executing B-Action
it B-Entity
. O

Several O
instances O
of O
this O
dropper O
have O
been O
observed O
, O
most O
commonly O
in O
association O
with O
the O
4H O
RAT O
, O
but O
also O
in O
relation O
to O
other O
tools O
that O
will O
be O
described O
in O
forthcoming O
reporting O
. O

Another B-Entity
dropper I-Entity
has O
been O
observed O
, O
exclusively O
installing B-Action
the B-Entity
pngdowner I-Entity
malware I-Entity
( I-Entity
example I-Entity
MD5 I-Entity
hash I-Entity
4c50457c35e2033b3a03fcbb4adac7b7 I-Entity
) I-Entity
. O

This O
dropper O
is O
simplistic O
in O
nature O
, O
and O
is O
compiled O
from O
a O
single O
C++ O
source O
code O
file O
. O

It O
contains O
a O
Word O
document O
in O
plaintext O
( O
written O
to O
BienvenueaSahajaYogaToulouse O
. O

doc O
) O
, O
along O
with O
an O
executable O
( O
Update.exe O
) O
and O
DLL O
( O
McUpdate.dll O
) O
. O

The B-Entity
executable I-Entity
and I-Entity
DLL I-Entity
are O
both O
contained O
within O
the O
.data O

section O
of O
the O
dropper O
, O
obfuscated B-Action
with B-Modifier
a B-Entity
16-byte I-Entity
XOR I-Entity
key I-Entity
( I-Entity
consisting I-Entity
of I-Entity
the I-Entity
bytes I-Entity
0xA0 I-Entity
– I-Entity
0xAF I-Entity
) I-Entity
. O

Both B-Entity
the I-Entity
document I-Entity
and I-Entity
executable I-Entity
are B-Action
written I-Action
to B-Modifier
disk B-Entity
and O
the O
executed B-Action
via B-Modifier
the B-Entity
ShellExecute I-Entity
API I-Entity
( I-Entity
using I-Entity
the I-Entity
verb I-Entity
'' I-Entity
open I-Entity
'' I-Entity
) I-Entity
. O

The B-Entity
executable I-Entity
is B-Action
also I-Action
installed I-Action
into B-Modifier
the B-Entity
ASEP I-Entity
registry I-Entity
key I-Entity
HKCU\Software\Microsoft\Windows\ I-Entity
CurrentVersion\Run I-Entity
, O
with B-Modifier
a B-Entity
value I-Entity
named I-Entity
McUpdate I-Entity
. O

Finally O
, O
the B-Entity
dropper I-Entity
deletes B-Action
itself B-Entity
via B-Modifier
a B-Entity
batch I-Entity
file I-Entity
. O

The B-Entity
dropped I-Entity
executable I-Entity
( I-Entity
MD5 I-Entity
hash I-Entity
38a2a6782e1af29ca8cb691cf0d29a0d I-Entity
) I-Entity
primarily O
aims O
to O
inject B-Action
the B-Entity
specified I-Entity
DLL I-Entity
( I-Entity
McUpdate.dll I-Entity
, I-Entity
MD5 I-Entity
hash I-Entity
08c7b5501df060ccfc3aa5c8c41b452f I-Entity
) I-Entity
into B-Modifier
a B-Entity
process I-Entity
that I-Entity
would I-Entity
normally I-Entity
be I-Entity
accessing I-Entity
the I-Entity
network I-Entity
, O
likely O
in O
order O
to O
disguise B-Action
the B-Entity
malicious I-Entity
activity I-Entity
. O

Module O
names O
corresponding O
to O
Outlook O
Express O
( O
msinm.exe O
) O
, O
Outlook O
( O
outlook.exe O
) O
, O
Internet O
Explorer O
( O
iexplore.exe O
) O
, O
and O
Firefox O
( O
firefox.exe O
) O
are O
used O
. O

If O
Internet O
Explorer O
is O
used O
, O
then O
the B-Entity
malware I-Entity
will O
attempt O
to O
terminate B-Action
processes B-Entity
corresponding I-Entity
to I-Entity
two I-Entity
components I-Entity
of I-Entity
Sophos I-Entity
Anti-Virus I-Entity
( I-Entity
SAVAdminService.exe I-Entity
and I-Entity
SavService.exe I-Entity
) I-Entity
. O

Four O
examples O
of O
these B-Entity
droppers I-Entity
were O
located O
, O
using B-Action
a B-Entity
mixture I-Entity
of I-Entity
decoy I-Entity
PDF I-Entity
and I-Entity
Microsoft I-Entity
Word I-Entity
documents I-Entity
( O
shown O
below O
in O
Figures O
15-18 O
) O
. O

The O
common O
theme O
throughout O
these O
documents O
is O
space O
technology O
( O
BienvenueaSahajaYogaToulouse.doc O
does O
not O
follow O
this O
trend O
, O
but O
could O
be O
targeted O
at O
workers O
at O
the O
Toulouse O
Space O
Centre O
, O
the O
'' O
largest O
space O
centre O
in O
Europe O
'' O
) O
, O
indicating O
that O
the O
attackers O
have O
a O
keen O
interest O
in O
this O
sector O
, O
which O
is O
also O
reflected O
in O
the O
choice O
of O
name O
for O
some O
of O
the O
C2 O
domains O
used O
( O
see O
the O
Attribution O
section O
above O
) O
. O

A O
number O
of O
specific O
and O
generic O
detection O
methods O
are O
possible O
for O
this O
RAT O
, O
both O
on O
a O
host O
and O
on O
the O
network O
. O

These O
are O
detailed O
below O
, O
and O
are O
designed O
to O
expand O
upon O
the O
indicators O
reported O
in O
other O
CrowdStrike O
reporting O
. O

The O
following O
Windows O
registry O
artifacts O
are O
indicative O
of O
a O
compromised O
host O
: O
redacted O
) O
The O
presence O
of O
the O
following O
file O
system O
artifacts O
is O
indicative O
of O
a O
compromised O
host O
: O
A O
file O
mapping O
named O
& O
*SDKJfhksdf89*DIUKJDSF O
& O
*sdfsdf78sdfsdf O
also O
indicates O
the O
victim O
machine O
is O
compromised O
with O
PUTTER O
PANDA O
malware O
. O

In O
addition O
the O
domains O
listed O
in O
the O
Appendices O
and O
in O
the O
Attribution O
section O
, O
the O
generic O
signatures O
below O
can O
be O
used O
to O
detect O
activity O
from O
the O
malware O
described O
in O
this O
report O
. O

In O
addition O
to O
the O
indicators O
described O
above O
, O
PUTTER O
PANDA O
have O
some O
distinct O
generic O
TTPs O
: O
PUTTER O
PANDA O
are O
a O
determined O
adversary O
group O
who O
have O
been O
operating O
for O
several O
years O
, O
conducting O
intelligence-gathering O
operations O
with O
a O
significant O
focus O
on O
the O
space O
sector O
. O

Although O
some O
of O
their O
tools O
are O
simplistic O
, O
taken O
as O
a O
whole O
their B-Entity
toolset I-Entity
provides B-Action
a B-Entity
wide I-Entity
degree I-Entity
of I-Entity
control I-Entity
over I-Entity
a I-Entity
victim I-Entity
system I-Entity
and O
can O
provide O
the O
opportunity O
to O
deploy B-Action
additional B-Entity
tools I-Entity
at B-Modifier
will B-Entity
. O

Research O
presented O
in O
this O
report O
shows O
that O
the O
PUTTER O
PANDA O
operators O
are O
likely O
members O
of O
the O
12th O
Bureau O
, O
3rd O
General O
Staff O
Department O
( O
GSD O
) O
of O
the O
People O
's O
Liberation O
Army O
( O
PLA O
) O
, O
operating O
from O
the O
unit O
's O
headquarters O
in O
Shanghai O
with O
MUCD O
61486 O
. O

Strategic O
objectives O
for O
this O
unit O
are O
likely O
to O
include O
obtaining O
intellectual O
property O
and O
industrial O
secrets O
relating O
to O
defense O
technology O
, O
particularly O
those O
to O
help O
enable O
the O
unit O
's O
suspect O
mission O
to O
conduct O
space O
surveillance O
, O
remote O
sensing O
, O
and O
interception O
of O
satellite O
communications O
. O

PUTTER O
PANDA O
is O
likely O
to O
continue O
to O
aggressively O
target O
Western O
entities O
that O
hold O
valuable O
information O
or O
intellectual O
property O
relevant O
to O
these O
interests O
. O

The O
detection O
and O
mitigation O
guidance O
given O
in O
this O
report O
will O
help O
to O
minimize O
the O
risk O
of O
a O
successful O
compromise O
by O
these O
actors O
, O
and O
future O
CrowdStrike O
reports O
will O
examine O
other O
elements O
of O
the O
PUTTER O
PANDA O
toolset O
. O

CrowdStrike O
Falcon O
Intelligence O
portal O
provides O
enterprises O
with O
strategic O
, O
customized O
, O
and O
actionable O
intelligence O
. O

Falcon O
Intelligence O
enables O
organizations O
to O
prioritize O
resources O
by O
determining O
targeted O
versus O
commodity O
attacks O
, O
saving O
time O
and O
focusing O
resources O
on O
critical O
threats O
. O

With O
unprecedented O
insight O
into O
adversary O
tools O
, O
tactics O
, O
and O
procedures O
( O
TTPs O
) O
and O
multi-source O
information O
channels O
, O
analysts O
can O
identify O
pending O
attacks O
and O
automatically O
feed O
threat O
intelligence O
via O
API O
to O
SIEM O
and O
thirdparty O
security O
tools O
. O

Access O
to O
CrowdStrike O
Falcon O
Intelligence O
is O
geared O
toward O
all O
levels O
of O
an O
organization O
, O
from O
the O
executivewho O
needs O
to O
understand O
the O
business O
threat O
and O
strategic O
business O
impact O
, O
to O
the O
front-line O
securiyt O
professional O
struggling O
to O
! O
ght O
through O
an O
adversary's O
attack O
against O
the O
enterprise O
. O

CrowdStrike O
Falcon O
Intelligence O
is O
a O
web-based O
intelligence O
subscription O
that O
includes O
full O
access O
to O
a O
variety O
of O
feature O
sets O
, O
including O
: O
CrowdStrike O
Falcon O
Host O
is O
an O
endpoint O
threat O
detection O
and O
response O
product O
that O
identifies O
unknown O
malware O
, O
detects O
zero-day O
threats O
, O
and O
prevents O
damage O
from O
targeted O
attacks O
in O
real-time O
. O

Falcon O
Host O
is O
comprised O
of O
two O
core O
components O
, O
the O
cloud-based O
management O
console O
and O
the O
on-premises O
host-based O
sensor O
that O
continuously O
monitors O
threat O
activity O
at O
the O
endpoint O
to O
prevent O
damage O
in O
real-time O
. O

Falcon O
Host O
leverages O
a O
lightweight O
kernel-mode O
sensor O
that O
shadows O
, O
captures O
, O
and O
correlates O
low- O
level O
operating O
system O
events O
to O
instantly O
identify O
the O
adversary O
tradecraft O
and O
activities O
through O
Stateful O
Execution O
Inspection O
( O
SEI O
) O
at O
the O
endpoint O
and O
Machine O
Learning O
in O
the O
cloud O
. O

As O
opposed O
to O
focusing O
on O
malware O
signatures O
, O
indicators O
of O
compromise O
, O
exploits O
, O
and O
vulnerabilities O
, O
Falcon O
Host O
instead O
identifies O
mission O
objectives O
of O
the O
adversary O
leveraging O
the O
Kill O
Chain O
model O
and O
provides O
realtime O
detection O
by O
focusing O
on O
what O
the O
attacker O
is O
doing O
, O
as O
opposed O
to O
looking O
nfor O
a O
specific O
, O
easily O
changeable O
indicator O
used O
in O
an O
attack O
. O

Without O
performing O
intrusive O
and O
performance- O
impacting O
scans O
of O
the O
system O
, O
Falcon O
Host O
's O
highly O
efficient O
real-time O
monitoring O
of O
all O
system O
activity O
is O
the O
only O
security O
solution O
that O
provides O
maximum O
visibility O
into O
all O
adversary O
activities O
, O
including O
Adversary-in-Motion O
: O
reconnaissance O
, O
exploitation O
, O
privilege O
escalation O
, O
lateral O
movement O
, O
and O
exfiltration O
. O

Falcon O
Host O
delivers O
insight O
into O
past O
and O
current O
attacks O
not O
only O
on O
a O
single O
host O
, O
but O
also O
across O
devices O
and O
networks O
. O

Stateful O
Execution O
inspection O
Stateful O
Execution O
Inspection O
( O
SEI O
) O
tracks O
execution O
state O
and O
links O
together O
various O
stages O
of O
the O
kill O
chain O
, O
from O
initial O
code O
execution O
to O
data O
exfiltration O
. O

CrowdStrike O
's O
Real-time O
Stateful O
Execution O
Engine O
performs O
inspection O
and O
analysis O
to O
understand O
the O
full O
context O
of O
a O
cyber O
attack O
. O

SEI O
is O
critical O
to O
understanding O
the O
entire O
attack O
life O
cycle O
and O
preventing O
the O
damage O
from O
advanced O
malware O
and O
targeted O
attacks O
. O

Existing O
security O
technologies O
that O
focus O
solely O
on O
malware O
signatures O
, O
incidators O
of O
compromise O
, O
exploits O
, O
and O
vulnerabilities O
fail O
to O
protect O
against O
the O
majority O
of O
attacks O
as O
they O
are O
blind O
to O
the O
full O
scope O
of O
adversary O
activity O
. O

CrowdStrike O
is O
a O
global O
provider O
of O
security O
technology O
and O
services O
focused O
on O
identifying O
advanced O
threats O
and O
targeted O
attacks O
. O

Using O
big-data O
technologies O
, O
CrowdStrike O
's O
next-generation O
threat O
protection O
platform O
leverages O
real-time O
Stateful O
Execution O
Inspection O
( O
SEI O
) O
at O
the O
endpoint O
and O
Machine O
Learning O
in O
the O
cloud O
instead O
of O
solely O
focusing O
on O
malware O
signatures O
, O
indicators O
of O
compromise O
, O
exploits O
, O
and O
vulnerabilities O
. O

The O
CrowdStrike O
Falcon O
Platform O
is O
a O
combination O
of O
big O
data O
technologies O
and O
endpoint O
security O
driven O
by O
advanced O
threat O
intelligence O
. O

CrowdStrike O
Falcon O
enables O
enterprises O
to O
identify O
unknown O
malware O
, O
detect O
zero-day O
threats O
, O
pinpoint O
advanced O
adversaries O
and O
attribution O
, O
and O
prevent O
damage O
from O
targeted O
attacks O
in O
real O
time O
. O

CrowdStrike O
Services O
is O
a O
wholly O
owned O
subsidiary O
of O
CrowdStrike O
responsible O
for O
proactively O
defending O
against O
and O
responding O
to O
cyber O
incidents O
with O
pre O
and O
post O
Incident O
Response O
services O
. O

CrowdStrike O
's O
seasoned O
team O
of O
Cyber O
Intelligence O
professionals O
, O
Incident O
Responders O
, O
and O
Malware O
Researchers O
consists O
of O
a O
number O
of O
internationally O
recognized O
authors O
, O
speakers O
, O
and O
experts O
who O
have O
worked O
on O
some O
of O
the O
most O
publicized O
and O
challenging O
intrusions O
and O
malware O
attacks O
in O
recent O
years O
. O

The O
CrowdStrike O
Services O
team O
leverages O
our O
Security O
Operations O
Center O
to O
monitor O
the O
full O
CrowdStrike O
Falcon O
Platform O
and O
provide O
cutting-edge O
advanced O
adversary O
intrusion O
detection O
services O
. O

The O
full O
spectrum O
of O
proactive O
and O
response O
services O
helps O
customers O
respond O
tactically O
as O
well O
as O
continually O
mature O
and O
strategically O
evolve O
Incident O
Response O
program O
capabilities O
. O

In O
February O
2014 O
, O
the O
experts O
of O
the O
G O
DATA O
SecurityLabs O
published O
an O
analysis O
of O
Uroburos O
, O
the O
rootkit O
with O
Russian O
roots O
. O

We O
explained O
that O
a O
link O
exists O
between O
Uroburos O
and O
the O
Agent.BTZ O
malware O
, O
which O
was O
responsible O
for O
'' O
the O
most O
significant O
breach O
of O
U.S. O
military O
computers O
ever O
. O

'' O
Nine O
months O
later O
, O
after O
the O
buzz O
around O
Uroburos O
, O
aka O
Snake O
or O
Turla O
, O
we O
now O
identified O
a O
new O
generation O
of O
Agent.BTZ O
. O

We O
dubbed O
it O
ComRAT O
and O
, O
by O
now O
, O
analyzed O
two O
versions O
of O
the O
threat O
( O
v3.25 O
and O
v3.26 O
) O
. O

As O
reported O
earlier O
this O
year O
, O
Agent.BTZ O
used O
the O
same O
encoding O
key O
and O
the O
installation O
log O
file O
name O
as O
Uroburos O
. O

ComRAT O
, O
in O
its O
version O
3.25 O
, O
shows O
the O
same O
behavior O
. O

Furthermore O
, O
the B-Entity
attackers I-Entity
also O
shared B-Action
a B-Entity
C I-Entity
& I-Entity
C I-Entity
domain I-Entity
. O

The O
latest O
version O
of O
ComRAT B-Entity
known O
to O
us O
( O
v3.26 O
) O
uses O
a O
new O
key O
and O
does O
not O
create O
the O
installation O
log O
file O
, O
in O
order O
to O
complicate B-Action
the B-Entity
analysis I-Entity
and O
to O
disguise O
the O
link O
between O
the O
two O
cases O
. O

Another O
very O
interesting O
fact O
: O
the B-Entity
attackers I-Entity
use B-Action
COM O
Object O
hijacking O
, O
the B-Entity
same I-Entity
persistence I-Entity
mechanism I-Entity
as O
COMpfun O
, O
which O
we O
described O
recently O
. O

Taken O
everything O
into O
consideration O
, O
the O
indications O
we O
saw O
during O
our O
analyzes O
lead O
to O
the O
supposition O
that O
the O
group O
behind O
Agent.BTZ O
and O
Uroburos O
is O
still O
active O
and O
is O
pursuing O
the O
Agent.BTZ O
path O
once O
more O
to O
improve O
and O
change O
the O
RAT O
. O

The O
analyzed O
file O
is O
the O
latest O
version O
we O
identified O
: O
v3.26 O
. O

The O
version O
identification O
is O
described O
in O
the O
chapter O
'' O
Log O
files O
'' O
. O

The O
major O
difference O
between O
this O
version O
and O
the O
older O
version O
( O
s O
) O
will O
be O
described O
there O
. O

The O
first O
task O
of O
the B-Entity
malware I-Entity
is O
to O
install B-Action
the B-Entity
file I-Entity
credprov.tlb I-Entity
in B-Modifier
% B-Entity
APPDATA I-Entity
% I-Entity
\Microsoft\ I-Entity
. O

This O
file O
is O
the O
main O
payload O
of O
the O
malware O
. O

The B-Entity
dropper I-Entity
executes O
the O
following O
command O
in O
order O
to O
install B-Action
a B-Entity
second I-Entity
file I-Entity
: O
The O
second O
file O
is O
shdocw.tlp O
. O

The O
two O
files O
are O
Microsoft O
Windows O
dynamic O
libraries O
. O

To O
be O
started B-Action
during B-Modifier
the B-Entity
boot I-Entity
process I-Entity
of I-Entity
the I-Entity
infected I-Entity
machine I-Entity
, O
the B-Entity
malware I-Entity
creates B-Action
the B-Entity
following I-Entity
registry I-Entity
key I-Entity
: O
This O
registry O
key O
is O
used O
to O
associate O
the O
library O
shdocvw.tlp O
to O
the O
object O
42aedc87-2188-41fd-b9a3-0c966feabec1 O
as O
previously O
explained O
in O
the O
article O
about O
COMpfun O
. O

The O
purpose O
is O
to O
load B-Action
the B-Entity
library I-Entity
into B-Modifier
each B-Entity
and I-Entity
every I-Entity
process I-Entity
executed I-Entity
on I-Entity
the I-Entity
infected I-Entity
system I-Entity
. O

If O
the O
version O
of O
the O
malware O
is O
older O
than O
3.26 O
, O
the B-Entity
dropper I-Entity
creates B-Action
an B-Entity
additional I-Entity
file I-Entity
called I-Entity
winview.ocx I-Entity
. O

We O
noticed O
that O
the O
file O
name O
is O
still O
the O
same O
as O
the O
file O
name O
used O
by O
Agent.BTZ O
in O
the O
past O
. O

The B-Entity
file I-Entity
is B-Action
xored I-Action
with B-Modifier
the B-Entity
following I-Entity
obfuscation I-Entity
key I-Entity
( O
used O
by O
both O
, O
Uroburos O
and O
Agent.BTZ O
) O
: O
Here O
is O
the O
decoded O
log O
file O
content O
: O
We O
can O
notice O
that O
the B-Entity
malware I-Entity
checks B-Action
if B-Entity
an I-Entity
older I-Entity
version I-Entity
is I-Entity
installed I-Entity
on I-Entity
the I-Entity
system I-Entity
and O
if O
this O
is O
the O
case O
, O
the B-Entity
dropper I-Entity
removes B-Action
the B-Entity
older I-Entity
version I-Entity
. O

In O
contrast O
to O
this O
, O
in O
our O
Uroburos O
analysis O
, O
we O
found O
out O
that O
Uroburos B-Entity
does B-Action
not I-Action
install I-Action
itself B-Entity
in O
case O
a B-Entity
version I-Entity
of I-Entity
Agent.BTZ I-Entity
was B-Action
found I-Action
on B-Modifier
a B-Entity
system I-Entity
. O

During O
the O
startup O
of O
the O
infected O
machine O
, O
the B-Entity
shdocvw.tlp I-Entity
library I-Entity
is B-Action
loaded I-Action
into B-Modifier
all B-Entity
processes I-Entity
. O

If O
the O
process O
is O
explorer.exe O
, O
this B-Entity
library I-Entity
will B-Action
load I-Action
the B-Entity
other I-Entity
library I-Entity
called I-Entity
credprov.tlb I-Entity
. O

This O
library O
is O
the O
real O
payload O
. O

Its O
features O
are O
common O
for O
a O
Remote O
Administration O
Tool O
( O
RAT O
) O
: O
ComRAT B-Entity
's I-Entity
communication I-Entity
to I-Entity
the I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
is B-Action
performed I-Action
by O
the B-Entity
browser I-Entity
process I-Entity
and O
not O
by O
explorer.exe O
in O
order O
to O
avoid B-Action
being B-Entity
blocked I-Entity
by I-Entity
a I-Entity
firewall I-Entity
on I-Entity
the I-Entity
system I-Entity
or I-Entity
any I-Entity
additional I-Entity
security I-Entity
products I-Entity
. O

The B-Entity
communication I-Entity
between I-Entity
the I-Entity
processes I-Entity
is B-Action
performed I-Action
by O
named B-Entity
pipe I-Entity
. O

Two B-Entity
log I-Entity
files I-Entity
are B-Action
created I-Action
during B-Modifier
the B-Entity
malware I-Entity
execution I-Entity
: O
mskfp32.ocx B-Entity
and I-Entity
msvcrtd.tlb I-Entity
. O

If O
the O
malware O
version O
is O
older O
than O
3.26 O
, O
the O
xored O
key O
is O
the O
same O
as O
the O
dropper O
key O
. O

Concerning O
the O
version O
3.26 O
, O
the O
malware O
uses O
a O
new O
non-ASCII O
key O
. O

Here O
is O
an O
example O
of O
decoded O
log O
file O
for O
the O
version O
3.26 O
: O
We O
can O
identify O
the O
version O
of O
the O
malware O
thanks O
to O
the O
PVer O
flag O
. O

The B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
information I-Entity
is B-Action
stored I-Action
in B-Modifier
the B-Entity
registry I-Entity
, O
not O
in O
an O
XML O
, O
and O
encoded O
: O
For O
example O
, O
in O
the O
analyzed O
sample O
the O
CC O
is O
: O
weather-online.hopto.org O
. O

This O
domain O
is O
far O
from O
unknown O
, O
as O
it O
has O
been O
mentioned O
in O
BAE O
System O
's O
Uroburos O
( O
aka O
Snake O
) O
analysis O
paper O
as O
C O
& O
C O
server O
domain O
for O
the O
Uroburos O
malware O
. O

Another O
connection O
between O
the O
cases O
. O

If O
the O
malware O
version O
in O
lower O
than O
3.26 O
, O
the B-Entity
XML I-Entity
log I-Entity
file I-Entity
contains B-Action
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
information I-Entity
: O
Let O
us O
summarize O
the O
similarities O
and O
differences O
between O
Agent.BTZ O
, O
Uroburos O
and O
ComRAT O
as O
far O
as O
we O
can O
: O
Some O
parts O
of O
the O
code O
are O
exactly O
the O
same O
( O
appears O
to O
be O
copy O
& O
paste O
) O
. O

That O
is O
the O
reason O
why O
the O
sample O
is O
detected O
as O
Uroburos O
( O
aka O
Turla O
) O
. O

The O
same O
code O
was O
used O
by O
Agent.BTZ O
and O
also O
the O
dll O
loaded O
into O
userland O
during O
the O
Uroburos O
analysis O
. O

Command B-Entity
and I-Entity
control I-Entity
server I-Entity
domains I-Entity
are B-Action
shared I-Action
between B-Modifier
Uroburos B-Entity
and I-Entity
ComRAT I-Entity
. O

In O
version O
3.26 O
, O
the O
author O
changed O
the O
key O
and O
remove O
the O
known O
file O
name O
. O

This O
action O
can O
be O
an O
indication O
for O
the O
developer O
's O
effort O
to O
hide O
this O
connection O
. O

The O
main O
difference O
is O
the O
design O
. O

Agent.BTZ B-Entity
is B-Action
a B-Entity
common I-Entity
RAT I-Entity
, O
a O
simple O
library O
executed O
on O
an O
infected O
machine O
. O

ComRAT O
is O
more O
complex O
and O
cleverer O
. O

The B-Entity
malware I-Entity
is B-Action
loaded I-Action
into B-Modifier
each B-Entity
and I-Entity
every I-Entity
process I-Entity
of I-Entity
the I-Entity
infected I-Entity
machine I-Entity
and O
the B-Entity
main I-Entity
part I-Entity
( I-Entity
payload I-Entity
) I-Entity
of I-Entity
the I-Entity
malware I-Entity
is B-Action
only I-Action
executed I-Action
in B-Modifier
explorer.exe B-Entity
. O

Furthermore O
, O
the B-Entity
C I-Entity
& I-Entity
C I-Entity
communication I-Entity
blends B-Action
into B-Modifier
the B-Entity
usual I-Entity
browser I-Entity
traffic I-Entity
and O
the B-Entity
malware I-Entity
communicates B-Action
to B-Modifier
the B-Entity
browser I-Entity
by B-Modifier
named B-Entity
pipe I-Entity
. O

It O
is O
by O
far O
a O
more O
complex O
userland O
design O
than O
Agent.BTZ O
. O

These O
differences O
, O
mainly O
the O
more O
complex O
design O
, O
lead O
us O
to O
give O
this O
malware O
a O
new O
name O
. O

The O
analyzed O
dropper O
of O
v3.25 O
has O
a O
compilation O
date O
of O
February O
6th O
2014 O
. O

The O
more O
recent O
dropper O
of O
v3.26 O
, O
which O
has O
all O
the O
mentioned O
changes O
implemented O
, O
reveals O
a O
compilation O
date O
of O
January O
3rd O
2013 O
. O

We O
suspect O
that O
this B-Entity
date I-Entity
is B-Action
spoofed I-Action
in O
order O
to O
disguise O
that O
this O
is O
in O
fact O
a O
newer O
version O
. O

This O
analysis O
shows O
that O
even O
after O
the O
Uroburos O
publication O
in O
February O
2014 O
, O
the O
group O
behind O
this O
piece O
of O
malware O
seems O
to O
be O
still O
active O
. O

In O
any O
case O
, O
the O
ComRAT O
developers O
implemented O
new O
mechanisms O
, O
changed O
keys O
, O
removed O
log O
files O
to O
hide O
their O
activities O
and O
tried O
to O
disguise O
the O
connections O
between O
the O
RAT O
ComRAT O
, O
the O
rootkit O
Uroburos O
and O
the O
RAT O
Agent.BTZ O
as O
much O
as O
possible O
. O

However O
, O
we O
can O
still O
follow O
the O
evolution O
of O
the O
malware O
by O
comparing O
the O
versions O
. O

The O
persistence O
mechanism O
discovered O
in O
October O
2014 O
makes O
it O
possible O
to O
intrude O
into O
a O
system O
in O
a O
really O
discreet O
manner O
and O
we O
estimate O
that O
other O
actors O
will O
use O
the O
same O
persistence O
mechanism O
in O
the O
near O
future O
. O

We O
will O
definitely O
keep O
our O
ears O
and O
eyes O
open O
and O
continue O
analyzing O
. O

At O
the O
end O
of O
April O
Microsoft O
announced O
that O
a O
vulnerability O
in O
Word O
was O
actively O
being O
exploited O
. O

This O
vulnerability O
occurred O
in O
parsing O
RTF O
files O
and O
was O
assigned O
CVE-2014-1761 O
, O
a O
thorough O
analysis O
of O
which O
can O
be O
found O
on O
the O
HP O
Security O
Research O
blog O
. O

We O
have O
since O
seen O
multiple O
cases O
where O
this B-Entity
exploit I-Entity
is O
used O
to O
deliver B-Action
malware B-Entity
and O
one O
was O
particularly O
interesting O
as O
it O
contained O
a O
new O
variant O
of O
MiniDuke O
( O
also O
known O
as O
Win32/SandyEva O
) O
. O

MiniDuke O
was O
first O
discussed O
by O
Kaspersky O
in O
March O
2013 O
in O
their O
paper O
The O
MiniDuke O
Mystery O
: O
PDF O
0- O
day O
Government O
Spy O
Assembler O
0x29A O
Micro O
Backdoorand O
shortly O
after O
in O
a O
paper O
by O
Bitdefender O
. O

Some O
of O
the O
characteristics O
of O
MiniDuke B-Entity
- O
such O
as O
its O
small O
size O
( O
20 O
KB O
) O
, O
its O
crafty O
use O
of O
assembly O
programming O
, O
and O
the O
use B-Action
of O
zero-day B-Entity
exploits I-Entity
for B-Modifier
distribution B-Entity
- O
made O
it O
an O
intriguing O
threat O
. O

Although O
the O
backdoor O
is O
still O
quite O
similar O
to O
its O
previous O
versions O
, O
some O
important O
changes O
were O
made O
since O
last O
year O
, O
the O
most O
notable O
being O
the O
introduction O
of O
a B-Entity
secondary I-Entity
component I-Entity
written I-Entity
in I-Entity
JScript I-Entity
to O
contact B-Action
a B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
via B-Modifier
Twitter B-Entity
. O

The O
exploit O
document O
was O
named O
Proposal-Cover-Sheet-English.rtf O
and O
is O
quite O
bland O
when O
compared O
to O
the O
documents O
that O
were O
used O
in O
2013 O
, O
which O
were O
of O
a O
political O
nature O
. O

We O
received O
the O
document O
on O
April O
8th O
, O
only O
three O
days O
after O
the O
compilation O
of O
the O
MiniDuke O
payload O
, O
dated O
April O
5th O
in O
the O
PE O
header O
. O

The O
payload O
remains O
quite O
small O
at O
only O
24 O
KB O
. O

The O
functionality O
of O
the B-Entity
shellcode I-Entity
which O
is B-Action
executed I-Action
by B-Modifier
triggering B-Entity
the I-Entity
vulnerability I-Entity
is O
rather O
simple O
and O
straightforward O
. O

After O
decrypting O
itself O
and O
obtaining O
the O
addresses O
of O
some O
functions O
exported O
by O
kernel32.dll O
, O
it B-Entity
decrypts B-Action
and I-Action
drops I-Action
the B-Entity
payload I-Entity
in B-Modifier
the B-Entity
% I-Entity
TEMP I-Entity
% I-Entity
directory I-Entity
in I-Entity
a I-Entity
file I-Entity
named I-Entity
'' I-Entity
a.l I-Entity
'' I-Entity
which O
is B-Action
subsequently I-Action
loaded I-Action
by B-Modifier
calling B-Entity
kernel32 I-Entity
! I-Entity
LoadLibraryA I-Entity
. O

An O
interesting O
thing O
about O
the O
shellcode O
is O
that O
before O
transferring O
control O
to O
any O
API O
function O
it B-Entity
checks O
the O
first O
bytes O
of O
the O
function O
in O
order O
to O
detect B-Action
hooks B-Entity
and I-Entity
debugger I-Entity
breakpoints I-Entity
which I-Entity
may I-Entity
be I-Entity
set I-Entity
by I-Entity
security I-Entity
software I-Entity
and I-Entity
monitoring I-Entity
tools I-Entity
. O

If O
any O
of O
these O
are O
found O
the O
shellcode O
skips O
the O
first O
5 O
bytes O
of O
the O
function O
being O
called O
by O
manually O
executing O
prologue O
instructions O
( O
mov O
edi O
, O
edi O
; O
push O
ebp O
; O
mov O
ebp O
, O
esp O
) O
and O
then O
jumping O
to O
the O
function O
code O
as O
illustrated O
below O
. O

The O
next O
graph O
presents O
the O
execution O
flow O
of O
this O
malware O
when O
the O
exploitation O
is O
successful O
. O

As O
mentioned O
previously O
this O
version O
of O
the O
MiniDuke O
payload O
comes O
with O
two O
modules O
which O
we O
refer O
to O
as O
the O
main O
module O
and O
the O
TwitterJS O
module O
. O

Once O
MiniDuke O
receives O
control O
it O
checks O
that O
the O
host O
process O
is O
not O
rundll32.exe O
and O
whether O
the O
current O
directory O
is O
% O
TEMP O
% O
. O

If O
either O
of O
those O
conditions O
is O
met O
the O
malware O
assumes O
it O
is O
run O
for O
the O
first O
time O
and O
it B-Entity
proceeds B-Action
with B-Modifier
its B-Entity
installation I-Entity
onto I-Entity
the I-Entity
system I-Entity
. O

MiniDuke B-Entity
gathers B-Action
information B-Entity
about I-Entity
the I-Entity
system I-Entity
and O
encrypts B-Action
its B-Entity
configuration I-Entity
based B-Modifier
on I-Modifier
that B-Entity
information I-Entity
, O
a O
method O
also O
used O
by O
OSX/Flashback O
( O
this O
process O
is O
called O
watermarking O
by O
Bitdefender O
) O
. O

The O
end O
result O
is O
that O
it O
is O
impossible B-Action
to I-Action
retrieve I-Action
the B-Entity
configuration I-Entity
of I-Entity
an I-Entity
encrypted I-Entity
payload I-Entity
if B-Modifier
analyzing B-Entity
it I-Entity
on I-Entity
a I-Entity
different I-Entity
computer I-Entity
. O

The O
information O
collected O
on O
infection O
has O
not O
changed O
since O
the O
previous O
version O
and O
consists O
of O
the O
following O
values O
: O
Once O
the B-Entity
encrypted I-Entity
version I-Entity
of I-Entity
the I-Entity
malware I-Entity
is B-Action
created I-Action
, O
it B-Entity
is B-Action
written I-Action
into B-Modifier
a B-Entity
file I-Entity
in I-Entity
the I-Entity
% I-Entity
ALLUSERSPROFILE I-Entity
% I-Entity
\Application I-Entity
Data I-Entity
directory I-Entity
. O

The O
name O
of O
the O
file O
is O
randomly O
picked O
from O
the O
following O
values O
( O
you O
can O
find O
this O
listing O
and O
those O
of O
the O
next O
screenshots O
on O
the O
VirusRadar O
description O
: O
The O
filename O
extension O
is O
also O
picked O
randomly O
from O
the O
following O
list O
: O
To O
persist B-Action
on B-Modifier
the B-Entity
infected I-Entity
system I-Entity
after B-Modifier
reboots B-Entity
, O
the B-Entity
malware I-Entity
creates B-Action
a B-Entity
hidden I-Entity
.LNK I-Entity
file I-Entity
in B-Modifier
the B-Entity
'' I-Entity
Startup I-Entity
'' I-Entity
directory I-Entity
pointing O
to O
the O
modified O
main O
module O
. O

The O
name O
of O
the O
.LNK O

file O
is O
randomly O
drawn O
from O
the O
following O
values O
: O
The B-Entity
.LNKfile I-Entity

is B-Action
created I-Action
using B-Modifier
a B-Entity
COM I-Entity
object I-Entity
with B-Modifier
the B-Entity
IShellLinkA I-Entity
interface I-Entity
and O
contains O
the O
following O
command O
: O
'' O
C O
: O
\Windows\system32\rundll32.exe O
% O
pathtomainmodule O
% O
, O
exportfunction O
'' O
Which O
gives O
something O
like O
: O
'' O
C O
: O
\Windows\system32\rundll32.exe O
C O
: O
\DOCUME~1\ALLUSE~1\APPLIC~1\data.cat O
, O
IlqUenn O
'' O
. O

When O
the B-Entity
malware I-Entity
is B-Action
loaded I-Action
by O
rundll32.exe B-Entity
and O
the O
current O
directory O
is O
n't O
% O
TEMP O
% O
, O
the B-Entity
malware I-Entity
starts O
with O
gathering B-Action
the B-Entity
same I-Entity
system I-Entity
information I-Entity
as I-Entity
described I-Entity
in I-Entity
the I-Entity
'' I-Entity
Installation I-Entity
'' I-Entity
section I-Entity
to B-Modifier
decrypt B-Entity
configuration I-Entity
information I-Entity
. O

As O
with O
the O
previous O
version O
of O
MiniDuke O
, O
it O
checks O
for O
the O
presence O
of O
the O
following O
processes O
in O
the O
system O
: O
If O
any O
of O
these O
are O
found O
in O
the O
system O
the O
configuration O
information O
will O
be O
decrypted O
incorrectly O
, O
i.e O
. O

the O
malware O
will O
run O
on O
the O
system O
without O
any O
communication O
to O
C O
& O
C O
servers O
. O

If O
the O
configuration O
data O
is O
decrypted O
correctly O
, O
MiniDuke B-Entity
retrieves B-Action
the B-Entity
Twitter I-Entity
page I-Entity
of I-Entity
@ I-Entity
FloydLSchwartz I-Entity
in B-Modifier
search B-Entity
of I-Entity
URLs I-Entity
by I-Entity
which I-Entity
to I-Entity
reach I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

It O
looks O
for O
the O
tag O
'' O
X O
) O
) O
) O
'' O
on O
the O
page O
( O
MiniDuke O
was O
searching O
for O
'' O
uri O
! O
'' O
in O
previous O
samples O
) O
and O
if O
the O
tag O
is O
found O
it O
decrypts O
a O
URL O
from O
the O
data O
that O
follows O
it O
. O

The O
Twitter O
account O
@ O
FloydLSchwartz O
does O
exist O
but O
has O
only O
retweets O
and O
no O
strings O
with O
the O
special O
tag O
. O

As O
the O
next O
step O
, O
MiniDuke B-Entity
gathers B-Action
the B-Entity
following I-Entity
information I-Entity
from B-Modifier
the B-Entity
infected I-Entity
systems I-Entity
: O
This B-Entity
information I-Entity
is B-Action
then I-Action
sent I-Action
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
along O
with O
the O
request B-Action
to B-Modifier
download B-Entity
a I-Entity
payload I-Entity
. O

The B-Entity
final I-Entity
URL I-Entity
used B-Action
to B-Modifier
communicate B-Entity
with I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
looks O
like O
this O
: O
< O
urlstart O
> O
/create.php O
? O
< O
rndparam O
> O
= O
< O
systeminfo O
> O
Those O
tokens O
are O
derived O
as O
follows O
: O
An O
example O
of O
such O
a O
URL O
is O
given O
below O
: O
The B-Entity
payload I-Entity
is B-Action
downloaded I-Action
in B-Modifier
the B-Entity
file I-Entity
named I-Entity
'' I-Entity
fdbywu I-Entity
'' I-Entity
using B-Modifier
the B-Entity
urlmon I-Entity
! I-Entity
URLDownloadToFileA I-Entity
API I-Entity
: O
The O
downloaded O
payload O
is O
a O
fake O
GIF8 O
file O
containing O
encrypted O
executable O
. O

The O
malware O
processes O
the O
downloaded O
file O
in O
the O
same O
way O
as O
previous O
samples O
of O
MiniDuke O
: O
it B-Entity
verifies B-Action
the B-Entity
integrity I-Entity
of I-Entity
the I-Entity
file I-Entity
using B-Modifier
RSA-2048 B-Entity
, O
then O
decrypts O
it O
, O
stores O
in O
a O
file O
and O
finally O
executes B-Action
it B-Entity
. O

The B-Entity
RSA-2048 I-Entity
public I-Entity
key I-Entity
to O
verify B-Action
integrity B-Entity
of I-Entity
the I-Entity
executable I-Entity
inside I-Entity
the I-Entity
GIF I-Entity
file I-Entity
is O
the O
same O
as O
in O
the O
previous O
version O
of O
MiniDuke O
. O

In O
the O
event O
that O
MiniDuke O
is O
unable O
to O
retrieve O
a O
C O
& O
C O
URL O
from O
this O
account O
, O
it O
generates O
a O
username O
to O
search O
for O
based O
on O
the O
current O
date O
. O

The O
search O
query O
changes O
roughly O
every O
seven O
days O
and O
is O
similar O
to O
the O
backup O
mechanism O
in O
previous O
versions O
that O
was O
using O
Google O
searches O
. O

A O
Python O
implementation O
of O
the O
algorithm O
can O
be O
found O
in O
Appendix O
B O
. O

The O
TwitterJS O
module O
is O
extracted O
by O
creating B-Action
a B-Entity
copy I-Entity
of I-Entity
the I-Entity
Windows I-Entity
DLL I-Entity
cryptdll.dll I-Entity
, O
injecting O
a O
block O
of O
code O
into O
it O
and O
redirecting O
the O
exported O
functions O
to O
this O
code O
. O

Here O
is O
how O
the O
export O
address O
table O
of O
the O
patched O
binary O
looks O
after O
modifications O
. O

This B-Entity
file I-Entity
is B-Action
then I-Action
stored I-Action
in B-Modifier
an B-Entity
Alternate I-Entity
Data I-Entity
Stream I-Entity
( I-Entity
ADS I-Entity
) I-Entity
in I-Entity
NTUSER.DAT I-Entity
in I-Entity
the I-Entity
% I-Entity
USERPROFILE I-Entity
% I-Entity
folder I-Entity
. O

Finally O
this B-Entity
DLL I-Entity
is B-Action
registered I-Action
as B-Modifier
the B-Entity
Open I-Entity
command I-Entity
when I-Entity
a I-Entity
drive I-Entity
is I-Entity
open I-Entity
, O
which O
has O
the O
effect O
of O
starting B-Action
the B-Entity
bot I-Entity
every B-Modifier
time I-Modifier
the B-Entity
user I-Entity
opens I-Entity
a I-Entity
disk I-Entity
drive I-Entity
. O

Below O
you O
can O
find O
the O
content O
of O
the O
init.cmd O
script O
used O
by O
MiniDuke B-Entity
to O
install B-Action
TwitterJS B-Entity
module I-Entity
onto B-Modifier
the B-Entity
system I-Entity
. O

When O
loaded O
, O
TwitterJS O
instantiates O
the O
JScript O
COM O
object O
and O
decrypts O
a O
JScript O
file O
containing O
the O
core O
logic O
of O
the O
module O
. O

Prior O
to O
executing O
it O
, O
MiniDuke B-Entity
applies B-Action
a B-Entity
light I-Entity
encoding I-Entity
to B-Modifier
the B-Entity
script I-Entity
: O
The O
next O
images O
show O
the O
result O
of O
two O
separate O
obfuscations O
, O
we O
can O
see O
that O
the O
variables O
have O
different O
values O
. O

This B-Entity
is O
probably O
done O
to O
thwart B-Action
security B-Entity
systems I-Entity
that I-Entity
scan I-Entity
at I-Entity
the I-Entity
entry I-Entity
points I-Entity
of I-Entity
the I-Entity
JScript I-Entity
engine I-Entity
. O

The O
purpose O
of O
this B-Entity
script I-Entity
is O
to O
use B-Action
Twitter B-Entity
to B-Modifier
find B-Entity
a I-Entity
C I-Entity
& I-Entity
C I-Entity
and O
retrieve B-Action
JScript B-Entity
code I-Entity
to I-Entity
execute I-Entity
. O

It O
first O
generates O
a O
Twitter O
user O
to O
search O
for O
; O
this O
search O
term O
changes O
every O
7 O
days O
and O
is O
actually O
a O
match O
to O
the O
real O
account O
name O
, O
not O
the O
Twitter O
account O
name O
. O

The O
bot O
then O
visits O
the O
Twitter O
profiles O
returned O
by O
the O
search O
and O
looks O
for O
links O
that O
end O
with O
'' O
.xhtml O

'' O
. O

When O
one O
is O
found O
, O
it O
replaces O
'' O
.xhtml O

'' O
with O
'' O
.php O

'' O
and O
fetches O
that O
link O
. O

Information O
about O
the O
computer O
is O
embedded O
in O
the O
Accept O
HTTP O
header O
. O

The O
first O
link O
on O
the O
retrieved O
page O
should O
contain O
base64 O
data O
; O
the O
name O
attribute O
of O
the O
link O
is O
used O
as O
a O
rolling O
XOR O
key O
to O
decrypt O
the O
JScript O
code O
. O

Finally O
, O
MiniDuke O
calculates O
a O
hash O
of O
the O
fetched O
script O
and O
compares O
it O
with O
a O
hardcoded O
hash O
in O
the O
TwitterJS O
script O
. O

If O
they O
match O
, O
the O
fetched O
script O
is O
executed O
by O
calling O
eval O
( O
) O
. O

The O
code O
hashing O
algorithm O
used O
by O
the O
component O
looks O
very O
much O
like O
SHA-1 O
but O
outputs O
different O
hashes O
( O
you O
can O
find O
the O
complete O
implementation O
in O
Appendix O
B O
. O

We O
decided O
to O
search O
for O
what O
was O
changed O
in O
the O
algorithm O
; O
one O
of O
our O
working O
hypotheses O
was O
that O
the O
algorithm O
might O
have O
been O
altered O
to O
make O
collisions O
feasible O
. O

We O
could O
n't O
find O
an O
obvious O
difference O
; O
all O
the O
constants O
and O
the O
steps O
of O
the O
algorithm O
were O
as O
expected O
. O

Then O
we O
noticed O
that O
for O
short O
messages O
only O
the O
second O
32-bit O
word O
was O
different O
when O
compared O
to O
the O
original O
SHA-1 O
. O

By O
examining O
how O
this O
2nd O
word O
was O
generated O
we O
finally O
discovered O
that O
this O
was O
caused O
by O
a O
scope O
issue O
. O

As O
shown O
below O
the O
SHA-1 O
function O
used O
a O
variable O
named O
f O
: O
the O
function O
Z O
( O
) O
is O
then O
called O
which O
also O
uses O
a O
variable O
named O
f O
without O
the O
var O
keyword O
, O
causing O
it O
to O
be O
treated O
as O
a O
global O
variable O
rather O
than O
local O
to O
the O
function O
. O

The O
end O
result O
is O
that O
the O
value O
of O
f O
is O
also O
changed O
in O
the O
SHA-1 O
function O
which O
affects O
the O
value O
of O
the O
2nd O
word O
for O
that O
round O
and O
ultimately O
the O
whole O
hash O
for O
long O
messages O
. O

A O
likely O
explanation O
of O
how O
this O
problem O
came O
to O
be O
is O
that O
the O
variable O
names O
were O
changed O
to O
single O
letters O
using O
an O
automated O
tool O
prior O
to O
embedding O
it O
in O
the O
payload O
. O

The O
2 O
f O
variables O
probably O
had O
different O
names O
in O
the O
original O
script O
which O
avoided O
the O
issue O
. O

So O
this O
leaves O
us O
with O
two O
takeaways O
: O
1 O
) O
The O
difference O
in O
the O
hashing O
algorithm O
was O
unintentional O
and O
2 O
) O
Always O
declare O
your O
local O
variables O
with O
the O
var O
keyword O
. O

; O
- O
) O
We O
generated O
the O
list O
of O
Twitter O
search O
terms O
for O
2013-2014 O
and O
checked O
if O
any O
of O
those O
were O
registered O
. O

At O
the O
moment O
only O
one O
exists O
, O
@ O
AA2ADcAOAA O
, O
which O
is O
the O
TwitterJS O
account O
that O
was O
generated O
between O
August O
21st O
and O
27th O
2013 O
. O

This O
account O
has O
no O
tweets O
. O

In O
an O
effort O
to O
discover O
potential O
victims O
, O
we O
registered O
the O
Twitter O
accounts O
corresponding O
to O
the O
current O
week O
both O
for O
the O
main O
and O
TwitterJS O
components O
and O
set O
up O
tweets O
with O
encrypted O
URLs O
so O
that O
an O
infected O
computer O
would O
reach O
out O
to O
our O
server O
. O

So O
far O
we O
have O
received O
connections O
via O
the O
TwitterJS O
accounts O
from O
four O
computers O
located O
in O
Belgium O
, O
France O
and O
the O
UK O
. O

We O
have O
contacted O
national O
CERTs O
to O
notify O
the O
affected O
parties O
. O

We O
detect O
the O
RTF O
exploit O
document O
as O
Win32/Exploit.CVE-2014-1761.D O
and O
the O
MiniDuke O
components O
as O
Win32/SandyEva.G O
. O

As O
the O
pro-democracy O
movement O
in O
Hong O
Kong O
has O
continued O
, O
we O
've O
been O
watching O
for O
indications O
of O
confrontation O
taking O
place O
in O
cyberspace O
. O

Protests O
began O
in O
September O
and O
have O
continued O
to O
escalate O
. O

In O
recent O
weeks O
, O
attackers B-Entity
have O
launched B-Action
a B-Entity
series I-Entity
of I-Entity
Distributed I-Entity
Denial I-Entity
of I-Entity
Service I-Entity
attacks I-Entity
( I-Entity
DDoS I-Entity
) I-Entity
against B-Modifier
websites B-Entity
promoting I-Entity
democracy I-Entity
in I-Entity
Hong I-Entity
Kong I-Entity
. O

According O
to O
the O
Wall O
Street O
Journal O
, O
websites B-Entity
belonging I-Entity
to I-Entity
Next I-Entity
Media I-Entity
's I-Entity
Apple I-Entity
Daily I-Entity
publication I-Entity
have O
suffered B-Action
from B-Modifier
an B-Entity
ongoing I-Entity
DDoS I-Entity
attack I-Entity
that I-Entity
'' I-Entity
brought I-Entity
down I-Entity
its I-Entity
email I-Entity
system I-Entity
for I-Entity
hours I-Entity
'' I-Entity
. O

According O
to O
other O
reports O
, O
Next B-Entity
Media I-Entity
's I-Entity
network I-Entity
has O
suffered B-Action
a B-Entity
'' I-Entity
total I-Entity
failure I-Entity
'' I-Entity
as B-Modifier
a I-Modifier
result I-Modifier
of I-Modifier
these B-Entity
attacks I-Entity
. O

Additionally O
, O
at O
least O
one O
member O
of O
the O
popular O
online O
forum O
HKGolden O
was O
arrested O
for O
posting O
messages O
encouraging O
support O
for O
the O
OccupyCentral O
Pro O
Democracy O
movement O
. O

The O
use O
of O
DDoS O
attacks O
as O
a O
political O
tool O
during O
times O
of O
conflict O
is O
not O
new O
; O
patriotic O
hacktivist O
groups O
frequently O
use O
them O
as O
a O
means O
to O
stifle O
political O
activity O
of O
which O
they O
disapprove O
. O

The O
question O
of O
state O
sponsorship O
( O
or O
at O
least O
tacit O
approval O
) O
in O
online O
crackdowns O
is O
often O
up O
for O
debate O
and O
ambiguous O
from O
a O
technical O
evidence O
and O
tradecraft O
perspective O
. O

In O
this O
case O
, O
however O
, O
we O
've O
discovered O
an O
overlap O
in O
the O
tools O
and O
infrastructure O
used O
by O
China-based O
advanced O
persistent O
threat O
( O
APT O
) O
actors O
and O
the O
DDoS O
attack O
activity O
. O

We O
believe O
that O
these O
DDoS O
attacks O
are O
linked O
to O
previously O
observed O
APT O
activity O
, O
including O
Operation O
Poisoned O
Hurricane O
. O

This O
correlation O
sheds O
light O
on O
the O
potential O
relationships O
, O
symbiosis O
and O
tool O
sharing O
between O
patriotic O
hacker O
activities O
designed O
to O
disrupt O
anti-government O
activists O
in O
China O
, O
and O
the O
APT O
activity O
we O
consistently O
see O
that O
is O
more O
IP O
theft O
and O
espionage-focused O
. O

FireEye O
has O
identified O
a B-Entity
number I-Entity
of I-Entity
binaries I-Entity
coded O
to O
receive B-Action
instructions B-Entity
from B-Modifier
a B-Entity
set I-Entity
of I-Entity
command I-Entity
and I-Entity
control I-Entity
( I-Entity
C2 I-Entity
) I-Entity
servers I-Entity
instructing B-Action
participating B-Entity
bots I-Entity
to B-Modifier
attack B-Entity
Next I-Entity
Media-owned I-Entity
websites I-Entity
and I-Entity
the I-Entity
HKGolden I-Entity
forum I-Entity
. O

Next O
Media O
is O
a O
large O
media O
company O
in O
Hong O
Kong O
and O
the O
HkGolden O
forum O
has O
been O
used O
as O
a O
platform O
to O
organize O
pro-democracy O
protests O
. O

Each O
sample O
we O
identified O
is O
signed O
with O
digital O
certificates O
that O
have O
also O
been O
used O
by O
APT O
actors O
to O
sign O
binaries O
in O
previous O
intrusion O
operations O
: O
These B-Entity
binaries I-Entity
are O
W32 O
Cabinet O
self-extracting O
files O
that O
drop B-Action
a B-Entity
variant I-Entity
of I-Entity
an I-Entity
older I-Entity
DDoS I-Entity
tool I-Entity
known I-Entity
as I-Entity
KernelBot I-Entity
. O

All O
of O
the O
samples O
we O
identified O
have O
the O
'' O
NewVersion O
'' O
value O
of O
20140926 O
. O

Structurally O
, O
all O
of O
these O
samples O
are O
similar O
in O
that O
they B-Entity
drop B-Action
three B-Entity
files I-Entity
: O
The B-Entity
KernelBot I-Entity
implants I-Entity
receive B-Action
targeting B-Entity
instructions I-Entity
from B-Modifier
C2 B-Entity
servers I-Entity
hard-coded I-Entity
directly I-Entity
into I-Entity
the I-Entity
sample I-Entity
. O

For O
example O
, O
c3d6450075d618b1edba17ee723eb3ca B-Entity
drops B-Action
a B-Entity
KernelBot I-Entity
variant I-Entity
that O
connects B-Action
to B-Modifier
both B-Entity
www.sapporo-digital-photoclub I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
and I-Entity
wakayamasatei I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
. O

The O
full O
list O
of O
C2 O
servers O
we O
identified O
is O
as O
follows O
: O
On O
Oct. O
21 O
, O
the O
control O
server O
at O
wakayamasatei O
[ O
. O

] O
com O
responded O
with O
the O
following O
encoded O
configuration O
file O
: O
This O
configuration O
file O
can O
be O
decoded O
by O
stripping O
the O
leading O
and O
trailing O
@ O
$ O
@ O
characters O
. O

At O
this O
point O
, O
a O
simple O
base64 O
and O
XOR O
decode O
will O
reveal O
the O
plaintext O
configuration O
. O

The O
following O
snippet O
of O
python O
code O
can O
be O
used O
to O
decode O
this O
command O
: O
FireEye O
has O
observed O
two B-Entity
different I-Entity
single-byte I-Entity
XOR I-Entity
keys I-Entity
used O
to O
encode B-Action
configuration B-Entity
files I-Entity
issued I-Entity
by I-Entity
the I-Entity
DDOS I-Entity
C2 I-Entity
servers I-Entity
in I-Entity
this I-Entity
campaign I-Entity
. O

The O
two O
different O
keys O
are O
0x2A O
or O
0x7E O
. O

The O
encoded O
configuration O
file O
shown O
above O
decodes O
to O
: O
During O
the O
course O
of O
our O
research O
, O
we O
've O
observed O
more B-Entity
than I-Entity
30 I-Entity
different I-Entity
unique I-Entity
configuration I-Entity
files I-Entity
issued B-Action
by O
the B-Entity
C2 I-Entity
servers I-Entity
listed I-Entity
above I-Entity
. O

These B-Entity
configurations I-Entity
issued B-Action
commands B-Entity
to I-Entity
attack I-Entity
the I-Entity
following I-Entity
domains I-Entity
and I-Entity
IPs I-Entity
: O
All O
of O
the O
above O
IPs O
host O
Next O
Media O
or O
Apple O
daily O
websites O
, O
with O
the O
exception O
of O
58.64.139.10 O
and O
124.217.214.149 O
. O

The O
IP O
58.64.139.10 O
has O
hosted O
hkgolden O
[ O
. O

] O
com O
– O
the O
domain O
for O
the O
HKGolden O
forum O
mentioned O
above O
. O

For O
approximately O
14 O
hours O
between O
October O
23rd O
and O
24th O
, O
the B-Entity
attackers I-Entity
pushed B-Action
a B-Entity
configuration I-Entity
update I-Entity
to B-Modifier
four B-Entity
controls I-Entity
servers I-Entity
that O
instructed B-Action
bots B-Entity
under I-Entity
their I-Entity
control I-Entity
to O
flood B-Action
124.217.214.149 B-Entity
with B-Modifier
UDP B-Entity
traffic I-Entity
. O

The O
IP O
124.217.214.149 O
hosted O
the O
attacker O
controlled O
domain O
p.java-sec O
[ O
. O

] O
com O
. O

On O
Oct. O
23 O
, O
2014 O
, O
two B-Entity
of I-Entity
the I-Entity
active I-Entity
controls I-Entity
began O
instructing B-Action
participating B-Entity
bots I-Entity
to B-Modifier
cease B-Entity
attacks I-Entity
. O

By O
Oct. O
24 O
, O
2014 O
, O
all B-Entity
five I-Entity
of I-Entity
the I-Entity
known I-Entity
active I-Entity
control I-Entity
servers I-Entity
were B-Action
issuing I-Action
commands B-Entity
to B-Modifier
cease B-Entity
the I-Entity
attacks I-Entity
. O

It O
should O
come O
as O
no O
surprise O
that O
hkgolden O
[ O
. O

] O
com O
, O
nextmedia O
[ O
. O

] O
com O
, O
and O
appledaily.com O
[ O
. O

] O
hk O
websites O
are O
now O
or O
previously O
have O
been O
blocked O
by O
the O
Great O
Firewall O
of O
China O
– O
indicating O
that O
the O
PRC O
has O
found O
the O
content O
hosted O
on O
these O
sites O
objectionable O
. O

The O
most O
direct O
connection O
between O
these O
DDoS O
attacks O
and O
previous O
APT O
activity O
is O
the O
use O
of O
the O
QTI O
International O
and O
CallTogether O
code O
signing O
certificates O
, O
which O
we O
have O
seen O
in O
malware O
attributed O
to O
APT O
activity O
. O

The O
QTI O
International O
digital O
certificate O
has O
been O
previously O
used O
to O
sign O
binaries O
used O
in O
APT O
activity O
including O
Operation O
Poisoned O
Hurricane O
. O

Specifically O
, O
17bc9d2a640da75db6cbb66e5898feb1 O
is O
a O
PlugX O
variant O
signed O
by O
the O
QTI O
International O
certificate O
. O

This B-Entity
PlugX I-Entity
variant I-Entity
connected B-Action
to B-Modifier
a B-Entity
Google I-Entity
Code I-Entity
project I-Entity
at I-Entity
code.google I-Entity
[ I-Entity
. I-Entity
] I-Entity
com/p/udom/ I-Entity
, O
where O
it B-Entity
decoded B-Action
a B-Entity
command I-Entity
that I-Entity
configured I-Entity
its I-Entity
C2 I-Entity
server I-Entity
. O

The O
sample O
0b54ae49fd5a841970b98a078968cb6b O
was O
signed O
with O
the O
QTI O
International O
certificate O
as O
well O
. O

This O
sample O
was O
first O
observed O
during O
a O
drive-by O
attack O
in O
June O
2014 O
, O
and O
was O
downloaded O
from O
java-se O
[ O
. O

] O
com/jp.jpg O
. O

This B-Entity
sample I-Entity
is B-Action
detected I-Action
as B-Modifier
Backdoor.APT.Preshin B-Entity
and O
connected B-Action
to B-Modifier
luxscena B-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
for B-Modifier
C2 B-Entity
. O

The O
QTI O
International O
certificate O
was O
also O
used O
to O
sign O
e2a4b96cce9de4fb126cfd5f5c73c3ed O
. O

We B-Entity
detect B-Action
this B-Entity
payload I-Entity
as B-Modifier
Backdoor.APT.PISCES B-Entity
and O
it B-Entity
used B-Action
hk.java-se B-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
for B-Modifier
C2 B-Entity
. O

The O
java-se O
[ O
. O

] O
com O
website O
was O
previously O
used O
in O
other O
attacks O
targeting O
the O
pro-democracy O
movement O
in O
Hong O
Kong O
. O

We O
first O
observed O
the O
presence O
of O
malicious O
javascript O
inserted O
into O
Hong O
Kong O
Association O
for O
Democracy O
and O
People's O
Livelihood O
on O
June O
26 O
, O
2014 O
, O
which O
appeared O
as O
the O
following O
: O
More O
recently O
, O
as O
noted O
by O
Claudio O
Guarnieri O
, O
the O
website O
of O
the O
Democratic O
Party O
of O
Hong O
Kong O
was O
seen O
hosting O
a O
redirect O
to O
the O
same O
malicious O
javascript O
. O

The O
CallTogether O
certificate O
has O
been O
used O
to O
sign O
ecf21054ab515946a812d1aa5c408ca5 O
. O

We B-Entity
also O
detect B-Action
this B-Entity
payload I-Entity
as B-Modifier
Backdoor.APT.PISCES B-Entity
and O
observed O
it B-Entity
connect B-Action
to B-Modifier
u.java-se B-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
. O

Both O
of O
these O
certificates O
are O
valid O
but O
can O
be O
detected O
and O
blocked O
via O
the O
following O
Yara O
signatures O
: O
These B-Entity
ongoing I-Entity
DDoS I-Entity
attacks I-Entity
and O
previous O
APT O
intrusion O
activity O
both O
target B-Action
the B-Entity
hkgolden I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
website I-Entity
. O

As O
noted O
above O
, O
this B-Entity
site I-Entity
has O
been B-Action
targeted I-Action
with B-Modifier
a B-Entity
DDoS I-Entity
attack I-Entity
by O
a B-Entity
KernelBot I-Entity
network I-Entity
. O

We O
also O
found O
that O
the O
hkgolden O
[ O
. O

] O
com O
website O
was O
compromised O
on O
Sept. O
5 O
, O
2014 O
and O
had O
a O
redirect O
to O
a O
malicious O
javascript O
again O
hosted O
at O
another O
jave-se O
[ O
. O

] O
com O
host O
, O
which O
appeared O
as O
follows O
: O
Finally O
, O
as O
noted O
above O
the O
IP O
124.217.214.149 O
was O
seen O
hosting O
the O
domain O
p.java-sec O
[ O
. O

] O
com O
between O
Oct. O
25 O
, O
2014 O
and O
Oct. O
27 O
, O
2014 O
. O

As O
Brandon O
Dixon O
noted O
here O
, O
the O
java-sec O
[ O
. O

] O
com O
domain O
is O
linked O
to O
the O
java- O
se O
[ O
. O

] O
com O
by O
shared O
hosting O
history O
at O
the O
following O
IP O
address O
: O
It O
is O
unclear O
why O
these O
actors O
would O
attack O
an O
IP O
address O
they O
were O
actively O
using O
. O

It O
's O
possible O
that O
the O
attackers O
wanted O
to O
test O
their O
botnet O
's O
capability O
by O
attacking O
an O
IP O
they O
were O
using O
to O
gather O
statistics O
on O
the O
size O
of O
the O
attack O
. O

It O
is O
also O
possible O
that O
the O
attackers O
simply O
made O
a O
mistake O
and O
accidentally O
issued O
commands O
to O
attack O
their O
own O
infrastructure O
. O

On O
Oct. O
24 O
, O
2014 O
, O
after O
attacking O
their O
own O
infrastructure O
, O
the B-Entity
attackers I-Entity
issued B-Action
new B-Entity
instructions I-Entity
to B-Modifier
their B-Entity
botnet I-Entity
that O
ceased O
all O
attacks O
. O

While O
not O
conclusive O
, O
the O
evidence O
presented O
above O
shows O
a O
link O
between O
confirmed O
APT O
activity O
and O
ongoing O
DDoS O
attacks O
that O
appear O
to O
be O
designed O
to O
silence O
the O
Pro O
Democracy O
movement O
in O
Hong O
Kong O
. O

The O
evidence O
does O
not O
conclusively O
prove O
that O
the O
same O
actors O
responsible O
for O
the O
DDoS O
attacks O
are O
also O
behind O
the O
observed O
intrusion O
activity O
discussed O
above O
– O
such O
as O
Operation O
Poisoned O
Hurricane O
. O

Rather O
, O
the O
evidence O
may O
indicate O
that O
a O
common O
quartermaster O
supports O
both O
the O
DDoS O
attacks O
and O
ongoing O
intrusion O
activity O
. O

In O
either O
scenario O
, O
there O
is O
a O
clear O
connection O
between O
the O
intrusion O
activity O
documented O
in O
Operation O
Poisoned O
Hurricane O
and O
the O
DDOS O
attacks O
documented O
here O
. O

While O
the O
tactics O
of O
these O
activities O
are O
very O
different O
from O
a O
technical O
perspective O
, O
each O
supports O
distinct O
political O
objectives O
. O

Operation O
Poisoned O
Hurricane O
's O
objective O
appeared O
to O
have O
in O
part O
been O
IP O
theft O
possibly O
for O
economic O
gain O
or O
other O
competitive O
advantages O
. O

In O
the O
DDOS O
attacks O
, O
the O
objective O
was O
to O
silence O
free O
speech O
and O
suppress O
the O
pro O
democracy O
movement O
in O
Hong O
Kong O
. O

The O
Chinese O
government O
is O
the O
entity O
most O
likely O
to O
be O
interested O
in O
achieving O
both O
of O
these O
objectives O
. O

This O
entry O
was O
posted O
in O
Threat O
Intelligence O
, O
Threat O
Research O
and O
tagged O
advanced O
malware O
, O
Cybersecurity O
, O
malware O
, O
zero-day O
by O
Ned O
Moran O
, O
Mike O
Oppenheim O
and O
Mike O
Scott O
. O

Bookmark O
the O
permalink O
. O

Repressive O
nation-states O
have O
long O
monitored O
telecommunica- O
tions O
to O
keep O
tabs O
on O
political O
dissent O
. O

The O
Internet O
and O
online O
social O
networks O
, O
however O
, O
pose O
novel O
technical O
challenges O
to O
this O
practice O
, O
even O
as O
they O
open O
up O
new O
domains O
for O
surveil- O
lance O
. O

We O
analyze O
an O
extensive O
collection O
of O
suspicious O
files O
and O
links O
targeting O
activists O
, O
opposition O
members O
, O
and O
non- O
governmental O
organizations O
in O
the O
Middle O
East O
over O
the O
past O
several O
years O
. O

We O
find O
that O
these O
artifacts O
reflect O
efforts O
to O
at- O
tack O
targets O
' O
devices O
for O
the O
purposes O
of O
eavesdropping O
, O
stealing O
information O
, O
and/or O
unmasking O
anonymous O
users O
. O

We O
describe O
attack O
campaigns O
we O
have O
observed O
in O
Bahrain O
, O
Syria O
, O
and O
the O
United O
Arab O
Emirates O
, O
investigating O
attackers O
, O
tools O
, O
and O
tech- O
niques O
. O

In O
addition O
to O
off-the-shelf O
remote O
access O
trojans O
and O
the O
use O
of O
third-party O
IP-tracking O
services O
, O
we O
identify O
commer- O
cial O
spyware O
marketed O
exclusively O
to O
governments O
, O
including O
Gamma O
's O
FinSpy O
and O
Hacking O
Team O
's O
Remote O
Control O
Sys- O
tem O
( O
RCS O
) O
. O

We O
describe O
their O
use O
in O
Bahrain O
and O
the O
UAE O
, O
and O
map O
out O
the O
potential O
broader O
scope O
of O
this O
activity O
by O
conduct- O
ing O
global O
scans O
of O
the O
corresponding O
command-and-control O
( O
C O
& O
C O
) O
servers O
. O

Finally O
, O
we O
frame O
the O
real-world O
consequences O
of O
these O
campaigns O
via O
strong O
circumstantial O
evidence O
linking O
hacking O
to O
arrests O
, O
interrogations O
, O
and O
imprisonment O
. O

Computer O
security O
research O
devotes O
extensive O
efforts O
to O
pro- O
tecting O
individuals O
against O
indiscriminate O
, O
large-scale O
attacks O
such O
as O
those O
used O
by O
cybercriminals O
. O

Recently O
, O
the O
prob- O
lem O
of O
protecting O
institutions O
against O
targeted O
attacks O
conducted O
by O
nation-states O
( O
so-called O
'' O
Advanced O
Persistent O
Threats O
'' O
) O
has O
likewise O
elicited O
significant O
research O
interest O
. O

Where O
these O
two O
problem O
domains O
intersect O
, O
however-targeted O
cyber O
attacks O
by O
nation-states O
against O
individuals-has O
received O
virtually O
no O
sig- O
nificant O
, O
methodical O
research O
attention O
to O
date O
. O

This O
new O
prob- O
lem O
space O
poses O
challenges O
that O
are O
both O
technically O
complex O
and O
of O
significant O
real-world O
importance O
. O

In O
this O
work O
we O
undertake O
to O
characterize O
the O
emergent O
prob- O
lem O
space O
of O
nation-state O
Internet O
attacks O
against O
individuals O
engaged O
in O
pro-democracy O
or O
opposition O
movements O
. O

While O
we O
lack O
the O
data O
to O
do O
so O
in O
a O
fully O
comprehensive O
fashion O
, O
we O
provide O
extensive O
detail O
from O
both O
technical O
and O
operational O
perspectives O
as O
seen O
in O
three O
countries O
. O

We O
view O
such O
character- O
izations O
as O
the O
fundamental O
first O
step O
necessary O
for O
the O
rigorous O
, O
scientific O
pursuit O
of O
a O
new O
problem O
space O
. O

For O
our O
study O
we O
draw O
upon O
several O
years O
of O
research O
we O
have O
conducted O
into O
cases O
from O
Bahrain O
, O
Syria O
and O
the O
United O
Arab O
Emirates O
. O

We O
frame O
the O
nature O
of O
these O
attacks O
, O
and O
the O
technology O
and O
infrastructure O
used O
to O
conduct O
them O
, O
in O
the O
con- O
text O
of O
their O
impacts O
on O
real O
people O
. O

We O
hope O
in O
the O
process O
to O
inspire O
additional O
research O
efforts O
addressing O
the O
difficult O
prob- O
lem O
of O
how O
to O
adequately O
protect O
individuals O
with O
very O
limited O
resources O
facing O
powerful O
adversaries O
. O

As O
an O
illustration O
of O
this O
phenomenon O
, O
consider O
the O
follow- O
ing O
anecdote O
, O
pieced O
together O
from O
public O
reports O
and O
court O
documents O
. O

At O
dawn O
on O
3/12/13 O
, O
police O
raided O
the O
house O
of O
17-year- O
old O
Ali O
Al-Shofa O
, O
confiscated O
his O
laptop O
and O
phone O
, O
and O
took O
him O
into O
custody O
. O

He O
was O
charged O
with O
referring O
to O
Bahrain's O
King O
as O
a O
'' O
dictator O
'' O
( O
) O
and O
'' O
fallen O
one O
'' O
( O
) O
on O
a O
pseudonymous O
Twitter O
account O
, O
@ O
alkawarahnews O
. O

Accord- O
ing O
to O
court O
documents O
, O
Bahrain O
's O
Cyber O
Crime O
Unit O
had O
linked O
an O
IP O
address O
registered O
in O
his O
father O
's O
name O
to O
the O
account O
on O
12/9/12 O
. O

Operators O
of O
@ O
alkawarahnews O
later O
forwarded O
a O
suspicious O
private O
message O
to O
one O
of O
the O
authors O
. O

The O
message O
was O
received O
on O
12/8/12 O
on O
a O
Facebook O
account O
linked O
to O
the O
Twitter O
handle O
, O
and O
contained O
a O
link O
to O
a O
protest O
video O
, O
purport- O
edly O
sent O
by O
an O
anti-government O
individual O
. O

The O
link O
redirected O
through O
iplogger.org O
, O
a O
service O
that O
records O
the O
IP O
address O
of O
anyone O
who O
clicks O
. O

Analytics O
for O
the O
link O
indicate O
that O
it O
had O
been O
clicked O
once O
from O
inside O
Bahrain O
. O

On O
6/25/13 O
, O
Ali O
was O
sentenced O
to O
one O
year O
in O
prison O
. O

Ali O
's O
case O
is O
an O
example O
of O
the O
larger O
phenomenon O
we O
in- O
vestigate O
: O
attacks O
against O
activists O
, O
dissidents O
, O
trade O
unionists O
, O
human O
rights O
campaigners O
, O
journalists O
, O
and O
members O
of O
NGOs O
( O
henceforth O
'' O
targets O
'' O
) O
in O
the O
Middle O
East O
. O

The B-Entity
attacks I-Entity
we I-Entity
have I-Entity
documented I-Entity
usually O
involve B-Action
the B-Entity
use I-Entity
of I-Entity
malicious I-Entity
links I-Entity
or I-Entity
e-mail I-Entity
attachments I-Entity
, O
designed O
to O
obtain B-Action
information B-Entity
from B-Modifier
a B-Entity
device I-Entity
. O

On O
the O
one O
hand O
, O
we O
have O
observed O
attacks B-Entity
using B-Action
a B-Entity
wide I-Entity
range I-Entity
of I-Entity
off-the-shelf I-Entity
spyware I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
publicly I-Entity
available I-Entity
third-party I-Entity
services I-Entity
, I-Entity
like I-Entity
iplogger.org I-Entity
. O

On O
the O
other O
hand O
, O
some B-Entity
at- I-Entity
tacks I-Entity
use B-Action
so-called B-Entity
'' I-Entity
lawful I-Entity
intercept I-Entity
'' I-Entity
trojans I-Entity
and O
related O
equip- O
ment O
, O
purportedly O
sold O
exclusively O
to O
governments O
by O
compa- O
nies O
like O
Gamma O
International O
and O
Hacking O
Team O
. O

The O
lat- O
ter O
advertises O
that O
governments O
need O
its O
technology O
to O
'' O
look O
through O
their O
target O
's O
eyes O
'' O
rather O
than O
rely O
solely O
on O
'' O
passive O
monitoring O
'' O
. O

Overall O
, O
the O
attacks O
we O
document O
are O
rarely O
technically O
novel O
. O

In O
fact O
, O
we O
suspect O
that O
the O
majority O
of O
at- O
tacks O
could O
be O
substantially O
limited O
via O
well-known O
security O
practices O
, O
settings O
, O
and O
software O
updates O
. O

Yet O
, O
the B-Entity
attacks I-Entity
are O
noteworthy O
for O
their O
careful B-Action
social I-Action
engineering I-Action
, O
their O
links O
to O
governments O
, O
and O
their O
real-world O
impact O
. O

We O
obtained O
the O
majority O
of O
our O
artifacts O
by O
encouraging O
in- O
dividuals O
who O
might O
be O
targeted O
by O
governments O
to O
provide O
us O
with O
suspicious O
files O
and O
unsolicited O
links O
, O
especially O
from O
un- O
familiar O
senders O
. O

While O
this O
process O
has O
provided O
a O
rich O
set O
of O
artifacts O
to O
analyze O
, O
it O
does O
not O
permit O
us O
to O
claim O
our O
dataset O
is O
representative O
. O

Our O
analysis O
links O
these O
attacks O
with O
a O
common O
class O
of O
ac- O
tor O
: O
an O
attacker O
whose O
behavior O
, O
choice O
of O
target O
, O
or O
use O
of O
in- O
formation O
obtained O
in O
the O
attack O
, O
aligns O
with O
the O
interests O
of O
a O
government O
. O

In O
some O
cases O
, O
such O
as O
Ali O
's O
, O
the O
attackers O
appear O
to O
be O
governments O
themselves O
; O
in O
other O
cases O
, O
they O
appear O
in- O
stead O
to O
be O
pro-government O
actors O
, O
ranging O
from O
patriotic O
, O
not O
necessarily O
skilled O
volunteers O
to O
cyber O
mercenaries O
. O

The O
phe- O
nomenon O
has O
been O
identified O
before O
, O
such O
as O
in O
Libya O
, O
when O
the O
fall O
of O
Gaddafi O
's O
regime O
revealed O
direct O
government O
ties O
to O
hacking O
during O
the O
2011 O
Civil O
War O
. O

We O
make O
the O
following O
contributions O
: O
• O
We O
analyze O
the O
technology O
associated O
with O
targeted O
at- O
tacks O
( O
e.g. O
, O
malicious O
links O
, O
spyware O
) O
, O
and O
trace O
it O
back O
to O
its O
programmers O
and O
manufacturers O
. O

While O
the O
attacks O
are O
not O
novel-and O
indeed O
often O
involve O
technology O
used O
by O
the O
cybercrime O
underground-they O
are O
significant O
be- O
cause O
they O
have O
a O
real-world O
impact O
and O
visibility O
, O
and O
are O
connected O
to O
governments O
. O

In O
addition O
, O
we O
often O
find O
amateurish O
mistakes O
in O
either O
the O
attacker O
's O
technology O
or O
operations O
, O
indicating O
that O
energy O
spent O
countering O
these O
threats O
can O
realize O
significant O
benefits O
. O

We O
do O
not O
, O
how- O
ever O
, O
conclude O
that O
all O
nation-state O
attacks O
or O
attackers O
are O
incompetent O
, O
and O
we O
suspect O
that O
some O
attacks O
have O
evaded O
our O
detection O
. O

• O
When O
possible O
, O
we O
empirically O
characterize O
the O
attacks O
and O
technology O
we O
have O
observed O
. O

We O
map O
out O
global O
use O
of O
two O
commercial O
hacking O
tools O
by O
governments O
by O
searching O
through O
Internet O
scan O
data O
using O
fingerprints O
for O
command-and-control O
( O
C O
& O
C O
) O
servers O
derived O
from O
our O
spyware O
analysis O
. O

• O
We O
develop O
strong O
evidence O
tying O
attacks O
to O
govern- O
ment O
sponsors O
and O
corporate O
suppliers O
, O
countering O
de- O
nials O
, O
sometimes O
energetic O
and O
sometimes O
indirect O
, O
of O
such O
involvement O
[ O
, O
, O
, O
] O
, O
in O
contrast O
to O
denials O
or O
claims O
of O
a O
corporate O
'' O
oversight O
'' O
board O
. O

Our O
scan- O
ning O
suggests O
use O
of O
'' O
lawful O
intercept O
'' O
trojans O
by O
11 O
ad- O
ditional O
countries O
considered O
governed O
by O
'' O
authoritarian O
regimes O
. O

'' O
We O
believe O
that O
activists O
and O
journalists O
in O
such O
countries O
may O
experience O
harassment O
or O
consequences O
to O
life O
or O
liberty O
from O
government O
surveillance O
. O

Finally O
, O
we O
do O
not O
explore O
potential O
defenses O
appropriate O
for O
protecting O
the O
target O
population O
in O
this O
work O
. O

We O
believe O
that O
to O
do O
so O
in O
a O
sufficiently O
well-grounded O
, O
meaningful O
manner O
first O
requires O
developing O
an O
understanding O
of O
the O
targets O
' O
knowledge O
of O
security O
issues O
, O
their O
posture O
regarding O
how O
they O
currently O
protect O
themselves O
, O
and O
the O
resources O
( O
including O
potentially O
ed- O
ucation O
) O
that O
they O
can O
draw O
upon O
. O

To O
this O
end O
, O
we O
are O
now O
con- O
ducting O
( O
with O
IRB O
approval O
) O
in-depth O
interviews O
with O
potential O
targets O
along O
with O
systematic O
examination O
of O
their O
Internet O
de- O
vices O
in O
order O
to O
develop O
such O
an O
understanding O
. O

In O
the O
past O
decades O
, O
a O
rich O
body O
of O
academic O
work O
has O
grown O
to O
document O
and O
understand O
government O
Internet O
censorship O
, O
in- O
cluding O
nationwide O
censorship O
campaigns O
like O
the O
Great O
Fire- O
wall O
of O
China O
[ O
, O
, O
] O
. O

Research O
on O
governmental O
Internet O
surveillance O
and O
activities O
like O
law-enforcement O
interception O
is O
a O
comparatively O
smaller O
area O
. O

Some O
academic O
work O
looks O
at O
government O
use O
of O
devices O
to O
enable O
censorship O
, O
such O
as O
key- O
word O
blacklists O
for O
Chinese O
chat O
clients O
, O
or O
the O
Green O
Dam O
censorware O
that O
was O
to O
be O
deployed O
on O
all O
new O
computers O
sold O
in O
China O
. O

We O
are O
aware O
of O
only O
limited O
previous O
work O
looking O
at O
advanced O
threat O
actors O
targeting O
activists O
with O
hack- O
ing O
, O
though O
this O
work O
has O
not O
always O
been O
able O
to O
establish O
ev- O
idence O
of O
government O
connections O
. O

Platforms O
used O
by O
potential O
targets O
, O
such O
as O
GMail O
, O
Twitter O
, O
and O
Facebook O
increasingly O
make O
transport- O
layer O
encryption O
the O
default O
, O
obscuring O
communications O
from O
most O
network O
surveillance O
. O

This O
use O
of O
encryption O
, O
along O
with O
the O
global O
nature O
of O
many O
social O
movements O
, O
and O
the O
role O
of O
diaspora O
groups O
, O
likely O
makes O
hacking O
increasingly O
attractive O
, O
especially O
to O
states O
who O
are O
unable O
to O
request O
or O
compel O
content O
from O
these O
platforms O
. O

Indeed O
, O
the O
increasing O
use O
of O
encryption O
and O
the O
global O
nature O
of O
targets O
have O
both O
been O
cited O
by O
pur- O
veyors O
of O
'' O
lawful O
intercept O
'' O
trojans O
in O
their O
marketing O
materi- O
als O
[ O
, O
] O
. O

In O
one O
notable O
case O
in O
2009 O
, O
UAE O
telecom O
firm O
Eti- O
salat O
distributed O
a O
system O
update O
to O
its O
then O
145,000 O
BlackBerry O
subscribers O
that O
contained O
spyware O
to O
read O
encrypted O
Black- O
Berry O
e-mail O
from O
the O
device O
. O

The O
spyware O
was O
discovered O
when O
the O
update O
drastically O
slowed O
users O
' O
phones O
. O

In O
con- O
trast O
to O
country-scale O
distribution O
, O
our O
work O
looks O
at O
this O
kind O
of O
pro-government O
and O
government-linked O
surveillance O
through O
highly O
targeted O
attacks O
. O

The O
term O
APT O
( O
Advanced O
Persistent O
Threat O
) O
refers O
to O
a O
sophisticated O
cyber-attacker O
who O
persistently O
attempts O
to O
tar- O
get O
an O
individual O
or O
group O
. O

Work O
outside O
the O
academic O
community O
tracking O
government O
cyberattacks O
typically O
falls O
under O
this O
umbrella O
. O

There O
has O
been O
significant O
work O
on O
APT O
outside O
the O
academic O
community O
, O
especially O
among O
se- O
curity O
professionals O
, O
threat O
intelligence O
companies O
, O
and O
human O
rights O
groups O
. O

Much O
of O
this O
work O
has O
focused O
on O
suspected O
government-on-government O
or O
government-on-corporation O
cy- O
ber O
attacks O
[ O
, O
] O
. O

Meanwhile O
, O
a O
small O
but O
growing O
body O
of O
this O
research O
deals O
with O
attacks O
carried O
out O
by O
governments O
against O
opposition O
and O
activist O
groups O
operating O
within O
, O
as O
well O
as O
outside O
their O
borders O
. O

One O
of O
the O
most O
notable O
cases O
is O
GhostNet O
, O
a O
large-scale O
cyber O
espionage O
campaign O
against O
the O
Tibetan O
independence O
movement O
[ O
, O
] O
. O

Other O
work O
avoids O
drawing O
conclusions O
about O
the O
attackers O
. O

Our O
study O
is O
based O
on O
extensive O
analysis O
of O
malicious O
files O
and O
suspect O
communications O
relevant O
to O
the O
activities O
of O
targeted O
groups O
in O
Bahrain O
, O
Syria O
, O
and O
the O
UAE O
, O
as O
documented O
in O
Ta- O
ble O
1 O
. O

A O
number O
of O
the O
attacks O
had O
significant O
real-world O
impli- O
cations O
, O
per O
Table O
2 O
. O

In O
many O
cases O
, O
we O
keep O
our O
descriptions O
somewhat O
imprecise O
to O
avoid O
potential O
leakage O
of O
target O
identi- O
ties O
. O

We O
began O
our O
work O
when O
contacted O
by O
individuals O
con- O
cerned O
that O
a O
government O
might O
have O
targeted O
them O
for O
cyber- O
attacks O
. O

As O
we O
became O
more O
acquainted O
with O
the O
targeted O
com- O
munities O
, O
in O
some O
cases O
we O
contacted O
targeted O
groups O
directly O
; O
in O
others O
, O
we O
reached O
out O
to O
individuals O
with O
connections O
to O
tar- O
geted O
groups O
, O
who O
allowed O
us O
to O
examine O
their O
communications O
with O
the O
groups O
. O

For O
Bahrain O
and O
Syria O
, O
the O
work O
encompassed O
10,000s O
of O
e-mails O
and O
instant O
messages O
. O

For O
the O
UAE O
, O
the O
vol- O
ume O
is O
several O
thousand O
communications O
. O

This O
following O
sections O
outline O
recent O
targeted O
hacking O
cam- O
paigns O
in O
Bahrain O
, O
Syria O
and O
the O
UAE O
. O

These O
cases O
have O
a O
com- O
mon O
theme O
: O
attacks O
against O
targets O
' O
computers O
and O
devices O
with O
malicious O
files O
and O
links O
. O

In O
some O
cases O
the B-Entity
attackers I-Entity
employed B-Action
expensive B-Entity
and I-Entity
'' I-Entity
government I-Entity
exclusive I-Entity
'' I-Entity
malware I-Entity
, O
while O
in O
other O
cases O
, O
attackers B-Entity
used B-Action
cheap B-Entity
and I-Entity
readily I-Entity
available I-Entity
RATs I-Entity
. O

Across O
these O
cases O
we O
find O
that O
clever B-Entity
social I-Entity
engineering I-Entity
often O
plays B-Action
a B-Entity
central I-Entity
role I-Entity
, O
which O
is O
strong O
evidence O
of O
a O
well-informed O
ad- O
versary O
. O

We O
also O
, O
however O
, O
frequently O
find O
technical O
and O
op- O
erational O
errors O
by O
the O
attackers O
that O
enable O
us O
to O
link O
attacks O
to O
governments O
. O

In O
general O
, O
the B-Entity
attacks I-Entity
we O
find O
are B-Action
not I-Action
well- I-Action
detected I-Action
by B-Modifier
anti-virus B-Entity
programs I-Entity
. O

We O
have O
analyzed O
two O
attack O
campaigns O
in O
the O
context O
of O
Bahrain O
, O
where O
the O
government O
has O
been O
pursuing O
a O
crackdown O
against O
an O
Arab-Spring O
inspired O
uprising O
since O
2/14/2011 O
. O

The B-Entity
first I-Entity
involved B-Action
malicious B-Entity
e-mails I-Entity
containing I-Entity
FinSpy I-Entity
, I-Entity
a I-Entity
'' I-Entity
lawful I-Entity
intercept I-Entity
'' I-Entity
trojan I-Entity
sold I-Entity
exclusively I-Entity
to I-Entity
governments I-Entity
. O

The B-Entity
second I-Entity
involved B-Action
specially B-Entity
crafted I-Entity
IP I-Entity
spy I-Entity
links I-Entity
and I-Entity
e-mails I-Entity
de- O
signed O
to O
reveal B-Action
the B-Entity
IP I-Entity
addresses I-Entity
of I-Entity
operators I-Entity
of I-Entity
pseudonymous I-Entity
accounts I-Entity
. O

Some O
individuals O
who O
apparently O
clicked O
on O
these O
links O
were O
later O
arrested O
, O
including O
Ali O
( O
cf O
. O

§1 O
) O
, O
whose O
click O
appears O
to O
have O
been O
used O
against O
him O
in O
court O
. O

While O
both O
campaigns O
point O
back O
to O
the O
government O
, O
we O
have O
not O
as O
yet O
identified O
overlap O
between O
the O
campaigns O
; O
targets O
of O
FinSpy O
appeared O
to O
reside O
mainly O
outside O
Bahrain O
, O
whereas O
the O
IP O
spy O
links O
targeted O
those O
mainly O
inside O
the O
country O
. O

We O
examine O
each O
campaign O
in O
turn O
. O

Beginning O
in O
April O
2012 O
, O
the O
authors O
received O
5 O
suspicious O
e-mails O
from O
US O
and O
UK-based O
activists O
and O
journalists O
working O
on O
Bahrain O
. O

We O
found O
that O
some B-Entity
of I-Entity
the I-Entity
attachments I-Entity
contained B-Action
a B-Entity
PE I-Entity
( I-Entity
.exe I-Entity
) I-Entity
file I-Entity
designed I-Entity
to I-Entity
appear I-Entity
as I-Entity
an I-Entity
image I-Entity
. O

Their B-Entity
filenames I-Entity
contained B-Action
a B-Entity
Uni- I-Entity
code I-Entity
right-to-left I-Entity
override I-Entity
( I-Entity
RLO I-Entity
) I-Entity
character I-Entity
, O
causing B-Action
Windows B-Entity
to I-Entity
render I-Entity
a I-Entity
filename I-Entity
such I-Entity
as I-Entity
gpj.1bajaR.exe I-Entity
instead I-Entity
as I-Entity
exe.Rajab1.jpg I-Entity
. O

The B-Entity
other I-Entity
.rar I-Entity
files I-Entity
contained B-Action
a B-Entity
Word I-Entity
document I-Entity
with I-Entity
an I-Entity
embedded I-Entity
ASCII-encoded I-Entity
PE I-Entity
file I-Entity
containing O
a B-Entity
custom I-Entity
macro I-Entity
set I-Entity
to O
automatically B-Action
run I-Action
upon B-Modifier
document B-Entity
startup I-Entity
. O

Under O
default O
security O
settings O
, O
Office O
disables O
all O
unsigned O
macros O
, O
so O
that O
a O
user O
who O
opens O
the O
document O
will O
only O
see O
an O
informational O
message O
that O
the O
macro O
has O
been O
disabled O
. O

Thus O
, O
this O
attack O
was O
apparently O
designed O
with O
the O
belief O
or O
hope O
that O
targets O
would O
have O
reduced O
security O
settings O
. O

Identification O
as O
FinSpy O
: O
By O
running O
the O
sample O
using O
Windows O
Virtual O
PC O
, O
we O
found O
the O
following O
string O
in O
mem- O
ory O
: O
y O
: O
\lsvnbranches\finspyv4.01\finspyv2\ O
. O

This O
string O
suggests O
FinSpy O
, O
a O
product O
of O
Gamma O
Inter- O
national O
. O

The B-Entity
executables I-Entity
used B-Action
virtualized B-Entity
obfusca- I-Entity
tion I-Entity
, O
which O
appeared O
to O
be O
custom-designed O
. O

We O
de- O
vised O
a O
fingerprint O
for O
the O
obfuscater O
and O
located O
a O
structurally O
similar O
executable O
by O
searching O
a O
large O
malware O
database O
. O

This B-Entity
executable I-Entity
contained O
a O
similar O
string O
, O
except O
it O
identi- O
fied O
itself O
as O
FinSpy O
v3.00 O
, O
and O
attempted O
to O
connect B-Action
to B-Modifier
tiger.gamma-international.de B-Entity
, I-Entity
a I-Entity
domain I-Entity
registered I-Entity
to I-Entity
Gamma I-Entity
International I-Entity
GmbH I-Entity
. O

Analysis O
of O
capabilities O
: O
We O
found O
that O
the B-Entity
spyware I-Entity
has O
a O
modular O
design O
, O
and O
can O
download B-Action
additional B-Entity
modules I-Entity
from B-Modifier
a B-Entity
command I-Entity
& I-Entity
control I-Entity
( I-Entity
C I-Entity
& I-Entity
C I-Entity
) I-Entity
server I-Entity
, O
including B-Action
password B-Entity
cap- I-Entity
ture I-Entity
( I-Entity
from I-Entity
over I-Entity
20 I-Entity
applications I-Entity
) I-Entity
and O
recording B-Entity
of I-Entity
screenshots I-Entity
, O
Skype B-Entity
chat I-Entity
, O
file B-Entity
transfers I-Entity
, O
and O
input B-Entity
from I-Entity
the B-Entity
computer I-Entity
's I-Entity
micro- I-Entity
phone I-Entity
and O
webcam B-Entity
. O

To O
exfiltrate B-Action
data B-Entity
back B-Modifier
to I-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
a B-Entity
module I-Entity
encrypts B-Action
and O
writes B-Action
it B-Entity
to B-Modifier
disk B-Entity
in I-Entity
a I-Entity
special I-Entity
folder I-Entity
. O

The B-Entity
spyware I-Entity
period- O
ically O
probes B-Action
this B-Entity
folder I-Entity
for B-Modifier
files B-Entity
that I-Entity
match I-Entity
a I-Entity
certain I-Entity
naming I-Entity
convention I-Entity
, O
then O
sends B-Action
them B-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

It B-Entity
then O
over- B-Action
writes I-Action
the B-Entity
files I-Entity
, O
renames B-Action
them B-Entity
several B-Entity
times I-Entity
, O
and O
deletes B-Action
them B-Entity
, O
in O
an O
apparent O
effort O
to O
frustrate B-Action
forensic B-Entity
analysis I-Entity
. O

Analysis O
of O
encryption O
: O
Because O
the B-Entity
malware I-Entity
employed B-Action
myriad B-Entity
known I-Entity
anti-debugging I-Entity
and I-Entity
anti-analysis I-Entity
techniques I-Entity
, O
it B-Entity
thwarted B-Action
our B-Entity
attempts I-Entity
to I-Entity
attach I-Entity
debuggers I-Entity
. O

Since O
it O
did O
not O
in- O
clude O
anti-VM O
code O
, O
we O
ran O
it O
in O
TEMU O
, O
an O
x86 O
emulator O
de- O
signed O
for O
malware O
analysis O
. O

TEMU O
captures O
instruction- O
level O
execution O
traces O
and O
provides O
support O
for O
taint-tracking O
. O

We O
found O
that O
FinSpy B-Entity
encrypts B-Action
data B-Entity
using B-Modifier
a B-Entity
custom I-Entity
imple- I-Entity
mentation I-Entity
of I-Entity
AES-256-CBC I-Entity
. O

The B-Entity
32 I-Entity
byte I-Entity
AES I-Entity
key I-Entity
and I-Entity
16 I-Entity
byte I-Entity
IV I-Entity
are B-Action
generated I-Action
by B-Modifier
repeatedly B-Entity
reading I-Entity
the I-Entity
low-order-4-bytes I-Entity
of I-Entity
the I-Entity
Windows I-Entity
clock I-Entity
. O

The B-Entity
key I-Entity
and I-Entity
IV I-Entity
are B-Action
encrypted I-Action
using B-Modifier
an B-Entity
em- I-Entity
bedded I-Entity
RSA-2048 I-Entity
public I-Entity
key I-Entity
, O
and O
stored O
in O
the O
same O
file O
as O
the O
data O
. O

The O
private O
key O
presumably O
resides O
on O
the O
C O
& O
C O
server O
. O

The O
weak O
AES O
keys O
make O
decryption O
of O
the O
data O
straightfor- O
ward O
. O

We O
wrote O
a O
program O
that O
generally O
can O
find O
these O
keys O
in O
under O
an O
hour O
, O
exploiting O
the O
fact O
that O
many O
of O
the O
system O
clock O
readings O
occur O
within O
the O
same O
clock-update O
quantum O
. O

In O
addition O
, O
FinSpy O
's O
AES O
code O
fails O
to O
encrypt O
the O
last O
block O
of O
data O
if O
less O
than O
the O
AES O
block O
size O
of O
128 O
bits O
, O
leaving O
trail- O
ing O
plaintext O
. O

Finally O
, O
FinSpy B-Entity
's I-Entity
wire I-Entity
protocol I-Entity
for I-Entity
C I-Entity
& I-Entity
C I-Entity
commu- I-Entity
nication I-Entity
uses B-Action
the B-Entity
same I-Entity
type I-Entity
of I-Entity
encryption I-Entity
, O
and O
thus O
is O
subject O
to O
the O
same O
brute O
force O
attack O
on O
AES O
keys O
. O

While O
we O
suspect O
FinSpy O
's O
cryptographic O
deficiencies O
reflect O
bugs O
, O
it O
is O
also O
con- O
ceivable O
that O
the O
cryptography O
was O
deliberately O
weakened O
to O
facilitate O
one O
government O
monitoring O
the O
surveillance O
of O
oth- O
ers O
. O

C O
& O
C O
server O
: O
The B-Entity
samples I-Entity
communicated B-Action
with B-Modifier
77.69.140.194 B-Entity
, O
which O
belongs O
to O
a O
subscriber O
of O
Batelco O
, O
Bahrain O
's O
main O
ISP O
. O

Analyzing O
network O
traffic O
between O
our O
infected O
VM O
and O
the O
C O
& O
C O
server O
revealed O
that O
the O
server O
used O
a O
global O
IPID O
, O
which O
allowed O
us O
to O
infer O
server O
activity O
by O
its O
progression O
. O

In O
response O
to O
our O
preliminary O
work O
an O
executive O
at O
Gamma O
told O
the O
press O
that O
Bahrain O
's O
FinSpy O
server O
was O
merely O
a O
proxy O
and O
the O
real O
server O
could O
have O
been O
anywhere O
, O
as O
part O
of O
a O
claim O
that O
the O
Bahrain O
FinSpy O
deployment O
could O
have O
been O
associ- O
ated O
with O
another O
government O
. O

However O
, O
a O
proxy O
would O
show O
gaps O
in O
a O
global O
IPID O
as O
it O
forwarded O
traffic O
; O
our O
frequent O
observation O
of O
strictly O
consecutive O
IPIDs O
thus O
contradicts O
this O
statement O
. O

Exploitation O
of O
captured O
data O
: O
Since O
we O
suspected O
the O
spy- O
ware O
operator O
would O
likely O
seek O
to O
exploit O
captured O
credentials O
, O
particularly O
those O
associated O
with O
Bahraini O
activist O
organiza- O
tions O
, O
we O
worked O
with O
Bahrain O
Watch O
, O
an O
activist O
organization O
inside O
Bahrain O
. O

Bahrain O
Watch O
established O
a O
fake O
login O
page O
on O
their O
website O
and O
provided O
us O
with O
a O
username O
and O
pass- O
word O
. O

From O
a O
clean O
VM O
, O
we O
logged O
in O
using O
these O
credentials O
, O
saving O
the O
password O
in O
Mozilla O
Firefox O
. O

We O
then O
infected O
the O
VM O
with O
FinSpy O
and O
allowed O
it B-Entity
to O
connect B-Action
to B-Modifier
the B-Entity
Bahrain I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

Bahrain O
Watch O
's O
website O
logs O
revealed O
a O
subsequent O
hit O
from O
89.148.0.41-made O
however O
to O
the O
site O
's O
home- O
page O
, O
rather O
than O
its O
login O
page-coming O
shortly O
after O
we O
had O
infected O
the O
VM O
. O

Decrypting O
packet O
captures O
of O
the O
spyware's O
activity O
, O
we O
found O
that O
our O
VM O
sent O
the O
password O
to O
the O
server O
exactly O
one O
minute O
earlier O
: O
The O
URL O
provided O
to O
the O
server O
did O
not O
include O
the O
path O
to O
the O
login O
page O
, O
which O
was O
inaccessible O
from O
the O
home- O
page O
. O

This O
omission O
reflects O
the O
fact O
that O
the O
Firefox O
password O
database O
stores O
only O
domain O
names O
, O
not O
full O
login O
page O
URLs O
, O
for O
each O
password O
. O

Repeating O
the O
experiment O
again O
yielded O
a O
hit O
from O
the O
same O
IP O
address O
within O
a O
minute O
. O

We O
inspected O
Bahrain O
Watch O
's O
logs O
, O
which O
showed O
no O
subsequent O
( O
or O
previ- O
ous O
) O
activity O
from O
that O
address O
, O
nor O
any O
instances O
of O
the O
same O
User O
Agent O
string O
. O

In O
an O
IP O
spy O
attack O
, O
the B-Entity
attacker I-Entity
aims O
to O
discover B-Action
the B-Entity
IP I-Entity
address I-Entity
of I-Entity
a I-Entity
victim I-Entity
who I-Entity
is I-Entity
typically I-Entity
the I-Entity
opera- I-Entity
tor I-Entity
of I-Entity
a I-Entity
pseudonymous I-Entity
social I-Entity
media I-Entity
or I-Entity
e-mail I-Entity
account I-Entity
. O

The B-Entity
at- I-Entity
tacker I-Entity
sends B-Action
the B-Entity
pseudonymous I-Entity
account I-Entity
a I-Entity
link I-Entity
to I-Entity
a I-Entity
webpage I-Entity
or I-Entity
an I-Entity
e-mail I-Entity
containing I-Entity
an I-Entity
embedded I-Entity
remote I-Entity
image I-Entity
, O
using B-Modifier
one B-Entity
of I-Entity
many I-Entity
freely-available I-Entity
services I-Entity
. O

When O
the O
victim O
clicks O
on O
the O
link O
or O
opens O
the O
e-mail O
, O
their B-Entity
IP I-Entity
address I-Entity
is B-Action
revealed I-Action
to B-Modifier
the B-Entity
at- I-Entity
tacker I-Entity
. O

The O
attacker O
then O
discovers O
the O
victim O
's O
identity O
from O
their O
ISP O
. O

In O
one O
case O
we O
identified O
legal O
documents O
that O
pro- O
vided O
a O
circumstantial O
link O
between O
such O
a O
spy O
link O
and O
a O
sub- O
sequent O
arrest O
. O

Figure O
2 O
illustrates O
the O
larger O
ecosystem O
of O
these O
attacks O
. O

The O
attackers O
appear O
to O
represent O
a O
single O
entity O
, O
as O
the O
activity O
all O
connects O
back O
to O
accounts O
that O
sent O
links O
shortened O
using O
a O
par- O
ticular O
user O
account O
al9mood O
on O
the O
bit.ly O
URL O
shortening O
service O
. O

Recall O
Ali O
Faisal O
Al-Shufa O
( O
discussed O
in O
Section O
1 O
) O
, O
who O
was O
accused O
of O
sending O
insulting O
tweets O
from O
an O
account O
@ O
alkawarahnews O
( O
Al O
Kawarah O
News O
in O
Figure O
2 O
) O
. O

An O
op- O
erator O
of O
the O
account O
forwarded O
us O
a O
suspicious O
private O
message O
sent O
to O
the O
Al O
Kawarah O
News O
Facebook O
account O
from O
Red O
Sky O
. O

Red O
Sky O
was O
purportedly O
arrested O
on O
10/17/12 O
, O
was O
convicted O
of O
insulting O
the O
King O
on O
his O
Twitter O
account O
@ O
RedSky446 O
, O
and O
was O
sentenced O
to O
four O
months O
prison O
. O

When O
released O
, O
he O
found O
that O
the O
passwords O
for O
his O
Twitter O
, O
Facebook O
, O
and O
e-mail O
accounts O
had O
been O
changed O
, O
and O
did O
not O
know O
how O
to O
recover O
his O
accounts O
. O

The O
message O
that O
Red O
Sky O
's O
account O
sent O
to O
Al O
Kawarah O
News O
included O
a O
link O
shortened O
using O
Google O
's O
goo.gl O
ser- O
vice O
. O

We O
used O
the O
goo.gl O
API O
to O
access O
analytics O
for O
the O
link O
, O
finding O
that O
it O
unshortened O
to O
iplogger.org/25SX O
and O
was O
created O
on O
12/8/12 O
. O

The O
link O
had O
received O
only O
one O
click O
, O
which O
came O
from O
Bahrain O
with O
the O
referrer O
www.facebook.com O
. O

Ali O
's O
case O
files O
contained O
a O
request O
from O
the O
Public O
Prose- O
cution O
for O
information O
on O
an O
IP O
address O
that O
it O
had O
linked O
to O
Al O
Kawarah O
News O
about O
22 O
hours O
after O
the O
link O
was O
created O
. O

Court O
documents O
indicate O
that O
ISP O
data O
linked O
the O
IP O
address O
to O
Ali O
, O
and O
on O
this O
basis O
he O
was O
sentenced O
to O
one O
year O
in O
prison O
. O

Red O
Sky O
also O
targeted O
M O
in O
Figure O
2 O
. O

M O
recalled O
click- O
ing O
on O
a O
link O
from O
Red O
Sky O
while O
using O
an O
Internet O
connec- O
tion O
from O
one O
of O
the O
houses O
in O
M O
's O
village O
. O

The O
house O
was O
raided O
by O
police O
on O
3/12/13 O
, O
who O
were O
looking O
for O
the O
sub- O
scriber O
of O
the O
house O
's O
internet O
connection O
. O

Police O
questioning O
revolved O
around O
Tweets O
that O
referred O
to O
Bahrain O
's O
King O
as O
a O
'' O
cursed O
one O
. O

'' O
Red B-Entity
Sky I-Entity
had O
earlier O
targeted B-Action
other B-Entity
users I-Entity
with B-Modifier
IP B-Entity
spy I-Entity
links I-Entity
shortened I-Entity
using I-Entity
the I-Entity
al9mood I-Entity
bit.ly I-Entity
account I-Entity
. O

The O
attack O
on O
Jehad O
Abdulla O
is O
noteworthy O
, O
as O
the O
ac- O
count O
's O
activity O
aligned O
with O
communities O
typically O
critical O
of O
Bahrain O
's O
opposition O
. O

However O
, O
the O
account O
also O
directly O
crit- O
icized O
the O
King O
on O
occasion O
, O
in O
one O
case O
referring O
to O
him O
as O
'' O
weak O
'' O
and O
'' O
stingy O
. O

'' O
An B-Entity
account I-Entity
linked I-Entity
to I-Entity
al9mood I-Entity
sent B-Action
Je- B-Entity
had I-Entity
Abdulla I-Entity
an B-Entity
IP I-Entity
spy I-Entity
link I-Entity
on B-Modifier
10/2/12 B-Entity
in B-Modifier
a B-Entity
public I-Entity
message I-Entity
. O

On O
10/16/12 O
, O
Salman O
Darwish O
was O
arrested O
for O
insulting O
the O
King O
using O
the O
Jehad O
Abdulla O
account O
. O

He O
was O
sentenced O
to O
one O
month O
in O
prison O
, O
partly O
on O
the O
basis O
of O
his O
confession O
. O

Salman's O
father O
claims O
that O
police O
denied O
Salman O
food O
, O
drink O
, O
and O
medi- O
cal O
care O
. O

Another O
account O
linked O
to O
al9mood O
targeted O
@ O
YLUBH O
, O
the O
Twitter O
account O
of O
Yokogawa O
Union O
, O
a O
trade O
union O
at O
the O
Bahraini O
branch O
of O
a O
Japanese O
company O
. O

@ B-Entity
YLUBH I-Entity
received B-Action
at B-Entity
least I-Entity
three I-Entity
IP I-Entity
spy I-Entity
links I-Entity
in B-Modifier
late B-Entity
2012 I-Entity
, O
sent O
via O
public O
Twitter O
mes O
sages O
. O

Yokogawa O
fired O
the O
leader O
of O
the O
trade O
union O
, O
Sami O
Ab- O
dulaziz O
Hassan O
, O
on O
3/23/13 O
. O

It O
later O
emerged O
that O
Sami O
was O
indeed O
the O
operator O
of O
the O
@ O
YLUBH O
account O
, O
and O
that O
the O
police O
had O
called O
him O
in O
for O
questioning O
in O
relation O
to O
its O
tweets O
. O

Use O
of O
embedded O
remote O
images O
: O
We O
identified O
several B-Entity
targets I-Entity
who O
received B-Action
spoofed B-Entity
e-mails I-Entity
containing I-Entity
embedded I-Entity
remote I-Entity
images I-Entity
. O

Figure O
2 O
shows O
two O
such O
cases O
, O
Maryam O
and O
Sayed O
Yousif O
. O

The B-Entity
attacker I-Entity
sent B-Action
the B-Entity
e-mails I-Entity
using B-Modifier
ReadNotify.com B-Entity
, O
which O
records B-Action
the B-Entity
user I-Entity
's I-Entity
IP I-Entity
address I-Entity
upon B-Modifier
their B-Entity
mail I-Entity
client I-Entity
downloading I-Entity
the I-Entity
remote I-Entity
image I-Entity
. O

While O
ReadNotify.com O
forbids O
spoofing O
in O
their O
TOS O
, O
the O
service O
has O
a O
vulnerability O
known O
to O
the O
attackers O
( O
and O
which O
we O
confirmed O
) O
that O
allows O
spoofing O
the O
From O
address O
by O
directly O
setting O
the O
parameters O
on O
a O
submission O
form O
on O
their O
website O
. O

We O
have O
not O
found O
evidence O
suggesting O
this O
vulnerabil- O
ity O
is O
publicly O
known O
, O
but O
it O
appears O
clear O
that O
the O
attacker O
ex- O
ploited O
it O
, O
as O
the O
web O
form O
adds O
a O
X-Mai1er O
: O
RNwebmail O
header O
not O
added O
when O
sending O
through O
ReadNotify.com's O
other O
supported O
methods O
. O

The O
header O
appeared O
in O
each O
e-mail O
the O
targets O
forwarded O
to O
us O
. O

When O
spoofing O
using O
this O
method O
, O
the O
original O
sender O
ad- O
dress O
still O
appears O
in O
X-Sender O
and O
other O
headers O
. O

Accord- O
ing O
to O
these O
, O
the O
e-mails O
received O
by O
the O
targets O
all O
came O
from O
fatoomah85 O
@ O
gmail.com O
. O

A O
link O
sent O
in O
one O
of O
these O
e- O
mails O
was O
connected O
to O
the O
al9mood O
bit.ly O
account O
. O

In O
monitoring O
accounts O
connected O
to O
al9mood O
, O
we O
counted O
more O
than O
200 O
IP O
spy O
links O
in O
Twitter O
messages O
and O
public O
Facebook O
posts O
. O

Attackers B-Entity
often O
used B-Action
( B-Entity
1 I-Entity
) I-Entity
accounts I-Entity
of I-Entity
promi- I-Entity
nent I-Entity
or I-Entity
trusted I-Entity
but I-Entity
jailed I-Entity
individuals I-Entity
like I-Entity
'' I-Entity
Red I-Entity
Sky I-Entity
, I-Entity
'' I-Entity
( I-Entity
2 I-Entity
) I-Entity
fake I-Entity
personas I-Entity
( I-Entity
e.g. I-Entity
, I-Entity
attractive I-Entity
women I-Entity
or I-Entity
fake I-Entity
job I-Entity
seekers I-Entity
when I-Entity
tar- I-Entity
geting I-Entity
a I-Entity
labor I-Entity
union I-Entity
) I-Entity
, I-Entity
or I-Entity
( I-Entity
3 I-Entity
) I-Entity
impersonations I-Entity
of I-Entity
legitimate I-Entity
ac- I-Entity
counts I-Entity
. O

In O
one O
particularly O
clever O
tactic O
, O
attackers O
exploited O
Twitter O
's O
default O
font O
, O
for O
example O
substituting O
a O
lowercase O
'' O
l O
'' O
with O
an O
uppercase O
'' O
I O
'' O
or O
switching O
vowels O
( O
e.g O
. O

from O
'' O
a O
'' O
to O
an O
'' O
e O
'' O
) O
to O
create O
at-a-glance O
identical O
usernames O
. O

In O
addition O
, O
malicious O
accounts O
tended O
to O
quickly O
delete O
IP O
spy O
tweets O
sent O
via O
( O
public O
) O
mentions O
, O
and O
frequently O
change O
profile O
names O
. O

The O
use O
of O
RATs O
against O
the O
opposition O
has O
been O
a O
well- O
documented O
feature O
of O
the O
Syrian O
Civil O
War O
since O
the O
first O
re- O
ports O
were O
published O
in O
early O
2012 O
[ O
, O
, O
, O
, O
] O
. O

The O
phenomenon O
is O
widespread O
, O
and O
in O
our O
experience O
, O
most O
mem- O
bers O
of O
the O
opposition O
know O
that O
some O
hacking O
is O
taking O
place O
. O

As O
summarized O
in O
Table O
3 O
, O
the B-Entity
attacks I-Entity
often O
include B-Action
fake B-Entity
or I-Entity
ma- I-Entity
liciously I-Entity
packaged I-Entity
security I-Entity
tools I-Entity
; I-Entity
intriguing I-Entity
, I-Entity
or I-Entity
ideological I-Entity
, I-Entity
or I-Entity
movement-relevant I-Entity
content I-Entity
( I-Entity
e.g I-Entity
. I-Entity
lists I-Entity
of I-Entity
wanted I-Entity
persons I-Entity
) I-Entity
. O

The O
seeding O
techniques O
and O
bait O
files O
suggest O
a O
good O
understanding O
of O
the O
opposition O
's O
needs O
, O
fears O
and O
behavior O
, O
coupled O
with O
ba- O
sic O
familiarity O
with O
off-the-shelf O
RATs O
. O

In O
some O
cases O
attacks O
occur O
in O
a O
context O
that O
points O
to O
a O
more O
direct O
connection O
to O
one O
of O
the O
belligerents O
: O
the O
Syrian O
opposition O
has O
regularly O
ob- O
served O
that O
detainees O
' O
accounts O
begin O
seeding O
malware O
shortly O
after O
their O
arrest O
by O
government O
forces O
. O

Researchers O
and O
security O
professionals O
have O
already O
profiled O
many O
of O
these O
RATs O
, O
including O
DarkComet O
[ O
, O
] O
, O
Black- O
shades O
Remote O
Controller O
, O
Xtreme O
RAT O
, O
njRAT O
, O
and O
ShadowTech O
. O

Some O
are O
available O
for O
purchase O
by O
any- O
one O
, O
in O
contrast O
to O
'' O
government O
only O
'' O
FinSpy O
and O
RCS O
. O

For O
ex- O
ample O
, O
Xtreme O
RAT O
retails O
for O
e350 O
, O
while O
a O
version O
of O
Black- O
shades O
lists O
for O
e40 O
. O

Others O
, O
like O
DarkComet O
, O
are O
free O
. O

We O
have O
also O
observed O
cracked O
versions O
of O
these O
RATs O
on O
Arabic- O
language O
hacker O
forums O
, O
making O
them O
available O
with O
little O
ef- O
fort O
and O
no O
payment O
trail O
. O

While O
the O
RATs O
are O
cheaper O
and O
less O
sophisticated O
than O
FinSpy O
and O
RCS O
, O
they O
share O
the B-Entity
same I-Entity
ba- I-Entity
sic I-Entity
functionality I-Entity
, O
including B-Action
screen B-Entity
capture I-Entity
, O
keylogging B-Entity
, O
remote B-Entity
monitoring I-Entity
of I-Entity
webcams B-Entity
and O
microphones B-Entity
, O
remote B-Entity
shell I-Entity
, O
and O
file B-Entity
exfiltration I-Entity
. O

In O
the O
most O
common O
attack O
sequence O
we O
observed O
, O
illus- O
trated O
with O
three O
examples O
in O
Figure O
3 O
, O
the B-Entity
attacker I-Entity
seeds B-Action
mal- B-Entity
ware I-Entity
via B-Modifier
private B-Entity
chat I-Entity
messages I-Entity
, I-Entity
posts I-Entity
in I-Entity
opposition-controlled I-Entity
social I-Entity
media I-Entity
groups I-Entity
, I-Entity
or I-Entity
e-mail I-Entity
. O

These B-Entity
techniques I-Entity
often O
limit O
the O
world-visibility O
of O
malicious O
files O
and O
links O
, O
slowing B-Action
their B-Entity
detection I-Entity
by I-Entity
common I-Entity
AV I-Entity
products I-Entity
. O

Typically O
, O
targets B-Entity
receive B-Action
either B-Entity
( I-Entity
1 I-Entity
) I-Entity
a I-Entity
PE I-Entity
in I-Entity
a I-Entity
.zip I-Entity
or I-Entity
.rar I-Entity
, I-Entity
( I-Entity
2 I-Entity
) I-Entity
a I-Entity
file I-Entity
download I-Entity
link I-Entity
, I-Entity
or I-Entity
( I-Entity
3 I-Entity
) I-Entity
a I-Entity
link I-Entity
that I-Entity
will I-Entity
trigger I-Entity
a I-Entity
drive-by I-Entity
download I-Entity
. O

The B-Entity
messages I-Entity
usually O
include B-Action
text B-Entity
, I-Entity
often I-Entity
in I-Entity
Arabic I-Entity
, I-Entity
that I-Entity
attempts I-Entity
to I-Entity
persuade I-Entity
the I-Entity
target I-Entity
to I-Entity
execute I-Entity
the I-Entity
file I-Entity
or I-Entity
click I-Entity
the I-Entity
link I-Entity
. O

The B-Entity
first I-Entity
attacks I-Entity
in O
Figure O
3 O
date O
to O
2012 O
, O
and O
use B-Action
bait B-Entity
files I-Entity
with I-Entity
a I-Entity
DarkComet I-Entity
RAT I-Entity
payload I-Entity
. O

These B-Entity
attacks I-Entity
share B-Action
the B-Entity
same I-Entity
C I-Entity
& I-Entity
C I-Entity
, I-Entity
216.6.0.28 I-Entity
, I-Entity
a I-Entity
Syrian I-Entity
IP I-Entity
address I-Entity
belonging I-Entity
to I-Entity
the I-Entity
Syr- I-Entity
ian I-Entity
Telecommunications I-Entity
Establishment I-Entity
, I-Entity
and I-Entity
publicly I-Entity
reported I-Entity
as I-Entity
a I-Entity
C I-Entity
& I-Entity
C I-Entity
of I-Entity
Syrian I-Entity
malware I-Entity
since I-Entity
February I-Entity
2012 I-Entity
. O

The B-Entity
first I-Entity
bait I-Entity
file I-Entity
presents B-Action
to B-Modifier
the B-Entity
victim I-Entity
as B-Modifier
a B-Entity
PDF I-Entity
containing I-Entity
infor- I-Entity
mation I-Entity
about I-Entity
a I-Entity
planned I-Entity
uprising I-Entity
in I-Entity
Aleppo I-Entity
. O

In O
fact O
the B-Entity
file I-Entity
is O
a O
Windows O
Screensaver O
( O
.scr O

) O
that O
masquerades B-Action
as B-Modifier
a B-Entity
PDF I-Entity
using B-Modifier
Unicode B-Entity
RLO I-Entity
, O
rendering O
a O
name O
such O
as O
'' O
.fdp.scr O

'' O
dis- O
play O
to O
the O
victim O
as O
'' O
.rcs.pdf O

. O

'' O
The B-Entity
second I-Entity
bait I-Entity
file I-Entity
is O
a O
dummy O
program O
containing O
DarkComet O
while O
masquerading B-Action
as B-Modifier
a B-Entity
Skype I-Entity
call I-Entity
encryption I-Entity
program I-Entity
, O
playing O
to O
opposition O
para- O
noia O
about O
government O
backdoors O
in O
common O
software O
. O

The B-Entity
third I-Entity
attack I-Entity
in O
Figure O
3 O
, O
observed O
in O
October O
2013 O
, O
entices B-Action
tar- B-Entity
gets I-Entity
with B-Modifier
e-mails B-Entity
purporting I-Entity
to I-Entity
contain I-Entity
or I-Entity
link I-Entity
to I-Entity
videos I-Entity
about I-Entity
the I-Entity
current I-Entity
conflict I-Entity
, O
infecting B-Action
victims B-Entity
with B-Modifier
Xtreme B-Entity
RAT I-Entity
, O
and O
using B-Action
the B-Entity
C I-Entity
& I-Entity
C I-Entity
tn1.linkpc.net I-Entity
. O

For B-Modifier
seeding B-Entity
, O
the B-Entity
attackers I-Entity
typically O
use B-Action
compromised B-Entity
ac- I-Entity
counts I-Entity
( I-Entity
including I-Entity
those I-Entity
of I-Entity
arrested I-Entity
individuals I-Entity
) I-Entity
or I-Entity
fake I-Entity
iden- I-Entity
tities I-Entity
masquerading I-Entity
as I-Entity
pro-opposition I-Entity
. O

Our O
illustration O
shows O
in O
abstract O
terms O
the O
use O
of O
Victim O
A O
's O
account O
to O
seed O
mal- O
ware O
( O
'' O
Aleppo O
Plan O
'' O
) O
via O
( O
say O
) O
Skype O
messages O
to O
Victim O
( O
s O
) O
Bn O
. O

In O
the O
cases O
of O
Opp O
. O

Member O
C O
and O
NGO O
Worker O
D O
( O
here O
, O
actual O
victims O
, O
not O
abstract O
) O
, O
targeting B-Action
was O
by B-Modifier
e-mail B-Entity
from I-Entity
domains I-Entity
apparently I-Entity
belonging I-Entity
to I-Entity
opposition I-Entity
groups I-Entity
, I-Entity
in- I-Entity
dicating I-Entity
a I-Entity
potential I-Entity
compromise I-Entity
. O

One O
domain O
remains O
active O
, O
hosting O
a O
website O
of O
the O
Salafist O
Al-Nusra O
front O
, O
while O
the O
other O
appears O
dormant O
. O

Opp B-Entity
. I-Entity
Member I-Entity
C I-Entity
received B-Action
a B-Entity
malicious I-Entity
file I-Entity
as B-Modifier
an B-Entity
e-mail I-Entity
attachment I-Entity
, O
while O
NGO B-Entity
Worker I-Entity
D I-Entity
was B-Action
sent I-Action
a B-Entity
shortened I-Entity
link I-Entity
( I-Entity
url I-Entity
[ I-Entity
. I-Entity
] I-Entity
no/Uu5 I-Entity
) I-Entity
to I-Entity
a I-Entity
download I-Entity
from I-Entity
a I-Entity
directory I-Entity
of I-Entity
Mrconstrucciones I-Entity
[ I-Entity
. I-Entity
] I-Entity
net I-Entity
, O
a O
site O
that O
may O
have O
been O
com- O
promised O
. O

Both B-Entity
attacks I-Entity
resulted B-Action
in B-Modifier
an B-Entity
Xtreme I-Entity
RAT I-Entity
infection I-Entity
. O

Interestingly O
, O
in O
the O
case O
of O
the O
fake O
Skype O
encryption O
the O
deception O
extended O
to O
a O
YouTube O
video O
from O
'' O
IT O
Se- O
curity O
Lab O
'' O
demonstrating O
the O
program O
's O
purported O
ca- O
pabilities O
, O
as O
well O
as O
a O
website O
promoting O
the O
tool O
, O
skype- O
encryption.sytes.net O
. O

The O
attackers O
also O
constructed O
a O
ba- O
sic O
, O
faux O
GUI O
for O
their O
'' O
Encryption O
'' O
program O
( O
see O
Figure O
4 O
) O
. O

The O
fake O
GUI O
has O
a O
number O
of O
non-functional O
buttons O
like O
'' O
En- O
crypt O
'' O
and O
'' O
DeCrypt O
, O
'' O
which O
generate O
fake O
prompts O
. O

While B-Modifier
dis- B-Entity
tracted I-Entity
by I-Entity
this I-Entity
meaningless I-Entity
interaction I-Entity
, O
the B-Entity
victim I-Entity
's I-Entity
machine I-Entity
is B-Action
infected I-Action
with B-Modifier
DarkComet B-Entity
3.3 I-Entity
[ O
, O
] O
. O

Anecdotally O
, O
campaign O
volume O
appears O
to O
track O
significant O
events O
in O
the O
ongoing O
conflict O
. O

For O
example O
, O
campaigns O
dwin- O
dled O
and O
then O
rebounded O
within O
hours O
after O
Syria O
's O
2012 O
Inter- O
net O
shutdown O
. O

Similarly O
, O
activity O
observed O
by O
the O
authors O
also O
dwindled O
prior O
to O
expectation O
of O
US-led O
military O
action O
against O
Syrian O
government O
targets O
in O
September O
2013 O
. O

Once O
this O
option O
appeared O
to O
be O
off O
the O
table O
, O
the O
volume O
of O
new O
samples O
and O
campaigns O
we O
observed O
again O
increased O
, O
includ- O
ing O
the O
recent O
targeting O
of O
NGO O
workers O
per O
Figure O
3 O
. O

We O
are O
aware O
of O
only O
a O
negligible O
number O
of O
cases O
of O
the O
opposition O
using O
similar O
RATs O
against O
Syrian O
Government O
supporters O
, O
al- O
though O
evidence O
exists O
of O
other O
kinds O
of O
electronic O
attacks O
by O
third O
parties O
. O

The O
logistics O
and O
activities O
of O
Syria O
's O
numerous O
opposition O
groups O
are O
intentionally O
concealed O
from O
public O
view O
to O
protect O
both O
their O
efficacy O
, O
and O
the O
lives O
of O
people O
participating O
in O
them O
. O

Nevertheless O
, O
Syrian O
opposition O
members O
are O
generally O
familiar O
with O
stories O
off O
digital O
compro- O
mises O
of O
high-profile O
figures O
, O
including O
those O
entrusted O
with O
the O
most O
sensitive O
roles O
, O
as O
well O
as O
rank-and-file O
members O
. O

Com- O
promise O
of O
operational O
security O
poses O
a O
documented O
threat O
to O
life O
both O
for O
victims O
of O
electronic O
compromise O
, O
and O
to O
family O
members O
and O
associates O
. O

The O
Syrian O
conflict O
is O
ongoing O
, O
making O
it O
difficult O
to O
assem- O
ble O
comprehensive O
evidence O
of O
linkages O
between O
government O
actors O
and O
malware O
campaigns O
. O

Moreover O
, O
many O
individuals O
whose O
identities O
have O
been O
compromised O
are O
in O
prison O
or O
oth- O
erwise O
disappeared O
, O
and O
thus O
unable O
to O
relate O
the O
evidence O
pre- O
sented O
to O
them O
during O
interrogation O
. O

Still O
, O
strong O
circumstantial O
evidence O
links O
the O
use O
of O
RATs O
, O
phishing O
, O
and O
government O
ac- O
tivity O
, O
which O
we O
briefly O
summarize O
here O
: O
( O
1 O
) O
many O
Syrians O
have O
recounted O
to O
journalists O
and O
the O
authors O
how O
interrogators O
con- O
fronted O
them O
with O
material O
from O
their O
computers O
. O

For O
example O
: O
The O
policeman O
told O
me O
, O
'' O
Do O
you O
remember O
when O
you O
were O
talking O
to O
your O
friend O
and O
you O
told O
him O
you O
had O
something O
wrong O
[ O
sic O
] O
and O
paid O
a O
lot O
of O
money O
? O
At O
that O
time O
we O
were O
taking O
information O
from O
your O
laptop O
. O

'' O
( O
2 O
) O
Syrian O
activists O
have O
supplied O
cases O
to O
international O
journal- O
ists O
, O
where O
arrests O
are O
quickly O
followed O
by O
the O
social O
me- O
dia O
accounts O
of O
detained O
individuals O
seeding O
malware O
to O
contact O
lists O
( O
Figure O
3 O
) O
. O

( O
3 O
) O
Finally O
, O
despite O
the O
notoriety O
of O
the O
attack O
campaigns O
, O
including O
mention O
of O
C O
& O
C O
IPs O
in O
international O
me- O
dia O
, O
the O
Syrian O
government O
has O
made O
no O
public O
statements O
about O
these O
campaigns O
nor O
acted O
to O
shut O
down O
the O
servers O
. O

Beyond O
the O
ongoing O
challenges O
of O
attribution O
, O
these O
malware O
campaigns O
have O
a O
tangible O
impact O
on O
the O
Syrian O
opposition O
, O
and O
generally O
align O
with O
the O
interests O
of O
the O
Syrian O
government's O
propaganda O
operations O
. O

The O
case O
of O
Abdul O
Razzaq O
Tlass O
, O
a O
leader O
in O
the O
Free O
Syrian O
Army O
, O
is O
illustrative O
of O
the O
potential O
uses O
of O
such O
campaigns O
. O

In O
2012 O
a O
string O
of O
videos O
emerged O
showing O
Tlass O
sexting O
and O
engaged O
in O
lewd O
activity O
in O
front O
of O
a O
webcam O
. O

While O
he O
denied O
the O
videos O
, O
the O
harm O
to O
his O
rep- O
utation O
was O
substantial O
and O
he O
was O
eventually O
replaced O
. O

While O
the O
UAE O
has O
experienced O
no O
recent O
uprising O
or O
politi- O
cal O
unrest O
, O
it O
has O
nevertheless O
cracked O
down O
on O
its O
opposition O
, O
concurrent O
with O
the O
Arab O
Spring O
. O

The B-Entity
first I-Entity
attacks I-Entity
we O
observed O
in O
the O
UAE O
involved B-Action
a B-Entity
government-grade I-Entity
'' I-Entity
lawful I-Entity
interception I-Entity
'' I-Entity
trojan I-Entity
known I-Entity
as I-Entity
Re- I-Entity
mote I-Entity
Control I-Entity
System I-Entity
( I-Entity
RCS I-Entity
) I-Entity
, I-Entity
sold I-Entity
by I-Entity
the I-Entity
Italian I-Entity
company I-Entity
Hack- I-Entity
ing I-Entity
Team I-Entity
. O

The O
associated O
C O
& O
C O
server O
indicated O
direct O
UAE O
government O
involvement O
. O

Over O
time O
, O
we O
stopped O
receiving O
RCS O
samples O
from O
UAE O
targets O
, O
and O
instead O
observed O
a O
shift O
to O
the O
use O
of O
off-the-shelf O
RATs O
, O
and O
possible O
involvement O
of O
cyber-mercenary O
groups O
. O

However O
, O
poor O
attacker O
operational O
security O
.allowed O

us O
to O
link O
most O
observed O
attacks O
together O
. O

UAE O
activist O
Ahmed O
Mansoor O
( O
per O
Figure O
5 O
) O
, O
impris- O
oned O
from O
April O
to O
November O
2011 O
after O
signing O
an O
online O
pro- O
democracy O
petition O
, O
received O
an O
e-mail O
purportedly O
from O
'' O
Arabic O
Wikileaks O
'' O
in O
July O
2012 O
. O

He O
opened O
the O
associated O
at- O
tachment O
, O
'' O
veryimportant.doc O
, O
'' O
and O
saw O
what O
he O
described O
as O
'' O
scrambled O
letters O
'' O
. O

He O
forwarded O
us O
the O
e-mail O
for O
investiga- O
tion O
. O

The O
attachment O
exploited O
CVE-2010-3333 O
, O
an O
RTF O
pars- O
ing O
vulnerability O
in O
Microsoft O
Office O
. O

The O
document O
did O
not O
contain O
any O
bait O
content O
, O
and O
part O
of O
the O
malformed O
RTF O
that O
triggered O
the O
exploit O
was O
displayed O
in O
the O
document O
. O

The B-Entity
exploit I-Entity
loaded B-Action
shellcode B-Entity
that O
downloaded B-Action
a B-Entity
second I-Entity
stage I-Entity
from B-Modifier
ar-24.com B-Entity
, O
which O
in O
turn O
downloaded B-Action
spyware B-Entity
from B-Modifier
ar-24.com B-Entity
. O

We O
denote O
this O
combination O
as O
the O
3-Stage O
Ex- O
ploit O
Kit O
in O
Figure O
5 O
. O

The B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
also O
ran B-Action
on B-Modifier
ar-24.com B-Entity
. O

When O
we O
ob- O
tained O
the O
sample O
in O
July O
2012 O
, O
ar-24.com O
resolved O
to O
an O
IP O
address O
on O
Linode O
, O
a O
hosting O
provider O
. O

Three O
months O
later O
, O
it O
resolved O
to O
a O
UAE O
address O
belonging O
to O
the O
Royal O
Group O
, O
an O
organization O
linked O
to O
the O
UAE O
government O
; O
it O
is O
chaired O
by O
Sheikh O
Tahnoon O
bin O
Zayed O
Al-Nayhan O
, O
a O
member O
of O
the O
UAE O
ruling O
family O
and O
a O
son O
of O
the O
founder O
of O
the O
UAE O
. O

Identification O
as O
RCS O
: O
We O
identified O
strings O
in O
memory O
that O
matched O
those O
in O
a O
Symantec O
analysis O
of O
RCS O
( O
also O
known O
as O
DaVinci O
or O
Crisis O
) O
, O
a O
product O
of O
the O
Italian O
com- O
pany O
Hacking O
Team O
. O

We O
also O
located O
a O
structurally O
sim- O
ilar O
Word O
document O
via O
VirusTotal O
. O

The B-Entity
document I-Entity
used O
the O
same O
exploit O
and O
attempted O
to O
download B-Action
a B-Entity
second I-Entity
stage I-Entity
from B-Modifier
rcs-demo.hackingteam.it B-Entity
, O
which O
was O
unavailable O
at O
the O
time O
of O
testing O
. O

Analysis O
of O
capabilities O
: O
RCS O
has O
a O
suite O
of O
functionality O
largely O
similar O
to O
FinSpy O
. O

One O
difference O
was O
in O
the B-Entity
vectors I-Entity
used O
to O
install B-Action
the B-Entity
spyware I-Entity
. O

We O
located O
additional O
samples O
( O
see O
§ O
5 O
) O
, O
some O
of O
which O
were O
embedded O
in O
a B-Entity
.jar I-Entity
file I-Entity
that O
installs B-Action
an B-Entity
OS-appropriate I-Entity
version I-Entity
of I-Entity
RCS I-Entity
( O
Windows O
or O
OSX O
) O
, O
option- O
ally O
using O
an O
exploit O
. O

If O
embedded O
as O
an O
applet O
, O
and O
no O
exploit O
is O
present O
, O
Java O
displays O
a O
security O
warning O
and O
asks O
the O
user O
whether O
they O
authorize O
the O
installation O
. O

We O
also O
saw O
instances O
of O
the O
3-Stage O
Exploit O
Kit O
where O
the O
first O
stage O
contained O
a O
Flash O
exploit O
; O
in O
some O
cases O
, O
we O
could O
obtain O
all O
stages O
and O
confirm O
that O
these B-Entity
installed B-Action
RCS B-Entity
. O

Some O
samples O
were O
packed O
with O
the O
MPress O
packer O
, O
and O
some B-Entity
Windows I-Entity
samples I-Entity
were B-Action
obfuscated I-Action
to B-Modifier
look B-Entity
like I-Entity
the I-Entity
PuTTY I-Entity
SSH I-Entity
client I-Entity
. O

Another O
difference O
is O
in O
persistence O
. O

For O
example O
, O
the B-Entity
RCS I-Entity
sample I-Entity
sent I-Entity
to I-Entity
Ahmed I-Entity
adds B-Action
a B-Entity
Run I-Entity
registry I-Entity
key I-Entity
, O
whereas O
the B-Entity
FinSpy I-Entity
samples I-Entity
used I-Entity
in I-Entity
Bahrain I-Entity
overwrite B-Action
the B-Entity
hard I-Entity
disk I-Entity
's I-Entity
boot I-Entity
sector I-Entity
to O
modify B-Action
the B-Entity
boot I-Entity
process I-Entity
; O
the B-Entity
spyware I-Entity
is B-Action
loaded I-Action
be- B-Modifier
fore I-Modifier
the B-Entity
OS I-Entity
, O
and O
injects B-Action
itself B-Entity
into B-Modifier
OS B-Entity
processes I-Entity
as B-Modifier
they B-Entity
start I-Entity
. O

The B-Entity
RCS I-Entity
samples I-Entity
we I-Entity
examined I-Entity
also O
had O
the O
ability O
to O
propa- B-Action
gate I-Action
to B-Modifier
other B-Entity
devices I-Entity
, O
including O
into B-Modifier
inactive B-Entity
VMWare I-Entity
virtual I-Entity
machines I-Entity
by B-Modifier
modifying B-Entity
the I-Entity
disk I-Entity
image I-Entity
, O
onto B-Modifier
USB B-Entity
flash I-Entity
drives I-Entity
, O
and O
onto B-Modifier
Windows B-Entity
Mobile I-Entity
phones I-Entity
. O

We O
did O
not O
observe O
similar O
capabilities O
in O
the O
FinSpy O
samples O
we O
examined O
. O

Exploitation O
of O
captured O
data O
: O
When O
Ahmed O
Mansoor O
re- O
ceived O
the O
RCS O
document O
, O
he O
opened O
it O
, O
infecting O
his O
computer O
( O
Figure O
5 O
) O
. O

Ahmed O
subsequently O
noted O
several O
suspicious O
ac- B-Action
cesses I-Action
to B-Modifier
his B-Entity
GMail I-Entity
account I-Entity
using B-Modifier
IMAP B-Entity
. O

Even B-Modifier
after I-Modifier
he B-Entity
changed I-Entity
his I-Entity
password I-Entity
, O
the B-Entity
accesses I-Entity
continued B-Action
. O

While O
corresponding O
with O
Ahmed O
on O
his O
compromised O
account O
, O
an O
author O
of O
this O
pa- O
per O
discovered O
that O
the O
attackers O
had O
installed O
an O
application- O
specific O
password O
in O
Ahmed O
's O
GMail O
account O
, O
a B-Entity
secondary I-Entity
password I-Entity
that O
they B-Entity
apparently O
used B-Action
to B-Modifier
access B-Entity
his I-Entity
account I-Entity
even B-Modifier
after I-Modifier
he B-Entity
changed I-Entity
his I-Entity
main I-Entity
password I-Entity
. O

The O
suspicious O
accesses O
stopped O
after O
removal O
of O
the O
application-specific O
password O
. O

Two O
weeks O
after O
this O
correspondence O
with O
Ahmed O
, O
one B-Entity
of I-Entity
us I-Entity
( O
Author O
in O
Figure O
5 O
) O
received B-Action
a B-Entity
targeted I-Entity
e-mail I-Entity
with I-Entity
a I-Entity
link I-Entity
to I-Entity
a I-Entity
file I-Entity
hosted I-Entity
on I-Entity
Google I-Entity
Docs I-Entity
containing I-Entity
a I-Entity
commercial I-Entity
off-the- I-Entity
shelf I-Entity
RAT I-Entity
, I-Entity
Xtreme I-Entity
RAT I-Entity
. O

The O
e-mail O
was O
sent O
from O
the O
UAE's O
timezone O
( O
as O
well O
as O
of O
other O
countries O
) O
and O
contained O
the O
terms O
'' O
veryimportant O
'' O
and O
'' O
wikileaks O
'' O
, O
just O
like O
in O
the O
e-mail O
re- O
ceived O
by O
Ahmed O
. O

The B-Entity
instance I-Entity
of I-Entity
Xtreme I-Entity
RAT I-Entity
sent I-Entity
to I-Entity
Author I-Entity
used B-Action
owner.no-ip.biz B-Entity
for B-Modifier
its B-Entity
C I-Entity
& I-Entity
C I-Entity
, O
one O
of O
the O
domains O
men- O
tioned O
in O
a O
report O
published O
by O
Norman O
about O
a O
year-long O
cam- O
paign O
of O
cyberattacks O
on O
Israeli O
and O
Palestinian O
targets O
carried O
out O
by O
a O
group O
that O
Norman O
was O
unable O
to O
identify O
. O

Three O
months O
after O
Author O
was O
targeted O
, O
Ahmed B-Entity
received B-Action
an B-Entity
e-mail I-Entity
containing I-Entity
an I-Entity
attachment I-Entity
with B-Modifier
Xtreme B-Entity
RAT I-Entity
that O
talked B-Action
to B-Modifier
the B-Entity
same I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
( O
Figure O
5 O
) O
, O
suggesting O
that O
the O
attackers O
who O
infected O
Ahmed O
with O
RCS O
may O
have O
provided O
a O
list O
of O
interest- O
ing O
e-mail O
addresses O
to O
another O
group O
for O
further O
targeting O
. O

Possible O
consequences O
: O
Shortly O
after O
he O
was O
targeted O
, O
Ahmed O
says O
he O
was O
physically O
assaulted O
twice O
by O
an O
attacker O
who O
appeared O
able O
to O
track O
Ahmed O
's O
location O
. O

He O
also O
re- O
ports O
that O
his O
car O
was O
stolen O
, O
a O
large O
sum O
of O
money O
disappeared O
from O
his O
bank O
account O
, O
and O
his O
passport O
was O
confiscated O
. O

He O
believes O
these O
consequences O
are O
part O
of O
a O
government O
in- O
timidation O
campaign O
against O
him O
, O
but O
we O
did O
not O
uncover O
any O
direct O
links O
to O
his O
infection O
. O

( O
Interestingly O
, O
spyware B-Entity
subse- I-Entity
quently I-Entity
sent I-Entity
to I-Entity
others I-Entity
has O
used B-Action
bait B-Entity
content I-Entity
about I-Entity
Ahmed I-Entity
. O

) O
Further O
attacks O
: O
In O
October O
2012 O
, O
UAE O
Journalist O
A O
and O
Human O
Rights O
activist O
B O
( O
per O
Figure O
6 O
) O
forwarded O
us O
suspi- B-Entity
cious I-Entity
e-mails I-Entity
they B-Entity
had O
received B-Action
that B-Entity
contained I-Entity
a I-Entity
Word I-Entity
docu- I-Entity
ment I-Entity
corresponding I-Entity
to I-Entity
the I-Entity
first I-Entity
stage I-Entity
of I-Entity
3-Stage I-Entity
Exploit I-Entity
Kit I-Entity
( O
Figure O
5 O
) O
. O

The O
attachment O
contained O
an B-Entity
embedded I-Entity
Flash I-Entity
file I-Entity
that I-Entity
exploited I-Entity
a I-Entity
vulnerability I-Entity
fixed I-Entity
in I-Entity
Adobe I-Entity
Flash I-Entity
11.4 I-Entity
, O
loading B-Action
shell B-Entity
code I-Entity
to O
download B-Action
a B-Entity
second I-Entity
stage I-Entity
from B-Modifier
faddeha.com B-Entity
. O

We O
were O
unable O
to O
obtain O
the O
second O
stage O
or O
the O
ultimate O
pay- O
load O
, O
as O
the O
website O
was O
unavailable O
at O
the O
time O
of O
testing O
. O

However O
, O
the O
exploit O
kit O
appears O
indicative O
of O
Hacking O
Team O
involvement O
. O

A O
page O
on O
faddeha.com O
found O
in O
Google's O
cache O
contained O
an O
embedded O
.jar O

with O
the O
same O
applet O
class O
( O
WebEnhancer O
) O
as O
those O
observed O
in O
other O
.jar O

files O
that O
we O
found O
to O
contain O
RCS O
. O

We O
found O
a O
file O
that O
VirusTotal O
had O
downloaded O
from O
faddeha.com O
, O
which O
appeared O
to O
be O
a O
re- O
mote O
access O
toolkit O
known O
as O
SpyNet O
, O
available O
for O
general O
pur- O
chase O
for O
50 O
Euros O
. O

The B-Entity
SpyNet I-Entity
sample I-Entity
communicated B-Action
with B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
hamas.sytes.net I-Entity
. O

SpyNet O
Packing O
: O
We O
found O
another O
instance O
of O
the O
first O
stage O
of O
the O
3-Stage O
Exploit O
Kit O
on O
VirusTotal O
. O

The B-Entity
exploit I-Entity
downloaded B-Action
a B-Entity
second I-Entity
stage I-Entity
, O
which O
in O
turn O
downloaded B-Action
a B-Entity
sam- I-Entity
ple I-Entity
of I-Entity
SpyNet I-Entity
from B-Modifier
maile-s.com B-Entity
. O

This B-Entity
sample I-Entity
of I-Entity
SpyNet I-Entity
communicated B-Action
with B-Modifier
the B-Entity
same I-Entity
C I-Entity
& I-Entity
C I-Entity
hamas.sytes.net I-Entity
. O

The O
sample O
was O
packed O
using O
ASProtect O
. O

When O
run O
, O
the O
sample O
unpacks O
a B-Entity
compiled I-Entity
Visual I-Entity
Basic I-Entity
project I-Entity
that O
loads B-Action
, O
via B-Modifier
the B-Entity
RunPE I-Entity
method I-Entity
, O
an B-Entity
executable I-Entity
packed I-Entity
with I-Entity
UPX I-Entity
. O

Finally O
, O
this O
executable O
unpacks O
SpyNet O
. O

SpyNet O
's O
GUI O
only O
offers O
an O
option O
to O
pack O
with O
UPX O
, O
suggesting O
that O
the O
attack- O
ers O
specially O
added O
the O
other O
layers O
of O
packing O
. O

In O
some O
cases O
, O
the O
Visual O
Basic O
project O
bears O
the O
name O
NoWayTech O
, O
which O
appears O
to O
be O
an O
underground O
RunPE O
tool O
, O
while O
others O
are O
named O
SpyVisual O
, O
which O
we O
have O
been O
unable O
to O
trace O
to O
any O
public O
underground O
tools O
, O
and O
thus O
also O
may O
reflect O
customiza- O
tion O
by O
the O
attacker O
. O

The O
SpyVisual O
projects O
contain O
the O
string O
c O
: O
\Users\Zain\AppData\Local\Temp\OLE1EmbedStrm.wav O
, O
which O
we O
used O
as O
the O
fingerprint O
VB O
Packer O
in O
Figure O
6 O
. O

Cedar O
Key O
attack O
: O
The O
same O
VB O
Packer O
was O
used O
in O
an O
attack O
on O
Relative O
of O
political O
detainee O
D O
and O
H.R O
. O

activist O
E O
in O
Figure O
6 O
. O

These B-Entity
individuals I-Entity
received B-Action
e-mails B-Entity
containing I-Entity
a I-Entity
link I-Entity
to I-Entity
a I-Entity
web I-Entity
page I-Entity
hosted I-Entity
on I-Entity
cedarkeyrv.com I-Entity
impersonat- I-Entity
ing I-Entity
YouTube I-Entity
. O

Loading O
the O
page O
greeted O
the O
target O
with O
'' O
Video O
loading O
please O
wait O
. O

. O

. O

'' O
The B-Entity
page I-Entity
redirected O
to O
a O
YouTube O
video O
a O
few O
seconds O
later O
, O
but O
first O
loaded B-Action
a B-Entity
Java I-Entity
exploit I-Entity
-a O
known O
vulnerability O
with O
no O
patch O
at O
the O
time O
that O
the O
e-mails O
were O
sent O
. O

Oracle O
released O
a O
patch O
12 O
hours O
after O
activists O
began O
receiving O
these O
links O
. O

The O
cedarkeyrv.com O
domain O
is O
associated O
with O
an O
RV O
park O
in O
Cedar O
Key O
, O
Florida O
. O

The O
website O
's O
hosting O
company O
told O
us O
that O
the O
site O
had O
apparently O
suffered O
a O
compromise O
, O
but O
did O
not O
have O
further O
details O
. O

The O
exploit O
used O
in O
the O
attack O
appears O
to O
have O
been O
origi- O
nally O
posted O
by O
a O
Kuwaiti O
user O
, O
njq8 O
, O
on O
an O
Arabic-language O
exploit O
sharing O
site O
. O

We O
contacted O
njq8 O
, O
who O
told O
us O
that O
he O
had O
obtained O
the O
exploit O
elsewhere O
and O
modified O
it O
prior O
to O
posting O
. O

The B-Entity
attack I-Entity
downloaded B-Action
an B-Entity
instance I-Entity
of I-Entity
SpyNet I-Entity
from B-Modifier
isteeler.com B-Entity
( O
which O
from O
our O
inspection O
did O
not O
appear O
to O
have O
any O
legitimate O
content O
) O
, O
which O
used B-Action
the B-Entity
C I-Entity
& I-Entity
C I-Entity
storge.myftp.org I-Entity
. O

This O
same O
C O
& O
C O
occurred O
in O
an- O
other O
attack O
( O
Figure O
6 O
) O
targeting O
Relative O
of O
political O
detainee O
D O
; O
in O
that O
case O
, O
the O
payload O
was O
a O
freely-available O
RAT O
known O
as O
njRAT O
, O
written O
by O
the O
same O
njq8 O
as O
the O
exploit-poster O
dis- O
cussed O
above O
. O

However O
, O
we O
did O
not O
find O
any O
other O
evidence O
suggesting O
njq8 O
's O
involvement O
in O
either O
attack O
. O

More O
SpyNet O
attacks O
: O
The O
domain O
hamas.sytes.net O
, O
which O
we O
previously O
saw O
used O
by O
two O
SpyNet O
sam- O
ples O
, O
resolved O
to O
67.205.79.177 O
. O

Historically O
, O
dreems.no-ip.ca O
also O
resolved O
to O
this O
address O
. O

An B-Entity
unidentified I-Entity
dropper I-Entity
using B-Action
this B-Entity
C I-Entity
& I-Entity
C I-Entity
targeted O
Journalist O
F O
; O
a B-Entity
SpyNet I-Entity
attack I-Entity
on I-Entity
Relative I-Entity
of I-Entity
political I-Entity
detainee I-Entity
D I-Entity
also O
used B-Action
this B-Entity
C I-Entity
& I-Entity
C I-Entity
. O

In O
that O
latter O
case O
, O
the B-Entity
sample I-Entity
arrived B-Action
via B-Modifier
e-mail B-Entity
in B-Modifier
a B-Entity
.rar I-Entity
attachment I-Entity
that O
contained O
an B-Entity
.scr I-Entity
file I-Entity
disguised B-Action
as B-Modifier
a B-Entity
Word I-Entity
document I-Entity
. O

The B-Entity
.scr I-Entity
file I-Entity
was O
a O
self-extracting O
archive O
that O
decompressed O
and O
ran B-Action
both B-Entity
the I-Entity
bait I-Entity
document I-Entity
and I-Entity
the I-Entity
payload I-Entity
. O

The O
SMTP O
source O
of O
the O
e-mail O
was O
webmail.upload.bz O
. O

Appin O
: O
In O
early O
2013 O
UAE O
H.R O
. O

activist O
E O
forwarded O
nu- O
merous O
documents O
that O
included O
a O
particular O
CVE-2012-0158 O
exploit O
for O
Microsoft O
Word O
. O

In O
all O
, O
these O
totaled O
17 O
distinct O
hashes O
of O
documents O
, O
and O
10 O
distinct O
hashes O
of O
payloads O
( O
some B-Entity
documents I-Entity
that I-Entity
differed I-Entity
in I-Entity
their I-Entity
hash I-Entity
downloaded B-Action
the B-Entity
same I-Entity
pay- I-Entity
load I-Entity
) O
. O

The B-Entity
exploits I-Entity
primarily O
downloaded B-Action
instances B-Entity
of I-Entity
SpyNet I-Entity
from B-Modifier
upload.bz B-Entity
, O
which O
for O
the O
most O
part O
communicated B-Action
with B-Modifier
C B-Entity
& I-Entity
C I-Entity
at I-Entity
sn.all-google.com I-Entity
. O

This B-Entity
domain I-Entity
was B-Action
also I-Action
used I-Action
for B-Modifier
C B-Entity
& I-Entity
C I-Entity
in I-Entity
other I-Entity
attacks I-Entity
, O
including O
that O
on O
Journalist O
C. O
Two B-Entity
of I-Entity
the I-Entity
other I-Entity
CVE-2012-0158 I-Entity
exploits I-Entity
down- B-Action
loaded I-Action
DarkComet B-Entity
from B-Modifier
www.getmedia.us B-Entity
and I-Entity
www.technopenta.com I-Entity
after O
posting B-Action
system B-Entity
infor- I-Entity
mation I-Entity
to B-Modifier
random123.site11.com B-Entity
. O

All O
three O
domains O
match O
those O
used O
by O
an O
Indian O
cybermercenary O
group O
said O
to O
be O
linked O
to O
Appin O
Security O
Group O
. O

The O
former O
two O
domains O
hosted O
content O
other O
than O
spyware O
( O
i.e. O
, O
they O
may O
have O
been O
compromised O
) O
. O

We O
alerted O
the O
owner O
of O
www.getmedia.us O
, O
who O
removed O
the O
payloads O
. O

The O
samples O
we O
received O
afforded O
us O
an O
opportunity O
to O
em- O
pirically O
characterize O
the O
use O
of O
FinFisher O
and O
Hacking O
Team O
around O
the O
world O
, O
enabling O
us O
to O
assess O
their O
prevalence O
, O
and O
identify O
other O
country O
cases O
that O
may O
warrant O
future O
investiga- O
tion O
. O

We O
analyzed O
the O
samples O
and O
the O
behavior O
of O
their O
C O
& O
C O
servers O
to O
develop O
indicators O
( O
fingerprints O
) O
for O
how O
the O
servers O
respond O
to O
certain O
types O
of O
requests O
. O

We O
then O
scanned O
the O
full O
Internet O
IPv4 O
address O
space O
( O
'' O
/0 O
'' O
) O
for O
these O
, O
along O
with O
prob- O
ing O
results O
found O
by O
past O
scans O
. O

In O
many O
cases O
we O
do O
not O
release O
the O
full O
details O
of O
our O
fingerprints O
to O
avoid O
compromising O
what O
may O
be O
legitimate O
investigations O
. O

Identifying O
and O
linking O
servers O
: O
We O
developed O
a O
number O
of O
fingerprints O
for O
identifying O
FinSpy O
servers O
using O
HTTP- O
based O
probing O
as O
well O
as O
FinSpy O
's O
custom O
TLV-based O
proto- O
col. O
We O
leveraged O
quirks O
such O
as O
specific O
non-compliance O
with O
RFC O
2616 O
, O
responses O
to O
certain O
types O
of O
invalid O
data O
, O
and O
the O
presence O
of O
signatures O
such O
as O
the O
bizarre O
'' O
Hallo O
Steffi O
'' O
that O
Guarnieri O
identified O
from O
Bahraini O
FinSpy O
C O
& O
C O
servers O
[ O
, O
] O
. O

See O
Appendix O
A O
for O
details O
. O

We O
then O
exhaus- O
tively O
scanned O
the O
Internet O
looking O
for O
matches O
to O
these O
finger- O
prints O
. O

Gamma O
documentation O
advertises O
that O
an B-Entity
operator I-Entity
of I-Entity
FinSpy I-Entity
can O
obscure B-Action
the B-Entity
location I-Entity
of I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
( I-Entity
called I-Entity
the I-Entity
mas- I-Entity
ter I-Entity
) I-Entity
by B-Modifier
setting B-Entity
up I-Entity
a I-Entity
proxy I-Entity
known I-Entity
as I-Entity
a I-Entity
relay I-Entity
. O

In O
Spring O
2013 O
we O
noticed O
FinSpy O
servers O
now O
issuing O
302 O
Redirects O
to O
google.com O
. O

However O
, O
we O
noticed O
anomalies O
: O
for O
ex- O
ample O
, O
servers O
in O
India O
were O
redirecting O
to O
the O
Latvian O
ver- O
sion O
of O
Google O
google.lv O
. O

We O
suspect O
that O
the O
server O
in O
India O
was O
a O
relay O
forwarding O
to O
a O
master O
in O
Latvia O
. O

Be- O
cause O
the O
master O
served O
as O
a O
proxy O
for O
Google O
, O
we O
could O
uncover O
its O
IP O
address O
using O
a O
Google O
feature O
that O
prints O
a O
user O
's O
IP O
address O
for O
the O
query O
'' O
IP O
address O
. O

'' O
We O
created O
an O
additional O
fingerprint O
based O
on O
the O
proxying O
behavior O
and O
is- O
sued O
GET O
/search O
? O
q=ip+address O
& O
nord=1 O
requests O
to O
servers O
We O
note O
some O
interesting O
master O
locations O
in O
Table O
4 O
. O

Server O
locations O
: O
In O
all O
, O
our O
fingerprints O
matched O
92 O
dis- O
tinct O
IP O
addresses O
in O
35 O
different O
countries O
. O

Probing O
these O
on O
8/8/13 O
revealed O
22 O
distinct O
addresses O
still O
responding O
, O
sited O
in O
: O
Bahrain O
, O
Bangladesh O
, O
Bosnia O
and O
Herzegovina O
, O
Estonia O
, O
Ethiopia O
, O
Germany O
, O
Hong O
Kong O
, O
Indonesia O
, O
Macedonia O
, O
Mex- O
ico O
, O
Romania O
, O
Serbia O
, O
Turkmenistan O
, O
and O
the O
United O
States O
. O

We O
found O
servers O
responding O
to O
a O
number O
of O
our O
fingerprints O
, O
sug- O
gesting O
either O
that O
some O
servers O
lag O
in O
their O
updates O
, O
or O
a O
con- O
certed O
effort O
to O
vary O
the O
behavior O
of O
FinSpy O
servers O
to O
make O
detection O
harder O
. O

We O
found O
: O
( O
1 O
) O
3 O
IP O
addresses O
in O
ranges O
registered O
to O
Gamma O
. O

( O
2 O
) O
Servers O
in O
3 O
IP O
ranges O
explicitly O
registered O
to O
govern- O
ment O
agencies O
: O
Turkmenistan O
's O
Ministry O
of O
Communications O
, O
Qatar O
's O
State O
Security O
Bureau O
, O
and O
the O
Bulgarian O
Council O
of O
Ministers O
. O

( O
3 O
) O
3 O
additional O
IP O
addresses O
in O
Bahrain O
, O
all O
in O
Batelco O
. O

( O
4 O
) O
Servers O
in O
7 O
countries O
with O
governments O
classified O
as O
'' O
authoritarian O
regimes O
'' O
by O
The O
Economist O
: O
Bahrain O
, O
Ethiopia O
, O
Nigeria O
, O
Qatar O
, O
Turkmenistan O
, O
UAE O
, O
Vietnam O
. O

Additional O
FinSpy O
samples O
: O
In O
parallel O
to O
our O
scanning O
, O
we O
obtained O
9 O
samples O
of O
FinSpy O
by O
writing O
YARA O
rules O
for O
the O
'' O
malware O
hunting O
'' O
feature O
of O
VirusTotal O
Intelligence O
. O

This O
feature O
sends O
us O
all O
newly-submitted O
samples O
that O
match O
our O
signatures O
. O

We O
located O
a B-Entity
version I-Entity
of I-Entity
FinSpy I-Entity
that O
does O
not O
use O
the O
normal O
FinSpy O
handshake O
, O
but O
instead O
uses B-Action
a B-Entity
protocol I-Entity
based I-Entity
on I-Entity
HTTP I-Entity
POST I-Entity
requests I-Entity
for B-Modifier
communication B-Entity
with I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

This O
did O
not O
appear O
to O
be O
an O
older O
or O
newer O
ver- O
sion O
of O
the O
protocol O
, O
suggesting O
that O
our O
scan O
results O
may O
not O
reveal O
the O
full O
scope O
of O
FinSpy O
C O
& O
C O
servers O
. O

Perhaps O
, O
the O
HTTP O
POST O
protocol O
was O
only O
delivered O
to O
a O
specific O
Gamma O
customer O
to O
meet O
a O
requirement O
. O

We O
began O
by O
analyzing O
the O
UAE O
RCS O
sample O
from O
Ahmed O
and O
6 O
samples O
obtained O
from O
VirusTotal O
by O
searching O
for O
AV O
re- O
sults O
containing O
the O
strings O
'' O
DaVinci O
'' O
and O
'' O
RCS O
. O

'' O
At O
the O
time O
, O
several O
AV O
vendors O
had O
added O
detection O
for O
RCS O
based O
on O
a O
sample O
analyzed O
by O
Dr O
. O

Web O
and O
the O
UAE O
RCS O
sample O
sent O
to O
Ahmed O
. O

We O
also O
similarly O
obtained O
and O
analyzed O
sam- O
ples O
of O
FSBSpy O
, O
a B-Entity
piece I-Entity
of I-Entity
malware I-Entity
that O
can O
report B-Action
system B-Entity
information I-Entity
, O
upload B-Action
screenshots B-Entity
, O
and O
drop B-Action
and I-Action
execute I-Action
more B-Entity
malware I-Entity
. O

Based O
on O
these O
samples O
, O
we O
devised O
YARA O
signa- O
tures O
that O
yielded O
23 O
additional O
samples O
of O
structurally O
similar O
malware O
. O

Fingerprints O
: O
We O
probed O
the O
C O
& O
C O
servers O
of O
the O
RCS O
and O
FSBSpy O
samples O
, O
and O
found O
that O
they O
responded O
in O
a O
distinc- O
tive O
way O
to O
HTTP O
requests O
, O
and O
returned O
distinctive O
SSL O
cer- O
tificates O
. O

We O
searched O
sources O
including O
Shodan O
, O
5 O
Internet O
Census O
service O
probes O
, O
and O
Critical.IO O
scanning O
data O
for O
the O
observed O
distinctive O
HTTP O
behavior O
. O

We O
searched O
for O
the O
dis- O
tinctive O
SSL O
certificates O
in O
two O
Internet O
Census O
service O
probes O
, O
and O
SSL O
certificate O
scans O
from O
ZMap O
. O

We O
also O
contacted O
a O
team O
at O
TU O
Munich O
, O
who O
applied O
our O
fingerprints O
to O
their O
SSL O
scanning O
data O
. O

Across O
all O
of O
these O
sources O
, O
we O
obtained O
31,345 O
indicator O
hits O
reflecting O
555 O
IP O
addresses O
in O
48 O
coun- O
tries O
. O

One O
SSL O
certificate O
returned O
by O
175 O
of O
the O
servers O
was O
issued O
by O
'' O
/CN=RCS O
Certification O
Authority O
/O=HT O
srl O
, O
'' O
apparently O
referring O
to O
the O
name O
of O
the O
spyware O
and O
the O
company O
. O

Servers O
for O
5 O
of O
our O
FSBSpy O
samples O
and O
2 O
of O
our O
RCS O
samples O
re- O
sponded O
with O
this O
type O
of O
certificate O
. O

Some O
servers O
returned O
these O
certificates O
in O
chains O
that O
in- O
cluded O
another O
distinctive O
certificate O
. O

We O
found O
175 O
distinct O
IP O
addresses O
( O
including O
the O
C O
& O
C O
's O
for O
5 O
of O
our O
FSBSpy O
samples O
and O
2 O
of O
our O
RCS O
samples O
) O
responded O
with O
this O
second O
type O
of O
certificate O
. O

We O
devised O
two O
more O
indicators O
: O
one O
that O
matched O
125 O
IP O
addresses O
, O
including O
7 O
of O
our O
FSBSpy O
samples O
' O
C O
& O
C O
's O
, O
and O
one O
that O
matched O
2 O
IP O
addresses O
, O
in O
Italy O
and O
Kazakhstan O
. O

Server O
locations O
: O
On O
11/4/13 O
we O
probed O
all O
of O
the O
IP O
ad- O
dresses O
that O
we O
collected O
, O
finding O
166 O
active O
addresses O
match- O
ing O
one O
of O
our O
fingerprints O
in O
29 O
different O
countries O
. O

We O
sum- O
marize O
the O
top O
providers O
and O
countries O
in O
Table O
5 O
. O

The O
prevalence O
of O
active O
servers O
either O
located O
in O
the O
USA O
or O
hosted O
by O
Linode O
is O
striking O
, O
and O
seems O
to O
indicate O
a O
pervasive O
use O
of O
out-of-country O
web O
hosting O
and O
VPS O
services O
. O

In O
addition O
, O
we O
found O
: O
( O
1 O
) O
3 O
IP O
addresses O
on O
a O
/28 O
named O
'' O
HT O
public O
subnet O
'' O
that O
is O
registered O
to O
the O
CFO O
of O
Hacking O
Team O
. O

The O
domain O
hackingteam.it O
resolves O
to O
an O
address O
in O
this O
range O
. O

( O
2 O
) O
An O
address O
belonging O
to O
Omantel O
, O
a O
majority-state-owned O
telecom O
in O
Oman O
. O

This O
address O
was O
un- O
reachable O
when O
we O
probed O
it O
; O
a O
researcher O
pointed O
us O
to O
an B-Entity
FS- I-Entity
BSpy I-Entity
sample I-Entity
that O
contained B-Action
an B-Entity
Arabic-language I-Entity
bait I-Entity
document I-Entity
about I-Entity
Omani I-Entity
poetry I-Entity
, O
which O
talked B-Action
to B-Modifier
a B-Entity
C I-Entity
& I-Entity
C I-Entity
in I-Entity
the I-Entity
UK I-Entity
. O

( O
3 O
) O
7 O
IP O
addresses O
belonging O
to O
Maroc O
Telecom O
. O

Moroccan O
journal- O
ists O
at O
Mamfakinch.com O
were O
previously O
targeted O
by O
RCS O
in O
2012 O
. O

( O
4 O
) O
Overall O
, O
servers O
in O
8 O
countries O
with O
governments O
deemed O
'' O
authoritarian O
regimes O
'' O
: O
Azerbaijan O
, O
Kazakhstan O
, O
Nigeria O
, O
Oman O
, O
Saudi O
Arabia O
, O
Sudan O
, O
UAE O
, O
Uzbekistan O
. O

Link O
to O
Hacking O
Team O
: O
All O
active O
servers O
match- O
ing O
one O
of O
our O
signatures O
also O
responded O
peculiarly O
when O
queried O
with O
particular O
ill-formed O
HTTP O
requests O
, O
respond- O
ing O
with O
'' O
HTTP1/1 O
400 O
Bad O
request O
'' O
( O
should O
be O
'' O
HTTP/1.1 O
'' O
) O
and O
a O
body O
of O
'' O
Detected O
error O
: O
HTTP O
code O
400 O
'' O
. O

Googling O
for O
this O
response O
yielded O
a O
GitHub O
project O
em-http-server O
, O
a O
Ruby-based O
webserver O
. O

The O
project O
's O
author O
is O
listed O
as O
Alberto O
Ornaghi O
, O
a O
software O
architect O
at O
Hacking O
Team O
. O

We O
suspect O
that O
the O
Hacking O
Team O
C O
& O
C O
server O
code O
may O
incorporate O
code O
from O
this O
project O
. O

Links O
between O
servers O
: O
We O
identified O
many O
cases O
where O
several O
servers O
hosted O
by O
different O
providers O
, O
and O
in O
different O
countries O
, O
returned O
identical O
SSL O
certificates O
matching O
our O
fin- O
gerprints O
. O

We O
also O
observed O
30 O
active O
servers O
used O
a O
global O
IPID O
. O

Only O
one O
active O
server O
had O
neither O
a O
global O
IPID O
nor O
an O
SSL O
certificate O
matching O
our O
fingerprints O
. O

We O
assessed O
whether O
servers O
returning O
SSL O
certificates O
were O
forwarding O
to O
the O
servers O
with O
global O
IPIDs O
by O
inducing O
bursts O
of O
traffic O
at O
the O
former O
and O
monitoring O
the O
IPID O
at O
the O
latter O
. O

For O
11 O
servers O
, O
we O
found O
that O
the O
server O
's O
activity O
correlated O
to O
bursts O
sent O
to O
other O
servers O
. O

We O
grouped O
servers O
by O
the O
SSL O
certificates O
they O
returned O
, O
and O
found O
that O
each B-Entity
group I-Entity
forwarded B-Action
to B-Modifier
only B-Entity
a I-Entity
sin- I-Entity
gle I-Entity
server I-Entity
, O
except O
for O
one O
case O
where O
a B-Entity
group I-Entity
forwarded B-Action
to B-Modifier
two B-Entity
different I-Entity
IPs I-Entity
( O
both O
in O
Morocco O
) O
. O

We O
also O
found O
two B-Entity
groups I-Entity
that O
forwarded B-Action
to B-Modifier
the B-Entity
same I-Entity
address I-Entity
. O

There O
was O
a O
1:1 O
mapping O
between O
the O
remaining O
8 O
addresses O
and O
groups O
. O

We O
refer O
to O
a O
group O
along O
with O
the O
server O
( O
s O
) O
it O
forwards O
to O
as O
a O
server O
group O
. O

We O
identified O
several O
server O
groups O
that O
may O
be O
associated O
with O
victims O
or O
operators O
in O
a O
certain O
country O
. O

Some O
of O
these O
suggest O
possible O
further O
investigation O
: O
Turkey O
: O
We O
identified O
a O
group O
containing O
20 O
servers O
in O
9 O
countries O
. O

Two B-Entity
RCS I-Entity
and I-Entity
5 I-Entity
FSBSpy I-Entity
samples I-Entity
from I-Entity
VirusTo- I-Entity
tal I-Entity
communicated B-Action
with B-Modifier
various B-Entity
servers I-Entity
in I-Entity
the I-Entity
group I-Entity
. O

The B-Entity
RCS I-Entity
samples I-Entity
also O
communicated B-Action
with B-Modifier
domains B-Entity
with I-Entity
lapsed I-Entity
registra- I-Entity
tions I-Entity
, O
so O
we O
registered O
them O
to O
observe O
incoming O
traffic O
. O

We O
ex- O
clusively O
received O
RCS O
traffic O
from O
Turkish O
IP O
addresses O
. O

( O
RCS O
traffic O
is O
identifiable O
based O
on O
a O
distinctive O
user O
agent O
and O
URL O
in O
POST O
requests O
. O

) O
A B-Entity
sample I-Entity
of I-Entity
FSBSpy I-Entity
apparently O
installed O
from O
an O
exploit O
on O
a O
Turkish O
server O
talked B-Action
to B-Modifier
one B-Entity
of I-Entity
the I-Entity
servers I-Entity
in I-Entity
this I-Entity
group I-Entity
. O

We O
also O
found O
server O
groups O
containing O
servers O
in O
Uzbek- O
istan O
and O
Kazakhstan O
; O
we O
found O
FSBSpy B-Entity
samples I-Entity
on I-Entity
Virus- I-Entity
Total I-Entity
uploaded I-Entity
from I-Entity
these I-Entity
countries I-Entity
that O
communicated B-Action
with B-Modifier
servers B-Entity
in I-Entity
these I-Entity
groups I-Entity
. O

In O
the O
above O
cases O
, O
save O
Turkey O
, O
the O
country O
we O
have O
identi- O
fied O
is O
classified O
as O
an O
'' O
authoritarian O
regime O
, O
'' O
and O
may O
be O
using O
Hacking O
Team O
products O
against O
the O
types O
of O
targets O
we O
profile O
in O
this O
paper O
. O

In O
the O
case O
of O
Turkey O
, O
there O
are O
hints O
that O
the O
tool O
may O
be O
employed O
against O
dissidents O
. O

Targeted O
surveillance O
of O
individuals O
conducted O
by O
nation-states O
poses O
an O
exceptionally O
challenging O
security O
problem O
, O
given O
the O
great O
imbalance O
of O
resources O
and O
expertise O
between O
the O
victims O
and O
the O
attackers O
. O

We O
have O
sketched O
the O
nature O
of O
this O
problem O
space O
as O
reported O
to O
us O
by O
targeted O
individuals O
in O
three O
Middle O
Eastern O
countries O
. O

The B-Entity
attacks I-Entity
include B-Action
spyware B-Entity
for I-Entity
ongoing I-Entity
monitoring I-Entity
and O
the B-Entity
use I-Entity
of I-Entity
'' I-Entity
IP I-Entity
spy I-Entity
'' I-Entity
links I-Entity
to I-Entity
deanonymize I-Entity
those I-Entity
who I-Entity
voice I-Entity
dissent I-Entity
. O

The B-Entity
attacks I-Entity
, O
while O
sometimes O
incorporating B-Action
effective B-Entity
so- I-Entity
cial I-Entity
engineering I-Entity
, O
in O
general O
lack O
novel O
technical O
elements O
. O

In- O
stead O
, O
they O
employ O
prepackaged O
tools O
developed O
by O
vendors O
or O
acquired O
from O
the O
cybercrime O
underground O
. O

This O
technol- O
ogy O
sometimes O
suffers O
from O
what O
strike O
us O
as O
amateurish O
mis- O
takes O
( O
multiple O
serious O
errors O
implementing O
cryptography O
, O
bro- O
ken O
protocol O
messages O
) O
, O
as O
does O
the O
attackers O
' O
employment O
of O
it O
( O
identifying-information O
embedded O
in O
binaries O
, O
C O
& O
C O
servers O
discoverable O
via O
scanning O
or O
'' O
Google O
hacking O
'' O
, O
clusters O
of O
at- O
tack O
accounts O
tied O
by O
common O
activity O
) O
. O

Some O
of O
these O
errors O
assisted O
our O
efforts O
to O
assemble O
strong O
circumstantial O
evidence O
of O
governmental O
origins O
. O

In O
addition O
, O
we O
mapped O
out O
the O
global O
use O
of O
two O
'' O
governmental O
'' O
hacking O
suites O
, O
including O
identify- O
ing O
11 O
cases O
in O
which O
they O
appeared O
to O
be O
used O
in O
countries O
governed O
by O
'' O
authoritarian O
regimes O
. O

'' O
We O
aim O
with O
this O
work O
to O
inspire O
additional O
research O
efforts O
addressing O
the O
difficult O
problem O
of O
how O
to O
adequately O
protect O
individuals O
with O
very O
limited O
resources O
facing O
very O
powerful O
adversaries O
. O

Open O
questions O
include O
robust O
, O
practical O
detection O
of O
targeted O
attacks O
designed O
to O
exfiltrate O
data O
from O
a O
victim's O
computer O
, O
as O
well O
as O
detection O
of O
and O
defense O
against O
novel O
at- O
tack O
vectors O
, O
like O
tampering O
with O
Internet O
connections O
to O
insert O
malware O
. O

The O
task O
is O
highly O
challenging O
, O
but O
the O
potential O
stakes O
are O
likewise O
very O
high O
. O

An O
opposition O
member O
, O
reflecting O
on O
gov- O
ernment O
hacking O
in O
Libya O
, O
speculated O
as O
to O
why O
some O
users O
would O
execute O
files O
even O
while O
recognizing O
them O
as O
potentially O
malicious O
: O
'' O
If O
we O
were O
vulnerable O
we O
could O
n't O
care O
less O
. O

. O

. O

we O
were O
desperate O
to O
get O
our O
voices O
out O
. O

. O

. O

it O
was O
a O
matter O
of O
life O
or O
death O
. O

. O

. O

it O
was O
just O
vital O
to O
get O
this O
information O
out O
. O

'' O
This O
work O
was O
supported O
by O
the O
National O
Science O
Foundation O
under O
grants O
1223717 O
and O
1237265 O
, O
and O
by O
a O
Citizen O
Lab O
Fel- O
lowship O
. O

Any O
opinions O
, O
findings O
, O
and O
conclusions O
or O
recom- O
mendations O
expressed O
in O
this O
material O
are O
those O
of O
the O
authors O
and O
do O
not O
necessarily O
reflect O
the O
views O
of O
the O
sponsors O
. O

The O
authors O
would O
like O
to O
thank O
the O
following O
individuals O
for O
their O
help O
in O
various O
aspects O
of O
our O
analysis O
: O
Bernhard O
Am- O
man O
, O
Collin O
D. O
Anderson O
, O
Brandon O
Dixon O
, O
Zakir O
Durumeric O
, O
Eva O
Galperin O
, O
Claudio O
Guarnieri O
, O
Drew O
Hintz O
, O
Ralph O
Holz O
, O
Shane O
Huntley O
, O
Andrew O
Lyons O
, O
Mark O
Schloesser O
, O
and O
Nicholas O
Weaver O
. O

Previous O
work O
by O
Guarnieri O
on O
scanning O
for O
FinSpy O
servers O
found O
that O
in O
response O
to O
a O
request O
such O
as O
GET O
/ O
, O
the O
Bahraini O
FinSpy O
C O
& O
C O
server O
returns O
a O
response O
with O
the O
string O
'' O
Hallo O
Steffi O
'' O
. O

Guarnieri O
searched O
a O
database O
of O
such O
responses O
compiled O
by O
the O
Critical.IO O
Internet O
scanning O
project O
, O
locating O
11 O
additional O
servers O
in O
10 O
countries O
. O

We O
refer O
to O
this O
fingerprint O
as O
α1 O
. O

Concurrent O
with O
this O
ef- O
fort O
, O
we O
devised O
our O
own O
fingerprint O
β1 O
that O
tested O
three O
as- O
pects O
of O
the O
handshake O
between O
a O
FinSpy O
infectee O
and O
a O
Fin- O
Spy O
C O
& O
C O
server O
, O
which O
follows O
a O
custom O
TLV-based O
protocol O
running O
on O
ports O
such O
as O
22 O
, O
53 O
, O
80 O
, O
and O
443 O
. O

We O
conducted O
targeted O
scanning O
of O
several O
countries O
using O
β1 O
, O
and O
also O
con- O
firmed O
Guarnieri O
's O
findings O
for O
those O
servers O
still O
reachable O
af- O
ter O
he O
published O
his O
findings O
. O

We O
observed O
a O
trend O
: O
changes O
in O
HTTP O
response O
behavior O
by O
FinFisher O
after O
publication O
of O
findings O
about O
the O
software O
. O

In O
July O
2012 O
, O
for O
example O
, O
after O
a O
post O
about O
Bahraini O
FinSpy O
samples O
, O
servers O
closed O
the O
TCP O
connection O
in O
response O
to O
a O
GET O
/ O
or O
HEAD O
/ O
request O
( O
although O
servers O
continued O
to O
behave O
consistently O
with O
β1 O
. O

Other O
changes O
followed O
later O
in O
2012 O
, O
including O
a O
new O
response O
to O
GET O
/ O
requests O
that O
in- O
cluded O
an O
imperfect O
copy O
of O
an O
Apache O
server O
's O
HTTP O
response O
( O
the O
Date O
header O
used O
UTC O
rather O
than O
GMT O
) O
. O

We O
fingerprinted O
this O
error O
as O
α2 O
, O
and O
later O
in O
2012 O
fingerprinted O
other O
distinctive O
behavior O
in O
response O
to O
GET O
/ O
requests O
as O
α3 O
. O

Subsequent O
scans O
of O
/0 O
for O
α2 O
and O
α3 O
, O
and O
five O
service O
probes O
of O
the O
Internet O
Census O
for O
α1 O
through O
α3 O
, O
located O
several O
additional O
servers O
. O

In O
Feburary O
2013 O
we O
identified O
and O
finger- O
printed O
new O
HTTP O
response O
behavior O
with O
α4 O
and O
modified O
β1 O
to O
produce O
β2 O
, O
which O
tests O
only O
two O
of O
the O
three O
aspects O
of O
the O
FinSpy O
handshake O
( O
the O
third O
test O
of O
β1 O
was O
broken O
when O
Fin- O
Spy O
servers O
were O
updated O
to O
accept O
types O
of O
invalid O
data O
they O
had O
previously O
rejected O
) O
. O

As O
of O
3/13/13 O
, O
all O
servers O
that O
matched O
any O
α O
fingerprint O
matched O
β2 O
. O

Over O
the O
last O
10 O
months O
, O
Kaspersky O
Lab O
researchers O
have O
analyzed O
a O
massive O
cyber-espionage O
operation O
which O
we O
call O
'' O
Epic O
Turla O
'' O
. O

The O
attackers O
behind O
Epic O
Turla O
have O
infected O
several O
hundred O
computers O
in O
more O
than O
45 O
countries O
, O
including O
government O
institutions O
, O
embassies O
, O
military O
, O
education O
, O
research O
and O
pharmaceutical O
companies O
. O

The O
attacks O
are O
known O
to O
have O
used O
at O
least O
two O
zero-day O
exploits O
: O
We O
also O
observed O
exploits O
against O
older O
( O
patched O
) O
vulnerabilities O
, O
social O
engineering O
techniques O
and O
watering O
hole O
strategies O
in O
these O
attacks O
. O

The B-Entity
primary I-Entity
backdoor I-Entity
used B-Action
in B-Modifier
the B-Entity
Epic I-Entity
attacks I-Entity
is O
also O
known O
as O
'' O
WorldCupSec O
'' O
, O
'' O
TadjMakhal O
'' O
, O
'' O
Wipbot O
'' O
or O
'' O
Tavdig O
'' O
. O

When O
G-Data O
published O
on O
Turla/Uroburos O
back O
in O
February O
, O
several O
questions O
remained O
unanswered O
. O

One O
big O
unknown O
was O
the O
infection O
vector O
for O
Turla O
( O
aka O
Snake O
or O
Uroburos O
) O
. O

Our O
analysis O
indicates O
that O
victims B-Entity
are B-Action
infected I-Action
via B-Modifier
a B-Entity
sophisticated I-Entity
multi-stage I-Entity
attack I-Entity
, O
which O
begins O
with O
the O
Epic O
Turla O
. O

In O
time O
, O
as O
the O
attackers O
gain O
confidence O
, O
this B-Entity
is B-Action
upgraded I-Action
to B-Modifier
more B-Entity
sophisticated I-Entity
backdoors I-Entity
, O
such O
as O
the O
Carbon/Cobra O
system O
. O

Sometimes O
, O
both B-Entity
backdoors I-Entity
are B-Action
run I-Action
in B-Modifier
tandem B-Entity
, O
and O
used O
to O
'' O
rescue O
'' O
each O
other O
if O
communications O
are O
lost O
with O
one O
of O
the O
backdoors O
. O

Once O
the B-Entity
attackers I-Entity
obtain B-Action
the B-Entity
necessary I-Entity
credentials I-Entity
without B-Modifier
the B-Entity
victim I-Entity
noticing I-Entity
, O
they B-Entity
deploy B-Action
the B-Entity
rootkit I-Entity
and I-Entity
other I-Entity
extreme I-Entity
persistence I-Entity
mechanisms I-Entity
. O

The O
attacks O
are O
still O
ongoing O
as O
of O
July O
2014 O
, O
actively O
targeting O
users O
in O
Europe O
and O
the O
Middle O
East O
. O

Note O
: O
A O
full O
analysis O
of O
the O
Epic O
attacks O
is O
available O
to O
the O
Kaspersky O
Intelligent O
Services O
subscribers O
. O

Contact O
: O
intelreports O
@ O
kaspersky.com O
The O
attacks O
in O
this O
campaign O
fall O
into O
several O
different O
categories O
depending O
on O
the O
vector O
used O
in O
the O
initial O
compromise O
: O
The B-Entity
attackers I-Entity
use B-Action
both B-Entity
direct I-Entity
spearphishing I-Entity
and I-Entity
watering I-Entity
hole I-Entity
attacks I-Entity
to B-Modifier
infect B-Entity
their I-Entity
victims I-Entity
. O

Watering O
holes O
( O
waterholes O
) O
are O
websites O
of O
interest O
to O
the O
victims O
that O
have O
been O
compromised O
by O
the O
attackers O
and O
injected O
to O
serve O
malicious O
code O
. O

So O
far O
we O
have O
n't O
been O
able O
to O
locate O
any O
e-mail O
used O
against O
the O
victims O
, O
only O
the O
attachments O
. O

The O
PDF O
attachments O
do O
not O
show O
any O
'' O
lure O
'' O
to O
the O
victim O
when O
opened O
, O
however O
, O
the O
SCR O
packages O
sometime O
show O
a O
clean O
PDF O
upon O
successful O
installation O
. O

Some O
of O
known O
attachment O
names O
used O
in O
the O
spearphishing O
attacks O
are O
: O
In O
some O
cases O
, O
these O
filenames O
can O
provide O
clues O
about O
the O
type O
of O
victims O
the O
attackers O
are O
targeting O
. O

Currently O
, O
the B-Entity
Epic I-Entity
attackers I-Entity
run B-Action
a B-Entity
vast I-Entity
network I-Entity
of I-Entity
watering I-Entity
holes I-Entity
that O
target B-Action
visitors B-Entity
with B-Modifier
surgical B-Entity
precision I-Entity
. O

Some O
of O
the O
injected O
websites O
include O
: O
In O
total O
, O
we O
observed O
more O
than O
100 O
injected O
websites O
. O

Currently O
, O
the O
largest O
number O
of O
injected O
sites O
is O
in O
Romania O
. O

Here O
's O
a O
statistic O
on O
the O
injected O
websites O
: O
The O
distribution O
is O
obviously O
not O
random O
, O
and O
it O
reflects O
some O
of O
the O
interests O
of O
the O
attackers O
. O

For O
instance O
, O
in O
Romania O
many O
of O
the O
infected O
sites O
are O
in O
the O
Mures O
region O
, O
while O
many O
of O
the O
Spanish O
infected O
sites O
belong O
to O
local O
governments O
( O
City O
Hall O
) O
. O

Most O
of O
the O
infected O
sites O
use O
the O
TYPO3 O
CMS O
( O
see O
: O
http O
: O
//typo3.org/ O
) O
, O
which O
could O
indicate O
the O
attackers O
are O
abusing O
a O
specific O
vulnerability O
in O
this O
publishing O
platform O
. O

Injected B-Entity
websites I-Entity
load B-Action
a B-Entity
remote I-Entity
JavaScript I-Entity
into B-Modifier
the B-Entity
victim I-Entity
's I-Entity
browser I-Entity
: O
The O
script O
'' O
sitenavigatoin.js O
'' O
is O
a O
Pinlady-style O
browser O
and O
plugin O
detection O
script O
, O
which O
in O
turn O
, O
redirects O
to O
a O
PHP O
script O
sometimes O
called O
main.php O
or O
wreq.php O
. O

Sometimes O
, O
the B-Entity
attackers I-Entity
register O
the O
.JPG O

extension O
with O
the O
PHP O
handler O
on O
the O
server O
, O
using B-Action
'' B-Entity
JPG I-Entity
'' I-Entity
files I-Entity
to B-Modifier
run B-Entity
PHP I-Entity
scripts I-Entity
: O
The O
main O
exploitation O
script O
'' O
wreq.php O
'' O
, O
'' O
main.php O
'' O
or O
'' O
main.jpg O
'' O
performs O
a O
numbers O
of O
tasks O
. O

We O
have O
located O
several B-Entity
versions I-Entity
of I-Entity
this I-Entity
script I-Entity
which O
attempt B-Action
various B-Entity
exploitation I-Entity
mechanisms I-Entity
. O

One B-Entity
version I-Entity
of I-Entity
this I-Entity
script I-Entity
attempts O
to O
exploit B-Action
Internet B-Entity
Explorer I-Entity
versions I-Entity
6 I-Entity
, I-Entity
7 I-Entity
and I-Entity
8 I-Entity
: O
Unfortunately O
, O
the O
Internet O
Explorer O
exploits O
have O
not O
yet O
been O
retrieved O
. O

Another B-Entity
more I-Entity
recent I-Entity
version I-Entity
attempts O
to O
exploit B-Action
Oracle B-Entity
Sun I-Entity
Java I-Entity
and I-Entity
Adobe I-Entity
Flash I-Entity
Player I-Entity
: O
Although O
the O
Flash O
Player O
exploits O
could O
n't O
be O
retrieved O
, O
we O
did O
manage O
to O
obtain O
the O
Java O
exploits O
: O
The B-Entity
Java I-Entity
files I-Entity
exploit B-Action
a B-Entity
popular I-Entity
vulnerability I-Entity
, O
CVE-2012-1723 B-Entity
, O
in B-Modifier
various B-Entity
configurations I-Entity
. O

The B-Entity
payload I-Entity
dropped B-Action
by O
these O
Java B-Entity
exploits I-Entity
is O
the O
following O
: O
The B-Entity
Java I-Entity
exploit I-Entity
use B-Action
a B-Entity
special I-Entity
loader I-Entity
that O
attempts O
to O
inject B-Action
the B-Entity
final I-Entity
Epic I-Entity
backdoor I-Entity
payload I-Entity
into B-Modifier
explorer.exe B-Entity
. O

The B-Entity
backdoor I-Entity
extracted I-Entity
from I-Entity
the I-Entity
Java I-Entity
exploits I-Entity
has B-Action
the B-Entity
following I-Entity
C I-Entity
& I-Entity
C I-Entity
hardcoded O
inside O
: O
This O
C O
& O
C O
is O
still O
online O
at O
the O
moment O
although O
it O
redirects O
to O
a O
currently O
suspended O
page O
at O
'' O
hxxp O
: O
//busandcoachdirectory.com O
[ O
. O

] O
au O
'' O
. O

For O
a O
full O
list O
of O
C O
& O
C O
servers O
, O
please O
see O
the O
Appendix O
. O

The O
Epic O
Turla O
attackers O
are O
extremely O
dynamic O
in O
using O
exploits O
or O
different O
methods O
depending O
on O
what O
is O
available O
at O
the O
moment O
. O

Most O
recently O
, O
we O
observed O
them B-Entity
using B-Action
yet B-Entity
another I-Entity
technique I-Entity
coupled I-Entity
with I-Entity
watering I-Entity
hole I-Entity
attacks I-Entity
. O

This O
takes B-Action
advantage B-Entity
of B-Modifier
social B-Entity
engineering I-Entity
to O
trick B-Action
the B-Entity
user I-Entity
into B-Modifier
running B-Entity
a I-Entity
fake I-Entity
Flash I-Entity
Player I-Entity
( O
MD5 O
: O
030f5fdb78bfc1ce7b459d3cc2cf1877 O
) O
: O
In O
at O
least O
one O
case O
, O
they B-Entity
tried O
to O
trick B-Action
the B-Entity
user I-Entity
into B-Modifier
downloading B-Entity
and I-Entity
running I-Entity
a I-Entity
fake I-Entity
Microsoft I-Entity
Security I-Entity
Essentials I-Entity
app I-Entity
( O
MD5 O
: O
89b0f1a3a667e5cd43f5670e12dba411 O
) O
: O
The O
fake O
application O
is O
signed O
by O
a O
valid O
digital O
certificate O
from O
Sysprint O
AG O
: O
This B-Entity
file I-Entity
was B-Action
distributed I-Action
from B-Modifier
the B-Entity
Ministry I-Entity
of I-Entity
Foreign I-Entity
Affairs I-Entity
of I-Entity
Tajikistan I-Entity
's I-Entity
website I-Entity
, O
at B-Modifier
'' B-Entity
hxxp I-Entity
: I-Entity
//mfa I-Entity
[ I-Entity
. I-Entity
] I-Entity
tj/upload/security.php I-Entity
'' I-Entity
. O

The B-Entity
file I-Entity
is O
a O
.NET O

application O
that O
contains B-Action
an B-Entity
encrypted I-Entity
resource I-Entity
. O

This B-Entity
drops B-Action
the B-Entity
malicious I-Entity
file I-Entity
with I-Entity
the I-Entity
MD5 I-Entity
7731d42b043865559258464fe1c98513 I-Entity
. O

This B-Entity
is B-Action
an B-Entity
Epic I-Entity
backdoor I-Entity
which O
connects B-Action
to B-Modifier
the B-Entity
following I-Entity
C I-Entity
& I-Entity
Cs I-Entity
, O
with B-Modifier
a B-Entity
generic I-Entity
internal I-Entity
ID I-Entity
of I-Entity
1156fd22- I-Entity
3443-4344-c4ffff I-Entity
: O
A O
full O
list O
with O
all O
the O
C O
& O
C O
server O
URLs O
that O
we O
recovered O
from O
the O
samples O
can O
be O
found O
in O
the O
technical O
Appendix O
. O

The B-Entity
Epic I-Entity
backdoors I-Entity
are B-Action
commanded I-Action
by O
a B-Entity
huge I-Entity
network I-Entity
of I-Entity
hacked I-Entity
servers I-Entity
that O
deliver B-Action
command B-Entity
and I-Entity
control I-Entity
functionality I-Entity
. O

The B-Entity
huge I-Entity
network I-Entity
commanded B-Action
by O
the B-Entity
Epic I-Entity
Turla I-Entity
attackers I-Entity
serves O
multiple O
purposes O
. O

For O
instance O
, O
the B-Entity
motherships I-Entity
function B-Action
as B-Modifier
both O
exploitation B-Entity
sites I-Entity
and O
command B-Entity
and I-Entity
control I-Entity
panels I-Entity
for O
the O
malware O
. O

Here O
's O
how O
the O
big O
picture O
looks O
like O
: O
The B-Entity
first I-Entity
level I-Entity
of I-Entity
command I-Entity
and I-Entity
control I-Entity
proxies I-Entity
generally O
talk B-Action
to B-Modifier
a B-Entity
second I-Entity
level I-Entity
of I-Entity
proxies I-Entity
, O
which O
in O
turn O
, O
talk B-Action
to B-Modifier
the B-Entity
'' I-Entity
mothership I-Entity
'' I-Entity
server I-Entity
. O

The B-Entity
mothership I-Entity
server I-Entity
is O
generally O
a O
VPS O
, O
which O
runs B-Action
the B-Entity
Control I-Entity
panel I-Entity
software I-Entity
used O
to O
interact B-Action
with B-Modifier
the B-Entity
victims I-Entity
. O

The O
attackers O
operate O
the O
mothership O
using O
a O
network O
of O
proxies O
and O
VPN O
servers O
for O
anonymity O
reasons O
. O

The B-Entity
mothership I-Entity
also O
work B-Action
as B-Modifier
the B-Entity
exploitation I-Entity
servers I-Entity
used B-Action
in B-Modifier
the B-Entity
watering I-Entity
hole I-Entity
attacks I-Entity
, O
delivering B-Action
Java B-Entity
, I-Entity
IE I-Entity
or I-Entity
fake I-Entity
applications I-Entity
to B-Modifier
the B-Entity
victim I-Entity
. O

We O
were O
able O
to O
get O
a O
copy O
of O
one O
of O
the O
motherships O
, O
which O
provided O
some O
insight O
into O
the O
operation O
. O

It O
runs O
a O
control O
panel O
which O
is O
password O
protected O
: O
Once O
logged O
into O
the O
Control O
panel O
, O
the O
attackers O
can O
see O
a O
general O
overview O
of O
the O
system O
including O
the O
number O
of O
interesting O
potential O
targets O
: O
A O
very O
interesting O
file O
on O
the O
servers O
is O
task.css O
, O
where O
the B-Entity
attackers I-Entity
define B-Action
the B-Entity
IP I-Entity
ranges I-Entity
they I-Entity
are I-Entity
interested I-Entity
in I-Entity
. O

To O
change O
the O
file O
, O
they O
are O
using O
the O
'' O
Task O
editor O
'' O
from O
the O
menu O
. O

Depending O
on O
the O
'' O
tasks O
'' O
, O
they B-Entity
will O
decide B-Action
whether B-Entity
to I-Entity
infect I-Entity
the I-Entity
visitors I-Entity
or I-Entity
not I-Entity
. O

In O
this O
case O
, O
we O
found O
they B-Entity
targeted B-Action
two B-Entity
ranges I-Entity
belonging O
to O
: O
It O
should O
be O
noted O
though O
, O
the O
fact O
that O
the O
attackers O
were O
targeting O
these O
ranges O
does O
n't O
necessarily O
mean O
they O
also O
got O
infected O
. O

Some O
other O
unknown O
IPs O
were O
also O
observed O
in O
the O
targeting O
schedules O
. O

There O
is O
also O
an O
'' O
except.css O
'' O
file O
where O
attackers O
log O
the O
reasons O
they O
did O
n't O
try O
to O
exploit O
certain O
visitors O
. O

There O
are O
three O
possible O
values O
: O
These O
are O
the O
'' O
do O
n't O
meet O
the O
conditions O
'' O
reasons O
observed O
in O
the O
logs O
: O
For O
this O
first O
stage O
of O
the O
attack O
, O
the B-Entity
threat I-Entity
actor I-Entity
uses B-Action
a B-Entity
custom I-Entity
backdoor I-Entity
. O

In O
some O
cases O
, O
the B-Entity
backdoor I-Entity
is O
packaged O
together O
with O
the O
CVE-2013-5065 O
EoP O
exploit O
and O
heavily O
obfuscated B-Action
. O

This O
makes O
the O
analysis O
more O
difficult O
. O

The O
CVE-2013-5065 O
exploit O
allows O
the B-Entity
backdoor I-Entity
to O
achieve B-Action
administrator B-Entity
privileges I-Entity
on I-Entity
the I-Entity
system I-Entity
and O
run B-Action
unrestricted B-Entity
. O

This O
exploit O
only O
works O
on O
unpatched O
Microsoft O
Windows O
XP O
systems O
. O

Other O
known O
detection O
names O
for O
the O
backdoor O
is O
Trojan.Wipbot O
( O
Symantec O
) O
or O
Tavdig O
. O

The B-Entity
main I-Entity
backdoor I-Entity
is O
about O
60KB O
in O
size O
and O
implements B-Action
a B-Entity
C I-Entity
& I-Entity
C I-Entity
protocol I-Entity
on B-Modifier
top I-Modifier
of I-Modifier
normal B-Entity
HTTP I-Entity
requests I-Entity
. O

The B-Entity
communication I-Entity
protocol I-Entity
uses B-Action
requests B-Entity
in B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
replies I-Entity
, O
which O
the B-Entity
malware I-Entity
decrypts B-Action
and I-Action
processes I-Action
. O

The B-Entity
replies I-Entity
are B-Action
sent I-Action
back B-Modifier
to I-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
through B-Modifier
the B-Entity
same I-Entity
channel I-Entity
. O

The O
malware O
behavior O
is O
defined O
by O
a O
configuration O
block O
. O

The O
configuration O
block O
usually O
contains O
two O
hard-coded O
C O
& O
C O
URLs O
. O

He O
have O
also O
seen O
one O
case O
where O
the O
configuration O
block O
contains O
just O
one O
URL O
. O

The B-Entity
configuration I-Entity
can O
also O
be B-Action
updated I-Action
on O
the O
fly O
by O
the B-Entity
attackers I-Entity
, O
via B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
. O

The B-Entity
backdoor I-Entity
attempts O
to O
identify B-Action
the B-Entity
following I-Entity
processes I-Entity
and O
, O
if O
found O
, O
it B-Entity
will O
terminate B-Action
itself B-Entity
: O
It O
contains O
an B-Entity
internal I-Entity
unique I-Entity
ID I-Entity
, O
which O
is O
used O
to O
identify B-Action
the B-Entity
victim I-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
. O

Most O
samples O
, O
especially O
old O
ones O
, O
have O
the O
ID O
1156fd22-3443-4344-c4ffff O
. O

Once O
a B-Entity
victim I-Entity
is B-Action
confirmed I-Action
as B-Modifier
'' B-Entity
interesting I-Entity
'' I-Entity
, O
the B-Entity
attackers I-Entity
upload B-Action
another B-Entity
Epic I-Entity
backdoor I-Entity
which O
has O
a O
unique O
ID O
used O
to O
control B-Action
this B-Entity
specific I-Entity
victim I-Entity
. O

During B-Modifier
the B-Entity
first I-Entity
C I-Entity
& I-Entity
C I-Entity
call I-Entity
, O
the B-Entity
backdoor I-Entity
sends B-Action
a B-Entity
pack I-Entity
with I-Entity
the I-Entity
victim I-Entity
's I-Entity
system I-Entity
information I-Entity
. O

All B-Entity
further I-Entity
information I-Entity
sent B-Action
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
is B-Action
encrypted I-Action
with B-Modifier
a B-Entity
public I-Entity
key I-Entity
framework I-Entity
, O
making O
decryption O
impossible O
. O

The B-Entity
commands I-Entity
from I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
are B-Action
encrypted I-Action
in O
a O
simpler O
manner O
and O
can O
be O
decrypted O
if O
intercepted O
because O
the O
secret O
key O
is O
hardcoded O
in O
the O
malware O
. O

Through O
monitoring O
, O
we O
were O
able O
to O
capture O
a B-Entity
large I-Entity
amount I-Entity
of I-Entity
commands I-Entity
sent B-Action
to B-Modifier
the B-Entity
victims I-Entity
by O
the B-Entity
attackers I-Entity
, O
providing O
an O
unique O
view O
into O
this O
operation O
. O

Here O
's O
a O
look O
at O
one O
of O
the O
encrypted O
server O
replies O
: O
Once O
a B-Entity
victim I-Entity
is B-Action
infected I-Action
and O
'' B-Action
checks I-Action
in I-Action
'' I-Action
with B-Modifier
the B-Entity
server I-Entity
, O
the B-Entity
attackers I-Entity
send B-Action
a B-Entity
template I-Entity
of I-Entity
commands I-Entity
: O
Next O
, O
the B-Entity
attackers I-Entity
try O
to O
move B-Action
through B-Modifier
the B-Entity
victim I-Entity
's I-Entity
network I-Entity
using B-Modifier
pre-defined B-Entity
or I-Entity
collected I-Entity
passwords I-Entity
: O
Listing O
all O
.doc O

files O
recursively O
is O
also O
a O
common O
'' O
theme O
'' O
: O
In O
total O
, O
we O
have O
decoded O
several O
hundreds O
of O
these O
command O
packages O
delivered O
to O
the O
victims O
, O
providing O
an O
unique O
insight O
into O
the O
inner O
workings O
of O
the O
attackers O
. O

In O
addition O
to O
generic O
searches O
, O
some O
very O
specific O
lookups O
have O
been O
observed O
as O
well O
. O

These O
include O
searches O
for O
: O
In O
this O
case O
, O
the B-Entity
attackers I-Entity
were O
interested O
to O
find B-Action
e-mails B-Entity
related I-Entity
to I-Entity
'' I-Entity
NATO I-Entity
'' I-Entity
, I-Entity
'' I-Entity
Energy I-Entity
Dialogue I-Entity
within I-Entity
European I-Entity
Unition I-Entity
'' I-Entity
and I-Entity
so I-Entity
on I-Entity
. O

For O
some O
of O
the O
C O
& O
C O
servers O
, O
the B-Entity
attackers I-Entity
implemented B-Action
RSA B-Entity
encryption I-Entity
for B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
logs I-Entity
, O
which O
makes O
it O
impossible O
to O
decrypt O
them O
. O

This O
scheme O
was O
implemented O
in O
April O
2014 O
. O

Once O
a B-Entity
victim I-Entity
is B-Action
compromised I-Action
, O
the B-Entity
attackers I-Entity
upload B-Action
several B-Entity
tools I-Entity
that I-Entity
are I-Entity
used I-Entity
for I-Entity
lateral I-Entity
movement I-Entity
. O

One O
such O
tool O
observed O
in O
the O
attacks O
and O
saved O
as O
'' O
C O
: O
\Documents O
and O
Settings\All O
users\Start O
Menu\Programs\Startup\winsvclg.exe O
'' O
is O
: O
This B-Entity
is B-Action
a B-Entity
keylogger I-Entity
tool I-Entity
that O
creates O
% O
temp O
% O
\~DFD3O8.tmp O
. O

Note O
: O
the O
filename O
can O
change O
across O
victims O
. O

On O
one O
Central O
Asian O
government O
's O
Ministry O
of O
Foreign O
Affairs O
victim O
system O
, O
the O
filename O
used O
was O
'' O
adobe32updt.exe O
'' O
. O

In O
addition O
to O
these O
custom O
tools O
, O
we O
observed O
the O
usage O
of O
standard O
administration O
utilities O
. O

For O
instance O
, O
another B-Entity
tool I-Entity
often O
uploaded B-Action
by O
the B-Entity
attackers I-Entity
to B-Modifier
the B-Entity
victim I-Entity
's I-Entity
machine I-Entity
is O
'' B-Entity
winrs.exe I-Entity
'' I-Entity
: O
This O
is O
an O
UPX O
packed O
binary O
, O
which O
contains O
the O
genuine O
'' O
dnsquery.exe O
'' O
tool O
from O
Microsoft O
, O
unpacked O
MD5 O
: O
c0c03b71684eb0545ef9182f5f9928ca O
. O

In O
several O
cases O
, O
an O
interesting O
update O
has O
been O
observed O
-- O
a O
malware O
from O
a O
different O
, O
yet O
related O
family O
. O

This B-Entity
backdoor I-Entity
is O
more O
sophisticated O
and O
belongs O
to O
the O
next O
level O
of O
cyber-espionage O
tools O
called B-Action
the B-Entity
'' I-Entity
Carbon I-Entity
system I-Entity
'' I-Entity
or I-Entity
Cobra I-Entity
by O
the B-Entity
Turla I-Entity
attackers I-Entity
. O

Several O
plugins O
for O
the O
'' O
Carbon O
system O
'' O
are O
known O
to O
exist O
. O

Note O
: O
the O
command O
and O
control O
servers O
www.losguayaberos O
[ O
. O

] O
com O
and O
thebesttothbrushes O
[ O
. O

] O
com O
have O
been O
sinkholed O
by O
Kaspersky O
Lab O
. O

Other O
packages O
delivered O
to O
the O
victims O
include O
: O
These B-Entity
top I-Entity
level I-Entity
packages I-Entity
deploy B-Action
both B-Entity
updated I-Entity
Epic I-Entity
backdoors I-Entity
and I-Entity
Turla I-Entity
Carbon I-Entity
system I-Entity
backdoors I-Entity
to B-Modifier
confirmed B-Entity
victims I-Entity
, O
effectively O
linking O
the O
Epic O
and O
Turla O
Carbon O
operations O
together O
. O

The O
Turla O
Carbon O
dropper O
from O
these O
packages O
has O
the O
following O
properties O
: O
This O
is O
called O
internally O
by O
the O
authors O
'' O
Carbon O
System O
'' O
, O
part O
of O
the O
'' O
Cobra O
'' O
project O
, O
as O
it O
can O
be O
seen O
from O
the O
debug O
path O
inside O
: O
This B-Entity
acts B-Action
as B-Modifier
a B-Entity
dropper I-Entity
for I-Entity
the I-Entity
following I-Entity
modules I-Entity
, O
both O
32 O
and O
64 O
bit O
: O
The O
Carbon O
system O
is O
in O
essence O
an O
extensible O
platform O
, O
very O
similar O
to O
other O
attack O
platforms O
such O
as O
the O
Tilded O
platform O
or O
the O
Flame O
platform O
. O

The O
plugins O
for O
the O
Carbon O
system O
can O
be O
easily O
recognized O
as O
they O
always O
feature O
at O
least O
two O
exports O
named O
: O
Several O
Epic O
backdoors O
appear O
to O
have O
been O
designed O
to O
work O
as O
Carbon O
system O
plugins O
as O
well O
- O
they O
require O
a O
specialized O
loader O
to O
start O
in O
victim O
systems O
that O
do O
not O
have O
the O
Carbon O
system O
deployed O
. O

Some O
modules O
have O
artifacts O
which O
indicate O
the O
Carbon O
system O
is O
already O
at O
version O
3.x O
, O
although O
the O
exact O
Carbon O
system O
version O
is O
very O
rarely O
seen O
in O
samples O
: O
The O
author O
of O
the O
Carbon O
module O
above O
can O
be O
also O
seen O
in O
the O
code O
, O
as O
'' O
gilg O
'' O
, O
which O
also O
authored O
several O
other O
Turla O
modules O
. O

We O
are O
planning O
to O
cover O
the O
Turla O
Carbon O
system O
with O
more O
details O
in O
a O
future O
report O
. O

The B-Entity
payload I-Entity
recovered O
from O
one O
of O
the O
mothership O
servers O
( O
at O
newsforum.servehttp O
[ O
. O

] O
com/wordpress/wp-includes/css/img/upload.php O
, O
MD5 O
: O
4dc22c1695d1f275c3b6e503a1b171f5 O
, O
Compiled O
: O
Thu O
Sep O
06 O
14:09:55 O
2012 O
) O
contains B-Action
two O
modules O
, O
a B-Entity
loader/injector I-Entity
and O
a B-Entity
backdoor I-Entity
. O

Internally O
, O
the O
backdoor O
is O
named O
'' O
Zagruzchick.dll O
'' O
: O
The O
word O
'' O
Zagruzchick O
'' O
means O
'' O
boot O
loader O
'' O
in O
Russian O
. O

The O
Control O
panel O
for O
the O
Epic O
motherships O
also O
sets O
the O
language O
to O
codepage O
'' O
1251 O
'' O
: O
Codepage O
1251 O
is O
commonly O
used O
to O
render O
Cyrillic O
characters O
. O

There O
are O
other O
indications O
that O
the O
attackers O
are O
not O
native O
English O
language O
speakers O
: O
The B-Entity
sample I-Entity
e9580b6b13822090db018c320e80865f I-Entity
that O
was B-Action
delivered I-Action
to B-Modifier
several B-Entity
Epic I-Entity
victims I-Entity
as B-Modifier
an B-Entity
upgraded I-Entity
backdoor I-Entity
, O
has O
the O
compilation O
code O
page O
language O
set O
to O
'' O
LANGRUSSIAN O
'' O
. O

The O
threat O
actor O
behind O
the O
'' O
Epic O
'' O
operation O
uses O
mainly O
hacked O
servers O
to O
host O
their O
proxies O
. O

The O
hacked O
servers O
are O
controlled O
through O
the O
use O
of O
a O
PHP O
webshell O
. O

This O
shell O
is O
password O
protected O
; O
the O
password O
is O
checked O
against O
an O
MD5 O
hash O
: O
The O
MD5 O
'' O
af3e8be26c63c4dd066935629cf9bac8 O
'' O
has O
been O
solved O
by O
Kaspersky O
Lab O
as O
the O
password O
'' O
kenpachi O
'' O
. O

In O
February O
2014 O
we O
observed O
the B-Entity
Miniduke I-Entity
threat I-Entity
actor I-Entity
using B-Action
the B-Entity
same I-Entity
backdoor I-Entity
on B-Modifier
their B-Entity
hacked I-Entity
servers I-Entity
, O
although O
using O
a O
much O
stronger O
password O
. O

Once O
again O
, O
it O
is O
also O
interesting O
to O
point O
out O
the O
usage O
of O
Codepage O
1251 O
in O
the O
webshell O
, O
which O
is O
used O
to O
render O
Cyrillic O
characters O
. O

There O
appears O
to O
be O
several O
links O
between O
Turla O
and O
Miniduke O
, O
but O
we O
will O
leave O
that O
for O
a O
future O
blogpost O
. O

On O
some O
of O
the O
C O
& O
C O
servers O
used O
in O
the O
Epic O
attacks O
, O
we O
were O
able O
to O
identify O
detailed B-Entity
victim I-Entity
statistics I-Entity
, O
which O
were B-Action
saved I-Action
for B-Modifier
debugging B-Entity
purposes I-Entity
by O
the B-Entity
attackers I-Entity
. O

This O
is O
the O
country O
distribution O
for O
the O
top O
20 O
affected O
countries O
by O
victim O
's O
IP O
: O
According O
to O
the O
public O
information O
available O
for O
the O
victims O
' O
IPs O
, O
targets O
of O
'' O
Epic O
'' O
belong O
to O
the O
following O
categories O
: O
When O
G-Data O
published O
their O
Turla O
paper O
, O
there O
were O
few O
details O
publicly O
available O
on O
how O
victims O
get O
infected O
with O
this O
malware O
campaign O
. O

Our O
analysis O
indicates O
this O
is O
a O
sophisticated O
multi-stage O
infection O
; O
which O
begins O
with O
Epic O
Turla O
. O

This B-Entity
is O
used O
to O
gain O
a O
foothold O
and O
validate B-Action
the B-Entity
high I-Entity
profile I-Entity
victim I-Entity
. O

If O
the O
victim O
is O
interesting O
, O
they B-Entity
get O
upgraded B-Action
to B-Modifier
the B-Entity
Turla I-Entity
Carbon I-Entity
system I-Entity
. O

Most O
recently O
, O
we O
observed O
this O
attack O
against O
a O
Kaspersky O
Lab O
user O
on O
August O
5 O
, O
2014 O
, O
indicating O
the O
operation O
remains O
fresh O
and O
ongoing O
. O

Note O
: O
A O
full O
analysis O
of O
the O
Epic O
attacks O
is O
available O
to O
the O
Kaspersky O
Intelligent O
Services O
customers O
. O

Contact O
: O
intelreports O
@ O
kaspersky.com O
We O
would O
like O
to O
add O
the O
following O
at O
the O
end O
of O
the O
blogpost O
, O
right O
before O
the O
detection O
names O
: O
If O
you O
'd O
like O
to O
read O
more O
about O
Turla/Uroburos O
, O
here O
's O
a O
few O
recommendations O
: O
After O
taking O
a O
look O
at O
recent O
Korplug O
( O
PlugX O
) O
detections O
, O
we O
identified O
two B-Entity
larger I-Entity
scale I-Entity
campaigns I-Entity
employing B-Action
this B-Entity
well-known I-Entity
Remote I-Entity
Access I-Entity
Trojan I-Entity
. O

This O
blog O
gives O
an O
overview O
of O
the O
first O
one O
, O
related O
to O
Afghanistan O
& O
Tajikistan O
. O

The O
other O
campaign O
, O
where O
the O
targets O
were O
a O
number O
of O
high-profile O
organizations O
in O
Russia O
, O
will O
be O
the O
subject O
of O
Anton O
Cherepanov O
's O
presentation O
at O
the O
ZeroNights O
security O
conference O
in O
Moscow O
this O
week O
. O

Sometimes O
malware O
used O
in O
various O
attacks O
is O
unique O
enough O
to O
identify O
related O
incidents O
, O
which O
makes O
tracking O
individual O
botnets O
simpler O
. O

An O
example O
is O
the O
BlackEnergy O
Lite O
variant O
( O
also O
known O
as O
BlackEnergy O
3 O
) O
used O
by O
a O
group O
of O
attackers O
( O
that O
was O
then O
given O
the O
name O
Quedagh O
, O
or O
Sandworm O
) O
against O
targets O
in O
Ukraine O
and O
other O
countries O
. O

BlackEnergy O
Lite O
is O
clearly O
distinguishable O
from O
the O
numerous O
binaries O
of O
the O
more O
common O
BlackEnergy O
2 O
also O
circulating O
in-the-wild O
. O

In O
other O
cases O
, O
attackers O
use O
more O
common O
tools O
for O
accomplishing O
their O
criminal O
goals O
. O

For O
example O
, O
the B-Entity
Korplug I-Entity
RAT I-Entity
( I-Entity
a.k.a I-Entity
.PlugX I-Entity
) I-Entity
is O
a O
well-known O
toolkit O
associated O
with O
Chinese O
APT O
groups O
and O
used B-Action
in B-Modifier
a B-Entity
large I-Entity
number I-Entity
of I-Entity
targeted I-Entity
attacks I-Entity
since B-Modifier
2012 B-Entity
. O

For O
the O
past O
several O
weeks O
we O
have O
taken O
a O
closer O
look O
at O
a O
great O
number O
of O
detections O
of O
this O
malware O
in O
many O
unrelated O
incidents O
. O

Among O
these O
, O
we O
were O
able O
to O
discover O
several O
successful O
infections O
where O
the B-Entity
employed I-Entity
Korplug I-Entity
samples I-Entity
were B-Action
connecting I-Action
to B-Modifier
the B-Entity
same I-Entity
C I-Entity
& I-Entity
C I-Entity
domain I-Entity
. O

Other B-Entity
Korplug I-Entity
samples I-Entity
were B-Action
connecting I-Action
to B-Modifier
a B-Entity
different I-Entity
domain I-Entity
name I-Entity
resolving I-Entity
to I-Entity
the I-Entity
same I-Entity
IPs I-Entity
as I-Entity
notebookhk.net I-Entity
: O
Taking O
these O
C O
& O
Cs O
as O
a O
starting O
point O
, O
we O
were O
able O
to O
locate O
a O
number O
of O
victims O
infected O
through O
various O
exploit-laden O
spear-phishing O
documents O
and O
cunningly-named O
archives O
. O

A O
table O
with O
a O
selection O
of O
RTF O
documents O
and O
RAR O
self-extracting O
archives O
with O
a O
.SCR O

extension O
is O
shown O
below O
: O
Some B-Entity
of I-Entity
the I-Entity
above-mentioned I-Entity
files I-Entity
also O
contained B-Action
decoy B-Entity
documents I-Entity
: O
In O
all O
of O
the O
cases O
, O
three B-Entity
binary I-Entity
files I-Entity
were B-Action
dropped I-Action
( O
apart O
from O
decoy O
documents O
) O
that O
led O
to O
the B-Entity
Korplug I-Entity
trojan I-Entity
being B-Action
loading I-Action
into B-Modifier
memory B-Entity
. O

The B-Entity
Korplug I-Entity
RAT I-Entity
is O
known O
to O
use B-Action
this B-Entity
side-loading I-Entity
trick I-Entity
by O
abusing O
legitimate O
digitally O
signed O
executables O
and O
is O
a O
way O
to O
stay B-Action
under B-Modifier
the B-Entity
radar I-Entity
, O
since O
a O
trusted O
application O
with O
a O
valid O
signature O
among O
startup O
items O
is O
less O
likely O
to O
raise O
suspicion O
. O

The B-Entity
maliciously I-Entity
crafted I-Entity
documents I-Entity
are O
RTF O
files O
that O
successfully O
exploit B-Action
the B-Entity
CVE-2012-0158 I-Entity
vulnerability I-Entity
in I-Entity
Microsoft I-Entity
Word I-Entity
. O

The O
image O
below O
shows O
the O
beginning O
of O
the O
CVE-2012-0158 O
shellcode O
in O
ASCII O
encoding O
within O
the O
document O
( O
the O
opcodes O
60 O
, O
55 O
, O
8bec O
disassemble O
to O
pusha O
; O
push O
ebp O
; O
mov O
ebp O
, O
esp O
) O
. O

Interestingly O
, O
though O
, O
the O
documents O
also O
contain O
the O
newer O
CVE-2014-1761 O
exploit O
that O
was O
extensively O
used O
in O
targeted O
attacks O
carried O
out O
by O
a O
number O
other O
malware O
families O
this O
year O
( O
including O
BlackEnergy O
, O
Sednit O
, O
MiniDuke O
, O
and O
others O
) O
. O

However O
, O
this O
exploit O
is O
not O
implemented O
correctly O
due O
to O
a O
wrong O
file O
offset O
in O
the O
1st O
stage O
shellcode O
. O

Below O
we O
see O
the O
disassembly O
of O
the O
1st O
stage O
shellcode O
where O
it O
checks O
the O
presence O
of O
the O
tag O
'' O
p O
! O
11 O
'' O
marking O
the O
beginning O
of O
the O
2nd O
stage O
shellcode O
and O
loads O
it O
into O
memory O
. O

Even O
though O
the O
tag O
and O
2nd O
stage O
shellcode O
is O
present O
in O
the O
RTF O
, O
it O
's O
at O
a O
different O
offset O
, O
and O
thus O
never O
is O
loaded O
. O

Sophos O
' O
Gabor O
Szappanos O
gives O
a O
possible O
explanation O
how O
these O
malformed O
samples O
may O
have O
come O
into O
existence O
. O

ESET O
LiveGrid O
telemetry O
indicates O
that O
the O
attacks O
against O
these O
targets O
have O
been O
going O
on O
since O
at O
least O
June O
2014 O
and O
continue O
through O
today O
. O

We O
were O
able O
to O
pinpoint O
the O
targets O
to O
residents O
of O
the O
following O
countries O
: O
From O
the O
topics O
of O
the O
files O
used O
to O
spread O
the O
malware O
, O
as O
well O
as O
from O
the O
affected O
targets O
, O
it O
appears O
that O
the O
attackers O
are O
interested O
in O
gathering O
intelligence O
related O
to O
Afghan O
, O
Tajik O
and O
Russian O
military O
and O
diplomatic O
subjects O
. O

Interestingly O
, O
most O
of O
the O
affected O
victims O
have O
another O
thing O
in O
common O
– O
a O
number O
of O
other O
RATs O
, O
file O
stealing O
trojans O
or O
keyloggers O
were O
detected O
on O
their O
systems O
on O
top O
of O
the O
Korplug O
RAT O
detection O
. O

One B-Entity
of I-Entity
these I-Entity
'alternative I-Entity
RATs I-Entity
' I-Entity
was B-Action
connecting I-Action
to B-Modifier
a B-Entity
domain I-Entity
also I-Entity
used I-Entity
by I-Entity
the I-Entity
Korplug I-Entity
samples I-Entity
. O

Since O
the O
functionality O
of O
these O
tools O
was O
partly O
overlapping O
with O
that O
of O
Korplug O
, O
it O
left O
us O
wondering O
whether O
the O
attackers O
were O
just O
experimenting O
with O
different O
RATs O
or O
were O
they O
supplementing O
some O
functionality O
that O
they O
were O
unable O
to O
accomplish O
. O

Additional O
information O
about O
two O
malware O
families O
that O
were O
most O
often O
found O
accompanying O
Korplug O
infections O
is O
given O
below O
. O

A O
curious O
Remote O
Access O
Trojan O
, O
as O
research O
points O
to O
a O
Chinese O
connection O
but O
the O
commands O
it O
listens O
to O
are O
in O
Spanish O
( O
translation O
in O
English O
) O
: O
The B-Entity
malware I-Entity
can O
manage B-Action
processes B-Entity
and I-Entity
services I-Entity
on I-Entity
the I-Entity
infected I-Entity
machine I-Entity
, O
transfer B-Action
files B-Entity
to B-Modifier
and O
from B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
run B-Action
shell B-Entity
commands I-Entity
, O
and O
so O
on O
. O

It B-Entity
is O
written O
in O
Delphi O
and O
connects B-Action
to B-Modifier
www.dicemention.com B-Entity
. O

Some O
samples O
contain O
a O
digital O
signature O
by O
'' O
Nanning O
weiwu O
Technology O
co. O
, O
ltd O
'' O
. O

This B-Entity
malware I-Entity
, O
written O
in O
C O
, O
and O
contains O
several O
functions O
for O
harvesting B-Action
files B-Entity
off B-Modifier
the B-Entity
victim I-Entity
's I-Entity
hard I-Entity
drive I-Entity
according B-Modifier
to I-Modifier
criteria B-Entity
set I-Entity
in I-Entity
the I-Entity
configuration I-Entity
file I-Entity
. O

Apart O
from O
doing B-Action
a B-Entity
recursive I-Entity
sweep I-Entity
of I-Entity
all I-Entity
logical I-Entity
fixed I-Entity
and I-Entity
remote I-Entity
drives I-Entity
, O
it B-Entity
also O
continually O
monitors B-Action
any O
attached B-Entity
removable I-Entity
media I-Entity
or O
network B-Entity
shares I-Entity
by B-Modifier
listening B-Entity
to I-Entity
DBTDEVICEARRIVAL I-Entity
events I-Entity
. O

In O
addition O
to O
collecting B-Action
files B-Entity
, O
the B-Entity
malware I-Entity
attempts O
to O
gather B-Action
saved B-Entity
passwords I-Entity
, O
history B-Entity
of I-Entity
visited I-Entity
URLs I-Entity
, O
account B-Entity
information I-Entity
and O
proxy B-Entity
information I-Entity
from B-Modifier
the B-Entity
following I-Entity
applications I-Entity
: O
The O
C O
& O
C O
domains O
used O
by O
this O
malware O
are O
: O
Some B-Entity
samples I-Entity
of I-Entity
this I-Entity
file I-Entity
stealer I-Entity
detected B-Action
in B-Modifier
these B-Entity
campaigns I-Entity
also O
contain O
the O
signature O
by O
'' O
Nanning O
weiwu O
Technology O
co. O
, O
ltd O
'' O
– O
another O
indicator O
that O
the O
infections O
are O
related O
. O

A O
few O
days O
ago O
we O
detected O
a O
watering O
hole O
campaign O
in O
a O
website O
owned O
by O
one O
big O
industrial O
company O
. O

The O
website O
is O
related O
to O
software O
used O
for O
simulation O
and O
system O
engineering O
in O
a O
wide O
range O
of O
industries O
, O
including O
automotive O
, O
aerospace O
, O
and O
manufacturing O
. O

The B-Entity
attackers I-Entity
were O
able O
to O
compromise B-Action
the B-Entity
website I-Entity
and O
include O
code B-Entity
that O
loaded B-Action
a B-Entity
malicious I-Entity
Javascript I-Entity
file I-Entity
from B-Modifier
a B-Entity
remote I-Entity
server I-Entity
. O

This B-Entity
Javascript I-Entity
file I-Entity
is B-Action
a B-Entity
framework I-Entity
for I-Entity
reconnaissance I-Entity
that O
the O
attackers O
call O
'' O
Scanbox O
'' O
and O
includes O
some O
of O
the O
techniques O
we O
described O
in O
a O
previous O
blog O
post O
: O
The B-Entity
Scanbox I-Entity
framework I-Entity
first O
configures B-Action
the B-Entity
remote I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
that I-Entity
it I-Entity
will I-Entity
use I-Entity
and O
collects B-Action
a B-Entity
small I-Entity
amount I-Entity
of I-Entity
information I-Entity
about B-Modifier
the B-Entity
victim I-Entity
that I-Entity
is I-Entity
visiting I-Entity
the I-Entity
compromised I-Entity
website I-Entity
including O
: O
Resulting O
in O
something O
like O
this O
: O
Before O
sending B-Action
the B-Entity
information I-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
Scanbox B-Entity
encodes B-Action
and O
encrypts B-Action
the B-Entity
data I-Entity
with B-Modifier
the B-Entity
following I-Entity
function I-Entity
: O
Producing O
the O
following O
request O
: O
If O
we O
decrypt O
the O
data O
it O
translates O
to O
: O
After O
the O
first O
request O
, O
the B-Entity
framework I-Entity
contains O
several O
plugins O
to O
extract B-Action
different B-Entity
information I-Entity
from B-Modifier
the B-Entity
victim I-Entity
. O

While O
the O
user O
is O
browsing O
the O
compromised O
website O
, O
all B-Entity
keystrokes I-Entity
are O
being B-Action
recorded I-Action
and O
sent B-Action
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
periodically B-Entity
. O

It B-Entity
will O
also O
send B-Action
keystrokes B-Entity
when B-Modifier
the B-Entity
user I-Entity
submits I-Entity
web I-Entity
forms I-Entity
that I-Entity
can I-Entity
potentially I-Entity
include I-Entity
passwords I-Entity
and I-Entity
other I-Entity
sensitive I-Entity
data I-Entity
. O

As O
we O
have O
seen O
, O
this O
is O
a O
very O
powerful O
framework O
that O
gives O
attackers O
a O
lot O
of O
insight O
into O
the O
potential O
targets O
that O
will O
help O
them O
launching O
future O
attacks O
against O
them O
. O

We O
have O
also O
seen O
several O
Metasploit-produced O
exploits O
that O
target O
different O
versions O
of O
Java O
in O
the O
same O
IP O
address O
that O
hosts O
the O
Scanbox O
framework O
( O
122.10.9 O
[ O
. O

] O
109 O
) O
. O

We O
recommend O
you O
look O
for O
this O
type O
of O
activity O
against O
the O
following O
machines O
in O
your O
network O
: O
A O
personal O
note O
from O
Cylance O
, O
CEO O
Stuart O
McClure O
On O
February O
24 O
, O
1989 O
, O
United O
Flight O
811 O
left O
Honolulu O
, O
Hawaii O
, O
on O
its O
way O
to O
Auckland O
, O
New O
Zealand O
, O
with O
364 O
souls O
on O
board O
. O

Somewhere O
between O
23,000 O
and O
24,000 O
feet O
an O
enormous O
explosion O
ejected O
nine O
passengers O
into O
the O
dark O
void O
over O
the O
Pacific O
Ocean O
. O

This O
aviation O
disaster O
was O
later O
determined O
to O
have O
been O
caused O
by O
a O
simple O
design O
flaw O
combined O
with O
the O
lack O
of O
corrective O
action O
. O

Boeing O
and O
the O
FAA O
had O
known O
about O
this O
problem O
for O
over O
one O
year O
prior O
to O
the O
accident O
. O

The O
result O
: O
nine O
people O
lost O
their O
lives O
. O

The O
other O
337 O
passengers O
plus O
18 O
crew O
members O
who O
survived O
, O
live O
with O
the O
memory O
every O
day O
; O
all O
of O
it O
due O
to O
a O
highly O
preventable O
design O
flaw O
. O

As O
a O
19-year-old O
young O
adult O
, O
I O
was O
grateful O
to O
have O
survived O
but O
I O
had O
no O
idea O
how O
that O
single O
event O
would O
impact O
my O
future O
in O
such O
a O
profound O
way O
. O

Much O
of O
my O
passion O
for O
cybersecurity O
can O
be O
directly O
attributed O
to O
that O
fateful O
day O
. O

The O
United O
Flight O
811 O
accident O
proves O
just O
how O
important O
it O
is O
to O
detect O
flaws O
before O
tragedy O
strikes O
. O

Preventable O
disasters O
like O
this O
are O
what O
motivates O
the O
Cylance O
team O
to O
create O
a O
safer O
world O
. O

We O
do O
everything O
we O
can O
to O
uncover O
the O
flaws O
in O
technologies O
before O
they O
damage O
the O
physical O
or O
cyber O
world O
. O

Our O
mission O
is O
simple O
: O
to O
protect O
the O
world O
. O

This O
report O
is O
an O
attempt O
to O
deliver O
on O
that O
mission O
. O

After O
tracking O
hackers O
both O
personally O
and O
professionally O
for O
more O
than O
26 O
years O
, O
there O
is O
no O
doubt O
in O
my O
mind O
that O
the O
release O
of O
the O
information O
contained O
in O
the O
Operation O
Cleaver O
report O
is O
vital O
to O
the O
security O
of O
the O
world's O
critical O
infrastructure O
. O

The O
focus O
of O
the O
Operation O
Cleaver O
report O
is O
on O
one O
particular O
Iranian O
team O
we O
've O
dubbed O
Tarh O
Andishan O
, O
the O
infrastructure O
they O
utilize O
, O
as O
well O
as O
their O
tactics O
, O
techniques O
and O
procedures O
. O

Roughly O
translated O
, O
'' O
Tarh O
Andishan O
'' O
means O
'' O
thinkers O
'' O
or O
'' O
innovators O
'' O
. O

This O
team O
displays O
an O
evolved O
skillset O
and O
uses O
a O
complex O
infrastructure O
to O
perform O
attacks O
of O
espionage O
, O
theft O
, O
and O
the O
potential O
destruction O
of O
control O
systems O
and O
networks O
. O

While O
our O
investigation O
is O
ongoing O
, O
and O
we O
presently O
have O
limited O
visibility O
inside O
many O
of O
the O
compromised O
networks O
, O
Cylance O
observed O
Tarh O
Andishan O
actively O
targeting O
, O
attacking O
, O
and O
compromising O
more O
than O
50 O
victims O
since O
at O
least O
2012 O
. O

Cylance O
is O
committed O
to O
responsible O
disclosure O
and O
has O
refrained O
from O
exaggeration O
and O
embellishment O
in O
this O
report O
, O
limiting O
our O
content O
to O
only O
that O
which O
can O
be O
definitively O
confirmed O
. O

However O
, O
we O
have O
speculated O
on O
the O
possible O
motivations O
behind O
these O
attacks O
, O
given O
our O
deep O
knowledge O
and O
understanding O
of O
the O
cyber O
landscape O
. O

We O
have O
made O
every O
effort O
to O
notify O
all O
affected O
entities O
prior O
to O
publishing O
this O
report O
. O

Additionally O
, O
all O
personally O
identifiable O
information O
about O
the O
members O
of O
Operation O
Cleaver O
has O
been O
withheld O
. O

We O
do O
n't O
care O
who O
the O
adversary O
is O
, O
where O
they O
work O
or O
reside O
, O
who O
they O
're O
dating O
or O
what O
party O
photos O
they O
upload O
to O
Facebook O
– O
all O
we O
care O
about O
is O
preventing O
campaigns O
like O
Operation O
Cleaver O
from O
negatively O
affecting O
the O
real O
world O
. O

This O
report O
is O
for O
the O
world O
's O
cyber O
defenders O
– O
never O
give O
up O
! O
Since O
at O
least O
2012 O
, O
Iranian B-Entity
actors I-Entity
have O
directly O
attacked O
, O
established B-Action
persistence B-Entity
in B-Modifier
, O
and O
extracted B-Action
highly B-Entity
sensitive I-Entity
materials I-Entity
from B-Modifier
the B-Entity
networks I-Entity
of I-Entity
government I-Entity
agencies I-Entity
and I-Entity
major I-Entity
critical I-Entity
infrastructure I-Entity
companies I-Entity
in I-Entity
the I-Entity
following I-Entity
countries I-Entity
: I-Entity
Canada I-Entity
, I-Entity
China I-Entity
, I-Entity
England I-Entity
, I-Entity
France I-Entity
, I-Entity
Germany I-Entity
, I-Entity
India I-Entity
, I-Entity
Israel I-Entity
, I-Entity
Kuwait I-Entity
, I-Entity
Mexico I-Entity
, I-Entity
Pakistan I-Entity
, I-Entity
Qatar I-Entity
, I-Entity
Saudi I-Entity
Arabia I-Entity
, I-Entity
South I-Entity
Korea I-Entity
, I-Entity
Turkey I-Entity
, I-Entity
United I-Entity
Arab I-Entity
Emirates I-Entity
, I-Entity
and I-Entity
the I-Entity
United I-Entity
States I-Entity
. O

Iran O
is O
the O
new O
China O
. O

Operation B-Entity
Cleaver I-Entity
has O
, O
over O
the O
past O
several O
years O
, O
conducted B-Action
a B-Entity
significant I-Entity
global I-Entity
surveillance I-Entity
and I-Entity
infiltration I-Entity
campaign I-Entity
. O

To O
date O
it B-Entity
has O
successfully O
evaded B-Action
detection B-Entity
by I-Entity
existing I-Entity
security I-Entity
technologies I-Entity
. O

The O
group O
is O
believed O
to O
work O
from O
Tehran O
, O
Iran O
, O
although O
auxiliary O
team O
members O
were O
identified O
in O
other O
locations O
including O
the O
Netherlands O
, O
Canada O
, O
and O
the O
UK O
. O

The O
group O
successfully O
leveraged O
both O
publicly O
available O
, O
and O
customized O
tools O
to O
attack O
and O
compromise O
targets O
around O
the O
globe O
. O

The O
targets O
include O
military O
, O
oil O
and O
gas O
, O
energy O
and O
utilities O
, O
transportation O
, O
airlines O
, O
airports O
, O
hospitals O
, O
telecommunications O
, O
technology O
, O
education O
, O
aerospace O
, O
Defense O
Industrial O
Base O
( O
DIB O
) O
, O
chemical O
companies O
, O
and O
governments O
. O

During O
intense O
intelligence O
gathering O
over O
the O
last O
24 O
months O
, O
we O
observed O
the O
technical O
capabilities O
of O
the O
Operation O
Cleaver O
team O
rapidly O
evolve O
faster O
than O
any O
previously O
observed O
Iranian O
effort O
. O

As O
Iran O
's O
cyber O
warfare O
capabilities O
continue O
to O
morph O
, O
the O
probability O
of O
an O
attack O
that O
could O
impact O
the O
physical O
world O
at O
a O
national O
or O
global O
level O
is O
rapidly O
increasing O
. O

Their O
capabilities O
have O
advanced O
beyond O
simple O
website O
defacements O
, O
Distributed O
Denial O
of O
Service O
( O
DDoS O
) O
attacks O
, O
and O
Hacking O
Exposed O
style O
techniques O
. O

With O
minimal O
separation O
between O
private O
companies O
and O
the O
Iranian O
government O
, O
their O
modus O
operandi O
seems O
clear O
: O
blur O
the O
line O
between O
legitimate O
engineering O
companies O
and O
state- O
sponsored O
cyber O
hacking O
teams O
to O
establish O
a O
foothold O
in O
the O
world O
's O
critical O
infrastructure O
. O

Iran O
's O
rising O
expertise O
, O
along O
with O
their O
choice O
of O
victims O
, O
has O
compelled O
us O
to O
release O
this O
report O
sooner O
than O
we O
would O
have O
liked O
in O
order O
to O
expose O
Operation O
Cleaver O
to O
the O
world O
. O

The O
evidence O
and O
indicators O
of O
compromise O
we O
provide O
in O
this O
report O
will O
allow O
potentially O
unaware O
victims O
to O
detect O
and O
eliminate O
Cleaver O
's O
incursions O
into O
their O
networks O
. O

Iran O
has O
been O
severely O
impacted O
by O
debilitating O
and O
extremely O
advanced O
malware O
campaigns O
since O
at O
least O
2009 O
. O

Famous B-Entity
examples I-Entity
of I-Entity
these I-Entity
efforts I-Entity
include B-Action
industrial B-Entity
sabotage I-Entity
via B-Modifier
Stuxnet B-Entity
( I-Entity
2009 I-Entity
- I-Entity
2010 I-Entity
) I-Entity
, O
and O
espionage B-Entity
with B-Modifier
Duqu B-Entity
( I-Entity
2009 I-Entity
- I-Entity
2011 I-Entity
) I-Entity
as I-Entity
well I-Entity
as I-Entity
Flame I-Entity
( I-Entity
2012 I-Entity
) I-Entity
. O

These O
campaigns O
have O
targeted O
Iran's O
nuclear O
program O
, O
and O
oil O
and O
gas O
operations O
. O

Stuxnet B-Entity
was O
an O
eye-opening O
event O
for O
Iranian O
authorities O
, O
exposing B-Action
them B-Entity
to B-Modifier
the B-Entity
world I-Entity
of I-Entity
physical I-Entity
destruction I-Entity
via I-Entity
electronic I-Entity
means I-Entity
. O

Hacking O
campaigns O
sourced O
out O
of O
Iran O
are O
nothing O
new O
. O

Since O
the O
early O
2000 O
's O
, O
the O
information O
security O
industry O
as O
a O
whole O
has O
tracked O
teams O
like O
the O
Iranian O
Cyber O
Army O
, O
which O
mainly O
focuses O
on O
patriotic O
hacking O
( O
website O
defacements O
) O
. O

After O
the O
release O
of O
Stuxnet O
, O
Iran O
's O
motivations O
appear O
to O
have O
shifted O
. O

Retaliation O
for O
Stuxnet O
began O
almost O
immediately O
in O
2011 O
with O
campaigns O
like O
the O
certificate O
compromises O
of O
Comodo O
and O
DigiNotar O
. O

These O
attacks O
served O
as O
a O
warning O
, O
showcasing O
the O
rapid O
evolution O
of O
Iran O
's O
hacking O
skills O
. O

A O
major O
retaliation O
came O
in O
the O
form O
of O
2012 O
's O
Shamoon O
campaign O
, O
which O
impacted O
RasGas O
and O
Saudi O
Aramco O
. O

It O
's O
estimated O
that O
Shamoon O
impacted O
over O
30,000 O
computer O
endpoints O
and O
cost O
the O
affected O
companies O
tens-of-thousands O
of O
hours O
recovering O
from O
the O
attacks O
. O

The O
direct O
financial O
impact O
from O
this O
retaliation O
and O
amount O
of O
downtime O
experienced O
were O
staggering O
. O

Shamoon O
was O
truly O
a O
watershed O
event O
for O
security O
defenders O
. O

It O
was O
the O
first O
glimpse O
into O
the O
real O
capabillity O
and O
intention O
of O
Iranian O
cyber O
operations O
. O

We O
see O
the O
same O
motivation O
and O
intent O
here O
in O
Operation O
Cleaver O
: O
establishing O
a O
beachhead O
for O
cyber O
sabotage O
. O

We O
saw O
further O
Iranian O
backlash O
in O
late O
2012 O
and O
early O
2013 O
in O
the O
form O
of O
Operation O
Ababil's O
Distributed O
Denial O
of O
Service O
( O
DDoS O
) O
attacks O
against O
US O
banks O
. O

These B-Entity
attacks I-Entity
were O
debilitating O
and O
impacted B-Action
the B-Entity
availability I-Entity
of I-Entity
online I-Entity
banking I-Entity
services I-Entity
. O

Yet O
more O
backlash O
was O
witnessed O
with O
FireEye's O
exposure O
of O
Operation O
Saffron O
Rose O
, O
an O
espionage O
campaign O
executed O
by O
the O
Ajax O
Security O
Team O
in O
2014 O
. O

In O
May O
2014 O
, O
evidence O
emerged O
of O
a B-Entity
highly I-Entity
targeted I-Entity
waterhole I-Entity
attack I-Entity
that O
leveraged B-Action
social B-Entity
media I-Entity
, O
dubbed O
Operation O
Newscaster O
, O
which O
was O
uncovered O
by O
iSight O
Partners O
. O

In O
June O
2013 O
, O
Israeli O
Prime O
Minister O
Benjamin O
Netanyahu O
accused O
Iran O
of O
carrying O
out O
'' O
non-stop O
'' O
attacks O
on O
'' O
[ O
Israel O
's O
] O
vital O
national O
systems O
'' O
including O
'' O
water O
, O
power O
and O
banking O
'' O
. O

The O
following O
September O
of O
2013 O
, O
the O
Wall O
Street O
Journal O
accused O
Iran O
of O
hacking O
into O
unclassified O
U.S. O
Navy O
computers O
in O
San O
Diego O
's O
NMCI O
( O
Navy O
Marine O
Corp O
Intranet O
) O
,5 O
which O
we O
can O
confirm O
was O
part O
of O
Operation O
Cleaver O
. O

While O
previously O
reported O
operations O
attributed O
to O
Iran O
have O
largely O
focused O
on O
Defense O
Industrial O
Base O
( O
DIB O
) O
companies O
, O
the O
United O
States O
Federal O
Government O
, O
or O
targets O
in O
Middle O
Eastern O
countries O
, O
Operation O
Cleaver O
has O
instead O
focused O
on O
a O
wide O
array O
of O
targets O
, O
including O
energy O
producers O
and O
utilities O
, O
commercial O
airlines O
and O
airports O
, O
military O
intelligence O
, O
aerospace O
, O
hospitals O
, O
and O
even O
universities O
– O
with O
only O
ten O
of O
the O
targets O
based O
in O
the O
United O
States O
. O

Such O
broad O
targeting O
demonstrates O
to O
the O
world O
that O
Iran O
is O
no O
longer O
content O
to O
retaliate O
against O
the O
US O
and O
Israel O
alone O
. O

They O
have O
bigger O
intentions O
: O
to O
position O
themselves O
to O
impact O
critical O
infrastructure O
globally O
. O

The O
string O
cleaver O
is O
found O
several O
times O
in O
a O
variety O
of O
custom O
software O
used O
in O
Operation O
Cleaver O
, O
including O
: O
We O
believe O
our O
visibility O
into O
this O
campaign O
represents O
only O
a O
fraction O
of O
Operation O
Cleaver O
's O
full O
scope O
. O

We O
believe O
that O
if O
the O
operation O
is O
left O
to O
continue O
unabated O
, O
it O
is O
only O
a O
matter O
of O
time O
before O
the O
world O
's O
physical O
safety O
is O
impacted O
by O
it O
. O

While O
the O
disclosure O
of O
this O
information O
will O
be O
a O
detriment O
to O
our O
ability O
to O
track O
the O
activity O
of O
this O
group O
, O
it O
will O
allow O
the O
security O
industry O
as O
a O
whole O
to O
defend O
against O
this O
threat O
. O

As O
such O
, O
we O
are O
exposing O
this O
cyber O
campaign O
early O
in O
an O
attempt O
to O
minimize O
additional O
real-world O
impact O
and O
prevent O
further O
victimization O
. O

• O
Persian O
hacker O
names O
are O
used O
throughout O
the O
campaign O
including O
: O
Salman O
Ghazikhani O
, O
Bahman O
Mohebbi O
, O
Kaj O
, O
Parviz O
, O
Alireza O
, O
and O
numerous O
others O
. O

• O
Numerous O
domains O
used O
in O
the O
campaign O
were O
registered O
in O
Iran O
. O

• O
Infrastructure O
leveraged O
in O
the O
attack O
was O
registered O
in O
Iran O
to O
the O
corporate O
entity O
Tarh O
Andishan O
, O
which O
translates O
to O
'' O
invention O
'' O
or O
'' O
innovation O
'' O
in O
Farsi O
. O

• O
Source O
netblocks O
and O
ASNs O
are O
registered O
to O
Iran O
. O

• O
Hacker O
tools O
warn O
when O
their O
external O
IP O
address O
traces O
back O
to O
Iran O
. O

• O
The O
infrastructure O
is O
hosted O
through O
Netafraz.com O
, O
an O
Iranian O
provider O
out O
of O
Isfahan O
, O
Iran O
. O

• O
The O
infrastructure O
utilized O
in O
the O
campaign O
is O
too O
significant O
to O
be O
a O
lone O
individual O
or O
a O
small O
group O
. O

We O
believe O
this O
work O
was O
sponsored O
by O
Iran O
. O

• O
US O
Military O
targets O
including O
NMCI O
in O
October O
2013 O
. O

Confirmed O
targeting O
of O
global O
government O
entities O
. O

• O
Networks O
and O
systems O
targeted O
in O
critical O
industries O
like O
energy O
and O
utilities O
, O
oil O
and O
gas O
, O
and O
chemical O
companies O
. O

• O
Assets B-Entity
( I-Entity
both I-Entity
cyber I-Entity
and I-Entity
physical I-Entity
) I-Entity
and I-Entity
logistics I-Entity
information I-Entity
were B-Action
compromised I-Action
at B-Modifier
major B-Entity
airline I-Entity
operators I-Entity
, I-Entity
airports I-Entity
, I-Entity
and I-Entity
transportation I-Entity
companies I-Entity
. O

• O
Various O
global O
telecommunications O
, O
technology O
, O
healthcare O
, O
aerospace O
, O
and O
defense O
companies O
were O
breached O
as O
part O
of O
the O
operation O
. O

• O
Confidential B-Entity
critical I-Entity
infrastructure I-Entity
documents I-Entity
were B-Action
harvested I-Action
from B-Modifier
major B-Entity
educational I-Entity
institutions I-Entity
around I-Entity
the I-Entity
world I-Entity
. O

• O
Initial B-Entity
compromise I-Entity
techniques I-Entity
include B-Action
SQL B-Entity
injection I-Entity
, I-Entity
web I-Entity
attacks I-Entity
, I-Entity
and I-Entity
creative I-Entity
deception- I-Entity
based I-Entity
attacks I-Entity
– O
all O
of O
which O
have O
been O
implemented O
in O
the O
past O
by O
Chinese O
and O
Russian O
hacking O
teams O
. O

• O
Pivoting B-Entity
and I-Entity
exploitation I-Entity
techniques I-Entity
leveraged B-Action
existing B-Entity
public I-Entity
exploits I-Entity
for I-Entity
MS08-067 I-Entity
and I-Entity
Windows I-Entity
privilege I-Entity
escalations I-Entity
, O
and O
were B-Action
coupled I-Action
with B-Modifier
automated B-Entity
, I-Entity
worm-like I-Entity
propagation I-Entity
mechanisms I-Entity
. O

• O
Customized B-Entity
private I-Entity
tools I-Entity
with I-Entity
functions I-Entity
that O
include B-Action
ARP B-Entity
poisoning I-Entity
, O
encryption B-Entity
, O
credential B-Entity
dumping I-Entity
, O
ASP.NET B-Entity
shells I-Entity
, O
web B-Entity
backdoors I-Entity
, O
process B-Entity
enumeration I-Entity
, O
WMI B-Entity
querying I-Entity
, O
HTTP B-Entity
and I-Entity
SMB I-Entity
communications I-Entity
, O
network B-Entity
interface I-Entity
sniffing I-Entity
, O
and O
keystroke B-Entity
logging I-Entity
. O

• O
The O
ability O
to O
build O
customized O
tools O
to O
compromise O
any O
target O
they O
choose O
. O

• O
Private B-Entity
signing I-Entity
certificates I-Entity
of I-Entity
one I-Entity
victim I-Entity
were B-Action
captured I-Action
allowing O
the B-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
to O
compromise B-Action
the B-Entity
entirety I-Entity
of I-Entity
their I-Entity
organization I-Entity
. O

• O
Over O
the O
past O
two O
years O
, O
Cylance O
has O
collected O
over O
8GB O
of O
data O
including O
over O
80,000 O
files O
of O
exfiltrated O
data O
, O
hacker O
tools O
, O
victim O
logs O
, O
and O
highly O
sensitive O
reconnaissance O
data O
. O

• O
Data O
from O
sinkholed O
command O
and O
control O
servers O
has O
allowed O
us O
to O
track O
this O
active O
campaign O
. O

• O
Cylance O
is O
releasing O
more O
than O
150 O
IOCs O
and O
samples O
associated O
with O
the O
Cleaver O
campaign O
to O
empower O
the O
security O
community O
to O
detect O
existing O
compromises O
in O
their O
own O
organizations O
, O
as O
well O
as O
potentially O
block O
future O
attacks O
from O
these O
teams O
. O

• O
This O
campaign O
continues O
Iran O
's O
retaliation O
for O
Stuxnet O
, O
Duqu O
, O
and O
Flame O
. O

• O
This O
is O
a O
state-sponsored O
campaign O
. O

• O
There O
is O
a O
possibility O
that O
this O
campaign O
could O
affect O
airline O
passenger O
safety O
. O

• O
This O
campaign O
's O
intentions O
may O
be O
to O
damage O
Industrial O
Control O
Systems O
( O
ICS O
) O
, O
Supervisory O
Control O
and O
Data O
Acquisition O
( O
SCADA O
) O
systems O
, O
and O
impact O
Critical O
Infrastructure O
and O
Key O
Resources O
( O
CIKR O
) O
. O

• O
This O
campaign O
could O
be O
a O
way O
to O
demonstrate O
Iran O
's O
cyber O
capabilities O
for O
additional O
geopolitical O
leverage O
, O
due O
to O
the O
breadth O
and O
depth O
of O
their O
global O
targets O
. O

• O
There O
is O
an O
intense O
focus O
on O
CIKR O
companies O
in O
South O
Korea O
, O
which O
could O
give O
Iran O
additional O
clout O
in O
their O
burgeoning O
partnership O
with O
North O
Korea O
. O

In O
September O
2012 O
, O
Iran O
signed O
an O
extensive O
agreement O
for O
technology O
cooperation O
agreement O
with O
North O
Korea O
, O
which O
would O
allow O
for O
collaboration O
on O
various O
efforts O
including O
IT O
and O
security O
. O

• O
Iran O
is O
recruiting O
from O
within O
the O
universities O
and O
potentially O
using O
'hackers O
for O
hire O
' O
. O

The O
Cleaver O
team O
targets O
some O
of O
the O
most O
sensitive O
global O
critical O
infrastructure O
companies O
in O
the O
world O
, O
including O
military O
, O
oil O
and O
gas O
, O
airlines O
, O
airports O
, O
energy O
producers O
, O
utilities O
, O
transportation O
, O
healthcare O
, O
telecommunications O
, O
technology O
, O
manufacturing O
, O
education O
, O
aerospace O
, O
Defense O
Industrial O
Base O
( O
DIB O
) O
, O
chemical O
companies O
and O
governments O
. O

Countries O
impacted O
include O
Canada O
, O
China O
, O
England O
, O
France O
, O
Germany O
, O
India O
, O
Israel O
, O
Kuwait O
, O
Mexico O
, O
Pakistan O
, O
Qatar O
, O
Saudi O
Arabia O
, O
South O
Korea O
, O
Turkey O
, O
United O
Arab O
Emirates O
, O
and O
the O
US O
. O

The O
following O
is O
a O
breakdown O
by O
country O
of O
which O
industries O
were O
targeted O
and/or O
victimized O
: O
Cleaver B-Entity
's I-Entity
level I-Entity
of I-Entity
access I-Entity
into I-Entity
each I-Entity
organization I-Entity
varied O
greatly O
, O
including B-Action
completely B-Entity
compromised I-Entity
systems I-Entity
and I-Entity
networks I-Entity
, O
Active B-Entity
Directory I-Entity
domain I-Entity
controllers I-Entity
and I-Entity
credentials I-Entity
, O
compromised B-Entity
data I-Entity
repositories I-Entity
and O
stolen B-Entity
VPN I-Entity
credentials I-Entity
. O

Compromised B-Entity
systems I-Entity
include B-Action
Microsoft B-Entity
Windows I-Entity
web I-Entity
servers I-Entity
running I-Entity
IIS I-Entity
and I-Entity
ColdFusion I-Entity
, I-Entity
Apache I-Entity
with I-Entity
PHP I-Entity
, I-Entity
many I-Entity
variants I-Entity
of I-Entity
Microsoft I-Entity
Windows I-Entity
desktops I-Entity
and I-Entity
servers I-Entity
, I-Entity
and I-Entity
Linux I-Entity
servers I-Entity
. O

Compromised B-Entity
network I-Entity
infrastructure I-Entity
included B-Action
Cisco B-Entity
VPNs I-Entity
as I-Entity
well I-Entity
as I-Entity
Cisco I-Entity
switches I-Entity
and I-Entity
routers I-Entity
. O

Unlike O
Stuxnet O
, O
no O
exotic O
exploitations O
( O
such O
as O
0-days O
) O
were O
observed O
. O

Within O
our O
investigation O
, O
we O
had O
no O
direct O
evidence O
of O
a O
successful O
compromise O
of O
specific O
Industrial O
Control O
Systems O
( O
ICS O
) O
or O
Supervisory O
Control O
and O
Data O
Acquisition O
( O
SCADA O
) O
networks O
, O
but O
Cleaver B-Entity
did O
exfiltrate B-Action
extremely B-Entity
sensitive I-Entity
data I-Entity
from B-Modifier
many B-Entity
critical I-Entity
infrastructure I-Entity
companies I-Entity
allowing O
them O
to O
directly O
affect O
the O
systems O
they O
run O
. O

This O
data O
could O
enable O
them B-Entity
, I-Entity
or I-Entity
affiliated I-Entity
organizations I-Entity
, O
to O
target B-Action
and I-Action
potentially I-Action
sabotage I-Action
ICS B-Entity
and I-Entity
SCADA I-Entity
environments I-Entity
with B-Modifier
ease B-Entity
. O

We O
discovered O
over O
50 O
victims O
in O
our O
investigation O
, O
distributed O
around O
the O
globe O
. O

Ten O
of O
these O
victims O
are O
headquartered O
in O
the O
US O
and O
include O
a O
major O
airline O
, O
a O
medical O
university O
, O
an O
energy O
company O
specializing O
in O
natural O
gas O
production O
, O
an O
automobile O
manufacturer O
, O
a O
large O
defense O
contractor O
, O
and O
a O
major O
military O
installation O
. O

The O
four O
targets O
in O
Israel O
and O
the O
five O
targets O
in O
Pakistan O
are O
comprised O
of O
education O
, O
aerospace O
, O
airports O
, O
airlines O
, O
healthcare O
and O
technology O
. O

Further O
victims O
were O
identified O
in O
numerous O
Middle O
Eastern O
countries O
as O
well O
as O
ones O
in O
Northern O
Europe O
including O
the O
UK O
, O
France O
, O
and O
Germany O
. O

Central O
America O
was O
not O
immune O
either O
with O
a O
large O
oil O
and O
gas O
company O
on O
the O
list O
. O

In O
fact O
, O
oil O
and O
gas O
was O
a O
particular O
focal O
point O
for O
the O
Cleaver O
team O
, O
going O
after O
no O
less O
than O
nine O
of O
these O
companies O
around O
the O
world O
. O

Universities O
were O
targeted O
in O
the O
US O
, O
India O
, O
Israel O
, O
and O
South O
Korea O
. O

The B-Entity
attackers I-Entity
targeted B-Action
research B-Entity
efforts I-Entity
, I-Entity
student I-Entity
information I-Entity
, I-Entity
student I-Entity
housing I-Entity
, I-Entity
and I-Entity
financial I-Entity
aid I-Entity
systems I-Entity
. O

They O
had O
a O
penchant O
for O
pictures O
, O
passports O
, O
and O
any O
specifc O
identifying O
information O
. O

Perhaps O
the O
most O
bone-chilling O
evidence O
we O
collected O
in O
this O
campaign O
was O
the O
targeting O
and O
compromise O
of O
transportation O
networks O
and O
systems O
such O
as O
airlines O
and O
airports O
in O
South O
Korea O
, O
Saudi O
Arabia O
and O
Pakistan O
. O

The O
level O
of O
access O
seemed O
ubiquitous O
: O
Active B-Entity
Directory I-Entity
domains I-Entity
were B-Action
fully I-Action
compromised I-Action
, O
along B-Modifier
with I-Modifier
entire B-Entity
Cisco I-Entity
Edge I-Entity
switches I-Entity
, I-Entity
routers I-Entity
, I-Entity
and I-Entity
internal I-Entity
networking I-Entity
infrastructure I-Entity
. O

Fully B-Entity
compromised I-Entity
VPN I-Entity
credentials I-Entity
meant B-Action
their B-Entity
entire I-Entity
remote I-Entity
access I-Entity
infrastructure I-Entity
and I-Entity
supply I-Entity
chain I-Entity
was I-Entity
under I-Entity
the I-Entity
control I-Entity
of I-Entity
the I-Entity
Cleaver I-Entity
team I-Entity
, O
allowing B-Action
permanent B-Entity
persistence I-Entity
under B-Modifier
compromised B-Entity
credentials I-Entity
. O

They B-Entity
achieved B-Action
complete B-Entity
access I-Entity
to I-Entity
airport I-Entity
gates I-Entity
and I-Entity
their I-Entity
security I-Entity
control I-Entity
systems I-Entity
, O
potentially O
allowing B-Action
them B-Entity
to B-Modifier
spoof B-Entity
gate I-Entity
credentials I-Entity
. O

They B-Entity
gained B-Action
access B-Entity
to I-Entity
PayPal I-Entity
and I-Entity
Go I-Entity
Daddy I-Entity
credentials I-Entity
allowing B-Action
them B-Entity
to B-Modifier
make B-Entity
fraudulent I-Entity
purchases I-Entity
and O
allowed B-Action
unfettered B-Entity
access I-Entity
to I-Entity
the I-Entity
victim I-Entity
's I-Entity
domains I-Entity
. O

We O
were O
witnessed O
a O
shocking O
amount O
of O
access O
into O
the O
deepest O
parts O
of O
these O
companies O
and O
the O
airports O
in O
which O
they O
operate O
. O

Despite O
today O
's O
trend O
toward O
attacker O
attribution O
, O
we O
believe O
it O
offers O
little O
real O
benefit O
to O
the O
day-to-day O
cyber O
defender O
. O

However O
, O
in O
this O
report O
we O
offer O
our O
observations O
on O
the O
sources O
of O
Operation O
Cleaver O
in O
order O
to O
benefit O
those O
that O
rely O
on O
attribution O
such O
as O
Law O
Enforcement O
. O

Operation O
Cleaver O
is O
believed O
to O
consist O
of O
at O
least O
20 O
hackers O
and O
developers O
, O
collaborating O
on O
projects O
and O
missions O
to O
support O
Iranian O
interests O
. O

Many O
of O
the O
targets O
were O
predominately O
English-speaking O
and O
a O
majority O
of O
the O
team O
members O
were O
capable O
of O
reading O
and O
writing O
in O
English O
. O

We O
present O
evidence O
that O
this O
team O
is O
operating O
, O
at O
least O
in O
part O
, O
out O
of O
Iran O
and O
in O
the O
interests O
of O
Iran O
. O

The O
skills O
and O
behavior O
of O
the O
Operation O
Cleaver O
teams O
are O
consistent O
with O
, O
and O
in O
one O
case O
surpasses O
, O
Iran O
's O
cyber O
capabilities O
as O
we O
know O
them O
today O
. O

For O
a O
complete O
list O
of O
IPs O
and O
domains O
related O
to O
this O
campaign O
, O
please O
refer O
to O
the O
Indicators O
of O
Compromise O
section O
. O

Over O
the O
course O
of O
multiple O
incident O
response O
engagements O
related O
to O
Operation O
Cleaver O
, O
we O
were O
able O
to O
identify O
a B-Entity
small I-Entity
set I-Entity
of I-Entity
IP I-Entity
addresses I-Entity
which O
were B-Action
commonly I-Action
used I-Action
during B-Modifier
the B-Entity
initial I-Entity
stages I-Entity
of I-Entity
an I-Entity
attack I-Entity
. O

The B-Entity
IP I-Entity
address I-Entity
78.109.194.114 I-Entity
served B-Action
as B-Modifier
a B-Entity
source I-Entity
for I-Entity
one I-Entity
of I-Entity
the I-Entity
primary I-Entity
attackers I-Entity
. O

They B-Entity
were O
observed O
conducting B-Action
SQL B-Entity
injections I-Entity
, O
controlling B-Action
backdoors B-Entity
, O
as O
well O
as O
exfiltrating B-Action
information B-Entity
using B-Modifier
this B-Entity
address I-Entity
, O
and O
the O
address O
appears O
in O
multiple O
software O
configurations O
recovered O
from O
staging O
servers O
over O
a O
period O
of O
time O
. O

This O
IP O
address O
was O
also O
observed O
in O
multiple O
software O
configurations O
. O

This O
particular O
net O
block O
was O
used O
over O
an O
extended O
period O
of O
time O
, O
indicating O
these O
were O
under O
the O
Cleaver O
team's O
physical O
control O
. O

Additionally O
, O
prior O
netblocks O
used O
by O
the O
same O
team O
demonstrated O
to O
us O
that O
this O
was O
n't O
simply O
a O
case O
of O
proxying O
or O
'' O
island O
hopping O
'' O
. O

For O
more O
information O
see O
the O
Tarh O
Andishan O
section O
of O
this O
report O
. O

The B-Entity
IP I-Entity
address I-Entity
159.253.144.209 I-Entity
was B-Action
a B-Entity
source I-Entity
for I-Entity
a I-Entity
secondary I-Entity
attacker I-Entity
in I-Entity
various I-Entity
compromises I-Entity
. O

They B-Entity
were O
observed O
conducting B-Action
SQL B-Entity
injection I-Entity
attacks I-Entity
. O

While O
this O
IP O
was O
this O
registered O
in O
the O
Netherlands O
, O
we O
believe O
they O
used O
Softlayer O
's O
Citrix O
demo O
environment O
to O
launch O
these O
attacks O
which O
is O
consistent O
with O
proxying O
or O
'' O
island O
hopping O
'' O
. O

A O
number O
of O
Cleaver O
's O
attack O
methods O
require O
a O
persistent O
server O
. O

In O
many O
cases O
, O
these O
servers O
were O
referenced O
by O
domain O
names O
. O

The O
following O
malicious O
domains O
are O
operated O
by O
this O
organization O
and O
are O
grouped O
by O
the O
registrant O
's O
email O
address O
. O

As O
is O
typical O
with O
malicious O
domains O
, O
the O
Whois O
data O
for O
most O
of O
these O
domains O
contained O
falsified O
information O
. O

We O
managed O
to O
obtain O
a O
large O
collection O
of O
the O
internally O
developed O
tools O
used O
by O
the O
Cleaver O
team O
, O
many O
of O
which O
were O
developed O
by O
its O
members O
. O

Due O
to O
operational O
security O
failures O
, O
these O
tools O
contain O
information O
that O
provided O
us O
insight O
into O
their O
organization O
and O
operations O
. O

In O
the O
tool O
named O
Shell O
Creator O
2 O
, O
there O
are O
three O
main O
components O
. O

The B-Entity
creator I-Entity
generates B-Action
an B-Entity
ASPX I-Entity
web I-Entity
shell I-Entity
using B-Modifier
user B-Entity
input I-Entity
as I-Entity
well I-Entity
as I-Entity
a I-Entity
collection I-Entity
of I-Entity
templates I-Entity
. O

The B-Entity
web I-Entity
shell I-Entity
could O
then O
be B-Action
installed I-Action
via B-Modifier
xpcmdshell B-Entity
, I-Entity
or I-Entity
any I-Entity
other I-Entity
method I-Entity
which I-Entity
would I-Entity
grant I-Entity
the I-Entity
attacker I-Entity
write I-Entity
access I-Entity
. O

The O
web O
shell O
is O
accessible O
by O
the O
shell O
client O
directly O
. O

The O
shell O
client O
is O
a O
portion O
of O
Shell O
Creator O
2 O
that O
was O
not O
designed O
to O
be O
run O
on O
a O
compromised O
computer O
. O

We O
originally O
located O
it O
on O
a B-Entity
staging I-Entity
server I-Entity
being B-Action
utilized I-Action
for B-Modifier
multiple B-Entity
attacks I-Entity
as I-Entity
well I-Entity
as I-Entity
a I-Entity
tool I-Entity
for I-Entity
sharing I-Entity
data I-Entity
between I-Entity
members I-Entity
of I-Entity
the I-Entity
organization I-Entity
's I-Entity
team I-Entity
. O

The O
shell O
client O
, O
which O
is O
developed O
in O
Java O
and O
is O
easily O
decompiled O
, O
is O
a O
simple O
interface O
with O
a O
feature O
to O
protect O
the O
operator O
from O
making O
a O
critical O
mistake O
. O

When O
executed O
, O
and O
before O
any O
connection O
to O
an O
instance O
of O
the O
web O
shell O
is O
initiated O
, O
the B-Entity
shell I-Entity
client I-Entity
communicates B-Action
with B-Modifier
freegeoip.net B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
get B-Entity
the I-Entity
external I-Entity
IP I-Entity
address I-Entity
of I-Entity
the I-Entity
current I-Entity
user I-Entity
. O

The O
country O
of O
origin O
is O
then O
shown O
to O
the O
user O
, O
to O
inform O
them O
of O
what O
country O
it O
appears O
they O
are O
connecting O
from O
. O

The O
assumed O
purpose O
of O
this O
feature O
is O
to O
ensure O
that O
a O
proper O
proxy O
is O
in O
use O
, O
and O
the O
real O
origin O
of O
the O
attacker O
is O
not O
revealed O
. O

After O
decompiling O
the O
shell O
client O
, O
we O
found O
the O
following O
code O
segment O
controlling O
the O
display O
of O
this O
IP O
location O
information O
. O

This O
code O
handles O
the O
XML O
response O
from O
freegeoip.net O
, O
and O
displays O
the O
information O
as O
different O
colors O
based O
on O
different O
attributes O
. O

For O
instance O
, O
if O
the O
string O
'' O
ERROR O
'' O
is O
in O
the O
response O
, O
the O
text O
is O
displayed O
with O
the O
color O
magenta O
. O

If O
the O
string O
IRAN O
is O
in O
the O
response O
, O
the O
text O
is O
displayed O
with O
the O
color O
red O
. O

It O
should O
be O
noted O
that O
no O
other O
country O
name O
contains O
the O
substring O
IRAN O
. O

Net B-Entity
Crawler I-Entity
is O
a O
tool O
developed O
in O
C O
# O
that O
exhibits B-Action
worm-like B-Entity
behavior I-Entity
in O
order O
to O
gather B-Action
cached B-Entity
credentials I-Entity
from B-Modifier
any B-Entity
and I-Entity
all I-Entity
accessible I-Entity
computers I-Entity
on I-Entity
an I-Entity
infected I-Entity
network I-Entity
. O

This O
is O
done O
with O
Windows O
Credential O
Editor O
( O
WCE O
) O
and O
Mimikatz O
in O
combination O
with O
PsExec O
. O

Different O
versions O
of O
this O
malware O
contain O
ASCII O
art O
which O
names O
the O
authoring O
group O
as O
Zhoupin O
( O
in O
'' O
leetspeak O
'' O
as O
'' O
Zh0up O
! O
n O
'' O
) O
. O

For O
more O
information O
on O
Net O
Crawler O
, O
see O
the O
Tactics O
, O
Techniques O
and O
Procedures O
section O
. O

TinyZBot O
is O
a O
bot O
written O
in O
C O
# O
and O
developed O
by O
the O
Cleaver O
team O
. O

It O
is O
the O
longest O
developed O
malware O
family O
discovered O
by O
this O
group O
, O
and O
has O
been O
used O
in O
campaigns O
for O
close O
to O
two O
years O
. O

How O
it O
operates O
can O
vary O
greatly O
from O
version O
to O
version O
. O

For O
a O
detailed O
technical O
analysis O
of O
TinyZBot O
, O
see O
the O
Tactics O
, O
Techniques O
and O
Procedures O
section O
. O

As O
TinyZBot O
is O
developed O
in O
C O
# O
, O
many O
versions O
can O
be O
decompiled O
to O
code O
very O
similar O
to O
their O
originals O
, O
including O
names O
of O
namespaces O
. O

Many B-Entity
versions I-Entity
were B-Action
obfuscated I-Action
with B-Modifier
a B-Entity
legitimate I-Entity
tool I-Entity
for I-Entity
developers I-Entity
named I-Entity
SmartAssembly I-Entity
, O
which O
makes O
the O
recovery O
of O
some O
names O
implausible O
. O

We O
obtained O
multiple O
versions O
from O
which O
we O
were O
able O
to O
recover O
many O
of O
the O
original O
names O
of O
variables O
and O
namespaces O
. O

In O
a O
number O
of O
these O
samples O
, O
the O
primary O
namespace O
for O
TinyZBot O
is O
named O
ZhoupinCleaver O
. O

In O
every O
version O
of O
TinyZBot O
that O
is O
not O
obfuscated O
, O
there O
is O
a O
code O
base O
referred O
to O
as O
Cleaver O
. O

This O
code O
base O
is O
also O
shared O
in O
other O
malware O
developed O
by O
this O
organization O
, O
such O
as O
Csext O
. O

PrivEsc O
is O
a O
blatant O
plagiarism O
of O
an O
existing O
exploit O
for O
Microsoft O
Windows O
released O
in O
January O
2010 O
called O
MS10-015 O
, O
'' O
Vulnerabilities O
in O
Windows O
Kernel O
Could O
Allow O
Escalation O
of O
Privilege O
'' O
, O
popularly O
known O
as O
the O
KiTrap0D O
exploit O
which O
was O
released O
publicly O
. O

The O
Cleaver O
team O
clearly O
modified O
the O
source O
code O
and O
compiled O
a O
new O
version O
. O

The O
only O
detectable O
modification O
was O
to O
change O
the O
original O
author O
's O
name O
to O
instead O
display O
the O
following O
: O
Zhopin O
Exploit O
Team O
This O
is O
not O
the O
only O
case O
of O
this O
team O
relabeling O
others O
' O
work O
as O
their O
own O
. O

Logger O
module O
is O
a O
component O
of O
the O
PVZ O
( O
PVZ O
is O
shorthand O
for O
Parviz O
, O
one O
of O
the O
members O
of O
the O
Cleaver O
team O
) O
bot O
tool O
chain O
. O

When O
executed O
, O
it B-Entity
will O
capture B-Action
the B-Entity
user I-Entity
's I-Entity
keystrokes I-Entity
and O
save B-Action
them B-Entity
to B-Modifier
a B-Entity
location I-Entity
which O
PVZ B-Entity
bot I-Entity
then O
exfiltrates B-Action
. O

The O
logger O
module O
binary O
's O
file O
description O
value O
is O
the O
following O
: O
Roughly O
translated O
from O
Persian O
, O
this O
text O
says O
: O
This O
text O
could O
potentially O
be O
a O
note O
intended O
to O
stay O
internal O
, O
or O
could O
be O
an O
attempt O
to O
persuade O
an O
unsuspecting O
victim O
to O
assume O
the O
file O
is O
not O
malicious O
. O

The O
Product O
Name O
value O
is O
GOOD O
FILE O
. O

For O
more O
information O
on O
the O
PVZ O
bot O
tool O
chain O
, O
see O
the O
Tactics O
, O
Techniques O
, O
and O
Procedures O
section O
. O

CCProxy O
is O
a O
publicly O
available O
proxy O
server O
for O
Windows O
, O
which O
can O
handle O
a O
variety O
of O
protocols O
. O

We O
do O
not O
believe O
that O
this O
organization O
was O
involved O
in O
the O
development O
or O
modification O
of O
CCProxy O
, O
but O
they O
have O
been O
observed O
using O
it O
. O

We O
recovered O
a O
CCProxy O
configuration O
, O
which O
exposed O
various O
operational O
details O
. O

The O
configuration O
allowed O
for O
remote O
connections O
, O
limited O
by O
a O
username O
as O
well O
as O
a O
limited O
IP O
range O
. O

The O
username O
was O
User-001 O
, O
which O
is O
the O
default O
value O
. O

The O
limited O
IP O
range O
covered O
one O
IP O
: O
78.109.194.114 O
. O

This O
IP O
address O
is O
located O
in O
Iran O
, O
and O
is O
owned O
by O
Tarh O
Andishan O
. O

The O
configuration O
also O
indicates O
which O
address O
the O
CCProxy O
server O
should O
listen O
on O
for O
incoming O
connections O
such O
as O
web O
( O
80 O
) O
and O
mail O
( O
25 O
) O
. O

Log O
output O
from O
the O
network O
port O
scanning O
application O
NMAP O
was O
recovered O
from O
a O
staging O
server O
. O

This O
log O
was O
generated O
during O
the O
usage O
of O
the B-Entity
nbrute I-Entity
utility I-Entity
, O
which O
brute-forces B-Action
network B-Entity
credentials I-Entity
and O
relies O
on O
NMAP O
to O
do O
so O
. O

The O
header O
of O
this O
NMAP O
log O
indicates O
that O
the O
computer O
used O
to O
run O
nbrute/nmap O
was O
set O
to O
Iran O
Daylight O
Time O
at O
the O
time O
of O
execution O
. O

With O
no O
known O
victims O
located O
in O
Iran O
, O
it O
is O
likely O
that O
this O
was O
executed O
on O
an O
attacker O
's O
computer O
, O
and O
not O
on O
a O
victim O
's O
computer O
. O

A O
configuration O
file O
for O
a O
Squid O
proxy O
server O
was O
recovered O
. O

Figure O
12 O
: O
Squid O
configuration O
file O
showing O
the O
use O
of O
Tarh O
Andishan O
's O
IP O
address O
. O

The O
net O
range O
of O
78.109.194.114/28 O
was O
inserted O
into O
the O
allowed O
local O
networks O
with O
an O
RFC O
comment O
appended O
in O
order O
to O
make O
it O
look O
like O
it O
was O
part O
of O
the O
default O
configuration O
. O

It O
is O
likely O
this O
is O
the O
same O
reason O
a O
/28 O
net O
range O
was O
used O
, O
in O
order O
to O
not O
look O
like O
it O
was O
intended O
to O
only O
allow O
one O
IP O
. O

This O
would O
give O
the O
same O
access O
to O
resources O
accessible O
from O
the O
Squid O
proxy O
server O
to O
this O
Iranian O
IP O
address O
. O

Tarh O
Andishan O
is O
listed O
as O
the O
registrant O
for O
a O
number O
of O
small O
net O
blocks O
based O
upon O
the O
email O
address O
tarh.andishan O
( O
at O
) O
yahoo.com O
. O

The O
net O
blocks O
appear O
to O
rotate O
over O
time O
and O
registrant O
information O
is O
altered O
to O
accommodate O
ongoing O
operations O
and O
avoid O
potential O
public O
exposure O
. O

The O
networks O
are O
included O
below O
as O
well O
as O
the O
last O
time O
that O
net O
block O
was O
observed O
as O
active O
. O

There O
are O
many O
seemingly O
legitimate O
Tarh O
Andishan O
related O
companies O
inside O
Tehran O
, O
but O
strong O
connections O
to O
Iranian O
backing O
have O
been O
difficult O
to O
prove O
definitively O
. O

'' O
Tarh O
Andishan O
'' O
is O
often O
translated O
as O
'' O
Thinkers O
'' O
, O
'' O
Innovators O
'' O
and O
'' O
Inventors O
'' O
. O

The O
net O
blocks O
above O
have O
strong O
associations O
with O
state-owned O
oil O
and O
gas O
companies O
. O

These O
companies O
have O
current O
and O
former O
employees O
who O
are O
ICS O
experts O
. O

Tarh O
Andishan O
has O
been O
suspected O
in O
the O
past O
of O
launching O
attacks O
in O
the O
interest O
of O
Iran O
. O

The B-Entity
operators I-Entity
of I-Entity
the I-Entity
blog I-Entity
IranRedLine.org I-Entity
, I-Entity
which I-Entity
comments I-Entity
on I-Entity
Iran I-Entity
's I-Entity
nuclear I-Entity
weapons I-Entity
efforts I-Entity
, O
has O
mentioned B-Action
in B-Modifier
multiple B-Entity
posts I-Entity
having B-Entity
been I-Entity
the I-Entity
target I-Entity
of I-Entity
debilitating I-Entity
brute-force I-Entity
authentication I-Entity
attacks I-Entity
from I-Entity
IP I-Entity
addresses I-Entity
registered I-Entity
to I-Entity
the I-Entity
same I-Entity
Tarh I-Entity
Andishan I-Entity
team I-Entity
found I-Entity
in I-Entity
Cleaver I-Entity
. O

In O
one O
of O
IranRedLine.org O
's O
blog O
posts O
, O
the O
author O
speculates O
on O
Tarh O
Andishan O
's O
involvement O
with O
the O
Iranian O
government O
by O
showing O
close O
proximity O
to O
SPND O
, O
the O
Organization O
of O
Defensive O
Innovation O
and O
Research O
; O
however O
, O
the O
phone O
number O
listed O
under O
the O
registrant O
contact O
information O
has O
yet O
to O
be O
completely O
validated O
. O

During O
this O
investigation O
, O
we O
were O
able O
to O
compile O
a O
considerable O
amount O
of O
information O
on O
some O
of O
the O
members O
of O
this O
organization O
. O

The O
following O
profiles O
were O
built O
from O
reverse O
engineering O
, O
code O
analysis O
, O
open O
source O
intelligence O
, O
incident O
response O
and O
forensics O
work O
. O

Personally O
identifiable O
information O
about O
these O
members O
is O
not O
being O
shared O
publicly O
as O
it O
could O
endanger O
their O
lives O
and O
would O
be O
irresponsible O
. O

Parviz O
is O
a O
developer O
who O
worked O
on O
a O
variety O
of O
projects O
, O
and O
was O
primarily O
active O
in O
2013 O
. O

His O
development O
skillset O
is O
based O
around O
his O
ability O
to O
develop O
in O
C/C++ O
. O

He O
has O
been O
observed O
using O
Visual O
Studio O
2010 O
, O
and O
his O
tools O
are O
written O
exclusively O
for O
Windows O
. O

Some O
of O
his O
tools O
were O
found O
to O
be O
packed O
with O
ASPack O
. O

Parviz O
is O
the O
primary O
developer O
of O
the O
PVZ O
bot O
and O
multiple O
parts O
of O
its O
tool O
chain O
. O

Parviz O
is O
likely O
associated O
with O
the O
PVZ O
bot O
as O
his O
name O
in O
hardcoded O
into O
the O
PDB O
file O
paths O
. O

The B-Entity
PVZ I-Entity
tool I-Entity
chain I-Entity
includes B-Action
a O
variety O
of O
functionality O
, O
such O
as O
HTTP B-Entity
command I-Entity
and I-Entity
control I-Entity
communications I-Entity
with I-Entity
an I-Entity
ASPX I-Entity
server-side I-Entity
component I-Entity
, O
a B-Entity
denial I-Entity
of I-Entity
service I-Entity
tool I-Entity
they I-Entity
developed I-Entity
, O
and O
the O
public O
project O
named O
XYNTService O
used O
to O
run O
ordinary O
applications O
as O
services O
. O

Nesha O
is O
one O
of O
the O
offensive O
members O
of O
this O
organization O
. O

Nesha B-Entity
was B-Action
seen I-Action
in B-Modifier
breaches B-Entity
involving I-Entity
SQL I-Entity
injection I-Entity
as I-Entity
well I-Entity
as I-Entity
other I-Entity
techniques I-Entity
. O

Nesha B-Entity
often O
utilized B-Action
web-based B-Entity
backdoors I-Entity
developed I-Entity
in I-Entity
ASPX I-Entity
, I-Entity
PHP I-Entity
as I-Entity
well I-Entity
as I-Entity
ColdFusion I-Entity
. O

A O
copy O
of O
an O
MS08-067 O
exploit O
developed O
in O
Python O
was O
recovered O
in O
which O
Nesha O
shamelessly O
replaced O
the O
original O
author O
's O
name O
with O
his O
own O
. O

Nesha O
's O
passwords O
very O
commonly O
include O
own O
handle O
. O

His O
passwords O
were O
frequently O
stored O
as O
hashes O
in O
backdoors O
, O
but O
common O
hash O
cracking O
methods O
were O
able O
to O
recover O
the O
plaintext O
versions O
. O

His O
observed O
password O
use O
is O
as O
follows O
: O
Cylance O
observed O
Nesha O
participating O
in O
compromises O
involving O
the O
following O
techniques O
: O
Nesha O
has O
additionally O
been O
identified O
using O
a O
variety O
of O
internally O
developed O
tools O
as O
well O
as O
the O
following O
publicly O
available O
tools O
: O
Alireza O
appears O
to O
be O
one O
of O
the O
senior O
developers O
of O
this O
organization O
. O

His O
tools O
are O
commonly O
developed O
in O
C++ O
, O
Java O
, O
and O
C O
# O
( O
desktop O
and O
ASPX O
) O
. O

These B-Entity
tools I-Entity
are O
often O
support O
tools O
, O
either O
monitoring B-Action
the B-Entity
activity I-Entity
of I-Entity
other I-Entity
tools I-Entity
or O
supplementing B-Action
the B-Entity
function I-Entity
of I-Entity
other I-Entity
tools I-Entity
gathering I-Entity
information I-Entity
during I-Entity
the I-Entity
infiltration I-Entity
process I-Entity
. O

Alireza O
's O
code O
appears O
to O
be O
reused O
internally O
on O
projects O
such O
as O
TinyZBot O
. O

Alireza O
appears O
to O
be O
using O
a O
version O
control O
system O
for O
his O
code O
, O
and O
it O
is O
likely O
that O
others O
are O
using O
the O
same O
system O
. O

Based O
on O
the O
paths O
, O
the O
version O
control O
system O
in O
use O
is O
likely O
Apache O
's O
Subversion O
. O

Use O
of O
a O
version O
control O
system O
is O
indicative O
of O
code O
sharing O
, O
but O
the O
use O
of O
an O
older O
system O
like O
Subversion O
, O
along O
with O
other O
evidence O
, O
suggests O
there O
is O
not O
a O
large O
amount O
of O
collaboration O
on O
projects O
and O
likely O
one O
developer O
working O
on O
each O
project O
at O
a O
time O
. O

This O
is O
not O
behavior O
typical O
of O
a O
professional O
development O
team O
. O

Alireza O
's O
C O
# O
tools O
include O
the O
following O
techniques O
: O
Alireza O
's O
Java O
tools O
include O
the O
following O
techniques O
: O
Alireza O
's O
C++ O
tools O
include O
the O
following O
techniques O
: O
kaJ O
is O
a O
.NET O

developer O
, O
and O
has O
only O
been O
observed O
working O
in O
C O
# O
. O

He O
has O
less O
English O
language O
proficiency O
than O
others O
in O
the O
organization O
, O
and O
likely O
has O
a O
supplemental O
role O
during O
compromises O
. O

He O
has O
been O
observed O
developing O
tools O
which O
cater O
to O
specific O
challenges O
in O
a O
compromise O
. O

His O
notable O
project O
was O
named O
Net O
Crawler O
, O
and O
a O
technical O
analysis O
of O
this O
tool O
can O
be O
found O
in O
the O
Tactics O
, O
Techniques O
and O
Procedures O
section O
. O

Thanks O
to O
a O
recovered O
test O
configuration O
for O
Net O
Crawler O
, O
we O
were O
able O
to O
determine O
that O
kaJ O
's O
development O
computer O
has O
the O
name O
dev-castle O
, O
where O
he O
has O
the O
username O
kaJ O
and O
the O
password O
oaolrJ O
@ O
vad O
. O

kaJ O
is O
believed O
to O
be O
the O
creator O
of O
the O
Zhoupin O
ASCII O
art O
displayed O
in O
Net O
Crawler O
. O

kaJ O
's O
projects O
include O
the O
following O
techniques O
. O

Jimbp O
is O
a O
.NET O

developer O
with O
minimal O
experience O
. O

His O
projects O
appear O
to O
be O
supplemental O
to O
TinyZBot O
and O
are O
very O
simplistic O
. O

It O
is O
believed O
he O
is O
the O
developer O
of O
the O
project O
Binder1 O
. O

This O
project O
was O
a O
simple O
malware O
binder O
which O
required O
manual O
configuration O
when O
compiling O
. O

His O
other O
work O
included O
creating O
a O
new O
service O
wrapper O
for O
TinyZBot O
. O

Of O
course O
many O
associated O
Iranian O
hacker O
teams O
have O
been O
identified O
in O
public O
and O
private O
security O
circles O
. O

Some O
of O
the O
teams O
publicly O
known O
today O
include O
Iranian O
Cyber O
Army O
, O
Ashiyane O
, O
Islamic O
Cyber O
Resistance O
Group O
, O
Izz O
ad-Din O
al-Qassam O
Cyber O
Fighters O
, O
Parastoo O
, O
Shabgard O
, O
Iran O
Black O
Hats O
and O
many O
others O
. O

However O
, O
even O
though O
the O
TTPs O
of O
the O
Cleaver O
team O
have O
some O
overlap O
to O
techniques O
used O
by O
Iranian O
Cyber O
Army O
( O
botnets O
) O
, O
Ashiyane O
( O
SQL O
injection O
) O
and O
Syrian O
Electronic O
Army O
( O
phishing O
and O
RATs O
) O
, O
we O
believe O
this O
is O
largely O
the O
work O
of O
a O
new O
team O
. O

Some O
connections O
to O
Ashiyane O
were O
discovered O
in O
our O
investigations O
including O
a O
reference O
to O
hussein1363 O
, O
who O
had O
prior O
ties O
to O
the O
hacker O
group O
. O

Additional O
connections O
between O
team O
members O
and O
individuals O
exist O
but O
are O
predominantly O
speculative O
and O
have O
only O
been O
shared O
with O
law O
enforcement O
. O

Ultimately O
we O
believe O
the O
Cleaver O
team O
is O
a O
mix O
of O
existing O
team O
members O
and O
new O
recruits O
pulled O
from O
the O
universities O
in O
Iran O
. O

The O
Cleaver O
campaign O
used O
a O
variety O
of O
methods O
in O
multiple O
stages O
of O
attacks O
. O

In O
this O
section O
we'll O
cover O
the O
commonly O
observed O
methods O
during O
different O
stages O
of O
the O
attack O
. O

The O
initial O
compromise O
gets O
the O
attackers O
their O
first O
foothold O
into O
the O
target O
network O
. O

Once O
the O
ability O
to O
execute O
arbitrary O
code O
has O
been O
established O
, O
an O
attacker O
's O
job O
becomes O
quite O
a O
bit O
easier O
. O

Since O
the O
vector O
of O
initial O
compromise O
is O
usually O
determined O
by O
what O
is O
vulnerable O
on O
the O
target O
, O
we O
'll O
cover O
just O
a O
few O
of O
the O
techniques O
we O
've O
seen O
Operation O
Cleaver O
use O
to O
initiate O
the O
compromise O
. O

SQL B-Entity
injection I-Entity
is B-Action
a B-Entity
very I-Entity
common I-Entity
and I-Entity
simple I-Entity
attack I-Entity
method I-Entity
. O

It O
is O
made O
possible O
by O
a O
lack O
of O
input O
sanitization O
by O
the O
vulnerable O
application O
before O
supplying O
that O
input O
into O
a O
SQL O
database O
query O
. O

SQL B-Entity
injection I-Entity
payloads I-Entity
used B-Action
by O
this B-Entity
organization I-Entity
have O
been B-Action
double I-Action
encoded I-Action
. O

Double B-Entity
encoding I-Entity
SQL I-Entity
injection I-Entity
payloads I-Entity
allows B-Action
for B-Modifier
bypassing B-Entity
of I-Entity
various I-Entity
anti-exploitation I-Entity
filters I-Entity
, I-Entity
such I-Entity
as I-Entity
those I-Entity
supplied I-Entity
by I-Entity
Web I-Entity
Application I-Entity
Firewalls I-Entity
( I-Entity
WAFs I-Entity
) I-Entity
. O

The O
attackers O
would O
enable O
xpcmdshell O
: O
Then O
connect B-Action
outbound B-Entity
via B-Modifier
anonymous B-Entity
FTP I-Entity
: O
Using B-Modifier
messaging B-Entity
methods I-Entity
such I-Entity
as I-Entity
email I-Entity
, O
attackers B-Entity
can O
social B-Action
engineer I-Action
users B-Entity
into B-Modifier
downloading B-Entity
and I-Entity
executing I-Entity
software I-Entity
, O
which O
quietly O
installs B-Action
malware B-Entity
alongside B-Modifier
of I-Modifier
the B-Entity
desired I-Entity
program I-Entity
. O

Operation O
Cleaver O
has O
employed O
this O
technique O
numerous O
times O
across O
different O
organizations O
. O

The O
domain O
EasyResumeCreatorPro.com O
was O
registered O
and O
a O
website O
setup O
which O
was O
a O
direct O
copy O
of O
a O
legitimate O
website O
at O
winresume.com O
. O

This O
is O
how O
the O
original O
site O
looked O
: O
That O
's O
not O
all O
they O
copied O
. O

In O
order O
to O
infect O
users O
, O
they B-Entity
combined B-Action
the B-Entity
original I-Entity
Easy I-Entity
Resume I-Entity
Creator I-Entity
Pro I-Entity
product I-Entity
with B-Modifier
malware B-Entity
by B-Modifier
using B-Entity
a I-Entity
binder I-Entity
they I-Entity
developed I-Entity
internally I-Entity
named I-Entity
Binder1 I-Entity
. O

A O
binder O
is O
an O
application O
, O
which O
combines O
two O
executables O
( O
desired O
software O
and O
malware O
) O
into O
a O
single O
executable O
. O

The B-Entity
resulting I-Entity
executable I-Entity
masquerades B-Action
as B-Modifier
the B-Entity
desired I-Entity
software I-Entity
. O

The O
purpose O
is O
deception O
, O
to O
make B-Action
the B-Entity
binder I-Entity
indistinguishable B-Entity
from I-Entity
the I-Entity
desired I-Entity
application I-Entity
. O

When O
executed O
, O
both B-Entity
applications I-Entity
are B-Action
written I-Action
to B-Modifier
a B-Entity
temporary I-Entity
directory I-Entity
and O
executed B-Action
. O

This O
way O
it O
appears O
that O
the O
desired O
application O
was O
executed O
, O
but O
the B-Entity
malware I-Entity
was B-Action
also I-Action
executed I-Action
silently O
. O

This O
attack O
evolved O
to O
appear O
more O
legitimate O
. O

The O
attackers O
made O
the O
victims O
feel O
like O
they O
had O
a O
pending O
job O
opportunity O
at O
the O
industrial O
conglomerate O
Teledyne O
. O

In B-Modifier
order I-Modifier
to I-Modifier
take B-Entity
advantage I-Entity
of I-Entity
this I-Entity
job I-Entity
opportunity I-Entity
, O
the B-Entity
victim I-Entity
needed O
to O
use B-Action
the B-Entity
fake I-Entity
résumé I-Entity
submission I-Entity
application I-Entity
supplied I-Entity
by I-Entity
the I-Entity
malicious I-Entity
recruiter I-Entity
. O

Multiple B-Entity
domains I-Entity
were B-Action
registered I-Action
in B-Modifier
order I-Modifier
to I-Modifier
make B-Entity
the I-Entity
download I-Entity
sites I-Entity
seem I-Entity
more I-Entity
realistic I-Entity
. O

These O
domains O
included O
other O
companies O
as O
they O
tried O
to O
hit O
a O
wider O
audience O
. O

At O
this O
point O
, O
the B-Entity
résumé I-Entity
submission I-Entity
application I-Entity
checks B-Action
the B-Entity
Internet I-Entity
connection I-Entity
. O

If O
it O
is O
unable O
to O
connect O
to O
the O
Internet O
, O
it B-Entity
will O
display B-Action
a B-Entity
window I-Entity
to B-Modifier
input B-Entity
proxy I-Entity
information I-Entity
. O

When O
this O
information O
is O
entered O
, O
the B-Entity
results I-Entity
are B-Action
cached I-Action
in B-Modifier
a B-Entity
location I-Entity
the I-Entity
dropped I-Entity
malware I-Entity
can I-Entity
access I-Entity
. O

After O
an B-Entity
Internet I-Entity
connection I-Entity
is B-Action
ensured I-Action
, O
the B-Entity
malware I-Entity
( I-Entity
TinyZbot I-Entity
) I-Entity
is B-Action
dropped I-Action
and O
executed B-Action
. O

This O
clever O
scheme O
makes O
sure O
the B-Entity
malware I-Entity
can O
connect B-Action
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
, O
and O
increases O
the O
chances O
that O
domain O
credentials O
are O
cached O
on O
the O
now O
infected O
machine O
. O

Shortly O
after O
, O
the B-Entity
main I-Entity
application I-Entity
is B-Action
launched I-Action
. O

The B-Entity
first I-Entity
résumé I-Entity
submission I-Entity
form I-Entity
requests B-Action
contact B-Entity
information I-Entity
. O

This B-Entity
form I-Entity
, O
like O
the O
rest O
of O
the O
submission O
forms O
, O
only O
stores B-Action
the B-Entity
submitted I-Entity
information I-Entity
while B-Modifier
the B-Entity
application I-Entity
is I-Entity
running I-Entity
. O

As O
the O
infected O
user O
is O
going O
through O
and O
filling O
out O
all O
this O
information O
, O
the B-Entity
malware I-Entity
is O
running O
in O
the O
background O
, O
logging B-Action
their B-Entity
keystrokes I-Entity
, O
retrieving B-Action
their B-Entity
stored I-Entity
passwords I-Entity
, O
etc O
. O

Once O
all O
the O
forms O
are O
filled O
out O
, O
the O
user O
goes O
to O
the O
submission O
form O
. O

When B-Modifier
the B-Entity
victim I-Entity
hits I-Entity
submit I-Entity
, O
the B-Entity
résumé I-Entity
submitter I-Entity
does B-Action
a B-Entity
GET I-Entity
request I-Entity
to B-Modifier
microsoft.com B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
make B-Entity
it I-Entity
seem I-Entity
like I-Entity
it I-Entity
is I-Entity
submitting I-Entity
something I-Entity
, O
then O
claims O
success O
. O

This O
method O
is O
particularly O
effective O
not O
only O
because O
of O
its O
level O
of O
deception O
, O
but O
even O
if O
the O
victim O
suspects O
that O
they O
are O
infected O
with O
malware O
, O
they O
are O
not O
as O
likely O
to O
speak O
up O
about O
it O
, O
as O
they O
would O
need O
to O
explain O
why O
they O
were O
submitting O
a O
job O
application O
for O
another O
company O
. O

Privilege B-Entity
escalation I-Entity
is B-Action
a B-Entity
category I-Entity
of I-Entity
techniques I-Entity
that I-Entity
describe I-Entity
the I-Entity
process I-Entity
of I-Entity
going I-Entity
from I-Entity
a I-Entity
less I-Entity
privileged I-Entity
user I-Entity
on I-Entity
a I-Entity
compromised I-Entity
computer I-Entity
to I-Entity
a I-Entity
more I-Entity
privileged I-Entity
user I-Entity
. O

This B-Entity
increase I-Entity
in I-Entity
privileges I-Entity
allows B-Action
for O
the B-Entity
attacker I-Entity
to O
gain B-Action
access B-Entity
to I-Entity
privleged I-Entity
areas I-Entity
of I-Entity
the I-Entity
operating I-Entity
system I-Entity
as O
well O
as O
to O
infect B-Action
other B-Entity
computers I-Entity
on I-Entity
the I-Entity
target I-Entity
network I-Entity
. O

This O
team O
did O
not O
utilize O
any O
novel O
methods O
of O
privilege O
escalation O
, O
but O
they O
were O
observed O
using O
a O
variety O
of O
publicly O
known O
exploits O
. O

PrivEsc B-Entity
is O
a O
compiled O
exploit O
, O
which O
leverages B-Action
the B-Entity
vulnerability I-Entity
commonly I-Entity
referred I-Entity
to I-Entity
as I-Entity
KiTrap0D I-Entity
( I-Entity
CVE-2010-0232 I-Entity
) I-Entity
. O

The B-Entity
exploit I-Entity
allows B-Action
for B-Modifier
escalation B-Entity
of I-Entity
privileges I-Entity
on I-Entity
unpatched I-Entity
Windows I-Entity
operating I-Entity
systems I-Entity
from I-Entity
an I-Entity
unprivileged I-Entity
user I-Entity
to I-Entity
kernel-level I-Entity
privilege I-Entity
. O

This O
vulnerability O
and O
the O
corresponding O
exploit O
were O
discovered O
and O
developed O
in O
2010 O
. O

The O
plagiarized O
version O
used O
in O
Operation O
Cleaver O
was O
compiled O
in O
May O
2013 O
, O
with O
a O
slight O
modification O
to O
the O
public O
source O
code O
. O

This O
modification O
changed O
the O
author O
's O
details O
to O
Zhopin O
Exploit O
Team O
. O

Pivoting B-Entity
is B-Action
the B-Entity
process I-Entity
of I-Entity
leveraging I-Entity
access I-Entity
from I-Entity
one I-Entity
compromised I-Entity
computer I-Entity
in I-Entity
order I-Entity
to I-Entity
gain I-Entity
access I-Entity
to I-Entity
additional I-Entity
systems I-Entity
on I-Entity
the I-Entity
target I-Entity
network I-Entity
. O

This O
can O
involve O
launching B-Action
attacks B-Entity
from B-Modifier
the B-Entity
compromised I-Entity
computer I-Entity
, O
or O
simply O
abusing B-Action
access B-Entity
once B-Modifier
it B-Entity
has I-Entity
been I-Entity
gained I-Entity
. O

A O
very O
common O
method O
of O
pivoting O
on O
a O
predominantly O
Windows O
operating O
system O
based O
network O
is O
to O
extract B-Action
domain B-Entity
credentials I-Entity
which I-Entity
have I-Entity
been I-Entity
used I-Entity
on I-Entity
the I-Entity
compromised I-Entity
computer I-Entity
from I-Entity
a I-Entity
credential I-Entity
cache I-Entity
. O

There O
are O
a B-Entity
few I-Entity
well-known I-Entity
tools I-Entity
which O
are O
capable O
of O
doing O
this O
given B-Action
sufficient B-Entity
privileges I-Entity
on I-Entity
the I-Entity
infected I-Entity
host I-Entity
. O

Two O
of O
these O
tools O
used O
by O
Cleaver O
are O
Mimikatz O
and O
Windows O
Credential O
Editor O
. O

Two B-Entity
similar I-Entity
applications I-Entity
were O
developed O
by O
Operation O
Cleaver O
in O
order O
automate B-Action
the B-Entity
execution I-Entity
of I-Entity
Mimikatz I-Entity
. O

These O
applications O
are O
zhMimikatz O
and O
MimikatzWrapper O
. O

These O
applications O
store O
multiple O
versions O
of O
Mimikatz O
in O
their O
resources O
. O

When O
executed O
, O
they B-Entity
determine B-Action
which B-Entity
version I-Entity
of I-Entity
Mimikatz I-Entity
to I-Entity
use I-Entity
based B-Modifier
on I-Modifier
whether B-Entity
the I-Entity
computer I-Entity
's I-Entity
version I-Entity
of I-Entity
Windows I-Entity
is I-Entity
32-bit I-Entity
or I-Entity
64-bit I-Entity
. O

This O
technique O
is O
uncommon O
in O
malware O
and O
shows O
the O
advanced O
skillset O
of O
the O
Cleaver O
team O
. O

Both O
tools O
were O
developed O
in O
C O
# O
. O

In O
the O
following O
examples O
, O
the O
computer O
name O
is O
TheComputerName O
, O
the O
username O
of O
the O
logged O
in O
user O
is O
TheUser O
, O
and O
that O
user O
's O
password O
is O
ThePassword O
. O

At O
the O
time O
of O
execution O
, O
the O
system O
only O
has O
its O
own O
credentials O
available O
and O
no O
cached O
network O
credentials O
. O

zhMimikatz B-Entity
executes B-Action
the B-Entity
correct I-Entity
version I-Entity
of I-Entity
Mimikatz I-Entity
for I-Entity
the I-Entity
current I-Entity
system I-Entity
, O
and O
parses B-Action
the B-Entity
results I-Entity
for B-Modifier
any B-Entity
cached I-Entity
credentials I-Entity
. O

Output O
from O
MimikatzWrapper O
is O
essentially O
the O
same O
as O
zhMimikatz O
, O
despite O
being O
a O
different O
Visual O
Studio O
project O
. O

The O
only O
external O
difference O
is O
that O
MimikatzWrapper B-Entity
also O
logs B-Action
these B-Entity
results I-Entity
to B-Modifier
res.txt B-Entity
in B-Modifier
the B-Entity
executing I-Entity
directory I-Entity
. O

This O
can O
make O
it O
useful O
for O
tools B-Entity
like I-Entity
the I-Entity
PVZ I-Entity
tool I-Entity
chain I-Entity
and I-Entity
Csext I-Entity
to O
execute B-Action
with B-Modifier
logged B-Entity
results I-Entity
: O
Once O
an B-Entity
attacker I-Entity
has O
credentials B-Entity
extracted B-Action
from B-Modifier
the B-Entity
cache I-Entity
, O
whether O
in O
hash O
form O
or O
in O
plaintext O
form O
, O
PsExec B-Entity
can O
be O
used O
to O
run B-Action
commands B-Entity
on B-Modifier
any B-Entity
other I-Entity
computer I-Entity
which I-Entity
accepts I-Entity
those I-Entity
domain I-Entity
credentials I-Entity
. O

If O
this B-Entity
technique I-Entity
is B-Action
combined I-Action
with B-Modifier
cached B-Entity
credential I-Entity
dumping I-Entity
, O
it B-Entity
can O
be O
used O
to O
jump B-Action
from B-Modifier
computer B-Entity
to B-Modifier
computer B-Entity
on B-Modifier
a B-Entity
compromised I-Entity
network I-Entity
. O

Net B-Entity
Crawler I-Entity
utilizes B-Action
a B-Entity
cached I-Entity
credential I-Entity
dumping I-Entity
technique I-Entity
along B-Modifier
with I-Modifier
PsExec B-Entity
in O
order O
to O
worm B-Action
throughout B-Modifier
a B-Entity
network I-Entity
, O
collecting B-Action
any B-Entity
and I-Entity
all I-Entity
credentials I-Entity
that I-Entity
it I-Entity
can I-Entity
extract I-Entity
from I-Entity
credential I-Entity
caches I-Entity
. O

It O
has O
the O
ability O
to O
do O
this O
with O
both O
Windows O
Credential O
Editor O
and O
Mimikatz O
. O

It B-Entity
starts O
by O
first O
extracting B-Action
cached B-Entity
credentials I-Entity
from B-Modifier
the B-Entity
infected I-Entity
computer I-Entity
's I-Entity
cache I-Entity
. O

Once O
this O
is O
complete O
, O
it B-Entity
then O
continues O
to O
scan B-Action
a B-Entity
set I-Entity
of I-Entity
configured I-Entity
IP I-Entity
addresses I-Entity
on B-Modifier
the B-Entity
local I-Entity
subnet I-Entity
to B-Modifier
determine B-Entity
which I-Entity
IP I-Entity
addresses I-Entity
have I-Entity
SMB I-Entity
related I-Entity
ports I-Entity
open I-Entity
. O

Then O
an B-Entity
iterative I-Entity
methodology I-Entity
is O
applied O
to O
brute B-Action
forcing I-Action
each B-Entity
SMB I-Entity
enabled I-Entity
target I-Entity
with B-Modifier
each B-Entity
credential I-Entity
that I-Entity
was I-Entity
extracted I-Entity
from I-Entity
the I-Entity
cache I-Entity
. O

When O
a O
positive O
result O
has O
been O
achieved O
, O
it B-Entity
will O
create B-Action
a B-Entity
copy I-Entity
of I-Entity
itself I-Entity
with B-Modifier
a B-Entity
modified I-Entity
configuration I-Entity
stored I-Entity
as I-Entity
a I-Entity
PE I-Entity
resource I-Entity
, O
then O
send B-Action
and O
execute B-Action
the B-Entity
copy I-Entity
utilizing I-Entity
PsExec I-Entity
. O

This B-Entity
copy I-Entity
repeats B-Action
the B-Entity
behavior I-Entity
of I-Entity
the I-Entity
original I-Entity
, O
but B-Modifier
with I-Modifier
already B-Entity
discovered I-Entity
credentials I-Entity
as I-Entity
well I-Entity
as I-Entity
newly I-Entity
discovered I-Entity
ones I-Entity
on I-Entity
the I-Entity
newly I-Entity
infected I-Entity
host I-Entity
. O

Any O
credentials O
found O
are O
reported O
back O
to O
the O
original O
infection O
. O

The O
following O
is O
a O
sample O
of O
some O
of O
the O
recovered O
results O
of O
Net O
Crawler O
executing O
on O
a O
live O
network O
: O
A O
more O
in O
depth O
analysis O
of O
Net O
Crawler O
, O
as O
part O
of O
the O
A O
Study O
in O
Bots O
series O
, O
will O
be O
available O
on O
Cylance O
's O
blog O
. O

MS08-067 B-Entity
is B-Action
a B-Entity
vulnerability I-Entity
in I-Entity
Microsoft I-Entity
Windows I-Entity
made I-Entity
popular I-Entity
by I-Entity
the I-Entity
Conficker I-Entity
worm I-Entity
which I-Entity
can I-Entity
be I-Entity
exploited I-Entity
by I-Entity
a I-Entity
specially I-Entity
crafted I-Entity
packet I-Entity
to I-Entity
the I-Entity
operating I-Entity
system I-Entity
's I-Entity
RPC I-Entity
network I-Entity
interface I-Entity
. O

This O
vulnerability O
has O
been O
patched O
since O
October O
2008 O
, O
but O
many O
networks O
have O
failed O
to O
update O
their O
systems O
even O
to O
this O
day O
. O

Operation O
Cleaver O
used O
a O
plagiarized O
version O
of O
a O
publicly O
available O
exploit O
for O
this O
vulnerability O
developed O
in O
Python O
. O

Someone O
in O
the O
Cleaver O
team O
( O
presumed O
to O
be O
Nesha O
) O
modified O
the O
exploit O
to O
read O
'' O
By O
Nesha O
'' O
. O

Jasus B-Entity
is B-Action
an B-Entity
ARP I-Entity
cache I-Entity
poisoner I-Entity
developed I-Entity
by I-Entity
the I-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
. O

It O
makes O
use O
of O
WinPcap O
and O
is O
developed O
in O
C. O
Compared O
to O
some O
other O
publicly O
available O
ARP O
cache O
poisoning O
utilities O
, O
Jasus O
is O
poorly O
developed O
and O
without O
many O
useful O
features O
. O

The B-Entity
primary I-Entity
positive I-Entity
attribute I-Entity
of I-Entity
Jasus I-Entity
is B-Action
its B-Entity
poor I-Entity
detection I-Entity
ratio I-Entity
by I-Entity
the I-Entity
antivirus I-Entity
industry I-Entity
. O

Cain O
& O
Abel O
is O
a O
publicly O
available O
toolkit O
, O
which O
covers O
a O
wide O
range O
of O
functionality O
that O
assists O
attackers O
once O
they O
have O
compromised O
a O
node O
on O
a O
network O
. O

It B-Entity
has O
the O
ability O
to O
dump B-Action
stored B-Entity
and I-Entity
cached I-Entity
credentials I-Entity
, O
and O
conduct B-Action
attacks B-Entity
like I-Entity
ARP I-Entity
cache I-Entity
poisoning I-Entity
in O
order O
to O
capture B-Action
credentials B-Entity
being I-Entity
transmitted I-Entity
on I-Entity
the I-Entity
network I-Entity
. O

It B-Entity
also O
has B-Action
a B-Entity
remotely I-Entity
installable I-Entity
trojan I-Entity
named I-Entity
Abel I-Entity
, O
which O
enables B-Action
some B-Entity
of I-Entity
its I-Entity
functionality I-Entity
on B-Modifier
a B-Entity
remote I-Entity
target I-Entity
. O

We O
observed O
the B-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
using B-Action
Cain B-Entity
& I-Entity
Abel I-Entity
for B-Modifier
extracting B-Entity
credentials I-Entity
from I-Entity
caches I-Entity
and I-Entity
the I-Entity
network I-Entity
when O
they O
are O
confident O
that O
there O
is O
little O
to O
no O
antivirus O
protection O
on O
the O
infected O
target O
. O

Exfiltration B-Entity
is B-Action
the B-Entity
process I-Entity
of I-Entity
moving I-Entity
information I-Entity
to I-Entity
an I-Entity
external I-Entity
site I-Entity
. O

In O
this O
context O
, O
it B-Entity
is B-Action
the B-Entity
process I-Entity
of I-Entity
stealing I-Entity
information I-Entity
without I-Entity
being I-Entity
detected I-Entity
. O

Operation B-Entity
Cleaver I-Entity
has O
a O
strong O
focus O
on O
stealing B-Action
confidential/privileged B-Entity
information I-Entity
, O
and O
they O
have O
utilized O
a O
few O
methods O
in O
order O
to O
facilitate O
this O
objective O
. O

Cleaver B-Entity
Operations I-Entity
observed O
in O
2013 O
mainly O
utilized B-Action
FTP B-Entity
servers I-Entity
with B-Modifier
anonymous B-Entity
access I-Entity
enabled I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
pilfer B-Entity
large I-Entity
quantities I-Entity
of I-Entity
information I-Entity
. O

This O
allowed O
them B-Entity
to O
use B-Action
existing B-Entity
command I-Entity
line I-Entity
utilities I-Entity
available I-Entity
on I-Entity
their I-Entity
targets I-Entity
in O
order O
to O
upload B-Action
information B-Entity
. O

This O
is O
a O
versatile O
technique O
as O
it O
does O
not O
require O
any O
additional O
software O
which O
could O
be O
detected O
. O

These B-Entity
FTP I-Entity
servers I-Entity
were B-Action
also I-Action
observed I-Action
during B-Modifier
the B-Entity
infection I-Entity
process I-Entity
, O
as O
infected B-Entity
computers I-Entity
were O
often O
instructed O
to O
download B-Action
additional B-Entity
files I-Entity
from B-Modifier
these B-Entity
FTP I-Entity
servers I-Entity
, O
including O
backdoors O
and O
pivoting O
tools O
. O

The B-Entity
following I-Entity
IP I-Entity
addresses I-Entity
hosted B-Action
FTP B-Entity
servers I-Entity
that O
were B-Action
used I-Action
in B-Modifier
the B-Entity
infection I-Entity
of I-Entity
targets I-Entity
or O
in B-Modifier
the B-Entity
exfiltration I-Entity
of I-Entity
information I-Entity
. O

NetCat O
is O
a O
network O
tool O
which O
has O
many O
valid O
purposes O
but O
can O
also O
be O
used O
for O
malicious O
purposes O
. O

Its B-Entity
main I-Entity
functionality I-Entity
allows B-Action
for B-Modifier
a B-Entity
client I-Entity
and I-Entity
server I-Entity
communication I-Entity
channel I-Entity
, O
allowing B-Action
for B-Modifier
information B-Entity
to I-Entity
be I-Entity
transported I-Entity
over I-Entity
the I-Entity
network I-Entity
simply I-Entity
. O

NetCat O
has O
an O
option O
when O
being O
compiled O
to O
enable O
or O
disable O
the O
ability O
for O
NetCat B-Entity
to O
execute B-Action
a B-Entity
command I-Entity
after B-Modifier
the B-Entity
connection I-Entity
is I-Entity
established I-Entity
. O

This B-Entity
feature I-Entity
can O
be O
abused O
to O
enable B-Action
a B-Entity
reverse I-Entity
connecting I-Entity
shell I-Entity
, O
which O
can O
be O
used O
to O
remotely B-Action
control I-Action
a B-Entity
target I-Entity
. O

NetCat O
's O
network O
communications O
are O
in O
plaintext O
, O
and O
could O
be O
viewed O
by O
an O
egress O
filter O
looking O
to O
block O
the O
exfiltration O
of O
sensitive O
information O
. O

The B-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
was O
observed O
attempting O
to O
use B-Action
NetCat B-Entity
to B-Modifier
exfiltrate B-Entity
information I-Entity
as O
well O
as O
use B-Action
it B-Entity
as B-Modifier
a B-Entity
reverse I-Entity
connecting I-Entity
shell I-Entity
. O

The O
use O
of O
NetCat O
was O
later O
replaced O
with O
zhCat O
. O

zhCat O
is O
a O
tool O
developed O
by O
the O
Operation O
Cleaver O
team O
which O
operates O
similarly O
to O
NetCat O
. O

Its B-Entity
main I-Entity
purpose I-Entity
is O
to O
create B-Action
a B-Entity
channel I-Entity
that I-Entity
is I-Entity
capable I-Entity
of I-Entity
transporting I-Entity
information I-Entity
over I-Entity
the I-Entity
network I-Entity
. O

The O
changes O
made O
in O
zhCat B-Entity
allow O
for O
this B-Entity
information I-Entity
to O
be B-Action
transferred I-Action
with B-Modifier
inline B-Entity
obfuscation I-Entity
and/ I-Entity
or I-Entity
encryption I-Entity
. O

This O
makes O
it O
more O
difficult O
to O
detect O
that O
privileged B-Entity
information I-Entity
is O
being B-Action
exfiltrated I-Action
. O

The O
command O
line O
help O
( O
of O
a O
particular O
version O
) O
shows O
the O
following O
options O
: O
Multiple O
obfuscation/encryption O
methods O
are O
available O
. O

The O
–h O
argument O
enables O
HTTP O
mode O
. O

This B-Entity
makes B-Action
the B-Entity
traffic I-Entity
between I-Entity
zhCat I-Entity
instances I-Entity
look B-Entity
like I-Entity
benign I-Entity
HTTP I-Entity
traffic I-Entity
. O

For O
instance O
, O
if O
the O
attackers O
set O
up O
a O
zhCat O
instance O
listening O
on O
port O
1000 O
on O
192.168.116.128 O
in O
HTTP O
mode O
, O
the O
client O
instance O
of O
zhCat O
would O
use O
the O
following O
command O
: O
The O
server O
instance O
would O
use O
the O
following O
command O
: O
When O
we O
run O
both O
of O
these O
, O
we O
can O
send O
information O
just O
by O
typing O
it O
into O
the O
terminal O
of O
the O
running O
application O
. O

Information O
can O
be O
supplied O
by O
standard O
input O
. O

If O
we O
observe O
the O
network O
communications O
during O
this O
transfer O
, O
we B-Entity
can O
see B-Action
the B-Entity
following I-Entity
HTTP I-Entity
POST I-Entity
request I-Entity
. O

Note O
: O
research O
into O
ebizmba.com O
did O
not O
turn O
up O
any O
additional O
evidence O
of O
being O
involved O
with O
the O
development O
of O
zhCat O
. O

On O
the O
server O
side O
, O
we O
can O
see O
our O
message O
has O
been O
received O
: O
If O
stricter O
egress O
filtering O
is O
enabled O
, O
the B-Entity
attackers I-Entity
can O
use B-Action
zhCat B-Entity
to B-Modifier
also B-Entity
XOR I-Entity
encrypt I-Entity
the I-Entity
traffic I-Entity
with I-Entity
a I-Entity
shared I-Entity
key I-Entity
. O

These O
keys O
are O
stored O
inside O
zhCat O
. O

The O
following O
is O
the B-Entity
key I-Entity
used B-Action
for B-Modifier
XOR B-Entity
encryption I-Entity
: O
The O
\n O
represents O
hex O
character O
0x0A O
, O
which O
is O
a O
new O
line O
character O
. O

An B-Entity
attacker I-Entity
could O
set B-Action
up I-Action
a B-Entity
server I-Entity
instance I-Entity
of I-Entity
zhCat I-Entity
with B-Modifier
the B-Entity
following I-Entity
command I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
enable B-Entity
both I-Entity
HTTP I-Entity
and I-Entity
XOR I-Entity
obfuscation I-Entity
: O
The O
client O
instance O
could O
then O
be O
invoked O
with O
the O
following O
command O
: O
Once O
again O
, O
information O
can O
be O
supplied O
via O
standard O
input O
. O

Upon O
inspecting O
the O
network O
traffic O
again O
, O
we B-Entity
see B-Action
the B-Entity
following I-Entity
HTTP I-Entity
POST I-Entity
request I-Entity
. O

On O
the O
server O
side O
, O
we O
can O
see O
this O
information O
being O
received O
: O
zhCat B-Entity
has B-Action
a B-Entity
variety I-Entity
of I-Entity
other I-Entity
features I-Entity
such I-Entity
as I-Entity
port I-Entity
mirroring I-Entity
as I-Entity
well I-Entity
as I-Entity
traffic I-Entity
redirecting I-Entity
. O

PLink O
is O
one O
of O
the O
many O
utilities O
provided O
in O
the O
PuTTY O
( O
SSH O
) O
suite O
, O
which O
has O
many O
benign O
purposes O
. O

It O
is O
capable O
of O
communicating O
over O
various O
protocols O
, O
the O
most O
notable O
being O
SSH O
. O

The O
SSH O
protocol O
is O
a O
heavily O
utilized O
encrypted O
protocol O
, O
most O
commonly O
used O
for O
remote O
administration O
of O
UNIX O
based O
operating O
systems O
. O

PLink O
is O
designed O
to O
implement O
some O
of O
the O
SSH O
functions O
related O
to O
forwarding O
traffic O
as O
well O
as O
other O
functionality O
. O

Operation B-Entity
Cleaver I-Entity
uses B-Action
PLink B-Entity
to B-Modifier
forward B-Entity
local I-Entity
RDP I-Entity
ports I-Entity
to I-Entity
remote I-Entity
SSH I-Entity
servers I-Entity
. O

This O
allows O
them B-Entity
to O
easily O
connect B-Action
to B-Modifier
RDP B-Entity
servers I-Entity
inside B-Modifier
the B-Entity
networks I-Entity
of I-Entity
their I-Entity
victims I-Entity
. O

These B-Entity
RDP I-Entity
connections I-Entity
can O
be O
used O
to O
exfiltrate B-Action
information B-Entity
visually O
, O
as O
well O
as O
to O
remotely B-Action
control I-Action
the B-Entity
computers I-Entity
hosting I-Entity
the I-Entity
RDP I-Entity
servers I-Entity
. O

Early B-Entity
Cleaver I-Entity
operations I-Entity
abused B-Action
SMTP B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
exfiltrate B-Entity
information I-Entity
. O

The B-Entity
sending I-Entity
is B-Action
performed I-Action
by O
internally B-Entity
developed I-Entity
malware I-Entity
samples I-Entity
such I-Entity
as I-Entity
TinyZBot I-Entity
and I-Entity
Csext I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
exfiltrate B-Entity
information I-Entity
about I-Entity
the I-Entity
infected I-Entity
computer I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
requested I-Entity
files I-Entity
and I-Entity
keystroke I-Entity
logging I-Entity
information I-Entity
. O

Messages B-Entity
were B-Action
sent I-Action
using B-Modifier
an B-Entity
open I-Entity
SMTP I-Entity
relay I-Entity
at I-Entity
BeyondSys.com I-Entity
with B-Modifier
the B-Entity
sender I-Entity
email I-Entity
address I-Entity
dyanachear I-Entity
( I-Entity
at I-Entity
) I-Entity
beyondsys.com I-Entity
. O

This O
allowed O
the B-Entity
attackers I-Entity
to O
use B-Action
infrastructure B-Entity
that I-Entity
was I-Entity
not I-Entity
theirs I-Entity
to B-Modifier
exfiltrate B-Entity
information I-Entity
. O

The O
known O
recipient O
addresses O
of O
this O
information O
were O
testmail00001 O
( O
at O
) O
yahoo.com O
and O
TerafficAnalyzer O
( O
at O
) O
yahoo O
. O

com O
. O

In O
order O
to O
deceive O
anyone O
reading O
these O
emails O
, O
they O
made O
them O
appear O
to O
be O
a O
spam O
message O
that O
most O
would O
not O
think O
twice O
about O
. O

The O
subject O
used O
is O
the O
following O
: O
The O
message O
used O
is O
the O
following O
: O
The B-Entity
files I-Entity
being I-Entity
exfiltrated I-Entity
are B-Action
added I-Action
to B-Modifier
the B-Entity
email I-Entity
as B-Modifier
attachments B-Entity
. O

SOAP B-Entity
is B-Action
a B-Entity
sub-protocol I-Entity
communicated I-Entity
via I-Entity
HTTP I-Entity
. O

In O
relation O
to O
Operation O
Cleaver O
, O
it B-Entity
is B-Action
used I-Action
as B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
for I-Entity
TinyZBot I-Entity
, O
which O
was O
the O
preferred O
backdoor O
, O
and O
underwent O
long-term O
development O
. O

HTTP B-Entity
communications I-Entity
are B-Action
often I-Action
used I-Action
by O
botnets B-Entity
, O
but O
it O
is O
uncommon O
to O
use O
a O
sub-protocol O
such O
as O
SOAP O
. O

It O
is O
likely O
that O
SOAP B-Entity
was O
used O
because O
it O
is O
simple O
to O
implement O
in O
C O
# O
, O
and O
has O
the O
added O
benefit O
of O
blending B-Action
in I-Action
with B-Modifier
other B-Entity
benign I-Entity
HTTP I-Entity
traffic I-Entity
. O

As O
part O
of O
TinyZBot O
's O
command O
and O
control O
protocol O
, O
files B-Entity
can O
be B-Action
exfiltrated I-Action
over B-Modifier
SOAP B-Entity
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O

For O
more O
information O
about O
TinyZBot O
, O
see O
the O
Persistence O
section O
. O

Persistence B-Entity
is B-Action
the B-Entity
means I-Entity
of I-Entity
maintaining I-Entity
access I-Entity
to I-Entity
a I-Entity
compromised I-Entity
network I-Entity
. O

There O
are O
limitless O
methods O
of O
persistence O
; O
the B-Entity
following I-Entity
are I-Entity
techniques I-Entity
and I-Entity
tools I-Entity
for I-Entity
persistence I-Entity
used B-Action
by O
Cleaver B-Entity
. O

TinyZBot B-Entity
is B-Action
a B-Entity
backdoor I-Entity
developed I-Entity
in I-Entity
C I-Entity
# I-Entity
. O

This O
bot O
is O
the O
longest O
developed O
malware O
we O
have O
analyzed O
from O
this O
organization O
. O

The O
earliest O
known O
version O
was O
compiled O
in O
January O
2013 O
and O
we O
continued O
to O
see O
new O
versions O
being O
created O
actively O
. O

The O
purpose O
of O
TinyZBot B-Entity
is O
to O
gather B-Action
information B-Entity
from B-Modifier
an B-Entity
infected I-Entity
computer I-Entity
as O
well O
as O
maintain B-Action
and O
further B-Action
access B-Entity
into I-Entity
a I-Entity
compromised I-Entity
network I-Entity
. O

TinyZBot O
was O
developed O
with O
the O
clear O
intention O
of O
targeted O
campaigns O
. O

The O
name O
TinyZBot O
is O
assumed O
to O
be O
referring O
to O
this O
project O
as O
a O
less O
versatile O
version O
of O
the O
ZeuS O
botnet O
, O
although O
it O
does O
not O
exhibit O
the O
major O
browser O
injection O
features O
of O
ZeuS O
. O

To O
be O
clear O
, O
TinyZBot O
shares O
no O
code O
with O
ZeuS O
or O
its O
variants O
, O
and O
is O
developed O
in O
a O
different O
programming O
language O
. O

The O
majority O
of O
the O
code O
in O
TinyZBot O
was O
created O
by O
Cleaver O
. O

TinyZBot O
supports O
a O
wide O
array O
of O
features O
that O
continually O
evolved O
over O
time O
. O

For O
the O
evolution O
of O
features O
, O
see O
the O
History O
section O
. O

The O
following O
is O
a O
list O
of O
supported O
features O
: O
The B-Entity
command I-Entity
and I-Entity
control I-Entity
mechanism I-Entity
for I-Entity
TinyZBot I-Entity
utilizes B-Action
SOAP B-Entity
communicating I-Entity
over I-Entity
HTTP I-Entity
. O

Potential O
reasons O
for O
using O
SOAP O
are O
: O
1 O
. O

SOAP-based O
communications O
are O
simple O
to O
implement O
in O
C O
# O
. O

2 O
. O

SOAP B-Entity
traffic I-Entity
could O
easily O
be B-Action
considered I-Action
benign B-Entity
traffic I-Entity
, O
as O
it O
is O
not O
commonly O
seen O
in O
malware O
. O

As O
part O
of O
SOAP O
communications O
, O
a O
URI O
is O
specified O
. O

This O
is O
internal O
to O
the O
sub-protocol O
, O
and O
does O
not O
necessarily O
reflect O
the O
URI O
of O
the O
host O
running O
the O
SOAP O
server O
( O
ASMX O
file O
) O
. O

In O
the O
case O
of O
TinyZBot O
, O
and O
many O
examples O
for O
developing O
SOAP O
applications O
, O
this O
URI O
is O
tempuri.org O
. O

Since O
the O
first O
version O
of O
the B-Entity
SOAP-based I-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
was B-Action
implemented I-Action
, O
TinyZBot O
used O
what O
is O
referred O
to O
as O
a O
'' O
dynamic O
password O
'' O
. O

The O
result O
of O
this O
is O
a O
cryptographically O
hashed O
version O
of O
the O
server O
time O
( O
which O
must O
be O
obtained O
through O
a O
SOAP O
query O
) O
, O
the O
TinyZBot O
's O
GUID O
, O
and O
the O
TinyZBot O
's O
AppUsageID O
( O
campaign O
identifier O
) O
. O

For O
the O
command O
and O
control O
examples O
below O
, O
red O
text O
represents O
TCP B-Entity
data I-Entity
sent B-Action
from B-Modifier
the B-Entity
TinyZBot I-Entity
infection I-Entity
while O
blue O
text O
represents O
TCP B-Entity
data I-Entity
sent B-Action
from B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O

The O
server O
time O
lookup O
query O
invokes O
the O
SOAP O
command O
GetServerTime O
. O

This O
is O
the B-Entity
first I-Entity
query I-Entity
done B-Action
by O
a B-Entity
running I-Entity
TinyZBot I-Entity
instance I-Entity
, O
and O
needs O
to O
be O
done O
shortly O
before O
most O
other O
queries O
, O
in O
order O
to O
update O
the O
dynamic O
password O
. O

Commands B-Entity
, I-Entity
updates I-Entity
and I-Entity
files I-Entity
to I-Entity
drop I-Entity
and I-Entity
execute I-Entity
are B-Action
stored I-Action
as B-Modifier
files B-Entity
on I-Entity
the I-Entity
SOAP I-Entity
server I-Entity
, O
and O
access O
is O
restricted O
by O
the O
AppUsageID O
as O
well O
as O
the O
bot O
GUID O
. O

This O
allows O
for O
commands B-Entity
to O
be B-Action
sent I-Action
to B-Modifier
all B-Entity
bots I-Entity
for I-Entity
a I-Entity
campaign I-Entity
as O
well O
as O
individual O
control O
. O

The B-Entity
TinyZBot I-Entity
queries B-Action
the B-Entity
server I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
enumerate B-Entity
all I-Entity
files I-Entity
currently I-Entity
available I-Entity
to I-Entity
it I-Entity
. O

In O
order O
to O
download B-Action
the B-Entity
file I-Entity
and O
parse O
for O
commands O
to O
execute O
, O
the B-Entity
TinyZBot I-Entity
must O
request B-Action
the B-Entity
file I-Entity
. O

The B-Entity
file I-Entity
is B-Action
downloaded I-Action
Base64-encoded B-Entity
inside B-Modifier
of I-Modifier
the B-Entity
SOAP I-Entity
response I-Entity
. O

The O
command O
file O
downloaded O
in O
this O
example O
is O
as O
follows O
: O
The O
first O
line O
is O
a O
timestamp O
of O
the O
command O
. O

The O
TinyZBot O
command O
parser O
ignores O
it O
. O

The O
RUNCMD O
line O
requests O
that O
cmd.exe B-Entity
be B-Action
executed I-Action
, O
with O
the O
command O
ipconfig O
/all O
being O
redirected O
to O
a O
file O
in O
a O
directory O
designated O
for O
files O
to O
be O
uploaded O
. O

The O
UPLOAD O
command O
requests O
that O
this B-Entity
file I-Entity
is B-Action
then I-Action
uploaded I-Action
over B-Modifier
SOAP B-Entity
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O

The O
DELETE O
command O
then O
requests O
that O
the B-Entity
file I-Entity
be B-Action
deleted I-Action
from B-Modifier
the B-Entity
infected I-Entity
system I-Entity
. O

The O
following O
is O
a B-Entity
list I-Entity
of I-Entity
supported I-Entity
commands I-Entity
that O
TinyZBot B-Entity
responds B-Action
to B-Modifier
: O
Commands B-Entity
such I-Entity
as I-Entity
GETINFO I-Entity
are B-Action
often I-Action
run I-Action
on B-Modifier
newly B-Entity
infected I-Entity
systems I-Entity
, O
as O
they B-Entity
decide B-Action
whether B-Entity
the I-Entity
infection I-Entity
has I-Entity
hit I-Entity
the I-Entity
correct I-Entity
target I-Entity
. O

There O
are O
additional O
SOAP O
commands O
, O
but O
they O
will O
not O
be O
covered O
in O
detail O
. O

The O
following O
is O
a O
list O
of O
all O
the O
SOAP O
commands O
: O
CheckFileMD5 O
, O
GetFile O
, O
GetFileList O
, O
GetServerTime O
, O
UploadFile O
. O

TinyZBot B-Entity
is B-Action
commonly I-Action
installed I-Action
using B-Modifier
some B-Entity
form I-Entity
of I-Entity
deception I-Entity
. O

Recent B-Entity
versions I-Entity
use B-Action
the B-Entity
resume- I-Entity
based I-Entity
methods I-Entity
reported I-Entity
in I-Entity
the I-Entity
Initial I-Entity
Compromise I-Entity
sections I-Entity
. O

An O
additional O
method O
was O
used O
for O
earlier O
versions O
. O

When O
early O
versions O
of O
TinyZBot O
were O
executed O
, O
they B-Entity
opened B-Action
an B-Entity
image I-Entity
stored I-Entity
in I-Entity
the I-Entity
resource I-Entity
section I-Entity
of I-Entity
the I-Entity
executable I-Entity
and O
copied B-Action
the B-Entity
malicious I-Entity
TinyZBot I-Entity
executable I-Entity
to B-Modifier
the B-Entity
% I-Entity
AppData I-Entity
% I-Entity
directory I-Entity
. O

Many O
of O
the O
images O
identified O
were O
of O
the O
popular O
Lebanese O
singer O
and O
actress O
Haifa O
Wehbe O
. O

The B-Entity
backdoor I-Entity
additionally O
replaced B-Action
the B-Entity
original I-Entity
malicious I-Entity
executable I-Entity
with B-Modifier
an B-Entity
appropriately I-Entity
named I-Entity
image I-Entity
file I-Entity
and O
padded B-Action
the B-Entity
image I-Entity
file I-Entity
with B-Modifier
null B-Entity
bytes I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
mirror B-Entity
the I-Entity
original I-Entity
file I-Entity
size I-Entity
. O

The O
earliest O
known O
version O
on O
TinyZBot O
was O
compiled O
on O
January O
27 O
, O
2013 O
. O

This O
early O
version O
had O
very O
little O
functionality O
. O

It B-Entity
was O
limited O
to O
logging B-Action
keystroke B-Entity
data I-Entity
, O
sending B-Action
emails B-Entity
, O
and O
creating B-Action
a B-Entity
link I-Entity
in B-Modifier
the B-Entity
user I-Entity
's I-Entity
startup I-Entity
folder I-Entity
for B-Modifier
persistence B-Entity
. O

Its B-Entity
method I-Entity
of I-Entity
exfiltrating I-Entity
the I-Entity
logged I-Entity
keystrokes I-Entity
relied B-Action
upon B-Modifier
a B-Entity
hardcoded I-Entity
email I-Entity
address I-Entity
stored I-Entity
in I-Entity
the I-Entity
binary I-Entity
. O

The O
sender O
email O
address O
was O
dyanachear O
( O
at O
) O
beyondsys.com O
and O
emails O
were O
destined O
for O
testmail00001 O
( O
at O
) O
yahoo.com O
. O

The B-Entity
message I-Entity
was O
intended O
to O
look O
like O
common O
Viagra O
spam O
from O
China O
, O
but O
would O
be B-Action
sent I-Action
with B-Modifier
the B-Entity
keystroke I-Entity
logging I-Entity
data I-Entity
as I-Entity
attachments I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
system I-Entity
information I-Entity
. O

The B-Entity
initial I-Entity
version I-Entity
did O
not O
provide O
any O
means O
of O
receiving O
commands O
and O
was B-Action
obfuscated I-Action
with B-Modifier
SmartAssembly B-Entity
. O

The O
following O
iteration O
compiled O
on O
March O
12 O
, O
2013 O
, O
only O
contained O
minor O
bug O
fixes O
. O

The O
next O
version O
was O
compiled O
on O
April O
24 O
, O
2013 O
. O

This O
version O
starts O
to O
look O
more O
like O
an O
average O
bot O
. O

A B-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
was B-Action
established I-Action
, O
using B-Action
HTTP B-Entity
and I-Entity
SOAP I-Entity
for B-Modifier
the B-Entity
protocol I-Entity
. O

The B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
for I-Entity
this I-Entity
version I-Entity
was B-Action
located I-Action
at B-Modifier
173.192.144.68/ B-Entity
DefaultWS I-Entity
( I-Entity
dot I-Entity
) I-Entity
asmx I-Entity
. O

This O
new O
command O
and O
control O
protocol O
allowed O
for O
the O
addition O
of O
quite O
a O
few O
other O
features O
. O

An O
update O
mechanism O
was O
added O
, O
and O
could O
be O
regularly O
scheduled O
, O
so O
unassisted B-Entity
periodic I-Entity
update I-Entity
checks I-Entity
were B-Action
automatically I-Action
performed I-Action
. O

The O
SOAP O
API O
used O
a O
dynamic O
password O
mechanism O
, O
which O
required O
the O
computation O
of O
a O
simple O
key O
in O
order O
to O
access O
certain O
parts O
of O
the O
API O
. O

The B-Entity
email I-Entity
data I-Entity
exfiltration I-Entity
method I-Entity
also O
underwent B-Action
modification B-Entity
to B-Modifier
be B-Entity
activated I-Entity
at I-Entity
a I-Entity
scheduled I-Entity
interval I-Entity
. O

There O
were O
also O
some O
changes O
, O
which O
looked O
to O
be O
bug O
fixes O
, O
such O
as O
limiting O
the O
number O
of O
times O
sending O
an O
email O
could O
fail O
. O

The O
next O
day O
, O
April O
25 O
, O
2013 O
, O
a B-Entity
new I-Entity
version I-Entity
was O
compiled O
which O
allowed B-Action
for B-Modifier
self-deletion B-Entity
. O

On O
May O
14 O
, O
2013 O
, O
we O
noticed O
a O
change O
which O
assisted O
in O
the O
identification O
of O
active O
targets O
. O

The B-Entity
AppUsageId I-Entity
( I-Entity
at I-Entity
this I-Entity
point I-Entity
named I-Entity
AppType I-Entity
) I-Entity
was O
an O
identifier O
used O
by O
this O
organization O
in O
order O
to O
differentiate B-Action
between B-Entity
targets I-Entity
infected I-Entity
with I-Entity
TinyZBot I-Entity
, O
meaning O
they B-Entity
could O
effectively O
run B-Action
multiple B-Entity
campaigns I-Entity
using B-Modifier
the B-Entity
same I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
and O
know B-Action
which B-Entity
target I-Entity
was I-Entity
infected I-Entity
. O

This O
also O
allowed O
for O
separate B-Entity
commands I-Entity
to O
be B-Action
supplied I-Action
to B-Modifier
different B-Entity
targets I-Entity
without O
the O
need O
for O
per-bot O
commands O
. O

At O
this O
time O
, O
the O
AppUsageId O
was O
total0 O
, O
but O
later O
we O
observed O
names O
, O
which O
aligned O
with O
active O
targets O
. O

The B-Entity
exfiltration I-Entity
email I-Entity
address I-Entity
was B-Action
also I-Action
changed I-Action
to B-Modifier
TerafficAnalyzer B-Entity
( I-Entity
at I-Entity
) I-Entity
yahoo.com I-Entity
. O

On O
June O
17 O
, O
2013 O
, O
there O
was O
an O
addition O
that O
allowed O
for O
the O
loading O
of O
configuration O
data O
from O
the O
PE O
's O
resources O
. O

At O
this O
time O
, O
it O
was O
limited O
to O
the O
exfiltration O
email O
address O
. O

This O
version O
was O
not O
obfuscated O
with O
SmartAssembly O
We O
do O
not O
see O
a O
new O
version O
of O
TinyZBot O
until O
June O
7 O
, O
2014 O
. O

There O
are O
quite O
a O
few O
notable O
improvements O
, O
but O
nowhere O
near O
enough O
to O
indicate O
consistent O
development O
on O
the O
project O
for O
a O
year O
. O

SmartAssembly B-Entity
was B-Action
reused I-Action
again O
. O

A B-Entity
method I-Entity
was O
added O
to O
detect B-Action
what B-Entity
security I-Entity
related I-Entity
software I-Entity
is I-Entity
installed I-Entity
. O

Avira B-Entity
antivirus I-Entity
was B-Action
specifically I-Action
targeted I-Action
and I-Action
disabled I-Action
, O
due O
to O
its O
detection O
of O
the B-Entity
new I-Entity
keystroke I-Entity
logger I-Entity
module I-Entity
added B-Action
in B-Modifier
this B-Entity
version I-Entity
. O

This B-Entity
keystroke I-Entity
logger I-Entity
source I-Entity
is B-Action
publicly B-Entity
available I-Entity
and I-Entity
referred I-Entity
to I-Entity
as I-Entity
DeadkeyLogger I-Entity
. O

A O
new O
string O
encryption O
class O
is O
added O
, O
but O
the O
code O
was O
copied O
and O
pasted O
from O
a O
Microsoft O
example O
. O

The B-Entity
ability I-Entity
to I-Entity
extract I-Entity
Internet I-Entity
Explorer I-Entity
passwords I-Entity
was B-Action
added I-Action
. O

Clipboard B-Entity
monitoring I-Entity
code I-Entity
was B-Action
added I-Action
, O
but O
not O
invoked O
. O

The O
emailing O
features O
were O
removed O
, O
but O
the O
classes O
which O
previously O
contained O
them O
were O
still O
present O
but O
empty O
. O

Many O
more O
options O
were O
enabled O
to O
be O
loaded O
from O
PE O
resources O
. O

The O
ability O
to O
add O
PE O
resources O
was O
added O
. O

Another O
version O
was O
compiled O
on O
June O
7 O
, O
2014 O
, O
with O
no O
feature O
difference O
. O

On O
June O
17 O
, O
2014 O
, O
we O
see2the O
first O
instance O
of O
Binder1 O
, O
which O
is O
aptly O
named O
, O
as O
it O
is O
a O
binder O
. O

The O
legitimate O
application O
used O
in O
this O
version O
of O
Binder1 O
was O
compiled O
on O
August O
22 O
, O
2013 O
, O
and O
is O
a O
self-extracting O
archive O
of O
desktop O
wallpapers O
, O
including O
an O
image O
from O
the O
game O
Mirror's O
Edge O
. O

The O
TinyZBot O
included O
was O
the O
version O
compiled O
on O
June O
7 O
, O
2014 O
. O

The B-Entity
version I-Entity
compiled I-Entity
on I-Entity
June I-Entity
23 I-Entity
, I-Entity
2014 I-Entity
, O
added O
functionality O
which O
allowed B-Action
screenshots B-Entity
of I-Entity
the I-Entity
desktop I-Entity
to B-Modifier
be B-Entity
taken I-Entity
. O

On O
August O
2 O
, O
2014 O
, O
we O
see O
another O
version O
without O
SmartAssembly O
obfuscation O
. O

A B-Entity
bug I-Entity
fix I-Entity
is B-Action
made I-Action
to B-Modifier
the B-Entity
keystroke I-Entity
logging I-Entity
method I-Entity
, O
and O
clipboard B-Entity
monitoring I-Entity
is B-Action
enabled I-Action
. O

Three O
items O
were O
compiled O
on O
August O
18 O
, O
2014 O
. O

Two O
of O
them O
are O
TinyZBot O
binaries O
, O
which O
contain O
a O
minor O
key O
logging O
bug O
fix O
. O

The O
third O
is O
a O
new O
Binder1 O
instance O
, O
which O
contains O
one O
of O
the O
TinyZBot O
instances O
compiled O
that O
day O
. O

The O
legitimate O
application O
included O
in O
this O
binder O
is O
called O
Easyresumecreator O
and O
is O
a O
legitimate O
application O
named O
EasyRésuméCreatorPro O
. O

This O
version O
targeted O
a O
major O
Saudi O
Arabian O
oil O
company O
. O

From O
August O
23 O
to O
August O
26 O
, O
2014 O
, O
new O
versions O
of O
TinyZBot O
were O
compiled O
with O
the O
AppUsageIds O
targeting O
major O
oil O
and O
gas O
companies O
in O
Qatar O
and O
Kuwait O
, O
Ministries O
of O
Foreign O
Affairs O
in O
the O
Persian O
Gulf O
, O
and O
a O
major O
airline O
holding O
company O
in O
UAE O
. O

These O
versions O
of O
TinyZBot O
moved O
towards O
a O
more O
modular O
architecture O
where O
each O
component O
was O
in O
its O
own O
.NET O

assembly O
. O

This B-Entity
was O
presumably O
done O
to O
limit B-Action
antivirus B-Entity
detection I-Entity
of I-Entity
each I-Entity
individual I-Entity
file I-Entity
as O
well O
as O
allow O
for O
dynamic O
updating O
of O
specific O
modules O
. O

All O
of O
these O
were O
included O
in O
their O
own O
Binder1 O
instance O
, O
which O
also O
dropped O
Easyresumecreator O
. O

There O
also O
seem O
to O
be O
improved O
software O
engineering O
practices O
in O
many O
locations O
. O

FTP B-Entity
upload I-Entity
support I-Entity
was B-Action
added I-Action
, O
with B-Modifier
hardcoded B-Entity
credentials I-Entity
of I-Entity
ano:1 I-Entity
. O

This B-Entity
FTP I-Entity
upload I-Entity
functionality I-Entity
points B-Action
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
, O
and O
is B-Action
invoked I-Action
by B-Modifier
a B-Entity
command I-Entity
in I-Entity
the I-Entity
SOAP I-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
. O

These B-Entity
versions I-Entity
have O
the O
capability O
to O
install B-Action
as B-Modifier
a B-Entity
service I-Entity
. O

On O
August O
25 O
, O
2014 O
, O
the O
version O
compiled O
on O
August O
18 O
was O
submitted O
to O
VirusTotal O
in O
a O
ZIP O
archive O
located O
at O
http O
: O
//dl.doosan-job O
( O
dot O
) O
com/cv/EasyResumeCreator- O
v2.0.zip O
. O

This O
indicates O
that O
TinyZBot B-Entity
is O
not O
only O
being B-Action
installed I-Action
while B-Modifier
impersonating B-Entity
a I-Entity
résumé I-Entity
creation I-Entity
suite I-Entity
, O
but O
is B-Action
also I-Action
impersonating I-Action
potential B-Entity
employers I-Entity
when B-Modifier
distributed B-Entity
. O

On O
September O
9 O
, O
2014 O
, O
a O
ZIP O
file O
containing O
TinyZBot O
and O
a O
configuration O
targeting O
a O
major O
US O
university O
with O
its O
AppUsageId O
was O
created O
. O

This O
was O
discovered O
on O
an O
anonymous O
FTP O
server O
in O
the O
same O
IP O
range O
as O
dl.doosan-job O
( O
dot O
) O
com O
along O
with O
other O
malware O
. O

From O
September O
11 O
through O
September O
17 O
, O
2014 O
, O
some O
TinyZBot O
components O
were O
compiled O
, O
along O
with O
a O
new O
dropper O
. O

This B-Entity
dropper I-Entity
impersonated B-Action
a B-Entity
tool I-Entity
to I-Entity
submit I-Entity
a I-Entity
résumé I-Entity
to I-Entity
Teledyne I-Entity
. O

When O
executed O
, O
the O
user O
is O
prompted O
to O
enter O
personal O
information O
, O
and O
at O
the O
end O
is O
given O
a O
button O
to O
submit O
the O
résumé O
to O
Teledyne O
, O
although O
nothing O
is O
actually O
submitted O
. O

While B-Modifier
the B-Entity
user I-Entity
enters I-Entity
this I-Entity
information I-Entity
, O
their B-Entity
machine I-Entity
is B-Action
infected I-Action
with B-Modifier
TinyZBot B-Entity
. O

The O
AppUsageIds O
for O
these O
versions O
target O
a O
major O
US-based O
university O
as O
well O
as O
an O
Israeli O
aerospace O
company O
. O

These B-Entity
versions I-Entity
began O
to O
include B-Action
a B-Entity
new I-Entity
method I-Entity
of I-Entity
installing I-Entity
as I-Entity
a I-Entity
service I-Entity
. O

The O
service O
runs O
with O
the O
name O
Network O
Connectivity O
Manager O
. O

TinyZBot O
, O
as O
well O
as O
some O
other O
tools O
( O
Csext O
, O
Net O
Crawler O
) O
initially O
would O
not O
run O
without O
a O
command O
line O
parameter O
set O
. O

This B-Entity
was O
likely O
to O
avoid B-Action
detonation-based B-Entity
detection I-Entity
engines I-Entity
. O

This O
command O
line O
parameter O
was O
opensesemi O
which O
is O
often O
stored O
in O
the O
application O
's O
code O
in O
an O
obfuscated O
manner O
. O

The O
binders O
and O
droppers O
for O
TinyZBot O
provided O
this O
command O
line O
argument O
and O
others O
when O
executing O
. O

TinyZBot O
uses O
a O
dynamic O
mutex O
. O

This O
was O
accomplished O
by O
combining O
a O
static O
preset O
prefix O
with O
the O
active O
process O
ID O
. O

This O
allowed O
supplemental B-Entity
tools I-Entity
to O
keep O
TinyZBot O
running O
by O
enumerating B-Action
every B-Entity
process I-Entity
and O
checking O
if O
the O
process O
ID O
and O
mutex O
prefix O
existed O
. O

If B-Modifier
no B-Entity
mutex I-Entity
and I-Entity
process I-Entity
pair I-Entity
was I-Entity
located I-Entity
, O
another B-Entity
TinyZBot I-Entity
instance I-Entity
would O
be B-Action
started I-Action
. O

Multiple B-Entity
backdoors I-Entity
were B-Action
used I-Action
by O
this B-Entity
organization I-Entity
. O

These O
are O
scripts B-Entity
or I-Entity
applications I-Entity
that O
allowed B-Action
for B-Modifier
command B-Entity
or I-Entity
code I-Entity
execution I-Entity
outside I-Entity
of I-Entity
the I-Entity
victim I-Entity
network I-Entity
. O

Many B-Entity
of I-Entity
their I-Entity
backdoors I-Entity
were B-Action
web B-Entity
applications I-Entity
, O
added O
to O
web O
servers O
, O
so O
commands B-Entity
can O
be B-Action
executed I-Action
from B-Modifier
a B-Entity
browser I-Entity
or I-Entity
client I-Entity
able I-Entity
to I-Entity
communicate I-Entity
with I-Entity
them I-Entity
. O

This B-Entity
group I-Entity
includes B-Action
the B-Entity
results I-Entity
of I-Entity
the I-Entity
Shell I-Entity
Creator I-Entity
mentioned I-Entity
in I-Entity
the I-Entity
Attribution I-Entity
section I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
ASPX I-Entity
backdoors I-Entity
used I-Entity
by I-Entity
Nesha I-Entity
. O

A B-Entity
PHP I-Entity
shell I-Entity
was B-Action
also I-Action
observed I-Action
, O
which O
also O
included O
attribution O
to O
Nesha O
in O
its O
hashed O
password O
. O

An B-Entity
ASPX I-Entity
backdoor I-Entity
named I-Entity
Zh0uSh311 I-Entity
was B-Action
located I-Action
on B-Modifier
live B-Entity
servers I-Entity
as O
well O
as O
recovered B-Action
fro B-Modifier
a B-Entity
staging I-Entity
server I-Entity
. O

This O
backdoor O
does O
not O
require O
authentication O
, O
and O
its O
use O
appears O
to O
be O
straightforward O
. O

Its B-Entity
functionality I-Entity
breaks B-Action
down I-Action
into B-Modifier
three O
fairly O
standard O
components O
: O
SQL B-Entity
queries I-Entity
, O
executing B-Entity
commands I-Entity
, O
and O
uploading B-Entity
files I-Entity
. O

This B-Entity
organization I-Entity
utilized B-Action
backdoors B-Entity
which O
masqueraded B-Action
as B-Modifier
varying B-Entity
versions I-Entity
of I-Entity
Notepad I-Entity
. O

They O
replace O
the O
existing O
Notepad.exe O
on O
the O
infected O
machine O
, O
and O
when O
run O
they B-Entity
call B-Action
out I-Action
to B-Modifier
a B-Entity
remote I-Entity
server I-Entity
and O
execute B-Action
any B-Entity
shell I-Entity
code I-Entity
returned I-Entity
by I-Entity
the I-Entity
remote I-Entity
server I-Entity
. O

There O
will O
be O
a O
detailed O
analysis O
of O
these O
backdoors O
posted O
to O
Cylance O
's O
blog O
in O
the O
future O
. O

PVZ O
is O
a O
name O
for O
a O
set O
of O
executables O
used O
together O
to O
create O
a O
botnet O
. O

The O
name O
PVZ O
was O
assigned O
by O
us O
as O
this O
is O
one O
of O
the O
few O
tools O
this O
organization O
has O
not O
named O
themselves O
. O

The O
components O
are O
as O
follows O
: O
XYNTService O
was O
not O
developed O
by O
the O
Cleaver O
team O
, O
but O
instead O
is O
a B-Entity
publicly I-Entity
available I-Entity
project I-Entity
which O
executes B-Action
an B-Entity
executable I-Entity
as B-Modifier
a B-Entity
service I-Entity
. O

The O
purpose O
of O
PVZ-In B-Entity
is O
to O
communicate B-Action
with B-Modifier
a B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O

Communication O
is O
primarily O
unidirectional O
, O
as O
little O
information O
is O
provided O
from O
the O
bot O
to O
its O
command O
and O
control O
server O
. O

The B-Entity
known I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
is B-Action
located I-Action
at B-Modifier
http B-Entity
: I-Entity
//kundenpflege I-Entity
. I-Entity
menrad I-Entity
( I-Entity
dot I-Entity
) I-Entity
de/js/jquery/default.aspx I-Entity
and O
the B-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
only O
uses B-Action
HTTP B-Entity
. O

The B-Entity
commands I-Entity
as I-Entity
well I-Entity
as I-Entity
infected I-Entity
computer I-Entity
information I-Entity
are B-Action
transferred I-Action
in B-Modifier
the B-Entity
Content- I-Entity
Disposition I-Entity
HTTP I-Entity
header I-Entity
, O
making O
the B-Entity
traffic I-Entity
easy O
to O
pass B-Action
over I-Action
as B-Modifier
benign B-Entity
. O

When O
a B-Entity
command I-Entity
is B-Action
received I-Action
from B-Modifier
the B-Entity
server I-Entity
, O
the B-Entity
results I-Entity
are B-Action
stored I-Action
in B-Modifier
a B-Entity
central I-Entity
location I-Entity
on I-Entity
disk I-Entity
that I-Entity
the I-Entity
PVZ I-Entity
tools I-Entity
utilize I-Entity
. O

Command B-Entity
functionality I-Entity
is B-Action
limited I-Action
to B-Modifier
executing B-Entity
supplied I-Entity
commands I-Entity
, O
downloading B-Entity
and O
executing B-Entity
executables I-Entity
as O
well O
as O
self-updating B-Entity
. O

The O
debug O
file O
path O
for O
PVZ-In O
is O
: O
PVZ-In O
has O
been O
observed O
using O
the O
file O
name O
ossisvc.exe O
. O

PVZ-Out B-Entity
is B-Action
the B-Entity
other I-Entity
half I-Entity
of I-Entity
the I-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
, O
primarily O
uploading B-Action
results B-Entity
of I-Entity
commands I-Entity
and I-Entity
keystroke I-Entity
logging I-Entity
data I-Entity
to B-Modifier
a B-Entity
remote I-Entity
server I-Entity
. O

The B-Entity
known I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
for I-Entity
PVZ-Out I-Entity
is B-Action
located I-Action
at B-Modifier
http B-Entity
: I-Entity
//www.gesunddurchsjahr I-Entity
( I-Entity
dot I-Entity
) I-Entity
de/tor/default.aspx I-Entity
. O

Much O
like O
PVZ-In O
, O
this B-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
communicates B-Action
with B-Modifier
the B-Entity
Content-Disposition I-Entity
HTTP I-Entity
header I-Entity
, O
but O
for B-Modifier
file B-Entity
data I-Entity
, O
POST B-Entity
data I-Entity
is B-Action
supplied I-Action
. O

Data B-Entity
uploaded I-Entity
is B-Action
often I-Action
compressed I-Action
, O
which O
can O
make B-Action
it B-Entity
more B-Entity
difficult I-Entity
to I-Entity
detect I-Entity
the I-Entity
exfiltration I-Entity
of I-Entity
sensitive I-Entity
information I-Entity
. O

The O
debug O
file O
path O
for O
PVZ-Out O
is O
: O
PVZ-Out O
has O
been O
observed O
with O
the O
file O
name O
osppsvc.exe O
. O

SYN B-Entity
Flooder I-Entity
is B-Action
a B-Entity
simple I-Entity
network I-Entity
based I-Entity
denial I-Entity
of I-Entity
service I-Entity
tool I-Entity
. O

It O
is O
a B-Entity
command I-Entity
line I-Entity
utility I-Entity
capable O
of O
being B-Action
invoked I-Action
by O
PVZ-In B-Entity
. O

Targeting O
information O
is O
supplied O
via O
command O
line O
parameters O
. O

The O
debug O
file O
path O
for O
SYN O
Flooder O
is O
: O
SYN O
Flooder O
has O
been O
observed O
using O
the O
name O
ossysvc.exe O
. O

Logger B-Entity
Module I-Entity
observes B-Action
the B-Entity
user I-Entity
's I-Entity
actions I-Entity
and O
records B-Action
them B-Entity
to B-Modifier
a B-Entity
file I-Entity
. O

The B-Entity
recorded I-Entity
actions I-Entity
include B-Action
mouse B-Entity
clicks I-Entity
, O
active B-Entity
windows I-Entity
, O
keypresses B-Entity
, O
as O
well O
as O
clipboard B-Entity
data I-Entity
. O

The B-Entity
resulting I-Entity
log I-Entity
is B-Action
written I-Action
out I-Action
to O
a O
location O
where O
PVZ-Out B-Entity
can O
exfiltrate B-Action
it B-Entity
to B-Modifier
its B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O

Logger O
Module O
has O
been O
observed O
using O
the O
name O
ospcsvc.exe O
. O

The B-Entity
following I-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
for I-Entity
Logger I-Entity
Module I-Entity
have O
been B-Action
observed I-Action
: O
WndTest O
is O
the O
evolution O
of O
the O
PVZ O
tool O
chain O
into O
a O
single O
executable O
. O

The B-Entity
tool I-Entity
chain I-Entity
is B-Action
minimized I-Action
down I-Action
to B-Modifier
a B-Entity
command I-Entity
and I-Entity
control I-Entity
communications I-Entity
, O
keystroke B-Entity
logging I-Entity
, O
and O
clipboard B-Entity
monitoring I-Entity
. O

The B-Entity
command I-Entity
and I-Entity
control I-Entity
still O
supports O
upgrading B-Action
, O
downloading B-Action
, O
and O
executing B-Action
of O
applications B-Entity
, O
as O
well O
as O
executing B-Action
batch B-Entity
scripts I-Entity
. O

WndTest B-Entity
installs B-Action
as B-Modifier
a B-Entity
service I-Entity
and O
has O
been O
observed O
attempting O
to O
impersonate B-Action
Adobe B-Entity
Report I-Entity
Service I-Entity
. O

WndTest B-Entity
starts O
using B-Action
PHP B-Entity
servers I-Entity
for B-Modifier
its B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
, O
some O
of O
which O
are O
listed O
as O
defaced O
sites O
. O

We O
have O
seen O
wndTest B-Entity
communicate B-Action
with B-Modifier
the B-Entity
following I-Entity
servers I-Entity
: O
Csext B-Entity
is B-Action
a B-Entity
backdoor I-Entity
application I-Entity
developed I-Entity
in I-Entity
C I-Entity
# I-Entity
which O
runs B-Action
as B-Modifier
a B-Entity
service I-Entity
. O

Its O
primary O
functionality O
is O
based O
on O
commands O
supplied O
by O
its O
configuration O
file O
. O

The O
configuration O
file O
is O
able O
to O
store O
specific O
commands O
, O
which O
are O
intended O
to O
run O
at O
particular O
times O
. O

A O
recovered O
configuration O
is O
as O
follows O
: O
This B-Entity
configuration I-Entity
executes B-Action
zhCat B-Entity
to O
connect B-Action
back B-Modifier
to I-Modifier
srv01.microsoftwindowsupdate B-Entity
( I-Entity
dot I-Entity
) I-Entity
net I-Entity
( I-Entity
a I-Entity
deceptive I-Entity
domain I-Entity
owned I-Entity
by I-Entity
this I-Entity
group I-Entity
with I-Entity
falsified I-Entity
Whois I-Entity
data I-Entity
attributing I-Entity
to I-Entity
Microsoft I-Entity
Investor I-Entity
Relations I-Entity
) I-Entity
with B-Modifier
XORed B-Entity
communication I-Entity
using B-Modifier
the B-Entity
HTTP I-Entity
protocol I-Entity
on B-Modifier
TCP B-Entity
port I-Entity
443 I-Entity
. O

This B-Entity
zhCat I-Entity
instance I-Entity
is B-Action
running I-Action
cmd.exe B-Entity
, O
effectively O
making B-Action
it B-Entity
a B-Entity
reverse I-Entity
connecting I-Entity
shell I-Entity
. O

This B-Entity
command I-Entity
runs O
at O
00:29 O
in O
the O
morning O
, O
and O
is B-Action
killed I-Action
by O
taskkill B-Entity
at B-Modifier
00:35 B-Entity
. O

This O
gives O
the B-Entity
attackers I-Entity
a O
predictable O
method O
to O
regain B-Action
access B-Entity
to I-Entity
a I-Entity
compromised I-Entity
network I-Entity
if B-Modifier
they B-Entity
ever I-Entity
lose I-Entity
access I-Entity
. O

Csext B-Entity
also O
has B-Action
email B-Entity
functionality I-Entity
similar I-Entity
to I-Entity
TinyZBot I-Entity
. O

This B-Entity
email I-Entity
functionality I-Entity
is O
used O
to O
exfiltrate B-Action
the B-Entity
results I-Entity
of I-Entity
commands I-Entity
from I-Entity
the I-Entity
command I-Entity
file I-Entity
which I-Entity
can I-Entity
also I-Entity
include I-Entity
requests I-Entity
like I-Entity
gathering I-Entity
user I-Entity
information I-Entity
. O

We O
have O
seen O
Csext B-Entity
configured O
to O
communicate B-Action
with B-Modifier
the B-Entity
following I-Entity
servers I-Entity
: O
If O
after O
reviewing O
the O
Indicators O
of O
Compromise O
( O
IOC O
) O
listed O
in O
Appendix O
A O
, O
you O
believe O
your O
organization O
to O
be O
a O
victim O
of O
Operation O
Cleaver O
, O
we O
recommend O
you O
consider O
the O
following O
course O
of O
action O
: O
1 O
. O

If O
inside O
the O
United O
States O
, O
contact O
the O
Federal O
Bureau O
of O
Investigation O
( O
FBI O
) O
via O
either O
your O
local O
FBI O
team O
or O
FBI O
CYWATCH O
at O
1-855-292-3937 O
or O
cywatch O
@ O
ic.fbi.gov O
. O

2 O
. O

If O
outside O
the O
United O
States O
, O
contact O
your O
local O
, O
district O
, O
state O
or O
federal O
law O
enforcement O
authorities O
. O

3 O
. O

If O
you O
have O
visibility O
into O
the O
attacks O
on O
your O
company O
and O
the O
tools O
and O
expertise O
to O
track O
them O
down O
, O
leverage O
the O
IOCs O
in O
Appendix O
A O
to O
identify O
their O
presence O
in O
your O
network O
, O
prevent O
them O
from O
expanding O
the O
scope O
of O
the O
compromise O
, O
and O
remove O
their O
access O
immediately O
. O

4 O
. O

If O
you O
do O
NOT O
have O
visibility O
into O
the O
attacks O
, O
need O
help O
identifying O
an O
existing O
successful O
compromise O
in O
your O
organization O
, O
or O
more O
importantly O
wish O
to O
prevent O
this O
attack O
or O
attacks O
similar O
to O
Operation O
Cleaver O
, O
please O
contact O
your O
security O
provider O
. O

5 O
. O

If O
you O
wish O
to O
contact O
Cylance O
for O
additional O
details O
not O
available O
in O
this O
report O
, O
please O
email O
opcleaver O
@ O
cylance.com O
. O

6 O
. O

If O
you O
would O
like O
to O
learn O
more O
about O
Cylance O
products O
and O
professional O
services O
, O
or O
discuss O
how O
Cylance O
can O
mitigate O
Operation O
Cleaver O
's O
impact O
to O
your O
organization O
, O
please O
contact O
us O
directly O
. O

Iran O
in O
2014 O
can O
probably O
be O
best O
described O
as O
galvanizing O
. O

They O
have O
long O
been O
an O
'' O
enemy O
'' O
of O
the O
west O
, O
and O
the O
United O
States O
in O
particular O
, O
but O
today O
's O
headlines O
include O
a O
variety O
of O
topics O
from O
nuclear O
talks O
to O
human O
rights O
to O
terrorism O
to O
cyber O
hacking O
. O

Iran O
continues O
to O
be O
extremely O
active O
on O
the O
global O
stage O
– O
and O
thereby O
on O
the O
radar O
of O
every O
superpower O
. O

Iran O
's O
cyber O
sophistication O
has O
grown O
rapidly O
since O
the O
dawn O
of O
Stuxnet O
and O
they O
have O
used O
hard O
dollars O
combined O
with O
national O
pride O
to O
help O
build O
their O
cyber O
army O
. O

Few O
doubt O
their O
commitment O
as O
a O
government O
and O
nation O
state O
to O
funding O
and O
recruiting O
cyber O
warriors O
to O
infiltrate O
and O
damage O
their O
enemies O
. O

And O
it O
has O
been O
commonly O
postulated O
that O
almost O
all O
activity O
since O
2010 O
coming O
out O
of O
Iran O
is O
associated O
with O
retaliation O
for O
Stuxnet/Duqu/Flame O
, O
which O
seems O
natural O
given O
the O
severity O
of O
the O
impact O
. O

But O
they O
do O
n't O
need O
Stuxnet O
as O
motivation O
to O
want O
to O
hack O
the O
world O
. O

They O
have O
long O
desired O
power O
on O
the O
political O
stage O
, O
in O
particular O
in O
the O
fight O
for O
nuclear O
power O
autonomy O
. O

With O
the O
deadlines O
around O
the O
Iranian O
nuclear O
discussions O
pushed O
to O
2015 O
, O
the O
attacks O
may O
be O
tied O
to O
negotiating O
power O
when O
discussing O
a O
pact O
with O
the O
nuclear O
superpowers O
of O
United O
States O
, O
Britain O
, O
France O
, O
Germany O
, O
Russia O
and O
China O
. O

The O
inner O
workings O
of O
the O
Iranian O
government O
remain O
largely O
a O
mystery O
to O
the O
western O
world O
. O

However O
, O
Iran O
's O
control O
over O
its O
people O
and O
the O
private O
businesses O
birthed O
inside O
has O
been O
well O
reported O
. O

In O
a O
2014 O
Reuters O
article O
, O
the O
reporters O
detail O
how O
the O
secret O
Iranian O
organization O
called O
'' O
Setad O
Ejraiye O
Farmane O
Hazrate O
Emam O
'' O
has O
become O
one O
of O
the O
most O
powerful O
organizations O
in O
the O
country O
, O
capable O
of O
taking O
over O
properties O
and O
businesses O
, O
buying O
controlling O
interests O
in O
numerous O
sectors O
including O
finance O
, O
oil O
, O
telecommunications O
and O
many O
others O
totaling O
in O
upwards O
of O
$ O
95B O
. O

Even O
the O
US O
Treasury O
has O
documented O
an O
extensive O
fronting O
of O
companies O
in O
its O
report O
of O
Execution O
of O
Imam O
Khomeini O
's O
Order O
( O
EIKO O
) O
, O
which O
through O
its O
two O
main O
subsidiaries O
controls O
37 O
private O
businesses O
that O
are O
purely O
front O
companies O
for O
the O
Iranian O
government O
. O

The O
history O
of O
Iran O
controlling O
the O
usage O
of O
the O
Internet O
and O
the O
very O
Internet O
on-ramps O
into O
Iran O
is O
well O
known O
, O
. O

They O
have O
controlled O
much O
of O
the O
country O
's O
Internet O
access O
to O
date O
and O
have O
taken O
over O
controlling O
interests O
in O
those O
companies O
to O
carry O
out O
their O
work O
. O

Given O
Operation O
Cleaver's O
frequent O
spin-up O
and O
take-down O
of O
large O
IP O
blocks O
inside O
the O
AFRANET O
IP O
space O
inside O
Iran O
, O
and O
Iran O
's O
well O
recorded O
investment O
in O
cyber O
warfare O
leads O
us O
to O
one O
simple O
conclusion O
: O
Iran O
is O
extremely O
active O
in O
the O
world O
of O
hacking O
. O

Operation O
Cleaver O
's O
intense O
focus O
on O
critical O
infrastructure O
companies O
, O
especially O
in O
South O
Korea O
, O
hints O
at O
information O
sharing O
or O
joint O
operations O
with O
Iran O
's O
partner O
, O
North O
Korea O
. O

In O
September O
, O
2012 O
, O
Iran O
signed O
an O
extensive O
agreement O
for O
technology O
cooperation O
agreement O
with O
North O
Korea O
, O
which O
allows O
for O
collaboration O
on O
a O
variety O
of O
efforts O
including O
IT O
and O
security O
. O

Operation O
Cleaver O
's O
carefully O
selected O
targets O
like O
the O
oil O
and O
gas O
industry O
, O
energy O
and O
utility O
companies O
, O
as O
well O
as O
airlines O
and O
airports O
, O
indicates O
Iran O
's O
desire O
to O
gain O
deep O
access O
into O
the O
world O
's O
most O
critical O
environments O
. O

The O
end O
goal O
of O
this O
operation O
is O
not O
known O
at O
this O
time O
. O

University O
student O
recruitment O
was O
hinted O
at O
within O
Operation O
Cleaver O
and O
is O
consistent O
with O
Iran O
's O
reported O
history O
of O
active O
warrior O
recruitment O
in O
the O
educational O
space O
. O

Overall O
, O
there O
are O
many O
reasons O
that O
Iran O
may O
be O
pursuing O
the O
targets O
they O
did O
in O
Operation O
Cleaver O
. O

While O
we O
may O
never O
truly O
know O
, O
it O
is O
important O
to O
consider O
all O
the O
above O
and O
more O
when O
trying O
to O
understand O
the O
why O
. O

After O
tracking O
the O
Operation O
Cleaver O
team O
for O
over O
two O
years O
, O
we O
're O
led O
to O
the O
inexorable O
conclusion O
: O
the O
government O
of O
Iran O
, O
and O
particularly O
the O
Islamic O
Revolutionary O
Guard O
Corps O
( O
IRGC O
) O
, O
is O
backing O
numerous O
groups O
and O
front O
entities O
to O
attack O
the O
world O
's O
critical O
infrastructure O
. O

As O
security O
experts O
in O
Critical O
Infrastructure O
and O
Key O
Resources O
( O
CIKR O
) O
, O
Industrial O
Control O
Systems O
( O
ICS O
) O
, O
Supervisory O
Control O
and O
Data O
Acquisition O
( O
SCADA O
) O
systems O
, O
Building O
Management O
Systems O
( O
BMS O
) O
, O
embedded O
systems O
and O
fixed-function O
systems O
, O
we O
know O
how O
easy O
they O
are O
to O
hack O
. O

We O
have O
worked O
with O
countless O
customers O
and O
vendors O
throughout O
the O
years O
to O
notify O
them O
of O
vulnerabilities O
, O
assist O
with O
remediatation O
efforts O
, O
and O
help O
mitigate O
threats O
to O
their O
environments O
. O

Unfortunately O
, O
many O
critical O
infrastructure O
organizations O
are O
unable O
to O
secure O
their O
complex O
envirnoments O
against O
modern O
attacks O
. O

They O
fall O
victim O
to O
the O
'' O
glue O
flu O
'' O
, O
a O
malaise O
of O
feeling O
stuck O
, O
not O
wanting O
to O
change O
the O
status O
quo O
for O
fear O
they O
will O
find O
problems O
that O
they O
have O
no O
idea O
how O
to O
prevent O
. O

This O
'' O
security O
anaphylaxis O
'' O
spells O
real O
disaster O
. O

If O
Operation O
Cleaver O
does O
n't O
get O
the O
world O
to O
wake O
up O
to O
what O
is O
happening O
in O
the O
silent O
world O
of O
cyber O
, O
then O
perhaps O
nothing O
will O
. O

Prevention O
is O
everything O
and O
we O
should O
never O
give O
up O
until O
it's O
achieved O
. O

Challenge O
your O
trusted O
advisors O
. O

Challenge O
your O
security O
vendors O
. O

Demand O
better O
technology O
and O
services O
to O
detect O
, O
respond O
, O
but O
most O
importantly O
PREVENT O
not O
just O
contemporary O
attacks O
, O
but O
future O
exotic O
attacks O
that O
have O
yet O
to O
be O
imagined O
. O

That O
is O
what O
truly O
disruptive O
and O
innovative O
technology O
is O
. O

Do O
n't O
settle O
for O
anything O
less O
. O

We O
hope O
that O
by O
exposing O
the O
Operation O
Cleaver O
team O
to O
the O
world O
, O
current O
global O
critical O
infrastructure O
victims O
can O
be O
notified O
, O
and O
prevent O
future O
victimization O
from O
suffering O
the O
consequences O
of O
'' O
status O
quo O
'' O
security O
. O

Unlike O
United O
Flight O
811 O
, O
perhaps O
we O
can O
prevent O
the O
next O
disaster O
. O

DEFENDERS O
, O
NEVER O
GIVE O
UP O
! O
In O
the O
face O
of O
growing O
and O
evolving O
threats O
, O
traditional O
cyber O
protection O
technologies O
are O
now O
widely O
considered O
inadequate O
. O

The O
only O
way O
to O
regain O
the O
upper O
hand O
against O
a O
new O
generation O
of O
attackers O
, O
is O
to O
embrace O
something O
entirely O
new O
. O

Something O
that O
'' O
thinks O
'' O
like O
an O
attacker O
. O

Something O
that O
does O
n't O
rely O
on O
a O
trust O
model O
or O
care O
about O
hash O
lookups O
. O

Something O
with O
a O
brain O
. O

Cylance O
has O
eschewed O
the O
old O
foundations O
that O
existing O
cybersecurity O
products O
are O
built O
upon O
. O

Instead O
, O
we O
've O
based O
our O
approach O
on O
mathematics O
, O
machine O
learning O
, O
and O
data O
science O
. O

This O
algorithmic O
approach O
has O
been O
proven O
to O
detect O
– O
and O
stop O
– O
exponentially O
more O
modern O
threats O
. O

Leveraging O
algorithmic O
risk O
modeling O
, O
CylancePROTECT O
protects O
endpoints O
from O
everyday O
viruses O
, O
worms O
, O
trojans O
, O
and O
spyware O
, O
but O
unlike O
other O
security O
products O
, O
CylancePROTECT O
offers O
true O
future-proof O
protection O
against O
the O
most O
malicious O
threats O
in O
the O
world O
. O

Advanced O
Persistent O
Threats O
( O
APT O
) O
, O
0-days O
, O
and O
exotic O
exploitation O
techniques O
are O
easily O
detected O
and O
halted O
with O
little-to-no O
impact O
on O
the O
end-user O
. O

Existing O
reactive O
solutions O
rely O
on O
a O
constant O
stream O
of O
signature O
updates O
for O
threat O
detection O
, O
which O
is O
not O
only O
costly O
and O
inconvenient O
, O
but O
also O
requires O
'' O
sacrificial O
lambs O
'' O
. O

Only O
after O
a O
previously O
unseen O
threat O
has O
inflicted O
damage O
can O
the O
rest O
of O
the O
industry O
begin O
to O
detect O
it O
. O

CylancePROTECT O
does O
n't O
require O
constant O
updates O
or O
even O
a O
network O
connection O
to O
protect O
against O
so-called O
'' O
previously O
undetectable O
'' O
threats O
. O

By O
identifying O
and O
defusing O
attacks O
in O
near O
real O
time O
, O
before O
the O
attack O
can O
execute O
, O
we O
can O
finally O
do O
away O
with O
the O
need O
for O
a O
'' O
patient O
zero O
'' O
. O

As O
Richard O
Stiennon O
, O
Chief O
Research O
Analyst O
at O
IT-Harvest O
, O
put O
it O
, O
'' O
Many O
vendors O
are O
trying O
to O
solve O
the O
endpoint O
problem O
, O
yet O
Cylance O
is O
the O
only O
one O
using O
the O
power O
of O
math O
to O
stop O
malware O
and O
with O
more O
effectiveness O
and O
efficiency O
than O
current O
solutions O
'' O
. O

Interested O
in O
seeing O
what O
CylancePROTECT O
can O
do O
for O
your O
organization O
? O
Contact O
us O
! O
Cylance O
is O
one O
of O
the O
fastest O
growing O
cybersecurity O
technology O
firms O
in O
the O
US O
. O

Cylance O
's O
flagship O
product O
CylancePROTECT O
has O
been O
adopted O
by O
Fortune O
500 O
companies O
and O
government O
agencies O
across O
the O
globe O
. O

Cylance O
was O
founded O
by O
27-year O
security O
industry O
luminary O
, O
Stuart O
McClure O
, O
former O
Global O
CTO O
of O
McAfee O
, O
original O
founder O
of O
Foundstone O
, O
and O
lead O
author O
of O
the O
international O
best-selling O
book O
Hacking O
Exposed O
. O

In O
building O
Cylance O
, O
Stuart O
brought O
together O
the O
best O
scientific O
and O
executive O
minds O
from O
the O
likes O
of O
Cisco O
, O
Sourcefire O
, O
Google O
and O
McAfee O
. O

The O
Cylance O
board O
of O
advisors O
includes O
former O
high-ranking O
officials O
from O
the O
DHS O
, O
the O
FBI O
, O
CIA O
, O
and O
executive O
titans O
of O
business O
. O

CylancePROTECT O
is O
the O
only O
next O
generation O
endpoint O
security O
product O
that O
applies O
math O
to O
mute O
existing O
and O
future O
malware O
, O
viruses O
, O
worms O
, O
trojans O
, O
bots O
, O
APTs O
, O
0-days O
, O
exploits O
, O
adware O
, O
spyware O
and O
hacking O
tools O
– O
without O
needing O
any O
updates O
or O
even O
a O
connection O
to O
the O
Internet O
. O

The O
technology O
is O
founded O
on O
the O
principle O
that O
to O
fix O
the O
industry O
, O
you O
must O
start O
from O
scratch O
with O
a O
way O
as O
yet O
unseen O
. O

CylancePROTECT O
does O
not O
rely O
on O
signatures O
of O
any O
sort O
( O
blacklist O
or O
whitelist O
) O
, O
behavioral O
analysis O
using O
IOCs O
, O
sandboxing O
analysis O
, O
heuristics O
, O
micro-virtualization O
, O
or O
dynamic O
detonation O
– O
to O
detect O
and O
prevent O
malicious O
files O
from O
executing O
on O
a O
target O
endpoint O
. O

While O
every O
other O
endpoint O
security O
product O
must O
collect O
a O
sample O
, O
analyze O
, O
and O
write O
a O
signature O
to O
detect O
it O
, O
CylancePROTECT O
can O
detect O
malware O
before O
it O
executes O
by O
statically O
analyzing O
features O
found O
in O
the O
binary O
itself O
. O

Features O
and O
Benefits O
of O
CylancePROTECT O
: O
• O
Near O
real O
time O
detection O
of O
malicious O
files O
, O
even O
if O
they O
've O
never O
been O
seen O
in O
the O
wild O
. O

• O
Can O
be O
used O
to O
augment O
existing O
endpoint O
security O
or O
be O
deployed O
as O
a O
complete O
replacement O
. O

• O
Does O
not O
require O
any O
signature O
updates O
or O
connection O
to O
the O
cloud O
. O

• O
An O
easy-to-use O
web O
management O
console O
with O
intuitive O
workflows O
. O

• O
Low-impact O
endpoint O
agent O
. O

For O
a O
demo O
of O
CylancePROTECT O
, O
contact O
a O
Cylance O
expert O
today O
! O
Cylance O
's O
Professional O
Services O
team O
is O
available O
to O
assist O
companies O
affected O
by O
this O
campaign O
. O

Cylance O
is O
providing O
consulting O
to O
companies O
that O
may O
have O
been O
targeted O
by O
these O
advanced O
threat O
actors O
. O

Cylance O
will O
perform O
initial O
triage O
in O
order O
to O
determine O
the O
extent O
to O
which O
your O
company O
has O
been O
affected O
by O
this O
campaign O
and O
work O
towards O
establishing O
a O
containment O
strategy O
. O

Cylance O
has O
two O
tailored O
offerings O
for O
clients O
affected O
by O
this O
campaign O
. O

The O
first O
one O
includes O
ICS O
in O
our O
incident O
response O
since O
many O
companies O
affected O
are O
in O
the O
Critical O
Infrastructure O
and O
Key O
Resources O
( O
CIKR O
) O
vertical O
. O

The O
second O
offering O
's O
focus O
is O
to O
deploy O
our O
proprietary O
tools O
and O
methodologies O
to O
detect O
and O
mitigate O
the O
threats O
posed O
by O
Operation O
Cleaver O
. O

For O
more O
information O
on O
how O
the O
Cylance O
Professional O
Services O
team O
can O
assess O
and O
respond O
to O
attacks O
like O
the O
ones O
obseved O
in O
Operation O
Cleaver O
, O
contact O
sales O
@ O
cylance.com O
today O
. O

Brian O
is O
a O
Sr. O
Security O
Researcher O
for O
Cylance O
who O
joined O
shortly O
after O
the O
company O
was O
established O
. O

He O
is O
best O
known O
for O
his O
avid O
botnet O
research O
( O
often O
going O
by O
'' O
botnethunter O
'' O
) O
and O
for O
his O
novel O
malware O
analysis O
in O
the O
A O
Study O
in O
Bots O
blog O
series O
hosted O
by O
Cylance O
. O

Brian O
has O
been O
a O
dedicated O
open-source O
developer O
as O
well O
as O
an O
advocate O
for O
public O
and O
private O
anti-botnet O
operations O
. O

Brian O
actively O
develops O
techniques O
to O
combat O
cyber O
oppositions O
in O
positions O
where O
resources O
and O
leverage O
are O
in O
too O
limited O
of O
supply O
for O
conventional O
means O
. O

These O
techniques O
, O
cultivated O
by O
Stuart O
McClure O
, O
are O
the O
Art O
of O
Deterrence O
. O

In O
a O
previous O
investigation O
, O
Art O
of O
Deterrence O
techniques O
were O
successfully O
used O
to O
divert O
Indonesian O
hackers O
motivated O
by O
monetary O
gain O
away O
from O
their O
highest O
yielding O
target O
group O
. O

Brian O
's O
botnet O
research O
covers O
a O
wide O
range O
of O
topics O
, O
from O
using O
graph O
analysis O
to O
estimate O
the O
amount O
of O
ransom O
that O
has O
been O
paid O
to O
a O
ransomware O
operator O
, O
to O
utilizing O
IPv4 O
scanning O
techniques O
to O
identify O
and O
take O
down O
point O
of O
sale O
malware O
panels O
. O

Stuart O
is O
founder O
, O
CEO/President O
and O
Chairman O
of O
Cylance O
. O

Widely O
recognized O
for O
his O
extensive O
and O
in-depth O
knowledge O
of O
security O
products O
, O
Stuart O
McClure O
is O
considered O
one O
of O
the O
industry O
's O
leading O
authorities O
in O
information O
security O
today O
. O

A O
well-published O
and O
acclaimed O
security O
visionary O
with O
currently O
eleven O
books O
in O
print O
, O
McClure O
is O
the O
originating O
founder O
of O
the O
Hacking O
Exposed O
series O
of O
books O
, O
the O
most O
successful O
security O
book O
ever O
written O
. O

From O
his O
work O
, O
he O
founded O
Foundstone O
in O
October O
of O
1999 O
which O
sold O
to O
McAfee O
in O
2004 O
. O

McClure O
brings O
over O
two O
decades O
of O
technology O
and O
executive O
leadership O
with O
profound O
technical O
, O
operational O
, O
and O
financial O
experience O
. O

Besides O
Foundstone O
, O
Stuart O
held O
leadership O
positions O
at O
InfoWorld O
, O
Ernst O
& O
Young O
, O
Kaiser O
Permanente O
and O
a O
number O
of O
government O
agencies O
. O

At O
McAfee O
, O
McClure O
held O
numerous O
positions O
including O
SVP/General O
Manager O
for O
the O
Security O
Management O
BU O
as O
well O
as O
EVP/Global O
Chief O
Technology O
Officer O
responsible O
for O
almost O
$ O
3B O
worth O
of O
revenues O
. O

Today O
, O
McClure O
is O
CEO O
of O
Cylance O
, O
a O
disruptive O
and O
innovative O
startup O
applying O
math O
to O
the O
problem O
of O
security O
. O

Cylance O
products O
such O
as O
CylancePROTECT O
prevent O
the O
most O
advanced O
attacks O
in O
the O
world O
without O
signatures O
or O
sandboxing O
in O
realtime O
on O
the O
endpoint O
. O

Cylance O
Services O
offer O
highly O
specialized O
security O
services O
such O
as O
incident O
response O
, O
forensics O
, O
compromise O
assessments O
and O
advanced O
penetration O
assessments O
for O
global O
critical O
infrastructure O
. O

Cylance O
employees O
work O
passionately O
and O
tirelessly O
every O
day O
to O
achieve O
one O
goal O
: O
Protect O
the O
world O
from O
cyber O
attacks O
. O

And O
with O
their O
efforts O
in O
tracking O
Operation O
Cleaver O
, O
they O
have O
achieved O
that O
goal O
. O

Our O
endless O
thanks O
to O
all O
the O
Cylancers O
who O
contributed O
to O
this O
report O
. O

The O
Operation O
Cleaver O
logo O
, O
created O
by O
Cylance O
specifically O
for O
this O
report O
, O
was O
inspired O
by O
the O
infamous O
logo O
used O
by O
the O
Army O
of O
the O
Guardians O
of O
the O
Islamic O
Revolution O
, O
also O
known O
in O
the O
west O
as O
the O
Iranian O
Revolutionary O
Guard O
Corps O
( O
IRGC O
) O
. O

Due O
to O
the O
close O
connection O
between O
the O
members O
tracked O
in O
this O
report O
and O
the O
IRGC O
, O
it O
was O
only O
fitting O
to O
replicate O
the O
look O
and O
feel O
of O
the O
IRGC O
's O
iconography O
as O
the O
anchor O
for O
this O
document O
's O
branding O
. O

The O
striking O
visual O
elements O
that O
make O
up O
the O
logo O
of O
the O
IRGC O
have O
very O
specific O
meanings O
: O
• O
The O
clenched O
fist O
holding O
a O
rifle O
, O
most O
likely O
an O
AK-47 O
, O
represents O
armed O
resistance O
. O

• O
The O
globe O
symbolizes O
the O
IRGC O
's O
worldwide O
ambitions O
. O

• O
The O
book O
, O
from O
which O
the O
clenched O
first O
emanates O
, O
represents O
the O
Qur'an O
, O
connecting O
the O
religious O
ideals O
on O
which O
the O
group O
was O
founded O
to O
the O
armed O
struggle O
. O

• O
The O
plants O
, O
possibly O
wheat O
, O
represent O
prosperity O
. O

• O
The O
name O
of O
the O
group O
in O
Persian O
, O
the O
year O
in O
which O
it O
was O
founded O
and O
a O
passage O
from O
the O
Qur'an O
( O
8:60 O
) O
'And O
make O
ready O
against O
them O
all O
you O
can O
of O
power O
' O
, O
are O
represented O
in O
text O
. O

Several O
of O
the O
visual O
elements O
present O
in O
the O
IRGC O
logo O
have O
been O
carried O
over O
to O
the O
Operation O
Cleaver O
logo O
including O
: O
• O
A O
clenched O
fist O
, O
this O
time O
holding O
a O
cleaver O
, O
represents O
the O
group O
's O
likely O
connection O
with O
the O
IRGC O
as O
well O
as O
armed O
resistence O
in O
general O
. O

• O
The O
globe O
in O
the O
background O
represents O
Operation O
Cleaver O
's O
worldwide O
reach O
. O

• O
An O
ethernet O
cable O
connected O
to O
the O
clenched O
first O
represents O
the O
nature O
of O
these O
attacks O
( O
cyber O
as O
opposed O
to O
traditional O
warfare O
) O
. O

• O
The O
hex O
string O
translates O
to O
'' O
Think O
Evil O
, O
Do O
Good O
'' O
, O
a O
mantra O
our O
research O
team O
lives O
by O
. O

This O
Appendix O
details O
the O
IOCs O
discovered O
in O
the O
investigation O
of O
Operation O
Cleaver O
. O

CylancePROTECT O
prevents O
the O
malware O
used O
in O
Operation O
Cleaver O
from O
ever O
executing O
. O

These O
mutexes O
are O
used O
with O
the O
process O
ID O
of O
the O
malware O
as O
a O
suffix O
: O
Listed O
below O
are O
both O
the O
MD5 O
and O
SHA-256 O
hashes O
for O
samples O
related O
to O
Operation O
Cleaver O
. O

It O
's O
friday O
afternoon O
, O
I O
had O
a O
bit O
of O
free O
time O
and O
stumbled O
across O
this O
tweet O
by O
PhysicalDrive0 O
( O
thx O
! O
) O
two O
hours O
ago O
and O
thought O
to O
give O
it O
a O
try O
to O
finally O
add O
a O
new O
article O
to O
this O
Blog O
( O
first O
of O
2014 O
) O
: O
So O
, O
I O
went O
to O
Google O
to O
search O
for O
the O
domain O
of O
the O
Embassy O
of O
Greece O
Beijing O
and O
added O
the O
( O
allegedly O
) O
malicious O
java O
file O
package O
that O
was O
found O
by O
PhysicalDrive0 O
: O
Next O
, O
I O
loaded O
the O
1.jar O
file O
into O
Java O
Decompiler O
to O
get O
the O
source O
code O
. O

It O
showed O
, O
that O
the O
functionality O
is O
obfuscated O
in O
some O
way O
, O
e.g O
. O

the O
function O
csfn O
( O
String O
paramString O
) O
decrypts O
all O
strings O
by O
'' O
removing O
'' O
the O
numbers O
of O
the O
string O
parameter O
: O
There O
are O
some O
other O
obfuscation O
techniques O
, O
but O
they O
are O
not O
important O
here O
. O

Instead O
, O
the O
following O
deobfuscated O
code O
line O
in O
the O
function O
init O
( O
) O
gives O
us O
an O
idea O
where O
the O
actual O
payload O
is O
located O
: O
We O
can O
also O
see O
, O
that O
the O
java O
package O
contains O
a O
file O
named O
pack O
, O
so O
we O
open O
7-Zip O
and O
unpack O
the O
file O
. O

A O
quick O
view O
with O
a O
PE O
viewer O
showed O
, O
that O
it O
is O
a O
x86 O
PE O
executable O
not O
even O
encrypted O
( O
SHA256 O
: O
b832e4b5a4829c8df6de7b42c5cb32ef25b5ab59072b4c2a7838404cd0dd5e5f O
) O
: O
So O
, O
I O
opened O
IDA O
Pro O
to O
take O
a O
quick O
look O
at O
the O
functionality O
. O

Together O
with O
the O
strings O
of O
the O
executable O
, O
we O
get O
a O
brief O
idea O
of O
what O
the O
purpose O
of O
this O
malware O
is O
. O

The O
important O
strings O
are O
as O
follows O
: O
Together O
with O
the O
output O
of O
IDA O
Pro O
, O
we O
can O
see O
that O
this B-Entity
malware I-Entity
uses O
the O
command O
line O
tool O
cmd.exe O
for O
adding B-Action
several B-Entity
registry I-Entity
keys I-Entity
to B-Modifier
Internet B-Entity
Explorer I-Entity
. O

It B-Entity
also O
tries O
to O
retrieve B-Action
possible B-Entity
AntiVirus I-Entity
information I-Entity
by B-Modifier
using B-Entity
the I-Entity
COM I-Entity
interface I-Entity
( O
dc12a687-737f-11cf-884d-00aa004b2e24 O
- O
> O
IWbemLocator O
- O
> O
SELECT O
* O
FROM O
AntiVirusProduct O
) O
. O

Furthermore O
, O
it B-Entity
makes O
use O
of O
the O
COM O
to O
launch B-Action
an B-Entity
instance I-Entity
of I-Entity
Internet I-Entity
Explorer I-Entity
( O
d30c1661-cdaf-11d0-8a3e-00c04fc9e26e O
- O
> O
IWebBrowser2 O
) O
, O
supposedly O
to O
contact B-Action
its B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

To O
verify O
this O
, O
we O
open O
up O
Wireshark O
and O
run O
the O
executable O
. O

As O
a O
result O
, O
we O
get O
the O
following O
network O
information O
: O
Also O
, O
we O
see O
that O
it B-Entity
downloads B-Action
some B-Entity
kind I-Entity
of I-Entity
data I-Entity
( O
Base64 O
encoded O
) O
. O

But O
first O
, O
we O
combine O
the O
C O
& O
C O
server O
and O
the O
HTTP O
request O
and O
open O
the O
URL O
in O
our O
favorite O
Browser O
: O
As O
you O
can O
see O
, O
there O
is O
a O
string O
named O
microsoft O
followed O
by O
Base64 O
encoded O
data O
. O

Side O
note O
: O
Is O
there O
also O
a O
Linux O
equivalent O
? O
Next O
, O
we O
copy O
the O
Base64 O
encoded O
data O
and O
go O
to O
the O
following O
website O
to O
let O
us O
decode O
it O
into O
a O
file O
( O
because O
I O
had O
the O
feeling O
it O
's O
just O
another O
unencrypted O
executable O
) O
: O
As O
a O
result O
, O
we O
get O
another O
executable O
( O
SHA256 O
: O
a4863f44f48d1c4c050dd7baad767a86b348dd4d33924acf4e0a3cd40c6ae29f O
) O
that O
was O
only O
Base64 O
encoded O
and O
not O
encrypted O
in O
any O
way O
: O
So O
again O
, O
we O
fire O
up O
our O
PE O
viewer O
and O
take O
a O
look O
at O
the O
important O
strings O
: O
Again O
, O
we O
load O
the O
executable O
into O
IDA O
Pro O
and O
quickly O
fly O
over O
the O
assembly O
code O
to O
get O
an O
idea O
of O
the O
functionality O
. O

Once O
again O
, O
it B-Entity
creates B-Action
several B-Entity
registry I-Entity
entries I-Entity
with B-Modifier
the B-Entity
help I-Entity
of I-Entity
the I-Entity
command I-Entity
line I-Entity
tool I-Entity
and O
creates B-Action
an B-Entity
instance I-Entity
of I-Entity
the I-Entity
Internet I-Entity
Explorer I-Entity
( O
CoCreateInstance O
( O
) O
- O
> O
d30c1661-cdaf-11d0-8a3e- O
00c04fc9e26e O
) O
for O
contacting B-Action
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

This O
time O
, O
the O
network O
information O
is O
as O
follows O
: O
From O
the O
code O
we O
can O
see O
, O
that O
the B-Entity
sample I-Entity
has O
also O
the O
ability O
to O
encode B-Action
/ O
decode O
data B-Entity
from B-Modifier
/ O
to O
Base64 B-Entity
. O

The O
dynamic O
analysis O
showed O
the B-Entity
malware I-Entity
sample I-Entity
contacted B-Action
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
but O
was O
n't O
sending O
any O
URL O
parameters O
( O
id1 O
, O
id2 O
) O
. O

Also O
the O
server O
did O
n't O
respond O
... O

The O
files O
can O
be O
downloaded O
here O
: O
That O
's O
it O
, O
have O
a O
nice O
weekend O
... O

We O
believe O
we O
're O
seeing O
an O
evolution O
and O
development O
in O
Iranian-based O
cyber O
activity O
. O

In O
years O
past O
, O
Iranian B-Entity
actors I-Entity
primarily O
committed B-Action
politically-motivated O
website O
defacement O
and O
DDoS B-Entity
attacks I-Entity
. O

More O
recently O
, O
however O
, O
suspected B-Entity
Iranian I-Entity
actors I-Entity
have O
destroyed B-Action
data B-Entity
on B-Modifier
thousands B-Entity
of I-Entity
computers I-Entity
with B-Modifier
the B-Entity
Shamoon I-Entity
virus I-Entity
, O
and O
they O
have O
penetrated O
the O
Navy O
Marine O
Corps O
Intranet O
( O
NMCI O
) O
, O
which O
is O
used O
by O
the O
U.S. O
Navy O
worldwide O
. O

In O
this O
report O
, O
we O
document O
the O
activities O
of O
the O
Ajax O
Security O
Team O
, O
a O
hacking O
group O
believed O
to O
be O
operating O
from O
Iran O
. O

Members O
of O
this O
group O
have O
accounts O
on O
popular O
Iranian O
hacker O
forums O
such O
as O
ashiyane O
[ O
. O

] O
org O
and O
shabgard O
[ O
. O

] O
org O
, O
and O
they O
have O
engaged O
in O
website O
defacements O
under O
the O
group O
name O
'' O
AjaxTM O
'' O
since O
2010 O
. O

By O
2014 O
, O
the O
Ajax O
Security O
Team O
had O
transitioned O
from O
performing O
defacements O
( O
their O
last O
defacement O
was O
in O
December O
2013 O
) O
to O
malware-based O
espionage O
, O
using O
a O
methodology O
consistent O
with O
other O
advanced O
persistent O
threat O
actors O
in O
this O
region O
. O

It O
is O
unclear O
if O
the O
Ajax O
Security O
Team O
operates O
in O
isolation O
or O
if O
they O
are O
a O
part O
of O
a O
larger O
coordinated O
effort O
. O

The O
Ajax O
Security O
Team O
itself O
uses O
malware O
tools O
that O
do O
not O
appear O
to O
be O
publicly O
available O
. O

We O
have O
seen O
this B-Entity
group I-Entity
leverage B-Action
varied B-Entity
social I-Entity
engineering I-Entity
tactics I-Entity
as O
a O
means O
to O
lure B-Action
their B-Entity
targets I-Entity
into B-Modifier
infecting B-Entity
themselves I-Entity
with I-Entity
malware I-Entity
. O

Although O
we O
have O
not O
observed O
the O
use O
of O
exploits O
as O
a O
means O
to O
infect O
victims O
, O
members O
of O
the O
Ajax O
Security O
Team O
have O
previously O
used O
publicly O
available O
exploit O
code O
in O
web O
site O
defacement O
operations O
. O

In O
sum O
, O
FireEye O
has O
recently O
observed O
the O
Ajax O
Security O
Team O
conducting O
multiple O
cyber O
espionage O
operations O
against O
companies O
in O
the O
defense O
industrial O
base O
( O
DIB O
) O
within O
the O
Unites O
States O
, O
as O
well O
as O
targeting O
local O
Iranian O
users O
of O
anti-censorship O
technologies O
that O
bypass O
Iran O
's O
Internet O
filtering O
system O
. O

The O
transition O
from O
patriotic O
hacking O
to O
cyber O
espionage O
is O
not O
an O
uncommon O
phenomenon O
. O

It O
typically O
follows O
an O
increasing O
politicization O
within O
the O
hacking O
community O
, O
particularly O
around O
geopolitical O
events O
. O

This O
is O
followed O
by O
increasing O
links O
between O
the O
hacking O
community O
and O
the O
state O
, O
particularly O
military O
and/or O
intelligence O
organizations O
. O

In O
the O
late O
1990 O
's O
and O
early O
2000 O
's O
, O
a O
similar O
transition O
occurred O
within O
the O
Chinese O
hacking O
community O
. O

During O
that O
time O
period O
, O
the B-Entity
Chinese I-Entity
hacking I-Entity
community I-Entity
engaged B-Action
in B-Modifier
website O
defacements O
and O
denial B-Entity
of I-Entity
service I-Entity
attacks I-Entity
in O
conjunction O
with O
incidents O
such O
as O
the O
accidental O
bombing O
of O
the O
Chinese O
embassy O
in O
Belgrade O
in O
1999 O
, O
the O
collision O
of O
a O
U.S. O
spy O
plane O
and O
a O
Chinese O
military O
plane O
in O
2001 O
, O
and O
the O
Japanese O
Prime O
Minister O
's O
controversial O
visit O
to O
the O
Yasukuni O
shrine O
in O
2005 O
. O

Around O
this O
time O
a O
significant O
shift O
in O
philosophy O
began O
to O
take O
place O
. O

Members O
of O
the O
Chinese O
hacking O
community O
that O
participated O
in O
such O
attacks O
soon O
found O
that O
transitioning O
to O
cyber O
espionage O
was O
more O
rewarding-both O
in O
terms O
of O
developing O
a O
more O
advanced O
skill O
set O
as O
well O
as O
in O
monetary O
remuneration O
. O

One O
group O
known O
as O
NCPH O
( O
Network O
Crack O
Program O
Hacker O
) O
, O
whose O
founding O
member O
'' O
Wicked/Withered O
Rose O
'' O
was O
a O
patriotic O
hacker O
, O
made O
the O
transition O
to O
cyber O
espionage O
by O
founding O
a O
'' O
hacker-for-hire O
'' O
group O
that O
simultaneously O
developed O
an O
association O
with O
the O
Chinese O
military O
. O

The O
group O
began O
developing O
zero-day O
exploits O
, O
rootkits O
and O
remote O
access O
tools O
( O
RATs O
) O
-using O
them O
in O
attacks O
against O
a O
variety O
of O
targets O
including O
the O
U.S. O
Department O
of O
Defense O
. O

( O
One O
of O
this O
group O
's O
associates O
, O
'' O
whg O
'' O
, O
is O
still O
active O
and O
is O
believed O
to O
have O
developed O
one O
variant O
of O
the O
PlugX/SOGU O
malware O
. O

) O
The O
rationale O
behind O
this O
transition O
within O
the O
Chinese O
hacking O
community O
is O
nicely O
summed O
up O
in O
a O
message O
by O
the O
'' O
Honker O
Union O
of O
China O
'' O
to O
its O
members O
in O
2010 O
: O
What O
benefit O
can O
hacking O
a O
Web O
page O
bring O
our O
country O
and O
the O
people O
? O
It O
is O
only O
a O
form O
of O
emotional O
catharsis O
, O
please O
do O
not O
launch O
any O
pointless O
attacks O
, O
the O
real O
attack O
is O
to O
fatally O
damage O
their O
network O
or O
gain O
access O
to O
their O
sensitive O
information O
. O

In O
Iran O
, O
the O
hacking O
community O
appears O
to O
be O
undergoing O
a O
similar O
transformation O
. O

While O
a O
variety O
of O
Iranian O
hacker O
groups O
had O
engaged O
in O
politically O
motivated O
website O
defacements O
, O
the O
emergence O
of O
the O
'' O
Iranian O
Cyber O
Army O
'' O
in O
2009 O
demonstrated O
'' O
a O
concentrated O
effort O
to O
promote O
the O
Iranian O
government O
's O
political O
narrative O
online O
'' O
. O

They O
targeted O
, O
among O
others O
, O
news O
organizations O
, O
opposition O
websites O
and O
social O
media O
. O

This O
marked O
the O
beginning O
of O
a O
large- O
scale O
cyber O
offensive O
against O
the O
perceived O
enemies O
of O
the O
Iranian O
government O
. O

Foreign O
news O
and O
opposition O
websites O
are O
routinely O
blocked O
in O
Iran O
, O
as O
are O
the O
tools O
that O
allow O
users O
in O
Iran O
to O
bypass O
these O
restrictions O
. O

One O
of O
the O
key O
stakeholders O
in O
Iran O
's O
Internet O
censorship O
program O
is O
the O
Iranian O
Revolutionary O
Guard O
Corps O
( O
IRGC O
) O
, O
under O
which O
the O
Basij O
paramilitary O
organization O
operates O
. O

The O
Basij O
formed O
the O
Basij O
Cyber O
Council O
and O
actively O
recruits O
hackers O
in O
order O
to O
develop O
both O
defensive O
and O
offensive O
cyber O
capabilities O
. O

There O
is O
increasing O
evidence O
to O
suggest O
that O
the O
hacker O
community O
in O
Iran O
is O
engaged O
in O
a O
transition O
from O
politically O
motivated O
defacements O
and O
denial O
of O
service O
attacks O
to O
cyber O
espionage O
activities O
. O

This O
model O
is O
consistent O
with O
the O
Basij O
's O
recruitment O
of O
paramilitary O
volunteer O
hackers O
to O
'' O
engage O
in O
less O
complex O
hacking O
or O
infiltration O
operations O
'' O
leaving O
the O
more O
technical O
operations O
to O
entities O
over O
which O
they O
have O
increasingly O
direct O
control O
. O

As O
such O
, O
the O
capabilities O
of O
threat O
actors O
operating O
from O
Iran O
have O
traditionally O
been O
considered O
limited O
. O

However O
, O
the B-Entity
'' I-Entity
Shamoon I-Entity
'' I-Entity
attacks I-Entity
, O
which O
wiped B-Action
computers B-Entity
in I-Entity
Saudi I-Entity
Arabia I-Entity
and I-Entity
Qatar I-Entity
, O
indicate O
an O
improvement O
in O
capabilities O
. O

And O
unsurprisingly O
, O
Iran O
has O
reportedly O
increased O
its O
efforts O
to O
improve O
offensive O
capabilities O
after O
being O
targeted O
by O
Stuxnet O
and O
Flame O
. O

We O
have O
observed O
the B-Entity
Ajax I-Entity
Security I-Entity
Team I-Entity
use O
a O
variety O
of O
vectors O
to O
lure B-Action
targets B-Entity
into B-Modifier
installing B-Entity
malicious I-Entity
software I-Entity
and/or I-Entity
revealing I-Entity
login I-Entity
credentials I-Entity
. O

These B-Entity
attack I-Entity
vectors I-Entity
include B-Action
sending B-Entity
email I-Entity
, I-Entity
private I-Entity
messages I-Entity
via I-Entity
social I-Entity
media I-Entity
, I-Entity
fake I-Entity
login I-Entity
pages I-Entity
, I-Entity
and I-Entity
the I-Entity
propagation I-Entity
of I-Entity
anti-censorship I-Entity
software I-Entity
that I-Entity
has I-Entity
been I-Entity
infected I-Entity
with I-Entity
malware I-Entity
. O

During O
our O
investigation O
, O
we O
discovered O
that O
these B-Entity
attackers I-Entity
sent B-Action
targeted B-Entity
emails I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
private I-Entity
messages I-Entity
through B-Modifier
social B-Entity
media I-Entity
. O

For O
example O
, O
the B-Entity
attackers I-Entity
targeted B-Action
companies B-Entity
in I-Entity
the I-Entity
DIB I-Entity
using B-Modifier
a B-Entity
fake I-Entity
conference I-Entity
page I-Entity
as I-Entity
a I-Entity
lure I-Entity
to I-Entity
trick I-Entity
targets I-Entity
into I-Entity
installing I-Entity
malicious I-Entity
software I-Entity
. O

The B-Entity
attackers I-Entity
registered B-Action
the B-Entity
domain I-Entity
'' I-Entity
aeroconf2014 I-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
'' I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
impersonate B-Entity
the I-Entity
IEEE I-Entity
Aerospace I-Entity
conference I-Entity
- O
the O
conference O
's O
actual O
domain O
is O
aeroconf.org-and O
sent B-Action
out B-Modifier
an B-Entity
email I-Entity
with I-Entity
the I-Entity
following I-Entity
information I-Entity
: O
The O
email O
encouraged O
users O
to O
visit O
a O
fake O
conference O
website O
owned O
by O
the O
attackers O
: O
Upon O
visiting O
the O
website O
, O
visitors O
were O
notified O
that O
they O
must O
install O
'' O
proxy O
'' O
software O
in O
order O
to O
access O
it O
, O
which O
is O
actually O
malware O
. O

The B-Entity
attackers I-Entity
have O
also O
used B-Action
phishing B-Entity
attacks I-Entity
, O
in O
which O
they B-Entity
set B-Action
up I-Action
Web B-Entity
pages I-Entity
to B-Modifier
emulate B-Entity
various I-Entity
services I-Entity
that I-Entity
require I-Entity
security I-Entity
credentials I-Entity
. O

The B-Entity
attackers I-Entity
tailored B-Action
these B-Entity
login I-Entity
pages I-Entity
for B-Modifier
specific B-Entity
targets I-Entity
in I-Entity
the I-Entity
DIB I-Entity
and O
spoofed B-Action
a B-Entity
variety I-Entity
of I-Entity
services I-Entity
such I-Entity
as I-Entity
Outlook I-Entity
Web I-Entity
Access I-Entity
and I-Entity
VPN I-Entity
login I-Entity
pages I-Entity
. O

If O
users O
attempt O
to O
login O
through O
these O
fake O
Web O
pages O
, O
the B-Entity
attackers I-Entity
collect B-Action
their B-Entity
login I-Entity
credentials I-Entity
. O

All O
Internet O
Service O
Providers O
( O
ISPs O
) O
in O
Iran O
are O
required O
to O
implement O
filtering O
technology O
that O
censors O
access O
to O
content O
which O
the O
Iranian O
government O
deems O
unacceptable O
. O

This O
content O
includes O
categories O
such O
as O
pornography O
and O
political O
opposition O
. O

In O
response O
to O
these O
restrictions O
, O
Iranians O
have O
been O
increasingly O
using O
software O
that O
bypasses O
such O
filtering O
technology O
. O

To O
counter O
anti-censorship O
efforts O
, O
Iran O
has O
attempted O
to O
block O
the O
use O
of O
certain O
software O
tools O
. O

In O
2012 O
, O
researchers O
found O
that O
an B-Entity
anti-censorship I-Entity
tool I-Entity
that I-Entity
is I-Entity
primarily I-Entity
used I-Entity
by I-Entity
Internet I-Entity
users I-Entity
in I-Entity
Iran I-Entity
was B-Action
bundled I-Action
with B-Modifier
malware B-Entity
and O
redistributed O
. O

Our O
investigation O
found O
that O
malware-laden B-Entity
versions I-Entity
of I-Entity
legitimate I-Entity
anti-censorship I-Entity
software I-Entity
, I-Entity
such I-Entity
as I-Entity
Psiphon I-Entity
and I-Entity
Ultrasurf I-Entity
, O
were B-Action
distributed I-Action
to B-Modifier
users B-Entity
Iran I-Entity
and I-Entity
Persian I-Entity
speaking I-Entity
people I-Entity
around I-Entity
the I-Entity
world I-Entity
. O

We O
have O
observed O
the O
Ajax O
Security O
Team O
use O
a O
malware O
family O
that O
they O
identify O
simply O
as O
'Stealer O
' O
. O

They B-Entity
deliver B-Action
this B-Entity
malware I-Entity
as B-Modifier
a B-Entity
malicious I-Entity
executable I-Entity
( I-Entity
dropper I-Entity
) I-Entity
. O

The B-Entity
executable I-Entity
is O
a O
CAB O
extractor O
that O
drops B-Action
the B-Entity
implant I-Entity
IntelRS.exe I-Entity
. O

This B-Entity
implant I-Entity
, O
in O
turn O
, O
drops B-Action
various B-Entity
other I-Entity
components I-Entity
into B-Modifier
C B-Entity
: I-Entity
\ I-Entity
Documents I-Entity
and I-Entity
Settings\ I-Entity
{ I-Entity
USER I-Entity
} I-Entity
\Application I-Entity
Data\IntelRapidStart\ I-Entity
. O

The B-Entity
following I-Entity
files I-Entity
are B-Action
written I-Action
to B-Modifier
disk B-Entity
in B-Modifier
this B-Entity
location I-Entity
: O
The O
IntelRS.exe O
is O
written O
in O
.NET O

and O
is O
aptly O
named O
'' O
Stealer O
'' O
, O
as O
it B-Entity
has B-Action
various B-Entity
data I-Entity
collection I-Entity
modules I-Entity
. O

It B-Entity
drops B-Action
and O
launches B-Action
AppTransferWiz.dll B-Entity
via B-Modifier
the B-Entity
following I-Entity
command I-Entity
: O
110 O
is O
an O
ordinal O
that O
corresponds O
to O
'' O
StartBypass O
'' O
export O
in O
AppTransferWiz.dll O
. O

Data B-Entity
exfiltration I-Entity
is B-Action
conducted I-Action
over B-Modifier
FTP B-Entity
by O
AppTransferWiz.dll B-Entity
, O
which O
acts O
as O
an O
FTP O
client O
. O

This O
DLL O
is O
written O
in O
Delphi O
. O

There O
is O
code B-Entity
to O
exfiltrate B-Action
data B-Entity
over B-Modifier
HTTP B-Entity
POST I-Entity
as O
well O
, O
but O
it O
is O
unused O
. O

We O
also O
found O
incomplete B-Entity
code I-Entity
that O
would O
perform B-Action
SFTP B-Entity
and I-Entity
SMTP I-Entity
exfiltration I-Entity
, O
which O
could O
be O
completed O
in O
a O
future O
version O
. O

State O
is O
maintained O
between O
the O
stealer O
component O
IntelRS.exe O
and O
the O
FTP O
component O
AppTransferWiz.DLL O
using O
a O
file O
from O
the O
FTP O
server O
'' O
sqlite3.dll O
'' O
, O
as O
well O
as O
a O
global O
atom O
'' O
SQLiteFinish O
'' O
. O

IntelRS.exe O
waits O
in O
an O
indefinite O
loop O
, O
until O
AppTransferWiz.DLL O
defines O
this O
state O
. O

Once O
the O
state O
is O
set O
, O
IntelRS.exe B-Entity
proceeds O
to O
collect B-Action
data B-Entity
from B-Modifier
various B-Entity
areas I-Entity
in I-Entity
the I-Entity
system I-Entity
as I-Entity
described I-Entity
below I-Entity
: O
IntelRS.exe B-Entity
loads B-Action
a B-Entity
Delphi I-Entity
component I-Entity
called I-Entity
DelphiNative.DLL I-Entity
, O
which O
implements B-Action
some B-Entity
additional I-Entity
data I-Entity
theft I-Entity
functionality I-Entity
for B-Modifier
the B-Entity
following I-Entity
: O
The B-Entity
Stealer I-Entity
component I-Entity
uses B-Action
common B-Entity
techniques I-Entity
to B-Modifier
acquire B-Entity
credential I-Entity
data I-Entity
. O

For O
instance O
, O
it B-Entity
loads B-Action
vaultcli.DLL B-Entity
and O
uses B-Action
various B-Entity
APIs I-Entity
shown I-Entity
below I-Entity
to B-Modifier
acquire B-Entity
RDP I-Entity
accounts I-Entity
from I-Entity
the I-Entity
Windows I-Entity
vault I-Entity
. O

Harvested B-Entity
data I-Entity
is B-Action
encrypted I-Action
and O
written B-Action
to B-Modifier
disk B-Entity
on B-Modifier
the B-Entity
local I-Entity
host I-Entity
. O

The O
filenames O
for O
these O
encrypted O
files O
follow O
this O
naming O
scheme O
: O
The O
{ O
stolen O
data O
type O
} O
parameter O
indicates O
where O
the O
data O
was O
harvested O
from O
( O
e.g. O
, O
a O
Web O
browser O
, O
an O
instant O
messenger O
application O
, O
installed O
proxy O
software O
) O
. O

Analysis O
of O
the O
malware O
indicates O
that O
the B-Entity
data I-Entity
is B-Action
encrypted I-Action
via B-Modifier
a B-Entity
Rijndael I-Entity
cipher I-Entity
implementation I-Entity
; O
more O
specifically O
it O
uses O
AES O
which O
is O
a O
specific O
set O
of O
configurations O
of O
Rijndael O
. O

It O
uses O
a O
key O
size O
of O
256 O
bytes O
and O
block O
size O
of O
128 O
bytes O
, O
which O
conforms O
to O
the O
FIPS-197 O
specification O
of O
AES-256 O
. O

It O
utilizes O
the O
passphrase O
'HavijeBaba' O
and O
a O
salt O
of O
'salam O
! O
* O
% O
# O
' O
as O
an O
input O
to O
PBKDF2 O
( O
Password-Based O
Key O
Derivation O
Function O
2 O
) O
to O
derive O
the O
key O
and O
initialization O
vector O
for O
the O
encryption O
. O

This O
key O
derivation O
implementation O
in O
.NET O

is O
done O
using O
the O
Rfc2898DeriveBytes O
class O
. O

The O
passphrase O
and O
salt O
are O
Persian O
language O
words O
. O

'' O
Havij O
'' O
means O
'' O
carrot O
'' O
, O
'' O
Baba O
'' O
means O
'' O
father O
'' O
, O
and O
'' O
Salam O
'' O
is O
a O
common O
greeting O
that O
means O
'' O
Peace O
'' O
. O

We O
identified O
17 O
droppers O
during O
this O
research O
, O
including O
: O
The O
2009 O
compile O
time O
appears O
to O
have O
been O
forged O
, O
while O
the O
2013 O
compile O
times O
may O
be O
legitimate O
. O

In O
some O
cases O
, O
we O
found O
an O
implant O
but O
not O
the O
parent O
dropper O
. O

In O
total O
, O
22 O
of O
the O
23 O
implants O
that O
we O
identified O
during O
our O
research O
had O
unique O
compile O
times O
ranging O
from O
2013-10-29 O
until O
2014-03-15 O
. O

We O
identified O
two O
implants O
that O
were O
both O
compiled O
on O
2014-3-15 O
at O
23:16 O
. O

These O
compile O
times O
appear O
to O
be O
legitimate O
and O
coincide O
with O
attempted O
intrusion O
activity O
attributed O
to O
these O
attackers O
. O

Many B-Entity
of I-Entity
the I-Entity
malicious I-Entity
executables I-Entity
( I-Entity
droppers I-Entity
) I-Entity
that I-Entity
we I-Entity
collected I-Entity
were B-Action
bundled I-Action
with B-Modifier
legitimate B-Entity
installers I-Entity
for I-Entity
VPN I-Entity
or I-Entity
proxy I-Entity
software I-Entity
. O

Examples O
include O
: O
• O
6dc7cc33a3cdcfee6c4edb6c085b869d B-Entity
was B-Action
bundled I-Action
with B-Modifier
an B-Entity
installer I-Entity
for I-Entity
Ultrasurf I-Entity
Proxy I-Entity
software I-Entity
. O

• O
3d26442f06b34df3d5921f89bf680ee9 B-Entity
was B-Action
bundled I-Action
with B-Modifier
an B-Entity
installer I-Entity
for I-Entity
Gerdoovpn I-Entity
virtual I-Entity
private I-Entity
network I-Entity
software I-Entity
. O

• O
3efd971db6fbae08e96535478888cff9 B-Entity
was B-Action
bundled I-Action
with B-Modifier
an B-Entity
installer I-Entity
for I-Entity
the I-Entity
Psiphon I-Entity
proxy I-Entity
. O

• O
288c91d6c0197e99b92c06496921bf2f B-Entity
was B-Action
bundled I-Action
with B-Modifier
an B-Entity
installer I-Entity
for I-Entity
Proxifier I-Entity
software I-Entity
. O

These B-Entity
droppers I-Entity
were O
also O
designed O
to O
visually O
spoof B-Action
the B-Entity
appearance I-Entity
of I-Entity
the I-Entity
above I-Entity
applications I-Entity
. O

These B-Entity
droppers I-Entity
contained B-Action
icons B-Entity
used I-Entity
in I-Entity
the I-Entity
legitimate I-Entity
installers I-Entity
for I-Entity
these I-Entity
programs I-Entity
. O

Analysis O
of O
the O
PDB O
strings O
seen O
in O
the O
implants O
indicates O
that O
there O
may O
be O
more O
than O
one O
developer O
working O
on O
the O
source O
code O
for O
the O
Stealer O
builder O
. O

The O
following O
two O
PDB O
paths O
were O
seen O
in O
the O
collection O
of O
implants O
that O
we O
collected O
: O
These O
strings O
indicate O
that O
the O
Stealer O
source O
code O
was O
stored O
in O
two O
different O
paths O
but O
not O
necessarily O
on O
two O
different O
computers O
. O

The O
f O
: O
\ O
Projects\ O
path O
may O
be O
from O
an O
external O
storage O
device O
such O
as O
a O
thumb O
drive O
. O

It O
is O
therefore O
possible O
that O
only O
one O
person O
has O
access O
to O
the O
source O
code O
, O
but O
keeps O
a O
separate O
repository O
on O
an O
external O
storage O
device O
. O

Alternatively O
, O
the O
different O
file O
paths O
could O
be O
the O
result O
of O
two O
different O
actors O
storing O
their O
source O
code O
in O
two O
different O
locations O
. O

In O
nine O
of O
the O
implants O
that O
we O
collected O
, O
we O
found O
a O
consistent O
portable O
executable O
( O
PE O
) O
resource O
with O
a O
SHA256 O
of O
5156aca994ecfcb40458ead8c830cd66469d5f5 O
a031392898d323a8d7a7f23d3 O
. O

This O
PE O
resource O
contains O
the O
VSVERSIONINFO O
. O

In O
layman O
's O
terms O
, O
this O
can O
best O
be O
described O
as O
the O
metadata O
describing O
the O
executable O
file O
. O

This O
specific O
PE O
resource O
contained O
the O
following O
information O
: O
Note O
the O
InternalName O
of O
'Stealer.exe O
' O
. O

This O
is O
the O
attackers O
' O
name O
for O
this O
malware O
family O
. O

During O
our O
research O
, O
we O
recovered O
two O
different O
tools O
used O
by O
the O
members O
of O
the O
Ajax O
Security O
Team O
in O
conjunction O
with O
targeted O
intrusion O
activities O
. O

The O
first O
tool O
, O
labeled O
the O
'Stealer O
Builder O
' O
was O
compiled O
on O
2014-04-08 O
. O

This O
compile O
date O
may O
indicate O
that O
the O
group O
is O
still O
active O
. O

Upon O
executing O
the O
'Stealer O
Builder O
' O
the O
user O
is O
presented O
with O
an O
option O
to O
load O
the O
'Builder O
' O
or O
to O
'Decrypt O
' O
logs B-Entity
generated O
from O
a O
victim O
and O
exfiltrated B-Action
to B-Modifier
a B-Entity
command-and-control I-Entity
( I-Entity
CnC I-Entity
) I-Entity
server I-Entity
under I-Entity
the I-Entity
groups I-Entity
' I-Entity
control I-Entity
. O

The O
Builder O
option O
enables O
an B-Entity
attacker I-Entity
to O
configure B-Action
a B-Entity
new I-Entity
Stealer I-Entity
backdoor I-Entity
. O

The O
user O
can O
configure O
the B-Entity
new I-Entity
backdoor I-Entity
to O
connect B-Action
to B-Modifier
a B-Entity
specific I-Entity
CnC I-Entity
server I-Entity
with B-Modifier
a B-Entity
personalized I-Entity
username I-Entity
and I-Entity
password I-Entity
. O

The B-Entity
attacker I-Entity
can O
bind B-Action
the B-Entity
backdoor I-Entity
to B-Modifier
a B-Entity
legitimate I-Entity
application I-Entity
of I-Entity
his I-Entity
or I-Entity
her I-Entity
choosing I-Entity
, O
or O
they B-Entity
can O
cloak B-Action
it B-Entity
with B-Modifier
an B-Entity
icon I-Entity
designed I-Entity
to I-Entity
make I-Entity
the I-Entity
backdoor I-Entity
appear I-Entity
as I-Entity
though I-Entity
it I-Entity
is I-Entity
a I-Entity
legitimate I-Entity
file I-Entity
. O

We O
also O
noted O
that O
the O
Builder O
did O
not O
allow O
the O
attacker O
to O
select O
a O
new O
passphrase O
or O
salt O
used O
to O
encrypt O
the O
stolen O
data O
. O

The O
passphrase O
'HavijeBaba O
' O
and O
a O
salt O
of O
'salam O
! O
* O
% O
# O
' O
are O
both O
hardcoded O
into O
the O
builder O
. O

During O
testing O
, O
we O
observed O
that O
backdoors O
generated O
by O
this O
Stealer O
Builder O
had O
a O
timestamp O
of O
2013-12-19 O
. O

We O
had O
one O
backdoor O
in O
our O
repository O
with O
this O
same O
timestamp O
. O

This B-Entity
sample I-Entity
( I-Entity
MD5 I-Entity
1823b77b9ee6296a8b997ffb64d32d21 I-Entity
) I-Entity
was O
configured O
to O
exfiltrate B-Action
data B-Entity
to B-Modifier
ultrasms B-Entity
[ I-Entity
. I-Entity
] I-Entity
ir I-Entity
. O

The O
VSVERSIONINFO O
PE O
resource O
mentioned O
above O
( O
SHA256 O
5156aca994ecfcb40458ead8c830cd66469d5f5 O
a031392898d323a8d7a7f23d3 O
) O
is O
an O
artifact O
of O
the O
Stealer O
builder O
that O
we O
recovered O
. O

The O
builder O
generates O
an O
executable O
named O
IntelRapidStart O
. O

exe O
. O

This O
executable O
contains O
the O
aforementioned O
VSVERSIONINFO O
PE O
resource O
. O

We O
also O
recovered O
a O
tool O
designed O
to O
encode O
plaintext O
into O
Base64 O
encoded O
text O
or O
decode O
Base64 O
encoded O
text O
into O
plaintext O
. O

Members O
of O
the O
Ajax O
Security O
Team O
likely O
this O
use O
tool O
to O
encode O
the O
configuration O
data O
seen O
in O
RapidStartTech.stl O
files O
. O

As O
noted O
above O
, O
the O
RapidStartTech.stl O
contains O
the O
backdoor O
's O
FTP O
credentials O
, O
implant O
name O
, O
decoy O
name O
, O
and O
screenshot O
interval O
, O
along O
with O
boolean O
settings O
for O
startup O
, O
keylogger O
, O
and O
screenshot O
plugins O
. O

Encoding O
and O
decoding O
Base64 O
data O
is O
a O
straightforward O
task O
and O
the O
standard O
Linux O
operating O
system O
offers O
a O
number O
of O
command O
line O
tools O
to O
achieve O
this O
task O
. O

The O
presence O
of O
a O
Windows-based O
GUI O
tool O
that O
simplifies O
encoding O
and O
decoding O
Base64 O
data O
indicates O
that O
these O
tools O
may O
have O
been O
developed O
for O
less O
adept O
users O
. O

The O
CnC O
infrastructure O
consists O
of O
distinct O
, O
but O
linked O
, O
clusters O
that O
have O
targeted O
both O
the O
users O
of O
anti-censorship O
tools O
in O
Iran O
as O
well O
as O
defense O
contractor O
companies O
in O
the O
U.S O
. O

The O
first O
cluster O
contains O
the O
domain O
used O
in O
the O
Aerospace O
Conference O
attack O
as O
well O
as O
the B-Entity
domains I-Entity
used B-Action
in B-Modifier
phishing B-Entity
attacks I-Entity
designed O
to O
capture B-Action
user B-Entity
credentials I-Entity
: O
The O
website O
used O
in O
the O
Aerospace O
Conference O
attack O
was O
aeroconf2014 O
[ O
. O

] O
org O
, O
which O
is O
registered O
to O
info O
@ O
usa.gov O
[ O
. O

] O
us O
. O

However O
, O
historical O
WHOIS O
information O
shows O
that O
the O
domain O
was O
registered O
by O
keyvan.ajaxtm O
@ O
gmail O
[ O
. O

] O
com-the O
same O
domain O
used O
to O
register O
ajaxtm O
[ O
. O

] O
org O
, O
the O
website O
of O
the O
Ajax O
Security O
Team O
. O

The O
same O
email O
addresses O
were O
used O
to O
register O
variations O
of O
domain O
names O
associated O
with O
popular O
services O
provided O
by O
companies O
such O
as O
Google O
, O
Facebook O
, O
Yahoo O
and O
LinkedIn O
. O

The O
second O
cluster O
comprises O
the O
CnC O
infrastructure O
used O
in O
the O
anti-censorship O
attacks O
. O

The B-Entity
majority I-Entity
of I-Entity
the I-Entity
samples I-Entity
we I-Entity
analyzed I-Entity
connect B-Action
to B-Modifier
intel-update B-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
and I-Entity
update-mirror I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
, O
which O
were O
registered O
by O
james.mateo O
@ O
aim O
[ O
. O

] O
com O
. O

The O
domain O
intel-update O
[ O
. O

] O
com O
resolved O
to O
the O
IP O
address O
88.150.227.197 O
, O
which O
also O
hosted O
domains O
registered O
by O
osshom O
@ O
yahoo O
[ O
. O

] O
com O
, O
many O
of O
which O
are O
consistent O
with O
the O
pattern O
of O
registering O
domains O
with O
associations O
to O
Google O
and O
Yahoo O
services O
. O

We O
also O
observed O
crossover O
with O
a B-Entity
sample I-Entity
that O
connected B-Action
to B-Modifier
both B-Entity
intel- I-Entity
update I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
and I-Entity
ultrasms I-Entity
[ I-Entity
. I-Entity
] I-Entity
ir I-Entity
, O
which O
was O
registered O
by O
lvlr98 O
@ O
gmail O
[ O
. O

] O
com O
. O

These O
two O
clusters O
are O
linked O
by O
a O
common O
IP O
address O
( O
5.9.244.151 O
) O
, O
which O
is O
used O
by O
both O
ns2 O
. O

aeroconf2014 O
[ O
. O

] O
org O
and O
office.windows- O
essentials O
[ O
. O

] O
tk O
. O

A O
third O
cluster O
of O
activity O
was O
found O
via O
analysis O
of O
1d4d9f6e6fa1a07cb0a66a9ee06d624a O
. O

This B-Entity
sample I-Entity
is O
a O
Stealer O
variant O
that O
connects B-Action
to B-Modifier
the B-Entity
aforementioned I-Entity
intel-update I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
as I-Entity
well I-Entity
as I-Entity
plugin-adobe I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
. O

The O
domain O
plugin-adobe O
[ O
. O

] O
com O
resolved O
to O
81.17.28.235 O
. O

Other O
domains O
seen O
resolving O
to O
IP O
address O
nearby O
include O
the O
following O
: O
Aside O
from O
the B-Entity
sample I-Entity
connecting B-Action
to B-Modifier
plugin- B-Entity
adobe I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
, O
we O
have O
not O
discovered O
any O
malware O
connecting O
to O
these O
domains O
. O

During O
our O
investigation O
, O
we O
were O
able O
to O
recover O
information O
on O
77 O
victims O
from O
one O
CnC O
server O
that O
we O
discovered O
while O
analyzing O
malware B-Entity
samples I-Entity
that O
were B-Action
disguised I-Action
as B-Modifier
anti-censorship B-Entity
tools I-Entity
. O

While O
analyzing O
the O
data O
from O
the O
victims O
, O
we O
found O
that O
the O
majority O
had O
either O
their O
timezone O
set O
to O
'' O
Iran O
Standard O
Time O
'' O
or O
had O
their O
language O
setting O
set O
to O
Persian O
: O
The O
largest O
concentration O
of O
victims O
is O
in O
Iran O
, O
based O
on O
the O
premise O
that O
Persian O
language O
settings O
and O
'' O
Iran O
Standard O
Time O
'' O
correlate O
the O
victim O
to O
be O
geographically O
located O
in O
Iran O
. O

As O
such O
, O
we O
believe O
that O
attackers B-Entity
disguised B-Action
malware B-Entity
as B-Modifier
anti-censorship B-Entity
tools I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
target B-Entity
the I-Entity
users I-Entity
of I-Entity
such I-Entity
tools I-Entity
inside I-Entity
Iran I-Entity
as I-Entity
well I-Entity
as I-Entity
Iranian I-Entity
dissidents I-Entity
outside I-Entity
the I-Entity
country I-Entity
. O

The O
Ajax O
Security O
Team O
appears O
to O
have O
been O
formed O
by O
personas O
named O
'' O
HUrr O
! O
c4nE O
! O
'' O
and O
'' O
Cair3x O
'' O
in O
2010 O
. O

Both O
members O
were O
engaged O
in O
website O
defacements O
prior O
to O
the O
forming O
of O
the O
Ajax O
Security O
Team O
, O
and O
both O
were O
members O
of O
Iranian O
hacker O
forums O
such O
as O
ashiyane O
[ O
. O

] O
org O
and O
shabgard O
[ O
. O

] O
org O
. O

Other O
members O
include O
'' O
0day O
'' O
, O
'' O
Mohammad O
PK O
'' O
and O
'' O
Crim3r O
'' O
. O

The O
Ajax O
Security O
Team O
website O
at O
ajaxtm O
[ O
. O

] O
org O
had O
a O
Web O
forum O
with O
at O
least O
236 O
members O
. O

The O
group O
published O
several O
exploits O
for O
content O
management O
systems O
and O
engaged O
in O
defacements O
. O

Initially O
, O
the O
defacements O
seemed O
to O
be O
motivated O
by O
a O
desire O
to O
demonstrate O
the O
group O
's O
prowess-they O
even O
defaced O
an O
Iranian O
government O
website O
. O

However O
, O
the O
group O
appears O
to O
have O
become O
increasingly O
political O
. O

For O
example O
, O
in O
a O
blog O
post O
in O
2012 O
, O
'' O
Cair3x O
'' O
announced O
the O
targeting O
of O
Iran's O
political O
opponents O
. O

In O
2013 O
, O
the O
Ajax O
Security O
Team O
, O
and O
'' O
HUrr O
! O
c4nE O
! O
'' O
in O
particular O
, O
took O
part O
in O
'' O
# O
OpIsrael O
'' O
and O
'' O
# O
OpUSA O
'' O
. O

By O
early O
2014 O
, O
the O
Ajax O
Security O
Team O
appears O
to O
have O
dwindled O
. O

There O
have O
been O
no O
defacements O
since O
December O
2013 O
. O

The O
website O
and O
forum O
at O
ajaxtm O
[ O
. O

] O
org O
operated O
by O
'' O
HUrr O
! O
c4nE O
! O
'' O
, O
aka O
'' O
k3yv4n O
'' O
, O
is O
no O
longer O
active O
. O

'' O
HUrr O
! O
c4nE O
! O
'' O
has O
the O
most O
open/documented O
Internet O
persona O
of O
the O
Ajax O
Security O
Team O
. O

He O
registered O
the O
ajaxtm O
[ O
. O

] O
org O
domain O
name O
using O
the O
email O
address O
keyvan.ajaxtm O
@ O
gmail O
[ O
. O

] O
com O
. O

This O
was O
also O
the O
email O
address O
used O
to O
register O
the B-Entity
domain I-Entity
aerospace2014 I-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
, O
which O
was B-Action
used I-Action
in B-Modifier
spear B-Entity
phishing I-Entity
attacks I-Entity
against I-Entity
companies I-Entity
in I-Entity
the I-Entity
U.S. I-Entity
and O
is O
linked O
with O
malware O
activity O
directed O
at O
users O
of O
anti-censorship O
tools O
in O
Iran O
. O

'' O
HUrr O
! O
c4nE O
! O
'' O
features O
prominently O
in O
all O
the O
group O
's O
activities O
and O
defacements O
. O

Although O
there O
has O
been O
a O
decline O
in O
public-facing O
Ajax O
Security O
Team O
activity O
, O
this O
coincides O
with O
an O
increase O
in O
malware O
activity O
linked O
to O
the O
group O
's O
infrastructure O
. O

The O
increasing O
politicization O
of O
the O
Ajax O
Security O
Team O
aligns O
with O
the O
timing O
of O
their O
activities O
against O
the O
perceived O
enemies O
of O
Iran O
. O

In O
addition O
to O
attacking O
companies O
in O
the O
U.S. O
, O
they O
have O
targeted O
domestic O
users O
of O
anti-censorship O
technology O
. O

While O
the O
objectives O
of O
this O
group O
are O
consistent O
with O
Iran O
's O
efforts O
at O
controlling O
political O
dissent O
and O
expanding O
offensive O
cyber O
capabilities O
, O
the O
relationship O
between O
this O
group O
and O
the O
Iranian O
government O
remains O
inconclusive O
. O

For O
example O
, O
the B-Entity
Ajax I-Entity
Security I-Entity
Team I-Entity
could O
just O
be B-Action
using I-Action
anti-censorship B-Entity
tools I-Entity
as B-Modifier
a B-Entity
lure I-Entity
because O
they O
are O
popular O
in O
Iran O
, O
in O
order O
to O
engage O
in O
activities O
that O
would O
be O
considered O
traditional O
cybercrime O
. O

In O
one O
case O
, O
'' O
HUrr O
! O
c4nE O
! O
'' O
, O
using O
the O
email O
address O
keyvan.ajaxtm O
@ O
gmail O
[ O
. O

] O
com O
, O
has O
been O
flagged O
for O
possible O
fraud O
by O
an O
online O
retailer O
. O

While O
'' O
HUrr O
! O
c4nE O
! O
'' O
is O
engaged O
in O
operations O
that O
align O
with O
Iran O
's O
political O
objectives O
, O
he O
may O
also O
be O
dabbling O
in O
traditional O
cybercrime O
. O

This O
indicates O
that O
there O
is O
a O
considerable O
grey O
area O
between O
the O
cyber O
espionage O
capabilities O
of O
Iran's O
hacker O
groups O
and O
any O
direct O
Iranian O
government O
or O
military O
involvement O
. O

On O
the O
spectrum O
of O
state O
responsibility O
, O
these O
attacks O
align O
with O
state-encouraged O
attacks O
, O
which O
are O
defined O
as O
attacks O
in O
which O
: O
Third O
parties O
control O
and O
conduct O
the O
attack O
, O
but O
the O
national O
government O
encourages O
them O
as O
a O
matter O
of O
policy O
. O

Recruiting O
hackers O
through O
this O
model O
allows O
Iran O
to O
influence O
their O
activities O
, O
and O
provides O
the O
Iranian O
government O
plausible O
deniability O
, O
but O
a O
lack O
of O
direct O
control O
also O
means O
that O
the O
groups O
may O
be O
unpredictable O
and O
engage O
in O
unsanctioned O
attacks O
. O

The O
increased O
politicization O
of O
the O
Ajax O
Security O
Team O
, O
and O
the O
transition O
from O
nuisance O
defacements O
to O
operations O
against O
internal O
dissidents O
and O
foreign O
targets O
, O
coincides O
with O
moves O
by O
Iran O
aimed O
at O
increasing O
offensive O
cyber O
capabilities O
. O

While O
the O
relationship O
between O
actors O
such O
as O
the O
Ajax O
Security O
Team O
and O
the O
Iranian O
government O
is O
unknown O
, O
their O
activities O
appear O
to O
align O
with O
Iranian O
government O
political O
objectives O
. O

The O
capabilities O
of O
the O
Ajax O
Security O
Team O
remain O
unclear O
. O

This O
group O
uses O
at O
least O
one O
malware O
family O
that O
is O
not O
publicly O
available O
. O

We O
have O
not O
directly O
observed O
the O
Ajax O
Security O
Team O
use O
exploits O
to O
deliver O
malware O
, O
but O
it O
is O
unclear O
if O
they O
or O
other O
Iranian O
actors O
are O
capable O
of O
producing O
or O
acquiring O
exploit O
code O
. O

While O
the O
Ajax O
Security O
Team O
's O
capabilities O
remain O
unclear O
, O
we O
know O
that O
their O
current O
operations O
have O
been O
somewhat O
successful O
as O
measured O
by O
the O
number O
of O
victims O
seen O
checking O
into O
to O
an O
Ajax O
Security O
Team O
controlled O
CnC O
server O
. O

We O
believe O
that O
if O
these O
actors O
continue O
the O
current O
pace O
of O
their O
operations O
they O
will O
improve O
their O
capabilities O
in O
the O
mid-term O
. O

FireEye O
has O
invented O
a O
purpose-built O
, O
virtual O
machine-based O
security O
platform O
that O
provides O
real-time O
threat O
protection O
to O
enterprises O
and O
governments O
worldwide O
against O
the O
next O
generation O
of O
cyber O
attacks O
. O

These O
highly O
sophisticated O
cyber O
attacks O
easily O
circumvent O
traditional O
signature-based O
defenses O
, O
such O
as O
next-generation O
firewalls O
, O
IPS O
, O
anti-virus O
, O
and O
gateways O
. O

The O
FireEye O
Threat O
Prevention O
Platform O
provides O
real-time O
, O
dynamic O
threat O
protection O
without O
the O
use O
of O
signatures O
to O
protect O
an O
organization O
across O
the O
primary O
threat O
vectors O
and O
across O
the O
different O
stages O
of O
an O
attack O
life O
cycle O
. O

The O
core O
of O
the O
FireEye O
platform O
is O
a O
virtual O
execution O
engine O
, O
complemented O
by O
dynamic O
threat O
intelligence O
, O
to O
identify O
and O
block O
cyber O
attacks O
in O
real O
time O
. O

FireEye O
has O
over O
1,500 O
customers O
across O
more O
than O
40 O
countries O
, O
including O
over O
100 O
of O
the O
Fortune O
500 O
. O

We O
thank O
Kenneth O
Geers O
and O
Jen O
Weedon O
for O
their O
support O
and O
analysis O
on O
these O
findings O
. O

Context O
Information O
Security O
distribute O
Context O
Threat O
Intelligence O
( O
CTI O
) O
reporting O
under O
the O
Traffic O
Light O
Protocol O
( O
TLP O
) O
, O
a O
method O
of O
classifying O
a O
document O
in O
order O
to O
promote O
the O
distribution O
of O
sensitive O
information O
between O
individuals O
, O
organisations O
or O
communities O
in O
a O
controlled O
and O
trusted O
way O
, O
based O
on O
the O
originator O
's O
wishes O
. O

The O
various O
levels O
of O
the O
TLP O
are O
represented O
by O
the O
following O
colours O
: O
Sources O
may O
use O
TLP O
: O
RED O
when O
information O
can O
not O
be O
effectively O
acted O
upon O
by O
additional O
parties O
, O
and O
could O
lead O
to O
impacts O
on O
a O
party O
's O
privacy O
, O
reputation O
, O
or O
operations O
if O
misused O
. O

Recipients O
may O
not O
share O
TLP O
: O
RED O
information O
with O
any O
parties O
outside O
of O
the O
specific O
exchange O
, O
meeting O
, O
or O
conversation O
in O
which O
it O
is O
originally O
disclosed O
. O

TLP O
: O
RED O
information O
will O
be O
passed O
verbally O
or O
in O
person O
. O

Sources O
may O
use O
TLP O
: O
AMBER O
when O
information O
requires O
support O
to O
be O
effectively O
acted O
upon O
, O
but O
carries O
risks O
to O
privacy O
, O
reputation O
, O
or O
operations O
if O
shared O
outside O
of O
the O
organisations O
involved O
. O

Recipients O
may O
only O
share O
TLP O
: O
AMBER O
information O
with O
members O
of O
their O
own O
organisation O
who O
need O
to O
know O
, O
and O
only O
as O
widely O
as O
necessary O
to O
act O
on O
that O
information O
. O

Sources O
may O
use O
TLP O
: O
GREEN O
when O
information O
is O
useful O
for O
the O
awareness O
of O
all O
participating O
organisations O
as O
well O
as O
with O
peers O
within O
the O
broader O
community O
or O
sector O
. O

Recipients O
may O
share O
TLP O
: O
GREEN O
information O
with O
peers O
and O
partner O
organisations O
within O
their O
sector O
or O
community O
, O
but O
not O
via O
publicly O
accessible O
channels O
such O
as O
publication O
or O
posting O
publicly O
on O
the O
Internet O
. O

Sources O
may O
use O
TLP O
: O
WHITE O
when O
information O
carries O
minimal O
or O
no O
foreseeable O
risk O
of O
misuse O
, O
in O
accordance O
with O
applicable O
rules O
and O
procedures O
for O
public O
release O
. O

Subject O
to O
standard O
copyright O
rules O
, O
TLP O
: O
WHITE O
information O
may O
be O
distributed O
freely O
, O
without O
restriction O
. O

On O
2nd O
January O
2014 O
a O
Systems O
Administrator O
at O
the O
Monju O
fast O
breeder O
reactor O
facility O
in O
Japan O
noticed O
suspicious O
connections O
emanating O
from O
a O
machine O
in O
the O
control O
room O
, O
coinciding O
with O
what O
was O
a O
seemingly O
routine O
software O
update O
to O
a O
free O
media O
player O
. O

Among B-Entity
other I-Entity
items I-Entity
, I-Entity
staff I-Entity
training I-Entity
documents I-Entity
and I-Entity
more I-Entity
than I-Entity
40,000 I-Entity
emails I-Entity
were O
stored O
on O
the O
machine O
and O
thought O
to O
be O
harvested B-Action
by O
the B-Entity
attacker I-Entity
. O

The O
Japanese O
Atomic O
Energy O
Agency O
is O
investigating O
further O
. O

The O
attack O
appears O
to O
have O
been O
the O
result O
of O
the B-Entity
attackers I-Entity
having O
compromised B-Action
the B-Entity
'GOM I-Entity
Player I-Entity
' I-Entity
update I-Entity
server I-Entity
and O
having O
it B-Entity
act B-Action
as I-Action
a B-Entity
'watering I-Entity
hole I-Entity
' I-Entity
, O
meaning O
that O
machines B-Entity
which I-Entity
access I-Entity
the I-Entity
site I-Entity
are B-Action
delivered I-Action
malware B-Entity
. O

Gom O
Player O
originates O
in O
South O
Korea O
and O
in O
some O
parts O
of O
Asia O
it O
is O
a O
popular O
alternative O
to O
Windows O
Media O
Player O
. O

It O
is O
unclear O
whether O
every O
machine O
trying O
to O
download O
an O
update O
received O
this O
malware O
or O
whether O
only O
machines O
which O
fitted O
a O
certain O
profile O
were O
infected O
. O

Technical O
analysis O
of O
the O
implant O
on O
the O
compromised O
machine O
has O
shown O
it B-Entity
to O
be B-Action
a B-Entity
variant I-Entity
of I-Entity
a I-Entity
Trojan I-Entity
which O
has O
been O
in O
the O
wild O
for O
some O
years O
now O
and O
continues O
to O
be O
effective O
. O

The O
'Gh0st O
RAT O
' O
has O
been O
used O
extensively O
in O
attacks O
linked O
to O
the O
Chinese O
state O
, O
though O
it O
is O
important O
to O
remember O
that O
the O
code O
is O
publicly O
available O
and O
can O
be O
modified O
and O
used O
by O
anyone O
. O

The O
targeting O
of O
a O
Japanese O
nuclear O
facility O
however O
, O
is O
consistent O
with O
Chinese O
state O
intelligence O
requirements O
. O

If O
this O
is O
the O
work O
of O
a O
Chinese O
group O
then O
we O
feel O
the O
targeting O
may O
go O
much O
further O
than O
the O
Civil O
Nuclear O
sector O
and O
thus O
be O
of O
interest O
to O
the O
wider O
Energy O
Sector O
and O
industry O
as O
a O
whole O
. O

In O
order O
to O
inform O
the O
Energy O
Sector O
and O
beyond O
about O
this O
attack O
, O
we O
have O
compiled O
a O
technical O
summary O
of O
the O
attack O
and O
have O
provided O
a O
number O
of O
Indicators O
Of O
Compromise O
( O
IOCs O
) O
which O
can O
be O
used O
to O
aid O
detection O
. O

It O
is O
likely O
that O
the O
attackers O
would O
redeploy O
their O
implant O
against O
other O
targets O
, O
albeit O
with O
a O
delivery O
mechanism O
more O
tailored O
to O
the O
location O
of O
the O
intended O
victims O
. O

Based O
on O
open O
source O
reporting O
, O
it O
appears O
that O
the O
intrusion O
took O
place O
via O
the O
compromise B-Action
of O
the B-Entity
GOM I-Entity
Player I-Entity
update I-Entity
server I-Entity
( I-Entity
app.gomlab.com I-Entity
) I-Entity
, O
where O
attackers B-Entity
may O
have O
gained B-Action
entry B-Entity
via B-Modifier
a B-Entity
PHP-based I-Entity
webshell I-Entity
, O
hidden O
within O
an O
image O
, O
present O
on O
the O
host O
since O
October O
2011 O
. O

The O
observed O
malicious O
activity O
relates O
to O
the O
modification O
of O
a O
file O
that O
controls O
GOM O
Player O
updates O
, O
spanning O
the O
date O
range O
27th O
December O
2013 O
to O
16th O
January O
2014 O
, O
during O
which O
time O
these B-Entity
alterations I-Entity
are O
reported O
to O
have O
only O
manifested B-Action
themselves B-Entity
for B-Modifier
visitors B-Entity
on I-Entity
certain I-Entity
IP I-Entity
ranges I-Entity
; O
evidence O
supporting O
this O
claim O
has O
not O
yet O
been O
made O
public O
. O

If O
this O
was O
indeed O
the O
case O
, O
then O
the O
nature O
of O
this O
attack O
is O
certainly O
more O
targeted O
than O
one O
that O
would O
cover O
the O
entire O
userbase O
of O
the O
GOM O
Player O
product O
, O
with O
victims O
comprising O
of O
the O
Japanese O
Government O
in O
addition O
to O
those O
at O
the O
Monju O
nuclear O
facility O
. O

The O
modified O
file O
redirected O
the O
GOM O
Player O
update O
process O
to O
another O
compromised O
server O
( O
www.fudousankaitori.jp O
( O
203.189.101.35 O
) O
) O
, O
where O
a B-Entity
file I-Entity
containing I-Entity
both I-Entity
the I-Entity
legitimate I-Entity
update I-Entity
and I-Entity
the I-Entity
malware I-Entity
was B-Action
deliver I-Action
to B-Modifier
the B-Entity
victim I-Entity
. O

Deployed B-Action
to B-Modifier
the B-Entity
system I-Entity
via B-Modifier
a B-Entity
compressed I-Entity
bundle I-Entity
containing I-Entity
the I-Entity
official I-Entity
GOM I-Entity
Player I-Entity
setup I-Entity
binary I-Entity
and I-Entity
a I-Entity
self-extracting I-Entity
RAR I-Entity
archive I-Entity
containing I-Entity
the I-Entity
malicious I-Entity
files I-Entity
, O
the B-Entity
malware I-Entity
consists O
of O
a O
number O
of O
individual O
pieces O
. O

Upon O
extraction O
from O
the O
RAR O
archive O
, O
the B-Entity
installer I-Entity
component I-Entity
( I-Entity
0ae82fd94836815a1e8d284ccb75109d I-Entity
) I-Entity
is B-Action
automatically I-Action
launched I-Action
alongside B-Modifier
the B-Entity
GOM I-Entity
Player I-Entity
update I-Entity
, O
distracting O
victims O
from O
the O
malicious O
activity O
taking O
place O
. O

The O
installer O
component O
is O
referred O
to O
by O
the O
author O
as O
'miansha O
' O
which O
, O
according O
to O
an O
East O
Asia O
Cyber O
Threat O
Intelligence O
Researcher O
, O
is O
likely O
Miǎnshā B-Entity
( I-Entity
免杀 I-Entity
) I-Entity
, O
a B-Entity
phrase I-Entity
commonly I-Entity
used I-Entity
by I-Entity
People I-Entity
's I-Entity
Republic I-Entity
of I-Entity
China I-Entity
( I-Entity
PRC I-Entity
) I-Entity
hackers I-Entity
to O
mean B-Action
'anti B-Entity
Antivirus I-Entity
detection I-Entity
' I-Entity
or I-Entity
'Antivirus I-Entity
avoidance I-Entity
' I-Entity
; O
Symantec O
have O
named O
the O
detection O
for O
this O
code O
'Backdoor.Miancha O
' O
, O
where O
Miǎnchá B-Entity
( I-Entity
免查 I-Entity
, I-Entity
likely I-Entity
shorthand I-Entity
for I-Entity
免杀查 I-Entity
) I-Entity
similarly B-Action
means I-Action
'Antivirus B-Entity
avoidance I-Entity
' I-Entity
. O

The B-Entity
installer I-Entity
is B-Action
responsible B-Entity
for I-Entity
the I-Entity
malware I-Entity
persistence I-Entity
mechanism I-Entity
, O
adding B-Action
entries B-Entity
to B-Modifier
the B-Entity
registry I-Entity
in B-Modifier
the B-Entity
following I-Entity
locations I-Entity
, O
depending O
on O
Windows O
Version O
: O
The B-Entity
installer I-Entity
will O
also O
determine B-Action
the B-Entity
system I-Entity
architecture I-Entity
( I-Entity
32- I-Entity
or I-Entity
64-bit I-Entity
) I-Entity
and O
then O
deobfuscate B-Action
the B-Entity
relevant I-Entity
loader I-Entity
DLL I-Entity
to I-Entity
the I-Entity
path I-Entity
'C I-Entity
: I-Entity
\Windows\temp\install.ocx I-Entity
' I-Entity
, O
ensuring B-Action
the B-Entity
malware I-Entity
is I-Entity
launched I-Entity
on I-Entity
system I-Entity
start-up I-Entity
. O

Oddly O
, O
this O
file O
is O
padded O
with O
null O
bytes O
, O
resulting O
in O
a O
25 O
megabyte O
file O
. O

The O
main O
implant O
code O
is O
stored O
in O
files O
named O
instructions.pdf O
and O
instructions64.pdf O
; O
not O
PDF O
documents O
but O
instead O
DLLs B-Entity
obfuscated B-Action
with B-Modifier
a B-Entity
one-byte I-Entity
XOR I-Entity
with I-Entity
0x14 I-Entity
, O
similar O
to O
the O
malware O
loader O
DLLs O
. O

The B-Entity
loader I-Entity
, O
referred O
to O
by O
the O
malware O
author O
as O
壳 O
( O
shell O
) O
, O
reads B-Action
and O
deobfuscates B-Action
the B-Entity
main I-Entity
implant I-Entity
code I-Entity
which O
then O
communicates B-Action
with B-Modifier
the B-Entity
attacker-controlled I-Entity
server I-Entity
at I-Entity
testqweasd.tk I-Entity
( I-Entity
211.43.220.89 I-Entity
) I-Entity
on B-Modifier
TCP B-Entity
port I-Entity
443 I-Entity
. O

The O
main O
implant O
code O
is O
referred O
to O
as O
白加黑 B-Entity
( I-Entity
'Black I-Entity
on I-Entity
White I-Entity
' I-Entity
) I-Entity
, O
a B-Entity
term I-Entity
used I-Entity
in I-Entity
the I-Entity
PRC I-Entity
hacking I-Entity
community I-Entity
to O
denote B-Action
the B-Entity
act I-Entity
of I-Entity
Antivirus I-Entity
avoidance I-Entity
through I-Entity
the I-Entity
loading I-Entity
of I-Entity
malicious I-Entity
'black I-Entity
' I-Entity
code I-Entity
via I-Entity
non-malicious I-Entity
or I-Entity
trusted I-Entity
'white I-Entity
' I-Entity
code I-Entity
. O

This O
is O
a O
practice O
recently O
illustrated O
through O
the O
deployment O
of O
the O
PlugX O
trojan O
, O
utilising O
DLL B-Entity
load I-Entity
order I-Entity
hijacking B-Action
alongside B-Modifier
a B-Entity
signed I-Entity
( I-Entity
trusted I-Entity
) I-Entity
executable I-Entity
. O

Analysis O
of O
this O
malware O
revealed O
it O
to O
be O
a O
variant O
of O
the O
Gh0st O
RAT O
, O
often O
used O
by O
Chinese O
actors O
( O
including O
those O
who O
are O
state-motivated O
or O
directly O
state-sponsored O
) O
. O

This O
specific O
variant O
shows O
similarities O
to O
that O
used O
during O
the O
VOHO O
campaign O
, O
where O
Gh0st B-Entity
RAT I-Entity
was B-Action
spread I-Action
via B-Modifier
watering B-Entity
hole I-Entity
attacks I-Entity
utilising I-Entity
vulnerable I-Entity
websites I-Entity
belonging I-Entity
to I-Entity
financial I-Entity
services I-Entity
and I-Entity
technology I-Entity
companies I-Entity
. O

Specifically O
, O
the O
initial O
five O
bytes O
of O
the O
communications O
( O
often O
used O
to O
denote O
a O
campaign O
or O
victim O
) O
are O
'HTTPS O
' O
, O
amended O
from O
the O
original O
'Gh0st O
' O
; O
the O
same O
as O
the O
traffic O
produced O
by O
the O
VOHO O
Gh0st O
variant O
. O

In O
addition O
to O
delivering B-Action
system-specific B-Entity
details I-Entity
back B-Modifier
to I-Modifier
the B-Entity
attacker I-Entity
, O
Gh0st B-Entity
RAT I-Entity
provides O
the O
capability O
to O
deploy B-Action
additional B-Entity
malware I-Entity
, O
enabling O
the O
harvesting B-Action
of O
sensitive B-Entity
data I-Entity
and O
enabling B-Action
the B-Entity
further I-Entity
propagation I-Entity
throughout I-Entity
the I-Entity
infected I-Entity
network I-Entity
. O

To O
enable O
rapid O
response O
, O
the O
following O
Snort O
signature O
can O
be O
deployed O
: O
Additionally O
, O
the O
following O
Yara O
signature O
should O
identify O
both O
encoded O
payloads O
and O
the O
active O
implant O
in O
memory O
: O
JustSystems O
has O
issued O
an O
update O
to O
its O
Ichitaro O
product O
line O
( O
Japanese O
office O
suite O
software O
) O
, O
plugging O
a O
zero-day O
vulnerability O
. O

This O
vulnerability O
is O
being O
actively O
exploited O
in O
the O
wild O
to O
specifically O
target O
Japanese O
organizations O
. O

The B-Entity
exploit I-Entity
is B-Action
sent I-Action
to B-Modifier
the B-Entity
targeted I-Entity
organizations I-Entity
through B-Modifier
emails B-Entity
with I-Entity
a I-Entity
malicious I-Entity
Ichitaro I-Entity
document I-Entity
file I-Entity
attached I-Entity
, O
which O
Symantec O
products O
detect O
as O
Bloodhound.Exploit.557 O
. O

Payloads B-Entity
from I-Entity
the I-Entity
exploit I-Entity
may O
include B-Action
Backdoor.Emdivi B-Entity
, I-Entity
Backdoor.Korplug I-Entity
, I-Entity
and I-Entity
Backdoor.ZXshell I-Entity
; O
however O
, O
all B-Entity
payloads I-Entity
aim O
to O
steal B-Action
confidential B-Entity
information I-Entity
from B-Modifier
the B-Entity
compromised I-Entity
computer I-Entity
. O

The O
content O
of O
the O
emails O
vary O
depending O
on O
the O
business O
interest O
of O
the O
targeted O
recipient O
's O
organization O
; O
however O
, O
all O
are O
about O
recent O
political O
events O
associated O
with O
Japan O
. O

Opening B-Entity
the I-Entity
malicious I-Entity
attachment I-Entity
with I-Entity
Ichitaro I-Entity
will O
drop B-Action
the B-Entity
payload I-Entity
and O
display O
the O
document O
. O

Often O
such O
exploitation O
attempts O
crash O
and O
then O
relaunch O
the O
document O
viewer O
to O
open O
a O
clean O
document O
in O
order O
to O
trick O
users O
into O
believing O
it O
is O
legitimate O
. O

In O
this O
particular O
attack O
, O
opening O
the O
document O
and O
dropping O
the O
payload O
are O
done O
without O
crashing O
Ichitaro O
and O
, O
as O
such O
, O
users O
have O
no O
visual O
indications O
as O
to O
what O
is O
really O
happening O
in O
the O
background O
. O

As O
Security O
Response O
previously O
discussed O
, O
unpatched O
vulnerabilities O
being O
exploited O
is O
nothing O
new O
for O
Ichitaro O
. O

However O
, O
during O
our O
investigation O
of O
this O
Ichitaro O
zero-day O
attack O
, O
we O
discovered O
that O
the O
attack O
was O
in O
fact O
part O
of O
an O
ongoing O
cyberespionage O
campaign O
specifically O
targeting O
various O
Japanese O
organizations O
. O

Symantec O
has O
named O
this O
attack O
campaign O
CloudyOmega O
. O

In O
this O
campaign O
, O
variants B-Entity
of I-Entity
Backdoor.Emdivi I-Entity
are B-Action
persistently I-Action
used I-Action
as B-Modifier
a B-Entity
payload I-Entity
. O

All B-Entity
attacks I-Entity
arrive B-Action
on B-Modifier
the B-Entity
target I-Entity
computers I-Entity
as B-Modifier
an B-Entity
attachment I-Entity
to I-Entity
email I-Entity
messages I-Entity
. O

Mostly O
the B-Entity
attachments I-Entity
are B-Action
in B-Modifier
a B-Entity
simple I-Entity
executable I-Entity
format I-Entity
with B-Modifier
a B-Entity
fake I-Entity
icon I-Entity
. O

However O
, O
some O
of O
the O
files O
exploit O
software O
vulnerabilities O
, O
and O
the O
aforementioned O
vulnerability O
in O
Ichitaro O
software O
is O
only O
one O
of O
them O
. O

This B-Entity
group I-Entity
's O
primary O
goal O
is O
to O
steal B-Action
confidential B-Entity
information I-Entity
from B-Modifier
targeted B-Entity
organizations I-Entity
. O

This O
blog O
provides O
insights O
into O
the O
history O
of O
the O
attack O
campaign O
, O
infection O
methods O
, O
malware O
payload O
, O
and O
the O
group O
carrying O
out O
the O
attacks O
. O

The O
first O
attack O
of O
the O
campaign O
can O
be O
traced O
back O
to O
at O
least O
2011 O
. O

Figure O
1 O
shows O
the O
targeted O
sectors O
and O
the O
number O
of O
attacks O
carried O
out O
each O
year O
. O

The O
perpetrators O
were O
very O
cautious O
launching O
attacks O
in O
the O
early O
years O
with O
attacks O
beginning O
in O
earnest O
in O
2014 O
. O

By O
far O
, O
the O
public O
sector O
in O
Japan O
is O
the O
most O
targeted O
sector O
hit O
by O
Operation O
CloudyOmega O
. O

This O
provides O
some O
clue O
as O
to O
who O
the O
attack O
group O
is O
. O

Email O
is O
the O
predominant O
infection O
vector O
used O
in O
this O
campaign O
. O

Figure O
2 O
is O
an O
example O
of O
an O
email O
used O
in O
recent O
attacks O
prior O
to O
those O
exploiting O
the O
Ichitaro O
zero-day O
vulnerability O
. O

The B-Entity
emails I-Entity
include B-Action
password-protected B-Entity
.zip I-Entity
files I-Entity
containing I-Entity
the I-Entity
malware I-Entity
. O

Ironically O
, O
the O
attackers O
follow O
security O
best O
practices O
by O
indicating O
in O
the O
first O
email O
that O
the O
password O
will O
be O
sent O
to O
the O
recipient O
in O
a O
separate O
email O
. O

This B-Entity
is O
merely O
to O
trick B-Action
the B-Entity
recipient I-Entity
into B-Modifier
believing B-Entity
the I-Entity
email I-Entity
is I-Entity
from I-Entity
a I-Entity
legitimate I-Entity
and I-Entity
trustworthy I-Entity
source I-Entity
. O

The O
body O
of O
the O
email O
is O
very O
short O
and O
claims O
the O
attachment O
includes O
a O
medical O
receipt O
. O

The B-Entity
email I-Entity
also O
requests B-Action
that B-Modifier
the B-Entity
recipient I-Entity
open I-Entity
the I-Entity
attachment I-Entity
on I-Entity
a I-Entity
Windows I-Entity
computer I-Entity
. O

The O
file O
in O
the O
attachment O
has O
a O
Microsoft O
Word O
icon O
but O
, O
as O
indicated O
within O
Windows O
Explorer O
, O
it O
is O
an O
executable O
file O
. O

The B-Entity
malicious I-Entity
payload I-Entity
is B-Action
Backdoor.Emdivi B-Entity
, O
a B-Entity
threat I-Entity
that O
opens B-Action
a B-Entity
back I-Entity
door I-Entity
on B-Modifier
the B-Entity
compromised I-Entity
computer I-Entity
. O

The O
malware O
is O
exclusively O
used O
in O
the O
CloudyOmega O
attack O
campaign O
and O
first O
appeared O
in O
2011 O
when O
it O
was O
used O
in O
an O
attack O
against O
a O
Japanese O
chemical O
company O
. O

Emdivi O
allows O
the B-Entity
remote I-Entity
attacker I-Entity
executing B-Action
the B-Entity
commands I-Entity
to O
send B-Action
the B-Entity
results I-Entity
back B-Modifier
to I-Modifier
the B-Entity
command-and-control I-Entity
( I-Entity
C I-Entity
& I-Entity
C I-Entity
) I-Entity
server I-Entity
through B-Modifier
HTTP B-Entity
. O

Each O
Emdivi O
variant O
has O
a O
unique O
version O
number O
and O
belongs O
to O
one O
of O
two O
types O
: O
Type O
S O
and O
Type O
T O
. O

The O
unique O
version O
number O
is O
not O
only O
a O
clear O
sign O
that O
Emdivi O
is O
systematically O
managed O
, O
but O
it O
also O
acts O
as O
an O
encryption O
key O
. O

The B-Entity
malware I-Entity
adds O
extra O
words O
to O
the O
version O
number O
and O
then O
, O
based O
on O
this O
, O
generates B-Action
a B-Entity
hash I-Entity
, O
which O
it B-Entity
uses B-Action
as B-Modifier
an B-Entity
encryption I-Entity
key I-Entity
. O

Both O
Emdivi O
Type O
S O
and O
Type O
T O
share O
the O
following O
functionality O
: O
Type O
T O
is O
primarily O
used O
in O
Operation O
CloudyOmega O
, O
has O
been O
in O
constant O
development O
since O
the O
campaign O
was O
first O
launched O
in O
2011 O
, O
and O
is O
written O
in O
the O
C++ O
programing O
language O
. O

Type B-Entity
T I-Entity
employs B-Action
techniques B-Entity
to B-Modifier
protect B-Entity
itself I-Entity
from I-Entity
security I-Entity
vendors I-Entity
or I-Entity
network I-Entity
administrators I-Entity
. O

Important B-Entity
parts I-Entity
of I-Entity
Type I-Entity
T I-Entity
, I-Entity
such I-Entity
as I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
address I-Entity
it I-Entity
contacts I-Entity
and I-Entity
its I-Entity
protection I-Entity
mechanisms I-Entity
, O
are B-Action
encrypted I-Action
. O

Type B-Entity
T I-Entity
also O
detects B-Action
the B-Entity
presence I-Entity
of I-Entity
automatic I-Entity
analysis I-Entity
systems I-Entity
or O
debuggers B-Entity
, O
such O
as O
the O
following O
: O
Type O
S O
, O
on O
the O
other O
hand O
, O
was O
used O
only O
twice O
in O
the O
attack O
campaign O
. O

Type B-Entity
S I-Entity
is O
a O
.NET O

application O
based B-Action
on B-Modifier
the O
same O
source O
code O
and B-Entity
shared I-Entity
C I-Entity
& I-Entity
C I-Entity
infrastructure I-Entity
as I-Entity
Type I-Entity
T I-Entity
. O

However O
, O
protection O
mechanisms O
and O
encryption O
, O
essential O
features O
for O
threat O
survival O
, O
are O
not O
present O
in O
Type O
S. O
One O
interesting O
trait O
of O
Type O
S O
is O
that O
it O
uses O
Japanese O
sentences O
that O
seem O
to O
be O
randomly O
taken O
from O
the O
internet O
to O
change O
the O
file O
hash O
. O

For O
instance O
, O
in O
the O
example O
shown O
in O
Figure O
4 O
, O
it O
uses O
a O
sentence O
talking O
about O
the O
special O
theory O
of O
relativity O
. O

Once O
infected O
, O
Emdivi B-Entity
connects B-Action
to B-Modifier
hardcoded B-Entity
C I-Entity
& I-Entity
C I-Entity
servers I-Entity
using B-Modifier
the B-Entity
HTTP I-Entity
protocol I-Entity
. O

So O
far O
, O
a O
total O
of O
50 O
unique O
domains O
have O
been O
identified O
from O
58 O
Emdivi O
variants O
. O

Almost O
all O
websites O
used O
as O
C O
& O
C O
servers O
are O
compromised O
Japanese O
websites O
ranging O
from O
sites O
belonging O
to O
small O
businesses O
to O
personal O
blogs O
. O

We O
discovered O
that O
40 O
out O
of O
the O
50 O
compromised O
websites O
, O
spread O
across O
13 O
IP O
addresses O
, O
are O
hosted O
on O
a O
single O
cloud-hosting O
service O
based O
in O
Japan O
. O

The O
compromised O
sites O
are O
hosted O
on O
various O
pieces O
of O
web O
server O
software O
, O
such O
as O
Apache O
and O
Microsoft O
Internet O
Information O
Services O
( O
IIS O
) O
, O
and O
are O
on O
different O
website O
platforms O
. O

This O
indicates O
that O
the O
sites O
were O
not O
compromised O
through O
a O
vulnerability O
in O
a O
single O
software O
product O
or O
website O
platform O
. O

Instead O
, O
the B-Entity
attacker I-Entity
somehow O
penetrated O
the O
cloud O
service O
itself O
and O
turned B-Action
the B-Entity
websites I-Entity
into B-Modifier
C B-Entity
& I-Entity
C I-Entity
servers I-Entity
for I-Entity
Backdoor.Emdivi I-Entity
. O

The O
compromised O
cloud O
hosting O
company O
has O
been O
notified O
but O
, O
at O
the O
time O
of O
writing O
, O
has O
not O
replied O
. O

Symantec O
offers O
two O
IPS O
signatures O
that O
detect O
and O
block O
network O
communication O
between O
infected O
computers O
and O
the O
Emdivi O
C O
& O
C O
server O
: O
During O
our O
research O
, O
multiple O
samples O
related O
to O
this O
attack O
campaign O
were O
identified O
and O
allowed O
us O
to O
connect O
the O
dots O
, O
as O
it O
were O
, O
when O
it O
came O
to O
CloudyOmega O
's O
connections O
to O
other O
attack O
groups O
. O

In O
August O
2012 O
, O
the O
CloudyOmega O
attackers O
exploited O
the O
zero-day O
Adobe O
Flash O
Player O
and O
AIR O
'copyRawDataTo O
( O
) O
' O
Integer O
Overflow O
Vulnerability O
( O
CVE-2012-5054 O
) O
in O
an O
attack O
against O
a O
high-profile O
organization O
in O
Japan O
. O

The B-Entity
attackers I-Entity
sent B-Action
a B-Entity
Microsoft I-Entity
Word I-Entity
file I-Entity
containing I-Entity
a I-Entity
maliciously I-Entity
crafted I-Entity
SWF I-Entity
file I-Entity
that I-Entity
exploited I-Entity
the I-Entity
vulnerability I-Entity
. O

Once O
successfully O
exploited O
, O
the B-Entity
file I-Entity
installed B-Action
Backdoor.Emdivi B-Entity
. O

As O
CVE- O
2012-5054 O
was O
publicly O
disclosed O
in O
the O
same O
month O
, O
the O
attack O
utilized O
what O
was O
, O
at O
the O
time O
, O
a O
zero-day O
exploit O
. O

Interestingly O
, O
the O
Flash O
file O
that O
was O
used O
in O
an O
Emdivi O
attack O
in O
2012 O
and O
the O
one O
used O
in O
the O
LadyBoyle O
attack O
in O
2013 O
look O
very O
similar O
. O

Figure O
6 O
shows O
the O
malformed O
SWF O
file O
executing O
LadyBoyle O
( O
) O
code O
that O
attempts O
to O
exploit O
the O
Adobe O
Flash O
Player O
CVE-2013-0634 O
Remote O
Memory O
Corruption O
Vulnerability O
( O
CVE-2013-0634 O
) O
. O

The O
Flash O
file O
seems O
to O
have O
been O
created O
using O
the O
same O
framework O
used O
by O
the O
CloudyOmega O
group O
, O
but O
with O
a O
different O
exploit O
. O

Both O
attacks O
use O
a O
.doc O

file O
containing O
an B-Entity
Adobe I-Entity
Flash I-Entity
zero-day I-Entity
exploit I-Entity
that O
is O
used O
to O
install B-Action
a B-Entity
back I-Entity
door I-Entity
. O

No O
other O
evidence O
connects O
these O
two O
different O
campaigns O
; O
however O
, O
as O
described O
previously O
in O
Symantec O
Security O
Response O
's O
Elderwood O
blog O
, O
it O
is O
strongly O
believed O
that O
a O
single O
parent O
organization O
has O
broken O
into O
a O
number O
of O
subgroups O
that O
each O
target O
a O
particular O
industry O
. O

In O
terms O
of O
the O
latest O
attack O
on O
Ichitaro O
, O
we O
collected O
a O
dozen O
samples O
of O
JTD O
files O
, O
all O
of O
which O
are O
exactly O
the O
same O
except O
for O
their O
payload O
. O

The O
parent O
organization O
, O
it O
would O
seem O
, O
supplied O
the O
zero-day O
exploit O
to O
the O
different O
subgroups O
as O
part O
of O
an O
attack O
toolkit O
and O
each O
group O
launched O
a O
separate O
attack O
using O
their O
chosen O
malware O
. O

This O
is O
why O
three O
different O
payloads O
( O
Backdoor.Emdivi O
, O
Backdoor.Korplug O
, O
and O
Backdoor.ZXshell O
) O
were O
observed O
in O
the O
latest O
zero-day O
attack O
. O

Operation O
CloudyOmega O
was O
launched O
by O
an O
attack O
group O
that O
has O
communication O
channels O
with O
other O
notorious O
attack O
groups O
including O
Hidden O
Lynx O
and O
the O
group O
responsible O
for O
LadyBoyle O
. O

CloudyOmega O
has O
been O
in O
operation O
since O
2011 O
and O
is O
persistent O
in O
targeting O
Japanese O
organizations O
. O

With O
the O
latest O
attack O
employing O
a O
zero-day O
vulnerability O
, O
there O
is O
no O
indication O
that O
the O
group O
will O
stop O
their O
activities O
anytime O
soon O
. O

Symantec O
Security O
Response O
will O
be O
keeping O
a O
close O
eye O
on O
the O
CloudyOmega O
group O
. O

It O
is O
highly O
recommended O
that O
customers O
using O
Ichitaro O
products O
apply O
any O
patches O
as O
soon O
as O
possible O
. O

Symantec O
offers O
the O
following O
protection O
against O
attacks O
associated O
with O
Operation O
CloudyOmega O
: O
Blue O
Coat O
researchers O
have O
uncovered O
a O
previously-undocumented O
, O
highly O
automated O
, O
and O
extremely O
sophisticated O
framework O
for O
performing O
targeted O
attacks O
. O

The B-Entity
framework I-Entity
is O
notable O
for O
a O
number O
of O
reasons O
, O
including O
( O
but O
not O
limited O
to O
) O
its O
use B-Action
of O
a B-Entity
cloud-based I-Entity
infrastructure I-Entity
for B-Modifier
command-and-control B-Entity
and O
its O
use B-Action
of O
the B-Entity
WebDAV I-Entity
protocol I-Entity
to B-Modifier
send B-Entity
instructions I-Entity
and O
receive B-Entity
exfiltrated I-Entity
information I-Entity
from I-Entity
compromised I-Entity
systems I-Entity
. O

Initial O
malware O
components O
were O
embedded O
in O
Rich O
Text O
Format O
( O
RTF O
) O
files O
. O

Exploitation B-Entity
of I-Entity
vulnerabilities I-Entity
in I-Entity
this I-Entity
file I-Entity
format I-Entity
is B-Action
leveraged I-Action
to B-Modifier
gain B-Entity
remote I-Entity
access I-Entity
to I-Entity
victim I-Entity
's I-Entity
computers I-Entity
. O

The B-Entity
framework I-Entity
, O
thus O
far O
, O
has O
been B-Action
using I-Action
the B-Entity
services I-Entity
of I-Entity
a I-Entity
cloud I-Entity
service I-Entity
provider I-Entity
based I-Entity
in I-Entity
Sweden I-Entity
, I-Entity
CloudMe.com I-Entity
, O
for B-Modifier
its B-Entity
main I-Entity
command-and-control I-Entity
infrastructure I-Entity
. O

Malware O
payloads O
designed O
for O
a O
wide O
array O
of O
potential O
devices O
, O
including O
home O
routers O
and O
mobile O
devices O
running O
iOS O
, O
BlackBerryOS O
or O
Android O
, O
were O
also O
recovered O
during O
the O
course O
of O
our O
research O
. O

The O
framework O
is O
designed O
in O
such O
a O
way O
that O
all B-Entity
post-infection I-Entity
communication I-Entity
( I-Entity
i.e I-Entity
. I-Entity
target I-Entity
surveying I-Entity
, I-Entity
configuration I-Entity
updates I-Entity
, I-Entity
malware I-Entity
updates I-Entity
, I-Entity
and I-Entity
data I-Entity
exfiltration I-Entity
) I-Entity
can O
be B-Action
performed I-Action
via B-Modifier
the B-Entity
cloud I-Entity
service I-Entity
. O

The O
malware O
components O
of O
this O
framework O
follow O
a O
plugin O
model O
, O
where O
new O
malware O
rely O
on O
other O
, O
previously O
delivered O
malware O
components O
to O
interact O
with O
the O
framework O
. O

Initial O
attacks O
were O
largely O
focused O
on O
Russia O
and O
a O
few O
other O
Eastern O
European O
countries O
. O

However O
, O
we O
have O
later O
seen O
that O
attackers O
are O
interested O
in O
targets O
all O
over O
the O
globe O
. O

The O
framework O
is O
itself O
target-agnostic O
, O
and O
seems O
highly O
automated O
. O

The O
operational O
security O
exhibited O
by O
the O
attackers O
is O
very O
good O
- O
among O
the O
best O
we O
have O
seen O
. O

Most B-Entity
interaction I-Entity
between I-Entity
attackers I-Entity
and I-Entity
their I-Entity
infrastructure I-Entity
is B-Action
performed I-Action
via B-Modifier
a B-Entity
convoluted I-Entity
network I-Entity
of I-Entity
router I-Entity
proxies I-Entity
and I-Entity
rented I-Entity
hosts I-Entity
. O

Although O
the O
attackers O
have O
left O
a O
few O
clues O
, O
we O
have O
been O
unable O
to O
provide O
attribution O
with O
any O
degree O
of O
accuracy O
. O

The O
use O
of O
software O
vulnerabilities O
in O
order O
to O
execute O
malicious O
software O
on O
unsuspecting O
users O
' O
computers O
is O
an O
important O
parameter O
to O
monitor O
. O

This O
method O
of O
attack O
is O
not O
only O
known O
to O
have O
a O
considerable O
success O
rate O
, O
it O
is O
also O
often O
deployed O
by O
resourceful O
attackers O
and O
, O
as O
such O
, O
marks O
a O
threat O
worth O
paying O
attention O
to O
. O

The O
use O
of O
exploits O
in O
document O
formats O
like O
PDF O
, O
DOC O
and O
RTF O
is O
in O
some O
ways O
especially O
noteworthy O
. O

Documents O
are O
commonly O
exchanged O
via O
mail O
, O
which O
make O
them O
perfect O
for O
email-borne O
targeted O
attacks O
; O
what O
is O
otherwise O
known O
as O
spear O
phishing O
. O

In O
March O
, O
2014 O
, O
Microsoft O
published O
information O
about O
a O
new O
vulnerability O
in O
Rich O
Text O
Format O
( O
RTF O
) O
. O

This O
vulnerability O
, O
named O
CVE-2014-1761 O
( O
Microsoft O
Word O
RTF O
Object O
Confusion O
) O
, O
had O
already O
been O
used O
effectively O
by O
attackers O
at O
the O
time O
of O
the O
announcement O
. O

Two O
previous O
vulnerabilities O
in O
the O
RTF O
file O
format O
, O
known O
as O
CVE-2010-3333 O
and O
CVE-2012-0158 O
, O
had O
become O
, O
by O
that O
time O
, O
mainstays O
of O
targeted O
attacks O
, O
so O
we O
tracked O
how O
attackers O
implemented O
this O
new O
exploit O
with O
keen O
interest O
. O

By O
late O
August O
, O
we O
identified O
a O
malware O
espionage O
operation O
that O
used O
both O
the O
CVE-2014-1761 O
and O
CVE-2012-0158 O
vulnerabilities O
to O
trigger O
execution O
of O
the O
malicious O
payload O
, O
and O
which O
leveraged O
a O
single O
cloud O
service O
as O
the O
backbone O
of O
its O
entire O
visible O
infrastructure O
. O

When O
we O
examined O
the O
suspicious O
documents O
, O
it O
was O
discovered O
that O
they O
were O
somewhat O
anomalous O
compared O
to O
the O
run-of-the-mill O
material O
. O

They O
turned O
out O
to O
belong O
to O
a B-Entity
highly I-Entity
advanced I-Entity
and I-Entity
professional I-Entity
targeted I-Entity
attack I-Entity
framework I-Entity
, O
which O
utilized B-Action
a B-Entity
complex I-Entity
series I-Entity
of I-Entity
techniques I-Entity
to B-Modifier
survey B-Entity
potential I-Entity
targets I-Entity
. O

Due O
to O
the O
many O
levels O
of O
obfuscation O
and O
indirection O
, O
we O
named O
this O
the O
Inception O
framework O
; O
but O
there O
ends O
all O
similarity O
with O
the O
movie O
by O
the O
same O
name O
. O

Leonardo O
DiCaprio O
is O
not O
associated O
with O
this O
investigation O
. O

We O
initially O
knew O
little O
about O
who O
the O
actual O
targets O
were O
; O
apart O
from O
one O
. O

In O
that O
particular O
case O
we B-Entity
had B-Action
the B-Entity
actual I-Entity
phishing I-Entity
email I-Entity
, O
so O
we O
knew O
the O
apparent O
recipient O
– O
the O
CEO O
of O
a O
large O
Russian O
bank O
. O

The O
email O
was O
apparently O
sent O
from O
'' O
Mrs. O
World O
'' O
; O
note O
the O
Mrs. O
, O
and O
not O
Miss O
- O
World O
. O

We O
soon O
discovered O
that O
our O
malware O
repository O
contained O
several O
other O
, O
similar O
documents O
, O
but O
these O
had O
come O
from O
other O
sources O
which O
did O
not O
include O
the O
email O
message O
, O
or O
any O
identifiable O
information O
about O
the O
targets O
. O

However O
, O
the O
text O
of O
the O
documents O
covered O
a O
variety O
of O
topics O
mostly O
revolving O
around O
Russian O
issues O
relating O
to O
a O
variety O
of O
business O
sectors O
. O

The O
following O
pages O
highlight O
a O
representative O
selection O
of O
these O
documents O
. O

All O
documents O
that O
we O
have O
found O
so O
far O
have O
been O
rather O
standard O
Word O
documents O
, O
of O
the O
old O
97-2003 O
compatible O
format O
based O
on O
OLE2 O
. O

Such O
documents O
can O
, O
and O
typically O
do O
, O
contain O
quite O
a O
bit O
of O
metadata O
: O
The O
name O
of O
the O
document O
creator O
; O
the O
user O
who O
edited O
it O
most O
recently O
; O
the O
name O
of O
the O
company O
whose O
copy O
of O
Word O
was O
used O
to O
create O
the O
document O
, O
et O
al O
. O

Users O
can O
optionally O
configure O
Word O
to O
remove O
this O
metadata O
when O
a O
document O
is O
saved O
, O
and O
that O
's O
exactly O
what O
the O
creator O
of O
these O
documents O
did O
, O
stripping O
out O
this O
potential O
source O
of O
attribution O
data O
. O

However O
, O
Word O
documents O
in O
this O
format O
contain O
additional O
information O
, O
if O
you O
know O
where O
to O
look O
. O

All O
Word O
documents O
of O
this O
format O
contain O
what O
's O
known O
as O
a O
File O
Information O
Block O
( O
FIB O
) O
. O

The O
FIB O
contains O
information O
about O
the O
file O
's O
internal O
structure O
, O
and O
also O
– O
to O
some O
extent O
– O
data O
on O
the O
program O
used O
to O
create O
the O
file O
. O

In O
the O
case O
of O
the O
samples O
we O
analyzed O
, O
all O
of O
the O
documents O
were O
saved O
using O
the O
same O
build O
of O
Microsoft O
Word O
from O
Office14 O
( O
better O
known O
as O
Office O
2010 O
) O
. O

In O
addition O
, O
documents O
can O
contain O
slack O
space O
in O
which O
old O
data O
remains O
. O

For O
example O
, O
the O
decoy O
that O
came O
with O
the O
attack O
named O
'' O
Organigrama O
Gobierno O
Rusia.doc O
'' O
contains O
Visual O
Basic O
leftovers O
indicating O
that O
it O
originally O
was O
created O
on O
a O
computer O
that O
was O
configured O
to O
be O
used O
by O
a O
native O
Spanish O
speaker O
, O
apparently O
by O
an O
advisor O
at O
the O
Spanish O
Embassy O
in O
Moscow O
. O

This B-Entity
document I-Entity
was B-Action
presumably I-Action
obtained I-Action
by O
the B-Entity
attackers I-Entity
and O
repurposed B-Action
for B-Modifier
the B-Entity
attack I-Entity
. O

Despite O
the O
limited O
information O
at O
our O
disposal O
about O
the O
targets O
of O
these O
attacks O
, O
their O
content O
reveals O
some O
context O
about O
who O
the O
possible O
targets O
may O
have O
been O
. O

First O
of O
all O
, O
we B-Entity
have B-Action
the B-Entity
decoy I-Entity
documents I-Entity
which O
indicate O
an O
interest O
in O
: O
We B-Entity
also O
have B-Action
a B-Entity
set I-Entity
of I-Entity
phishing I-Entity
mails I-Entity
, O
which O
were O
targeted O
at O
: O
The O
shellcode O
used O
is O
a O
pretty O
standard O
variant O
previously O
used O
by O
a O
number O
of O
campaigns O
typically O
operating O
out O
of O
China O
, O
but O
with O
some O
minor O
changes O
. O

The B-Entity
malicious I-Entity
content I-Entity
is B-Action
stored I-Action
inside B-Modifier
the B-Entity
document I-Entity
in B-Modifier
encoded B-Entity
form I-Entity
, O
and O
the B-Entity
shellcode I-Entity
decodes O
and O
writes B-Action
this B-Entity
to B-Modifier
disk B-Entity
. O

Upon O
successful O
execution O
this B-Entity
code I-Entity
drops B-Action
a B-Entity
Word I-Entity
document I-Entity
and I-Entity
a I-Entity
Visual I-Entity
Basic I-Entity
script I-Entity
. O

The O
Word O
document O
is O
displayed O
to O
the O
user O
to O
avoid O
arousing O
any O
suspicion O
while O
the B-Entity
script I-Entity
is B-Action
executed I-Action
in B-Modifier
the B-Entity
background I-Entity
. O

Unusual O
for O
many O
exploit O
campaigns O
, O
the B-Entity
names I-Entity
of I-Entity
the I-Entity
dropped I-Entity
files I-Entity
vary O
; O
for O
example O
HyHa9AJ.vbs O
, O
ewRg.vbs O
, O
0QHdN.vbs O
, O
etc O
. O

– O
clearly O
randomized B-Action
in B-Modifier
order I-Modifier
to I-Modifier
avoid B-Entity
detection I-Entity
by I-Entity
name I-Entity
. O

The O
VBScript O
dropper O
code O
is O
also O
a O
little O
unusual O
. O

It O
declares O
a O
Windows O
Management O
Instrumentation O
( O
WMI O
) O
object O
in O
order O
to O
reach O
components O
like O
the O
registry O
and O
file O
system O
. O

This O
seems O
adapted O
from O
Microsoft O
example O
code O
, O
like O
the O
one O
found O
at O
http O
: O
//msdn.microsoft.com/en-us/library/aa387236 O
( O
v=vs.85 O
) O
.aspx O

When O
the O
VBSript O
is O
run O
it B-Entity
drops B-Action
two B-Entity
files I-Entity
to B-Modifier
disk B-Entity
. O

One O
is O
a O
polymorphed O
dll O
file O
and O
the O
other O
a O
binary O
data O
file O
with O
no O
obvious O
internal O
structure O
. O

This B-Entity
data I-Entity
file I-Entity
turns O
out O
to O
be B-Action
encrypted I-Action
using B-Modifier
AES-256 B-Entity
. O

The B-Entity
files I-Entity
will O
be B-Action
installed I-Action
in B-Modifier
several B-Entity
locations I-Entity
: O
These O
locations O
will O
vary O
some O
between O
operating O
system O
versions O
. O

The B-Entity
VBScript I-Entity
then O
sets B-Action
a B-Entity
startup I-Entity
key I-Entity
in B-Modifier
the B-Entity
'' I-Entity
HKCU\Software\Microsoft\Windows\CurrentVersion\Run I-Entity
'' I-Entity
registry I-Entity
path I-Entity
to O
execute B-Action
the B-Entity
DLLs I-Entity
at B-Modifier
boot B-Entity
time I-Entity
. O

Regardless O
of O
whether O
the O
registry O
launches O
the O
DLL O
or O
when O
another O
malware O
executable O
starts O
the O
DLL O
directly O
, O
the B-Entity
DLL I-Entity
is B-Action
launched I-Action
using B-Modifier
regsrv32.exe B-Entity
with B-Modifier
the B-Entity
/s I-Entity
( I-Entity
silent I-Entity
) I-Entity
option I-Entity
. O

The O
names O
of O
these O
dropped O
files O
change O
from O
attack O
to O
attack O
. O

The B-Entity
one I-Entity
above I-Entity
drops B-Action
ctfmonrc.dll B-Entity
. O

Other O
names O
observed O
were O
: O
The O
encrypted O
data O
files O
are O
named O
using O
random O
words O
apparently O
taken O
from O
a O
dictionary O
– O
'' O
acholias O
'' O
, O
'' O
arzner O
'' O
, O
'' O
bicorporate O
'' O
, O
'' O
crockrell O
'' O
, O
'' O
damnatorily O
'' O
etc O
. O

Looking O
at O
one O
of O
the O
dropped O
dlls O
we O
can O
see O
the O
authors O
originally O
called O
it O
95Num3P3gm.dll.polymorphed.dll O
. O

When O
executed O
it O
will O
rebuild O
the O
original O
dll O
( O
95Num3p3gm.dll O
, O
presumably O
) O
, O
load B-Action
it B-Entity
from B-Modifier
memory B-Entity
and O
pass O
over O
execution O
. O

It O
is O
hard O
to O
describe O
the O
polymorphed O
dlls O
with O
any O
real O
depth O
, O
as O
there O
is O
little O
consistency O
between O
them O
. O

When O
two O
nearly O
identical O
dlls O
are O
encoded O
using O
the O
polymorphic O
scheme O
there O
is O
very O
little O
code O
in O
common O
. O

The O
call O
graphs O
are O
different O
and O
key O
functions O
have O
varying O
number O
of O
arguments O
. O

The B-Entity
polymorphing I-Entity
mechanism I-Entity
also O
generates O
, O
and O
inserts O
, O
unique O
functions O
all O
of O
which O
make O
calls O
to O
different O
floating-point O
operations O
– O
all O
done O
just O
to O
obfuscate B-Action
the B-Entity
actual I-Entity
decoding I-Entity
process I-Entity
. O

The O
sizes O
of O
buffers O
allocated O
are O
also O
randomized O
to O
mask O
their O
intent O
. O

What O
is O
common O
is O
that O
somewhere O
along O
the O
execution O
cycle O
is O
one O
extremely O
large O
function O
( O
over O
200 O
kb O
in O
length O
) O
where O
early O
in O
a O
large O
allocation O
is O
made O
where O
the O
un-obfuscated O
binary O
will O
be O
placed O
. O

The O
binary O
is O
then O
built O
from O
de- O
obfuscating O
segments O
of O
it O
that O
have O
been O
dispersed O
through O
the O
'.rdata O
' O
section O
. O

The O
order O
, O
size O
, O
and O
locations O
of O
these O
segments O
vary O
from O
build O
to O
build O
but O
somewhere O
near O
the O
end O
of O
the O
large O
function O
there O
will O
be O
a B-Entity
call I-Entity
to I-Entity
a I-Entity
subfunction I-Entity
that O
loads B-Action
the B-Entity
PE I-Entity
image I-Entity
into B-Modifier
memory B-Entity
, O
followed O
by O
a B-Entity
call I-Entity
to O
free B-Action
the B-Entity
PE I-Entity
image I-Entity
allocation I-Entity
from B-Modifier
memory B-Entity
. O

Simply O
halting O
execution O
before O
this O
function O
call O
permits O
a O
researcher O
to O
extract O
the O
reconstructed O
DLL O
from O
memory O
. O

Here O
, O
pausing O
execution O
before O
the O
call O
to O
'loadpefrommemory O
' O
reveals O
the O
extracted O
PE O
at O
the O
memory O
address O
pointed O
to O
by O
edx O
. O

This O
reconstructed O
DLL O
, O
once O
loaded O
, O
will O
decode O
a O
configuration O
structure O
from O
its O
'.data O
' O
section O
which O
contains O
three O
important O
details O
: O
the O
name O
of O
the O
encrypted O
data O
file O
dropped O
by O
the O
VBScript O
; O
the O
AES O
key O
used O
to O
decrypt O
the O
file O
; O
and O
the O
name O
of O
a O
unique O
global O
mutex O
to O
hold O
while O
running O
to O
prevent O
multiple O
instances O
. O

This B-Entity
configuration I-Entity
information I-Entity
is O
used O
to O
load B-Action
the B-Entity
encrypted I-Entity
file I-Entity
into B-Modifier
memory B-Entity
and O
decrypt O
it O
. O

This O
turns O
out O
to O
be O
yet O
another O
dll O
. O

The O
first O
ordinal O
exported O
by O
this O
dll O
is O
located O
and O
then O
called O
, O
passing O
in O
the O
configuration O
and O
the O
name O
of O
the O
encrypted O
file O
on O
disk O
as O
parameters O
. O

This O
last O
dll O
is O
the O
heart O
of O
the O
threat O
( O
originally O
called O
q5Byo.dll O
in O
this O
instance O
. O

This O
file O
contains O
the O
true O
intent O
of O
this O
campaign O
. O

It B-Entity
is B-Action
designed I-Action
as B-Modifier
a B-Entity
survey I-Entity
tool I-Entity
. O

The B-Entity
PE I-Entity
file I-Entity
gathers B-Action
system B-Entity
information I-Entity
including O
OS B-Entity
version I-Entity
, O
computer B-Entity
name I-Entity
, O
user B-Entity
name I-Entity
, O
user B-Entity
group I-Entity
membership I-Entity
, O
the B-Entity
process I-Entity
it I-Entity
is I-Entity
running I-Entity
in I-Entity
, O
locale B-Entity
ID I-Entity
's I-Entity
, O
as O
well O
as O
system B-Entity
drive I-Entity
and I-Entity
volume I-Entity
information I-Entity
. O

All B-Entity
of I-Entity
this I-Entity
is B-Action
encrypted I-Action
and O
then O
sent B-Action
to B-Modifier
cloud B-Entity
storage I-Entity
via B-Modifier
WebDAV B-Entity
. O

WebDAV O
is O
a O
communication O
standard O
that O
allows O
file O
management O
over O
HTTP O
or O
HTTPS O
. O

Windows O
allows O
WebDAV O
sessions O
to O
be O
mapped O
as O
network O
resources O
. O

The O
use O
of O
WebDAV O
as O
the O
communication O
channel O
is O
atypical O
for O
most O
malware O
samples O
we O
see O
. O

By O
using O
a O
network O
resource O
, O
the O
actual O
web O
traffic O
originates O
from O
the O
system O
itself O
, O
and O
not O
from O
the O
process O
in O
which O
the O
malware O
resides O
. O

Additionally O
, O
once O
the O
resource O
is O
established O
, O
the B-Entity
malware I-Entity
can O
transfer B-Action
files B-Entity
to B-Modifier
and O
from B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
using B-Modifier
standard B-Entity
file I-Entity
IO I-Entity
commands I-Entity
. O

All O
the O
authentication O
information O
for O
the O
WebDAV O
session O
including O
the O
URL O
, O
folders O
, O
path O
, O
user O
name O
, O
and O
password O
is O
stored O
within O
this O
last O
DLL O
in O
another O
AES-encrypted O
configuration O
structure O
in O
the O
binary O
. O

A O
unique O
path O
, O
username O
, O
and O
password O
were O
used O
for O
each O
malware O
instance O
we O
've O
seen O
in O
the O
wild O
. O

This O
allows O
the B-Entity
attackers I-Entity
to O
uniquely O
identify B-Action
every B-Entity
targeted I-Entity
attack I-Entity
and O
track O
how O
successful O
each O
phishing O
campaign O
is O
. O

Also O
contained O
within O
the O
configuration O
structure O
is O
information O
on O
how O
to O
name O
the O
survey O
data O
on O
the O
remote O
file O
server O
. O

The O
binary O
reads O
from O
its O
configuration O
a O
string O
on O
how O
to O
generate O
the O
remote O
filename O
, O
and O
a O
list O
of O
extensions O
to O
use O
. O

An O
example O
would O
be O
'' O
1-7d0-8s O
'' O
, O
[ O
'' O
TIF O
'' O
, O
'' O
TAR O
'' O
, O
'' O
SIT O
'' O
] O
which O
instructs O
the O
binary O
to O
generate O
a O
filename O
with O
1 O
to O
7 O
numeric O
digit O
characters O
followed O
by O
0 O
to O
8 O
ASCII O
letters O
with O
one O
of O
the O
three O
listed O
extensions O
such O
as O
'' O
664gher.TAR O
'' O
. O

The B-Entity
survey I-Entity
is B-Action
then I-Action
uploaded I-Action
to B-Modifier
the B-Entity
server I-Entity
in B-Modifier
a B-Entity
specified I-Entity
folder I-Entity
with B-Modifier
the B-Entity
generated I-Entity
name I-Entity
. O

Files B-Entity
are B-Action
compressed I-Action
using B-Modifier
a B-Entity
modified I-Entity
LZMA-compression I-Entity
and O
encrypted B-Action
using B-Modifier
AES B-Entity
cipher-block-chaining I-Entity
( I-Entity
CBC I-Entity
) I-Entity
before O
being B-Action
uploaded I-Action
to B-Modifier
the B-Entity
cloud I-Entity
server I-Entity
. O

The B-Entity
binary I-Entity
also O
checks B-Action
a B-Entity
separate I-Entity
folder I-Entity
on I-Entity
the I-Entity
cloud I-Entity
service I-Entity
designated I-Entity
to I-Entity
contain I-Entity
new I-Entity
configuration I-Entity
information I-Entity
. O

If O
such O
a O
file O
is O
present O
on O
the O
server O
, O
the B-Entity
malware I-Entity
downloads B-Action
the B-Entity
new I-Entity
configuration I-Entity
file I-Entity
then O
deletes B-Action
it B-Entity
from B-Modifier
the B-Entity
server I-Entity
. O

The O
cloud O
storage O
provider O
in O
every O
case O
we O
have O
seen O
was O
the O
Swedish O
company O
CloudMe.com O
, O
which O
offers O
free O
and O
paid O
WebDAV O
cloud O
storage O
. O

The O
URI O
model O
used O
by O
the O
malware O
is O
http O
: O
//webdav.cloudme.com/ O
% O
username O
% O
/CloudDrive/ O
which O
is O
a O
direct O
reference O
to O
file O
storage O
. O

It O
must O
be O
noted O
that O
the O
CloudMe O
service O
is O
not O
actively O
spreading O
the O
malicious O
content O
; O
the O
attackers O
are O
only O
using O
it O
for O
storing O
their O
files O
. O

We O
notified O
CloudMe.com O
about O
the O
abuse O
of O
their O
services O
. O

Their O
CEO O
, O
Mr. O
Daniel O
Arthursson O
, O
was O
none O
too O
happy O
about O
this O
, O
and O
was O
very O
helpful O
in O
our O
further O
research O
. O

CloudMe O
has O
shared O
a O
great O
deal O
of O
log O
information O
related O
to O
this O
attack O
. O

These O
indicate O
that O
there O
are O
many O
other O
accounts O
( O
over O
100 O
) O
likely O
related O
to O
this O
attack O
system O
. O

We O
have O
no O
way O
of O
verifying O
this O
with O
absolute O
certainty O
, O
but O
this O
is O
what O
we O
regard O
as O
a O
high O
confidence O
assumption O
. O

The O
cloud O
accounts O
are O
not O
used O
for O
one-way O
communication O
only O
. O

The B-Entity
malware I-Entity
also O
checks B-Action
configured B-Entity
subfolders I-Entity
for B-Modifier
updates B-Entity
; O
and O
if O
these O
are O
found O
they B-Entity
will O
be B-Action
downloaded I-Action
, O
decrypted O
and O
used O
as O
appropriate O
. O

One O
such O
case O
is O
the O
franko7046 O
account O
, O
used O
against O
the O
previously O
mentioned O
bank O
CEO O
. O

In O
this O
account O
there O
was O
hidden O
another B-Entity
encrypted I-Entity
configuration I-Entity
file I-Entity
which O
the B-Entity
malware I-Entity
downloaded B-Action
and O
decrypted O
. O

This O
is O
how O
we O
found O
the O
depp3353 O
account O
. O

In O
this O
new O
account O
there O
was O
another O
surprise O
waiting O
for O
us O
– O
a O
download O
folder O
with O
two O
new O
encrypted O
files O
, O
921.bin O
and O
922.bin O
. O

Once O
decrypted O
, O
these O
turned O
out O
to O
be O
PE O
executables O
. O

The O
two O
new O
executables O
are O
plugins O
- O
quite O
similar O
to O
each O
other O
and O
obviously O
compiled O
on O
the O
same O
setup O
. O

They B-Entity
are O
lightweight O
and O
intended O
to O
pull B-Action
specific B-Entity
survey I-Entity
information I-Entity
from B-Modifier
their B-Entity
target I-Entity
. O

Of O
interest O
, O
both O
of O
the O
DLLs O
originally O
had O
the O
same O
internal O
name O
( O
78wO13YrJ0cB.dll O
) O
. O

Presumably O
the O
same O
PE O
sanitization O
script O
and O
parameters O
were O
used O
on O
both O
. O

None O
of O
these O
plugins O
contain O
any O
means O
of O
CnC O
communication O
. O

Instead O
, O
when O
they O
are O
executed O
they B-Entity
are B-Action
passed I-Action
a B-Entity
pointer I-Entity
to I-Entity
a I-Entity
function I-Entity
to B-Modifier
use B-Entity
for I-Entity
sending I-Entity
data I-Entity
back I-Entity
home I-Entity
. O

Neither O
are O
they O
ever O
written O
to O
disk O
. O

They B-Entity
are B-Action
executed I-Action
in B-Modifier
memory B-Entity
only O
, O
and O
once B-Modifier
they B-Entity
have I-Entity
completed I-Entity
the B-Entity
memory I-Entity
is B-Action
freed I-Action
. O

This O
makes O
these O
modules O
extremely O
stealthy O
, O
flexible O
and O
compatible O
with O
multiple O
toolsets O
independent O
of O
what O
CnC O
method O
is O
being O
used O
. O

921.bin B-Entity
retrieves B-Action
several B-Entity
datapoints I-Entity
about B-Modifier
the B-Entity
infected I-Entity
machine I-Entity
: O
Domain B-Entity
info I-Entity
; O
a B-Entity
list I-Entity
of I-Entity
running I-Entity
processes I-Entity
with I-Entity
all I-Entity
loaded I-Entity
modules I-Entity
in I-Entity
each I-Entity
; O
the B-Entity
list I-Entity
of I-Entity
installed I-Entity
software I-Entity
; O
and O
a B-Entity
complete I-Entity
hardware I-Entity
profile I-Entity
of I-Entity
the I-Entity
target I-Entity
machine I-Entity
. O

922.bin B-Entity
compiles B-Action
a B-Entity
dirwalk I-Entity
– I-Entity
a I-Entity
complete I-Entity
listing I-Entity
of I-Entity
every I-Entity
file I-Entity
path I-Entity
– I-Entity
of I-Entity
each I-Entity
fixed I-Entity
drive I-Entity
. O

All B-Entity
of I-Entity
this I-Entity
information I-Entity
is B-Action
exfiltrated I-Action
back B-Modifier
via I-Modifier
the B-Entity
same I-Entity
WebDAV I-Entity
connection I-Entity
. O

This O
model O
makes O
it O
possible O
to O
do O
the O
intrusion O
in O
steps O
, O
with O
verification O
stages O
in O
between O
; O
and O
the O
files O
will O
not O
be O
easily O
found O
on O
affected O
computers O
. O

Based O
on O
the O
information O
gathered O
from O
these O
modules O
, O
the O
attackers O
appear O
to O
move O
to O
the O
next O
stage O
of O
their O
attack O
by O
placing O
more O
new O
components O
on O
the O
WebDAV O
shares O
. O

Information O
about O
these O
uploads O
is O
limited O
by O
the O
fact O
that O
we O
do O
not O
have O
the O
AES O
keys O
to O
decrypt O
much O
of O
the O
uploaded O
data O
, O
but O
we O
have O
been O
able O
to O
see O
some O
upload O
patterns O
. O

What O
we O
assume O
to O
be O
third-stage O
plugins O
appear O
on O
the O
shares O
as O
*.bin O
files O
of O
roughly O
72kb O
. O

As O
with O
other O
plugins O
, O
these B-Entity
are B-Action
downloaded I-Action
and O
deleted B-Action
from B-Modifier
the B-Entity
share I-Entity
in B-Modifier
one B-Entity
go I-Entity
. O

However O
, O
the O
next O
day O
, O
another O
*.bin O
file O
of O
the O
same O
size O
will O
be O
uploaded O
to O
the O
share O
. O

This O
is O
a O
pattern O
that O
repeats O
itself O
over O
all O
live O
accounts O
. O

It O
seems O
that O
because O
the O
plugins O
exist O
in O
memory O
only O
, O
they B-Entity
are B-Action
injected I-Action
daily B-Entity
to B-Modifier
ensure B-Entity
persistence I-Entity
on I-Entity
victim I-Entity
computers I-Entity
. O

Our O
theory O
is O
that O
this B-Entity
malware I-Entity
is B-Action
a B-Entity
more I-Entity
typical I-Entity
datastealer I-Entity
, O
and O
we O
have O
observed O
that O
after O
this O
type O
of O
file O
is O
planted O
on O
the O
account O
, O
encrypted B-Entity
data I-Entity
uploads I-Entity
from I-Entity
compromised I-Entity
users I-Entity
increase B-Action
. O

Victims B-Entity
of I-Entity
this I-Entity
attack I-Entity
will O
connect B-Action
using B-Modifier
the B-Entity
Windows I-Entity
WebDAV I-Entity
redirector I-Entity
, O
and O
the O
HTTP O
request O
user-agent O
string O
will O
reflect O
this O
. O

For O
Windows O
XP O
this O
will O
typically O
be O
'' O
Microsoft-WebDAV-MiniRedir/5.1.2600 O
'' O
, O
and O
for O
Windows O
7 O
a O
common O
user-agent O
is O
'' O
Microsoft-WebDAV-MiniRedir/6.1.7601 O
'' O
. O

Security O
researchers O
– O
and O
there O
are O
a O
few O
of O
them O
- O
connect O
in O
a O
variety O
of O
ways O
; O
first O
of O
all O
, O
we O
see O
a O
number O
of O
connections O
that O
are O
indistinguishable O
from O
the O
way O
victims O
connect O
. O

This O
happens O
when O
researchers O
use O
lab O
machines O
with O
live O
internet O
access O
to O
run O
the O
malware O
. O

The O
only O
way O
we O
can O
tell O
these O
are O
researchers O
is O
because O
they O
connect O
from O
IP O
address O
ranges O
that O
are O
unlikely O
to O
be O
victims O
; O
and O
they O
also O
tend O
to O
consist O
of O
short-lived O
sessions O
. O

Some O
researchers O
set O
up O
scheduled O
tasks O
to O
scan O
the O
shares O
for O
new O
updates O
and O
malware O
. O

We O
see O
a O
few O
variations O
of O
these O
– O
one O
typical O
configuration O
is O
where O
the O
requests O
contain O
a O
Python-related O
user-agent O
string O
. O

Attackers O
, O
on O
the O
other O
hand O
, O
do O
n't O
appear O
to O
use O
Windows O
. O

Common O
across O
multiple O
accounts O
, O
multiple O
IP O
's O
, O
and O
over O
time O
, O
is O
that O
the B-Entity
probable I-Entity
attackers I-Entity
have O
used B-Action
a B-Entity
HTTP I-Entity
user-agent I-Entity
of I-Entity
'' I-Entity
davfs2/1.4.6 I-Entity
neon/0.29.6 I-Entity
'' I-Entity
. O

We O
know O
these O
are O
not O
researchers O
, O
because O
we O
can O
see O
malware O
files O
being O
uploaded O
by O
them O
: O
We O
have O
a O
log O
fragment O
in O
which O
the O
attackers O
uploaded O
a O
sequential O
series O
of O
updates O
( O
from O
1746.bin O
to O
1774.bin O
) O
within O
1.5 O
hours O
on O
Sept O
17th O
, O
spread O
over O
27 O
different O
accounts O
and O
using O
27 O
different O
IP O
addresses O
in O
the O
process O
. O

The O
user-agent O
string O
shows O
that O
attackers O
likely O
have O
used O
a O
client O
based O
on O
the O
open O
source O
davfs2 O
file O
system O
for O
Linux O
to O
mount O
the O
WebDAV O
shares O
. O

This O
client O
is O
used O
when O
uploading O
new O
malware O
, O
but O
also O
when O
the O
attackers O
scan O
their O
shares O
for O
new O
victim O
updates O
, O
in O
which O
case O
the O
shares O
are O
enumerated O
by O
requests O
in O
a O
scheduled O
manner O
. O

The O
attackers O
have O
used O
a O
large O
number O
of O
IP O
addresses O
to O
access O
the O
shares O
. O

As O
mentioned O
above O
, O
there O
is O
a O
rotation O
scheme O
in O
place O
in O
which O
a O
new O
IP O
address O
will O
be O
used O
after O
a O
few O
minutes O
of O
access O
against O
CloudMe O
accounts O
. O

These O
IP O
's O
are O
distributed O
widely O
over O
geographical O
locations O
and O
service O
providers O
, O
with O
a O
heavy O
bias O
towards O
South O
Korean O
ranges O
. O

At O
first O
we O
thought O
these O
IP O
's O
belonged O
to O
some O
commercial O
proxy O
service O
, O
particularly O
since O
several O
such O
proxy O
services O
also O
offer O
IP O
rotation O
. O

However O
, O
this O
turned O
out O
to O
be O
a O
wrong O
assumption O
. O

A O
superficial O
examination O
of O
the O
proxy O
IP O
addresses O
that O
connected O
to O
CloudMe O
showed O
them O
to O
be O
internet-connected O
devices O
of O
various O
kinds O
. O

Many O
were O
Korean O
Tera-EP O
home O
routers O
; O
but O
there O
were O
several O
other O
products O
represented O
. O

It O
is O
believed O
that O
the B-Entity
attackers I-Entity
were O
able O
to O
compromise B-Action
these B-Entity
devices I-Entity
based B-Modifier
on I-Modifier
poor B-Entity
configurations I-Entity
or I-Entity
default I-Entity
credentials I-Entity
. O

We O
were O
able O
to O
do O
some O
forensic O
work O
on O
a O
compromised O
Tera-EP O
TE-800 O
device O
and O
discovered O
another O
dimension O
of O
the O
attacker O
's O
infrastructure O
. O

Under O
the O
ramfs O
mounted O
partition O
we O
found O
a O
stripped O
and O
statically O
linked O
MIPS-el O
binary O
named O
tail- O
. O

Instances O
of O
this O
were O
also O
found O
under O
the O
running O
process O
list O
. O

tail- B-Entity
serves B-Action
as B-Modifier
a B-Entity
SOCKS I-Entity
proxy I-Entity
for B-Modifier
the B-Entity
attackers I-Entity
. O

Each O
sample O
of O
the O
binary O
we O
were O
able O
to O
acquire O
was O
configured O
with O
a O
unique O
32byte O
blowfish O
key O
and O
a O
small O
, O
encrypted O
section O
appended O
to O
the O
end O
of O
the O
binary O
. O

Upon O
execution O
the B-Entity
binary I-Entity
uses O
its O
hardcoded O
key O
to O
decrypt O
the O
configuration O
section O
and O
retrieve B-Action
the B-Entity
listening I-Entity
port I-Entity
to B-Modifier
use B-Entity
for I-Entity
incoming I-Entity
connections I-Entity
. O

This O
acts O
as O
a O
management O
interface O
. O

From O
here O
the O
attackers O
can O
request O
a O
specific O
port O
to O
be O
opened O
as O
one O
of O
the O
following O
types O
: O
SOCKET O
, O
SOCKSS O
, O
SOCKAT O
, O
SOCKS5 O
, O
or O
STATUSPORT O
. O

To O
prevent O
anyone O
else O
from O
accessing O
this O
service O
all O
communication O
on O
the O
management O
interface O
is O
encrypted O
using O
the O
same O
blowfish O
key O
. O

This O
means O
that O
the B-Entity
attackers I-Entity
must O
maintain B-Action
a B-Entity
list I-Entity
of I-Entity
where I-Entity
each I-Entity
of I-Entity
these I-Entity
implants I-Entity
are I-Entity
installed I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
what I-Entity
port I-Entity
and I-Entity
key I-Entity
each I-Entity
is I-Entity
configured I-Entity
to I-Entity
use I-Entity
. O

This O
setup O
makes O
it O
difficult O
to O
identify O
embedded O
devices O
compromised O
with O
this O
malware O
by O
scanning O
open O
ports O
. O

In O
the O
wild O
we O
witnessed O
the O
attackers O
connect O
to O
the O
management O
port O
and O
request O
SOCKSS O
connections O
. O

This O
would O
open O
the O
specified O
port O
and O
wait O
for O
configuration O
data O
, O
which O
consists O
of O
a O
domain O
name O
( O
webdav.cloudme.com O
) O
, O
the O
destination O
port O
, O
and O
a O
variable O
length O
RC4 O
key O
, O
all O
of O
which O
encrypted O
using O
the O
blowfish O
key O
. O

Once O
received O
the B-Entity
malware I-Entity
would O
attempt O
to O
connect B-Action
to B-Modifier
the B-Entity
domain I-Entity
name I-Entity
on B-Modifier
the B-Entity
specified I-Entity
port I-Entity
and O
would O
start O
tunneling B-Action
all B-Entity
traffic I-Entity
received I-Entity
from I-Entity
the I-Entity
SOCKSS I-Entity
port I-Entity
to B-Modifier
the B-Entity
destination I-Entity
and O
vise-versa O
. O

The B-Entity
communication I-Entity
between I-Entity
the I-Entity
attacker I-Entity
and I-Entity
the I-Entity
SOCKSS I-Entity
is B-Action
encoded I-Action
using B-Modifier
the B-Entity
RC4 I-Entity
key I-Entity
. O

The O
graphic O
below O
illustrates O
a O
typical O
session O
. O

The O
router O
proxy O
network O
provides O
another O
layer O
of O
indirection O
masking O
the O
attackers O
' O
infrastructure O
. O

However O
, O
because O
we O
captured O
traffic O
through O
one O
of O
these O
embedded O
devices O
we O
could O
identify O
other O
parts O
of O
their O
operation O
. O

We O
identified O
four B-Entity
IP I-Entity
addresses I-Entity
that O
connected B-Action
to B-Modifier
the B-Entity
proxy I-Entity
malware I-Entity
: O
This B-Entity
host I-Entity
belongs O
to O
a O
Bulgarian O
VPS O
service O
and O
would O
use B-Action
the B-Entity
router I-Entity
proxy I-Entity
to B-Modifier
connect B-Entity
to I-Entity
webdav.cloudme.com I-Entity
. O

This B-Entity
host I-Entity
does O
all O
scanning O
of O
webdav O
shares O
for O
stolen O
user O
data O
, O
and O
also O
uploads B-Action
new B-Entity
malware I-Entity
components I-Entity
. O

This O
IP O
would O
make O
connections O
hourly O
and O
poll O
the O
status O
of O
the O
router O
proxy O
malware O
. O

This O
machine O
is O
most O
likely O
used O
to O
track O
which O
compromised O
routers O
are O
currently O
available O
for O
use O
. O

Traffic O
from O
this O
IP O
had O
a O
very O
specific O
purpose O
: O
It B-Entity
unlocked B-Action
routers B-Entity
for B-Modifier
proxying B-Entity
in B-Modifier
connection I-Modifier
with I-Modifier
the B-Entity
sending I-Entity
of I-Entity
phishing I-Entity
emails I-Entity
. O

In O
the O
wild O
we O
observed O
this B-Entity
IP I-Entity
connect B-Action
to B-Modifier
our B-Entity
router I-Entity
on B-Modifier
the B-Entity
malware I-Entity
management I-Entity
port I-Entity
and O
specify O
a O
SOCKSS O
proxy O
port O
to O
be O
opened O
. O

Immediately O
after O
, O
the B-Entity
newly I-Entity
opened I-Entity
port I-Entity
would O
be B-Action
connected I-Action
to B-Modifier
by O
another B-Entity
IP I-Entity
and O
used O
to O
send B-Action
phishing B-Entity
emails I-Entity
with I-Entity
malicious I-Entity
attachments I-Entity
. O

However O
, O
later O
we O
observed O
that O
the O
Email O
sender O
IP O
at O
VOLIA O
vanished O
and O
the O
Unlocker O
server O
taking O
over O
its O
role O
as O
well O
. O

After O
a O
router O
SOCKSS O
port O
was O
opened O
by O
Unlocker O
, O
this B-Entity
IP I-Entity
would O
connect B-Action
to B-Modifier
the B-Entity
opened I-Entity
port I-Entity
and O
tunnel B-Action
its B-Entity
email I-Entity
traffic I-Entity
through B-Modifier
the B-Entity
router I-Entity
. O

Each O
of O
these O
connections O
used O
the O
correct O
encryption O
key O
, O
so O
we O
know O
that O
these O
accesses O
came O
from O
the O
attackers O
and O
not O
some O
opportunistic O
third O
party O
. O

Mail O
proxies O
: O
Through O
our O
router O
monitoring O
we O
identified O
two B-Entity
mail I-Entity
proxies I-Entity
used B-Action
by O
the B-Entity
attackers I-Entity
. O

We O
were O
later O
notified O
by O
Symantec O
( O
thanks O
, O
guys O
! O
) O
about O
a O
third O
. O

These O
servers O
were O
hosted O
on O
domains O
that O
were O
registered O
by O
the O
attackers O
, O
using O
domain O
names O
clearly O
meant O
to O
look O
legitimate O
. O

This O
is O
the O
only O
time O
we O
have O
seen O
attackers O
register O
domains O
in O
this O
investigation O
. O

The O
mail O
proxies O
were O
: O
Registrant O
WHOIS O
information O
seems O
forged O
: O
The O
connections O
made O
from O
the O
Ukrainian O
host O
to O
the O
router O
were O
interesting O
. O

After O
being O
proxied O
though O
the O
router O
, O
each B-Entity
of I-Entity
these I-Entity
would O
authenticate O
with O
one O
of O
the O
dedicated O
mail O
proxies O
and O
send B-Action
out B-Modifier
phishing B-Entity
attacks I-Entity
. O

From O
captured O
traffic O
it O
appears O
that O
the O
mail O
proxies O
have O
SOCKSv5 O
services O
running O
on O
obscure O
high O
ports O
. O

We O
have O
documented O
that O
the O
attackers O
log O
in O
to O
these O
using O
apparently O
randomly O
generated O
usernames O
and O
passwords O
, O
a O
unique O
pair O
for O
each O
server O
. O

The B-Entity
mail I-Entity
proxy I-Entity
would O
then O
relay B-Action
the B-Entity
spearphishing I-Entity
mail I-Entity
as B-Modifier
seen B-Entity
below I-Entity
. O

This O
way O
the B-Entity
attack I-Entity
can O
be B-Action
mistaken I-Action
to B-Modifier
come B-Entity
from I-Entity
legitimate I-Entity
businesses I-Entity
and I-Entity
trusted I-Entity
organizations I-Entity
. O

In O
some O
cases O
the B-Entity
organization I-Entity
from I-Entity
which I-Entity
the I-Entity
phishing I-Entity
email I-Entity
originates I-Entity
would O
appear B-Action
to B-Modifier
be B-Entity
a I-Entity
known I-Entity
associate I-Entity
to I-Entity
the I-Entity
target I-Entity
. O

The O
email O
shown O
above O
was O
one O
of O
a B-Entity
number I-Entity
of I-Entity
messages I-Entity
sent B-Action
to B-Modifier
targets B-Entity
in I-Entity
the I-Entity
oil I-Entity
industry I-Entity
. O

Investigating O
the O
target O
email O
addresses O
, O
we O
saw O
several O
of O
these O
were O
found O
in O
this O
public O
document O
from O
the O
World O
Petroleum O
Council O
, O
including O
some O
addresses O
that O
are O
, O
at O
the O
present O
time O
, O
no O
longer O
valid O
. O

And O
then O
, O
the O
ground O
shifted O
again O
. O

One B-Entity
of I-Entity
the I-Entity
spearphishing I-Entity
mails I-Entity
we O
observed O
coming B-Action
through B-Modifier
the B-Entity
router I-Entity
network I-Entity
was O
this O
one O
, O
sent B-Action
to B-Modifier
an B-Entity
address I-Entity
under I-Entity
the I-Entity
gov.py I-Entity
( I-Entity
Government I-Entity
of I-Entity
Paraguay I-Entity
) I-Entity
domain I-Entity
. O

There O
was O
no O
executable O
attachment O
in O
this O
mail O
, O
but O
instead O
a O
link O
shortened O
by O
the O
URL O
shortener O
service O
bit.ly O
, O
with O
the O
underlying O
link O
pointing O
to O
an O
IP O
address O
on O
a O
Dutch O
hosting O
service O
. O

Clicking O
that O
link O
from O
a O
Windows O
PC O
only O
yielded O
a O
redirection O
to O
the O
BBC O
homepages O
, O
and O
using O
other O
devices O
did O
not O
give O
more O
data O
. O

The O
bit.ly O
service O
does O
however O
provide O
information O
on O
the O
user O
creating O
the O
shortened O
link O
, O
and O
other O
links O
associated O
with O
this O
account O
. O

In O
this O
case O
, O
the O
user O
was O
named O
nicolatesla53 O
. O

The O
nicolatesla53 O
account O
was O
created O
in O
July O
2014 O
. O

From O
Oct O
24th O
to O
Nov O
21st O
this O
user O
created O
nearly O
10000 O
shortened O
links O
– O
we O
harvested O
9990 O
unique O
ones O
. O

Three O
IP O
addresses O
were O
used O
for O
these O
links O
: O
The O
links O
themselves O
were O
on O
this O
format O
: O
As O
far O
as O
we O
were O
able O
to O
tell O
, O
there O
were O
three O
main O
types O
of O
actioncode O
: O
We O
have O
no O
sample O
of O
the O
actual O
MMS O
phishing O
messages O
apparently O
being O
sent O
, O
but O
we O
can O
see O
the O
page O
served O
when O
a O
user O
clicks O
a O
spammed O
link O
. O

This O
is O
just O
a O
dialogue O
box O
asking O
for O
the O
password O
presumably O
included O
in O
the O
initial O
message O
, O
and O
the O
next O
stage O
likely O
involves O
download O
of O
malicious O
content O
. O

We O
were O
in O
the O
middle O
of O
harvesting O
the O
servers O
for O
data O
on O
the O
various O
action O
codes O
when O
they O
all O
were O
abruptly O
taken O
offline O
; O
so O
our O
data O
on O
which O
mobile O
operators O
are O
targeted O
is O
not O
complete O
. O

We O
managed O
to O
get O
66 O
of O
a O
total O
of O
190 O
. O

The O
ones O
we O
know O
of O
are O
shown O
below O
. O

A O
full O
breakdown O
of O
mobile O
operators O
and O
related O
links O
is O
included O
in O
the O
appendix O
. O

The O
composition O
of O
links O
created O
for O
the O
various O
mobile O
operators O
is O
quite O
interesting O
, O
as O
one O
can O
speculate O
that O
they O
represent O
amount O
of O
actual O
or O
planned O
attacks O
in O
different O
countries O
. O

With O
the O
top O
three O
operators O
being O
Vodafone O
, O
T- O
Mobile O
and O
Proximus O
( O
Belgacom O
) O
it O
seems O
these O
apparent O
phishing O
attacks O
are O
less O
focused O
on O
the O
Russian O
sphere O
than O
the O
previously O
discussed O
malware O
. O

This O
map O
is O
not O
complete O
, O
though O
. O

It O
represents O
only O
about O
35 O
% O
( O
66/190 O
) O
of O
all O
mobile O
operators O
targeted O
and O
66 O
% O
( O
3152/4781 O
) O
of O
all O
phishing O
links O
we O
managed O
to O
harvest O
. O

In O
addition O
, O
some O
operators O
like O
Vodafone O
are O
global O
actors O
, O
so O
the O
map O
might O
show O
an O
unfair O
intensity O
in O
their O
HQ O
locations O
. O

The O
rest O
of O
the O
bit.ly O
links O
used O
the O
action O
codes O
743 O
or O
1024 O
. O

And O
now O
things O
really O
get O
interesting O
. O

By O
using O
mobile O
device O
HTTP O
User-Agents O
we O
were O
able O
to O
trigger O
downloads O
of O
malware O
components O
from O
some O
of O
these O
links O
. O

Accessing B-Entity
the I-Entity
link I-Entity
from I-Entity
an I-Entity
Android I-Entity
User-Agent I-Entity
initiated B-Action
a B-Entity
download I-Entity
of I-Entity
an I-Entity
Android I-Entity
installer I-Entity
package I-Entity
named I-Entity
WhatsAppUpdate.apk I-Entity
. O

The O
package O
we O
analyzed O
was O
1.2MB O
in O
size O
. O

The O
apparent O
main O
purpose O
of O
this B-Entity
malware I-Entity
is O
to O
record B-Action
phone B-Entity
call I-Entity
audio I-Entity
. O

Recordings B-Entity
are B-Action
stored I-Action
as B-Modifier
*.mp4 B-Entity
files I-Entity
, O
and O
uploaded B-Action
to B-Modifier
the B-Entity
attackers I-Entity
periodically B-Entity
. O

The B-Entity
malware I-Entity
is O
able O
to O
collect B-Action
a B-Entity
lot I-Entity
of I-Entity
other I-Entity
information I-Entity
, O
not O
all O
of O
which O
is O
actually O
used O
: O
Through B-Modifier
the B-Entity
encrypted I-Entity
C I-Entity
& I-Entity
C I-Entity
protocol I-Entity
, O
the B-Entity
attackers I-Entity
can O
issue B-Action
commands B-Entity
and I-Entity
binary I-Entity
updates I-Entity
to B-Modifier
the B-Entity
malware I-Entity
. O

It O
uses O
a O
custom O
DAO/Database O
scheme O
which O
uses O
accounts O
belonging O
to O
the O
virtual O
community O
Live O
Journal O
( O
livejournal.com O
) O
as O
data O
stores O
. O

Three O
such O
accounts O
were O
found O
hardcoded O
in O
the O
package O
: O
The O
accounts O
all O
state O
that O
they O
belong O
to O
Iranian O
users O
. O

This O
is O
very O
likely O
false O
. O

The O
text O
in O
these O
posts O
starts O
first O
out O
in O
cleartext O
, O
but O
quickly O
turns O
into O
unreadable O
gibberish O
. O

The O
HTML O
source O
code O
reveals O
that O
the O
encoded O
portion O
is O
encapsulated O
in O
blog-index O
tags O
: O
The O
three O
accounts O
contain O
different B-Entity
configuration I-Entity
blocks I-Entity
pointing B-Action
to B-Modifier
C B-Entity
& I-Entity
C I-Entity
servers I-Entity
apparently I-Entity
located I-Entity
in I-Entity
Poland I-Entity
, I-Entity
Germany I-Entity
and I-Entity
Russia I-Entity
, I-Entity
respectively I-Entity
. O

Based O
on O
registration O
data O
and O
folder O
configuration O
we O
believe O
these O
are O
legitimate O
but O
compromised O
Joomla O
servers O
. O

And O
then O
an O
unexpected O
oddity O
shows O
up O
in O
the O
Java O
source O
: O
We O
were O
also O
able O
to O
download O
a O
similar O
malware O
sample O
( O
BrowserUpdate.apk O
) O
from O
one O
of O
the O
C O
& O
C O
servers O
. O

This O
sample O
used O
different O
online O
accounts O
for O
its O
DAO/database O
functionality O
, O
but O
is O
otherwise O
quite O
similar O
to O
the O
first O
. O

Using B-Entity
an I-Entity
IOS I-Entity
User-Agent I-Entity
triggered B-Action
the B-Entity
download I-Entity
of I-Entity
a I-Entity
Debian I-Entity
installer I-Entity
package I-Entity
, I-Entity
WhatsAppUpdate.deb I-Entity
, O
also O
1.2Mb O
in O
size O
. O

This B-Entity
application I-Entity
impersonates B-Action
a B-Entity
Cydia I-Entity
installer I-Entity
, O
and O
can O
only O
be O
installed O
on O
a O
jailbroken O
phone O
. O

Once O
installed O
, O
it B-Entity
may O
collect B-Action
These B-Entity
data I-Entity
are B-Action
encrypted I-Action
and O
uploaded B-Action
to B-Modifier
an B-Entity
FTP I-Entity
account I-Entity
which O
is O
taken O
from O
an O
encrypted O
configuration O
file O
named O
/usr/bin/cores O
. O

In O
this O
particular O
case O
, O
the O
FTP O
account O
is O
located O
on O
a O
legitimate O
( O
if O
struggling O
) O
hosting O
service O
in O
the O
UK O
. O

In O
this O
case O
, O
there O
's O
another O
clue O
: O
The O
WhatsAppUpdate O
project O
seems O
derived O
from O
an O
earlier O
template O
named O
SkypeUpdate O
. O

By O
now O
, O
it O
came O
as O
no O
surprise O
when O
we O
triggered O
a O
download O
with O
a O
BlackBerry O
User-Agent O
. O

The O
initial O
download O
was O
a O
Java O
Applications O
Descriptor O
, O
a O
text O
file O
designed O
for O
Over-The-Air O
installation O
of O
Java-based O
applications O
. O

This O
JAD O
file O
contained O
the O
locations O
of O
the O
two O
Blackberry O
*.COD O
binaries O
which O
we O
then O
could O
download O
directly O
. O

The B-Entity
application I-Entity
impersonates B-Action
a B-Entity
settings I-Entity
utility I-Entity
. O

This B-Entity
collects B-Action
: O
Collected B-Entity
data I-Entity
will O
be B-Action
uploaded I-Action
to B-Modifier
a B-Entity
DynDNS I-Entity
domain I-Entity
currently I-Entity
hosted I-Entity
on I-Entity
a I-Entity
US I-Entity
webhosting I-Entity
service I-Entity
. O

Since O
these O
COD O
files O
are O
also O
compiled O
Java O
code O
, O
they O
are O
possible O
to O
decompile O
to O
original O
source O
code O
. O

In O
a O
similar O
fashion O
to O
the O
Android O
version O
, O
we O
find O
interesting O
strings O
there O
. O

This O
time O
they O
are O
in O
Arabic O
: O
The O
earliest O
sample O
of O
Inception-related O
malware O
we O
have O
been O
able O
to O
obtain O
, O
was O
submitted O
to O
us O
in O
June O
2014 O
. O

However O
, O
decoy O
document O
metadata O
shows O
that O
it O
was O
created O
late O
May O
. O

The O
related O
cloud O
account O
was O
created O
just O
before O
that O
. O

An O
examination O
of O
the O
other O
documents O
associated O
with O
the O
attacks O
show O
that O
they O
have O
been O
created O
at O
a O
steady O
pace O
all O
through O
summer O
and O
autumn O
2014 O
and O
attacks O
are O
still O
ongoing O
. O

Of O
interest O
is O
also O
the O
attackers O
' O
activity O
patterns O
over O
the O
24h O
cycle O
. O

The O
main O
upload O
of O
new O
components O
to O
shares O
seems O
to O
be O
divided O
over O
two O
high–activity O
periods O
: O
6:00 O
-10:00 O
UTC O
and O
17:00 O
- O
21:00 O
UTC O
. O

No O
uploads O
were O
seen O
between O
23:00 O
and O
05:00 O
UTC O
. O

It O
is O
however O
doubtful O
how O
indicative O
these O
timeframes O
are O
. O

To O
illustrate O
, O
we O
looked O
into O
another O
and O
more O
obscure O
timing O
factor O
: O
The O
timing O
of O
the O
AES O
InitVector O
random O
seeds O
. O

A O
random O
seed O
is O
the O
initial O
value O
passed O
into O
a O
pseudo-randomizer O
function O
. O

The O
malware O
uses O
the O
random O
output O
to O
create O
what O
is O
known O
as O
an O
InitVector O
- O
a O
starting O
point O
for O
the O
AES O
encryption/decryption O
function O
. O

The O
code O
used O
in O
some O
of O
the O
DLLs O
indicate O
that O
the O
attackers O
tend O
to O
use O
the O
C O
time O
( O
) O
function O
to O
generate O
random O
seeds O
. O

This O
function O
returns O
values O
of O
granularity O
down O
to O
seconds O
. O

Thus O
random O
seeds O
, O
and O
ultimately O
the O
InitVectors O
, O
are O
functions O
of O
these O
quite O
coarse O
units O
of O
time O
. O

The B-Entity
encrypted I-Entity
files I-Entity
uploaded B-Action
to B-Modifier
the B-Entity
WebDAV I-Entity
shares I-Entity
come O
with O
their O
InitVectors O
stored O
at O
the O
end O
of O
the O
file O
. O

Since O
we O
know O
the O
time O
window O
to O
be O
within O
a O
few O
days O
of O
the O
upload O
time O
we O
were O
able O
to O
brute O
force O
the O
time O
values O
that O
would O
generate O
the O
corresponding O
InitVectors O
. O

Thus O
, O
we O
were O
able O
to O
say O
to O
the O
second O
when O
the O
file O
was O
created O
– O
and O
most O
times O
were O
identified O
to O
be O
in O
the O
range O
1500 O
- O
2200 O
GMT O
. O

Unfortunately O
, O
we O
had O
to O
reject O
these O
data O
. O

The O
file O
creation O
times O
turned O
out O
to O
be O
hours O
after O
the B-Entity
files I-Entity
themselves I-Entity
were B-Action
uploaded I-Action
to B-Modifier
the B-Entity
WebDAV I-Entity
share I-Entity
. O

Either O
the O
attackers O
' O
system O
clock O
is O
wrong O
or O
a O
fixed O
offset O
is O
added O
to O
the O
random O
seed O
. O

Either O
way O
, O
the O
data O
ca O
n't O
be O
trusted O
; O
and O
shows O
that O
nothing O
can O
be O
taken O
at O
face O
value O
. O

On O
at O
least O
two O
occasions O
during O
our O
surveillance O
of O
the O
Inception O
framework O
, O
the B-Entity
malware I-Entity
downloaded B-Action
something B-Entity
unexpected I-Entity
and I-Entity
wholly I-Entity
different I-Entity
from I-Entity
what I-Entity
we I-Entity
have I-Entity
discussed I-Entity
until I-Entity
now I-Entity
. O

These B-Entity
files I-Entity
were B-Action
downloaded I-Action
as B-Modifier
encrypted B-Entity
*.bin I-Entity
files I-Entity
from B-Modifier
the B-Entity
accounts I-Entity
carter0648 I-Entity
and I-Entity
frogs6352 I-Entity
. O

When O
decrypted O
, O
these O
turned O
out O
to O
be O
dropper B-Entity
packages I-Entity
containing B-Action
one B-Entity
dropper I-Entity
executable I-Entity
clearly I-Entity
created I-Entity
for I-Entity
the I-Entity
Inception I-Entity
framework I-Entity
, I-Entity
and I-Entity
one I-Entity
other I-Entity
, I-Entity
very I-Entity
different I-Entity
executable I-Entity
. O

This O
executable O
, O
( O
sccm.exe O
, O
md5 O
dd8790455109497d49c2fa2442cf16f7 O
) O
is O
a O
classical O
Chinese O
APT O
implant O
. O

It B-Entity
is B-Action
a B-Entity
downloader I-Entity
and O
remote B-Entity
shell I-Entity
program I-Entity
, O
designed O
to O
connect B-Action
to B-Modifier
a B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
to B-Modifier
interact B-Entity
with I-Entity
the I-Entity
attacker I-Entity
and/or O
download B-Action
more B-Entity
malware I-Entity
. O

The B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
in O
this O
case O
is B-Action
ict32.msname.org B-Entity
. O

When O
connecting B-Action
to B-Modifier
this B-Entity
server I-Entity
, O
sccm.exe B-Entity
issues O
the O
following O
request O
: O
This B-Entity
C I-Entity
& I-Entity
C I-Entity
domain I-Entity
is B-Action
used I-Action
by O
many B-Entity
other I-Entity
malwares I-Entity
related I-Entity
to I-Entity
sccm.exe I-Entity
; O
some O
of O
which O
share O
obvious O
connections O
to O
the O
Quarian O
malware O
family O
, O
a O
known O
APT O
intrusion O
tool O
. O

This O
development O
was O
unexpected O
for O
several O
reasons O
. O

First O
of O
all O
, O
it O
apparently O
breaks O
the O
strict O
, O
obfuscatory O
operational O
security O
built O
into O
the O
Inception O
framework O
. O

Inception B-Entity
has O
the O
capacity O
to O
perform O
all O
steps O
needed O
for O
scouting B-Action
out B-Modifier
and O
exfiltrating B-Action
data B-Entity
without O
resorting O
to O
traditional O
hosted O
command O
& O
control O
. O

By O
using B-Action
a O
well-understood O
APT O
tool O
and O
a B-Entity
known I-Entity
malicious I-Entity
C I-Entity
& I-Entity
C I-Entity
domain I-Entity
name I-Entity
, O
the B-Entity
attackers I-Entity
permit O
much O
clearer O
attribution O
. O

Another O
factor O
which O
is O
out O
of O
character O
is O
the O
coding O
style O
. O

All O
Inception-related O
malware O
is O
written O
using O
Visual O
Studio O
2010 O
. O

The O
downloaded O
sccm.exe O
is O
written O
using O
Visual O
C++ O
6 O
; O
and O
has O
a O
PE O
header O
compile O
date O
of O
October O
2010 O
. O

This O
date O
can O
be O
forged O
, O
and O
indeed O
, O
all O
Inception-related O
malware O
has O
some O
level O
of O
forgery O
in O
the O
compile O
dates O
. O

However O
, O
the O
sccm.exe O
compile O
date O
matches O
the O
Quarian O
developer O
toolset O
and O
coding O
style O
to O
a O
better O
degree O
than O
the O
other O
files O
distributed O
through O
Inception O
. O

Then O
there O
is O
the B-Entity
C I-Entity
& I-Entity
C I-Entity
domain I-Entity
used B-Action
. O

According O
to O
DomainTools.com O
the O
msname.org O
domain O
registration O
timed O
out O
September O
27th O
2014 O
. O

It O
was O
left O
inactive O
and O
was O
not O
renewed O
until O
Nov O
12th O
. O

This O
means O
that O
the O
attackers O
distributed O
malware O
that O
would O
be O
out O
of O
action O
for O
a O
long O
time O
( O
last O
distribution O
of O
sccm.exe O
was O
September O
26th O
) O
. O

Because O
of O
all O
this O
we O
consider O
sccm.exe O
as O
an O
unreliable O
indicator O
. O

It O
is O
likely O
to O
be O
a O
red O
herring O
purposefully O
placed O
on O
shares O
where O
the O
attackers O
have O
seen O
signs O
of O
access O
by O
security O
researchers O
. O

At O
one O
instance O
the O
attackers O
seem O
to O
have O
slipped O
up O
. O

Instead O
of O
using O
their O
scheduled O
task O
, O
they O
apparently O
did O
something O
manually O
on O
a O
WebDAV O
share O
. O

This O
is O
visible O
because O
the O
request O
came O
from O
an O
apparent O
attacker O
IP O
, O
but O
used O
yet O
another O
User-Agent O
: O
'' O
gvfs/1.12.3 O
'' O
. O

Gvfs O
is O
the O
virtual O
filesystem O
for O
Gnome O
desktop O
. O

The O
action O
on O
the O
account O
was O
abnormal O
as O
well O
; O
an O
apparent O
file O
upload O
: O
When O
WebDAV O
shares O
are O
mapped O
up O
as O
drives O
by O
the O
operating O
system O
, O
any O
action O
taken O
by O
the O
attacker O
follows O
the O
same O
pattern O
as O
on O
the O
attacker O
's O
local O
drive O
. O

In O
the O
case O
above O
, O
it O
seems O
the O
attacker O
attempted O
to O
edit O
a O
new O
document O
, O
which O
by O
default O
is O
given O
the O
name O
'' O
Untitled O
document O
'' O
in O
Gnome O
. O

This O
might O
indicate O
that O
the O
attacker O
's O
operating O
system O
language O
is O
Spanish O
. O

Of O
course O
, O
Spanish O
is O
one O
of O
the O
world O
's O
most O
widespread O
languages O
, O
so O
one O
can O
not O
infer O
much O
from O
this O
. O

There O
is O
even O
a O
small O
possibility O
that O
the O
phenomenon O
is O
a O
pure O
artifact O
; O
for O
example O
that O
a O
Spanish-speaking O
researcher O
connected O
to O
the O
same O
account O
using O
the O
same O
Linux-based O
setup O
as O
the O
attackers O
. O

This O
attack O
system O
shares O
a O
number O
of O
properties O
that O
are O
somewhat O
similar O
with O
the O
Red O
October O
campaigns O
detailed O
by O
Kaspersky O
Labs O
in O
2013 O
. O

For O
more O
information O
about O
this O
see O
: O
The O
'' O
Red O
October O
'' O
Campaign O
- O
An O
Advanced O
Cyber O
Espionage O
Network O
Targeting O
Diplomatic O
and O
Government O
Agencies O
However O
, O
there O
are O
also O
clear O
differences O
. O

The O
code O
is O
fully O
rewritten O
; O
there O
appears O
to O
be O
little O
code O
overlap O
, O
at O
least O
in O
the O
initial O
stage O
malware O
. O

The O
coding O
style O
is O
different O
, O
with O
different O
solutions O
to O
programmatic O
problems O
, O
different O
use O
of O
exception O
handling O
, O
and O
different O
use O
of O
C++ O
classes O
. O

It O
's O
hard O
to O
believe O
that O
the O
same O
programmers O
are O
responsible O
for O
the O
two O
code O
bases O
. O

The O
Red O
October O
malware O
contained O
linguistic O
markers O
that O
pointed O
towards O
Russian O
speaking O
attackers O
. O

No O
such O
clues O
have O
been O
found O
in O
the O
Inception- O
related O
malware O
; O
there O
is O
a O
marked O
difference O
in O
the O
attention O
to O
detail O
and O
information O
leakage O
. O

It O
is O
certainly O
possible O
that O
the O
same O
people O
have O
organized O
both O
Inception O
and O
Red O
October O
, O
but O
there O
are O
no O
clear O
indications O
to O
this O
effect O
. O

The O
Windows-based O
malware O
in O
this O
paper O
generally O
contains O
very O
few O
noticeable O
strings O
apart O
from O
what O
is O
commonly O
found O
in O
software O
, O
and O
clearly O
randomized O
strings O
. O

What O
exists O
– O
like O
the O
word O
'' O
polymorphed O
'' O
in O
the O
early O
DLL O
versions O
- O
is O
standard O
English O
with O
few O
discerning O
features O
. O

This O
changes O
a O
bit O
when O
we O
look O
at O
the O
mobile O
malware O
. O

In O
the O
Android O
malware O
we O
find O
Hindi O
comments O
in O
the O
Java O
source O
code O
. O

In O
the O
Iphone O
malware O
we O
find O
project O
paths O
referencing O
one O
'' O
JohnClerk O
'' O
, O
and O
a O
few O
typos O
like O
'' O
conutry O
'' O
. O

In O
one O
of O
the O
Blackberry O
binaries O
we O
find O
the O
string O
'' O
GodSaveTheQueen O
'' O
, O
a O
rather O
blunt O
hint O
towards O
Britain O
, O
as O
well O
as O
Arabic O
log O
strings O
. O

These O
and O
other O
indicators O
have O
led O
us O
to O
conclude O
that O
the O
Inception O
attackers O
are O
setting O
a O
new O
standard O
for O
deliberate O
disinformation O
and O
red O
herrings O
in O
a O
malware O
espionage O
operation O
. O

Some O
clues O
might O
have O
been O
added O
by O
accident O
, O
but O
none O
of O
these O
indicators O
can O
be O
trusted O
in O
any O
way O
. O

Thus O
we O
are O
not O
going O
to O
assume O
anything O
about O
who O
might O
be O
behind O
these O
attacks O
. O

The O
whole O
Inception O
setup O
shows O
signs O
of O
automation O
and O
seasoned O
programming O
. O

The O
amount O
of O
layers O
used O
in O
this O
scheme O
to O
protect O
the O
payload O
of O
their O
attack O
seems O
excessively O
paranoid O
. O

Not O
only O
is O
the B-Entity
initial I-Entity
DLL I-Entity
apparently O
polymorphed B-Action
using B-Modifier
some B-Entity
backend I-Entity
tool I-Entity
– O
the O
compile O
time O
stamps O
in O
the O
PE O
header O
are O
clearly O
forged O
, O
resources O
are O
removed O
so O
as O
not O
to O
give O
away O
any O
location O
information O
, O
and O
import O
tables O
are O
shuffled O
around O
, O
rendering O
import O
hashes O
( O
aka O
imphashes O
) O
useless O
. O

The O
names O
of O
the O
files O
both O
when O
dropped O
and O
their O
original O
names O
along O
with O
the O
callback O
directories O
, O
paths O
and O
mutexes O
used O
all O
seem O
to O
be O
dynamically O
generated O
. O

The B-Entity
attackers I-Entity
utilize B-Action
compromised B-Entity
embedded I-Entity
devices I-Entity
– I-Entity
typically I-Entity
routers- I-Entity
on I-Entity
the I-Entity
Internet I-Entity
as I-Entity
well I-Entity
as I-Entity
multiple I-Entity
dedicated I-Entity
hosting I-Entity
providers I-Entity
and I-Entity
VPN I-Entity
services I-Entity
to B-Modifier
mask B-Entity
their I-Entity
identity I-Entity
from I-Entity
the I-Entity
cloud I-Entity
storage I-Entity
provider I-Entity
and I-Entity
others I-Entity
. O

The B-Entity
same I-Entity
router I-Entity
botnet I-Entity
is B-Action
used I-Action
as B-Modifier
a B-Entity
spreading I-Entity
and I-Entity
management I-Entity
platform I-Entity
for I-Entity
attacks I-Entity
on I-Entity
mobile I-Entity
devices I-Entity
as O
well O
. O

This O
suggests O
that O
this O
a O
large O
campaign O
and O
we O
've O
only O
seeing O
the O
beginning O
of O
it O
. O

Initially O
many O
of O
the O
targets O
were O
located O
in O
Russia O
or O
related O
to O
Russian O
interests O
, O
but O
as O
the O
campaign O
has O
evolved O
we O
have O
verified O
targets O
in O
countries O
all O
over O
the O
world O
. O

It O
is O
clear O
that O
this O
infrastructure O
model O
does O
not O
need O
to O
be O
applied O
solely O
against O
a O
few O
targets O
, O
or O
even O
need O
to O
be O
hosted O
at O
CloudMe O
. O

The O
framework O
is O
generic O
, O
and O
will O
work O
as O
an O
attack O
platform O
for O
a O
multitude O
of O
purposes O
with O
very O
little O
modification O
. O

The O
attribution O
indicators O
point O
in O
different O
directions O
and O
ca O
n't O
be O
given O
much O
weight O
. O

These O
attacks O
can O
in O
theory O
be O
the O
creation O
of O
nation O
states O
or O
resourceful O
private O
entities O
- O
we O
consider O
it O
very O
unlikely O
that O
they O
are O
performed O
by O
one O
or O
just O
a O
few O
individuals O
. O

haarmannsi.cz O
sanygroup.co.uk O
ecolines.es O
blackberry-support.herokuapp.com O
( O
DynDNS O
) O
The O
following O
entities O
have O
helped O
in O
big O
and O
small O
ways O
. O

Big O
thanks O
to O
all O
. O

We O
also O
owe O
a O
big O
debt O
of O
gratitude O
to O
Ryan O
W. O
Smith O
of O
Blue O
Coat O
who O
helped O
us O
tremendously O
with O
the O
analysis O
of O
the O
mobile O
malware O
. O

The O
energy O
sector O
has O
become O
a O
major O
focus O
for O
targeted O
attacks O
and O
is O
now O
among O
the O
top O
five O
most O
targeted O
sectors O
worldwide O
. O

Companies O
in O
the O
sector O
are O
facing O
a O
growing O
risk O
of O
having O
their O
services O
interrupted O
or O
losing O
data O
. O

The O
threat O
to O
energy O
firms O
is O
only O
likely O
to O
increase O
in O
the O
coming O
years O
as O
new O
developments O
, O
such O
as O
further O
extensions O
of O
smart O
grids O
and O
smart O
metering O
expose O
more O
infrastructure O
to O
the O
Internet O
. O

Equipment O
that O
is O
not O
connected O
to O
the O
Internet O
and O
other O
networks O
is O
not O
immune O
to O
threats O
and O
there O
has O
already O
been O
a O
number O
of O
successful O
attacks O
against O
isolated O
systems O
. O

Operators O
of O
critical O
infrastructure O
, O
as O
well O
as O
energy O
utility O
companies O
, O
need O
to O
be O
aware O
of O
these O
threats O
and O
prepare O
accordingly O
. O

The O
threat O
to O
energy O
firms O
comes O
from O
several O
different O
sources O
. O

In O
some O
cases O
, O
espionage O
from O
competitors O
is O
the O
primary O
motive O
, O
with O
data O
on O
new O
projects O
, O
exploration O
and O
finances O
being O
targeted O
. O

Disruption O
and O
destruction O
are O
the O
goals O
of O
other O
attacks O
. O

Some O
instances O
appear O
to O
be O
state O
sponsored O
, O
such O
as O
the O
disruption O
of O
the O
Iranian O
nuclear O
program O
by O
the O
Stuxnet O
worm O
in O
2010 O
, O
one O
of O
the O
attacks O
that O
began O
this O
trend O
. O

Others O
appear O
to O
be O
the O
work O
of O
hacktivists O
with O
political O
or O
environmental O
agendas O
. O

Internal O
attackers O
, O
like O
disgruntled O
employees O
, O
are O
also O
a O
major O
source O
of O
attacks O
that O
often O
lead O
to O
service O
disruption O
. O

The O
majority O
of O
the O
actors O
behind O
these O
attacks O
have O
grown O
more O
sophisticated O
in O
the O
way O
they O
attack O
. O

During O
the O
monitoring O
period O
from O
July O
2012 O
to O
June O
2013 O
, O
we O
observed O
an O
average O
of O
74 O
targeted O
attacks O
per O
day O
globally O
. O

Of O
these O
, O
nine O
attacks O
per O
day O
targeted O
the O
energy O
sector O
. O

Accounting O
for O
16.3 O
percent O
of O
all O
attacks O
, O
the O
energy O
sector O
was O
the O
second O
most O
targeted O
vertical O
in O
the O
last O
six O
months O
of O
2012 O
, O
with O
only O
the O
government/public O
sector O
exceeding O
it O
with O
25.4 O
percent O
of O
all O
attacks O
. O

The O
high O
ranking O
was O
mainly O
due O
to O
a O
major O
attack O
against O
a O
global O
oil O
company O
, O
which O
we O
observed O
in O
September O
2012 O
. O

However O
, O
in O
the O
first O
half O
of O
2013 O
the O
energy O
sector O
continued O
to O
attract O
a O
high O
proportion O
of O
attacks O
, O
ranking O
in O
fifth O
place O
with O
7.6 O
percent O
of O
targeted O
attacks O
. O

Not O
all O
of O
the O
attacks O
analyzed O
used O
highly O
sophisticated O
tools O
. O

Most O
of O
them O
could O
have O
been O
prevented O
by O
following O
best O
practice O
guidelines O
for O
protecting O
the O
IT O
infrastructure O
and O
the O
industrial O
components O
, O
indicating O
that O
despite O
high O
revenues O
and O
strategic O
importance O
, O
many O
energy O
sector O
companies O
are O
not O
prioritizing O
cybersecurity O
. O

The O
number O
of O
targeted O
cyberattacks O
in O
general O
has O
risen O
in O
the O
past O
few O
years O
. O

In O
addition O
to O
this O
, O
the O
rate O
of O
attack O
exposure O
has O
also O
risen O
, O
with O
more O
companies O
becoming O
aware O
of O
attacks O
, O
expecting O
them O
and O
searching O
for O
indications O
of O
compromise O
. O

It O
is O
not O
a O
new O
phenomenon O
, O
but O
its O
importance O
has O
grown O
. O

The O
Council O
on O
Foreign O
Relations O
, O
a O
US O
think O
tank O
, O
reported O
that O
energy O
companies O
, O
including O
oil O
and O
gas O
producers O
, O
were O
often O
the O
focus O
of O
targeted O
attacks O
during O
summer O
2012 O
. O

In O
May O
2013 O
the O
US O
Department O
of O
Homeland O
Security O
( O
DHS O
) O
warned O
of O
an O
increase O
in O
sabotage O
attacks O
against O
US O
energy O
companies O
located O
in O
the O
Middle O
East O
. O

The O
government O
had O
tracked O
multiple O
attacks O
and O
issued O
a O
warning O
together O
with O
the O
Industrial O
Control O
Systems O
Cyber O
Emergency O
Response O
Team O
( O
ICS-CERT O
) O
. O

A O
report O
by O
the O
US O
Congress O
supported O
this O
picture O
, O
stating O
that O
many O
power O
utilities O
companies O
were O
under O
constant O
or O
daily O
attack O
through O
cyberspace O
. O

Taking O
into O
account O
that O
successful O
breaches O
of O
critical O
infrastructures O
are O
still O
rare O
and O
that O
these O
numbers O
included O
generic O
malware O
infections O
, O
it O
nevertheless O
highlights O
the O
potential O
for O
cyberattacks O
in O
the O
energy O
sector O
. O

As O
in O
most O
sectors O
, O
attackers O
are O
often O
after O
valuable O
information O
. O

For O
example O
, O
we O
have O
seen O
attackers O
target O
intellectual O
property O
such O
as O
technology O
for O
photovoltaic O
research O
and O
wind O
turbines O
, O
or O
data O
on O
gas O
field O
exploration O
. O

Information O
such O
as O
this O
is O
of O
high O
value O
and O
can O
generate O
huge O
profits O
for O
attackers O
or O
their O
sponsors O
. O

The O
same O
information O
can O
also O
be O
misused O
for O
an O
act O
of O
sabotage O
. O

Many O
power O
utilities O
companies O
fear O
disruptive O
attacks O
the O
most O
, O
regardless O
of O
whether O
it O
is O
done O
by O
internal O
or O
external O
attackers O
. O

The O
energy O
sector O
has O
a O
high O
potential O
for O
critical O
disruption O
through O
sabotage O
attacks O
. O

Any O
interruption O
to O
the O
power O
grid O
would O
cause O
substantial O
chaos O
and O
cascading O
effects O
resulting O
in O
financial O
loss O
. O

In O
the O
past O
there O
have O
been O
quite O
a O
few O
attacks O
that O
included O
targets O
in O
the O
energy O
sector O
. O

Some O
of O
these O
were O
more O
focused O
, O
like O
Stuxnet O
, O
Duqu O
, O
Shamoon/Disttrack O
and O
Night O
Dragon O
. O

Others O
saw O
power O
companies O
targeted O
among O
many O
other O
sectors O
, O
such O
as O
Hidden O
Lynx O
, O
Nitro O
, O
Flamer O
, O
Net O
Traveler O
and O
Elderwood O
to O
name O
a O
few O
. O

One O
of O
the O
biggest O
examples O
, O
and O
a O
game O
changer O
for O
many O
organizations O
, O
was O
Stuxnet O
. O

This O
targeted O
sabotage O
attack O
, O
which O
is O
believed O
to O
have O
been O
aimed O
against O
uranium O
enrichment O
facilities O
in O
Iran O
, O
made O
clear O
what O
could O
be O
done O
through O
cyberattacks O
. O

It O
is O
also O
clear O
that O
the O
energy O
sector O
is O
not O
exempt O
from O
the O
generic O
attacks O
that O
every O
company O
faces O
, O
such O
as O
ransomware B-Entity
that O
locks B-Action
PCs B-Entity
or O
financial B-Entity
Trojans I-Entity
that O
attempt O
to O
steal B-Action
passwords B-Entity
and I-Entity
credit I-Entity
card I-Entity
details I-Entity
. O

For O
example O
, O
such O
a O
case O
happened O
in O
May O
2013 O
, O
when O
a O
small O
fuel O
distribution O
company O
in O
North O
Carolina O
fell O
victim O
to O
a O
cyberheist O
that O
transferred O
US O
$ O
800,000 O
from O
the O
company O
's O
bank O
account O
. O

Such O
threats O
spread O
broadly O
and O
might O
impact O
any O
person O
, O
regardless O
of O
their O
employer O
. O

These O
attackers O
aim O
at O
infecting O
as O
many O
computers O
as O
possible O
in O
order O
to O
maximize O
their O
chances O
of O
profits O
. O

These O
attacks O
can O
include O
nonspecific O
data O
breaches O
where O
employee B-Entity
or I-Entity
customer I-Entity
records I-Entity
get O
stolen B-Action
, O
as O
happened O
to O
the O
US O
Department O
of O
Energy O
in O
July O
2013 O
. O

For O
this O
paper O
we O
focused O
on O
email O
data O
from O
targeted O
attacks O
between O
July O
2012 O
and O
June O
2013 O
. O

Even O
though O
watering O
holes O
are O
becoming O
more O
frequently O
used O
in O
targeted O
attacks O
, O
it O
is O
unfortunately O
quite O
difficult O
to O
reliably O
map O
these O
to O
individual O
campaigns O
. O

A O
blocked O
drive-by O
download O
attempt O
does O
not O
give O
any O
indication O
if O
it O
was O
a O
targeted O
attack O
or O
just O
general O
noise O
. O

In O
quite O
a O
few O
cases O
we O
see O
the O
same O
common O
malware O
, O
like O
Poison O
Ivy O
, O
being O
used O
by O
generic O
attackers O
and O
by O
targeted O
attacks O
. O

In O
such O
cases O
the O
sole O
difference O
between O
a O
sophisticated O
targeted O
attack O
and O
a O
generic O
one O
lies O
in O
the O
person O
commanding O
the O
malware O
. O

Historically O
most O
industrial O
control O
systems O
( O
ICS O
) O
and O
supervisory O
control O
and O
data O
acquisition O
( O
SCADA O
) O
systems O
were O
in O
separated O
networks O
not O
connected O
to O
the O
Internet O
or O
any O
other O
network O
. O

Unfortunately O
this O
security O
through O
segregation O
approach O
does O
not O
fully O
protect O
against O
cyberattacks O
. O

In O
reality O
, O
networks O
are O
rarely O
completely O
isolated O
. O

Often O
some O
configuration O
updates O
are O
periodically O
installed O
or O
log O
files O
are O
transferred O
. O

If O
systems O
are O
not O
directly O
connected O
, O
the O
method O
of O
choice O
for O
these O
types O
of O
interactions O
is O
usually O
through O
a O
USB O
stick O
or O
a O
non-permanent O
modem O
connection O
, O
which O
provides O
a O
way O
into O
the O
restricted O
networks O
. O

This O
allows O
malware B-Entity
to O
spread B-Action
into B-Modifier
such B-Entity
isolated I-Entity
networks I-Entity
as B-Modifier
demonstrated B-Entity
many I-Entity
times I-Entity
by I-Entity
threats I-Entity
such I-Entity
as I-Entity
Stuxnet I-Entity
. O

If O
networks O
are O
truly O
segregated O
, O
this O
would O
mean O
that O
there O
would O
be O
no O
software O
updates O
installed O
, O
leaving O
old O
vulnerabilities O
open O
. O

There O
are O
also O
issues O
around O
processes O
. O

For O
example O
, O
the O
revocation O
lists O
for O
digital O
certificates O
are O
seldom O
updated O
and O
therefore O
certificates O
which O
are O
no O
longer O
valid O
can O
not O
be O
checked O
properly O
and O
would O
still O
be O
accepted O
. O

With O
the O
increasing O
desire O
for O
connectivity O
now O
reaching O
industrial O
plants O
, O
many O
operators O
have O
started O
to O
connect O
their O
ICS O
to O
the O
Internet O
. O

New O
adapters O
can O
bridge O
to O
older O
technology O
which O
was O
never O
intended O
to O
be O
controlled O
over O
the O
Internet O
, O
allowing O
it O
to O
be O
connected O
easily O
. O

This O
allows O
for O
efficient O
centralized O
monitoring O
and O
, O
to O
some O
extent O
, O
remote O
control O
of O
equipment O
. O

Depending O
on O
the O
type O
of O
machinery O
controlled O
through O
the O
human-machine O
interface O
( O
HMI O
) O
of O
the O
ICS O
, O
not O
all O
modifications O
are O
possible O
. O

Some O
systems O
are O
physically O
connected O
in O
a O
pure O
read-only O
mode O
for O
monitoring O
. O

And O
even O
if O
they O
are O
fully O
connected O
, O
some O
turbines O
have O
physical O
limitations O
or O
emergency O
systems O
based O
on O
physical O
effects O
that O
can O
not O
be O
overridden O
by O
the O
digital O
controller O
. O

Thus O
, O
not O
all O
Hollywood O
scenarios O
of O
open O
flood O
gates O
or O
turbines O
that O
fly O
through O
the O
air O
are O
possible O
. O

However O
, O
sabotage B-Entity
attacks I-Entity
that O
damage B-Action
equipment B-Entity
are O
definitely O
possible O
, O
as O
has O
already O
been O
demonstrated O
. O

In O
the O
future O
, O
more O
systems O
are O
going O
to O
implement O
the O
failsafe O
switches O
in O
software O
, O
opening O
up O
the O
vector O
for O
malware O
attacks O
. O

An O
additional O
source O
of O
concern O
is O
that O
some O
countries O
have O
started O
to O
open O
the O
energy O
market O
for O
smaller O
private O
contributors O
. O

This O
means O
that O
almost O
anyone O
can O
use O
mini O
power O
plants O
like O
water O
, O
wind O
or O
photovoltaic O
sites O
to O
feed O
energy O
back O
into O
the O
power O
grid O
. O

Often O
these O
operators O
do O
not O
have O
a O
full O
IT O
staff O
supporting O
the O
facilities O
at O
hand O
, O
which O
might O
lead O
to O
more O
vulnerable O
installations O
. O

Furthermore O
they O
may O
deploy O
new O
technology O
which O
might O
be O
untested O
and O
contain O
some O
unknown O
vulnerabilities O
. O

While O
these O
smaller O
sites O
make O
up O
only O
a O
small O
portion O
of O
the O
grid O
, O
new O
decentralized O
power O
input O
feeds O
are O
a O
challenge O
for O
the O
balance O
of O
the O
power O
grid O
as O
well O
and O
need O
to O
be O
carefully O
monitored O
. O

Small O
outages O
or O
changes O
can O
have O
a O
domino O
effect O
for O
the O
whole O
power O
grid O
. O

To O
increase O
the O
exposure O
of O
energy O
firms O
even O
further O
, O
sites O
like O
SHODAN O
, O
which O
is O
essentially O
a O
search O
engine O
for O
devices O
, O
enable O
anyone O
to O
easily O
find O
exposed O
controllers O
on O
the O
Internet O
. O

Of O
course O
not O
all O
of O
the O
industrial O
control O
systems O
connected O
to O
the O
Internet O
are O
critical O
systems O
or O
even O
real O
ones O
. O

Some O
researchers O
have O
started O
to O
create O
honey O
pot O
systems O
in O
order O
to O
study O
the O
attackers O
, O
which O
have O
apparently O
already O
attracted O
attackers O
like O
the O
Comment O
Crew/APT1 O
group O
, O
who O
have O
broken O
into O
these O
decoy O
systems O
. O

Smart O
grids O
and O
smart O
metering O
are O
bringing O
significant O
change O
to O
the O
world O
's O
power O
systems O
. O

Experts O
predict O
that O
billions O
of O
smart O
meters O
and O
sensors O
will O
be O
installed O
worldwide O
over O
the O
next O
ten O
years O
. O

They O
enable O
utility O
companies O
to O
measure O
energy O
consumption O
at O
a O
more O
granular O
level O
, O
creating O
better O
flow O
patterns O
and O
enabling O
different O
prices O
for O
consumption O
based O
on O
the O
time O
of O
day O
and O
location O
. O

This O
development O
brings O
new O
opportunities O
, O
as O
well O
as O
new O
challenges O
. O

As O
with O
any O
connected O
infrastructure O
, O
it O
is O
important O
to O
secure O
the O
network O
and O
its O
endpoint O
on O
multiple O
levels O
. O

There O
have O
already O
been O
proof O
of O
concept O
attacks O
that O
demonstrate O
how O
smart B-Entity
meters I-Entity
could O
be B-Action
manipulated I-Action
to B-Modifier
send B-Entity
back I-Entity
false I-Entity
information I-Entity
or I-Entity
report I-Entity
incorrect I-Entity
billing I-Entity
IDs I-Entity
, I-Entity
leading I-Entity
to I-Entity
power I-Entity
theft I-Entity
. O

In O
addition O
to O
the O
issue O
of O
securing O
these O
devices O
, O
smart O
grids O
will O
produce O
a O
huge O
amount O
of O
data O
which O
, O
depending O
on O
regulations O
, O
will O
need O
to O
be O
kept O
for O
audits O
. O

Some O
of O
this O
data O
may O
be O
sensitive O
and O
could O
raise O
privacy O
concerns O
if O
not O
properly O
protected O
. O

This O
could O
easily O
grow O
to O
petabytes O
of O
data O
that O
needs O
to O
be O
safely O
stored O
and O
managed O
. O

It O
is O
beyond O
the O
scope O
of O
this O
paper O
to O
address O
all O
the O
challenges O
associated O
with O
smart O
grids O
and O
smart O
meters O
. O

Symantec O
has O
created O
a O
dedicated O
whitepaper O
for O
this O
topic O
: O
How O
to O
protect O
critical O
infrastructure O
, O
mitigate O
fraud O
and O
guarantee O
privacy O
. O

As O
a O
member O
of O
the O
CRISALIS O
project O
, O
Symantec O
is O
following O
these O
developments O
closely O
and O
is O
helping O
to O
secure O
critical O
infrastructure O
together O
with O
partners O
from O
academia O
and O
different O
industry O
sectors O
. O

There O
have O
been O
numerous O
cyberattacks O
against O
the O
energy O
sector O
over O
the O
past O
few O
years O
. O

Not O
all O
of O
them O
were O
the O
work O
of O
sophisticated O
attackers O
; O
some O
incidents O
were O
just O
collateral O
damage O
caused O
by O
malware O
infections O
or O
bad O
configuration O
issues O
. O

These O
incidents O
highlight O
the O
fact O
that O
such O
attacks O
can O
happen O
and O
that O
they O
can O
have O
real O
life O
consequences O
. O

In O
2013 O
part O
of O
the O
Austrian O
and O
German O
power O
grid O
nearly O
broke O
down O
after O
a O
control O
command O
was O
accidentally O
misdirected O
. O

It O
is O
believed O
that O
a O
status O
request O
command O
packet O
, O
which O
was O
broadcast O
from O
a O
German O
gas O
company O
as O
a O
test O
for O
their O
newly O
installed O
network O
branch O
, O
found O
its O
way O
into O
the O
systems O
of O
the O
Austrian O
energy O
power O
control O
and O
monitoring O
network O
. O

Once O
there O
, O
the O
message O
generated O
thousands O
of O
reply O
messages O
, O
which O
generated O
even O
more O
data O
packages O
, O
which O
in O
turn O
flooded O
the O
control O
network O
. O

To O
stop O
this O
self-inflicted O
DDoS O
attack O
, O
part O
of O
the O
monitoring O
and O
control O
network O
had O
to O
be O
isolated O
and O
disconnected O
. O

Fortunately O
the O
situation O
was O
resolved O
without O
any O
power O
outages O
. O

In O
2008 O
, O
Tom O
Donahue O
, O
a O
senior O
Central O
Intelligence O
Agency O
( O
CIA O
) O
official O
told O
a O
meeting O
of O
utility O
company O
representatives O
that O
cyberattacks B-Entity
had O
taken B-Action
out I-Action
power B-Entity
equipment I-Entity
in I-Entity
multiple I-Entity
cities I-Entity
outside I-Entity
the I-Entity
United I-Entity
States I-Entity
. O

In O
some O
cases O
the O
attacker O
tried O
to O
extort O
money O
from O
the O
energy O
companies O
, O
threatening O
them O
with O
further O
blackouts O
. O

In O
2003 O
the B-Entity
safety I-Entity
monitoring I-Entity
system I-Entity
of I-Entity
the I-Entity
Ohio I-Entity
nuclear I-Entity
power I-Entity
plant I-Entity
apparently O
went B-Action
offline B-Entity
for B-Modifier
several B-Entity
hours I-Entity
due B-Modifier
to I-Modifier
a B-Entity
Slammer I-Entity
worm I-Entity
infection I-Entity
. O

Fortunately O
the O
power O
plant O
was O
already O
offline O
due O
to O
maintenance O
and O
the O
installed O
secondary O
backup O
monitoring O
system O
was O
unaffected O
by O
the O
worm O
. O

Nevertheless O
the O
incident O
raised O
safety O
concerns O
. O

At O
the O
beginning O
of O
2003 O
a B-Entity
marine I-Entity
terminal I-Entity
in I-Entity
Venezuela I-Entity
was B-Action
targeted I-Action
by O
a B-Entity
sabotage I-Entity
attack I-Entity
. O

Details O
of O
this O
attack O
are O
scarce O
and O
vague O
, O
but O
it O
seems O
that O
during O
a O
strike O
an B-Entity
attacking I-Entity
group I-Entity
managed O
to O
get B-Action
access B-Entity
to I-Entity
the I-Entity
SCADA I-Entity
network I-Entity
of I-Entity
the I-Entity
oil I-Entity
tanker I-Entity
loading I-Entity
machinery I-Entity
and O
overwrote B-Action
programmable B-Entity
logic I-Entity
controllers I-Entity
( I-Entity
PLCs I-Entity
) I-Entity
with B-Modifier
an B-Entity
empty I-Entity
program I-Entity
module I-Entity
. O

This B-Entity
halted B-Action
machinery B-Entity
, O
preventing B-Action
oil B-Entity
tankers I-Entity
from B-Modifier
loading B-Entity
for B-Modifier
eight B-Entity
hour I-Entity
till B-Modifier
the B-Entity
unaffected I-Entity
backup I-Entity
code I-Entity
was I-Entity
reinstalled I-Entity
on I-Entity
the I-Entity
PLCs I-Entity
. O

The O
attack O
was O
not O
too O
sophisticated O
as O
it O
was O
easily O
spotted O
. O

A O
small O
modification O
of O
the O
PLC O
code O
instead O
would O
probably O
have O
gone O
unnoticed O
for O
a O
long O
time O
. O

In O
2001 O
an O
attack O
took O
place O
against O
California O
's O
power O
distribution O
center O
, O
which O
controls O
the O
flow O
of O
electricity O
across O
California O
. O

Due O
to O
apparently O
poor O
security O
configuration O
, O
the O
attacker O
was O
able O
to O
compromise O
two O
Web O
servers O
that O
were O
part O
of O
a O
developer O
network O
and O
penetrate O
further O
from O
there O
. O

Fortunately O
the O
attackers O
were O
stopped O
before O
they O
managed O
to O
attack O
any O
systems O
which O
were O
tied O
into O
the O
transmission O
grid O
for O
the O
Western O
United O
States O
. O

According O
to O
Russian O
officials O
, O
the O
largest O
natural O
gas O
extraction O
company O
in O
the O
country O
was O
successfully O
attacked O
in O
2000 O
. O

The B-Entity
attackers I-Entity
used B-Action
a B-Entity
Trojan I-Entity
to B-Modifier
gain B-Entity
access I-Entity
to I-Entity
the I-Entity
control I-Entity
for I-Entity
the I-Entity
gas I-Entity
pipelines I-Entity
. O

Through O
this O
switchboard O
, O
the O
flow O
for O
individual O
gas O
pipelines O
could O
have O
been O
modified O
, O
which O
would O
easily O
have O
caused O
widespread O
disruption O
. O

Aside O
from O
these O
incidents O
, O
there O
have O
also O
been O
a O
number O
of O
more O
serious O
and O
well-documented O
targeted O
attacks O
against O
the O
energy O
sector O
: O
The O
Stuxnet O
incident O
and O
its O
relatives O
Duqu O
, O
Flamer O
and O
Gauss O
are O
some O
of O
the O
most O
talked-about O
cases O
of O
targeted O
attacks O
. O

As O
far O
as O
we O
know O
today O
, O
the B-Entity
Stuxnet I-Entity
operation I-Entity
began B-Action
in B-Modifier
November B-Entity
2005 I-Entity
with B-Modifier
the B-Entity
registration I-Entity
of I-Entity
the I-Entity
command I-Entity
and I-Entity
control I-Entity
( I-Entity
C I-Entity
& I-Entity
C I-Entity
) I-Entity
servers I-Entity
used I-Entity
in I-Entity
the I-Entity
attacks I-Entity
. O

The O
first O
recorded O
appearance O
of O
what O
we O
now O
call O
Stuxnet O
version O
0.5 O
was O
in O
November O
2007 O
. O

Since O
then O
, O
a O
handful O
of O
different O
versions O
have O
been O
found O
and O
analyzed O
. O

Stuxnet O
1.x O
is O
based O
on O
what O
is O
now O
known O
as O
the O
'' O
tilded O
'' O
platform O
; O
whereas O
Stuxnet O
0.5 O
is O
based O
on O
the O
Flamer O
framework O
. O

The O
code O
segments O
and O
programming O
style O
differ O
, O
which O
indicates O
that O
two O
different O
programming O
teams O
were O
most O
likely O
responsible O
for O
the O
different O
branches O
of O
Stuxnet O
. O

Thorough O
investigation O
into O
the O
mechanism O
and O
functions O
of O
this O
threat O
started O
in O
July O
2010 O
. O

Stuxnet B-Entity
is O
the O
first O
known O
autonomous O
threat O
to O
target B-Action
and I-Action
sabotage I-Action
industrial B-Entity
control I-Entity
systems I-Entity
to O
such O
an O
extent O
. O

Stuxnet B-Entity
is O
a O
sophisticated O
piece O
of O
malware O
, O
which O
uses B-Action
seven B-Entity
vulnerabilities I-Entity
to B-Modifier
spread B-Entity
and I-Entity
infect I-Entity
its I-Entity
targets I-Entity
. O

The O
most O
notable O
vulnerability O
is O
the O
Microsoft O
Windows O
Shortcut O
'LNK/PIF O
' O
Files O
Automatic O
File O
Execution O
Vulnerability O
( O
CVE-2010-2568 O
) O
, O
which O
allows O
it O
to O
auto-execute O
on O
USB O
drives O
. O

Spreading B-Action
through B-Modifier
infected B-Entity
portable I-Entity
media I-Entity
drives I-Entity
allowed O
it B-Entity
to O
also O
infect B-Action
networks B-Entity
isolated I-Entity
by I-Entity
air I-Entity
gaps I-Entity
that I-Entity
are I-Entity
unreachable I-Entity
from I-Entity
the I-Entity
Internet I-Entity
. O

This O
was O
most O
likely O
the O
first O
infection O
vector O
used O
by O
Stuxnet O
. O

In O
addition O
, O
it B-Entity
is O
able O
to O
infect B-Action
Step7 B-Entity
project I-Entity
files I-Entity
, I-Entity
which I-Entity
are I-Entity
used I-Entity
to I-Entity
control I-Entity
Programmable I-Entity
Logic I-Entity
Controllers I-Entity
( I-Entity
PLCs I-Entity
) I-Entity
. O

This O
allowed O
the B-Entity
worm I-Entity
to O
infect B-Action
computers B-Entity
whenever B-Modifier
the B-Entity
engineer I-Entity
exchanged I-Entity
the I-Entity
project I-Entity
files I-Entity
. O

Besides O
this O
, O
it B-Entity
also O
spread B-Action
through B-Modifier
network B-Entity
shares I-Entity
, O
a B-Entity
printer I-Entity
spooler I-Entity
vulnerability I-Entity
, O
an B-Entity
old I-Entity
Windows I-Entity
RPC I-Entity
( I-Entity
remote I-Entity
procedure I-Entity
calls I-Entity
) I-Entity
vulnerability I-Entity
and O
a B-Entity
known I-Entity
password I-Entity
in I-Entity
the I-Entity
WinCC I-Entity
database I-Entity
. O

In O
the O
end O
, O
Stuxnet O
propagated O
further O
than O
its O
authors O
probably O
intended O
. O

We O
have O
monitored O
more O
than O
40,000 O
infected O
IP O
addresses O
in O
155 O
countries O
. O

Many O
of O
those O
systems O
are O
most O
likely O
just O
collateral O
damage O
and O
were O
not O
intended O
to O
be O
infected O
by O
the O
attackers O
. O

For O
example O
multiple O
computers O
at O
Chevron O
were O
infected O
by O
Stuxnet O
, O
without O
any O
damage O
being O
done O
. O

Part B-Entity
of I-Entity
the I-Entity
malware I-Entity
code I-Entity
was I-Entity
signed I-Entity
with I-Entity
stolen I-Entity
digital I-Entity
certificates I-Entity
making B-Action
it B-Entity
harder B-Entity
to I-Entity
detect I-Entity
by I-Entity
security I-Entity
tools I-Entity
. O

To B-Modifier
hide B-Entity
its I-Entity
activity I-Entity
even I-Entity
further I-Entity
, O
Stuxnet B-Entity
executed B-Action
slightly B-Entity
different I-Entity
infection I-Entity
routines I-Entity
depending I-Entity
on I-Entity
the I-Entity
security I-Entity
software I-Entity
installed I-Entity
on I-Entity
the I-Entity
target I-Entity
. O

On O
the O
USB O
drive O
itself O
, O
the B-Entity
malware I-Entity
would O
hide B-Action
its B-Entity
own I-Entity
files I-Entity
and O
even O
delete B-Action
itself B-Entity
from B-Modifier
it B-Entity
after B-Modifier
three B-Entity
successful I-Entity
propagations I-Entity
. O

Tricks B-Entity
like I-Entity
these I-Entity
, O
to O
make B-Action
the B-Entity
detection I-Entity
of I-Entity
the I-Entity
malware I-Entity
more B-Entity
difficult I-Entity
, O
are O
now O
frequently O
used O
in O
modern O
targeted O
attacks O
. O

Stuxnet O
's O
payload O
focused O
on O
PLCs O
, O
which O
are O
used O
to O
control O
different O
industrial O
components O
. O

The O
target O
of O
the O
Stuxnet O
operation O
is O
believed O
to O
be O
a O
uranium O
enrichment O
facility O
in O
Iran O
. O

The B-Entity
sabotage I-Entity
payload I-Entity
disrupted B-Action
and I-Action
partially I-Action
destroyed I-Action
the B-Entity
cascaded I-Entity
high I-Entity
frequency I-Entity
gas I-Entity
centrifuges I-Entity
. O

The B-Entity
early I-Entity
version I-Entity
of I-Entity
Stuxnet I-Entity
targeted B-Action
the B-Entity
S7- I-Entity
417 I-Entity
PLCs I-Entity
and O
modified B-Action
its B-Entity
valve I-Entity
settings I-Entity
. O

Closing O
the O
valves O
at O
certain O
points O
in O
time O
would O
lead O
to O
an O
increase O
of O
pressure O
that O
could O
damage O
the O
equipment O
. O

The B-Entity
later I-Entity
version I-Entity
of I-Entity
the I-Entity
threat I-Entity
focused B-Action
on B-Modifier
the B-Entity
S7-315 I-Entity
PLCs I-Entity
, O
manipulating B-Action
the B-Entity
spinning I-Entity
frequency I-Entity
of I-Entity
the I-Entity
rotating I-Entity
motors I-Entity
. O

By O
speeding O
the O
centrifuges O
up O
and O
slowing O
them O
down O
repeatedly O
, O
the O
output O
quality O
could O
be O
spoiled O
and O
the O
centrifuges O
themselves O
could O
be O
damaged O
. O

The B-Entity
payload I-Entity
would O
only O
become B-Action
active B-Entity
if B-Modifier
the B-Entity
fingerprint I-Entity
in I-Entity
the I-Entity
found I-Entity
PLC I-Entity
setup I-Entity
matched I-Entity
a I-Entity
given I-Entity
configuration I-Entity
setup I-Entity
. O

This O
minimized O
the O
collateral O
damage O
at O
other O
facilities O
and O
showed O
that O
the O
attackers O
had O
in-depth O
knowledge O
of O
the O
targeted O
uranium O
enrichment O
facilities O
. O

To B-Modifier
avoid B-Entity
detection I-Entity
by I-Entity
personnel I-Entity
monitoring I-Entity
the I-Entity
human I-Entity
machine I-Entity
interface I-Entity
( I-Entity
HMI I-Entity
) I-Entity
of I-Entity
the I-Entity
plant I-Entity
, O
the B-Entity
threat I-Entity
recorded B-Action
measurement B-Entity
readings I-Entity
during I-Entity
normal I-Entity
operation I-Entity
and O
played B-Action
those B-Entity
back I-Entity
in I-Entity
a I-Entity
loop I-Entity
. O

Operation O
Night O
Dragon O
, O
which O
was O
uncovered O
in O
2010 O
, O
is O
a O
typical O
example O
of O
global O
oil O
companies O
being O
targeted O
, O
but O
this O
time O
not O
with O
the O
aim O
of O
disruption O
in O
mind O
. O

The B-Entity
attacks I-Entity
started O
in O
late O
2009 O
and O
were O
directed O
at O
finding B-Action
project B-Entity
details I-Entity
and I-Entity
financial I-Entity
information I-Entity
about I-Entity
oil I-Entity
and I-Entity
gas I-Entity
field I-Entity
exploration I-Entity
and I-Entity
bids I-Entity
. O

The B-Entity
attackers I-Entity
started O
by O
compromising B-Action
public B-Entity
facing I-Entity
Web I-Entity
servers I-Entity
through B-Modifier
SQL B-Entity
injection I-Entity
and I-Entity
installing I-Entity
Web I-Entity
shells I-Entity
on I-Entity
them I-Entity
. O

Once O
they O
had O
control O
over O
the O
server O
they B-Entity
used O
common O
hacking O
tools O
to O
harvest B-Action
local B-Entity
passwords I-Entity
, O
dump B-Action
password B-Entity
hashes I-Entity
, O
sniff B-Action
authentication B-Entity
messages I-Entity
and O
exploit O
internal O
active O
directory O
configuration O
. O

This O
allowed O
them B-Entity
to O
move B-Action
on B-Modifier
to I-Modifier
other B-Entity
internal I-Entity
computers I-Entity
using B-Modifier
the B-Entity
gathered I-Entity
passwords I-Entity
. O

In O
addition O
, O
spear B-Entity
phishing I-Entity
messages I-Entity
were B-Action
used I-Action
to B-Modifier
compromise B-Entity
additional I-Entity
computers I-Entity
. O

The O
attackers O
did O
not O
use O
any O
zero-day O
vulnerabilities O
during O
their O
attacks O
. O

Rather O
they O
used O
publicly O
available O
tools O
for O
each O
individual O
job O
. O

On B-Modifier
compromised B-Entity
computers I-Entity
a B-Entity
common I-Entity
Backdoor.Trojan I-Entity
was B-Action
installed I-Action
that O
communicated B-Action
back B-Modifier
to I-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
, O
allowing B-Action
remote B-Entity
access I-Entity
to I-Entity
the I-Entity
computer I-Entity
. O

This O
allowed O
the B-Entity
attacker I-Entity
to O
find B-Action
and O
extract B-Action
valuable B-Entity
information I-Entity
. O

In O
August O
2012 O
an O
extremely O
destructive O
cyberattack O
hit O
an O
estimated O
30,000 O
computers O
at O
one O
of O
the O
largest O
oil O
producers O
of O
the O
world O
in O
Saudi O
Arabia O
. O

The O
W32.Disttrack O
malware O
used O
in O
this O
attack O
, O
also O
known O
as O
Shamoon O
, O
consists O
of O
three O
components O
: O
a O
dropper O
, O
a O
wiper O
and O
a O
reporter O
module O
. O

The B-Entity
dropper I-Entity
component I-Entity
is O
responsible O
for O
creating B-Action
all B-Entity
the I-Entity
required I-Entity
files I-Entity
on I-Entity
the I-Entity
system I-Entity
, O
registering B-Action
a B-Entity
service I-Entity
called I-Entity
'' I-Entity
TrkSvr I-Entity
'' I-Entity
in O
order O
to O
start B-Action
itself B-Entity
with B-Modifier
Windows B-Entity
. O

It B-Entity
also O
attempts O
to O
copy B-Action
itself B-Entity
to B-Modifier
accessible B-Entity
network I-Entity
shares I-Entity
and O
execute B-Action
itself B-Entity
remotely B-Entity
if B-Modifier
successfully B-Entity
copied I-Entity
. O

The O
wiper O
component O
is O
only O
activated O
when O
a O
hardcoded O
configuration O
date O
has O
been O
passed O
. O

This O
enables O
a O
coordinated O
, O
'' O
time O
bomb O
'' O
scenario O
. O

The B-Entity
module I-Entity
then O
drops B-Action
a B-Entity
legitimate I-Entity
and I-Entity
digitally I-Entity
signed I-Entity
device I-Entity
driver I-Entity
that I-Entity
provides I-Entity
low I-Entity
level I-Entity
disk I-Entity
access I-Entity
from I-Entity
user I-Entity
space I-Entity
. O

The B-Entity
malware I-Entity
collects B-Action
file B-Entity
names I-Entity
and O
starts O
overwriting B-Action
them B-Entity
with B-Modifier
a B-Entity
JPEG I-Entity
image I-Entity
or I-Entity
192KB I-Entity
blocks I-Entity
of I-Entity
random I-Entity
data I-Entity
. O

At O
the O
end O
Disttrack B-Entity
finishes O
the O
computer O
off O
by O
wiping B-Action
the B-Entity
master I-Entity
boot I-Entity
record I-Entity
with B-Modifier
the B-Entity
same I-Entity
data I-Entity
. O

The B-Entity
reporter I-Entity
component I-Entity
is O
responsible O
for O
sending B-Action
back B-Modifier
a B-Entity
HTTP I-Entity
GET I-Entity
request I-Entity
to B-Modifier
the B-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
. O

It B-Entity
reports B-Action
the B-Entity
domain I-Entity
name I-Entity
, I-Entity
IP I-Entity
address I-Entity
and I-Entity
number I-Entity
of I-Entity
files I-Entity
overwritten I-Entity
. O

By O
acquiring B-Action
user B-Entity
credentials I-Entity
and O
gaining O
access O
to O
the O
domain O
controller O
the B-Entity
attackers I-Entity
were O
able O
to O
push B-Action
the B-Entity
malware I-Entity
on B-Modifier
to I-Modifier
many B-Entity
systems I-Entity
before B-Modifier
they B-Entity
triggered I-Entity
the I-Entity
destructive I-Entity
payload I-Entity
. O

Disttrack B-Entity
's O
secondary O
goal O
may O
have O
been O
to O
steal B-Action
valuable B-Entity
information I-Entity
from B-Modifier
infected B-Entity
computers I-Entity
, O
but O
the O
main O
intent O
was O
to O
render B-Action
the B-Entity
computers I-Entity
unusable I-Entity
by O
wiping B-Action
the B-Entity
operating I-Entity
system I-Entity
and I-Entity
master I-Entity
boot I-Entity
record I-Entity
, O
causing O
disruption O
and O
downtime O
at O
the O
targeted O
company O
. O

Although O
wiping B-Entity
is O
also O
frequently O
used O
to O
destroy B-Action
evidence B-Entity
of I-Entity
the I-Entity
attack I-Entity
and O
make B-Action
forensics B-Entity
more B-Entity
difficult I-Entity
. O

The O
malware O
does O
not O
contain O
any O
payload O
against O
ICS O
, O
like O
Stuxnet O
does O
for O
PLCs O
, O
and O
is O
not O
as O
sophisticated O
. O

According O
to O
the O
company O
, O
no O
computer O
related O
with O
the O
production O
or O
distribution O
of O
oil O
was O
affected O
, O
since O
the O
operational O
network O
is O
separated O
and O
specially O
protected O
. O

One O
group O
that O
claimed O
responsibility O
for O
the O
attack O
posted O
on O
Pastebin O
that O
it O
was O
an O
anti-oppression O
hacker O
group O
. O

The O
attack O
was O
prompted O
by O
disappointment O
with O
some O
of O
the O
regimes O
in O
the O
Middle O
East O
, O
the O
group O
said O
. O

True O
or O
not O
, O
this O
shows O
that O
it O
is O
not O
necessarily O
only O
state-sponsored O
attackers O
who O
are O
carrying O
out O
disruptive O
attacks O
. O

Sabotage O
attacks O
usually O
fall O
into O
the O
orbit O
of O
hacktivists O
, O
who O
seek O
attention O
rather O
than O
profit O
. O

Some O
sources O
reported O
that O
the O
attackers O
had O
help O
from O
insiders O
, O
which O
would O
explain O
the O
so O
far O
unclear O
infection O
vector O
. O

Soon O
after O
this O
attack O
became O
known O
, O
a O
Qatari O
gas O
company O
was O
attacked O
in O
a O
similar O
way O
. O

Spear B-Entity
phishing I-Entity
is O
, O
along O
with O
watering O
hole O
attacks O
, O
one O
of O
the O
most O
common O
attack O
vectors O
used B-Action
to B-Modifier
attack B-Entity
companies I-Entity
. O

The O
attacks O
are O
simple O
to O
carry O
out O
. O

They O
often O
follow O
the O
same O
pattern O
, O
starting O
with O
a O
reconnaissance O
phase O
to O
gather O
all O
publicly O
available O
information O
. O

This O
is O
followed O
by O
the O
incursion O
phase O
of O
breaking B-Action
in I-Action
and I-Action
compromising I-Action
computers B-Entity
. O

After O
that O
comes O
the O
discovery O
phase O
, O
where O
the B-Entity
attacker I-Entity
gathers B-Action
passwords B-Entity
and O
maps B-Action
the B-Entity
internal I-Entity
network I-Entity
. O

The O
final O
stage O
is O
capture O
and O
exfiltration O
, O
where O
the B-Entity
valuable I-Entity
information I-Entity
is B-Action
copied I-Action
and O
sent B-Action
back I-Action
to B-Modifier
the B-Entity
attacker I-Entity
. O

The O
last O
phase O
may O
also O
involve O
a O
disruption O
attack O
if O
the O
goal O
is O
sabotage O
. O

For O
a O
more O
detailed O
analysis O
of O
the O
attack O
phases O
, O
see O
Appendix O
C. O
A O
spear O
phishing O
attack O
consists O
of O
an O
email O
with O
either O
a O
malicious O
attachment O
or O
a O
link O
to O
a O
malicious O
website O
. O

Such O
emails O
are O
sent O
in O
bulk O
to O
a O
handful O
of O
key O
users O
. O

These O
waves O
are O
often O
repeated O
till O
enough O
people O
fall O
for O
the O
bait O
and O
compromise O
their O
computers O
. O

For O
analysis O
on O
the O
social O
engineering O
themes O
used O
, O
attack O
details O
and O
attachment O
types O
used O
, O
see O
Appendix O
A O
. O

Some O
of O
the O
spear O
phishing O
campaigns O
are O
smaller O
in O
scale O
and O
are O
focused O
on O
specific O
targets O
. O

For O
example O
, O
on O
January O
1 O
, O
2013 O
a O
global O
energy O
research O
company O
was O
targeted O
. O

A B-Entity
wave I-Entity
of I-Entity
spear I-Entity
phishing I-Entity
emails I-Entity
were B-Action
sent I-Action
from B-Modifier
two B-Entity
Freemailer I-Entity
accounts I-Entity
to B-Modifier
291 B-Entity
individuals I-Entity
at I-Entity
the I-Entity
targeted I-Entity
company I-Entity
. O

All O
receiving O
email O
addresses O
started O
with O
a O
letter O
between O
G O
and O
R O
, O
covering O
half O
of O
the O
alphabet O
. O

Whether O
there O
was O
a O
second O
wave O
of O
emails O
using O
the O
other O
half O
of O
the O
alphabet O
or O
whether O
the O
attackers O
only O
got O
their O
hands O
on O
part O
of O
the O
address O
book O
remains O
unknown O
. O

All O
emails O
had O
either O
the O
subject O
line O
'' O
2013 O
, O
Obama O
QE4 O
! O
Merry O
Christmas O
! O
'' O
or O
'' O
2013 O
, O
Obama O
QE4 O
! O
'' O
. O

It O
is O
common O
to O
see O
spear O
phishing O
attacks O
take O
place O
around O
holidays O
, O
as O
people O
are O
receiving O
more O
emails O
during O
these O
times O
and O
are O
less O
likely O
to O
perform O
due O
diligence O
while O
opening O
them O
. O

All B-Entity
of I-Entity
the I-Entity
emails I-Entity
contained B-Action
the B-Entity
same I-Entity
Trojan.Dropper I-Entity
disguised B-Action
as B-Modifier
an B-Entity
attachment I-Entity
with I-Entity
the I-Entity
filename I-Entity
AVP.dll I-Entity
. O

The B-Entity
malware I-Entity
itself I-Entity
drops B-Action
a B-Entity
malicious I-Entity
Downloader I-Entity
'' I-Entity
clbcatq.dll I-Entity
'' I-Entity
into B-Modifier
a B-Entity
newly I-Entity
created I-Entity
'' I-Entity
wuauclt I-Entity
'' I-Entity
directory I-Entity
, O
posing B-Action
as B-Modifier
Windows B-Entity
update I-Entity
and O
taking O
advantage O
of O
the O
DLL O
search O
order O
hijack O
weakness O
in O
order O
to O
load B-Action
the B-Entity
malicious I-Entity
code I-Entity
in B-Modifier
Windows B-Entity
. O

The O
same O
family O
of O
dropper O
has O
been O
used O
in O
previous O
targeted O
attacks O
against O
other O
sectors O
, O
indicating O
that O
a O
group O
with O
multiple O
interests O
is O
behind O
the O
attacks O
. O

The B-Entity
back I-Entity
door I-Entity
provided B-Action
full B-Entity
access I-Entity
to I-Entity
the I-Entity
compromised I-Entity
computers I-Entity
. O

A O
week O
later O
, O
on O
January O
7 O
, O
2013 O
, O
the O
group O
attacked O
the O
same O
company O
again O
. O

Seventy O
emails O
were O
sent O
to O
58 O
individuals O
using O
either O
'' O
2012-13 O
NFL O
Playoffs O
Schedule O
'' O
or O
'' O
Re O
: O
2012-13 O
NFL O
Playoffs O
Schedule O
'' O
as O
a O
subject O
line O
. O

In O
this O
wave O
, O
the O
attackers O
used O
a O
similar O
AVP.dll O
to O
the O
one O
used O
before O
. O

In O
some O
of O
the O
emails O
, O
an O
additional O
CHM O
file O
with O
an O
old O
exploit O
was O
used O
in O
an O
effort O
to O
maximize O
the O
chances O
of O
a O
successful O
infection O
. O

After O
this O
second O
wave O
, O
the O
attack O
ceased O
. O

It O
is O
unknown O
if O
the O
attackers O
successfully O
retrieved O
the O
information O
they O
were O
seeking O
, O
if O
they B-Entity
installed B-Action
other B-Entity
back I-Entity
door I-Entity
Trojans I-Entity
or O
gained O
passwords O
that O
allowed O
them O
to O
directly O
access O
the O
computers O
, O
or O
if O
they O
have O
given O
up O
on O
the O
target O
. O

A O
global O
oil O
company O
, O
with O
offices O
around O
the O
world O
, O
had O
been O
under O
continuous O
attack O
for O
some O
time O
, O
but O
in O
September O
2012 O
we O
noticed O
an O
upsurge O
in O
activity O
, O
with O
34 O
times O
more O
suspicious O
emails O
than O
on O
average O
. O

This O
provided O
a O
clear O
indication O
that O
something O
suspicious O
was O
going O
on O
. O

At O
the O
end O
of O
this O
wave O
of O
emails O
, O
a O
hotel O
chain O
, O
a O
rental O
car O
company O
and O
two O
financial O
institutions O
were O
also O
targeted O
by O
the O
same O
attacker O
. O

This O
may O
have O
been O
an O
attempt O
to O
find O
further O
information O
that O
could O
be O
used O
in O
a O
future O
social O
engineering O
attack O
against O
the O
oil O
company O
. O

In O
total O
, O
136 O
email O
accounts O
at O
the O
oil O
company O
were O
targeted O
. O

A O
regional O
sales O
manager O
in O
Greece O
received O
412 O
emails O
over O
the O
12 O
month O
period O
, O
with O
155 O
different O
attachments O
. O

A O
HR O
person O
in O
the O
same O
country O
received O
the O
second O
largest O
amount O
of O
emails O
with O
90 O
in O
total O
. O

Seventeen O
other O
people O
were O
targeted O
between O
70 O
and O
90 O
times O
, O
many O
in O
the O
same O
region O
. O

The O
rest O
of O
the O
targeted O
people O
received O
less O
than O
five O
emails O
each O
, O
in O
what O
seems O
to O
have O
been O
an O
undirected O
spraying O
in O
the O
hope O
that O
at O
least O
some O
would O
fall O
for O
the O
bait O
. O

Clearly O
the O
one O
person O
that O
received O
the O
highest O
volume O
of O
emails O
was O
deemed O
to O
be O
of O
high O
value O
to O
the O
attackers O
. O

Possible O
explanations O
for O
the O
attack O
could O
be O
that O
a O
competitor O
wanted O
to O
know O
more O
about O
some O
upcoming O
deal O
or O
details O
on O
the O
oil O
field O
exploration O
, O
but O
this O
would O
be O
highly O
speculative O
. O

The B-Entity
spear I-Entity
phishing I-Entity
emails I-Entity
came B-Action
from B-Modifier
234 B-Entity
spoofed I-Entity
addresses I-Entity
. O

They B-Entity
were B-Action
made I-Action
to B-Modifier
appear B-Entity
to I-Entity
be I-Entity
linked I-Entity
to I-Entity
the I-Entity
company I-Entity
in I-Entity
relation I-Entity
to I-Entity
the I-Entity
subject I-Entity
and I-Entity
attachment I-Entity
chosen I-Entity
. O

Many O
of O
the O
emails O
came O
from O
the O
same O
country O
as O
the O
main O
targeted O
sales O
manager O
. O

The B-Entity
emails I-Entity
all I-Entity
contained B-Action
malicious B-Entity
attachments I-Entity
. O

None O
of O
them O
linked O
to O
third O
party O
sites O
for O
drive-by O
downloads O
. O

Of O
the O
attachments O
, O
1,588 O
had O
a O
.exe O

extension O
. O

Of O
those O
, O
842 O
had O
a O
.pdf.exe O

extension O
. O

The B-Entity
malware I-Entity
chosen I-Entity
was B-Action
a B-Entity
variant I-Entity
of I-Entity
the I-Entity
Poison I-Entity
Ivy I-Entity
Trojan I-Entity
Backdoor.Darkmoon I-Entity
and O
, O
in O
some O
minor O
cases O
, O
Trojan B-Entity
droppers I-Entity
that O
would O
download B-Action
additional B-Entity
malware I-Entity
. O

The O
attackers O
did O
not O
use O
any O
zero-day O
exploits O
to O
drop O
a O
payload O
. O

The O
social O
engineering O
messages O
concentrated O
mainly O
around O
the O
following O
two O
themes O
: O
Once O
installed B-Action
, O
the B-Entity
back I-Entity
door I-Entity
would O
create B-Action
a B-Entity
registry I-Entity
run I-Entity
key I-Entity
in O
order O
to O
restart B-Action
with B-Modifier
Windows B-Entity
and O
connect B-Action
to B-Modifier
one B-Entity
of I-Entity
three I-Entity
C I-Entity
& I-Entity
C I-Entity
servers I-Entity
located I-Entity
in I-Entity
Greece I-Entity
. O

The B-Entity
last I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
has O
been B-Action
used I-Action
since B-Modifier
2010 B-Entity
in B-Modifier
similar B-Entity
attacks I-Entity
against I-Entity
other I-Entity
companies I-Entity
. O

Other O
sub-domains O
at O
the O
same O
free O
host O
and O
DNS O
service O
have O
been O
used O
by O
other O
groups O
to O
spread O
malware O
in O
the O
past O
. O

The B-Entity
chosen I-Entity
names I-Entity
of I-Entity
the I-Entity
C I-Entity
& I-Entity
C I-Entity
server I-Entity
domains I-Entity
imitates B-Action
legitimate B-Entity
services I-Entity
in B-Modifier
a I-Modifier
bid I-Modifier
to I-Modifier
be B-Entity
overlooked I-Entity
by I-Entity
the I-Entity
system I-Entity
administrators I-Entity
when I-Entity
checking I-Entity
their I-Entity
logs I-Entity
. O

The B-Entity
back I-Entity
door I-Entity
provides B-Action
full B-Entity
remote I-Entity
access I-Entity
to B-Modifier
the B-Entity
compromised I-Entity
computers I-Entity
, O
allowing B-Action
for B-Modifier
extraction B-Entity
of I-Entity
any I-Entity
data I-Entity
. O

It O
is O
unknown O
if O
the O
attackers O
succeeded O
in O
their O
goal O
and O
if O
valuable O
information O
has O
been O
extracted O
. O

The O
attacks O
did O
not O
completely O
disappear O
, O
but O
the O
email O
volume O
decreased O
significantly O
to O
only O
a O
few O
emails O
per O
week O
afterwards O
. O

As O
with O
all O
targeted O
attacks O
, O
there O
are O
many O
different O
groups O
of O
attackers O
operating O
in O
this O
field O
. O

These O
attacks O
can O
not O
be O
attributed O
to O
only O
one O
group O
or O
geographical O
region O
. O

We O
have O
seen O
individuals O
, O
competitors O
, O
hacktivist O
groups O
and O
possible O
state O
sponsored O
agents O
carrying O
out O
attacks O
against O
energy O
companies O
. O

Some O
of O
the O
attacks O
have O
been O
purely O
opportunistic O
, O
seeking O
any O
valuable O
information O
available O
. O

Other O
campaigns O
look O
like O
they O
were O
planned O
over O
a O
lengthy O
period O
and O
carried O
out O
methodically O
with O
a O
clear O
goal O
in O
mind O
. O

The O
attackers O
tend O
to O
go O
after O
valuable O
information O
, O
including O
maps O
of O
new O
gas O
fields O
or O
research O
on O
efficient O
photovoltaic O
generators O
. O

This O
information O
can O
be O
of O
great O
value O
to O
competitors O
or O
nations O
that O
want O
to O
make O
progress O
in O
the O
same O
field O
. O

Another O
motivation O
for O
attackers O
is O
to O
profit O
from O
the O
information O
stolen O
by O
blackmailing O
the O
company O
. O

The O
same O
information O
can O
be O
used O
to O
carry O
out O
sabotage O
attacks O
designed O
to O
disrupt O
ICSs O
, O
as O
the O
energy O
sector O
is O
also O
a O
primary O
target O
for O
sabotage O
attacks O
which O
will O
not O
generate O
direct O
profit O
for O
the O
attacker O
. O

A O
competitor O
might O
be O
interested O
in O
generating O
bad O
press O
and O
bad O
customer O
experience O
for O
a O
rival O
company O
, O
in O
order O
to O
win O
some O
new O
clients O
. O

For O
example O
, O
in O
January O
2013 O
a O
group O
claiming O
to O
be O
related O
to O
Anonymous O
posted O
access O
details O
for O
what O
they O
said O
were O
Israeli O
SCADA O
systems O
for O
power O
plants O
and O
other O
systems O
. O

Meanwhile O
, O
'' O
Operation O
Save O
the O
Arctic O
'' O
targeted O
multiple O
oil O
companies O
around O
the O
globe O
in O
protest O
against O
drilling O
plans O
in O
the O
Arctic O
. O

Disgruntled O
employees O
are O
also O
a O
source O
of O
attacks O
that O
should O
not O
be O
underestimated O
. O

With O
their O
knowhow O
about O
internal O
critical O
processes O
and O
systems O
they O
often O
know O
how O
to O
inflict O
serious O
damage O
. O

They O
may O
be O
able O
to O
perform O
system O
modifications O
that O
could O
go O
unnoticed O
for O
a O
long O
periods O
. O

For O
all O
regular O
client O
computers O
, O
the O
well-established O
best O
practice O
guidelines O
apply O
. O

These O
computers O
are O
often O
the O
first O
ones O
to O
be O
attacked O
. O

Once O
compromised O
, O
the O
attacker O
will O
use O
these O
computers O
and O
try O
to O
explore O
deeper O
into O
internal O
networks O
. O

Securing O
and O
hardening O
of O
deployed O
operating O
systems O
with O
a O
working O
strategy O
for O
patch O
deployment O
is O
important O
. O

Reoccurring O
security O
awareness O
training O
can O
help O
users O
to O
identify O
social O
engineering O
attempts O
and O
prevent O
them O
from O
falling O
victim O
to O
them O
in O
the O
first O
place O
. O

The O
company O
can O
perform O
penetration O
testing O
on O
Web O
and O
network O
applications O
but O
also O
on O
ICSs O
to O
identify O
and O
remedy O
any O
vulnerability O
. O

For O
examples O
Web O
applications O
should O
be O
tested O
against O
SQL O
injection O
attacks O
. O

This O
can O
also O
help O
confirm O
if O
applied O
polices O
are O
followed O
through O
, O
if O
the O
patch O
level O
is O
correct O
on O
all O
computers O
and O
if O
systems O
are O
compliant O
. O

Companies O
can O
monitor O
the O
Internet O
for O
information O
about O
attacks O
in O
the O
same O
vertical O
and O
apply O
lessons O
learned O
where O
possible O
. O

In O
addition O
, O
different O
layers O
of O
security O
products O
can O
help O
achieve O
better O
overall O
protection O
. O

• O
Security O
Information O
and O
Event O
Manager O
system O
( O
SIEM O
) O
: O
Using O
a O
SIEM O
can O
help O
correlate O
all O
related O
alerts O
in O
one O
place O
. O

This O
centralized O
view O
can O
be O
cross O
referenced O
with O
threat O
intelligence O
data O
to O
generate O
prioritization O
and O
an O
action O
plan O
. O

Painting O
the O
bigger O
picture O
of O
the O
overall O
security O
state O
can O
reveal O
previously O
unnoticed O
attacks O
. O

For O
example O
failed O
login O
attempts O
on O
internal O
servers O
could O
indicate O
a O
password O
breach O
. O

This O
includes O
logging O
of O
critical O
systems O
and O
synchronization O
of O
time O
among O
multiple O
systems O
. O

• O
Ingress O
and O
egress O
filtering O
: O
Filtering O
the O
network O
traffic O
with O
firewalls O
, O
content O
filters O
and O
IPS O
allows O
the O
control O
of O
data O
flows O
. O

This O
can O
prevent O
attackers O
from O
reaching O
internal O
systems O
. O

It O
is O
important O
to O
also O
monitor O
outbound O
traffic O
, O
as O
data O
exfiltration O
is O
a O
key O
point O
for O
cyberespionage O
. O

It O
should O
be O
noted O
that O
with O
the O
increased O
use O
of O
cloud O
services O
and O
mobile O
devices O
, O
some O
traffic O
might O
never O
pass O
through O
the O
company O
's O
gateways O
. O

Where O
traffic O
blocking O
is O
too O
disruptive O
at O
least O
monitoring O
should O
be O
implemented O
. O

• O
Data O
loss O
prevention O
( O
DLP O
) O
: O
DLP O
solutions O
can O
track O
the O
access O
and O
flow O
of O
critical O
information O
and O
prevent O
it O
from O
leaving O
the O
company O
or O
encrypt O
it O
automatically O
. O

• O
Endpoint O
protection O
: O
Depending O
on O
the O
usage O
pattern O
of O
the O
computer O
, O
different O
solutions O
are O
available O
to O
protect O
the O
endpoint O
. O

Antivirus O
solution O
with O
proactive O
detection O
methods O
like O
behavioral O
analysis O
and O
reputation O
scanning O
can O
prevent O
unknown O
malware O
from O
installing O
itself O
. O

HIPS O
( O
host O
based O
intrusion O
prevention O
systems O
) O
, O
behavioral O
lockdown O
or O
whitelisting O
can O
protect O
computers O
from O
any O
kind O
of O
unwanted O
tampering O
without O
the O
need O
of O
constant O
updates O
. O

• O
System O
protection O
: O
For O
non-standard O
IT O
systems O
, O
hardening O
can O
increase O
the O
security O
. O

On O
industrial O
systems O
which O
are O
not O
often O
updated O
or O
that O
can O
not O
be O
updated O
, O
exploitation O
can O
be O
prevented O
with O
the O
help O
of O
lockdown O
solutions O
like O
Symantec O
Critical O
System O
Protection O
( O
CSP O
) O
. O

Through O
policies O
, O
only O
trusted O
system O
applications O
are O
allowed O
to O
run O
. O

ICS O
should O
be O
regularly O
checked O
and O
upgraded O
if O
new O
firmware O
exists O
. O

Where O
this O
is O
not O
possible O
HIPS O
and O
behavioral O
lockdown O
tools O
can O
be O
used O
to O
secure O
computers O
. O

• O
Email O
filtering O
: O
Proper O
email O
filtering O
can O
prevent O
many O
spear O
phishing O
attempts O
from O
reaching O
users O
. O

They O
can O
help O
minimize O
the O
risk O
of O
an O
untrained O
user O
falling O
for O
social O
engineering O
tricks O
. O

• O
Authentication O
: O
Some O
of O
the O
ICS O
contain O
hardcoded O
passwords O
and O
, O
wherever O
possible O
, O
these O
should O
be O
changed O
. O

ICS O
frequently O
use O
weakly O
authenticated O
protocols O
that O
allow O
for O
impersonation O
attacks O
. O

Where O
possible O
those O
authentication O
methods O
should O
be O
upgraded O
or O
at O
least O
closely O
monitored O
. O

Strong O
authentication O
or O
PKI O
should O
be O
used O
where O
applicable O
. O

Industrial O
control O
systems O
( O
ICS O
) O
should O
be O
specially O
protected O
and O
monitored O
. O

The O
control O
system O
and O
control O
network O
should O
be O
secured O
. O

Where O
possible O
, O
ICS O
should O
be O
separate O
from O
the O
Intranet O
. O

Isolating O
these O
networks O
alone O
is O
often O
not O
enough O
to O
protect O
the O
control O
network O
, O
but O
it O
can O
make O
it O
more O
difficult O
for O
attackers O
to O
succeed O
. O

For O
some O
systems O
it O
can O
make O
sense O
to O
have O
a O
plan O
to O
quickly O
disconnect O
or O
separate O
critical O
machines O
in O
the O
event O
of O
a O
detected O
cyberattack O
. O

Cyberespionage O
campaigns O
and O
sabotage O
attacks O
are O
becoming O
increasingly O
common O
, O
with O
countless O
threat O
actors O
attempting O
to O
gain O
a O
foothold O
in O
some O
of O
the O
best O
protected O
organizations O
. O

At O
this O
stage O
, O
roughly O
five O
targeted O
attacks O
per O
day O
are O
being O
mounted O
on O
firms O
in O
the O
energy O
sector O
. O

These O
attacks O
have O
become O
increasingly O
sophisticated O
, O
although O
the O
capabilities O
and O
tactics O
used O
by O
these O
threat O
actors O
vary O
considerably O
. O

In O
the O
second O
half O
of O
2012 O
, O
the O
energy O
sector O
was O
the O
second O
most O
targeted O
with O
16 O
percent O
of O
all O
the O
targeted O
attacks O
. O

This O
strong O
increase O
was O
mainly O
due O
to O
a O
large O
scale O
attack O
against O
one O
global O
oil O
company O
. O

In O
the O
first O
half O
of O
2013 O
, O
the O
energy O
sector O
was O
ranked O
fifth O
with O
7.6 O
percent O
of O
all O
attacks O
focused O
on O
this O
sector O
. O

In O
general O
we O
have O
observed O
that O
attackers O
are O
becoming O
more O
efficient O
and O
focusing O
on O
smaller O
operations O
that O
attract O
less O
attention O
. O

The O
attackers O
tend O
to O
go O
after O
valuable O
information O
– O
such O
as O
maps O
of O
a O
new O
gas O
field O
– O
but O
the O
sector O
is O
also O
a O
major O
target O
for O
sabotage O
attacks O
, O
which O
will O
not O
generate O
direct O
profit O
for O
the O
attacker O
. O

Such O
disruptive O
attacks O
do O
already O
happen O
and O
may O
lead O
to O
large O
financial O
losses O
. O

State O
sponsored O
agents O
, O
competitors O
, O
internal O
attackers O
or O
hacktivists O
are O
the O
most O
likely O
authors O
of O
such O
sabotage O
attacks O
. O

Fortunately O
, O
there O
have O
not O
been O
many O
successful O
sabotage O
attacks O
against O
energy O
companies O
to O
date O
. O

However O
, O
the O
increasing O
number O
of O
connected O
systems O
and O
centralized O
control O
for O
ICS O
systems O
means O
that O
the O
risk O
of O
attacks O
in O
the O
future O
will O
increase O
. O

Energy O
and O
utility O
companies O
need O
to O
be O
aware O
of O
these O
risks O
and O
plan O
accordingly O
to O
protect O
their O
valuable O
information O
as O
well O
as O
their O
ICS O
or O
SCADA O
networks O
. O

Social O
engineering O
is O
an O
essential O
part O
of O
spear O
phishing O
campaigns O
. O

A O
cleverly O
chosen O
, O
enticing O
message O
may O
prompt O
the O
user O
into O
opening O
an O
attachment O
. O

It O
is O
evident O
that O
most O
attackers O
are O
carefully O
selecting O
the O
themes O
that O
they O
use O
for O
their O
attacks O
. O

Some O
groups O
use O
real O
news O
stories O
and O
copy O
the O
text O
directly O
from O
the O
newspaper O
websites O
. O

Others O
try O
to O
appeal O
to O
personal O
hobbies O
in O
order O
to O
get O
the O
user O
's O
attention O
. O

In O
the O
energy O
sector O
the O
most O
commonly O
used O
theme O
for O
spear O
phishing O
emails O
was O
money O
related O
( O
e.g O
. O

'' O
Wage O
Data O
2012 O
'' O
) O
followed O
by O
sports O
related O
themes O
( O
e.g O
. O

'' O
2012-13 O
NFL O
Playoffs O
Schedule O
'' O
) O
. O

As O
an O
example O
, O
the O
subject O
line O
'' B-Entity
Wage I-Entity
Data I-Entity
2012 I-Entity
'' I-Entity
was B-Action
used I-Action
in B-Modifier
944 B-Entity
emails I-Entity
, O
sent B-Action
from B-Modifier
26 B-Entity
different I-Entity
email I-Entity
addresses I-Entity
to B-Modifier
targets B-Entity
in I-Entity
nine I-Entity
different I-Entity
sectors I-Entity
. O

The B-Entity
attack I-Entity
was O
carried O
out O
over O
eight O
days O
and O
used B-Action
the B-Entity
same I-Entity
infected I-Entity
Microsoft I-Entity
Word I-Entity
document I-Entity
in B-Modifier
every B-Entity
instance I-Entity
. O

In O
general O
any O
topic O
can O
be O
used O
in O
a O
social O
engineering O
attempt O
, O
which O
makes O
it O
even O
harder O
for O
regular O
users O
to O
spot O
the O
attacks O
. O

Here O
are O
a O
few O
examples O
of O
subject O
lines O
used O
, O
listed O
by O
category O
: O
In O
the O
last O
six O
month O
of O
2012 O
the O
average O
number O
of O
targeted O
attacks O
observed O
per O
day O
was O
87 O
( O
with O
14 O
in O
the O
energy O
sector O
) O
. O

In O
the O
first O
six O
month O
of O
2013 O
the O
average O
number O
decreased O
to O
60 O
targeted O
attacks O
per O
day O
( O
five O
in O
the O
energy O
sector O
) O
. O

The O
spike O
in O
August O
and O
September O
2012 O
is O
mostly O
related O
to O
a O
large O
scale O
attack O
against O
a O
global O
oil O
company O
. O

The O
increase O
in O
May O
2013 O
was O
due O
to O
multiple O
attacks O
against O
financial O
services O
, O
public O
sector O
and O
IT O
service O
organizations O
. O

The O
government O
and O
public O
sector O
was O
quantitatively O
the O
most O
attacked O
sector O
, O
with O
25.4 O
percent O
of O
all O
targeted O
attacks O
falling O
in O
this O
sector O
for O
the O
last O
half O
of O
2012 O
and O
24 O
percent O
for O
the O
first O
half O
of O
2013 O
. O

The O
energy O
sector O
accounted O
for O
7.6 O
percent O
of O
all O
targeted O
attacks O
, O
making O
it O
the O
fifth O
most O
targeted O
sector O
in O
the O
first O
six O
month O
of O
2013 O
. O

This O
was O
a O
big O
decrease O
from O
16.3 O
percent O
of O
all O
attacks O
in O
the O
last O
half O
of O
2012 O
, O
when O
it O
was O
the O
second O
most O
attacked O
sector O
. O

This O
spike O
in O
2012 O
is O
mainly O
due O
to O
a O
large O
attack O
campaign O
against O
a O
global O
oil O
company O
which O
took O
place O
in O
September O
2012 O
. O

On O
average O
we O
saw O
18.6 O
mail O
accounts O
being O
attacked O
for O
any O
given O
target O
company O
in O
the O
last O
half O
of O
2012 O
( O
60.7 O
in O
the O
energy O
sector O
) O
and O
5.6 O
email O
accounts O
in O
the O
first O
half O
of O
2013 O
( O
10 O
in O
the O
energy O
sector O
) O
. O

Overall O
, O
we O
see O
a O
trend O
of O
the O
attacker O
conducting O
more O
focused O
attacks O
against O
fewer O
individuals O
. O

This O
generates O
less O
noise O
and O
the O
risk O
of O
getting O
noticed O
or O
discovered O
is O
smaller O
. O

These O
emails O
are O
sent O
in O
small O
bursts O
and O
then O
repeated O
against O
a O
changing O
target O
space O
till O
enough O
computers O
are O
compromised O
. O

Half O
of O
all O
the O
attachments O
analyzed O
used O
an O
extension O
that O
would O
run O
directly O
when O
double O
clicked O
. O

This O
old O
method O
is O
still O
the O
most O
common O
scheme O
used O
. O

Of O
all O
attachments O
analyzed O
, O
38 O
percent O
were O
.exe O

and O
12 O
percent O
were O
.src O

files O
. O

In O
total O
only O
6 O
percent O
used O
double O
extensions O
like O
.pdf.exe O

to O
fool O
the O
user O
. O

It O
should O
also O
be O
noted O
that O
23 O
percent O
were O
Microsoft O
Word O
documents O
using O
some O
exploit O
to O
execute O
custom O
code O
on O
the O
computer O
. O

There O
were O
also O
some O
more O
exotic O
extensions O
used O
like O
AutoIt O
scripts O
( O
.au3 O

) O
and O
ZX-Edit O
files O
( O
.zed O

) O
, O
but O
these O
are O
the O
exception O
rather O
than O
the O
rule O
. O

It O
might O
be O
that O
the O
attackers O
tried O
to O
bypass O
some O
email O
filtering O
software O
by O
experimenting O
with O
different O
attachment O
types O
. O

Sometimes O
even O
older O
exploits O
like O
the O
Microsoft O
DirectX O
DirectShow O
Length O
Record O
Remote O
Code O
Execution O
Vulnerability O
( O
CVE- O
2009-1539 O
) O
in O
.mp4 O

files O
are O
still O
occasionally O
used O
. O

This O
indicates O
that O
either O
not O
all O
attackers O
have O
the O
knowhow O
to O
use O
newer O
exploits O
that O
are O
publicly O
available O
or O
they O
speculate O
that O
the O
target O
has O
not O
patched O
all O
computers O
. O

Some O
of O
the O
attackers O
do O
not O
seem O
to O
be O
too O
sophisticated O
. O

For O
example O
they O
used O
'' O
www O
. O

[ O
COMPANY-NAME O
] O
.com.exe O

'' O
as O
an O
attachment O
name O
, O
clearly O
missing O
that O
the O
'' O
.com O

'' O
at O
the O
end O
would O
be O
sufficient O
to O
run O
it O
and O
the O
additional O
'' O
.exe O

'' O
was O
not O
needed O
. O

To O
identify O
a O
series O
of O
targeted O
attacks O
that O
are O
likely O
performed O
by O
the O
same O
individuals O
, O
we O
have O
used O
a O
novel O
attack O
attribution O
methodology O
named O
TRIAGE O
. O

Developed O
by O
Symantec O
Research O
Labs O
, O
TRIAGE O
is O
data O
mining O
software O
that O
relies O
on O
multi-criteria O
decision O
analysis O
and O
intelligent O
data O
fusion O
algorithms O
to O
reliably O
link O
different O
attacks O
to O
the O
same O
source O
. O

This O
framework O
has O
been O
developed O
in O
order O
to O
automate O
cyberintelligence O
tasks O
and O
reduce O
the O
time O
needed O
to O
get O
insights O
into O
organized O
cybercrime O
activities O
. O

By O
enabling O
rapid O
analysis O
of O
large O
security O
data O
sets O
, O
Symantec O
analysts O
can O
then O
quickly O
and O
more O
efficiently O
attribute O
various O
waves O
of O
cyberattacks O
to O
a O
specific O
attack O
campaign O
likely O
run O
by O
the O
same O
individuals O
. O

The O
TRIAGE O
framework O
was O
recently O
enhanced O
with O
novel O
visualizations O
thanks O
to O
VIS-SENSE O
, O
a O
European O
research O
project O
aiming O
at O
developing O
visual O
analytics O
technologies O
for O
network O
security O
applications O
. O

Since O
its O
original O
conception O
, O
TRIAGE O
has O
been O
successfully O
used O
to O
analyze O
the O
behavior O
of O
cybercriminals O
involved O
in O
various O
types O
of O
Internet O
attack O
activities O
, O
such O
as O
rogue O
antivirus O
websites O
, O
spam O
botnets O
operations O
, O
scam O
campaigns O
and O
targeted O
attacks O
performed O
via O
spear O
phishing O
emails O
. O

As O
with O
any O
other O
targeted O
attacks O
, O
attacks O
against O
the O
energy O
sector O
often O
follow O
the O
same O
pattern O
. O

It O
can O
be O
broken O
down O
in O
different O
phases O
of O
attack O
. O

It O
should O
be O
noted O
that O
we O
have O
seen O
attackers O
modify O
their O
behavior O
and O
exceptions O
from O
the O
norm O
and O
this O
is O
possible O
especially O
if O
the O
target O
company O
has O
special O
circumstances O
or O
security O
measures O
in O
place O
. O

During O
this O
phase O
the O
attacker O
tries O
to O
learn O
as O
much O
as O
possible O
about O
the O
targeted O
organization O
. O

Information O
sources O
often O
include O
social O
networks O
, O
job O
posting O
sites O
and O
press O
releases O
. O

This O
enables O
the O
attacker O
to O
learn O
the O
contact O
details O
of O
possible O
target O
individuals O
as O
well O
as O
context O
that O
can O
be O
used O
in O
social O
engineering O
scenarios O
. O

The O
attacker O
will O
often O
create O
a O
list O
of O
implemented O
security O
software O
used O
at O
the O
targeted O
company O
from O
whatever O
information O
is O
available O
. O

These O
investigations O
often O
start O
completely O
passively O
without O
any O
direct O
contact O
with O
the O
company O
, O
since O
there O
are O
many O
data O
sources O
publicly O
available O
. O

Subsequently O
the O
attacker O
can O
use O
more O
interaction O
if O
needed O
. O

Some O
attackers O
go O
through O
all O
the O
effort O
of O
creating O
a O
fake O
social O
media O
account O
and O
befriending O
key O
employees O
. O

After O
a O
period O
of O
small O
talk O
, O
to O
create O
a O
false O
sense O
of O
security O
, O
such O
a O
connection O
can O
then O
be O
used O
to O
pass O
on O
an O
infected O
document O
or O
find O
out O
about O
some O
key O
information O
. O

Depending O
on O
the O
targeted O
location O
, O
physical O
reconnaissance O
and O
eavesdropping O
may O
also O
be O
used O
. O

The O
actual O
break-in O
occurs O
during O
this O
phase O
. O

The B-Entity
attacker I-Entity
usually O
compromises B-Action
the B-Entity
network I-Entity
by O
delivering B-Action
targeted B-Entity
malware I-Entity
to B-Modifier
vulnerable B-Entity
systems I-Entity
or I-Entity
employees I-Entity
. O

There O
are O
two O
main O
avenues O
of O
attack O
. O

One O
is O
to O
send B-Action
spear B-Entity
phishing I-Entity
emails I-Entity
, O
where O
a B-Entity
link I-Entity
to I-Entity
a I-Entity
malicious I-Entity
website I-Entity
or I-Entity
a I-Entity
malicious I-Entity
attachment I-Entity
is B-Action
delivered I-Action
using B-Modifier
social B-Entity
engineering I-Entity
techniques I-Entity
. O

The B-Entity
second I-Entity
method I-Entity
, O
which O
is O
gaining O
traction O
, O
is B-Action
watering B-Entity
hole I-Entity
attacks I-Entity
, O
where O
the B-Entity
attacker I-Entity
infects B-Action
a B-Entity
website I-Entity
that I-Entity
has I-Entity
a I-Entity
high I-Entity
likelihood I-Entity
of I-Entity
being I-Entity
visited I-Entity
by I-Entity
the I-Entity
intended I-Entity
victim I-Entity
. O

By O
using B-Action
IP B-Entity
address I-Entity
filters I-Entity
before B-Modifier
infecting B-Entity
any I-Entity
visitor I-Entity
of I-Entity
such I-Entity
sites I-Entity
, O
the B-Entity
attacker I-Entity
can O
reduce O
the O
number O
of O
infected O
systems O
and O
bring O
it O
to O
a O
manageable O
quantity O
which O
can O
be O
assessed O
manually O
at O
another O
time O
. O



