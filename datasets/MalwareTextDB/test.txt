But O
what O
if O
the O
landing O
pages O
that O
are O
supposed O
to O
be O
ads O
are O
actually O
malicious O
PHP O
pages O
with O
embedded O
malware O
? O
The O
bidding O
and O
ad O
placements O
work O
the O
same O
, O
but O
instead O
of O
seeing O
a O
flashy O
ad O
banner O
, O
the B-Entity
highest I-Entity
bidder I-Entity
for I-Entity
the I-Entity
placement I-Entity
serves B-Action
malware B-Entity
. O

The O
price O
to O
win O
the O
bid O
to O
push O
malvertising O
to O
any O
page O
you O
happen O
to O
visit O
ranges O
from O
45 O
to O
75 O
cents O
per O
impression O
. O

A O
malicious O
advertiser O
on O
a O
network O
may O
serve O
crafted O
, O
seemingly O
normal O
ads O
, O
a O
majority O
of O
the O
time O
. O

In O
fact O
, O
the O
ads O
are O
often O
stolen O
copies O
from O
legitimate O
advertisers O
. O

This O
establishes O
the O
attacker O
's O
legitimacy O
and O
trust O
on O
the O
ad O
network O
. O

Of O
course O
with O
real-time O
ad O
bidding O
, O
he O
can O
simply O
offer O
up O
low O
bids O
and O
his O
content O
would O
consistently O
lose O
in O
the O
marketplace O
. O

But O
it O
is O
very O
simple O
to O
replace B-Action
the B-Entity
redirection I-Entity
code I-Entity
to B-Modifier
switch B-Entity
from I-Entity
a I-Entity
legitimate I-Entity
ad I-Entity
banner I-Entity
to I-Entity
a I-Entity
drop I-Entity
site I-Entity
that I-Entity
hosts I-Entity
an I-Entity
exploit I-Entity
kit I-Entity
, I-Entity
typically I-Entity
based I-Entity
on I-Entity
Java I-Entity
, I-Entity
Flash I-Entity
, I-Entity
Silverlight I-Entity
, I-Entity
or I-Entity
all I-Entity
three I-Entity
. O

Once O
the O
malvertiser O
detects O
that O
he O
has O
several O
infected O
hosts O
, O
he O
removes O
the O
redirection O
code O
and O
goes O
back O
to O
serving O
standard O
ad O
banners O
. O

He O
then O
'' O
burns O
'' O
his O
temporary O
exploit O
kit O
drop O
site O
, O
moving O
his O
exploits O
to O
another O
location O
for O
a O
new O
campaign O
. O

This O
allows O
the O
malicious O
advertiser O
to O
perform O
hit O
and O
run O
attacks O
, O
infect O
whomever O
he O
wants O
at O
whatever O
time O
he O
wants O
, O
and O
maintain O
his O
presence O
on O
the O
advertising O
marketplace O
without O
drawing O
undue O
attention O
to O
his O
activities O
. O

In O
the O
sections O
below O
, O
we O
will O
provide O
highlights O
of O
the O
RTB O
industry O
, O
its O
targeting O
capabilities O
, O
and O
show O
how O
malvertisers O
have O
been O
mis-appropriating O
RTB O
networks O
to O
deliver O
malware O
. O

The O
RTB O
ad O
networks O
provide O
significant O
micro-targeting O
capabilities O
that O
have O
long O
been O
used O
to O
serve O
legitimate O
content O
to O
users O
more O
likely O
to O
click O
on O
them O
. O

In O
the O
following O
, O
we O
describe O
these O
capabilities O
to O
show O
the O
state O
of O
the O
art O
in O
RTB O
network O
capabilities O
. O

The O
quoted O
material O
below O
are O
direct O
quotes O
from O
Real O
Time O
Bidding O
service O
providers O
linked O
. O

Emphasis O
added O
by O
Invincea O
. O

Audience O
Targeting O
: O
Bid O
on O
the O
audiences O
most O
valuable O
to O
you O
. O

Each O
impression O
in O
the O
PubMatic O
auction O
can O
be O
enhanced O
with O
first- O
and O
third-party O
data O
; O
giving O
buyers O
targeting O
capabilities O
across O
display O
, O
mobile O
, O
tablet O
and O
video O
inventory O
. O

Media O
buyers O
can O
also O
cookie O
sync O
with O
publisher O
audiences O
to O
incorporate O
CRM O
, O
retargeting O
and O
exclusion O
strategies O
in O
their O
digital O
advertising O
. O

Buyers O
have O
access O
to O
proprietary O
audience O
segments O
either O
directly O
through O
Private O
Marketplace O
deals O
or O
through O
the O
open O
market O
. O

With O
hundreds O
of O
parameters O
available O
to O
you O
, O
PubMatic O
has O
your O
best O
audiences O
waiting O
for O
you O
. O

With O
PubMatic O
, O
buyers O
are O
able O
to O
access O
pre-defined O
vertical O
or O
audience O
packages O
, O
seasonal O
packages O
, O
publisher O
and/or O
site-specific O
inventory O
packages O
as O
well O
as O
pre-selected O
publisher O
packages O
and O
pricing O
available O
in O
Private O
Marketplaces O
. O

'' O
First-Impression O
Buy-Side O
offers O
the O
granular O
targeting O
, O
tracking O
, O
and O
reporting O
needed O
to O
help O
our O
clients O
make O
the O
most O
of O
their O
spend O
, O
along O
with O
an O
expert O
support O
team O
to O
advise O
when O
needed O
. O

By O
leveraging O
real O
time O
buying O
, O
First-Impression O
Buy-Side O
gives O
media O
buyers O
the O
full O
control O
to O
maximize O
the O
value O
of O
an O
impression O
. O

'' O
Could O
Malvertisers O
Track O
Exploits O
and O
their O
cost O
per O
impression O
? O
Yes O
. O

Many O
RTB O
networks O
provide O
a O
control O
panel O
to O
track O
advertising O
campaigns O
in O
real-time O
, O
along O
with O
notifications O
that O
bids O
have O
been O
won O
and O
who O
exactly O
was O
served O
the O
malware O
. O

Below O
is O
a O
URL O
redirection O
log O
from O
First-Impression.com O
from O
a O
winning O
bid O
by O
a O
malvertiser O
. O

In O
the O
URL O
are O
parameters O
such O
as O
the O
type O
of O
ad O
, O
the O
type O
of O
user-agent O
string O
of O
the O
ad O
reader O
specified O
( O
which O
discloses O
browser O
and O
java O
versions O
) O
, O
whether O
it O
is O
a O
retargeted O
ad O
based O
off O
of O
cookies O
( O
this O
one O
was O
not O
) O
, O
the O
price O
paid O
, O
which O
is O
65.4 O
cents O
, O
and O
the O
notification O
to O
the O
malvertiser O
that O
his O
malvertising O
was O
delivered O
. O

DoubleClick O
discusses O
their O
targeting O
capabilities O
in O
online O
documentation O
. O

Since O
they O
specialize O
in O
knowing O
the O
location O
of O
their O
ad O
windows O
, O
they O
market O
those O
ad O
spaces O
to O
the O
actual O
advertisers O
and O
malvertisers O
, O
along O
with O
targeted O
demographics O
about O
the O
content O
pages O
, O
the O
visitors O
to O
the O
sites O
and O
more O
. O

To O
showcase O
the O
variety O
of O
impression-level O
data O
available O
to O
buyers O
, O
consider O
the O
data O
made O
available O
through O
a O
connection O
to O
DoubleClick O
Ad O
Exchange O
's O
real-time O
bidding O
API O
. O

With O
ADX O
, O
a O
buyer O
could O
consider O
any O
of O
the O
following O
data O
passed O
from O
the O
seller O
with O
each O
impression O
: O
• O
Ad O
slot O
parameters O
: O
visibility O
( O
above O
or O
below O
the O
fold O
) O
, O
size O
, O
excluded O
creative O
attributes O
, O
excluded O
advertiser O
URLs O
, O
allowed O
vendor O
or O
ad O
technology O
. O

• O
Geo O
parameters O
: O
country O
, O
region O
, O
metro O
, O
city O
. O

• O
Content O
parameters O
: O
site O
URL O
, O
site O
language O
, O
seller O
network O
, O
vertical O
or O
category O
. O

• O
User O
parameters O
: O
browser O
, O
operating O
system O
, O
anonymous O
cookie O
( O
hashed O
) O
, O
cookie O
age O
. O

Just O
like O
when O
considering O
one O
type O
of O
data O
, O
by O
using O
the O
anonymous O
cookie O
parameter O
, O
buyers O
can O
consider O
first-party O
retargeting O
or O
third-party O
audience O
data O
from O
a O
data O
provider O
. O

However O
, O
they O
can O
go O
further O
in O
the O
evaluation O
by O
looking O
at O
more O
of O
these O
parameters O
. O

This O
helps O
a O
buyer O
learn O
much O
more O
about O
a O
particular O
user O
and O
a O
particular O
impression O
, O
gain O
a O
smarter O
answer O
to O
the O
three O
essential O
questions O
and O
make O
a O
more O
data-driven O
decision O
. O

This O
sounds O
like O
a O
great O
way O
to O
advertise O
if O
you O
are O
in O
the O
marketing O
industry O
. O

Consider O
how O
granularly O
a O
person O
can O
be O
targeted O
if O
this O
service O
is O
used O
maliciously O
. O

If O
not O
targeted O
by O
the O
desktop O
, O
how O
about O
on O
the O
mobile O
platform O
? O
Twitter O
's O
Tailored O
Audiences O
just O
got O
a O
little O
more O
tailored O
. O

Advertisers O
can O
now O
augment O
their O
customer O
data O
using O
mobile O
advertising O
IDs O
and O
mobile O
phone O
numbers O
as O
a O
way O
to O
reach O
existing O
customers O
and O
increase O
audience O
size O
. O

In O
essence O
, O
the O
move O
is O
an O
extension O
of O
Twitter O
's O
Tailored O
Audiences O
for O
CRM O
retargeting O
, O
which O
allows O
advertisers O
to O
use O
hashed O
non-PII O
email O
address O
to O
retarget O
existing O
customers O
. O

( O
email O
addresses O
are O
twitter O
IDs- O
so O
you O
could O
be O
targeted O
for O
ad O
delivery O
based O
on O
your O
account O
name O
or O
known O
phone O
number O
) O
Twitter O
also O
rolled O
out O
the O
ability O
to O
target O
lookalike O
audiences O
, O
a O
function O
that O
seems O
pretty O
similar O
to O
Facebook O
's O
tool O
of O
the O
same O
name O
. O

Twitter O
's O
lookalike O
modeling O
uses O
a O
proprietary O
algorithm O
that O
examines O
modeled O
users O
looking O
for O
similarities O
related O
to O
behaviors O
, O
interests O
, O
location O
, O
demographic O
attributes O
and O
engagement O
patterns O
. O

Twitter O
described O
its O
enhanced O
as O
'' O
part O
of O
improved O
targeting O
options O
to O
help O
advertisers O
reach O
additional O
users O
similar O
to O
their O
existing O
audiences O
. O

'' O
Tailored O
Audiences O
, O
Twitter O
's O
seeming O
answer O
to O
the O
Facebook O
Exchange O
( O
FBX O
) O
, O
officially O
launched O
back O
in O
December O
after O
running O
retargeting O
and O
database O
matching O
tests O
in O
July O
. O

Twitter O
has O
appeared O
to O
follow O
Facebook O
's O
lead O
with O
a O
number O
of O
its O
recent O
roll-outs O
, O
including O
site O
retargeting O
, O
CRM O
targeting O
and O
now O
retargeting O
via O
lookalike O
audiences O
. O

( O
Facebook O
also O
makes O
it O
possible O
to O
target O
users O
by O
phone O
numbers O
through O
Custom O
Audiences O
. O

) O
Neustar O
does O
provide O
a O
real-time O
bidding O
ad O
exchange O
, O
but O
their O
real O
market O
is O
IP O
intelligence O
that O
they O
sell O
to O
other O
advertising O
networks O
for O
the O
purposes O
of O
better O
targeting O
specific O
users O
. O

In O
Europe O
, O
laws O
require O
that O
advertising O
networks O
allow O
people O
to O
opt O
out O
of O
having O
tracking O
cookies O
, O
which O
is O
how O
many O
advertisers O
used O
to O
rely O
upon O
for O
ad O
campaign O
targeting O
. O

To O
get O
around O
this O
, O
Neustar O
perfected O
IP O
based O
targeting O
, O
which O
avoids O
cookies O
. O

They O
are O
able O
to O
build O
IP O
specific O
browsing O
profiles O
based O
on O
IP O
subnets O
. O

In O
a O
blog O
post O
below O
, O
Neustar O
boasts O
about O
their O
direct O
to O
IP O
range O
and O
enterprise O
advertising O
. O

How O
can O
Neustar O
IP O
Intelligence O
target O
by O
IP O
? O
While O
IP O
intelligence O
has O
been O
around O
for O
many O
years O
, O
the O
ability O
to O
effectively O
target O
advertising O
by O
audience O
, O
based O
on O
IP O
is O
very O
new O
. O

Neustar O
IP O
Intelligence O
is O
currently O
working O
with O
select O
DSP O
platforms O
to O
buy O
impressions O
off O
of O
the O
exchanges O
based O
on O
the O
IP O
address O
rather O
than O
cookies O
. O

This O
has O
only O
been O
possible O
with O
the O
recent O
emergence O
of O
real O
time O
bidding O
( O
RTB O
) O
. O

The O
secret O
sauce O
is O
in O
understanding O
the O
IP O
and O
the O
methodology O
necessary O
for O
targeting O
ads O
appropriately O
against O
it O
. O

Is O
an O
IP O
Address O
like O
a O
cookie O
? O
No O
, O
an O
IP O
address O
only O
identifies O
devices O
on O
a O
network O
. O

The O
IP O
address O
does O
not O
contain O
any O
PII O
and O
does O
not O
track O
or O
store O
any O
consumer O
usage O
or O
behavioral O
information O
. O

( O
But O
IP O
ranges O
are O
registered O
by O
IANA O
, O
and O
you O
can O
easily O
know O
who O
owns O
the O
ranges O
) O
Product O
Specific O
Questions O
Q1 O
: O
How O
does O
the O
process O
work O
? O
The O
process O
works O
exactly O
like O
any O
advertising O
network O
. O

Instead O
of O
buying O
inventory O
based O
on O
a O
cookie O
, O
Neustar O
is O
buying O
inventory O
based O
on O
an O
IP O
address O
. O

We O
run O
the O
targeting O
specifics O
against O
our O
proprietary O
database O
and O
create O
a O
custom O
IP O
list O
to O
target O
against O
. O

Neustar O
has O
set O
up O
relationships O
with O
partners O
that O
have O
built O
the O
functionality O
for O
this O
to O
work O
end-to-end O
for O
our O
advertisers O
. O

Neustar O
offers O
a O
full O
service O
ad O
network O
. O

Brand O
marketers O
who O
wish O
to O
advertise O
using O
IP O
Audience O
Targeting O
can O
work O
directly O
with O
Neustar O
to O
determine O
custom O
IP O
placements O
, O
run O
campaigns O
, O
optimization O
, O
reporting O
and O
billing O
. O

Much O
like O
any O
traditional O
online O
publisher O
or O
online O
ad O
network O
, O
Neustar O
manages O
the O
entire O
process O
. O

How O
does O
Neustar O
deliver O
its O
ads O
? O
We O
use O
industry O
standard O
methods O
for O
delivering O
our O
ads O
, O
but O
what O
makes O
our O
approach O
special O
is O
that O
we O
bake O
in O
the O
IP O
data O
before O
delivering O
the O
inventory O
with O
our O
network O
partners O
, O
which O
allows O
us O
to O
target O
display O
ad O
campaigns O
to O
a O
specific O
business O
or O
organization O
. O

We O
obtain O
inventory O
from O
ad O
exchanges O
, O
but O
have O
our O
own O
ad O
server O
. O

Zedo O
, O
blamed O
for O
recent O
malvertising O
via O
DoubleClick O
, O
say O
they O
are O
now O
trying O
to O
protect O
against O
malvertisers O
in O
this O
blog O
here O
. O

Less O
than O
a O
week O
after O
this O
announcement O
, O
they O
published O
another O
blog O
post O
that O
describes O
how O
they O
can O
push O
advertising O
to O
specific O
platforms O
, O
devices O
, O
as O
well O
as O
specific O
markets O
and O
networks O
: O
Users O
can O
now O
target O
ads O
to O
a O
specific O
device O
when O
trafficking O
ads O
. O

An O
option O
for O
'' O
Device O
Targeting O
'' O
is O
now O
available O
under O
'' O
Targeting O
'' O
. O

A O
creative O
targeted O
to O
a O
specific O
Device O
will O
serve O
only O
on O
that O
Device O
. O

All O
major O
manufacturers/models O
are O
supported O
by O
this O
feature O
. O

If O
a O
creative O
is O
not O
targeted O
to O
any O
specific O
device O
than O
it O
will O
serve O
on O
all O
device O
. O

Apart O
from O
device O
, O
a O
user O
can O
target O
various O
devices O
based O
on O
different O
categories O
. O

At O
any O
given O
point O
of O
time O
, O
a O
user O
can O
target O
multiple O
manufacturers O
and O
categories O
. O

Apart O
from O
existing O
campaign O
reach O
report O
a O
user O
can O
now O
pull O
a O
reach O
report O
by O
creative O
. O

The O
creative O
reach O
report O
is O
available O
along O
with O
all O
the O
existing O
parameters O
and O
can O
be O
pulled O
by O
month O
, O
week O
or O
day O
. O

Creative O
reach O
report O
will O
show O
creative O
wise O
reach O
. O

It O
will O
help O
to O
analyze O
how O
effective O
the O
reach O
of O
a O
creative O
was O
. O

To O
be O
clear O
, O
RTB O
networks O
are O
legitimate O
platforms O
for O
displaying O
ads O
on O
ad-supported O
websites O
. O

They O
enable O
micro-targeting O
of O
user O
's O
interest O
, O
delivering O
content O
that O
a O
viewer O
would O
likely O
want O
to O
see O
. O

As O
we O
have O
detailed O
here O
, O
they O
can O
also O
be O
mis-appropriated O
unwittingly O
by O
malvertisers B-Entity
using B-Action
these B-Entity
same I-Entity
tools I-Entity
and I-Entity
techniques I-Entity
to B-Modifier
target B-Entity
companies I-Entity
with I-Entity
malware I-Entity
for I-Entity
persistent I-Entity
remote I-Entity
access I-Entity
in B-Modifier
addition I-Modifier
to I-Modifier
traditional B-Entity
click I-Entity
fraud I-Entity
, I-Entity
phishing I-Entity
, I-Entity
and I-Entity
identity I-Entity
theft I-Entity
. O

Below O
are O
links O
to O
RTB O
providers O
to O
learn O
more O
. O

Invincea O
has O
shown O
logs O
from O
a O
winning O
malvertising O
bid O
in O
the O
price O
range O
of O
65 O
cents O
per O
impression O
. O

That O
is O
one O
ad O
, O
on O
one O
page O
, O
paid O
for O
by O
the O
malvertiser O
's O
account O
. O

This O
implies O
that O
malvertisers O
have O
deep O
pockets O
, O
spending O
hundreds O
of O
dollars O
on O
ad O
impressions O
. O

So O
how O
do O
they O
get O
money O
to O
spend O
on O
these O
malicious O
campaigns O
? O
Invincea O
recently O
saw O
a B-Entity
malvertiser I-Entity
win O
a O
bid O
and O
delivered B-Action
a B-Entity
Java I-Entity
exploit I-Entity
. O

This B-Entity
exploit I-Entity
copied B-Action
a B-Entity
fully I-Entity
functional I-Entity
version I-Entity
of I-Entity
Chrome I-Entity
into B-Modifier
the B-Entity
Java I-Entity
cache I-Entity
directory I-Entity
, O
and O
that B-Entity
version I-Entity
of I-Entity
Chrome I-Entity
launched O
in O
the O
background O
and O
proceeded O
to O
visit O
websites O
and O
click B-Action
on B-Modifier
specific B-Entity
ad I-Entity
banners I-Entity
. O

It O
is O
presumed O
that O
these O
ad O
banners O
paid O
revenue O
via O
referral O
bonuses O
to O
the O
malvertiser O
. O

By O
paying O
65 O
cents O
to O
install O
a B-Entity
background I-Entity
web I-Entity
browser I-Entity
that O
does B-Action
nothing O
but O
click B-Entity
fraud I-Entity
, O
the O
malvertiser O
is O
able O
to O
reap O
hundreds O
if O
not O
thousands O
of O
dollars O
in O
advertising O
referral O
income O
. O

It O
is O
a O
pretty O
good O
return O
on O
investment O
, O
which O
in O
turn O
allows O
the O
malvertiser O
to O
fund O
his O
micro-targeted O
malvertising O
attack O
campaign O
. O

It O
is O
ironic O
, O
however O
, O
that O
click O
fraud O
is O
what O
is O
driving O
the O
prices O
of O
RTB O
advertising O
so O
high O
. O

Malvertising O
is O
not O
only O
a O
danger O
to O
end O
users O
, O
but O
it O
is O
a O
danger O
to O
the O
advertising O
industry O
as O
well O
. O

The O
image O
from O
Figure O
14 O
below O
shows O
a O
log O
file O
of O
Chrome O
, O
in O
this O
instance O
, O
renamed O
Oajvliewxpge.exe O
, O
injected O
via O
Java O
to O
run O
in O
the O
background O
. O

Invincea O
detected O
this O
attack O
and O
killed O
the O
infection O
attempt O
. O

This O
is O
one O
instance O
where O
the O
malvertiser O
wasted O
his O
65 O
cents O
. O

It O
should O
be O
noted O
that O
Invincea O
is O
uniquely O
capable O
of O
stopping O
this O
type O
of O
attack O
. O

The O
introduction O
of O
Chrome O
as O
a O
browser O
, O
which O
is O
whitelisted O
by O
hash O
across O
the O
AV O
industry O
, O
would O
go O
unchecked O
by O
the O
AV O
and O
whitelisting O
applications O
industry O
. O

In O
this O
instance O
, O
the B-Entity
host I-Entity
was B-Action
almost I-Action
converted I-Action
to B-Modifier
a B-Entity
click-fraud I-Entity
bot I-Entity
. O

But O
the B-Entity
malware I-Entity
delivery I-Entity
could O
have O
been B-Action
intended I-Action
for B-Modifier
data B-Entity
exfiltration I-Entity
, O
banking O
Trojans O
, O
or O
any O
other O
more O
insidious O
purpose O
. O

The O
ability O
for O
advertisers O
and O
malvertisers O
to O
automatically O
redirect O
to O
self-hosted O
ad O
content O
or O
exploit O
pages O
is O
driving O
RTB O
malvertising O
. O

Invincea O
has O
witnessed O
a O
rash O
of O
exploit O
kits O
and O
landing O
pages O
hosted O
on O
: O
In O
most O
instances O
, O
the B-Entity
landing I-Entity
pages I-Entity
are B-Action
preconfigured I-Action
with B-Modifier
the B-Entity
exploit I-Entity
kit I-Entity
. O

The O
malvertiser O
creates O
the O
redirection O
in O
his O
normal O
ad O
prior O
to O
raising O
his O
bids O
to O
winning O
levels O
. O

Once O
several O
victims O
are O
confirmed O
, O
those O
malicious O
landing O
pages O
have O
the O
content O
erased O
, O
and O
the O
automatic O
redirection O
removed O
to O
serve O
'' O
normal O
'' O
ads O
again O
. O

Figures O
17 O
through O
21 O
in O
the O
following O
are O
screenshots O
from O
Invincea O
's O
Threat O
Management O
console O
from O
various O
RTB-based O
malvertising O
incidents O
with O
highlighted O
URLs O
for O
malvertising B-Entity
delivered B-Action
via B-Modifier
RTB B-Entity
ad I-Entity
bidding I-Entity
. O

In O
September O
and O
October O
of O
2014 O
, O
Invincea O
saw O
a O
sharp O
spike O
of O
malvertising B-Entity
delivering B-Action
CryptoWall B-Entity
ransomware I-Entity
attacks I-Entity
via B-Modifier
Real B-Entity
Time I-Entity
Ad I-Entity
Bidding I-Entity
. O

We O
observed O
Real B-Entity
Time I-Entity
Ad I-Entity
bidding I-Entity
platforms I-Entity
, I-Entity
including I-Entity
OpenX I-Entity
, I-Entity
GoogleAds I-Entity
, I-Entity
Yahoo I-Entity
, I-Entity
AOL I-Entity
, I-Entity
and I-Entity
first-impression.com I-Entity
, O
fall O
victim O
to O
the O
ransomware O
malvertising O
scheme O
by O
unwittingly O
delivering B-Action
the B-Entity
CryptoWall I-Entity
2.0 I-Entity
ransomware I-Entity
ads I-Entity
. O

Ransomware B-Entity
is O
a O
particularly O
pernicious O
form O
of O
malware O
that O
fully O
encrypts B-Action
the B-Entity
victim I-Entity
's I-Entity
disk I-Entity
and I-Entity
data I-Entity
files I-Entity
, I-Entity
including I-Entity
remote I-Entity
storage I-Entity
, O
then O
demands O
payment O
of O
anywhere O
from O
$ O
300 O
to O
$ O
1000 O
in O
return O
for O
the O
decryption O
key O
. O

Users O
are O
held O
hostage O
from O
their O
own O
work O
, O
pictures O
, O
personal O
, O
and O
proprietary O
material O
. O

To O
learn O
more O
about O
the O
scourage O
of O
ransomware O
, O
see O
this O
blog O
. O

Based O
on O
analysis O
of O
Invincea O
logs O
in O
would-be O
victims O
targeted O
by O
these O
ads O
, O
we O
have O
insight O
into O
the B-Entity
attacker I-Entity
that O
is B-Action
delivering I-Action
the B-Entity
malicious I-Entity
ads I-Entity
. O

According O
to O
Invincea O
analysis O
of O
ads O
delivered O
from O
first- O
impression.com O
, O
winning O
ad O
bids O
ranging O
from O
as O
low O
as O
30 O
cents O
and O
as O
high O
as O
$ O
1.70 O
, O
were O
delivered O
by O
a O
block O
of O
unique O
identifiers O
. O

It O
is O
highly O
likely O
that O
the O
same O
attackers O
are O
using O
other O
RTB O
ad O
platforms O
. O

This O
campaign O
matches O
the O
characteristics O
described O
by O
Proofpoint O
in O
its O
blog O
in O
terms O
of O
the O
exploitation O
methods O
. O

Legitimate O
ad O
copy O
is O
stolen O
, O
3rd B-Entity
party I-Entity
ad I-Entity
networks I-Entity
used B-Action
to B-Modifier
distribute B-Entity
malware I-Entity
, O
and O
popular O
ad- O
supported O
websites O
displaying O
the B-Entity
malicious I-Entity
ads I-Entity
that O
exploit B-Action
unsuspecting B-Entity
visitors I-Entity
with B-Modifier
drive-by B-Entity
web I-Entity
exploits I-Entity
. O

Merely O
visiting B-Entity
any I-Entity
ad-supported I-Entity
site I-Entity
may O
result B-Action
in B-Modifier
a B-Entity
CryptoWall I-Entity
ransomware I-Entity
infection I-Entity
. O

Cryptowall B-Entity
2.0 I-Entity
utilizes B-Action
the B-Entity
TOR I-Entity
network I-Entity
to B-Modifier
hide B-Entity
its I-Entity
communications I-Entity
, O
but O
it B-Entity
quickly O
encrypts B-Action
all B-Entity
local I-Entity
files I-Entity
on I-Entity
the I-Entity
disk I-Entity
, O
and O
demands O
bitcoin O
payment O
to O
unlock O
the O
files O
. O

Many O
companies O
have O
fallen O
prey O
to O
this O
attack O
over O
the O
past O
few O
months O
, O
making O
this O
one O
of O
the O
most O
successful O
Ransomware O
campaigns O
to O
date O
. O

Below O
is O
a O
typical O
Cryptowall O
2 O
infection O
as O
seen O
in O
the O
Invincea O
Management O
Server O
logs O
. O

This O
winning O
ad O
placement O
ran O
on O
sports.yahoo.com O
– O
an O
Alexa O
Top O
4 O
rated O
site O
. O

Highlighted O
in O
order O
in O
Figure O
22 O
is O
the O
common O
filename O
of O
obupdat.exe O
, O
which O
has O
ever O
changing O
hashes O
, O
followed O
by O
the O
TOR O
port O
, O
and O
the O
3rd O
party O
ad O
platform O
of O
first-impression.com O
. O

Analysis O
( O
Original O
report O
) O
: O
Timeline O
Analysis O
( O
Original O
Report O
) O
: O
Below O
in O
Figure O
23 O
is O
the O
timeline O
of O
the O
Tor O
connections O
and O
SSL O
connections O
employed O
by O
CryptoWall O
. O

In O
addition O
, O
you O
can O
see O
the B-Entity
ransom I-Entity
note I-Entity
being B-Action
written I-Action
to B-Modifier
disk B-Entity
on B-Modifier
an B-Entity
infected I-Entity
machine I-Entity
in O
the O
audit O
logs O
in O
Figure O
24 O
. O

Figure O
25 O
shows O
the O
winning O
malvertising O
bid O
via O
RTB O
ad O
delivery O
from O
first-impression.com O
. O

Items O
highlighted O
in O
the O
URL O
below O
is O
userid O
, O
and O
the O
winning O
bid O
price O
to O
place B-Action
malvertising B-Entity
of I-Entity
Cryptowall I-Entity
on B-Modifier
sports.yahoo.com B-Entity
, O
which O
is O
60 O
cents O
. O

In O
Figure O
26 O
below O
, O
we O
show O
the O
unique O
identifiers O
for O
the O
userID O
and O
campaigns O
to O
deliver O
CryptoWall O
malware O
that O
were O
blocked O
and O
audited O
by O
Invincea O
, O
including O
the O
websites O
that O
delivered O
the O
ads O
via O
a O
third-party O
ad O
network O
over O
the O
past O
month O
. O

To O
reiterate O
, O
neither O
the O
websites O
listed O
here O
, O
nor O
the O
3rd O
party O
ad O
network O
, O
necessarily O
was O
aware O
of O
the O
malicious O
ads O
they O
were O
serving O
to O
the O
website O
visitors O
. O

It O
is O
likely O
they O
were O
not O
aware O
without O
ad O
screening O
technology O
. O

In O
each O
event O
above O
, O
Invincea O
blocked O
an O
attempt O
to O
infect O
an O
endpoint O
with O
Cryptowall O
2.0 O
and O
prevented O
CryptoWall O
from O
encrypting O
the O
user O
's O
file O
system O
and O
holding O
it O
hostage O
. O

Had O
the O
user O
not O
been O
running O
Invincea O
, O
the O
attack O
would O
likely O
have O
been O
successful O
, O
and O
the O
only O
way O
the O
user O
would O
have O
had O
to O
recover O
the O
encrypted O
files O
would O
be O
to O
pay O
the O
attacker O
the O
ransom O
. O

This O
is O
an O
effective O
ransom O
technique O
, O
and O
one O
that O
is O
paying O
off O
well O
for O
the O
attackers O
, O
who O
use O
the O
income O
from O
the O
attacks O
to O
purchase O
Real O
Time O
Ad O
Bids O
on O
RTB O
networks O
to O
infect O
more O
users O
. O

Most O
RTB O
ad O
providers O
allow O
for O
advertisers O
to O
host O
their O
own O
ad O
content O
. O

This O
allows O
advertisers O
to O
directly O
collect O
web O
impression O
data O
of O
who O
is O
hitting O
which O
ads O
, O
from O
where O
, O
by O
which O
IPs O
, O
which O
user- O
agent O
strings O
, O
and O
just O
about O
anything O
else O
you O
could O
log O
about O
a O
website O
visit O
. O

In O
addition O
, O
the O
advertising O
network O
does O
n't O
have O
to O
utilize O
their O
own O
disk O
space O
to O
host O
the O
image O
files O
, O
the O
flash O
videos O
or O
other O
online O
content O
. O

RTB O
networks O
simply O
do O
the O
auctioneering O
and O
redirection O
to O
the O
winning O
content O
. O

It O
is O
this O
weakness O
in O
security O
that O
malvertisers O
are O
taking O
advantage O
of O
. O

If O
ad O
networks O
were O
to O
switch O
to O
a O
model O
where O
all O
content O
is O
actually O
hosted O
by O
them O
( O
1st O
party O
hosting O
) O
, O
in O
a O
cloud O
, O
then O
the O
risk O
of O
malvertising O
would O
drop O
dramatically O
. O

The O
RubiconProject O
has O
a O
Seller O
's O
Cloud O
, O
which O
could O
be O
a O
security O
model O
for O
the O
RTB O
industry O
. O

It O
is O
inherently O
more O
secure O
way O
of O
hosting O
ad O
content O
. O

Operation B-Entity
DeathClick I-Entity
is O
an O
active O
campaign O
to O
micro-target B-Action
companies B-Entity
via B-Modifier
malvertising B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
compromise B-Entity
their I-Entity
networks I-Entity
. O

Unfortunately O
, O
the B-Entity
micro-targeting I-Entity
malvertising I-Entity
technique I-Entity
evades B-Action
almost B-Entity
all I-Entity
network I-Entity
controls I-Entity
and I-Entity
traditional I-Entity
endpoint I-Entity
anti-virus I-Entity
solutions I-Entity
. O

Invincea O
can O
protect O
users O
from O
this O
attack O
type O
among O
other O
targeted O
and O
opportunistic O
web-based O
threats O
. O

For O
half O
the O
price O
of O
a O
candy O
bar O
, O
attackers B-Entity
have O
the O
unprecedented O
ability O
to O
deliver B-Action
malware B-Entity
to B-Modifier
you B-Entity
through B-Modifier
your B-Entity
web I-Entity
browser I-Entity
simply O
because B-Modifier
of I-Modifier
your B-Entity
IP I-Entity
address I-Entity
space I-Entity
and I-Entity
your I-Entity
industry I-Entity
vertical I-Entity
. O

Most B-Entity
of I-Entity
the I-Entity
attacks I-Entity
featured I-Entity
here I-Entity
were B-Action
not I-Action
detected I-Action
by O
standard B-Entity
Anti-Virus I-Entity
because B-Modifier
the B-Entity
malware I-Entity
hashes I-Entity
constantly I-Entity
change I-Entity
. O

Web O
proxy O
blocking O
updates O
, O
even O
in O
real O
time O
, O
will O
not O
stop O
new O
malvertising O
landing O
pages O
that O
appear O
and O
disappear O
within O
minutes O
. O

Intelligence O
feeds O
from O
the O
premier O
intelligence O
providers O
, O
based O
on O
hostname O
, O
IP O
, O
URL O
or O
domain O
will O
not O
be O
able O
to O
block O
malicious O
malvertisers O
quickly O
enough O
. O

Invincea O
protected O
users O
can O
simply O
browse O
and O
click O
anything O
online O
without O
fear O
of O
compromise O
or O
targeted O
malvertising O
attacks O
. O

Non-Invincea O
users O
can O
attempt O
to O
OptOut O
of O
directed O
targeting O
where O
you O
can O
. O

European O
privacy O
laws O
for O
forcing O
most O
ad O
providers O
to O
offer O
the O
opt-out O
service O
; O
however O
, O
you O
often O
have O
to O
visit O
each O
ad O
provider O
individually O
to O
choose O
to O
opt O
out O
. O

Note O
, O
that O
opting O
out O
merely O
places O
a O
blocking O
cookie O
in O
your O
browser O
. O

This O
means O
that O
ad O
providers O
will O
not O
target O
or O
retarget O
based O
on O
cookies O
. O

But O
as O
shown O
above O
, O
the O
new O
targeted O
advertising O
is O
via O
IP O
intelligence O
. O

10/27 O
: O
For O
clarification O
, O
Invincea O
has O
added O
additional O
notes O
in O
this O
version O
that O
the O
websites O
shown O
here O
and O
the O
3rd O
party O
real-time O
ad O
networks O
are O
being O
used O
unwittingly O
and O
their O
resources O
misappropriated O
by O
malvertisers O
to O
target O
companies O
for O
persistent O
remote O
access O
, O
click O
fraud O
, O
and O
other O
nefarious O
activities O
. O

This O
is O
not O
a O
reflection O
on O
these O
companies O
, O
nor O
the O
services O
they O
provide O
. O

This O
paper O
highlights O
the O
problem O
for O
greater O
awareness O
so O
the O
industry O
collectively O
can O
combat O
this O
problem O
perhaps O
with O
more O
effective O
screening O
at O
the O
source O
prior O
to O
displaying O
ads O
. O

Less O
than O
a O
week O
after O
uncovering O
Operation O
SnowMan O
, O
the O
FireEye O
Dynamic O
Threat O
Intelligence O
cloud O
has O
identified O
another O
targeted O
attack O
campaign O
- O
this O
one O
exploiting O
a O
zero-day O
vulnerability O
in O
Flash O
. O

We O
are O
collaborating O
with O
Adobe O
security O
on O
this O
issue O
. O

Adobe O
has O
assigned O
the O
CVE O
identifier O
CVE-2014- O
0502 O
to O
this O
vulnerability O
and O
released O
a O
security O
bulletin O
. O

As O
of O
this O
blog O
post O
, O
visitors B-Entity
to I-Entity
at I-Entity
least I-Entity
three I-Entity
nonprofit I-Entity
institutions I-Entity
- O
two O
of O
which O
focus O
on O
matters O
of O
national O
security O
and O
public O
policy O
- O
were B-Action
redirected I-Action
to B-Modifier
an B-Entity
exploit I-Entity
server I-Entity
hosting I-Entity
the I-Entity
zero-day I-Entity
exploit I-Entity
. O

We O
're O
dubbing O
this O
attack O
'' O
Operation O
GreedyWonk O
. O

'' O
We O
believe O
GreedyWonk O
may O
be O
related O
to O
a O
May O
2012 O
campaign O
outlined O
by O
ShadowServer O
, O
based O
on O
consistencies O
in O
tradecraft O
( O
particularly O
with O
the O
websites O
chosen O
for O
this O
strategic O
Web O
compromise O
) O
, O
attack O
infrastructure O
, O
and O
malware O
configuration O
properties O
. O

The B-Entity
group I-Entity
behind I-Entity
this I-Entity
campaign I-Entity
appears O
to O
have O
sufficient O
resources O
( O
such O
as O
access O
to O
zero-day O
exploits O
) O
and O
a O
determination O
to O
infect B-Action
visitors B-Entity
to I-Entity
foreign I-Entity
and I-Entity
public I-Entity
policy I-Entity
websites I-Entity
. O

The B-Entity
threat I-Entity
actors I-Entity
likely O
sought O
to O
infect B-Action
users B-Entity
to I-Entity
these I-Entity
sites I-Entity
for B-Modifier
follow-on B-Entity
data I-Entity
theft I-Entity
, O
including O
information O
related O
to O
defense O
and O
public O
policy O
matters O
. O

On O
Feb. O
13 O
, O
FireEye O
identified O
a O
zero-day O
Adobe O
Flash O
exploit O
that O
affects O
the O
latest O
version O
of O
the O
Flash O
Player O
( O
12.0.0.4 O
and O
11.7.700.261 O
) O
. O

Visitors B-Entity
to I-Entity
the I-Entity
Peter I-Entity
G. I-Entity
Peterson I-Entity
Institute I-Entity
for I-Entity
International I-Entity
Economics I-Entity
( I-Entity
www.piie I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
) I-Entity
were B-Action
redirected I-Action
to B-Modifier
an B-Entity
exploit I-Entity
server I-Entity
hosting I-Entity
this I-Entity
Flash I-Entity
zero-day I-Entity
through B-Modifier
a B-Entity
hidden I-Entity
iframe I-Entity
. O

We B-Entity
subsequently I-Entity
found I-Entity
that I-Entity
the I-Entity
American I-Entity
Research I-Entity
Center I-Entity
in I-Entity
Egypt I-Entity
( I-Entity
www.arce I-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
) I-Entity
and I-Entity
the I-Entity
Smith I-Entity
Richardson I-Entity
Foundation I-Entity
( I-Entity
www.srf I-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
) I-Entity
also O
redirected B-Action
visitors B-Entity
the B-Entity
exploit I-Entity
server I-Entity
. O

All O
three O
organizations O
are O
nonprofit O
institutions O
; O
the O
Peterson O
Institute O
and O
Smith O
Richardson O
Foundation O
engage O
in O
national O
security O
and O
public O
policy O
issues O
. O

To O
bypass B-Action
Windows B-Entity
' I-Entity
Address I-Entity
Space I-Entity
Layout I-Entity
Randomization I-Entity
( I-Entity
ASLR I-Entity
) I-Entity
protections I-Entity
, O
this B-Entity
exploit I-Entity
targets B-Action
computers B-Entity
with I-Entity
any I-Entity
of I-Entity
the I-Entity
following I-Entity
configurations I-Entity
: O
Users O
can O
mitigate O
the O
threat O
by O
upgrading O
from O
Windows O
XP O
and O
updating O
Java O
and O
Office O
. O

If O
you O
have O
Java O
1.6 O
, O
update O
Java O
to O
the O
latest O
1.7 O
version O
. O

If O
you O
are O
using O
an O
out-of-date O
Microsoft O
Office O
2007 O
or O
2010 O
, O
update O
Microsoft O
Office O
to O
the O
latest O
version O
. O

These O
mitigations O
do O
not O
patch O
the O
underlying O
vulnerability O
. O

But O
by O
breaking O
the O
exploit O
's O
ASLR-bypass O
measures O
, O
they O
do O
prevent O
the O
current O
in-the-wild O
exploit O
from O
functioning O
. O

GreedyWonk O
targets O
a O
previously O
unknown O
vulnerability O
in O
Adobe O
Flash O
. O

The O
vulnerability O
permits O
an B-Entity
attacker I-Entity
to O
overwrite B-Action
the B-Entity
vftable I-Entity
pointer I-Entity
of I-Entity
a I-Entity
Flash I-Entity
object I-Entity
to B-Modifier
redirect B-Entity
code I-Entity
execution I-Entity
. O

The B-Entity
attack I-Entity
uses B-Action
only B-Entity
known I-Entity
ASLR I-Entity
bypasses I-Entity
. O

Details O
of O
these O
techniques O
are O
available O
from O
our O
previous O
blog O
post O
on O
the O
subject O
( O
in O
the O
'' O
Non-ASLR O
modules O
'' O
section O
) O
. O

For B-Modifier
Windows B-Entity
XP I-Entity
, O
the B-Entity
attackers I-Entity
build B-Action
a B-Entity
return-oriented I-Entity
programming I-Entity
( I-Entity
ROP I-Entity
) I-Entity
chain I-Entity
of I-Entity
MSVCRT I-Entity
( I-Entity
Visual I-Entity
C I-Entity
runtime I-Entity
) I-Entity
gadgets I-Entity
with B-Modifier
hard-coded B-Entity
base I-Entity
addresses I-Entity
for I-Entity
English I-Entity
( I-Entity
'' I-Entity
en I-Entity
'' I-Entity
) I-Entity
and I-Entity
Chinese I-Entity
( I-Entity
'' I-Entity
zh-cn I-Entity
'' I-Entity
and I-Entity
'' I-Entity
zh-tw I-Entity
'' I-Entity
) I-Entity
. O

On B-Modifier
Windows B-Entity
7 I-Entity
, O
the B-Entity
attackers I-Entity
use B-Action
a B-Entity
hard-coded I-Entity
ROP I-Entity
chain I-Entity
for I-Entity
MSVCR71.dll I-Entity
( I-Entity
Visual I-Entity
C++ I-Entity
runtime I-Entity
) I-Entity
if B-Modifier
the B-Entity
user I-Entity
has I-Entity
Java I-Entity
1.6 I-Entity
, O
and O
a B-Entity
hard-coded I-Entity
ROP I-Entity
chain I-Entity
for I-Entity
HXDS.dll I-Entity
( I-Entity
Help I-Entity
Data I-Entity
Services I-Entity
Module I-Entity
) I-Entity
if B-Modifier
the B-Entity
user I-Entity
has I-Entity
Microsoft I-Entity
Office I-Entity
2007 I-Entity
or I-Entity
2010 I-Entity
. O

Java O
1.6 O
is O
no O
longer O
supported O
and O
does O
not O
receive O
security O
updates O
. O

In O
addition O
to O
the O
MSVCR71.dll O
ASLR O
bypass O
, O
a O
variety O
of O
widely O
exploited O
code-execution O
vulnerabilities O
exist O
in O
Java O
1.6 O
. O

That O
's O
why O
FireEye O
strongly O
recommends O
upgrading O
to O
Java O
1.7 O
. O

The O
Microsoft O
Office O
HXDS.dll O
ASLR O
bypass O
was O
patched O
at O
the O
end O
of O
2013 O
. O

More O
details O
about O
this O
bypass O
are O
addressed O
by O
Microsoft O
's O
Security O
Bulletin O
MS13-106 O
and O
an O
accompanying O
blog O
entry O
. O

FireEye O
strongly O
recommends O
updating O
Microsoft O
Office O
2007 O
and O
2010 O
with O
the O
latest O
patches O
. O

The B-Entity
shellcode I-Entity
is B-Action
downloaded I-Action
in B-Modifier
ActionScript B-Entity
as B-Modifier
a B-Entity
GIF I-Entity
image I-Entity
. O

Once O
ROP O
marks O
the O
shellcode O
as O
executable O
using O
Windows O
' O
VirtualProtect O
function O
, O
it B-Entity
downloads B-Action
an B-Entity
executable I-Entity
via B-Modifier
the B-Entity
InternetOpenURLA I-Entity
and I-Entity
InternetReadFile I-Entity
functions I-Entity
. O

Then O
it B-Entity
writes B-Action
the B-Entity
file I-Entity
to B-Modifier
disk B-Entity
with B-Modifier
CreateFileA B-Entity
and I-Entity
WriteFile I-Entity
functions I-Entity
. O

Finally O
, O
it B-Entity
runs B-Action
the B-Entity
file I-Entity
using B-Modifier
the B-Entity
WinExec I-Entity
function I-Entity
. O

Once O
the O
exploit O
succeeds O
, O
a B-Entity
PlugX/Kaba I-Entity
remote I-Entity
access I-Entity
tool I-Entity
( I-Entity
RAT I-Entity
) I-Entity
payload I-Entity
with I-Entity
the I-Entity
MD5 I-Entity
hash I-Entity
507aed81e3106da8c50efb3a045c5e2b I-Entity
is B-Action
installed I-Action
on B-Modifier
the B-Entity
compromised I-Entity
endpoint I-Entity
. O

This O
PlugX O
sample O
was O
compiled O
on O
Feb. O
12 O
, O
one O
day O
before O
we O
first O
observed O
it O
, O
indicating O
that O
it O
was O
deployed O
specifically O
for O
this O
campaign O
. O

This B-Entity
PlugX I-Entity
payload I-Entity
was B-Action
configured I-Action
with B-Modifier
the B-Entity
following I-Entity
command-and-control I-Entity
( I-Entity
CnC I-Entity
) I-Entity
domains I-Entity
: O
Sample O
callback O
traffic O
was O
as O
follows O
: O
Both O
java.ns1 O
[ O
. O

] O
name O
and O
adservice.no-ip O
[ O
. O

] O
org O
resolved O
to O
74.126.177.68 O
on O
Feb. O
18 O
, O
2014 O
. O

Passive O
DNS O
analysis O
reveals O
that O
the O
domain O
wmi.ns01.us O
previously O
resolved O
to O
103.246.246.103 O
between O
July O
4 O
, O
2013 O
and O
July O
15 O
, O
2013 O
and O
192.74.246.219 O
on O
Feb. O
17 O
, O
2014 O
. O

java.ns1 O
[ O
. O

] O
name O
also O
resolved O
to O
192.74.246.219 O
on O
February O
18 O
. O

Further O
research O
uncovered O
a B-Entity
number I-Entity
of I-Entity
older I-Entity
malware I-Entity
samples I-Entity
connecting B-Action
to B-Modifier
the B-Entity
same I-Entity
domain I-Entity
wmi.ns01 I-Entity
[ I-Entity
. I-Entity
] I-Entity
us I-Entity
. O

The B-Entity
Poison I-Entity
Ivy I-Entity
variants I-Entity
that O
connected B-Action
to B-Modifier
the B-Entity
domain I-Entity
wmi.ns01 I-Entity
[ I-Entity
. I-Entity
] I-Entity
us I-Entity
had O
the O
following O
unique O
configuration O
properties O
: O
We O
found O
a B-Entity
related I-Entity
Poison I-Entity
Ivy I-Entity
sample I-Entity
( I-Entity
MD5 I-Entity
8936c87a08ffa56d19fdb87588e35952 I-Entity
) I-Entity
with I-Entity
the I-Entity
same I-Entity
'' I-Entity
java7 I-Entity
'' I-Entity
password I-Entity
, O
which O
was B-Action
dropped I-Action
by O
an B-Entity
Adobe I-Entity
Flash I-Entity
exploit I-Entity
( I-Entity
CVE-2012-0779 I-Entity
) I-Entity
. O

In O
this O
previous O
incident O
, O
visitors B-Entity
to I-Entity
the I-Entity
Center I-Entity
for I-Entity
Defense I-Entity
Information I-Entity
website I-Entity
( O
www.cdi O
[ O
. O

] O
org O
- O
also O
an O
organization O
involved O
in O
defense O
matters O
- O
were B-Action
redirected I-Action
to B-Modifier
an B-Entity
exploit I-Entity
server I-Entity
at I-Entity
159.54.62.92 I-Entity
. O

This O
exploit O
server O
hosted O
a O
Flash O
exploit O
file O
named O
BrightBalls.swf O
( O
MD5 O
1ec5141051776ec9092db92050192758 O
) O
. O

This B-Entity
exploit I-Entity
, O
in O
turn O
, O
dropped B-Action
the B-Entity
Poison I-Entity
Ivy I-Entity
variant I-Entity
. O

In O
addition O
to O
using O
the O
same O
password O
'' O
java7 O
, O
'' O
this B-Entity
variant I-Entity
was O
configured O
with O
the O
mutex O
with O
the O
similar O
pattern O
of O
'' O
YFds* O
& O
^ff O
'' O
and O
connected B-Action
to B-Modifier
a B-Entity
CnC I-Entity
server I-Entity
at I-Entity
windows.ddns I-Entity
[ I-Entity
. I-Entity
] I-Entity
us I-Entity
. O

Using O
passive O
DNS O
analysis O
, O
we O
see O
the O
domains O
windows.ddns O
[ O
. O

] O
us O
and O
wmi.ns01 O
[ O
. O

] O
us O
both O
resolved O
to O
76.73.80.188 O
in O
mid-2012 O
. O

During O
another O
earlier O
compromise O
of O
the O
same O
www.cdi.org O
website O
, O
visitors B-Entity
were B-Action
redirected I-Action
to B-Modifier
a B-Entity
Java I-Entity
exploit I-Entity
test.jar I-Entity
( I-Entity
MD5 I-Entity
7d810e3564c4eb95bcb3d11ce191208e I-Entity
) I-Entity
. O

This B-Entity
jar I-Entity
file I-Entity
exploited O
CVE-2012-0507 O
and O
dropped B-Action
a B-Entity
Poison I-Entity
Ivy I-Entity
payload I-Entity
with I-Entity
the I-Entity
hash I-Entity
( I-Entity
MD5 I-Entity
52aa791a524b61b129344f10b4712f52 I-Entity
) I-Entity
. O

This B-Entity
Poison I-Entity
Ivy I-Entity
variant I-Entity
connected B-Action
to B-Modifier
a B-Entity
CnC I-Entity
server I-Entity
at I-Entity
ids.ns01 I-Entity
[ I-Entity
. I-Entity
] I-Entity
us I-Entity
. O

The O
domain O
ids.ns01 O
[ O
. O

] O
us O
also O
overlaps O
with O
the O
domain O
wmi.ns01 O
[ O
. O

] O
us O
on O
the O
IP O
194.183.224.75 O
. O

The B-Entity
Poison I-Entity
Ivy I-Entity
sample I-Entity
referenced I-Entity
above I-Entity
( I-Entity
MD5 I-Entity
fd69793bd63c44bbb22f9c4d46873252 I-Entity
) I-Entity
was B-Action
delivered I-Action
via B-Modifier
an B-Entity
exploit I-Entity
chain I-Entity
that I-Entity
began I-Entity
with I-Entity
a I-Entity
redirect I-Entity
from I-Entity
the I-Entity
Center I-Entity
for I-Entity
European I-Entity
Policy I-Entity
Studies I-Entity
( I-Entity
www.ceps I-Entity
[ I-Entity
. I-Entity
] I-Entity
be I-Entity
) I-Entity
. O

In O
this O
case O
, O
visitors B-Entity
were B-Action
redirected I-Action
from B-Modifier
www.ceps B-Entity
[ I-Entity
. I-Entity
] I-Entity
be I-Entity
to B-Modifier
a B-Entity
Java I-Entity
exploit I-Entity
hosted I-Entity
on I-Entity
shop.fujifilm I-Entity
[ I-Entity
. I-Entity
] I-Entity
be I-Entity
. O

In O
what O
is O
certainly O
not O
a O
coincidence O
, O
we O
also O
observed O
www.arce B-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
( O
one O
of O
the O
sites O
redirecting B-Action
to B-Modifier
the B-Entity
current I-Entity
Flash I-Entity
exploit I-Entity
) O
also O
redirect B-Action
visitors B-Entity
to B-Modifier
the B-Entity
Java I-Entity
exploit I-Entity
on I-Entity
shop.fujifilm I-Entity
[ I-Entity
. I-Entity
] I-Entity
be I-Entity
in B-Modifier
2013 B-Entity
. O

This O
threat O
actor O
clearly O
seeks O
out O
and O
compromises O
websites O
of O
organizations O
related O
to O
international O
security O
policy O
, O
defense O
topics O
, O
and O
other O
non-profit O
sociocultural O
issues O
. O

The O
actor O
either O
maintains O
persistence O
on O
these O
sites O
for O
extended O
periods O
of O
time O
or O
is O
able O
to O
re-compromise O
them O
periodically O
. O

This B-Entity
actor I-Entity
also O
has O
early O
access O
to O
a O
number O
of O
zero-day O
exploits O
, O
including O
Flash O
and O
Java O
, O
and O
deploys B-Action
a B-Entity
variety I-Entity
of I-Entity
malware I-Entity
families I-Entity
on B-Modifier
compromised B-Entity
systems I-Entity
. O

Based O
on O
these O
and O
other O
observations O
, O
we O
conclude O
that O
this O
actor O
has O
the O
tradecraft O
abilities O
and O
resources O
to O
remain O
a O
credible O
threat O
in O
at O
least O
the O
mid- O
term O
. O

by O
John O
Scott-Railton O
and O
Seth O
Hardy O
With O
the O
collaboration O
of O
Cyber O
Arabs O
. O

Media O
coverage O
: O
Associated O
Press O
, O
Forbes O
This O
report O
describes O
a O
malware O
attack O
with O
circumstantial O
links O
to O
the O
Islamic O
State O
in O
Iraq O
and O
Syria O
. O

In O
the O
interest O
of O
highlighting O
a O
developing O
threat O
, O
this O
post O
analyzes O
the O
attack O
and O
provides O
a O
list O
of O
Indicators O
of O
Compromise O
. O

A O
Syrian O
citizen O
media O
group O
critical O
of O
Islamic O
State O
of O
Iraq O
and O
Syria O
( O
ISIS O
) O
was O
recently O
targeted O
in O
a O
customized O
digital O
attack O
designed O
to O
unmask O
their O
location O
. O

The O
Syrian O
group O
, O
Raqqah O
is O
being O
Slaughtered O
Silently O
( O
RSS O
) O
, O
focuses O
its O
advocacy O
on O
documenting O
human O
rights O
abuses O
by O
ISIS O
elements O
occupying O
the O
city O
of O
Ar- O
Raqah O
. O

In O
response O
, O
ISIS O
forces O
in O
the O
city O
have O
reportedly O
targeted O
the O
group O
with O
house O
raids O
, O
kidnappings O
, O
and O
an O
alleged O
assassination O
. O

The O
group O
also O
faces O
online O
threats O
from O
ISIS O
and O
its O
supporters O
, O
including O
taunts O
that O
ISIS O
is O
spying O
on O
the O
group O
. O

Though O
we O
are O
unable O
to O
conclusively O
attribute O
the O
attack O
to O
ISIS O
or O
its O
supporters O
, O
a O
link O
to O
ISIS O
is O
plausible O
. O

The O
malware O
used O
in O
the O
attack O
differs O
substantially O
from O
campaigns O
linked O
to O
the O
Syrian O
regime O
, O
and O
the O
attack O
is O
focused O
against O
a O
group O
that O
is O
an O
active O
target O
of O
ISIS O
forces O
. O

As O
the O
Syrian O
Civil O
War O
continues O
, O
Syrian O
citizen O
journalists O
and O
nonviolent O
activists O
operate O
in O
an O
increasingly O
unsafe O
environment O
. O

The O
regime O
has O
never O
welcomed O
their O
work O
, O
and O
has O
often O
targeted O
them O
for O
arrest O
and O
detention O
, O
and O
a O
multi-year O
hacking O
campaign O
( O
see O
Pro-Regime O
/ O
Regime O
Linked O
Groups O
) O
. O

Additionally O
, O
not O
all O
elements O
of O
the O
Syrian O
opposition O
have O
uniformly O
supported O
nonviolent O
activists O
and O
citizen O
journalists O
. O

More O
recently O
, O
in O
areas O
like O
Raqqah O
, O
nonviolent O
activists O
face O
a O
new O
and O
exceptionally O
grave O
threat O
: O
ISIS O
. O

A O
growing O
number O
of O
reports O
suggest O
that O
ISIS O
is O
systematically O
targeting O
groups O
that O
document O
atrocities O
, O
or O
that O
communicate O
with O
Western O
media O
and O
aid O
organizations O
, O
sometimes O
under O
the O
pretext O
of O
finding O
'' O
spies O
'' O
. O

Ar-Raqqah O
, O
the O
city O
in O
which O
the O
case O
study O
is O
located O
, O
is O
situated O
in O
northern O
Syria O
and O
continues O
to O
be O
a O
key O
conflict O
flashpoint O
of O
the O
Syrian O
Civil O
War O
. O

In O
the O
spring O
of O
2013 O
, O
Islamists O
and O
Free O
Syrian O
Army O
( O
FSA O
) O
fighters O
took O
over O
Ar- O
Raqqah O
from O
regime O
forces O
. O

As O
ISIS O
gained O
momentum O
, O
they O
consolidated O
their O
control O
over O
the O
city O
, O
edging O
out O
FSA- O
affiliated O
groups O
through O
attacks O
, O
summary O
executions O
, O
and O
kidnappings O
against O
a O
range O
of O
groups O
, O
including O
ethnic O
and O
religious O
minorities O
. O

During O
2014 O
, O
there O
were O
a O
number O
of O
reports-many O
unconfirmed-that O
ISIS O
confiscated O
smartphones O
and O
laptops O
from O
captured O
activists O
. O

According O
to O
Syrians O
who O
experienced O
these O
searches O
and O
spoke O
with O
one O
of O
the O
reports O
' O
authors O
, O
ISIS O
sometimes O
extracts O
data O
from O
confiscated O
smartphones O
and O
laptops O
to O
collect O
information O
about O
people O
and O
groups O
they O
are O
targeting O
, O
as O
well O
as O
to O
seek O
evidence O
of O
'' O
un-Islamic O
'' O
activities O
. O

As O
ISIS O
cements O
their O
control O
of O
Ar-Raqqah O
and O
other O
territories O
, O
reports O
have O
emerged O
recently O
( O
though O
not O
all O
of O
them O
confirmed O
) O
suggesting O
that O
elements O
within O
ISIS O
are O
growing O
increasingly O
sophisticated O
at O
imposing O
control O
and O
targeting O
opponents O
using O
digital O
methods O
. O

Reports O
about O
ISIS O
targeting O
Internet O
cafés O
have O
grown O
increasingly O
common O
, O
and O
in O
some O
cases O
reports O
point O
to O
the O
possible O
use O
of O
keyloggers O
as O
well O
as O
unspecified O
'' O
IP O
sniffers O
'' O
to O
track O
behaviour O
in O
Internet O
cafes O
. O

Nonviolent O
activists O
and O
citizen O
journalists O
based O
in O
Ar-Raqqah O
have O
provided O
the O
outside O
world O
with O
much O
of O
what O
we O
know O
about O
how O
ISIS O
treats O
the O
population O
. O

These O
activists O
and O
journalists O
face O
mortal O
danger O
for O
their O
actions O
, O
and O
reports O
have O
emerged O
of O
their O
detention O
and O
torture O
at O
the O
hands O
of O
ISIS O
. O

As O
ISIS O
continues O
to O
use O
social O
media O
to O
push O
the O
message O
that O
it O
is O
welcomed O
by O
the O
population O
of O
Ar-Raqqah O
, O
groups O
like O
Raqqah O
is O
being O
Slaughtered O
Silently O
( O
RSS O
) O
provide O
a O
compelling O
counter O
narrative O
. O

RSS O
has O
n't O
escaped O
ISIS O
' O
notice O
, O
and O
the O
group O
has O
been O
targeted O
for O
kidnappings O
, O
house O
raids O
, O
and O
at O
least O
one O
alleged O
targeted O
killing O
. O

At O
the O
time O
of O
writing O
, O
ISIS O
is O
allegedly O
holding O
several O
citizen O
journalists O
in O
Ar-Raqqah O
. O

In O
addition O
, O
RSS O
is O
targeted O
online O
by O
ISIS O
supporters O
with O
harassment O
, O
including O
threats O
to O
the O
physical O
safety O
of O
its O
members O
. O

For O
example O
, O
ISIS O
supporters O
have O
claimed O
that O
ISIS O
has O
established O
a O
system O
of O
CCTV O
cameras O
in O
Ar-Raqqah O
to O
observe O
residents O
' O
movements O
. O

While O
this O
claim O
may O
be O
a O
bluff O
or O
exaggeration O
, O
at O
least O
one O
ISIS O
supporter O
has O
indicated O
on O
social O
media O
that O
this O
system O
could O
be O
used O
to O
look O
for O
members O
of O
RSS O
. O

This O
section O
describes O
a B-Entity
highly I-Entity
targeted I-Entity
attack I-Entity
sent B-Action
to B-Modifier
an B-Entity
e-mail I-Entity
address I-Entity
belonging I-Entity
to I-Entity
RSS I-Entity
. O

The O
Citizen O
Lab O
analyzed O
this O
attack O
with O
the O
consent O
of O
RSS O
, O
which O
requested O
that O
their O
name O
be O
used O
in O
this O
report O
. O

The B-Entity
attack I-Entity
took B-Action
the B-Entity
form I-Entity
of I-Entity
an I-Entity
unsolicited I-Entity
e-mail I-Entity
containing I-Entity
a I-Entity
download I-Entity
link I-Entity
to I-Entity
a I-Entity
decoy I-Entity
file I-Entity
. O

The O
file O
contained O
custom B-Entity
malware I-Entity
that O
profiled B-Action
the B-Entity
victim I-Entity
's I-Entity
computer I-Entity
and O
beaconed B-Action
its B-Entity
IP I-Entity
address I-Entity
to B-Modifier
an B-Entity
e-mail I-Entity
account I-Entity
under I-Entity
the I-Entity
attacker I-Entity
's I-Entity
control I-Entity
. O

The B-Entity
unsolicited I-Entity
message I-Entity
below I-Entity
was B-Action
sent I-Action
to B-Modifier
RSS B-Entity
at B-Modifier
the B-Entity
end I-Entity
of I-Entity
November I-Entity
2014 I-Entity
from B-Modifier
a B-Entity
Gmail I-Entity
email I-Entity
address I-Entity
. O

The O
message O
was O
carefully O
worded O
, O
and O
contained O
references O
specific O
to O
the O
work O
and O
interests O
of O
RSS O
. O

Thank O
you O
for O
your O
efforts O
to O
deliver O
a O
true O
picture O
of O
the O
reality O
of O
life O
in O
Raqqah O
. O

As O
Syrians O
residing O
in O
Canada O
we O
are O
working O
with O
media O
because O
we O
believe O
in O
the O
importance O
of O
shedding O
light O
on O
the O
realities O
of O
life O
in O
Syria O
, O
and O
Raqqah O
in O
particular O
. O

We O
are O
preparing O
a O
lengthy O
news O
report O
on O
the O
realities O
of O
life O
in O
Raqqah O
. O

We O
are O
sharing O
some O
information O
with O
you O
with O
the O
hope O
that O
you O
will O
correct O
it O
in O
case O
it O
contains O
errors O
. O

We O
have O
prepared O
a O
map O
of O
the O
city O
of O
Raqqah O
, O
in O
addition O
to O
a O
preliminary O
report O
. O

We O
hope O
that O
you O
have O
a O
look O
at O
it O
with O
them O
and O
inform O
us O
of O
any O
errors O
. O

We O
also O
hope O
that O
if O
you O
happen O
to O
be O
on O
Facebook O
, O
you O
could O
provide O
us O
with O
the O
account O
of O
the O
person O
responsible O
for O
the O
campaign O
, O
if O
you O
do O
n't O
mind O
, O
so O
that O
we O
can O
communicate O
with O
him O
directly O
. O

You O
can O
see O
a O
preliminary O
copy O
of O
the O
report O
on O
this O
linkhttp O
: O
//tempsend O
[ O
DOT O
] O
com/ O
[ O
Redacted O
] O
With O
all O
respect O
[ O
Name O
Redacted O
] O
We O
are O
unsure O
why O
the O
attacker O
specifically O
mentions O
Canada O
in O
the O
email O
lure O
. O

However O
, O
it O
is O
well O
known O
that O
Syria's O
extensive O
diaspora O
( O
including O
in O
Canada O
) O
regularly O
engages O
in O
advocacy O
, O
sometimes O
in O
coordination O
with O
groups O
within O
Syria O
. O

Thus O
, O
the O
message O
is O
not O
on O
its O
face O
implausible O
. O

However O
, O
we O
note O
that O
the B-Entity
attacker I-Entity
also O
attempts O
to O
social B-Action
engineer I-Action
the B-Entity
identity I-Entity
of I-Entity
individuals I-Entity
working I-Entity
with I-Entity
RSS I-Entity
, O
by O
requesting O
a O
personal O
Facebook O
page O
. O

The B-Entity
custom I-Entity
malware I-Entity
used I-Entity
in I-Entity
this I-Entity
attack I-Entity
infects B-Action
a B-Entity
user I-Entity
who I-Entity
views I-Entity
the I-Entity
decoy I-Entity
'' I-Entity
slideshow I-Entity
, I-Entity
'' I-Entity
and O
beacons B-Action
home B-Entity
with B-Modifier
the B-Entity
IP I-Entity
address I-Entity
of I-Entity
the I-Entity
victim I-Entity
's I-Entity
computer I-Entity
and O
details B-Entity
about I-Entity
his I-Entity
or I-Entity
her I-Entity
system I-Entity
each B-Modifier
time B-Entity
the I-Entity
computer I-Entity
restarts I-Entity
. O

Unlike O
Syrian O
regime-linked O
malware O
, O
it O
contains O
no O
Remote O
Access O
Trojan O
( O
RAT O
) O
functionality O
, O
suggesting O
it B-Entity
is O
intended O
for O
identifying B-Action
and I-Action
locating I-Action
a B-Entity
target I-Entity
. O

Further O
, O
because O
the B-Entity
malware I-Entity
sends B-Action
data B-Entity
captured I-Entity
by I-Entity
the I-Entity
malware I-Entity
to B-Modifier
an B-Entity
e-mail I-Entity
address I-Entity
, O
it O
does O
not O
require O
that O
the O
attackers O
maintain O
a O
command-and-control O
server O
online O
. O

This O
functionality O
would O
be O
especially O
useful O
to O
an O
adversary O
unsure O
of O
whether O
it O
can O
maintain O
uninterrupted O
Internet O
connectivity O
. O

Accessing O
the O
link O
provided O
in O
the O
malicious O
e-mail O
sends O
the O
user O
to O
a O
.zip O

file O
hosted O
on O
file-sharing O
site O
tempsend.com O
. O

At O
the O
time O
of O
writing O
the O
file O
had O
been O
downloaded O
only O
10 O
times O
This O
file O
is O
a O
self-extracting O
archive O
with O
an O
icon O
intended O
to O
suggest O
to O
the O
victim O
that O
it O
is O
itself O
a O
slideshow O
. O

When O
run O
, O
the O
file O
opens O
a O
slideshow O
of O
Google O
Earth O
screen O
captures O
to O
the O
victim O
, O
displaying O
a O
series O
of O
locations O
in O
Syria O
, O
and O
highlighting O
an O
'' O
ISIS O
HQ O
'' O
and O
other O
images O
showing O
the O
alleged O
locations O
of O
US O
airstrikes O
. O

Examples O
of O
images O
in O
the O
slideshow O
as O
follows O
: O
When B-Modifier
opened B-Entity
, O
the B-Entity
'' I-Entity
slideshow.zip I-Entity
'' I-Entity
file I-Entity
writes B-Action
and O
executes B-Action
several B-Entity
files I-Entity
: O
'' O
AdobeR1.exe O
'' O
is O
malicious O
, O
while O
'' O
pictures.exe O
'' O
is O
the O
genuine O
slideshow O
displayed O
to O
the O
victim O
. O

When B-Modifier
the B-Entity
slideshow I-Entity
is I-Entity
closed I-Entity
both B-Entity
AdobeR1.exe I-Entity
and I-Entity
pictures.exe I-Entity
are B-Action
deleted I-Action
. O

The B-Entity
AdobeR1 I-Entity
file I-Entity
writes B-Action
a B-Entity
series I-Entity
of I-Entity
executable I-Entity
files I-Entity
that O
perform B-Action
information B-Entity
collection I-Entity
and O
communication B-Entity
functions O
, O
including O
: O
The B-Entity
program I-Entity
sequence I-Entity
of I-Entity
data I-Entity
collection I-Entity
and I-Entity
sending I-Entity
is B-Action
somewhat B-Entity
unusual I-Entity
, O
with O
each O
program O
performing O
a O
single O
task O
and O
communicating O
via O
markers B-Entity
left B-Action
in B-Modifier
the B-Entity
registry I-Entity
. O

Programs O
appear O
to O
make O
use O
of O
the O
Visual O
C++ O
Runtime O
Library O
. O

First O
, O
the B-Entity
program I-Entity
nvidrv I-Entity
adds B-Action
itself B-Entity
to B-Modifier
autorun B-Entity
: O
It B-Entity
also O
creates B-Action
a B-Entity
series I-Entity
of I-Entity
registry I-Entity
keys I-Entity
that I-Entity
the I-Entity
individual I-Entity
programs I-Entity
use I-Entity
to I-Entity
communicate I-Entity
: O
Registry B-Entity
keys I-Entity
and O
programs B-Entity
using B-Action
them B-Entity
: O
It B-Entity
then O
runs B-Action
GooglUpd B-Entity
, O
which O
cleans B-Action
up I-Action
the B-Entity
program I-Entity
files I-Entity
if B-Modifier
they B-Entity
exist I-Entity
, O
and O
runs B-Action
AdbrRader B-Entity
. O

AdbrRader B-Entity
( O
communicating O
through O
registry O
key O
'' O
2 O
'' O
) O
writes B-Action
the B-Entity
file I-Entity
vgadmysadm.tmp I-Entity
with I-Entity
the I-Entity
name I-Entity
of I-Entity
another I-Entity
registry I-Entity
key I-Entity
'' I-Entity
2 I-Entity
'' I-Entity
with B-Modifier
startup B-Entity
info I-Entity
. O

Next O
, O
nvidrv O
runs O
GoogleUpate O
, O
which O
collects O
system O
information O
and O
writes O
it O
to O
: O
Then O
nvidrv O
runs O
nvisdvr O
( O
registry O
key O
'' O
4 O
'' O
) O
that O
collects O
a O
list O
of O
running O
processes O
, O
which O
are O
written O
to O
: O
Finally O
, O
nvidrv B-Entity
runs B-Action
svhosts B-Entity
, O
which O
tests B-Action
Internet B-Entity
connectivity I-Entity
by O
doing B-Action
a B-Entity
DNS I-Entity
query I-Entity
for I-Entity
windowsupdate.microsoft.com I-Entity
. O

It B-Entity
then O
runs B-Action
rundl132 B-Entity
if B-Modifier
it B-Entity
has I-Entity
not I-Entity
before I-Entity
, O
by O
checking B-Action
whether B-Entity
registry I-Entity
key I-Entity
name I-Entity
'' I-Entity
6 I-Entity
'' I-Entity
is I-Entity
present I-Entity
. O

It B-Entity
sets B-Action
the B-Entity
key I-Entity
to B-Modifier
'' B-Entity
0 I-Entity
'' I-Entity
and O
runs B-Action
it B-Entity
. O

Next O
, O
'' B-Entity
rundl132.exe I-Entity
'' I-Entity
performs B-Action
an B-Entity
HTTP I-Entity
GET I-Entity
request I-Entity
to B-Modifier
myexternalip.com B-Entity
and O
collects B-Action
the B-Entity
external I-Entity
IP I-Entity
of I-Entity
the I-Entity
infected I-Entity
machine I-Entity
: O
Next O
, O
rundl132 O
writes O
: O
Then O
rundl132 B-Entity
writes B-Action
the B-Entity
external I-Entity
IP I-Entity
to O
: O
Finally O
, O
rundl132 B-Entity
runs B-Action
AdobeIns B-Entity
, O
which O
zips B-Action
the B-Entity
contents I-Entity
of I-Entity
the I-Entity
win32.tmp I-Entity
folder I-Entity
. O

Program B-Entity
'' I-Entity
AdobeIns.exe I-Entity
'' I-Entity
takes O
the O
files O
written O
by O
the O
other O
programs O
and O
zips B-Action
them B-Entity
in B-Modifier
an B-Entity
encrypted I-Entity
, I-Entity
password- I-Entity
protected I-Entity
file I-Entity
: O
Data B-Entity
is B-Action
transmitted I-Action
by B-Modifier
e-mail B-Entity
to B-Modifier
an B-Entity
account I-Entity
presumably I-Entity
controlled I-Entity
by I-Entity
the I-Entity
attacker I-Entity
. O

AdobeIns B-Entity
connects B-Action
to B-Modifier
an B-Entity
account I-Entity
at B-Modifier
the B-Entity
online I-Entity
e-mail I-Entity
provider I-Entity
inbox.com I-Entity
via B-Modifier
smtp B-Entity
using B-Modifier
hardcoded B-Entity
credentials I-Entity
. O

The B-Entity
malware I-Entity
then O
sends B-Action
an B-Entity
e-mail I-Entity
to B-Modifier
the B-Entity
same I-Entity
inbox I-Entity
containing O
the O
text O
'' O
Hello O
'' O
and O
with O
mxtd O
file O
attached O
. O

SMTP O
traffic O
generated O
by O
the O
malware O
to O
inbox.com O
( O
with O
redactions O
) O
The O
malware O
seen O
in O
this O
case O
study O
is O
unusual O
as O
it O
relies O
on O
a O
half-dozen O
separate O
executable O
files O
, O
each O
with O
a O
single O
task O
, O
and O
each O
communicating O
via O
markers B-Entity
dropped B-Action
in B-Modifier
the B-Entity
Registry I-Entity
. O

The B-Entity
malware I-Entity
is O
also O
interesting O
because O
it O
does O
not O
provide O
remote O
access O
, O
but O
only O
sends B-Action
an B-Entity
e-mail I-Entity
containing I-Entity
the I-Entity
victim I-Entity
's I-Entity
IP I-Entity
address I-Entity
and I-Entity
miscellaneous I-Entity
system I-Entity
information I-Entity
. O

The B-Entity
malware I-Entity
resends B-Action
the B-Entity
information I-Entity
each B-Modifier
time B-Entity
the I-Entity
computer I-Entity
is I-Entity
restarted I-Entity
, O
but O
it O
does O
not O
refresh O
the O
sent O
information O
on O
restart O
( O
which O
may O
be O
a O
bug O
) O
. O

This O
behaviour O
strongly O
suggests O
that O
the O
function O
of O
this B-Entity
malware I-Entity
is O
to O
serve B-Action
as B-Modifier
a B-Entity
beacon I-Entity
. O

The O
system O
information O
could O
be O
used O
to O
identify O
processes O
to O
exploit O
in O
the O
future O
, O
however O
since O
the B-Entity
attacker I-Entity
has O
already O
triggered B-Action
the B-Entity
execution I-Entity
of I-Entity
a I-Entity
file I-Entity
on I-Entity
the I-Entity
victim I-Entity
's I-Entity
system I-Entity
, O
it O
is O
surprising O
that O
more O
was O
not O
taken O
, O
or O
that O
a O
RAT O
( O
custom O
or O
widely O
available O
) O
was O
not O
used O
. O

A O
RAT O
would O
have O
provided O
much O
greater O
access O
alongside O
IP O
information O
By O
not O
providing O
remote O
access O
and O
other O
RAT O
functionality O
, O
the B-Entity
program I-Entity
looks B-Action
less B-Entity
like I-Entity
malware I-Entity
, O
and O
may O
attract B-Action
less B-Entity
attention I-Entity
from O
endpoint O
protection O
tools O
and O
scanners O
. O

Detections O
were O
low O
when O
the O
file O
was O
first O
submitted O
to O
VirusTotal O
, O
for O
example O
. O

It B-Entity
registered B-Action
only B-Entity
6/55 I-Entity
detections I-Entity
by I-Entity
anti I-Entity
virus I-Entity
scanners I-Entity
, I-Entity
or I-Entity
a I-Entity
10 I-Entity
% I-Entity
detection I-Entity
rate I-Entity
. O

Transmitting B-Action
the B-Entity
malware I-Entity
via B-Modifier
e-mail B-Entity
also O
provides O
a O
degree O
of O
obscurity O
, O
and O
has O
the O
additional O
advantage O
of O
providing O
a O
layer O
of O
abstraction O
between O
the O
attacker O
and O
the O
target O
: O
there O
is O
no O
need O
to O
maintain O
a O
RAT O
command-and-control O
server O
. O

The B-Entity
malware I-Entity
transmits B-Action
autonomously O
, O
leaving B-Action
the B-Entity
material I-Entity
in B-Modifier
an B-Entity
inbox I-Entity
for B-Modifier
the B-Entity
attacker I-Entity
to I-Entity
collect I-Entity
at I-Entity
a I-Entity
later I-Entity
time I-Entity
. O

The O
malware O
has O
no O
obfuscation O
processes O
and O
is O
not O
highly O
technical O
in O
its O
development O
or O
interaction O
with O
Windows O
. O

Nevertheless O
, O
we O
believe O
that O
the O
author O
of O
the O
program O
is O
aware O
of O
certain O
techniques O
to O
reduce B-Action
the B-Entity
visibility I-Entity
of I-Entity
malware I-Entity
on I-Entity
a I-Entity
network I-Entity
, O
including O
transmitting B-Action
data B-Entity
via B-Modifier
encrypted B-Entity
e-mail I-Entity
communications I-Entity
. O

However O
, O
the O
attacker O
has O
not O
correctly O
implemented O
encrypted O
e-mail O
: O
the O
malware O
will O
not O
attempt O
to O
use O
a O
TLS O
connection O
in O
certain O
cases O
. O

As O
a O
result O
, O
account O
login O
credentials O
may O
be O
readily O
available O
in O
network O
traffic O
. O

In O
addition O
, O
the B-Entity
malware I-Entity
uses B-Action
the B-Entity
old I-Entity
PKWARE I-Entity
implementation I-Entity
of I-Entity
zip I-Entity
encryption I-Entity
, O
which O
is O
not O
particularly O
secure O
. O

The O
password O
for O
the O
zipped O
file O
is O
also O
present O
in O
the O
binary O
without O
encryption O
or O
obfuscation O
. O

Citizen O
Lab O
researchers O
have O
developed O
the O
Targeted O
Threat O
Index O
( O
TTI O
) O
as O
a O
tool O
to O
standardize O
information O
about O
the O
sophistication O
of O
targeted O
threats O
against O
civil O
society O
groups O
in O
our O
research O
. O

The O
index O
captures O
information O
about O
the O
level O
of O
social O
engineering O
used O
( O
'' O
Targeting O
Sophistication O
'' O
) O
, O
and O
adds O
a O
Technical O
Sophistication O
value O
for O
the O
attack O
as O
a O
multiplier O
. O

This B-Entity
attack I-Entity
, O
which O
has O
little O
technical O
sophistication O
( O
i.e. O
, O
it O
uses O
no O
exploits O
, O
code O
obfuscation O
, O
or O
techniques O
to O
frustrate O
reversing O
, O
etc O
. O

) O
, O
nevertheless O
has O
carefully O
developed B-Action
social B-Entity
engineering I-Entity
in B-Modifier
the B-Entity
seeding I-Entity
materials I-Entity
and I-Entity
bait I-Entity
document I-Entity
. O

Taken O
together O
it O
rates O
a O
3 O
for O
Targeting O
Sophistication O
and O
a O
1.25 O
for O
Technical O
Sophistication O
by O
our O
metric O
, O
yielding O
a O
TTI O
score O
of O
3.75 O
. O

Citizen O
Lab O
research O
using O
the O
TTI O
has O
found O
that O
, O
despite O
low O
levels O
of O
technical O
sophistication O
, O
with O
well-crafted O
social O
engineering O
malware O
attacks O
remain O
highly O
effective O
against O
civil O
society O
groups O
. O

More O
information O
is O
available O
about O
the O
TTI O
in O
a O
recent O
Usenix O
Security O
paper O
. O

There O
are O
at O
least O
three O
possible O
sources O
for O
this O
malware O
attack O
: O
We O
evaluate O
each O
of O
these O
possibilities O
in O
turn O
, O
drawing O
on O
the O
information O
available O
to O
us O
after O
almost O
three O
years O
of O
tracking O
regime-linked O
malware O
. O

Pro-regime O
malware O
actors O
have O
continually O
targeted O
the O
Syrian O
opposition O
with O
waves O
of O
malware O
since O
at O
least O
late O
2011 O
. O

Those O
campaigns O
have O
been O
extensively O
reported O
on O
by O
a O
range O
of O
groups O
, O
including O
Kaspersky O
, O
FireEye O
, O
Citizen O
Lab O
, O
the O
Electronic O
Frontier O
Foundation O
, O
and O
many O
others O
. O

Regime-linked O
malware O
has O
a O
number O
of O
common O
features O
that O
typically O
serve O
as O
distinguishing O
characteristics O
: O
Social O
engineering O
focusing O
on O
the O
needs O
and O
interests O
of O
the O
opposition O
. O

Although O
targeted O
, O
the B-Entity
malware I-Entity
seeding I-Entity
often O
aims B-Action
at B-Modifier
classes B-Entity
of I-Entity
people I-Entity
( O
e.g. O
, O
people O
interested O
in O
'shocking O
' O
news O
about O
a O
fighter O
, O
or O
'leaked O
' O
information O
about O
the O
Assad O
regime O
) O
rather O
than O
carefully O
written O
spear O
phishing O
targeting O
a O
single O
individual O
or O
small O
group O
. O

Use B-Action
of O
widely B-Entity
available I-Entity
RATs I-Entity
( O
njRAT O
, O
Xtreme O
Rat O
, O
ShadowTech O
Rat O
, O
DarkComet O
RAT O
, O
and O
Blackshades O
RAT O
, O
among O
others O
) O
. O

At B-Entity
least I-Entity
one I-Entity
command-and-control I-Entity
server I-Entity
located B-Action
within B-Modifier
Syrian B-Entity
IP I-Entity
space I-Entity
( O
often O
from O
a O
limited O
range O
of O
addresses O
) O
. O

Frequent O
use O
of O
Dynamic O
DNS O
providers O
like O
no-ip O
. O

Use B-Action
of O
'' B-Entity
crypters I-Entity
'' I-Entity
to B-Modifier
obscure B-Entity
the I-Entity
binary I-Entity
. O

These O
characteristics O
are O
not O
all O
present O
in O
every O
sample O
, O
but O
we O
have O
typically O
found O
one O
or O
more O
in O
almost O
every O
binary O
we O
have O
examined O
that O
is O
Syrian O
regime-linked O
. O

This O
malware O
attack O
differs O
from O
known O
regime-linked O
groups O
in O
each O
of O
these O
elements O
. O

Not O
only O
is B-Action
it B-Entity
exceptionally B-Entity
targeted I-Entity
, O
but O
it O
is O
also O
not O
a O
commonly O
available O
RAT O
. O

Nor O
does O
it O
have O
RAT O
functionality O
. O

The O
function O
of O
the B-Entity
malware I-Entity
appears O
to O
be O
: O
identify B-Action
and I-Action
unmask I-Action
the B-Entity
IP I-Entity
address I-Entity
of I-Entity
target I-Entity
( I-Entity
s I-Entity
) I-Entity
, O
and O
resend B-Action
them B-Entity
to B-Modifier
the B-Entity
attacker I-Entity
with B-Modifier
each I-Modifier
reboot B-Entity
. O

In O
addition O
, O
data B-Entity
is B-Action
sent I-Action
to B-Modifier
an B-Entity
Internet I-Entity
e-mail I-Entity
address I-Entity
, O
and O
no O
crypter O
is O
used O
to O
obscure O
the O
binary O
. O

We O
are O
aware O
of O
only O
one O
previous O
case O
in O
Syria O
in O
which O
e-mail B-Entity
was B-Action
used I-Action
to B-Modifier
transmit B-Entity
data I-Entity
, O
and O
that O
we O
believed O
was O
regime O
linked O
. O

That O
incident O
, O
observed O
in O
2012 O
, O
also O
used B-Action
hardcoded B-Entity
e-mail I-Entity
to B-Modifier
exfiltrate B-Entity
. O

However O
, O
that O
malware O
had O
substantially O
more O
functionality O
than O
this O
case O
: O
not O
only O
did O
it B-Entity
drop B-Action
a B-Entity
second I-Entity
stage I-Entity
from B-Modifier
a B-Entity
compromised I-Entity
site I-Entity
, O
but O
was O
also O
included O
a O
mechanism O
for O
exfiltrating B-Action
credentials B-Entity
from I-Entity
Facebook I-Entity
and I-Entity
hooking I-Entity
programs I-Entity
like I-Entity
Skype I-Entity
. O

The O
lack O
of O
overlap O
in O
Tactics O
, O
Techniques O
, O
and O
Procedures O
( O
TTPs O
) O
between O
this O
attack O
and O
prior O
attacks O
does O
not O
rule O
out O
Syrian O
regime-linked O
attackers O
. O

It O
is O
possible O
that O
regime-linked O
groups O
are O
trying O
a O
new O
approach O
. O

However O
, O
given O
that O
known O
regime-linked O
groups O
continued O
to O
remain O
active O
during O
the O
same O
date O
range O
using O
familiar O
TTPs O
, O
this O
scenario O
seems O
unlikely O
. O

In O
addition O
, O
it O
would O
be O
strange O
for O
regime-linked O
malware O
groups O
to O
undertake O
significant O
effort O
to O
prepare O
and O
send O
an O
implant O
that O
has O
significantly O
less O
functionality O
than O
what O
they O
commonly O
use O
. O

Taken O
together O
, O
we O
find O
this O
evidence O
supports O
the O
hypothesis O
that O
familiar O
regime-linked O
groups O
did O
not O
conduct O
the O
attack O
. O

RSS O
operates O
in O
territory O
controlled O
by O
ISIS O
, O
and O
has O
faced O
extensive O
targeting O
by O
ISIS O
. O

Currently O
, O
they O
appear O
to O
be O
directly O
targeted O
by O
ISIS O
for O
kidnappings O
and O
other O
retaliation O
, O
including O
executions O
. O

In O
addition O
, O
ISIS O
supporters O
have O
explicitly O
suggested O
that O
the O
group O
is O
under O
surveillance O
and O
actively O
hunted O
. O

Together O
this O
evidence O
suggests O
that O
ISIS O
has O
a O
strong O
motivation O
for O
using O
social O
engineering O
and/or O
malware O
to O
locate O
the O
members O
of O
RSS O
. O

We O
think O
there O
are O
several O
features O
of O
the O
malware O
attack O
that O
align O
with O
the O
needs O
and O
constraints O
of O
ISIS O
and O
its O
supporters O
in O
Ar-Raqqah O
, O
more O
so O
than O
other O
groups O
, O
as O
we O
understand O
them O
. O

For O
example O
: O
The B-Entity
malware I-Entity
beacons B-Action
location B-Entity
but O
does O
not O
provide O
RAT O
functionality O
. O

The B-Entity
seeding I-Entity
attempts O
to O
obtain B-Action
a B-Entity
'private I-Entity
' I-Entity
Facebook I-Entity
identity I-Entity
from B-Modifier
RSS B-Entity
through B-Modifier
social B-Entity
engineering I-Entity
. O

The B-Entity
malware I-Entity
exfiltrates B-Action
to B-Modifier
an B-Entity
online I-Entity
e-mail I-Entity
account I-Entity
, O
thus O
not O
requiring O
the O
attacker O
to O
maintain O
a O
command-and- O
control O
server O
online O
. O

The O
social O
media O
activity O
of O
members O
of O
RSS O
is O
often O
highly O
public O
. O

Their O
location O
and O
exact O
membership O
, O
however O
, O
is O
secret O
. O

We O
speculate O
that O
if O
an O
attacker O
were O
interested O
in O
maintaining O
long-term O
surveillance O
of O
the O
activities O
of O
RSS O
they O
could O
have O
employed O
a O
RAT O
. O

However O
, O
if O
the O
attacker O
were O
interested O
in O
unmasking O
the O
location O
of O
its O
targets O
so O
they O
could O
be O
physically O
tracked O
down O
, O
collecting O
IP O
data O
and O
system O
info O
would O
be O
a O
more O
reasonable O
approach O
. O

ISIS O
or O
its O
supporters O
clearly O
have O
a O
strong O
interest O
in O
the O
( O
rudimentary O
) O
location O
tracking O
of O
the O
members O
of O
RSS O
that O
this O
malware O
provides O
. O

Internet O
connectivity O
in O
Raqqah O
is O
extremely O
limited O
, O
and O
some O
of O
it O
is O
under O
ISIS O
control O
. O

Knowing O
the O
IP O
address O
of O
a O
target O
could O
quickly O
narrow O
down O
targets O
to O
specific O
locations O
, O
and O
specific O
Internet O
services O
, O
or O
Internet O
cafes O
in O
Raqqah O
. O

Given O
that O
the O
identities O
and O
locations O
of O
RSS O
members O
are O
closely O
guarded O
, O
such O
information O
would O
hold O
significant O
intelligence O
value O
for O
ISIS O
. O

Armed O
with O
this O
kind O
of O
information O
, O
ISIS O
could O
physically O
harm O
people O
within O
Raqqah O
( O
and O
it O
is O
also O
possible O
that O
they O
have O
the O
ability O
to O
operate O
in O
some O
capacity O
in O
border O
areas O
of O
Turkey O
) O
. O

Little O
is O
publicly O
known O
about O
the O
technical O
capabilities O
of O
ISIS O
and O
its O
supporters O
; O
however O
, O
reports O
have O
begun O
to O
emerge O
suggesting O
that O
ISIS O
is O
interested O
in O
expanding O
its O
abilities O
. O

In O
addition O
, O
ISIS O
has O
reportedly O
gained O
the O
support O
of O
at O
least O
one O
individual O
with O
some O
experience O
with O
social O
engineering O
and O
hacking O
: O
Junaid O
Hussain O
( O
aka O
TriCk O
) O
, O
a O
former O
member O
of O
teamp0ison O
hacking O
team O
. O

While O
Mr. O
Hussain O
and O
associates O
have O
reportedly O
made O
threats O
against O
Western O
governments O
, O
it O
is O
possible O
that O
he O
or O
others O
working O
with O
ISIS O
have O
quietly O
supported O
an O
effort O
to O
identify O
the O
targeted O
organization O
, O
which O
is O
a O
highly O
visible O
thorn O
in O
the O
side O
of O
ISIS O
. O

It O
is O
possible O
that O
the O
attack O
is O
the O
product O
of O
actors O
working O
for O
unknown O
purposes O
and O
targeting O
RSS O
. O

Given O
the O
activities O
of O
RSS O
, O
however O
, O
it O
is O
unclear O
who O
this O
might O
be O
. O

It O
is O
not O
possible O
, O
for O
example O
, O
to O
reject O
the O
theory O
that O
some O
unknown O
group O
within O
the O
FSA O
, O
or O
other O
groups O
opposing O
the O
Assad O
regime O
are O
responsible O
. O

Citizen O
journalists O
in O
Ar-Raqqah O
were O
previously O
critical O
of O
arbitrary O
arrests O
carried O
out O
by O
non-ISIS O
groups O
in O
2013 O
. O

However O
, O
it O
is O
unclear O
why O
those O
groups O
, O
which O
no O
longer O
control O
Ar-Raqqah O
, O
would O
be O
interested O
in O
RSS O
in O
November O
2014 O
. O

It O
is O
likely O
that O
third O
party O
actors O
, O
including O
several O
intelligence O
services O
, O
are O
closely O
monitoring O
various O
actors O
in O
the O
conflict O
through O
a O
range O
of O
electronic O
means O
. O

However O
, O
there O
is O
little O
reason O
to O
suggest O
that O
they O
would O
use O
a O
tailored O
but O
technically O
rudimentary O
attack O
to O
target O
RSS O
in O
particular O
. O

After O
considering O
each O
possibility O
, O
we O
find O
strong O
but O
inconclusive O
circumstantial O
evidence O
to O
support O
a O
link O
to O
ISIS O
. O

However O
, O
we O
are O
unable O
to O
connect O
this O
attack O
directly O
to O
ISIS O
, O
Mr. O
Hussain O
, O
or O
other O
ISIS O
supporters O
. O

If O
indeed O
ISIS O
or O
its O
supporters O
are O
responsible O
, O
it O
seems O
reasonable O
that O
such O
an O
offensive O
capability O
may O
still O
be O
in O
development O
. O

We O
hope O
that O
publishing O
this O
report O
will O
draw O
attention O
to O
a O
new O
and O
concerning O
threat O
that O
includes O
ISIS O
critics O
among O
its O
targets O
. O

If O
ISIS O
is O
responsible O
, O
while O
this O
attack O
targets O
in-country O
impediments O
to O
ISIS O
objectives O
, O
other O
targets O
may O
include O
ideological O
or O
military O
adversaries O
abroad O
. O

Whether O
or O
not O
ISIS O
is O
responsible O
, O
this O
attack O
is O
likely O
the O
work O
of O
a O
non-regime O
threat O
actor O
who O
may O
be O
just O
beginning O
to O
field O
a O
still-rudimentary O
capability O
in O
the O
Syrian O
conflict O
. O

The O
entry O
costs O
for O
engaging O
in O
malware O
attacks O
in O
a O
conflict O
like O
the O
Syrian O
Civil O
War O
are O
low O
, O
and O
made O
lower O
by O
the O
fact O
that O
the O
rule O
of O
law O
is O
nonexistent O
for O
large O
parts O
of O
the O
country O
. O

In O
still O
other O
parts O
( O
under O
regime O
control O
) O
, O
malware O
attacks O
appear O
to O
be O
state O
sanctioned O
. O

Citizen O
Lab O
research O
into O
targeted O
digital O
threats O
against O
civil O
society O
confirms O
that O
civil O
society O
groups O
face O
grave O
threats O
from O
targeted O
malware O
attacks O
, O
despite O
being O
under-resourced O
to O
defend O
against O
them O
. O

The O
case O
highlighted O
here O
is O
no O
exception O
: O
lack O
of O
IT O
and O
security O
resources O
have O
made O
it O
difficult O
for O
the O
Syrian O
opposition O
to O
address O
targeted O
and O
persistent O
digital O
threats O
against O
them O
. O

In O
addition O
, O
if O
ISIS O
is O
indeed O
responsible O
, O
this O
case O
suggests O
how O
easy O
it O
is O
for O
belligerents O
in O
a O
conflict O
to O
begin O
fielding O
basic O
offensive O
digital O
capabilities O
, O
and O
how O
quickly O
the O
capabilities O
can O
be O
pointed O
at O
unarmed O
civil O
society O
groups O
. O

This B-Entity
attack I-Entity
was B-Action
exceptionally I-Action
targeted I-Action
, O
and O
clearly O
reflected O
the O
work O
of O
an O
actor O
familiar O
with O
the O
operations O
of O
the O
targeted O
organization O
. O

As O
most O
organizations O
working O
on O
issues O
surrounding O
Syria O
are O
aware O
, O
malware O
delivered O
with O
good O
social O
engineering O
is O
a O
constant O
source O
of O
danger O
. O

This O
particular O
attack O
can O
be O
prevented O
by O
not O
opening O
files O
sent O
by O
unknown O
persons O
. O

However O
, O
many O
attacks O
in O
Syria O
come O
from O
hijacked O
accounts O
and O
impersonate O
people O
known O
to O
the O
targets O
. O

Social O
engineering O
remains O
an O
unsolved O
problem O
, O
and O
continues O
to O
compromise O
groups O
throughout O
the O
Syrian O
opposition O
and O
their O
supporters O
. O

This O
attack O
reaffirms O
the O
dangers O
posed O
by O
social O
engineering O
attacks O
, O
whether O
they O
deliver O
phishing O
campaigns O
or O
malware O
. O

The O
circumstantial O
evidence O
of O
ISIS O
involvement O
suggests O
that O
groups O
working O
on O
topics O
that O
ISIS O
considers O
a O
threat O
, O
and O
their O
partner O
organizations O
and O
supporters O
, O
should O
urgently O
examine O
their O
security O
policies O
and O
assess O
the O
possible O
risks O
to O
their O
operations O
, O
and O
the O
consequences O
of O
exposure O
of O
sensitive O
information O
to O
ISIS O
. O

Even O
if O
the O
link O
to O
ISIS O
turns O
out O
to O
be O
incorrect O
, O
it O
is O
possible O
that O
this O
will O
be O
a O
threat O
in O
the O
future O
. O

Individuals O
and O
groups O
at O
risk O
can O
also O
consult O
materials O
in O
Arabic O
provided O
by O
Cyber O
Arabs O
including O
a O
series O
of O
very O
accessible O
videos O
on O
digital O
security O
. O

The O
malware O
files O
Files O
dropped O
by O
the O
malware O
Collected O
Information O
Files O
( O
unencrypted O
) O
Exfiltrated O
file O
( O
encrypted O
) O
Registry O
Keys O
Acknowledgements O
: O
We O
are O
grateful O
to O
Cyber O
Arabs O
and O
the O
Institute O
for O
War O
and O
Peace O
Reporting O
for O
their O
critical O
work O
and O
assistance O
. O

Special O
thanks O
to O
: O
several O
anonymous O
Syrians O
, O
Masashi O
Crete-Nishihata O
, O
Sarah O
McKune O
, O
Morgan O
Marquis-Boire O
, O
Ron O
Deibert O
, O
Bill O
Marczak O
, O
Nart O
Villeneuve O
, O
Irene O
Poetranto O
, O
and O
Kristen O
Dennesen O
. O

Support O
for O
this O
research O
is O
provided O
by O
grants O
from O
the O
John O
D. O
and O
Catherine O
T. O
MacArthur O
Foundation O
and O
the O
Ford O
Foundation O
. O

We O
have O
written O
about O
NetTraveler O
before O
HERE O
and O
HERE O
. O

Earlier O
this O
year O
, O
we O
observed O
an O
uptick O
in O
the O
number O
of O
attacks O
against O
Uyghur O
and O
Tibetan O
supporters O
using O
an O
updated O
version O
of O
the O
NetTraveler O
backdoor O
. O

Here O
's O
an O
example O
of O
a B-Entity
targeted I-Entity
spear-phishing I-Entity
e-mail I-Entity
directed B-Action
at B-Modifier
Uyghur B-Entity
activists I-Entity
in B-Modifier
March B-Entity
2014 I-Entity
. O

The B-Entity
e-mail I-Entity
has B-Action
two B-Entity
attachments I-Entity
, I-Entity
a I-Entity
non-malicious I-Entity
JPG I-Entity
file I-Entity
and I-Entity
a I-Entity
373 I-Entity
KB I-Entity
Microsoft I-Entity
Word I-Entity
.DOC I-Entity
file I-Entity
. O

The O
.DOC O

file O
, O
which O
in O
reality O
is O
a O
'' O
Single O
File O
Web O
Page O
'' O
container O
, O
also O
known O
as O
'' O
Web O
archive O
file O
'' O
, O
appears O
to O
have O
been O
created O
on O
a O
system O
using O
Microsoft O
Office O
- O
Simplified O
Chinese O
. O

It O
contains O
an O
exploit O
for O
the O
CVE-2012-0158 O
vulnerability O
, O
detected O
by O
Kaspersky O
Lab O
products O
as O
Exploit.MSWord.CVE-2012-0158.db O
. O

If O
run O
on O
a O
vulnerable O
version O
of O
Microsoft O
Office O
, O
it B-Entity
drops B-Action
the B-Entity
main I-Entity
module I-Entity
as B-Modifier
'' B-Entity
net.exe I-Entity
'' I-Entity
( O
detected O
by O
Kaspersky O
Lab O
products O
as O
Trojan-Dropper.Win32.Agent.lifr O
) O
, O
which O
in O
turn O
installs B-Action
a B-Entity
number I-Entity
of I-Entity
other I-Entity
files I-Entity
. O

The B-Entity
main I-Entity
C I-Entity
& I-Entity
C I-Entity
module I-Entity
is B-Action
dumped I-Action
into B-Modifier
'' B-Entity
% I-Entity
SystemRoot I-Entity
% I-Entity
\system32\Windowsupdataney.dll I-Entity
'' I-Entity
, O
( O
detected O
by O
Kaspersky O
as O
Trojan- O
Spy.Win32.TravNet.qfr O
) O
. O

It B-Entity
is B-Action
registered I-Action
as B-Modifier
a B-Entity
service I-Entity
( I-Entity
named I-Entity
'' I-Entity
Windowsupdata I-Entity
'' I-Entity
) I-Entity
through B-Modifier
a B-Entity
Windows I-Entity
Batch I-Entity
file I-Entity
named I-Entity
'' I-Entity
DOT.BAT I-Entity
'' I-Entity
( O
detected O
by O
Kaspersky O
Lab O
products O
as O
Trojan.BAT.Tiny.b O
) O
: O
To O
make B-Action
sure B-Entity
the B-Entity
malware I-Entity
is I-Entity
n't I-Entity
running I-Entity
multiple I-Entity
times I-Entity
, O
it O
uses O
the O
mutex O
'' O
SD2013 O
Is O
Running O
! O
'' O
to O
mark O
its O
presence O
in O
the O
system O
. O

Other O
known O
mutexes O
used O
by O
older O
and O
current O
variants O
include O
: O
The B-Entity
malware I-Entity
configuration I-Entity
file I-Entity
is B-Action
written I-Action
to B-Modifier
the B-Entity
'' I-Entity
SYSTEM I-Entity
'' I-Entity
folder I-Entity
( I-Entity
as I-Entity
opposed I-Entity
to I-Entity
SYSTEM32 I-Entity
) I-Entity
and O
has O
a O
slightly O
new O
format O
compared O
to O
'' O
older O
'' O
NetTraveler O
samples O
: O
For O
the O
record O
, O
here O
's O
what O
an O
older O
NetTraveler O
config O
file O
looks O
like O
: O
Obviously O
, O
the B-Entity
developers I-Entity
behind I-Entity
NetTraveler I-Entity
have O
taken O
steps O
to O
try O
to O
hide B-Action
the B-Entity
malware I-Entity
's I-Entity
configuration I-Entity
. O

Luckily O
, O
the O
encryption O
is O
relatively O
simple O
to O
break O
. O

The O
algorithm O
is O
as O
follows O
: O
Once O
decrypted O
, O
the O
new O
config O
looks O
like O
this O
: O
One O
can O
easily O
see O
the B-Entity
command-and-control I-Entity
( I-Entity
C I-Entity
& I-Entity
C I-Entity
) I-Entity
server I-Entity
in O
the O
screenshot O
above O
, O
which O
is B-Action
'' B-Entity
uyghurinfo I-Entity
[ I-Entity
. I-Entity
] I-Entity
com I-Entity
'' I-Entity
. O

We O
identified O
several O
samples O
using O
this O
new O
encryption O
scheme O
. O

A O
list O
of O
all O
the O
extracted O
C O
& O
C O
servers O
can O
be O
found O
below O
: O
We O
recommend O
blocking O
all O
these O
hosts O
in O
your O
firewall O
. O

This O
year O
, O
the O
actors O
behind O
NetTraveler O
celebrate O
10 O
years O
of O
activity O
. O

Although O
the O
earliest O
samples O
we O
have O
seen O
appear O
to O
have O
been O
compiled O
in O
2005 O
, O
there O
are O
certain O
indicators O
that O
point O
to O
2004 O
as O
the O
year O
when O
their O
activity O
started O
. O

For O
10 O
years O
NetTraveler O
has O
been O
targeting O
various O
sectors O
, O
with O
a O
focus O
on O
diplomatic O
, O
government O
and O
military O
targets O
. O

Most O
recently O
, O
the O
main O
focus O
of O
interest O
for O
cyber-espionage O
activities O
revolved O
around O
space O
exploration O
, O
nano-technology O
, O
energy O
production O
, O
nuclear O
power O
, O
lasers O
, O
medicine O
and O
communications O
. O

The O
targeting O
of O
Uyghur O
and O
Tibetan O
activists O
remains O
a O
standard O
component O
of O
their O
activities O
and O
we O
can O
assume O
it O
will O
stay O
this O
way O
, O
perhaps O
for O
another O
10 O
years O
. O

Our O
clients O
often O
ask O
us O
to O
assess O
the O
threat O
Russia O
poses O
in O
cyberspace O
. O

Russia O
has O
long O
been O
a O
whispered O
frontrunner O
among O
capable O
nations O
for O
performing O
sophisticated O
network O
operations O
. O

This O
perception O
is O
due O
in O
part O
to O
the O
Russian O
government O
's O
alleged O
involvement O
in O
the O
cyber O
attacks O
accompanying O
its O
invasion O
of O
Georgia O
in O
2008 O
, O
as O
well O
as O
the O
rampant O
speculation O
that O
Moscow O
was O
behind O
a O
major O
U.S. O
Department O
of O
Defense O
network O
compromise O
, O
also O
in O
2008 O
. O

These O
rumored O
activities O
, O
combined O
with O
a O
dearth O
of O
hard O
evidence O
, O
have O
made O
Russia O
into O
something O
of O
a O
phantom O
in O
cyberspace O
. O

In O
this O
paper O
we O
discuss O
a O
threat O
group O
whose O
malware O
is O
already O
fairly O
well-known O
in O
the O
cybersecurity O
community O
. O

This O
group O
, O
unlike O
the O
China-based O
threat O
actors O
we O
track O
, O
does O
not O
appear O
to O
conduct O
widespread O
intellectual O
property O
theft O
for O
economic O
gain O
. O

Nor O
have O
we O
observed O
the O
group O
steal O
and O
profit O
from O
financial O
account O
information O
. O

The O
activity O
that O
we O
profile O
in O
this O
paper O
appears O
to O
be O
the O
work O
of O
a O
skilled O
team O
of O
developers O
and O
operators O
collecting O
intelligence O
on O
defense O
and O
geopolitical O
issues O
– O
intelligence O
that O
would O
only O
be O
useful O
to O
a O
government O
. O

We O
believe O
that O
this O
is O
an O
advanced O
persistent O
threat O
( O
APT O
) O
group O
engaged O
in O
espionage O
against O
political O
and O
military O
targets O
including O
the O
country O
of O
Georgia O
, O
Eastern O
European O
governments O
and O
militaries O
, O
and O
European O
security O
organizations O
since O
at O
least O
2007 O
. O

They O
compile O
malware O
samples O
with O
Russian O
language O
settings O
during O
working O
hours O
consistent O
with O
the O
time O
zone O
of O
Russia O
's O
major O
cities O
, O
including O
Moscow O
and O
St. O
Petersburg O
. O

While O
we O
do O
n't O
have O
pictures O
of O
a O
building O
, O
personas O
to O
reveal O
, O
or O
a O
government O
agency O
to O
name O
, O
what O
we O
do O
have O
is O
evidence O
of O
long- O
standing O
, O
focused O
operations O
that O
indicate O
a O
government O
sponsor O
– O
specifically O
, O
a O
government O
based O
in O
Moscow O
. O

We O
are O
tracking O
this O
group O
as O
APT28 O
. O

APT28 O
targets O
insider O
information O
related O
to O
governments O
, O
militaries O
, O
and O
security O
organizations O
that O
would O
likely O
benefit O
the O
Russian O
government O
. O

Malware O
compile O
times O
suggest O
that O
APT28 O
developers O
have O
consistently O
updated O
their O
tools O
over O
the O
last O
seven O
years O
. O

Since O
2007 O
, O
APT28 O
has O
systematically O
evolved O
its O
malware O
, O
using O
flexible O
and O
lasting O
platforms O
indicative O
of O
plans O
for O
long-term O
use O
. O

The O
coding O
practices O
evident O
in O
the O
group's O
malware O
suggest O
both O
a O
high O
level O
of O
skill O
and O
an O
interest O
in O
complicating O
reverse O
engineering O
efforts O
. O

• O
Malware O
compile O
times O
suggest O
that O
APT28 O
developers O
have O
consistently O
updated O
their O
tools O
over O
the O
last O
seven O
years O
. O

• O
APT28 O
malware O
, O
in O
particular O
the O
family O
of O
modular O
backdoors O
that O
we O
call O
CHOPSTICK O
, O
indicates O
a O
formal O
code O
development O
environment O
. O

Such O
an O
environment O
would O
almost O
certainly O
be O
required O
to O
track O
and O
define O
the O
various O
modules O
that O
can O
be O
included O
in O
the O
backdoor O
at O
compile O
time O
. O

• O
APT28 O
tailors O
implants O
for O
specific O
victim O
environments O
. O

They B-Entity
steal B-Action
data B-Entity
by O
configuring O
their B-Entity
implants I-Entity
to O
send B-Action
data B-Entity
out B-Modifier
of I-Modifier
the B-Entity
network I-Entity
using B-Modifier
a B-Entity
victim I-Entity
network I-Entity
's I-Entity
mail I-Entity
server I-Entity
. O

• O
Several B-Entity
of I-Entity
APT28 I-Entity
's I-Entity
malware I-Entity
samples I-Entity
contain B-Action
counter- B-Entity
analysis I-Entity
capabilities I-Entity
including O
runtime B-Entity
checks I-Entity
to O
identify B-Action
an B-Entity
analysis I-Entity
environment I-Entity
, O
obfuscated B-Entity
strings I-Entity
unpacked B-Action
at B-Modifier
runtime B-Entity
, O
and O
the O
inclusion B-Entity
of I-Entity
unused I-Entity
machine I-Entity
instructions I-Entity
to O
slow B-Action
analysis B-Entity
. O

Indicators O
in O
APT28 O
's O
malware O
suggest O
that O
the O
group O
consists O
of O
Russian O
speakers O
operating O
during O
business O
hours O
in O
Russia O
's O
major O
cities O
. O

More O
than O
half O
of O
the O
malware O
samples O
with O
Portable O
Executable O
( O
PE O
) O
resources O
that O
we O
have O
attributed O
to O
APT28 O
included O
Russian O
language O
settings O
( O
as O
opposed O
to O
neutral O
or O
English O
settings O
) O
, O
suggesting O
that O
a O
significant O
portion O
of O
APT28 O
malware O
was O
compiled O
in O
a O
Russian O
language O
build O
environment O
consistently O
over O
the O
course O
of O
six O
years O
( O
2007 O
to O
2013 O
) O
. O

Over O
96 O
% O
of O
the O
malware O
samples O
we O
have O
attributed O
to O
APT28 O
were O
compiled O
between O
Monday O
and O
Friday O
. O

More O
than O
89 O
% O
were O
compiled O
between O
8AM O
and O
6PM O
in O
the O
UTC+4 O
time O
zone O
, O
which O
parallels O
the O
working O
hours O
in O
Moscow O
and O
St. O
Petersburg O
. O

These O
samples O
had O
compile O
dates O
ranging O
from O
mid-2007 O
to O
September O
2014 O
. O

Three O
themes O
in O
APT28 O
's O
targeting O
clearly O
reflect O
areas O
of O
specific O
interest O
to O
an O
Eastern O
European O
government O
, O
most O
likely O
the O
Russian O
government O
. O

Many O
of O
APT28 O
's O
targets O
align O
generally O
with O
interests O
that O
are O
typical O
of O
any O
government O
. O

However O
, O
three O
themes O
in O
APT28 O
's O
targeting O
clearly O
reflects O
areas O
of O
specific O
interest O
to O
an O
Eastern O
European O
government O
, O
most O
likely O
the O
Russian O
government O
. O

These O
include O
the O
Caucasus O
( O
especially O
the O
Georgian O
government O
) O
, O
Eastern O
European O
governments O
and O
militaries O
, O
and O
specific O
security O
organizations O
. O

APT28 B-Entity
uses B-Action
spearphishing B-Entity
emails I-Entity
to B-Modifier
target B-Entity
its I-Entity
victims I-Entity
, O
a O
common O
tactic O
in O
which O
the B-Entity
threat I-Entity
group I-Entity
crafts B-Action
its B-Entity
emails I-Entity
to B-Modifier
mention B-Entity
specific I-Entity
topics I-Entity
( I-Entity
lures I-Entity
) I-Entity
relevant I-Entity
to I-Entity
recipients I-Entity
. O

This O
increases O
the O
likelihood O
that O
recipients O
will O
believe O
that O
the O
email O
is O
legitimate O
and O
will O
be O
interested O
in O
opening O
the O
message O
, O
opening O
any O
attached O
files O
, O
or O
clicking O
on O
a O
link O
in O
the O
body O
of O
the O
email O
. O

Since O
spearphishing O
lures O
are O
tailored O
to O
the O
recipients O
whose O
accounts O
APT28 O
hopes O
to O
breach O
, O
the O
subjects O
of O
the O
lures O
provide O
clues O
as O
to O
APT28's O
targets O
and O
interests O
. O

For O
example O
, O
if O
the O
group's O
lures O
repeatedly O
refer O
to O
the O
Caucasus O
, O
then O
this O
most O
likely O
indicates O
that O
APT28 O
is O
trying O
to O
gain O
access O
to O
the O
accounts O
of O
individuals O
whose O
work O
pertains O
to O
the O
Caucasus O
. O

Similarly O
, O
APT28 O
's O
practice O
of O
registering O
domains O
that O
mimic O
those O
of O
legitimate O
news O
, O
politics O
, O
or O
other O
websites O
indicates O
topics O
that O
are O
relevant O
to O
APT28 O
's O
targets O
. O

We O
identified O
three O
themes O
in O
APT28 O
's O
lures O
and O
registered O
domains O
, O
which O
together O
are O
particularly O
relevant O
to O
the O
Russian O
government O
. O

In O
addition O
to O
these O
themes O
, O
we O
have O
seen O
APT28 O
target O
a O
range O
of O
political O
and O
military O
organizations O
. O

We O
assess O
that O
the O
work O
of O
these O
organizations O
serves O
nation O
state O
governments O
. O

The O
Caucasus O
, O
a O
region O
that O
includes O
Chechnya O
and O
other O
Russian O
republics O
and O
the O
independent O
states O
of O
Georgia O
, O
Armenia O
, O
and O
Azerbaijan O
, O
continues O
to O
experience O
political O
unrest O
. O

The O
Georgian O
government O
's O
posture O
and O
ties O
to O
the O
West O
are O
a O
frequent O
source O
of O
Moscow O
's O
frustration O
, O
particularly O
after O
the O
2008 O
war O
. O

Overall O
, O
issues O
in O
the O
Caucasus O
likely O
serve O
as O
focal O
points O
for O
Russian O
intelligence O
collection O
efforts O
. O

Since O
2011 O
, O
APT28 B-Entity
has O
used B-Action
lures B-Entity
written I-Entity
in I-Entity
Georgian I-Entity
that O
are O
probably O
intended O
to O
target O
Georgian O
government O
agencies O
or O
citizens O
. O

APT28 O
is O
likely O
seeking O
information O
on O
Georgia's O
security O
and O
diplomatic O
postures O
. O

Specifically O
, O
the O
group O
has O
targeted O
the O
Georgian O
Ministry O
of O
Internal O
Affairs O
( O
MIA O
) O
and O
the O
Ministry O
of O
Defense O
( O
MOD O
) O
. O

We O
also O
observed O
efforts O
to O
target O
a O
journalist O
working O
on O
issues O
in O
the O
Caucasus O
and O
a O
controversial O
Chechen O
news O
site O
. O

APT28 O
made O
at O
least O
two O
specific O
attempts O
to O
target O
the O
Georgian O
Ministry O
of O
Internal O
Affairs O
. O

The O
MIA O
harbors O
sensitive O
information O
about O
the O
inner O
workings O
of O
Georgia O
's O
security O
operations O
, O
the O
country O
's O
engagement O
in O
multilateral O
institutions O
, O
and O
the O
government O
's O
communications O
backbone O
. O

It O
is O
responsible O
for O
: O
APT28 O
made O
at O
least O
two O
specific O
attempts O
to O
target O
the O
MIA O
. O

In O
one O
case O
, O
we O
identified O
an O
APT28 O
lure O
from O
mid-2013 O
that O
referenced O
MIA-related O
topics O
and O
employed O
malware B-Entity
that O
attempted O
to O
disguise B-Action
its B-Entity
activity I-Entity
as B-Modifier
legitimate B-Entity
MIA I-Entity
email I-Entity
traffic I-Entity
. O

The O
lure O
consisted O
of O
a B-Entity
weaponized I-Entity
Excel I-Entity
file I-Entity
that O
presented B-Action
a B-Entity
decoy I-Entity
document I-Entity
containing I-Entity
a I-Entity
list I-Entity
of I-Entity
Georgian I-Entity
driver I-Entity
's I-Entity
license I-Entity
numbers I-Entity
. O

The B-Entity
backdoor I-Entity
attempted O
to O
establish B-Action
a B-Entity
connection I-Entity
to I-Entity
a I-Entity
Georgian I-Entity
MIA I-Entity
mail I-Entity
server I-Entity
and O
communicate B-Action
via B-Modifier
MIA B-Entity
email I-Entity
addresses I-Entity
ending I-Entity
with I-Entity
'' I-Entity
@ I-Entity
mia.ge.gov I-Entity
'' I-Entity
. O

Once O
connected O
to O
the O
mail O
server O
, O
APT28 B-Entity
's I-Entity
backdoor I-Entity
sent B-Action
an B-Entity
email I-Entity
message I-Entity
using I-Entity
a I-Entity
subject I-Entity
line I-Entity
related I-Entity
to I-Entity
driver's I-Entity
licenses I-Entity
( I-Entity
in I-Entity
Georgian I-Entity
) I-Entity
, O
and O
attached B-Action
a B-Entity
file I-Entity
containing I-Entity
system I-Entity
reconnaissance I-Entity
information I-Entity
. O

This O
tactic O
could O
allow O
APT28 B-Entity
to O
obtain B-Action
data B-Entity
from B-Modifier
the B-Entity
MIA I-Entity
's I-Entity
network I-Entity
through B-Modifier
a B-Entity
less-monitored I-Entity
route I-Entity
, O
limiting B-Action
the B-Entity
MIA I-Entity
network I-Entity
security I-Entity
department I-Entity
's I-Entity
abilities I-Entity
to I-Entity
detect I-Entity
the I-Entity
traffic I-Entity
. O

In O
the O
second O
example O
of O
MIA O
targeting O
, O
an B-Entity
APT28 I-Entity
lure I-Entity
used B-Action
an B-Entity
information I-Entity
technology-themed I-Entity
decoy I-Entity
document I-Entity
that I-Entity
included I-Entity
references I-Entity
to I-Entity
the I-Entity
Windows I-Entity
domain I-Entity
'' I-Entity
MIA I-Entity
Users\Ortachala… I-Entity
'' I-Entity
( I-Entity
Figure I-Entity
1 I-Entity
) I-Entity
. O

This O
probably O
referred O
to O
the O
MIA O
facility O
in O
the O
Ortachala O
district O
of O
Tbilisi O
, O
Georgia O
's O
capital O
city O
. O

The B-Entity
decoy I-Entity
document I-Entity
also O
contains B-Action
metadata B-Entity
listing I-Entity
'' I-Entity
MIA I-Entity
'' I-Entity
as I-Entity
the I-Entity
company I-Entity
name I-Entity
and I-Entity
'' I-Entity
Beka I-Entity
Nozadze I-Entity
'' I-Entity
as I-Entity
an I-Entity
author I-Entity
, O
a O
possible O
reference O
to O
a O
system O
administrator O
in O
Tbilisi O
. O

The B-Entity
text I-Entity
of I-Entity
the I-Entity
document I-Entity
purports B-Action
to B-Modifier
provide B-Entity
domain I-Entity
and I-Entity
user I-Entity
group I-Entity
setup I-Entity
information I-Entity
for I-Entity
internal I-Entity
Windows I-Entity
XP I-Entity
and I-Entity
Windows I-Entity
7 I-Entity
systems I-Entity
. O

APT28 B-Entity
possibly O
crafted B-Action
this B-Entity
document I-Entity
to B-Modifier
appear B-Entity
legitimate I-Entity
to I-Entity
all I-Entity
MIA I-Entity
system I-Entity
users I-Entity
and O
intended O
to O
breach O
the O
MIA O
network O
specifically O
using O
the O
embedded O
malware O
. O

APT28 O
also O
appeared O
to O
target O
Georgia O
's O
MOD O
along O
with O
a O
U.S. O
defense O
contractor O
that O
was O
training O
the O
Georgian O
military O
. O

APT28 B-Entity
used B-Action
a B-Entity
lure I-Entity
document I-Entity
that O
installed B-Action
a B-Entity
SOURFACE I-Entity
downloader I-Entity
( O
further O
discussed O
in O
the O
Malware O
section O
) O
and O
contained B-Action
a B-Entity
listing I-Entity
of I-Entity
birthdays I-Entity
for I-Entity
members I-Entity
of I-Entity
a I-Entity
working I-Entity
group I-Entity
between I-Entity
the I-Entity
Georgian I-Entity
MOD I-Entity
and I-Entity
the I-Entity
U.S. I-Entity
defense I-Entity
contractor I-Entity
. O

The O
U.S. O
contractor O
was O
involved O
in O
a O
working O
group O
to O
advise O
the O
MOD O
and O
Georgian O
Armed O
Forces O
, O
assess O
Georgia's O
military O
capabilities O
, O
and O
develop O
a O
military O
training O
program O
for O
the O
country O
. O

We O
believe O
that O
APT28 O
's O
targeting O
of O
the O
MOD O
aligns O
with O
Russian O
threat O
perceptions O
. O

The O
growing O
U.S.-Georgian O
military O
relationship O
has O
been O
a O
source O
of O
angst O
for O
Russia O
. O

Georgia O
and O
Russia O
severed O
diplomatic O
relations O
following O
the O
Russia-Georgia O
War O
in O
2008 O
, O
and O
Georgia O
has O
since O
sought O
to O
align O
itself O
more O
closely O
with O
western O
security O
organizations O
. O

Additionally O
, O
in O
June O
2014 O
, O
despite O
Russia O
's O
vocal O
objections O
, O
Georgia O
, O
along O
with O
Ukraine O
and O
Moldova O
, O
signed O
association O
accords O
with O
the O
EU O
. O

This O
move O
placed O
all O
three O
countries O
more O
firmly O
in O
the O
EU O
's O
political O
, O
economic O
, O
and O
security O
spheres O
of O
influence O
. O

Georgian O
military O
security O
issues O
, O
particularly O
with O
regard O
to O
U.S. O
cooperation O
and O
NATO O
, O
provide O
a O
strong O
incentive O
for O
Russian O
state-sponsored O
threat O
actors O
to O
steal O
information O
that O
sheds O
light O
on O
these O
topics O
. O

Targeting O
journalists O
could O
provide O
APT28 O
and O
its O
sponsors O
with O
a O
way O
to O
monitor O
public O
opinion O
, O
identify O
dissidents O
, O
spread O
disinformation O
, O
or O
facilitate O
further O
targeting O
. O

Another B-Entity
one I-Entity
of I-Entity
APT28 I-Entity
's I-Entity
lures I-Entity
appeared O
to O
target B-Action
a B-Entity
specific I-Entity
journalist I-Entity
covering I-Entity
issues I-Entity
in I-Entity
the I-Entity
Caucasus I-Entity
region I-Entity
. O

In O
late O
2013 O
, O
APT28 B-Entity
used B-Action
a B-Entity
lure I-Entity
that I-Entity
contained I-Entity
a I-Entity
letter I-Entity
addressing I-Entity
a I-Entity
journalist I-Entity
by I-Entity
his I-Entity
first I-Entity
name I-Entity
and I-Entity
claiming I-Entity
to I-Entity
originate I-Entity
from I-Entity
a I-Entity
'' I-Entity
Chief I-Entity
Coordinator I-Entity
'' I-Entity
in I-Entity
Reason I-Entity
Magazine's I-Entity
'' I-Entity
Caucasian I-Entity
Issues I-Entity
Department I-Entity
'' I-Entity
- I-Entity
a I-Entity
division I-Entity
that I-Entity
does I-Entity
not I-Entity
appear I-Entity
to I-Entity
exist I-Entity
. O

( O
Reason O
Magazine O
is O
a O
US-based O
magazine O
) O
The O
letter O
welcomed O
the O
individual O
as O
a O
contributor O
and O
requested O
topic O
ideas O
and O
identification O
information O
in O
order O
to O
establish O
him O
at O
the O
magazine O
. O

In O
the O
background O
, O
the B-Entity
decoy I-Entity
document I-Entity
installed B-Action
a B-Entity
SOURFACE I-Entity
backdoor I-Entity
on B-Modifier
the B-Entity
victim I-Entity
's I-Entity
system I-Entity
. O

The O
body O
of O
the O
letter O
suggests O
that O
APT28 O
actors O
are O
able O
to O
read O
at O
least O
two O
languages O
– O
Russian O
and O
English O
. O

The O
grammar O
of O
the O
letter O
also O
indicates O
that O
English O
is O
not O
the O
author O
's O
first O
language O
, O
despite O
it O
purportedly O
originating O
from O
a O
US-based O
magazine O
. O

This O
implies O
that O
Russian O
may O
be O
the O
APT28 O
author O
's O
preferred O
language O
. O

Targeting O
journalists O
could O
provide O
APT28 O
and O
its O
sponsors O
with O
a O
way O
to O
monitor O
public O
opinion O
, O
identify O
dissidents O
, O
spread O
disinformation O
, O
or O
facilitate O
further O
targeting O
. O

Several O
other O
nation O
states O
are O
suspected O
of O
targeting O
journalists O
and O
dissidents O
to O
monitor O
their O
activity O
, O
including O
China O
and O
Iran. O
, O
Journalists O
in O
the O
Caucasus O
working O
on O
Caucasus O
independence O
issues O
would O
be O
a O
prime O
target O
for O
intelligence O
collection O
for O
Moscow O
. O

Journalists O
critical O
of O
the O
Kremlin O
have O
long O
been O
targets O
of O
surveillance O
and O
harassment O
, O
and O
a O
number O
of O
governments O
and O
human O
rights O
organizations O
have O
publicly O
criticized O
the O
government O
for O
its O
treatment O
of O
journalists O
and O
its O
increasing O
consolidation O
of O
control O
over O
the O
media O
. O

We O
have O
seen O
APT28 B-Entity
register B-Action
at B-Entity
least I-Entity
two I-Entity
domains I-Entity
mimicking I-Entity
the I-Entity
domains I-Entity
of I-Entity
legitimate I-Entity
organizations I-Entity
in I-Entity
the I-Entity
Caucasus I-Entity
, O
as O
shown O
in O
the O
table O
below O
. O

One B-Entity
APT28 I-Entity
domain I-Entity
imitated B-Action
a B-Entity
key I-Entity
Chechen-focused I-Entity
news I-Entity
website I-Entity
, O
while O
the B-Entity
other I-Entity
appeared O
to O
target B-Action
members B-Entity
of I-Entity
the I-Entity
Armenian I-Entity
military I-Entity
by B-Modifier
hosting B-Entity
a I-Entity
fake I-Entity
login I-Entity
page I-Entity
. O

Of O
particular O
note O
, O
the O
Kavkaz O
Center O
is O
a O
Chechen-run O
website O
designed O
to O
present O
an O
alternative O
view O
to O
the O
long-running O
conflict O
between O
Russia O
and O
Chechen O
separatists O
. O

In O
2004 O
and O
2013 O
, O
Russia O
's O
Foreign O
Minister O
voiced O
his O
displeasure O
that O
a O
Swedish O
company O
continues O
to O
host O
the O
Kavkaz O
Center O
website O
. O

Eastern O
European O
countries O
' O
political O
and O
military O
postures O
are O
traditionally O
core O
Russian O
government O
interests O
. O

The O
Kremlin O
has O
long O
regarded O
the O
former O
Soviet O
Republics O
and O
satellite O
states O
as O
in O
its O
sphere O
of O
economic O
, O
political O
, O
and O
military O
interest O
. O

Over O
the O
past O
two O
decades O
, O
as O
many O
of O
these O
states O
joined O
NATO O
and O
the O
EU O
, O
Russia O
has O
attempted O
to O
regain O
its O
influence O
in O
the O
region O
. O

Many O
of O
APT28 O
's O
targets O
parallel O
this O
continued O
focus O
on O
Eastern O
European O
governments O
and O
militaries O
. O

We O
have O
evidence O
that O
APT28 O
made O
at O
least O
two O
attempts O
to O
compromise O
Eastern O
European O
government O
organizations O
: O
• O
In O
a O
late O
2013 O
incident O
, O
a O
FireEye O
device O
deployed O
at O
an O
Eastern O
European O
Ministry O
of O
Foreign O
Affairs O
detected O
APT28 O
malware O
in O
the O
client O
's O
network O
. O

• O
More O
recently O
, O
in O
August O
2014 O
APT28 B-Entity
used B-Action
a B-Entity
lure I-Entity
( I-Entity
Figure I-Entity
3 I-Entity
) I-Entity
about I-Entity
hostilities I-Entity
surrounding I-Entity
a I-Entity
Malaysia I-Entity
Airlines I-Entity
flight I-Entity
downed I-Entity
in I-Entity
Ukraine I-Entity
in B-Modifier
a B-Entity
probable I-Entity
attempt I-Entity
to I-Entity
compromise I-Entity
the I-Entity
Polish I-Entity
government I-Entity
. O

A B-Entity
SOURFACE I-Entity
sample I-Entity
employed B-Action
in B-Modifier
the B-Entity
same I-Entity
Malaysia I-Entity
Airlines I-Entity
lure I-Entity
was O
referenced O
by O
a O
Polish O
computer O
security O
company O
in O
a O
blog O
post O
. O

The O
Polish O
security O
company O
indicated O
that O
the O
sample O
was O
'' O
sent O
to O
the O
government O
, O
'' O
presumably O
the O
Polish O
government O
, O
given O
the O
company O
's O
location O
and O
visibility O
. O

We O
have O
evidence O
that O
APT28 O
made O
at O
least O
two O
attempts O
to O
compromise O
Eastern O
European O
government O
organizations O
. O

APT28 B-Entity
has O
registered B-Action
domains B-Entity
similar I-Entity
to I-Entity
those I-Entity
of I-Entity
legitimate I-Entity
Eastern I-Entity
European I-Entity
news I-Entity
sites I-Entity
and I-Entity
governments I-Entity
, O
listed O
in O
Table O
2 O
. O

These O
domain O
registrations O
not O
only O
suggest O
that O
APT28 O
is O
interested O
in O
Eastern O
European O
political O
affairs O
, O
but O
also O
that O
the O
group O
targets O
Eastern O
European O
governments O
directly O
. O

In O
addition O
, O
APT28 B-Entity
used B-Action
one B-Entity
domain I-Entity
for I-Entity
command I-Entity
and I-Entity
control I-Entity
sessions I-Entity
( I-Entity
baltichost I-Entity
[ I-Entity
. I-Entity
] I-Entity
org I-Entity
) I-Entity
that I-Entity
was I-Entity
themed I-Entity
after I-Entity
the I-Entity
Baltic I-Entity
Host I-Entity
exercises I-Entity
. O

Baltic O
Host O
is O
a O
multinational O
logistics O
planning O
exercise O
, O
hosted O
annually O
since O
2009 O
by O
one O
of O
the O
three O
Baltic O
States O
( O
Estonia O
, O
Latvia O
, O
and O
Lithuania O
, O
all O
three O
of O
which O
are O
on O
Russia O
's O
border O
) O
on O
a O
rotational O
basis O
. O

In O
June O
2014 O
, O
this O
event O
was O
integrated O
with O
a O
larger O
U.S. O
Army O
training O
event O
, O
and O
focused O
on O
exercises O
to O
improve O
interoperability O
with O
regional O
allies O
and O
partners. O
, O
This O
domain O
registration O
suggests O
that O
APT28 O
sought O
to O
target O
individuals O
either O
participating O
in O
the O
exercises O
or O
interested O
in O
Baltic O
military O
and O
security O
matters O
. O

Such O
targets O
would O
potentially O
provide O
APT28 O
with O
sensitive O
tactical O
and O
strategic O
intelligence O
concerning O
regional O
military O
capabilities O
and O
relationships O
. O

These O
exercises O
are O
a O
particular O
point O
of O
interest O
in O
Moscow O
: O
pro- O
Kremlin O
press O
cited O
Russia O
's O
interpretation O
of O
these O
military O
exercises O
and O
NATO O
's O
involvement O
as O
a O
'' O
sign O
of O
aggression O
, O
'' O
and O
Russia O
's O
Foreign O
Minister O
publicly O
stated O
that O
the O
exercise O
was O
'' O
a O
demonstration O
of O
hostile O
intention O
. O

'' O
APT28 O
's O
lures O
and O
domain O
registrations O
also O
demonstrate O
their O
interest O
in O
NATO O
and O
other O
European O
security O
organizations O
. O

NATO O
remains O
a O
chief O
Russian O
adversary O
, O
or O
in O
the O
words O
of O
Russia O
's O
2010 O
military O
doctrine O
, O
a O
'' O
main O
external O
military O
danger O
'' O
particularly O
as O
it O
moves O
'' O
closer O
to O
the O
borders O
of O
the O
Russian O
Federation O
. O

'' O
As O
the O
traditional O
western O
counterweight O
to O
the O
Soviet O
Union O
, O
Russia O
regards O
NATO O
, O
particularly O
NATO O
's O
eastward O
expansion O
, O
as O
a O
threat O
to O
Russia O
's O
strategic O
stability O
. O

APT28 O
also O
registered O
a O
domain O
name O
imitating O
the O
Organization O
for O
Security O
and O
Cooperation O
in O
Europe O
( O
OSCE O
) O
, O
an O
intergovernmental O
organization O
that O
has O
cited O
widespread O
fraud O
in O
numerous O
Russian O
state O
elections O
. O

Insider O
information O
about O
NATO O
, O
the O
OSCE O
and O
other O
security O
organizations O
would O
inform O
Russian O
political O
and O
military O
policy O
. O

Several B-Entity
of I-Entity
the I-Entity
domains I-Entity
APT28 I-Entity
registered I-Entity
imitated B-Action
NATO B-Entity
domain I-Entity
names I-Entity
, O
including O
those O
of O
NATO O
Special O
Operations O
Headquarters O
and O
the O
NATO O
Future O
Forces O
Exhibition O
. O

We O
also O
observed O
a O
user O
that O
we O
suspect O
works O
for O
NATO O
HQ O
submit O
an O
APT28 O
sample O
to O
VirusTotal O
, O
probably O
as O
a O
result O
of O
receiving O
a O
suspicious O
email O
. O

APT28 O
also O
demonstrated O
an O
interest O
in O
defense O
attaches O
working O
in O
European O
countries O
. O

We O
identified O
an B-Entity
APT28 I-Entity
lure I-Entity
containing B-Action
a B-Entity
decoy I-Entity
document I-Entity
with I-Entity
a I-Entity
list I-Entity
of I-Entity
British I-Entity
officers I-Entity
and I-Entity
U.S. I-Entity
and I-Entity
Canadian I-Entity
military I-Entity
attachés I-Entity
in I-Entity
London I-Entity
. O

Finally O
, O
APT28 B-Entity
used B-Action
a B-Entity
lure I-Entity
that I-Entity
contained I-Entity
an I-Entity
apparent I-Entity
non-public I-Entity
listing I-Entity
of I-Entity
contact I-Entity
information I-Entity
for I-Entity
defense I-Entity
attachés I-Entity
in I-Entity
the I-Entity
'' I-Entity
Ankara I-Entity
Military I-Entity
Attaché I-Entity
Corps I-Entity
( I-Entity
AMAC I-Entity
) I-Entity
, I-Entity
'' I-Entity
which O
appears O
to O
be O
a O
professional O
organization O
of O
defense O
attachés O
in O
Turkey O
. O

In O
addition O
to O
targeting O
European O
security O
organizations O
and O
governments O
, O
it O
appears O
that O
APT28 O
is O
targeting O
attendees O
of O
European O
defense O
exhibitions O
. O

Some B-Entity
of I-Entity
the I-Entity
APT28- I-Entity
registered I-Entity
domains I-Entity
imitated B-Action
those B-Entity
of I-Entity
defense I-Entity
events I-Entity
held I-Entity
in I-Entity
Europe I-Entity
, O
such O
as O
the O
Farnborough O
Airshow O
2014 O
, O
EuroNaval O
2014 O
, O
EUROSATORY O
2014 O
, O
and O
the O
Counter O
Terror O
Expo O
. O

In O
September O
2014 O
, O
APT28 B-Entity
registered B-Action
a B-Entity
domain I-Entity
( I-Entity
smigroup- I-Entity
online.co I-Entity
[ I-Entity
. I-Entity
] I-Entity
uk I-Entity
) I-Entity
that I-Entity
appeared I-Entity
to I-Entity
mimic I-Entity
that I-Entity
for I-Entity
the I-Entity
SMi I-Entity
Group I-Entity
, O
a O
company O
that O
plans O
events O
for O
the O
'' O
Defence O
, O
Security O
, O
Energy O
, O
Utilities O
, O
Finance O
and O
Pharmaceutical O
sectors O
. O

'' O
Among O
other O
events O
, O
the O
SMi O
Group O
is O
currently O
planning O
a O
military O
satellite O
communications O
event O
for O
November O
2014 O
. O

Targeting O
organizations O
and O
professionals O
involved O
in O
these O
defense O
events O
would O
likely O
provide O
APT28 O
with O
an O
opportunity O
to O
procure O
intelligence O
pertaining O
to O
new O
defense O
technologies O
, O
as O
well O
as O
the O
victim O
organizations' O
operations O
, O
communications O
, O
and O
future O
plans O
. O

APT28 O
has O
targeted O
a O
variety O
of O
organizations O
that O
fall O
outside O
of O
the O
three O
themes O
we O
highlighted O
above O
. O

However O
, O
we O
are O
not O
profiling O
all O
of O
APT28 O
's O
targets O
with O
the O
same O
detail O
because O
they O
are O
not O
particularly O
indicative O
of O
a O
specific O
sponsor O
's O
interests O
. O

They O
do O
indicate O
parallel O
areas O
of O
interest O
to O
many O
governments O
and O
do O
not O
run O
counter O
to O
Russian O
state O
interests O
. O

Other O
probable O
APT28 O
targets O
that O
we O
have O
identified O
: O
Our O
analysis O
of O
some O
of O
the O
group O
's O
more O
commonly O
used O
tools O
indicates O
that O
APT28 O
has O
been O
systematically O
updating O
their O
malware O
since O
2007 O
. O

APT28 O
's O
tools O
are O
suggestive O
of O
the O
group O
's O
skills O
, O
ambitions O
, O
and O
identity O
. O

Our O
analysis O
of O
some O
of O
the O
group O
's O
more O
commonly O
used O
tools O
indicates O
that O
APT28 O
has O
been O
systematically O
updating O
their O
tools O
since O
2007 O
. O

APT28 O
is O
most O
likely O
supported O
by O
a O
group O
of O
developers O
creating O
tools O
intended O
for O
long-term O
use O
and O
versatility O
, O
who O
make O
an O
effort O
to O
obfuscate O
their O
activity O
. O

This O
suggests O
that O
APT28 O
receives O
direct O
ongoing O
financial O
and O
other O
resources O
from O
a O
well-established O
organization O
, O
most O
likely O
a O
nation O
state O
government O
. O

APT28 O
's O
malware O
settings O
suggest O
that O
the O
developers O
have O
done O
the O
majority O
of O
their O
work O
in O
a O
Russian O
language O
build O
environment O
during O
Russian O
business O
hours O
, O
which O
suggests O
that O
the O
Russian O
government O
is O
APT28 O
's O
sponsor O
. O

Some B-Entity
of I-Entity
APT28 I-Entity
's I-Entity
more I-Entity
commonly I-Entity
used I-Entity
tools I-Entity
are B-Action
the B-Entity
SOURFACE I-Entity
downloader I-Entity
, O
its B-Entity
second I-Entity
stage I-Entity
backdoor I-Entity
EVILTOSS I-Entity
, O
and O
a B-Entity
modular I-Entity
family I-Entity
of I-Entity
implants I-Entity
that I-Entity
we I-Entity
call I-Entity
CHOPSTICK I-Entity
. O

• O
SOURFACE O
: O
This O
downloader O
is O
typically O
called O
Sofacy O
within O
the O
cyber O
security O
community O
. O

However O
because O
we O
have O
observed O
the O
name O
'' O
Sofacy O
'' O
used O
to O
refer O
to O
APT28 O
malware O
generally O
( O
to O
include O
the O
SOURFACE O
dropper O
, O
EVILTOSS O
, O
CHOPSTICK O
, O
and O
the O
credential O
harvester O
OLDBAIT O
) O
, O
we O
are O
using O
the B-Entity
name I-Entity
SOURFACE I-Entity
to O
precisely O
refer B-Action
to B-Modifier
a B-Entity
specific I-Entity
downloader I-Entity
. O

This B-Entity
downloader I-Entity
obtains B-Action
a B-Entity
second-stage I-Entity
backdoor I-Entity
from B-Modifier
a B-Entity
C2 I-Entity
server I-Entity
. O

CORESHELL O
is O
an O
updated O
version O
of O
SOURFACE O
. O

• O
EVILTOSS O
: O
This B-Entity
backdoor I-Entity
has O
been B-Action
delivered I-Action
through B-Modifier
the B-Entity
SOURFACE I-Entity
downloader I-Entity
to O
gain B-Action
system B-Entity
access I-Entity
for B-Modifier
reconnaissance B-Entity
, O
monitoring B-Entity
, O
credential B-Entity
theft I-Entity
, O
and O
shellcode B-Entity
execution I-Entity
. O

• O
CHOPSTICK O
: O
This O
is O
a O
modular O
implant O
compiled O
from O
a O
software O
framework O
that O
provides O
tailored O
functionality O
and O
flexibility O
. O

A O
number O
of O
the O
malware O
variants O
that O
we O
profile O
below O
, O
especially O
the O
CHOPSTICK O
family O
, O
demonstrate O
formal O
coding O
practices O
indicative O
of O
methodical O
, O
diligent O
programmers O
. O

The O
modularity O
of O
CHOPSTICK O
alone O
, O
with O
its O
flexible O
and O
lasting O
platform O
, O
demonstrates O
planning O
for O
long-term O
use O
and O
versatility O
. O

We O
have O
also O
noted O
that O
APT28 O
tailors O
implants O
to O
their O
target O
environments O
, O
configuring O
them B-Entity
to O
use B-Action
local B-Entity
network I-Entity
resources I-Entity
such I-Entity
as I-Entity
email I-Entity
servers I-Entity
. O

APT28 B-Entity
has O
attempted O
to O
obfuscate B-Action
their B-Entity
code I-Entity
and O
implement B-Action
counter-analysis B-Entity
techniques I-Entity
: O
• O
One B-Entity
of I-Entity
the I-Entity
latest I-Entity
samples I-Entity
of I-Entity
CORESHELL I-Entity
includes B-Action
counter-reverse B-Entity
engineering I-Entity
tactics I-Entity
via B-Modifier
unused B-Entity
machine I-Entity
instructions I-Entity
. O

This B-Entity
would O
hinder B-Action
static B-Entity
analysis I-Entity
of I-Entity
CORESHELL I-Entity
behavior I-Entity
by B-Modifier
creating B-Entity
a I-Entity
large I-Entity
amount I-Entity
of I-Entity
unnecessary I-Entity
noise I-Entity
in I-Entity
the I-Entity
disassembly I-Entity
. O

• O
A B-Entity
number I-Entity
of I-Entity
CORESHELL I-Entity
droppers I-Entity
also O
conduct B-Action
runtime B-Entity
checks I-Entity
, O
attempting O
to O
determine B-Action
if B-Entity
they I-Entity
are I-Entity
executing I-Entity
in I-Entity
an I-Entity
analysis I-Entity
environment I-Entity
, O
and O
if O
so O
, O
they O
do O
not O
trigger O
their O
payloads O
. O

• O
Many B-Entity
samples I-Entity
across I-Entity
the I-Entity
SOURFACE/ I-Entity
CORESHELL I-Entity
, I-Entity
CHOPSTICK I-Entity
, I-Entity
and I-Entity
EVILTOSS I-Entity
malware I-Entity
families I-Entity
obfuscate B-Action
strings B-Entity
that I-Entity
are I-Entity
decoded I-Entity
at I-Entity
runtime I-Entity
. O

Two B-Entity
of I-Entity
the I-Entity
malware I-Entity
families I-Entity
( I-Entity
SOURFACE/CORESHELL I-Entity
and I-Entity
EVILTOSS I-Entity
) I-Entity
use B-Action
the B-Entity
same I-Entity
decryption I-Entity
sequence I-Entity
and I-Entity
similar I-Entity
algorithms I-Entity
for B-Modifier
string B-Entity
encoding I-Entity
and I-Entity
decoding I-Entity
. O

These B-Entity
families I-Entity
encode B-Action
their B-Entity
strings I-Entity
at B-Modifier
compile B-Entity
time I-Entity
using B-Modifier
a B-Entity
custom I-Entity
stream I-Entity
cipher I-Entity
. O

From O
a O
high O
level O
, O
these O
ciphers O
share O
a O
similar O
design O
across O
the O
malware O
families O
but O
differ O
slightly O
in O
the O
internal O
arithmetic O
operations O
. O

• O
APT28 B-Entity
has O
employed B-Action
RSA B-Entity
encryption I-Entity
to B-Modifier
protect B-Entity
files I-Entity
and I-Entity
stolen I-Entity
information I-Entity
moved I-Entity
from I-Entity
the I-Entity
victim I-Entity
's I-Entity
network I-Entity
to I-Entity
the I-Entity
controller I-Entity
. O

APT28 O
has O
made O
incremental O
and O
systematic O
changes O
to O
the O
SOURFACE O
downloader O
and O
its O
surrounding O
ecosystem O
since O
as O
early O
as O
2007 O
. O

These O
changes O
indicate O
a O
long-standing O
and O
dedicated O
development O
effort O
behind O
APT28 O
. O

We O
have O
observed O
samples O
of O
the O
SOURFACE O
downloader O
compiled O
between O
2007 O
and O
2014 O
. O

We O
call O
SOURFACE B-Entity
( O
samples O
are O
frequently O
named O
netids.dll O
) O
a O
first O
stage O
downloader O
because O
its O
primary O
job O
is O
to O
retrieve B-Action
a B-Entity
second I-Entity
stage I-Entity
payload I-Entity
from B-Modifier
a B-Entity
C2 I-Entity
server I-Entity
. O

Until O
2013 O
, O
the B-Entity
SOURFACE I-Entity
downloader I-Entity
used B-Action
hard-coded B-Entity
IP I-Entity
addresses I-Entity
for B-Modifier
C2 B-Entity
communications I-Entity
, O
whereas O
the B-Entity
future I-Entity
CORESHELL I-Entity
samples I-Entity
use B-Action
domains B-Entity
. O

First O
, O
a O
malware O
family O
is O
a O
collection O
of O
malware O
in O
which O
each O
sample O
shares O
a O
significant O
amount O
of O
code O
with O
all O
of O
the O
others O
. O

There O
are O
exceptions O
: O
for O
example O
, O
some O
files O
contain O
public O
and O
standard O
code O
libraries O
that O
we O
do O
not O
take O
into O
consideration O
when O
making O
a O
family O
determination O
. O

A O
malware O
ecosystem O
is O
a O
group O
of O
malware O
families O
that O
work O
together O
to O
perform O
the O
same O
objective O
. O

Perhaps O
the O
simplest O
and O
most O
typical O
ecosystem O
is O
a O
dropper O
and O
a O
backdoor O
that O
are O
used O
together O
. O

They O
may O
not O
share O
the O
same O
code O
structure O
, O
but O
they O
are O
related O
because O
one B-Entity
drops B-Action
and I-Action
installs I-Action
the B-Entity
other I-Entity
. O

The O
ecosystem O
surrounding O
the O
SOURFACE O
downloader O
frequently O
consists O
of O
a B-Entity
dropper I-Entity
, O
which O
installs B-Action
SOURFACE B-Entity
. O

The B-Entity
SOURFACE I-Entity
downloader I-Entity
then O
receives B-Action
another B-Entity
dropper I-Entity
from B-Modifier
its B-Entity
C2 I-Entity
server I-Entity
, O
and O
this B-Entity
second I-Entity
dropper I-Entity
installs B-Action
a B-Entity
second I-Entity
stage I-Entity
backdoor I-Entity
, O
which O
is O
usually O
EVILTOSS O
. O

In O
April O
2013 O
, O
based O
on O
compile O
time O
, O
the O
group O
began O
to O
make O
significant O
alterations O
to O
the O
SOURFACE O
downloader O
. O

They O
started O
by O
changing O
the O
compiled O
DLL O
name O
to O
'' O
coreshell.dll O
'' O
and O
making O
minor O
changes O
to O
the O
network O
communications O
, O
as O
seen O
in O
Figure O
7 O
. O

The O
hostname O
, O
volume O
serial O
number O
and O
OS O
version O
data O
are O
encoded O
in O
the O
new O
URL O
format O
. O

As O
seen O
in O
the O
table O
below O
, O
the O
SOURFACE/ O
CORESHELL O
developers O
also O
made O
other O
modifications O
that O
changed O
the O
exported O
function O
name O
and O
file O
size O
over O
time O
. O

In O
April O
2013 O
, O
based O
on O
compile O
time O
, O
the O
group O
began O
to O
make O
significant O
alterations O
to O
the O
SOURFACE O
downloader O
. O

Variants O
of O
the O
SOURFACE O
second O
stage O
backdoor O
, O
EVILTOSS O
, O
share O
some O
code O
similarities O
with O
SOURFACE O
. O

However O
, O
it B-Entity
contains O
more O
capabilities O
, O
including O
the O
ability O
to O
provide B-Action
access B-Entity
to I-Entity
the I-Entity
file I-Entity
system I-Entity
and I-Entity
registry I-Entity
, O
enumerate B-Action
network B-Entity
resources I-Entity
, O
create B-Action
processes B-Entity
, O
log B-Action
keystrokes B-Entity
, O
access B-Action
stored B-Entity
credentials I-Entity
, O
and O
execute B-Action
shellcode B-Entity
. O

The B-Entity
backdoor I-Entity
encrypts B-Action
data B-Entity
that O
it B-Entity
uploads B-Action
with B-Modifier
an B-Entity
RSA I-Entity
public I-Entity
key I-Entity
. O

Many O
of O
its O
variants O
we O
have O
seen O
are O
named O
netui.dll O
. O

EVILTOSS B-Entity
variants I-Entity
may O
use B-Action
the B-Entity
Simple I-Entity
Mail I-Entity
Transfer I-Entity
Protocol I-Entity
( I-Entity
SMTP I-Entity
) I-Entity
to B-Modifier
send B-Entity
stolen I-Entity
data I-Entity
in I-Entity
an I-Entity
attachment I-Entity
named I-Entity
'' I-Entity
detaluri I-Entity
. I-Entity
dat I-Entity
'' I-Entity
. O

The B-Entity
backdoor I-Entity
attaches B-Action
this B-Entity
file I-Entity
to B-Modifier
a B-Entity
preformatted I-Entity
email I-Entity
and O
sends B-Action
it B-Entity
out B-Modifier
through B-Modifier
a B-Entity
victim I-Entity
's I-Entity
mail I-Entity
server I-Entity
. O

Interestingly O
, O
we O
found O
an O
antivirus O
report O
from O
2004 O
detailing O
what O
appears O
to O
be O
an O
early O
variant O
of O
EVILTOSS O
. O

The B-Entity
backdoor I-Entity
was B-Action
installed I-Action
alongside B-Modifier
the B-Entity
NATO-themed I-Entity
decoy I-Entity
document I-Entity
depicted I-Entity
in I-Entity
Figure I-Entity
8 I-Entity
. O

The B-Entity
backdoor I-Entity
sent B-Action
data B-Entity
via B-Modifier
SMTP B-Entity
to B-Modifier
natosmtp B-Entity
@ I-Entity
mail I-Entity
[ I-Entity
. I-Entity
] I-Entity
ru I-Entity
and O
received B-Action
its B-Entity
tasking I-Entity
via B-Modifier
POP B-Entity
from B-Modifier
natopop B-Entity
@ I-Entity
mail I-Entity
[ I-Entity
. I-Entity
] I-Entity
ru I-Entity
. O

Although O
we O
have O
not O
conclusively O
attributed O
this O
sample O
to O
APT28 O
, O
it O
does O
suggest O
the O
possibility O
that O
APT28 O
has O
been O
operating O
since O
as O
early O
as O
2004 O
. O

A O
modular O
development O
framework O
suggests O
the O
group O
has O
had O
an O
organized O
development O
effort O
since O
as O
early O
as O
2007 O
. O

During O
our O
research O
, O
we O
discovered O
that O
APT28 B-Entity
uses B-Action
a B-Entity
backdoor I-Entity
developed I-Entity
using I-Entity
a I-Entity
modular I-Entity
framework I-Entity
. O

We O
call O
this O
backdoor O
CHOPSTICK O
, O
a O
somewhat O
ironic O
name O
that O
comes O
from O
our O
semi-random O
name O
generator O
. O

The O
modular O
design O
allows O
flexible O
options O
for O
compiling O
variants O
with O
different O
capabilities O
as O
needed O
, O
as O
well O
as O
deploying O
additional O
capabilities O
at O
runtime O
. O

This O
allows O
the O
developers O
to O
make O
targeted O
implants O
, O
including O
only O
the O
capabilities O
and O
protocols O
necessary O
for O
a O
specific O
environment O
. O

Such O
a O
modular O
framework O
suggests O
the O
group O
has O
had O
an O
organized O
development O
effort O
since O
as O
early O
as O
2007 O
. O

A O
formal O
development O
environment O
, O
in O
which O
code O
is O
versioned O
and O
well-organized O
, O
would O
almost O
certainly O
be O
required O
to O
track O
and O
define O
the O
various O
modules O
that O
can O
be O
included O
in O
the O
backdoor O
at O
compile O
time O
. O

CHOPSTICK O
variants O
may O
move O
messages O
and O
information O
using O
at O
least O
three O
methods O
: O
1 O
. O

Communications B-Entity
with I-Entity
a I-Entity
C2 I-Entity
server I-Entity
using B-Action
HTTP B-Entity
. O

These O
protocols O
are O
covered O
in O
more O
detail O
in O
Appendix O
D. O
2 O
. O

Email B-Entity
sent B-Action
through B-Modifier
a B-Entity
specified I-Entity
mail I-Entity
server I-Entity
. O

One B-Entity
CHOPSTICK I-Entity
v1 I-Entity
variant I-Entity
contained O
modules O
and O
functions O
for O
collecting B-Action
keystroke B-Entity
logs I-Entity
, O
Microsoft B-Entity
Office I-Entity
documents I-Entity
, O
and O
PGP B-Entity
files I-Entity
. O

The B-Entity
monitoring I-Entity
for I-Entity
new I-Entity
files I-Entity
of I-Entity
interest I-Entity
is B-Action
performed I-Action
by O
a B-Entity
'' I-Entity
Directory I-Entity
Observer I-Entity
'' I-Entity
module I-Entity
. O

In O
one O
sample O
this B-Entity
information I-Entity
was O
intended O
to O
be B-Action
sent I-Action
via B-Modifier
SMTP B-Entity
using B-Modifier
a B-Entity
Georgian I-Entity
MIA I-Entity
mail I-Entity
server I-Entity
. O

It B-Entity
used B-Action
one B-Entity
of I-Entity
four I-Entity
embedded I-Entity
sender I-Entity
email I-Entity
addresses I-Entity
( I-Entity
@ I-Entity
mia.gov.ge I-Entity
) I-Entity
to B-Modifier
send B-Entity
files I-Entity
via I-Entity
email I-Entity
to I-Entity
another I-Entity
email I-Entity
address I-Entity
on I-Entity
the I-Entity
same I-Entity
mail I-Entity
server I-Entity
. O

All O
information O
required O
for O
the O
email O
was O
hardcoded O
in O
the O
backdoor O
. O

3 O
. O

Local O
copying O
to O
defeat O
closed O
networks O
. O

One B-Entity
variant I-Entity
of I-Entity
CHOPSTICK I-Entity
focuses O
on O
apparent O
air O
gap O
/ O
closed O
network O
capabilities O
by O
routing B-Action
messages B-Entity
between B-Modifier
local B-Entity
directories I-Entity
, I-Entity
the I-Entity
registry I-Entity
and I-Entity
USB I-Entity
drives I-Entity
. O

During O
our O
research O
into O
APT28 O
's O
malware O
, O
we O
noted O
two O
details O
consistent O
across O
malware O
samples O
. O

The O
first O
was O
that O
APT28 O
had O
consistently O
compiled O
Russian O
language O
settings O
into O
their O
malware O
. O

The O
second O
was O
that O
malware O
compile O
times O
from O
2007 O
to O
2014 O
corresponded O
to O
normal O
business O
hours O
in O
the O
UTC O
+ O
4 O
time O
zone O
, O
which O
includes O
major O
Russian O
cities O
such O
as O
Moscow O
and O
St. O
Petersburg O
. O

PE O
resources O
include O
language O
information O
that O
can O
be O
helpful O
if O
a O
developer O
wants O
to O
show O
user O
interface O
items O
in O
a O
specific O
language O
. O

Non-default O
language O
settings O
packaged O
with O
PE O
resources O
are O
dependent O
on O
the O
developer O
's O
build O
environment O
. O

Each O
PE O
resource O
includes O
a O
'' O
locale O
'' O
identifier O
with O
a O
language O
ID O
'' O
composed O
of O
a O
primary O
language O
identifier O
indicating O
the O
language O
and O
a O
sublanguage O
identifier O
indicating O
the O
country/region O
. O

'' O
At O
the O
time O
of O
the O
writing O
of O
this O
paper O
, O
we O
had O
identified O
103 O
malware O
samples O
that O
were O
both O
attributed O
to O
APT28 O
and O
contained O
PE O
resources O
. O

Table O
5 O
shows O
the O
locale O
identifiers O
with O
associated O
language O
and O
country/region O
for O
these O
samples O
. O

The O
samples O
with O
Russian O
language O
settings O
were O
compiled O
between O
late O
2007 O
and O
late O
2013 O
, O
as O
depicted O
in O
Figure O
9 O
. O

This O
consistency O
over O
a O
long O
timeframe O
suggests O
that O
the O
developers O
of O
APT28 O
malware O
were O
using O
a O
build O
environment O
with O
Russian O
language O
settings O
at O
least O
some O
of O
the O
time O
and O
made O
no O
effort O
to O
obscure O
this O
detail O
. O

Overall O
, O
the O
locale O
IDs O
suggest O
that O
APT28 O
developers O
can O
operate O
in O
both O
Russian O
and O
English O
. O

Of O
the O
140 O
malware O
samples O
that O
we O
have O
attributed O
to O
APT28 O
so O
far O
, O
over O
89 O
% O
were O
compiled O
between O
0400 O
and O
1400 O
UTC O
time O
, O
as O
depicted O
in O
Figure O
10 O
. O

Over O
96 O
% O
were O
compiled O
between O
Monday O
and O
Friday O
. O

This O
parallels O
the O
working O
hours O
in O
UTC+0400 O
( O
that O
is O
, O
compile O
times O
begin O
about O
8AM O
and O
end O
about O
6PM O
in O
this O
time O
zone O
) O
. O

This O
time O
zone O
includes O
major O
Russian O
cities O
such O
as O
Moscow O
and O
St. O
Petersburg O
. O

We O
started O
researching O
APT28 O
based O
on O
activity O
we O
observed O
on O
our O
clients O
' O
networks O
, O
similar O
to O
other O
targeted O
threat O
groups O
we O
have O
identified O
over O
time O
. O

We O
assess O
that O
APT28 O
is O
most O
likely O
sponsored O
by O
the O
Russian O
government O
. O

We O
summarize O
our O
key O
observations O
about O
APT28 O
in O
Figure O
11 O
below O
. O

APT28 O
's O
characteristics-their O
targeting O
, O
malware O
, O
language O
, O
and O
working O
hours-have O
led O
us O
to O
conclude O
that O
we O
are O
tracking O
a O
focused O
, O
long- O
standing O
espionage O
effort O
. O

Given O
the O
available O
data O
, O
we O
assess O
that O
APT28 O
's O
work O
is O
sponsored O
by O
the O
Russian O
government O
. O

We O
use O
the O
term O
'' O
threat O
group O
'' O
to O
refer O
to O
actors O
who O
work O
together O
to O
target O
and O
penetrate O
networks O
of O
interest O
. O

These O
individuals O
may O
share O
the O
same O
set O
of O
tasks O
, O
coordinate O
targets O
, O
and O
share O
tools O
and O
methodology O
. O

They B-Entity
work O
together O
to O
gain B-Action
access B-Entity
to I-Entity
their I-Entity
targets I-Entity
and O
steal B-Action
data B-Entity
. O

The O
art O
of O
attributing O
disparate O
intrusion O
activities O
to O
the O
same O
threat O
group O
is O
not O
always O
simple O
. O

Different O
groups O
may O
use O
similar O
intrusion O
methodologies O
and O
common O
tools O
, O
particularly O
those O
that O
are O
widely O
available O
on O
the O
Internet O
, O
such O
as O
pwdump O
, O
HTran O
, O
or O
Gh0st O
RAT O
. O

There O
may O
be O
overlaps O
between O
groups O
caused O
by O
the O
sharing O
of O
malware O
or O
exploits O
they O
have O
authored O
, O
or O
even O
the O
sharing O
of O
personnel O
. O

Individual O
threat O
actors O
may O
move O
between O
groups O
either O
temporarily O
or O
permanently O
. O

A O
threat O
actor O
may O
also O
be O
a O
private O
citizen O
who O
is O
hired O
by O
multiple O
groups O
. O

Multiple O
groups O
, O
on O
occasion O
, O
compromise O
the O
same O
target O
within O
the O
same O
timeframe O
. O

Distinguishing O
one O
threat O
group O
from O
another O
is O
possible O
with O
enough O
information O
, O
analytical O
experience O
, O
and O
tools O
to O
piece O
it O
all O
together O
. O

We O
can O
analyze O
multiple O
incidents O
and O
tell O
by O
the O
evidence O
left O
behind O
that O
a O
given O
incident O
was O
the O
result O
of O
one O
threat O
group O
and O
not O
another O
. O

Threat O
actors O
leave O
behind O
various O
forensic O
details O
. O

They B-Entity
may O
send B-Action
spear B-Entity
phishing I-Entity
emails I-Entity
from B-Modifier
a B-Entity
specific I-Entity
IP I-Entity
address I-Entity
or I-Entity
email I-Entity
address I-Entity
. O

Their O
emails O
may O
contain O
certain O
patterns O
; O
files O
have O
specific O
names O
, O
MD5 O
hashes O
, O
timestamps O
, O
custom O
functions O
, O
and O
encryption O
algorithms O
. O

Their O
backdoors O
may O
have O
command O
and O
control O
IP O
addresses O
or O
domain O
names O
embedded O
. O

These O
are O
just O
a O
few O
examples O
of O
the O
myriad O
of O
forensic O
details O
that O
we O
consider O
when O
distinguishing O
one O
threat O
group O
from O
another O
. O

At O
the O
most O
basic O
level O
, O
we O
say O
that O
two O
intrusion O
events O
are O
attributed O
to O
the O
same O
group O
when O
we O
have O
collected O
enough O
indicators O
to O
show O
beyond O
a O
reasonable O
doubt O
that O
the O
same O
actor O
or O
group O
of O
actors O
were O
involved O
. O

We O
track O
all O
of O
the O
indicators O
and O
significant O
linkages O
associated O
with O
identified O
threat O
groups O
in O
a O
proprietary O
database O
that O
comprises O
millions O
of O
nodes O
and O
linkages O
between O
them O
. O

In O
this O
way O
, O
we O
can O
always O
go O
back O
and O
answer O
'' O
why O
'' O
we O
associated O
cyber O
threat O
activity O
with O
a O
particular O
group O
. O

SOURFACE B-Entity
is B-Action
a B-Entity
downloader I-Entity
that O
obtains B-Action
a B-Entity
second I-Entity
stage I-Entity
backdoor I-Entity
from B-Modifier
a B-Entity
C2 I-Entity
server I-Entity
. O

Over O
time O
the O
downloader O
has O
evolved O
and O
the O
newer O
versions O
, O
usually O
compiled O
with O
the O
DLL O
name O
'coreshell.dll O
' O
, O
are O
distinct O
enough O
from O
the O
older O
versions O
that O
we O
refer O
to O
it O
as O
SOURFACE/CORESHELL O
or O
simply O
CORESHELL O
. O

This O
appendix O
focuses O
on O
these O
newer O
versions O
. O

CORESHELL B-Entity
uses B-Action
two B-Entity
threads I-Entity
to B-Modifier
communicate B-Entity
with I-Entity
its I-Entity
C2 I-Entity
server I-Entity
. O

The B-Entity
first I-Entity
thread I-Entity
sends B-Action
beacons B-Entity
that I-Entity
contain I-Entity
the I-Entity
process I-Entity
listing I-Entity
of I-Entity
the I-Entity
compromised I-Entity
host I-Entity
. O

The B-Entity
second I-Entity
thread I-Entity
is O
responsible O
for O
downloading B-Action
and O
executing B-Action
stage B-Entity
two I-Entity
payloads I-Entity
. O

Messages B-Entity
are B-Action
sent I-Action
using B-Modifier
HTTP B-Entity
POST I-Entity
requests I-Entity
whose O
bodies O
contain B-Action
encrypted B-Entity
and I-Entity
Base64 I-Entity
encoded I-Entity
data I-Entity
. O

The O
encryption O
algorithm O
is O
a O
custom O
stream O
cipher O
using O
a O
six-byte O
key O
. O

Commands B-Entity
from I-Entity
the I-Entity
controller I-Entity
to I-Entity
the I-Entity
CORESHELL I-Entity
implant I-Entity
are B-Action
encrypted I-Action
using B-Modifier
another B-Entity
stream I-Entity
cipher I-Entity
but I-Entity
this I-Entity
time I-Entity
using I-Entity
an I-Entity
eight-byte I-Entity
key I-Entity
. O

CORESHELL O
has O
used O
the O
same O
user O
agent O
string O
( O
'' O
MSIE O
8.0 O
'' O
) O
that O
SOURFACE O
previously O
used O
, O
but O
in O
more O
recent O
samples O
CORESHELL O
uses O
the O
default O
Internet O
Explorer O
user O
agent O
string O
obtained O
from O
the O
system O
. O

Figure O
11 O
shows O
an O
example O
POST O
request O
. O

When O
Base64 O
decoded O
, O
the O
POST O
content O
looks O
like O
this O
: O
The O
key O
used O
to O
encrypt O
the O
message O
is O
six O
bytes O
long O
and O
is O
appended O
to O
the O
end O
of O
the O
message O
. O

In O
this O
is O
example O
the O
key O
would O
be O
: O
30 O
ac O
e5 O
21 O
e4 O
a6 O
. O

When O
the O
message O
is O
decrypted O
, O
the O
resulting O
plaintext O
is O
: O
The O
following O
table O
contains O
a O
breakdown O
of O
each O
of O
the O
field O
's O
C2 O
message O
. O

Commands B-Entity
are B-Action
sent I-Action
from B-Modifier
the B-Entity
C2 I-Entity
server I-Entity
to B-Modifier
the B-Entity
CORESHELL I-Entity
backdoor I-Entity
in B-Modifier
HTTP B-Entity
responses I-Entity
to I-Entity
the I-Entity
POST I-Entity
requests I-Entity
. O

The O
command O
is O
identified O
by O
the O
NULL O
terminated O
UNICODE O
string O
'' O
OK O
'' O
( O
O\x00\K\x00\x00\ O
x00 O
) O
. O

The O
command O
is O
Base64 O
encoded O
and O
immediately O
follows O
the O
'' O
OK O
'' O
string O
. O

Figure O
12 O
shows O
a O
sample O
CORESHELL O
command O
: O
The O
Base64 O
decoded O
string O
is O
: O
The O
following O
table O
contains O
a O
description O
of O
each O
field O
in O
the O
command O
message O
: O
When O
the O
above O
command O
'' O
10 O
41 O
70 O
41 O
10 O
42 O
33… O
'' O
is O
decrypted O
using O
the O
key O
'' O
01 O
01 O
01 O
01 O
01 O
01 O
01 O
01 O
'' O
the O
following O
command O
message O
is O
produced O
: O
The O
implant O
supports O
the O
following O
four O
command O
identifiers O
from O
the O
controller O
as O
seen O
in O
Table O
8 O
. O

The O
first O
byte O
of O
the O
command O
message O
specifies O
the O
command O
type O
and O
is O
immediately O
followed O
by O
the O
PE O
or O
shellcode O
to O
be O
executed O
. O

In O
this O
example O
the O
command O
byte O
is O
04 O
indicating O
the O
following O
bytes O
are O
shellcode O
. O

If O
the O
command O
byte O
was O
01 O
, O
02 O
, O
or O
03 O
the O
following O
bytes O
would O
be O
a B-Entity
DLL I-Entity
or I-Entity
EXE I-Entity
that O
would O
be B-Action
written I-Action
to B-Modifier
disk B-Entity
and O
executed B-Action
. O

CHOPSTICK B-Entity
is B-Action
a B-Entity
backdoor I-Entity
that O
uses O
a O
modularized O
, O
object-oriented O
framework O
written O
in O
C++ O
. O

This O
framework O
allows O
for O
a O
diverse O
set O
of O
capabilities O
across O
malware O
variants O
sharing O
a O
common O
code O
base O
. O

CHOPSTICK B-Entity
may O
communicate B-Action
with B-Modifier
external B-Entity
servers I-Entity
using B-Modifier
SMTP B-Entity
or I-Entity
HTTP I-Entity
. O

This O
appendix O
documents O
variants O
using O
HTTP O
communications O
. O

The O
first O
time O
CHOPSTICK O
is O
executed O
, O
it B-Entity
may O
encrypt B-Action
and I-Action
store I-Action
configuration B-Entity
data I-Entity
in B-Modifier
the B-Entity
Registry I-Entity
key I-Entity
HKU\S-1-5-19Classes\Software\Microsoft\MediaPlayer\ I-Entity
{ I-Entity
E6696105-E63E-4EF1-939E- I-Entity
15DDD83B669A I-Entity
} I-Entity
\chnnl I-Entity
. O

The O
user O
HKU\S-1-5-19 O
corresponds O
to O
the O
LOCALSERVICE O
account O
SID O
. O

The B-Entity
configuration I-Entity
block I-Entity
is B-Action
encrypted I-Action
using B-Modifier
RC4 B-Entity
encryption I-Entity
. O

The O
key O
is O
a O
combination O
of O
a O
50-byte O
static O
key O
and O
a O
four-byte O
salt O
value O
randomly O
generated O
at O
runtime O
. O

The O
static O
key O
is O
derived O
from O
opcodes O
in O
the O
backdoor O
. O

CHOPSTICK B-Entity
collects B-Action
detailed B-Entity
information I-Entity
from B-Modifier
the B-Entity
host I-Entity
including O
the B-Entity
Windows I-Entity
version I-Entity
, O
CPU B-Entity
architecture I-Entity
, O
Windows B-Entity
Firewall I-Entity
state I-Entity
, O
User B-Entity
Account I-Entity
Control I-Entity
( I-Entity
UAC I-Entity
) I-Entity
configuration I-Entity
settings I-Entity
on I-Entity
Windows I-Entity
Vista I-Entity
and I-Entity
above I-Entity
and O
Internet B-Entity
Explorer I-Entity
settings I-Entity
. O

It B-Entity
also O
tests B-Action
for B-Modifier
the B-Entity
installation I-Entity
of I-Entity
specific I-Entity
security I-Entity
products I-Entity
( I-Entity
Table I-Entity
9 I-Entity
) I-Entity
and I-Entity
applications I-Entity
( I-Entity
Table I-Entity
10 I-Entity
) I-Entity
. O

After O
collecting B-Action
host B-Entity
information I-Entity
, O
CHOPSTICK B-Entity
creates B-Action
a B-Entity
hidden I-Entity
file I-Entity
that I-Entity
may I-Entity
be I-Entity
named I-Entity
% I-Entity
ALLUSERSPROFILE I-Entity
% I-Entity
\edg6EF885E2.tmp I-Entity
for B-Modifier
temporary B-Entity
storage I-Entity
and O
creates B-Action
a B-Entity
Windows I-Entity
mailslot I-Entity
with B-Modifier
the B-Entity
name I-Entity
'' I-Entity
checkmesv5555 I-Entity
'' I-Entity
. O

Its O
usage O
of O
a O
Windows O
mailslot O
would O
potentially O
allow O
external B-Entity
binaries I-Entity
to O
write B-Action
data B-Entity
to B-Modifier
the B-Entity
'' I-Entity
checkmesv5555 I-Entity
'' I-Entity
mailslot I-Entity
, O
possibly O
allowing O
CHOPSTICK B-Entity
to O
encrypt B-Action
and O
store O
output B-Entity
from I-Entity
other I-Entity
malware I-Entity
. O

It B-Entity
creates B-Action
a B-Entity
thread I-Entity
that O
records B-Action
user B-Entity
activity I-Entity
on I-Entity
the I-Entity
host I-Entity
, O
capturing B-Action
desktop B-Entity
screenshots I-Entity
in B-Modifier
JPEG B-Entity
format I-Entity
, O
tracks B-Action
current B-Entity
window I-Entity
focus I-Entity
, O
collects B-Action
keystrokes B-Entity
, O
and O
scrapes B-Action
window B-Entity
contents I-Entity
( I-Entity
text I-Entity
, I-Entity
context I-Entity
menus I-Entity
, I-Entity
etc. I-Entity
) I-Entity
. O

User B-Entity
activity I-Entity
is B-Action
captured I-Action
once B-Entity
every B-Modifier
500 B-Entity
milliseconds I-Entity
and O
logged B-Action
in B-Modifier
an B-Entity
HTML-like I-Entity
format I-Entity
. O

The B-Entity
thread I-Entity
writes B-Action
user B-Entity
activity I-Entity
log I-Entity
messages I-Entity
to B-Modifier
the B-Entity
'' I-Entity
checkmesv5555 I-Entity
'' I-Entity
mailslot I-Entity
in B-Modifier
plain B-Entity
text I-Entity
. O

CHOPSTICK B-Entity
reads B-Action
messages B-Entity
from B-Modifier
the B-Entity
mailslot I-Entity
, O
encrypts B-Action
them B-Entity
using B-Modifier
RC4 B-Entity
, O
and O
then O
stores B-Action
the B-Entity
encrypted I-Entity
message I-Entity
in B-Modifier
an B-Entity
edg6EF885E2.tmp I-Entity
temporary I-Entity
file I-Entity
. O

The O
RC4 O
encryption O
used O
here O
also O
uses O
a O
50- O
byte O
static O
key O
plus O
four-byte O
random O
salt O
value O
. O

After O
approximately O
60 O
seconds O
of O
execution O
time O
, O
CHOPSTICK B-Entity
begins O
communicating B-Action
with B-Modifier
one B-Entity
of I-Entity
its I-Entity
C2 I-Entity
servers I-Entity
over B-Modifier
HTTP B-Entity
. O

After O
sending B-Action
an B-Entity
initial I-Entity
HTTP I-Entity
GET I-Entity
request I-Entity
it B-Entity
uploads B-Action
the B-Entity
file I-Entity
contents I-Entity
of I-Entity
edg6EF885E2 I-Entity
. I-Entity
tmp I-Entity
to B-Modifier
the B-Entity
C2 I-Entity
server I-Entity
using B-Modifier
HTTP B-Entity
POST I-Entity
requests I-Entity
. O

It O
does O
not O
wait O
for O
a O
response O
from O
the O
server O
to O
begin O
uploading O
. O

Once O
the B-Entity
contents I-Entity
of I-Entity
edg6EF885E2.tmp I-Entity
are B-Action
uploaded I-Action
, O
CHOPSTICK B-Entity
deletes B-Action
the B-Entity
file I-Entity
. O

Figure O
13 O
below O
contains O
an O
example O
of O
an B-Entity
HTTP I-Entity
POST I-Entity
request I-Entity
uploading B-Action
a B-Entity
segment I-Entity
from I-Entity
edg6EF885E2.tmp I-Entity
. O

CHOPSTICK B-Entity
uses B-Action
a B-Entity
URL-safe I-Entity
Base64 I-Entity
encoding I-Entity
, O
using B-Modifier
an B-Entity
alphabet I-Entity
that I-Entity
substitutes I-Entity
'' I-Entity
+ I-Entity
'' I-Entity
and I-Entity
'' I-Entity
/ I-Entity
'' I-Entity
for I-Entity
'' I-Entity
- I-Entity
'' I-Entity
and I-Entity
'' I-Entity
 I-Entity
'' I-Entity
, I-Entity
respectively I-Entity
. O

Each O
HTTP O
request O
contains O
multiple O
Base64 O
encoded O
URL O
parameters O
, O
however O
only O
one O
parameter O
contains O
information O
encoded O
by O
the O
malware O
( O
'' O
ai= O
'' O
) O
and O
the O
rest O
of O
the O
URL O
parameters O
appear O
to O
be O
randomly O
generated O
per O
request O
. O

CHOPSTICK B-Entity
encrypts B-Action
an B-Entity
11-byte I-Entity
sequence I-Entity
in B-Modifier
the B-Entity
'' I-Entity
ai= I-Entity
'' I-Entity
parameter I-Entity
. O

The O
purpose O
of O
this O
parameter O
appears O
to O
be O
to O
uniquely O
identify B-Action
the B-Entity
particular I-Entity
instance I-Entity
of I-Entity
the I-Entity
backdoor I-Entity
to B-Modifier
the B-Entity
C2 I-Entity
server I-Entity
. O

The O
Base64 O
encoded O
text O
of O
this O
parameter O
begins O
with O
a O
number O
of O
randomly O
generated O
alphabetical O
characters O
presumably O
intended O
to O
prevent O
people O
from O
Base64 O
decoding O
the O
whole O
string O
without O
some O
knowledge O
of O
how O
the O
malware O
family O
works O
. O

The O
first O
four O
bytes O
of O
the O
message O
are O
an O
XOR O
key O
for O
the O
remainder O
of O
the O
data O
. O

Once O
decrypted O
using O
the O
XOR O
key O
, O
an O
11-byte O
sequence O
is O
revealed O
. O

The O
first O
seven O
bytes O
are O
static O
, O
and O
are O
hard-coded O
in O
CHOPSTICK O
, O
while O
the O
last O
four O
bytes O
appear O
to O
be O
unique O
. O

The B-Entity
message I-Entity
body I-Entity
of I-Entity
the I-Entity
POST I-Entity
request I-Entity
is B-Action
also I-Action
Base64 I-Action
encoded I-Action
. O

This O
encoded O
string O
is O
also O
prefixed O
with O
random O
characters O
designed O
to O
break O
the O
output O
of O
a O
Base64 O
decode O
operation O
on O
the O
entire O
string O
. O

The O
first O
15 O
bytes O
of O
the O
decoded O
message O
body O
comprise O
another O
11-byte O
sequence O
similar O
to O
the O
sequence O
stored O
in O
the O
'' O
ai= O
'' O
parameter O
as O
described O
above O
. O

Decrypting O
these O
bytes O
yields O
another O
static O
seven-byte O
sequence O
, O
followed O
by O
four O
unique O
bytes O
. O

The O
remainder O
of O
the O
message O
body O
consists O
of O
the O
RC4 O
encrypted O
data O
containing O
the O
HTML-formatted O
user O
activity O
log O
, O
edg6EF885E2.tmp O
. O

After O
uploading B-Action
edg6EF885E2.tmp B-Entity
, O
CHOPSTICK B-Entity
continues O
to O
query B-Action
its B-Entity
C2 I-Entity
servers I-Entity
for B-Modifier
commands B-Entity
using B-Modifier
HTTP B-Entity
GET I-Entity
requests I-Entity
. O

The O
malware O
contains O
code O
which O
allows O
it B-Entity
to O
load B-Action
or O
memory-map B-Action
external B-Entity
modules I-Entity
that I-Entity
export I-Entity
the I-Entity
following I-Entity
functions I-Entity
: I-Entity
SendRawPacket I-Entity
, I-Entity
GetRawPacket I-Entity
, I-Entity
InitializeExp I-Entity
, I-Entity
DestroyExp I-Entity
, I-Entity
IsActiveChannel I-Entity
, I-Entity
GetChannelInfo I-Entity
, I-Entity
SetChannelInfo I-Entity
, I-Entity
Run I-Entity
, I-Entity
GetModuleInfo I-Entity
, I-Entity
GiveMessage I-Entity
, I-Entity
and I-Entity
TakeMessage I-Entity
. O

CHOPSTICK O
backdoors O
are O
compiled O
within O
a O
modularized O
development O
framework O
. O

This O
means O
that O
two O
separate O
CHOPSTICK O
backdoors O
may O
contain O
vastly O
different O
functionality O
, O
depending O
on O
which O
modules O
were O
included O
at O
compile O
time O
. O

The B-Entity
modules I-Entity
that I-Entity
are I-Entity
included I-Entity
in I-Entity
an I-Entity
instance I-Entity
of I-Entity
CHOPSTICK I-Entity
may O
be B-Action
reported I-Action
to B-Modifier
the B-Entity
C2 I-Entity
server I-Entity
as B-Modifier
part B-Entity
of I-Entity
POST I-Entity
messages I-Entity
. O

Figure O
14 O
includes O
an O
example O
from O
a O
CHOPSTICK O
v1 O
variant O
: O
To O
decode O
the O
POST O
content O
, O
the O
first O
step O
is O
to O
remove O
characters O
from O
the O
Base64 O
string O
( O
the O
number O
of O
characters O
to O
remove O
may O
vary O
between O
different O
communication O
channels O
) O
. O

In O
the O
example O
from O
Figure O
14 O
, O
the O
number O
of O
characters O
removed O
is O
seven O
. O

Once O
these O
characters O
are O
removed O
the O
decoded O
( O
but O
still O
encrypted O
) O
text O
looks O
like O
this O
: O
The B-Entity
first I-Entity
two I-Entity
words I-Entity
( I-Entity
'' I-Entity
72 I-Entity
11 I-Entity
'' I-Entity
and I-Entity
'' I-Entity
fd I-Entity
22 I-Entity
'' I-Entity
) I-Entity
are O
checksums O
that O
are O
used O
to O
validate B-Action
the B-Entity
message I-Entity
. O

The O
next O
4 O
bytes O
'' O
f8 O
dc O
33 O
9e O
'' O
are O
a O
salt O
value O
that O
is O
appended O
to O
the O
end O
of O
an O
RC4 O
key O
. O

Once O
decrypted O
, O
the O
message O
looks O
like O
the O
following O
: O
The O
strings O
'' O
V4MGNxZWlvcmhjOG9yZQ O
'' O
and O
'' O
= O
< O
< O
\xee O
'' O
are O
hardcoded O
in O
the O
implant O
. O

The O
module O
information O
starts O
at O
offset O
0x20 O
with O
the O
string O
'' O
01 O
00 O
00 O
'' O
and O
is O
formatted O
as O
follows O
: O
The O
modules O
included O
in O
this O
CHOPSTICK O
v1 O
implant O
are O
: O
Our O
determination O
of O
a O
CHOPSTICK O
'' O
v1 O
'' O
versus O
'' O
v2 O
'' O
is O
based O
on O
the O
self-identification O
of O
the O
kernel O
ID O
and O
associated O
modules O
. O

Compare O
the O
list O
of O
CHOPSTICK O
v1 O
modules O
in O
Table O
12 O
with O
the O
list O
of O
modules O
in O
an O
example O
CHOPSTICK O
v2 O
variant O
in O
Table O
13 O
: O
The O
kernel O
IDs O
0x0001 O
and O
0x0002 O
indicate O
different O
versions O
. O

The O
corresponding O
modules O
in O
each O
backdoor O
also O
are O
consistently O
identified O
with O
0x01 O
and O
0x02 O
, O
respectively O
, O
in O
the O
second O
byte O
. O

In O
both O
variants O
the O
modules O
with O
keystroke O
log O
, O
file O
system O
access O
, O
and O
command O
shell O
capabilities O
have O
the O
consistent O
identifiers O
0x10 O
, O
0x11 O
, O
and O
0x13 O
, O
respectively O
, O
in O
the O
first O
byte O
. O

This O
suggests O
that O
the O
first O
byte O
in O
the O
module O
ID O
identifies O
the O
module O
type O
whereas O
the O
second O
byte O
identifies O
the O
kernel O
version O
. O

The O
kernel O
sends O
commands O
to O
each O
module O
using O
its O
module O
ID O
. O

The O
commands O
that O
each O
module O
understands O
are O
likely O
consistent O
from O
build O
to O
build O
. O

Table O
14 O
and O
Table O
15 O
show O
examples O
of O
commands O
that O
each O
module O
understands O
. O

OLDBAIT B-Entity
is B-Action
a B-Entity
credential I-Entity
harvester I-Entity
that O
installs B-Action
itself B-Entity
in B-Modifier
% B-Entity
ALLUSERPROFILE I-Entity
% I-Entity
\\Application I-Entity
Data\ I-Entity
Microsoft\MediaPlayer\updatewindws.exe I-Entity
. O

There O
is O
a O
missing O
space O
in O
the O
MediaPlayer O
directory O
and O
the O
filename O
is O
missing O
the O
'o O
' O
character O
. O

Both B-Entity
the I-Entity
internal I-Entity
strings I-Entity
and I-Entity
logic I-Entity
are B-Action
obfuscated I-Action
and O
are O
unpacked O
at O
startup O
. O

Credentials B-Entity
for I-Entity
the I-Entity
following I-Entity
applications I-Entity
are B-Action
collected I-Action
: O
Both O
email B-Entity
and O
HTTP B-Entity
can O
be B-Action
used I-Action
to B-Modifier
send B-Entity
out I-Entity
the I-Entity
collected I-Entity
credentials I-Entity
. O

Sample O
HTTP O
traffic O
is O
displayed O
in O
Figure O
15 O
. O

OLDBAIT O
handles O
APIs O
very O
similarly O
to O
SOURFACE O
and O
EVILTOSS O
. O

There O
is O
a O
setup O
routine O
that O
loads O
the O
imports O
into O
a O
table O
and O
all O
API O
calls O
reference O
an O
index O
to O
this O
table O
. O

In O
SOURFACE O
and O
EVILTOSS O
the O
table O
is O
stored O
in O
a O
global O
variable O
while O
in O
OLDBAIT O
this O
table O
is O
allocated O
at O
runtime O
and O
a O
pointer O
is O
passed O
between O
functions O
. O